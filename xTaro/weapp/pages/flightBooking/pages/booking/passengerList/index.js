"use strict";require("../../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[7304],{34284:function(e,n,s){var i=s(32180),t=s(90129),r=s(90201),o=s(92954),l=s(17311),a=s(67347),c=s(81789),d=s(63871),u=s(43198),m=s(51595),p=s(43480),g=s(298),f=s(62171),h=s(45023),x=s(64353),v=s(10830),N=s(72950),j=function(e){var n=e.userId,s=void 0===n?"":n,i=e.productTypes,t=e.passengers,l=void 0===t?[]:t,a=e.setPassengers,c=e.setSelected,d=e.isIntl,u=e.children,m=i.indexOf("LIMITED_STUDENT")>-1,p=(0,o.useRouter)(),x=p.params,N=x||{},j=N.policyId,k=(0,v.XC)({userId:s,isStudent:m,intl:d,policyId:j}),w=k.isFetching,b=k.refetch,P=(0,r.useMemo)((function(){return f.R.reduce((function(e,n){return(0,g.Z)((0,g.Z)({},e),{},(0,h.Z)({},n.id,n.checked))}),{},l)}),[l]);return u({isFetching:w,defaultSelected:P,passengers:l,setPassengers:a,setSelected:c,updateGetPassenger:b})},k=function(e){return{userId:(0,x.c7)(e),passengers:(0,N.kJ)(e)}},w=function(e){return{setPassengers:function(n){return e((0,N.kq)(n))},setShowCount:function(n){return e((0,N.gY)(n))},setSelected:function(n,s){return e((0,N.Sx)({selected:n,needSort:s}))}}},b=(0,f.connect)(k,w),P=(0,f.compose)(b)((0,r.memo)(j)),T=P,_=s(83845),C=s(79301),y=s(95308),L=s(71515),S=s(94345),I=s(59931),V=s(69905),Z=s(72776),F=s(54491),M=s(77954),E=s(43752),A=s(22276),R=s(36903),q=s(30847),B=s(20092),D=s(68629),H={"btn-wrap":"PassengerList-module_IXIhN","passenger-list":"PassengerList-module_C6Ki_","top-btn-wrap":"PassengerList-module_tvmY1","icon-add-circle":"PassengerList-module_ZrUDs","passenger-list-item":"PassengerList-module_WbivJ",disable:"PassengerList-module_PrZB0","info-box":"PassengerList-module_Xazjr","basic-info":"PassengerList-module_g7W3z",tag:"PassengerList-module_qqydj","card-info":"PassengerList-module_feb2z","section-operate":"PassengerList-module_Puzze","section-info":"PassengerList-module_r9fuc","english-name":"PassengerList-module_SAtmh",operate:"PassengerList-module_nYrKz",checkError:"PassengerList-module_mVHMP","students-container":"PassengerList-module_TUtaQ","students-list":"PassengerList-module_FOSfg","certification-describe":"PassengerList-module_H1KHj","go-certification":"PassengerList-module_erIny","padding-bottom":"PassengerList-module_x3MyE"},U=s(12809),G={dragUpdatePage:"RefreshScrollView-module_PGWNs",downDragBox:"RefreshScrollView-module_vWfaX",downText:"RefreshScrollView-module_Xi53p",home__wrap:"RefreshScrollView-module_VOuFv",animateTop:"RefreshScrollView-module_YBo30",pullTop:"RefreshScrollView-module_KCfIB",animateHeight:"RefreshScrollView-module_rETmo",pullHeight:"RefreshScrollView-module_VtEqU",animateBackTop:"RefreshScrollView-module_DHXKO",backTop:"RefreshScrollView-module_adXM0",animateBackHeight:"RefreshScrollView-module_u9aHc",backHeight:"RefreshScrollView-module_UzJUf"},z=s(2269),O=function(e){var n=e.isFetching,s=e.refresh,i=void 0===s?null:s,t=e.loadMore,r=void 0===t?null:t,o=e.classNameAdditional,l=void 0===o?"":o,a=e.childComponent;console.log("isFetching",n);var c=function(){i&&i()},d=function(){r&&r()};return(0,z.jsx)(L.View,{className:G.dragUpdatePage,children:(0,z.jsx)(U.Z,{className:(0,f.classnames)(G.home__wrap,l),onScrollToLower:(0,f.trackFn)("onScrollToLower--1dfc7",(function(){return d()})),scrollWithAnimation:!0,refresherEnabled:!0,refresherTriggered:n,onRefresherRefresh:c,refresherThreshold:45,scrollY:!0,id:"id_1dfc7",onScroll:(0,f.trackFn)("id_1dfc7"),children:a})})},W=O,X=s(30948),K=s(42463),Y=s(19836),J=function(e){var n=e.nameError,s=e.checkError,i=e.name,t=(0,Y.Z_)(i),r=i.chineseName,o=[];return r&&o.push({type:"chineseName",text:r}),t&&o.push({type:"englishName",text:t}),(n||null!==s&&void 0!==s&&s.text&&null!==s&&void 0!==s&&s.isEditable)&&o.push({text:n||(null===s||void 0===s?void 0:s.text),type:"warning"}),o},Q=function(){(0,E.jq)("go to student certification, passenger list"),(0,X._)()},$=function(e){var n,s,i=e.productTypes,t=e.passengerItem,o=e.style,l=e.onClickPassengerList,a=e.isIntl,c=e.haveAdult,d=e.clrlist,u=e.policyId,m=t.id,p=t.self,g=t.checked,x=t.document,v=t.passengerType,N=t.nameError,j=t.checkError,k=t.tipContent,w=t.name,b=t.identity,P=t.gender,T=k||[];null!==k&&void 0!==k&&k.includes("\u4e58\u5ba2\u5728\u65c5\u9014\u4e2d\u5c06\u6ee112\u5468\u5c81\uff0c\u6309\u822a\u53f8\u89c4\u5b9a\uff0c\u4e3a\u60a8\u4ee5\u6210\u4eba\u4ef7\u8d2d\u4e70")&&!c&&(T=["\u53bb\u7a0b12\u5468\u5c81\u4ee5\u4e0b\u672a\u6210\u5e74\u4eba\u987b\u7531\u5e74\u6ee118\u5468\u5c81\u4e58\u5ba2\u966a\u540c\u4e58\u673a\uff0c\u5e76\u8d2d\u4e70\u540c\u8231\u7b49\u673a\u7968\uff1b\u82e5\u65e0\u7b26\u5408\u5e74\u9f84\u4e58\u5ba2\u966a\u540c\u8bf7\u76f4\u63a5\u5411\u822a\u7a7a\u516c\u53f8\u9884\u8ba2\u3002"].concat((0,A.Z)(k)));var _=(0,r.useCallback)((function(e){var n=x||{},s=n.interceptStatus,i=void 0===s?"":s,t=n.interceptMessage,r=void 0===t?"":t,o=n.interceptSubMessages,l=void 0===o?[]:o;["W","T"].includes(i)&&("W"===i?(0,Z.Rq)({intermsg:r,interSubMsg:l}):"T"===i&&(0,Z.GV)({intermsg:r}),e.stopPropagation())}),[x]),C=J({nameError:N,checkError:j,name:w}),y=1===(1&b),S=!(null===i||void 0===i||!i.length)&&i.indexOf("LIMITED_STUDENT")>-1,I="MALE"===P?"\u7537":"FEMALE"===P?"\u5973":"",V=!N&&!(null!==j&&void 0!==j&&j.text)&&(!(null!==(n=T)&&void 0!==n&&n.length)||(null===(s=T)||void 0===s?void 0:s.length)&&!g)&&!(S&&!y);return(0,z.jsx)(L.View,{className:(0,f.classnames)(H["passenger-list-item"],(0,h.Z)({},H.disable,N)),style:o,onClick:(0,f.trackFn)("onClick--de373",(function(){return l(m)})),children:(0,z.jsxs)(L.View,{className:"container",children:[(0,z.jsxs)(L.View,{className:"row",children:[(0,z.jsx)(L.View,{className:(0,f.classnames)("col",H["section-operate"]),children:!N&&(0,z.jsx)(r.Fragment,{children:g?(0,z.jsx)(L.Text,{className:"iconfont-h5 icon-selected"}):(0,z.jsx)(L.Text,{className:"iconfont-h5 icon-unselected"})})}),(0,z.jsxs)(L.View,{className:(0,f.classnames)("col",H["section-info"],{"bb-grey-1":V}),children:[(0,z.jsxs)(L.View,{className:H["info-box"],children:[(0,z.jsxs)(L.View,{className:H["basic-info"],children:[null===C||void 0===C?void 0:C.map((function(e,n){return("chineseName"===e.type||"englishName"===e.type)&&(0,z.jsxs)(L.Text,{className:(0,f.classnames)((0,h.Z)({},H["english-name"],"englishName"===e.type)),children:[e.text," "]},"".concat(m,"_").concat(n,"_").concat(e.text))})),p?(0,z.jsx)(L.Text,{className:H.tag,children:"\u672c\u4eba"}):("CHILD"===v||"INFANT"===v)&&(0,z.jsx)(L.Text,{className:H.tag,children:"CHILD"===v?"\u513f\u7ae5":"\u5a74\u513f"}),S&&y&&(0,z.jsx)(L.Text,{className:H.tag,children:"\u5b66\u751f"})]}),I&&a?(0,z.jsx)(L.View,{className:H["card-info"],children:I+" | "+((null===x||void 0===x?void 0:x.name)||"")+" "+((null===x||void 0===x?void 0:x.no)||"")}):(0,z.jsx)(L.View,{className:H["card-info"],children:((null===x||void 0===x?void 0:x.name)||"")+" "+((null===x||void 0===x?void 0:x.no)||"")})]}),(0,z.jsx)(L.View,{className:(0,f.classnames)(H.operate,(0,h.Z)({},H.disable,!(null!==j&&void 0!==j&&j.isEditable))),onClick:(0,f.trackFn)("onClick--3755f",(function(e){(0,K.wd)(a,t,d,u),e.stopPropagation()})),children:(0,z.jsx)(L.Text,{className:"iconfont-h5 icon-edit"})})]})]}),(null===j||void 0===j?void 0:j.text)&&(0,z.jsx)(L.View,{className:"row",children:(0,z.jsxs)(L.View,{className:(0,f.classnames)("col pb-2 bb-grey-1",H.checkError),onClick:(0,f.trackFn)("tipsClick--9f9a1",_),children:[(0,z.jsx)(L.Text,{className:"iconfont-h5 icon-info-slim"}),"passport_region_invalid"===j.text?"\u8bf7\u66f4\u6362\u8bc1\u4ef6\u4fe1\u606f":j.text]})}),g&&!(null!==j&&void 0!==j&&j.text)&&!N&&T&&T.map((function(e,n){return(0,z.jsx)(L.View,{className:"row",children:(0,z.jsxs)(L.View,{className:(0,f.classnames)("col pb-2 bb-grey-1",H.checkError),children:[(0,z.jsx)(L.Text,{className:"iconfont-h5 icon-info-slim"}),e]})},n)})),!N&&!(null!==j&&void 0!==j&&j.text)&&S&&!y&&(0,z.jsx)(L.View,{className:(0,f.classnames)("bb-grey-1 pb-2",H["students-container"]),children:(0,z.jsxs)(L.View,{className:H["students-list"],children:[(0,z.jsx)(L.View,{className:H["certification-describe"],children:"\u901a\u8fc7\u5927\u5b66\u751f\u8ba4\u8bc1\u540e\u53ef\u9884\u8ba2\u6b64\u4ef7\u683c"}),(0,z.jsxs)(L.View,{className:H["go-certification"],onClick:(0,f.trackFn)("onClick--c9a40",(function(e){Q(),e.stopPropagation()})),children:[(0,z.jsx)(L.View,{children:"\u53bb\u8ba4\u8bc1"}),(0,z.jsx)(L.View,{className:"iconfont-h5 icon-arrow-right"})]})]})})]})})},ee=function(e){var n=e.productTypes,s=e.salePolInfo,i=e.passengerList,t=e.onConfirmPassengers,o=e.onClickPassengerList,l=e.isFetching,a=e.updateGetPassenger,c=e.isIntl,d=e.clrlist,u=e.policyId,m=null===i||void 0===i?void 0:i.filter((function(e){return!!e.checked})),p=null===i||void 0===i?void 0:i.filter((function(e){return!e.checked})),h=Number((0,q.l)((null===s||void 0===s?void 0:s.spnlst)||[],B.Fx.ChildCompanionAgeMin)||"18"),x=Number((0,q.l)((null===s||void 0===s?void 0:s.spnlst)||[],B.Fx.OldCompanionAgeMin)||"0"),v=Number((0,q.l)((null===s||void 0===s?void 0:s.spnlst)||[],B.Fx.OldCompanionAgeMax)||"100"),N=null===m||void 0===m?void 0:m.some((function(e){var n=e.companion||{},s=n.lastAge;return s&&s>=Number(h)})),j=null===m||void 0===m?void 0:m.some((function(e){var n=e.companion||{},s=n.lastAge;return s&&s>=Number(x)&&s<Number(v)})),k=(0,z.jsxs)(r.Fragment,{children:[(0,z.jsxs)(L.View,{className:H["top-btn-wrap"],children:[(0,z.jsxs)(R.z,{type:"primary",onClick:(0,f.trackFn)("onClick--9f8df",(function(){return(0,K.wd)(c,void 0,d)})),children:[(0,z.jsx)(L.Text,{className:(0,f.classnames)("iconfont-h5 icon-add-circle",H["icon-add-circle"])}),"\u65b0\u589e\u4e58\u673a\u4eba"]}),(0,z.jsx)(D.Z,{className:"invitePassengerList"})]}),null===m||void 0===m?void 0:m.map((function(e,s){var i,t,r=e.companion||{},l=r.childNeedAccompanyTip,a=r.oldNeedAccompanyTip;if(!N&&l||!j&&a){var p,h=l||a;e=(0,g.Z)((0,g.Z)({},e),{},{tipContent:[].concat((0,A.Z)((null===(p=e)||void 0===p?void 0:p.tipContent)||[]),[h||""])})}var x=null===(i=m.filter((function(e){return"ADULT"===e.passengerType})))||void 0===i?void 0:i.length,v=null===(t=m.filter((function(e){return"1"===(0,I.Md)(e)})))||void 0===t?void 0:t.length,k=x>v;return(0,z.jsx)($,{passengerItem:e,productTypes:n,style:{marginBottom:s===m.length-1?"10px":""},onClickPassengerList:(0,f.trackFn)(e.id+"--onClickPassengerList-485e8",o),isIntl:c,haveAdult:k,clrlist:d,policyId:u},e.id)})),null===p||void 0===p?void 0:p.map((function(e,s){return(0,z.jsx)($,{passengerItem:e,productTypes:n,style:s===p.length-1&&i.length>6?{marginBottom:"240px"}:{},onClickPassengerList:(0,f.trackFn)(e.id+"--onClickPassengerList-759e3",o),isIntl:c,haveAdult:!0,clrlist:d,policyId:u},e.id)})),(0,z.jsx)(L.View,{className:H["padding-bottom"]})]});return(0,z.jsxs)(L.View,{className:H["passenger-list"],children:[(0,z.jsx)(W,{isFetching:l,refresh:a,classNameAdditional:"list-wrap",childComponent:k}),(0,z.jsx)(L.View,{className:H["btn-wrap"],children:(0,z.jsx)(R.z,{type:"blue",onClick:(0,f.trackFn)("onClick--16c31",(function(){return t()})),children:"\u786e\u5b9a"})})]})},ne=ee,se={"passenger-list-page":"PassengerList-module_l6EZm","list-title":"PassengerList-module_SiooP","num-text":"PassengerList-module_ZoA6X"},ie=function(e){var n=e.productTypes,s=e.salePolInfo,i=e.passengers,o=e.defaultSelected,l=e.isFetching,a=e.isIntl,c=e.updateGetPassenger,d=e.setSelected,u=e.resolve,m=e.reject,p=e.clrlist,x=e.policyId,v=(0,r.useState)({}),N=(0,t.Z)(v,2),j=N[0],k=N[1],w=(0,r.useRef)([]),b=(0,r.useMemo)((function(){return(0,g.Z)((0,g.Z)({},o),j)}),[o,j]),P=(0,r.useMemo)((function(){return f.R.map((function(e){return(0,g.Z)((0,g.Z)({},e),{},{checked:!!b[e.id]})}),i||[])}),[i,b]),T=(0,r.useMemo)((function(){return(0,M.$S)(P)}),[P]),_=(0,r.useCallback)(function(){var e=(0,y.Z)((0,C.Z)().mark((function e(s){var i,t,r,o,l,c,d,u,m,f,x,v;return(0,C.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=P.find((function(e){return e.id===s})),t=(null===i||void 0===i?void 0:i.document)||{},r=t.interceptStatus,o=void 0===r?"":r,l=t.interceptMessage,c=void 0===l?"":l,d=t.interceptSubMessages,u=void 0===d?[]:d,m=t.type,f=void 0===m?"":m,(0,E.jq)("onClickPassengerList",{desc:"\u4e58\u673a\u4eba\u5217\u8868\u70b9\u51fb\u4e58\u673a\u4eba",passenger:i,checked:!(null!==i&&void 0!==i&&i.checked)}),i){e.next=5;break}return e.abrupt("return");case 5:if(x=(0,M.N6)(i,T,P,n,a,p),!x){e.next=17;break}if(v=(0,F.e)(p,f),null!==i&&void 0!==i&&i.checked||!a||!v){e.next=13;break}if(w.current.includes(s)||"W"!==o||!u||!c){e.next=13;break}return w.current.push(s),e.next=13,(0,Z.Rq)({intermsg:c,interSubMsg:u});case 13:if("T"!==o||!v){e.next=16;break}return(0,Z.GV)({intermsg:c||"\u8bc1\u4ef6\u6709\u6548\u671f\u9700\u8981\u66f4\u6539"}),e.abrupt("return");case 16:k((0,g.Z)((0,g.Z)({},b),{},(0,h.Z)({},s,!(null!==i&&void 0!==i&&i.checked))));case 17:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[P,a,T,n,p,b]),A=(0,r.useCallback)((function(){(0,E.jq)("onConfirmPassengers"),(0,I.BK)(P,a),d(b,!0),(0,M.xQ)(P),(0,V.k5)({resolve:u})}),[P,a,d,b,u]),R=T||{},q=R.ADULT,B=void 0===q?0:q,D=R.CHILD,H=void 0===D?0:D,U=R.INFANT,G=void 0===U?0:U;return(0,z.jsxs)(L.View,{className:se["passenger-list-page"],children:[(0,z.jsx)(S.Z,{titleText:"\u4e58\u673a\u4eba\u5217\u8868",reject:m,resolve:u,title:(0,z.jsxs)(L.View,{className:se["list-title"],children:[(0,z.jsx)(L.Text,{className:se["info-text"],children:"\u5df2\u9009"}),(0,z.jsxs)(r.Fragment,{children:[(0,z.jsx)(L.Text,{className:se["num-text"],children:B}),(0,z.jsx)(L.Text,{className:"iconfont-h5 icon-adult"})]}),(0,z.jsxs)(r.Fragment,{children:[(0,z.jsx)(L.Text,{className:se["num-text"],children:H}),(0,z.jsx)(L.Text,{className:"iconfont-h5 icon-child"})]}),(0,z.jsxs)(r.Fragment,{children:[(0,z.jsx)(L.Text,{className:se["num-text"],children:G}),(0,z.jsx)(L.Text,{className:"iconfont-h5 icon-infant"})]})]})}),(0,z.jsx)(ne,{passengerList:P,productTypes:n,salePolInfo:s,countList:T,onClosePopup:V.k5,onConfirmPassengers:A,onClickPassengerList:(0,f.trackFn)("onClickPassengerList--cab84",_),isFetching:l,updateGetPassenger:c,isIntl:a,clrlist:p,policyId:x})]})},te=ie;function re(e){var n=(0,d.aN)(e),s=(0,_.Ck)(_.xt),i=(0,_.Ck)(_.W9),t=!!Number(n.isIntl);return(0,z.jsx)(T,{productTypes:s,isIntl:t,children:function(r){var o=r.defaultSelected,l=r.passengers,a=r.setSelected,c=r.isFetching,d=r.updateGetPassenger;return(0,z.jsx)(te,(0,g.Z)({},(0,g.Z)((0,g.Z)({},e),{},{productTypes:s,salePolInfo:i,passengers:l,defaultSelected:o,setSelected:a,isFetching:c,updateGetPassenger:d,isIntl:t,clrlist:null===n||void 0===n?void 0:n.clrlist,policyId:null===n||void 0===n?void 0:n.policyId})))}})}var oe=re,le=function(e){var n=(0,r.useState)(!1),s=(0,t.Z)(n,2),i=s[0],l=s[1],c=(0,d.aN)(e),g=!!Number(c.isIntl),f=(0,m.i)(),h=(0,p.$)();return(0,o.useShareAppMessage)((function(){return l(!0),g?h:f})),(0,r.useEffect)((function(){i&&(0,a.K4)({closeMethod:"close",content:(0,z.jsx)(u.Z,{}),animationClassName:"animate__animated animate__slideInUp animate__faster",buttons:[{text:"\u77e5\u9053\u4e86",class:"primary",callback:function(){l(!1)}}]})})),(0,z.jsx)(oe,{props:e})},ae=(0,c.Z)({needLogin:!0,pageId:l.uP})(le),ce={navigationBarTitleText:"",navigationBarTextStyle:"black",titleBarColor:"#ffffff",navigationStyle:"custom",usingComponents:{captcha:"/commonComponent/captcha_min/captcha"}};ae.enableShareAppMessage=!0;Page((0,i.createPageConfig)(ae,"pages/flightBooking/pages/booking/passengerList/index",{root:{cn:[]}},ce||{}))},79181:function(e){e.exports=require("../../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../../cwx/ext/global")}},function(e){var n=function(n){return e(e.s=n)};e.O(0,[6011,2107,1216,8592],(function(){return n(34284)}));e.O()}]);
//# sourceMappingURL=index.js.map