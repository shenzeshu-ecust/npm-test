"use strict";require("../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[3780],{21417:function(e,i,t){var n=t(32180),c=t(90129),o=t(90201),s=t(92954),a=t(67347),r=t(16921),l=t(22275),d=t(60175),u=t(83674),p=t(10546),g=t(37360),m=t(83845),h=t(81789),x=t(43198),k=t(51595),f=t(62171),v=t(71515),P=t(12809),_=t(63871),C=t(33943),j=t(43752),w=t(48937),N=t(95569),T=t(66187),y=t(2269),b=function(){return(0,y.jsxs)(v.View,{className:"fill-loading",style:{marginLeft:0,marginRight:0},children:[(0,y.jsxs)(v.View,{className:"loading-section loading-margin-0 loading-section2",children:[(0,y.jsx)(v.View,{className:"loading-block loading-block-large"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-long"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-long"})]}),(0,y.jsxs)(v.View,{className:"loading-section loading-margin-0 loading-section1",children:[(0,y.jsx)(v.View,{className:"loading-block loading-block-large"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-small"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-long"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-long"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-large"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-small"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-long"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-long"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-large"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-small"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-long"})]})]})},I=b,S=t(63745),V=function(e){var i=S.Y8.getCurrentPage(),t={pageSource:"ctripwechatmini_planehangsi_realname",isNavBack:!0,returnCallBack:function(i){e&&e(i)}};i.navigateTo({url:"/pages/wallet/setrealname/index",data:t,callback:function(e){return t.returnCallBack(e)},success:function(){},fail:function(){}})},L=t(69191),Z=t(84724),R=t(69905),E=t(19025),F=t(3875),D=(0,y.jsxs)(v.View,{className:"fill-loading",style:{marginLeft:0,marginRight:0},children:[(0,y.jsxs)(v.View,{className:"loading-section loading-margin-0 loading-section2",children:[(0,y.jsx)(v.View,{className:"loading-block loading-block-large"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-long"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-long"})]}),(0,y.jsxs)(v.View,{className:"loading-section  loading-margin-0 loading-section2",children:[(0,y.jsx)(v.View,{className:"loading-block loading-block-large"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-long"}),(0,y.jsx)(v.View,{className:"loading-block loading-block-long"})]})]}),A=D,X=t(298),O=t(88431),M=t(51897),q=t(12265),B=t(97081),G=t(72950),H=t(7905),U=t(14426),K=t(88455),Y=t(68629),W=t(14334),z=t(56494),J=t(82607),Q={"passenger-member-wrap":"BookTip-module_BsIps","student-limit-tip":"BookTip-module_symw1","family-limit-tip":"BookTip-module_uDdtX"},$=function(e){var i=e.registerMemberType,t=e.productTypes,n=e.airlineName,c=e.studentLimitTip,o=e.familyLimitTip;return(0,y.jsxs)(y.Fragment,{children:[("PASSENGER"===i||"MULTI_PASSENGER"===i)&&t.indexOf("LIMITED_AIRLINE_MEMBERSHIP")>-1&&(0,y.jsx)(v.View,{className:(0,f.classnames)("row",Q["passenger-member-wrap"]),children:"\u975e".concat(n,"\u4f1a\u5458\u7684\u4e58\u673a\u4eba\u5c06\u88ab\u6ce8\u518c\u4e3a").concat(n,"\u4f1a\u5458\uff0c\u4ee5\u4eab\u53d7").concat(n,"\u4f1a\u5458\u4ef7")}),c&&(0,y.jsx)(v.View,{className:(0,f.classnames)("row",Q["student-limit-tip"]),children:c}),o&&(0,y.jsx)(v.View,{className:(0,f.classnames)("row",Q["family-limit-tip"]),children:o})]})},ee=(0,o.memo)($),ie=ee,te={"passenger-container":"PassengerModule-module_tpQC_","extra-tip":"PassengerModule-module_bAde7","lock-passenger-tip":"PassengerModule-module_VpJF1",highlight:"PassengerModule-module_Zpbi9"},ne=function(e){var i=e.setTargetView,t=e.lockPriceSwitcher,n=e.goToRealNameFn,c=(0,_.Gm)("bookingPageText",{}),o=(0,m.Ck)(m.s7),s=(0,m.Ck)(m.kA),a=(0,m.Ck)(m.eG),r=(0,m.Ck)(m.xt),l=(0,m.Ck)(m.n8),d=(0,m.Ck)(m.Gi),u=(0,m.Ck)(m.FT),p=(0,m.Ck)(m.WY),g=(0,m.Ck)(m.ow),h=(0,m.Ck)(m.v$),x=(0,m.Ck)(m.xy),k=(0,m.Ck)(m.Nb),P=(0,B.f3)(B.Oh);return(0,y.jsx)(M.Z,{children:(0,y.jsx)(G.ZP,{policy:k,restriction:h,ticketCount:x,setTargetView:i,children:function(e){var m=e.showCount,h=e.passengerCount,x=e.passengers,k=e.lockPsgTip,_=e.selectedPassengers,C=e.setSelected,j=e.isFetching;return(0,y.jsx)(H.ZP,{selectedPassengers:_,realNameType:g,realNameTip:p,setTargetView:i,goToRealName:n,children:function(e){var w,N=e.authInfo;return(0,y.jsxs)(y.Fragment,{children:[1===g&&(0,y.jsx)(J.Z,{authInfo:N,selectedPassengers:_,realNameTip:p,goToRealName:n}),j?(0,y.jsx)(q.T,{}):(0,y.jsxs)(v.View,{className:(0,f.classnames)("card",te["passenger-container"]),id:"userArea",children:[(0,y.jsxs)(K.Z,(0,X.Z)((0,X.Z)({},h),{},{children:[t&&k.length>0?(0,y.jsx)(v.View,{className:te["extra-tip"],children:k.map((function(e){return(0,y.jsx)(v.Text,{className:e.active?te.highlight:te["lock-passenger-tip"],children:e.text},e.text)}))}):(0,y.jsx)(v.View,{children:(0,y.jsx)(Y.Z,{className:"inviteBooking"})}),!(0,O.GN)()&&(0,y.jsx)(W.Z,{})]})),(0,y.jsx)(ie,{registerMemberType:d,productTypes:r,airlineName:l,studentLimitTip:s,familyLimitTip:a}),(0,y.jsx)(z.Z,{showCount:m,passengerCount:h,passengerList:x,xPassengerIds:P,authInfo:N,goToRealName:n,realNameTip:p,realNameType:g,productTypes:r,availableCardList:null===o||void 0===o||null===(w=o.policy)||void 0===w?void 0:w.acardlst,setSelected:C,showLockPricePsg:t&&!!u,isIntl:!1}),(0,y.jsx)(U.Z,{id:"contactArea",setTargetView:i,registerMemberType:d,airlineName:l,productTypes:r,bookingPageText:c,selectedPassengers:_,isIntl:!1})]})]})}})}})})},ce=(0,o.memo)(ne),oe=ce,se=t(52296),ae=t(57895),re=t(17745),le=t(19836),de=t(5328),ue=t(34869),pe=function(){var e=(0,G.r0)(G.w1),i=(0,G.r0)(G.zk),t=(0,G.r0)(G.zY),n=(0,g.GX)(g.cE),o=(0,m.Ck)(m.OI),s=(0,m.Ck)(m.cA),r=(0,B.GT)(),l=(0,c.Z)(r,1),d=l[0];return(0,y.jsx)(v.View,{id:"insuranceArea",children:(0,y.jsx)(M.Z,{children:(0,y.jsx)(f.Insurance,{regionType:"Domestic",contextProps:{TARO_ENV:"weapp",miniProgram:(0,ue.C0)(),sendSpeed:se.jq,sendShowTrace:se.$J,showModal:a.K4,closeModal:a.Mr,jumpToH5:re.G,request:ae.W,sourceCode:"Flight",pageName:"FlightInterBooking",safeArea:(0,C.R2)(),screenWidth:(0,C.So)().screenWidth},promiseRequest:d,departureDate:s,insuranceParamString:o,insuranceRuleSwitch:n,passengerTotalCount:i,selectPassengerList:t,children:function(i){var c=i.selected,o=i.selectedInsurances,s=i.showInsuranceRetainsPop;return(0,y.jsx)(de.ZP,{passengerList:e,children:function(e){var i=e.applicant,a=e.onOpenApplicantListPopup,r=e.onClickApplicantNotice;return(0,y.jsx)(B.ZP,{selected:c,selectedInsurances:o,selectedPassengers:t,insuranceRuleSwitch:n,applicant:i,showInsuranceRetainsPop:s,children:function(e){var t=e.showNonageInsure;return(0,y.jsx)(f.NonageInsureComponent,{isIntl:!1,showNonageInsure:t,applicantName:i&&(0,le.Ob)(i),onOpenApplicantListPopup:a,onClickApplicantNotice:(0,f.trackFn)("insuranceArea--onClickApplicantNotice--f0697",r)})}})}})}})})})},ge=(0,o.memo)(pe),me=ge,he=t(72024),xe=t(61659),ke=t(62461),fe=t(45023),ve=t(22276),Pe=t(81983),_e=t(13374),Ce={container:"XProducts-module_mH20y","combine-section":"XProducts-module_ri3_u","xproduct-item":"XProducts-module_WlqLE","xpro-item":"XProducts-module_QahQ0","xpro-name":"XProducts-module_uWENO","icon-wraning":"XProducts-module_vPi5n","icon-img":"XProducts-module_fhkhG","xpro-price":"XProducts-module_Pxt7U",_dfn:"XProducts-module_ABUPF","xpro-desc":"XProducts-module_O2BzK","xproduct-seperate":"XProducts-module_Bjklb",item:"XProducts-module_BGGWE",active:"XProducts-module_TnGao","item-title":"XProducts-module_yeyhT","item-price":"XProducts-module_TAHC2","item-dfn":"XProducts-module_t0Sq6","security-lounge-pop":"XProducts-module_HP84M","popup-notice":"XProducts-module_pdEQj","pop-tab":"XProducts-module_FCcWk",tab_li:"XProducts-module_onTkm","item-tl":"XProducts-module_YiwDT","tag-slogan":"XProducts-module_VclZx","item-slider":"XProducts-module_waNrD",slide:"XProducts-module_MI0PU","item-section":"XProducts-module_v9EiW","xproduct-tl":"XProducts-module_mX6aE","xproduct-price":"XProducts-module_mr53j","x-price":"XProducts-module_fbc9b",x_dfn:"XProducts-module_C5_Lf",x_del:"XProducts-module_HpQ_r","save-price":"XProducts-module_qlaOm","xproduct-label":"XProducts-module_pLSAg",label:"XProducts-module_noOR8","sub-title":"XProducts-module_xoMyC",tl:"XProducts-module_b5A_p","sub-title-line":"XProducts-module__vjIS","section-tl":"XProducts-module_vA5c2","section-content":"XProducts-module_tJ71X","service-package":"XProducts-module_r47IM"};function je(e){var i=e.noticeList,t=e.tripType,n=void 0===t?"ONE_WAY":t,s=(0,o.useState)(0),a=(0,c.Z)(s,2),r=a[0],l=a[1];return(0,y.jsx)(P.Z,{className:Ce["security-lounge-pop"],scrollY:!0,id:"id_b3a84",onScroll:(0,f.trackFn)("id_b3a84"),children:(0,y.jsx)(v.View,{className:Ce["popup-notice"],id:"security-lounge-pop",children:(0,y.jsxs)(v.View,{children:[i.length>1&&(0,y.jsx)(v.View,{className:Ce["pop-tab"],children:i.map((function(e,i){return(0,y.jsx)(v.View,{className:(0,f.classnames)(Ce.tab_li,(0,fe.Z)({},Ce.active,i===r)),onClick:(0,f.trackFn)("security-lounge-pop--"+e.productId+"--c3aa6",(function(){return l(i)})),"data-testid":"set-show-child-item-index-".concat(i),children:_e.xS[n+i]||_e.xS["seg"+i]},e.productId)}))}),i.map((function(e,i){return(0,y.jsx)(v.View,{children:i===r&&(0,y.jsxs)(o.Fragment,{children:[("SECURITY_CHANNEL"===e.xproductType||"LOUNGE"===e.xproductType&&e.xproductInfo.hotDesc)&&(0,y.jsxs)(v.View,{className:Ce["item-tl"],children:[(0,y.jsx)(v.View,{className:Ce["tag-slogan"],children:e.xproductInfo.hotTitle||"\u4eba\u6c14\u4ea7\u54c1"}),e.xproductInfo.hotDesc]}),e.xproductInfo.pics.length&&(0,y.jsx)(v.View,{className:Ce["item-slider"],style:{height:"238px"},children:(0,y.jsx)(v.Swiper,{indicatorDots:!0,autoplay:!0,interval:3e3,duration:100,circular:!0,className:Ce.slide,children:e.xproductInfo.pics.map((function(e){return(0,y.jsx)(o.Fragment,{children:(0,y.jsx)(v.SwiperItem,{children:(0,y.jsx)(xe.Z,{src:e,className:Ce.slide})})},e)}))})}),(0,y.jsxs)(v.View,{className:Ce["item-section"],children:[(0,y.jsx)(v.View,{className:Ce["xproduct-tl"],children:e.xproductInfo.name||e.productName}),(0,y.jsxs)(v.View,{className:Ce["xproduct-price"],children:[e.priceInfo.salePrice>0&&(0,y.jsxs)(o.Fragment,{children:["\u673a\u7968\u540c\u8ba2\u4ef7",(0,y.jsx)(v.Text,{className:(0,f.classnames)(Ce.x_dfn,Ce["x-price"]),children:"\xa5"}),(0,y.jsx)(v.Text,{className:Ce["x-price"],children:e.priceInfo.salePrice}),"/\u4eba"]}),e.priceInfo.printPrice>0&&(0,y.jsx)(v.View,{className:Ce.x_del,children:"\u673a\u573a\u4ef7\xa5"+e.priceInfo.printPrice}),(0,y.jsx)(v.Label,{className:Ce["save-price"],children:e.priceInfo.printPrice>e.priceInfo.salePrice?"\u7701\xa5"+(e.priceInfo.printPrice-e.priceInfo.salePrice):"\u4f18\u60e0\u4ef7"})]}),!(!e.xproductInfo.tips||!e.xproductInfo.tips.length)&&(0,y.jsx)(v.View,{className:Ce["xproduct-label"],children:e.xproductInfo.tips.map((function(e,i){return(0,y.jsx)(v.Label,{className:Ce.label,children:e},i)}))})]}),e.xproductInfo.tags.length&&(0,y.jsx)(v.View,{className:Ce["item-section"],children:(0,y.jsxs)(v.View,{className:Ce["sub-title"],children:[(0,y.jsx)(v.View,{className:Ce.tl,children:"\u8be6\u7ec6\u8bf4\u660e"}),(0,y.jsx)(v.View,{className:Ce["sub-title-line"]})]})}),e.xproductInfo.tags.map((function(e,i){return(0,y.jsxs)(v.View,{className:Ce["item-section"],children:[(0,y.jsx)(v.View,{className:Ce["section-tl"],children:e.name}),(0,y.jsx)(v.View,{className:Ce["section-content"],children:(0,y.jsx)(v.View,{dangerouslySetInnerHTML:{__html:e.desc}})})]},i)}))]})},e.productId)}))]})})})}function we(e,i){var t=0;return i.length?i.forEach((function(e){e.selected&&(t+=e.priceInfo.salePrice)})):t=Math.min.apply(Math,(0,ve.Z)(e.map((function(e){return e.priceInfo.salePrice})))),t}function Ne(e,i,t,n,c,o){var s,a=!!c.length;if(1===e.length){var r=e[0],l=r.priceInfo,d=r.journeyNo,u=r.segmentNo,p="",g=d-1,m=u-1;"ROUND_TRIP"===i?p=_e.xS["ROUND_TRIP"+g]:t&&(p=_e.xS["seg"+m]),s=(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(v.Text,{children:p}),(0,y.jsx)(v.Text,{className:Ce._dfn,children:"\xa5"}),(0,y.jsx)(v.Text,{children:l.salePrice+"/\u4eba"})]})}else if(e.length>1){var h=we(e,c);s=(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(v.Text,{className:Ce._dfn,children:"\xa5"}),(0,y.jsx)(v.Text,{children:h+"/\u4eba"+(a?"":"\u8d77")})]})}return(0,y.jsxs)(v.View,{className:Ce["xpro-price"],children:[s,(0,y.jsx)(v.View,{children:a&&!!n&&(0,y.jsx)(v.Text,{children:" x "+n})}),(0,y.jsx)(Pe.v,{checked:a,className:"ML10",testId:"select-btn-".concat(o)})]})}function Te(e,i,t){return!i.length||e.length<=1?null:(0,y.jsx)(v.View,{className:Ce["xproduct-seperate"],children:e.map((function(e){var n=i.map((function(e){return e.productId})).includes(e.productId);return(0,y.jsxs)(v.View,{className:(0,f.classnames)(Ce.item,(0,fe.Z)({},Ce.active,n)),onClick:(0,f.trackFn)(e.productId+"--9f2fd",(function(){return t(e)})),children:[(0,y.jsx)(v.View,{className:Ce["item-title"],children:e.xproductInfo.name||e.productName}),(0,y.jsxs)(v.View,{className:Ce["item-price"],children:[(0,y.jsx)(v.Text,{className:Ce["item-dfn"],children:"\xa5"}),(0,y.jsx)(v.Text,{children:e.priceInfo.salePrice})]})]},e.productId)}))})}function ye(e,i,t,n){e.stopPropagation(),(0,j.jq)("security_lounge_click_notice",{text:t}),(0,a.K4)({close:{position:"top-left"},closeMethod:"close",title:t,content:(0,y.jsx)(je,{noticeList:i,tripType:n}),position:"bottom"})}function be(e){var i=e.security,t=e.count,n=e.isTransit,c=e.tripType,o=(0,ke.T)(),s=(0,he.NK)(he.Iz);if(!i||!i.length)return null;var a=function(){s&&s.length?o((0,he.yO)([])):o((0,he.yO)(i))},r=function(e){o((0,he.NQ)(e))};return(0,y.jsxs)(v.View,{className:Ce["xproduct-item"],children:[(0,y.jsxs)(v.View,{onClick:(0,f.trackFn)("chooseAll--ff4a0",a),"data-testid":"choose-all-security",children:[(0,y.jsxs)(v.View,{className:(0,f.classnames)("d-flex",Ce["xpro-item"]),children:[(0,y.jsxs)(v.View,{className:Ce["xpro-name"],onClick:(0,f.trackFn)("onClick--4b94f",(function(e){return ye(e,i,"\u5feb\u901f\u5b89\u68c0",c)})),"data-testid":"security-click",children:[(0,y.jsx)(xe.Z,{className:Ce["icon-img"],src:"https://pages.c-ctrip.com/flight_h5/tinyapp/domBooking/quickSecurityCheck.png"}),(0,y.jsx)(v.View,{children:"\u5feb\u901f\u5b89\u68c0"}),(0,y.jsx)(xe.Z,{src:"https://pages.c-ctrip.com/flight_h5/tinyapp/icons/book-top/Icon_wraning.png",className:Ce["icon-wraning"]})]}),Ne(i,c,n,t,s,"security")]}),(0,y.jsx)(v.View,{className:Ce["xpro-desc"],children:"\u4e13\u7528\u901a\u9053\u5feb\u901f\u7a7f\u8fc7\u5b89\u68c0\uff0c\u51cf\u5c11\u6392\u961f\u7b49\u5f85\u65f6\u957f"})]}),(0,y.jsx)(v.View,{children:Te(i,s,r)})]})}var Ie=be;function Se(e){var i=e.lounge,t=e.count,n=e.isTransit,c=e.tripType,o=(0,ke.T)(),s=(0,he.NK)(he.hc);if(!i||!i.length)return null;var a=function(){s&&s.length?o((0,he._g)([])):o((0,he._g)(i))},r=function(e){o((0,he.ds)(e))};return(0,y.jsxs)(v.View,{className:Ce["xproduct-item"],children:[(0,y.jsxs)(v.View,{onClick:(0,f.trackFn)("chooseAll--3d5cc",a),"data-testid":"choose-all-lounge",children:[(0,y.jsxs)(v.View,{className:(0,f.classnames)("d-flex",Ce["xpro-item"]),children:[(0,y.jsxs)(v.View,{className:Ce["xpro-name"],onClick:(0,f.trackFn)("onClick--4d60f",(function(e){return ye(e,i,"\u8d35\u5bbe\u4f11\u606f\u5ba4",c)})),"data-testid":"lounge-click",children:[(0,y.jsx)(xe.Z,{className:Ce["icon-img"],src:"https://pages.c-ctrip.com/flight_h5/tinyapp/domBooking/loungeReserve.png"}),(0,y.jsx)(v.View,{children:"\u8d35\u5bbe\u4f11\u606f\u5ba4"}),(0,y.jsx)(xe.Z,{src:"https://pages.c-ctrip.com/flight_h5/tinyapp/icons/book-top/Icon_wraning.png",className:Ce["icon-wraning"]})]}),Ne(i,c,n,t,s,"lounge")]}),(0,y.jsx)(v.View,{className:Ce["xpro-desc"],children:"\u5c0f\u98df\u996e\u6599\uff0c\u4e13\u5c5ewifi\uff0c\u8212\u9002\u7684\u5019\u673a\u73af\u5883"})]}),(0,y.jsx)(v.View,{children:Te(i,s,r)})]})}var Ve=Se,Le=t(49574),Ze=t(70766),Re={servicePackage:"ServicePackage-module_Jnh66",namePrice:"ServicePackage-module_EX075",name:"ServicePackage-module_vftaP",priceSelect:"ServicePackage-module_L4wSD",price:"ServicePackage-module_IyUwJ",subPackage:"ServicePackage-module_Q7pXY",title:"ServicePackage-module_vgD3d",separateLineLeft:"ServicePackage-module_UC7kY",titleBox:"ServicePackage-module_MlbQH",titleImage:"ServicePackage-module_B3Xuc",separateLineRight:"ServicePackage-module_hokBJ",subPackageList:"ServicePackage-module_tWhaQ",package:"ServicePackage-module_kJBSm",iconImage:"ServicePackage-module_rRQ9t",detail:"ServicePackage-module_XfpRt",dTitle:"ServicePackage-module_QheO2",content:"ServicePackage-module_FsXtg"};function Ee(e){var i=e.servicePackage,t=e.selectedServicePackage,n=e.addServicePackage,c=e.count,s=e.servicePackageConfig,a=(0,ke.T)(),r=!(null===t||void 0===t||!t.length),l=(0,X.Z)((0,X.Z)({},i),{},{channelType:"4300823"}),d=i.PackageDetailInfo,u=void 0===d?[]:d,p=i.PackageCategoryNoteList,g=void 0===p?[]:p,m=u[0]||{},h=m.PackageSalePolicyInfo,x=void 0===h?[]:h,k=x[0],P=g.filter((function(e){return 3===e.Type})),_=function(){r?((0,j.ff)("C_FLT_N_H5_InputPage_Fwb_Cancel",{xpid:null===k||void 0===k?void 0:k.PackageID}),a(n([]))):((0,j.ff)("C_FLT_N_H5_InputPage_Fwb_Confirm",{xpid:null===k||void 0===k?void 0:k.PackageID}),a(n([l])))},C=function(){r||((0,j.ff)("C_FLT_N_H5_InputPage_Fwb_Pageup"),a(n([l])))},w=function(){(0,j.ff)("C_FLT_N_H5_InputPage_Fwb_Subservice"),(0,Ze.Z)(s,C,r)};return(0,o.useEffect)((function(){setTimeout((function(){(0,Le.I8)()}),50)}),[i]),(0,y.jsxs)(v.View,{className:"autoExpose ".concat(Re.servicePackage),id:"service-package","data-expose":{ubtKeyName:"S_FLT_N_H5_InputPage_Fwb_True",data:{xpid:null===k||void 0===k?void 0:k.PackageID}},children:[(0,y.jsxs)(v.View,{className:Re.namePrice,children:[(0,y.jsx)(v.Text,{className:Re.name,children:null===k||void 0===k?void 0:k.PackageName}),(0,y.jsxs)(v.View,{className:Re.priceSelect,children:[(0,y.jsx)(v.Text,{className:Re.price,children:"\xa5".concat(null===k||void 0===k?void 0:k.SalePrice,"/\u4eba").concat(c>0&&r?"x ".concat(c):"")}),(0,y.jsx)(Pe.v,{checked:r,onClick:(0,f.trackFn)("service-package--clickServicePackage--7ff29",_),testId:"click-service-package",className:"ML10"})]})]}),(0,y.jsxs)(v.View,{className:Re.subPackage,onClick:(0,f.trackFn)("service-package--showDetailPopUp--1cd6f",w),"data-testid":"show-detail-popUp",children:[(0,y.jsxs)(v.View,{className:Re.title,children:[(0,y.jsx)(v.Text,{className:Re.separateLineLeft}),(0,y.jsxs)(v.View,{className:Re.titleBox,children:[(0,y.jsx)(xe.Z,{className:Re.titleImage,src:"https://pages.c-ctrip.com/flight_h5/tinyapp/servicePackage/qyjzgd.png"}),(0,y.jsxs)(v.Text,{children:["\xa5",null===k||void 0===k?void 0:k.OriginalPrice]})]}),(0,y.jsx)(v.Text,{className:Re.separateLineRight})]}),(0,y.jsx)(v.View,{className:Re.subPackageList,children:P.map((function(e,i){return(0,y.jsxs)(v.View,{className:Re["package"],children:[(0,y.jsx)(xe.Z,{className:Re.iconImage,src:null===e||void 0===e?void 0:e.IconUrl}),(0,y.jsxs)(v.View,{className:Re.detail,children:[(0,y.jsx)(v.View,{className:Re.dTitle,dangerouslySetInnerHTML:{__html:(null===e||void 0===e?void 0:e.Content)||""}}),(0,y.jsx)(v.View,{className:Re.content,dangerouslySetInnerHTML:{__html:(null===e||void 0===e?void 0:e.NoteTitle)||""}})]})]},i)}))})]})]})}var Fe=Ee,De=function(e){var i,t,n,c,s,a=e.passengerCount,r=e.sections,l=e.tripType,d=e.xProducts,u=e.loading,p=e.servicePackage,g=e.servicePackageConfig,m=e.selectedServicePackage,h=e.addServicePackage;if(u)return A;var x=a.ADULT,k=void 0===x?0:x,P=a.CHILD,_=void 0===P?0:P,C=k+_,j=null===r||void 0===r||null===(i=r[0])||void 0===i||null===(i=i.segments)||void 0===i?void 0:i.length,w=!!j&&j>1,N=(null===d||void 0===d||null===(t=d.xproducts)||void 0===t||null===(t=t.SECURITY_CHANNEL)||void 0===t?void 0:t.length)>0||(null===d||void 0===d||null===(n=d.xproducts)||void 0===n||null===(n=n.LOUNGE)||void 0===n?void 0:n.length)>0;return(0,y.jsxs)(o.Fragment,{children:[1===(1&(null===p||void 0===p?void 0:p.PackageFlagMap))&&(0,y.jsx)(v.View,{className:(0,f.classnames)("card",Ce["service-package"]),children:(0,y.jsx)(Fe,{servicePackage:p,count:C,servicePackageConfig:g,selectedServicePackage:m,addServicePackage:h})}),N?(0,y.jsx)(v.View,{children:(0,y.jsx)(v.View,{className:(0,f.classnames)("card",Ce.container),children:(0,y.jsxs)(v.View,{className:(0,f.classnames)("card-body",Ce["combine-section"]),id:"x-product-list",children:[(0,y.jsx)(Ie,{security:null===d||void 0===d||null===(c=d.xproducts)||void 0===c?void 0:c.SECURITY_CHANNEL,count:C,isTransit:w,tripType:l}),(0,y.jsx)(Ve,{lounge:null===d||void 0===d||null===(s=d.xproducts)||void 0===s?void 0:s.LOUNGE,count:C,isTransit:w,tripType:l})]})})}):null]})},Ae=De,Xe=t(64353),Oe=function(){var e=(0,ke.C)(Xe.c7),i=(0,m.Ck)(m.C3),t=(0,m.Ck)(m.pp),n=(0,m.Ck)(m.mg),c=(0,m.Ck)(m.e_),o=(0,m.Ck)(m.OI),s=(0,G.r0)(G.zY),a=(0,G.r0)(G.yd);return(0,y.jsx)(M.Z,{children:(0,y.jsx)(he.ZP,{userId:e,searchKey:n,searchToken:t,xproductParamsString:o,children:function(e){var t=e.xProducts,n=e.loading,o=e.servicePackage,r=e.servicePackageConfig,l=e.selectedServicePackage,d=e.addServicePackage;return(0,y.jsx)(Ae,{selectedPassengers:s,passengerCount:a,sections:i,tripType:c,xProducts:t,loading:n,servicePackage:o,servicePackageConfig:r,selectedServicePackage:l,addServicePackage:d})}})})},Me=Oe,qe=Me,Be=t(56849),Ge=t(92139),He=function(){var e=(0,m.Ck)(m.Nb),i=(0,B.f3)(B.vY),t=(0,m.Ck)(m.mg),n=(0,m.Ck)(m.e_),c=(0,Be.Ft)(Be.gZ),o=(0,Be.Ft)(Be.Xb),s=(0,G.r0)(G.yd),a=(0,G.r0)(G.zY);return(0,y.jsx)(v.View,{children:(0,y.jsx)(Be.ZP,{searchKey:t,passengerCount:s,selectedPassengers:a,hasSelectedInsurance:i,tripType:n,isIntl:!1,policy:e,children:function(e){var i=e.manualOperateSelected,t=e.addCouponDomestic,n=e.couponLabel,a=e.isIntl,r=e.addOrVerifyCouponInter;return(0,y.jsx)(Ge.Z,{manualOperateSelected:i,addCouponDomestic:t,addOrVerifyCouponInter:r,isIntl:a,couponList:c,selected:o,couponLabel:n,passengerTotalCount:s.TOTAL})}})})},Ue=He,Ke=Ue,Ye=t(11870),We=t(34439),ze=t(8407),Je=t(32180)["window"],Qe=function(e){var i=e.children,t=e.userId,n=e.policy,s=e.selectedCoupons,a=e.passengerCount,r=e.selectedInsurances,l=e.selectedLounge,d=e.selectedSecurity,u=e.selectedServicePackage,p=e.initOrderCheckResult,g=e.freeX,m=e.termsSwitch,h=(0,o.useState)(!1),x=(0,c.Z)(h,2),k=x[0],f=x[1],v=(0,o.useState)(!1),P=(0,c.Z)(v,2),_=P[0],C=P[1],w=(0,o.useState)(!1),T=(0,c.Z)(w,2),y=T[0],b=T[1],I=(0,o.useCallback)((function(e){k?((0,j.jq)("Order RESERVATION_CHECK check ok"),e({result:1})):((0,j.jq)("Order RESERVATION_CHECK check failed"),m?b(!0):C(!0),e({result:0}))}),[k,m]);(0,N.Up)(N.O4.RESERVATION_CHECK,I);var S=(0,o.useCallback)((function(e){f(e)}),[]),V=(0,o.useMemo)((function(){var e=(0,ze.t)(n,a,s,r,l,d,u,g);return(0,j.jq)("BOOKING_PRICE_CHANGE",{items:e.items,total:e.total}),e}),[g,a,n,s,l,d,u,r]),L=(0,o.useCallback)((function(){try{(0,j.jq)("taro_goto_payment"),p()}catch(e){(0,We.u9)(e)}}),[p,t]),Z=(0,o.useCallback)((function(){C(!1),f(!0),setTimeout((function(){L()}),50)}),[L]),R=(0,o.useCallback)((function(){(0,j.jq)("payment_go_to_payment",{desc:"\u53bb\u652f\u4ed8\uff0c\u53d1\u8d77\u521b\u5355\u68c0\u67e5",time:(new Je.Date).getTime()}),k||!_||m?L():Z()}),[L,k,_,Z]);return i({checkReservationBtn:S,priceDetail:V,reservationCheck:k,setReservationCheck:f,goToPayment:R,reservationAnimate:_,setReservationAnimate:C,agreeAndContinue:Z,isForceShowScheduledDoubleCheckPop:y,setForceShowScheduledDoubleCheckPop:b})},$e=(0,o.memo)(Qe),ei=$e,ii=t(79301),ti=t(95308),ni=t(57042),ci=t(24460),oi=t(81876),si=t(21867),ai=t(86066),ri=t(51482),li=t(4430),di=t(555),ui=t(10975),pi=t(95329),gi=t(55590),mi=t(32408),hi=t(9154),xi=t(66792),ki=t(22722),fi=t(30864),vi={"order-icon":"DomRepeat-module_CysY9",icon:"DomRepeat-module_z0Bx1","order-title":"DomRepeat-module_dP5DT","order-content":"DomRepeat-module_bSYQ9"},Pi=function(e){var i=e.icon,t=e.title,n=e.subTitle,c=(0,f.handleHighlight)(n);return(0,y.jsxs)(v.View,{catchMove:!0,children:[i&&(0,y.jsx)(v.View,{className:vi["order-icon"],children:(0,y.jsx)(xe.Z,{className:vi.icon,src:i})}),t&&(0,y.jsx)(v.View,{className:vi["order-title"],children:t}),c.length>0?(0,y.jsx)(v.View,{className:vi["order-content"],children:c.map((function(e){return(0,y.jsx)(v.Text,{className:e.active?"active":"",children:e.text},e.text)}))}):null]})},_i=Pi,Ci=function(e){var i=e.icon,t=e.title,n=e.subTitle,c=e.buttons;(0,j.$J)("popup_order_repeat_show"),(0,a.K4)({mask:{enableClose:!1},content:(0,y.jsx)(_i,{icon:i,title:t,subTitle:n}),buttons:c,animationClassName:"animate__animated animate__faster animate__zoomIn"})},ji=t(32180)["window"],wi=function(e){(0,si.Z)(t,e);var i=(0,ai.Z)(t);function t(){var e;(0,ni.Z)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return e=i.call.apply(i,[this].concat(c)),(0,fe.Z)((0,oi.Z)(e),"state",{popup:{PRICE_DETAIL:!1,PRICE_CHANGE:!1},priceChangeInfo:{},showLoading:!1,showPayLoading:!1}),(0,fe.Z)((0,oi.Z)(e),"timePromoteText",(Math.round(10*Math.random())%2?"2\u5206\u949f\u8f7b\u677e\u5b8c\u6210\u4e0b\u5355":"10\u5206\u949f\u5185\u5b8c\u6210\u4e0b\u5355")+"\uff0c\u5373\u53ef\u9501\u5b9a\u4f4e\u4ef7"),(0,fe.Z)((0,oi.Z)(e),"onOpenPopup",(function(i){ki.Z.onOpenPopup(i,(0,oi.Z)(e))})),(0,fe.Z)((0,oi.Z)(e),"onClosePopup",(function(i){ki.Z.onClosePopup(i,(0,oi.Z)(e))})),(0,fe.Z)((0,oi.Z)(e),"onSwitchPopup",(function(i){var t=e.state.popup;(0,j.jq)("price_detail_switch",{desc:(t.PRICE_DETAIL?"\u5173\u95ed":"\u6253\u5f00")+"\u4ef7\u683c\u660e\u7ec6\u6d6e\u5c42",show:t.PRICE_DETAIL}),ki.Z.onSwitchPopup(i,(0,oi.Z)(e))})),(0,fe.Z)((0,oi.Z)(e),"orderCreateTime",0),(0,fe.Z)((0,oi.Z)(e),"clickPayment",(0,f.throttle)((function(){var i,t,n,c=e.props,o=c.goToPayment,s=c.priceDetail,a=c.detail,r=c.passengerCount,l=c.selectedCoupons,d=c.selectedInsurances,u=c.selectedLounge,p=c.selectedSecurity,g=c.selectedServicePackage,m=c.freeX;w.F.logTrace("exit","next",{passengerCount:r,selectedCoupons:l,selectedInsurances:d,selectedLounge:u,selectedSecurity:p,selectedServicePackage:g,freeX:m});var h=null===a||void 0===a||null===(i=a.sections)||void 0===i||null===(i=i[0])||void 0===i||null===(i=i.segments)||void 0===i?void 0:i[0];(0,j.jq)("click_payment",{time:(new ji.Date).getTime(),desc:"\u70b9\u51fb\u53bb\u652f\u4ed8"});var x,k=(null===s||void 0===s?void 0:s.policy)||{},f=k.policyNoteList,v=void 0===f?[]:f,P=null===v||void 0===v?void 0:v.find((function(e){return e.type===_e.NF.LockPriceNoteNew})),_=null===v||void 0===v?void 0:v.find((function(e){return e.type===_e.NF.LockPricePolicy}));(null!==P&&void 0!==P&&P.title&&(0,j.jq)("select_lockPrice_price_to_pay"),null!==_&&void 0!==_&&_.content&&null!==a&&void 0!==a&&null!==(t=a.policy)&&void 0!==t&&t.lockPricePassengerList&&(null===a||void 0===a||null===(n=a.policy)||void 0===n||null===(n=n.lockPricePassengerList)||void 0===n?void 0:n.length)>0)&&(0,j.ff)("C_Flt_N_TinyApp_PriceFreeze_AfterSale_FillClick",{dCityCode:null===h||void 0===h?void 0:h.departureCityCode,aCityCode:null===h||void 0===h?void 0:h.arrivalCityCode,takeofftime:null===h||void 0===h?void 0:h.departDateTime,flightNo:null===h||void 0===h?void 0:h.airline,currentPrice:null===a||void 0===a||null===(x=a.policy)||void 0===x||null===(x=x.totalPrices)||void 0===x?void 0:x.ADULT});e.onClosePopup("PRICE_DETAIL"),o()}))),e}return(0,ci.Z)(t,[{key:"componentDidUpdate",value:function(e){var i,t=this.props.orderCheck||{},n=t.pass;(null===(i=e.orderCheck)||void 0===i?void 0:i.pass)!==n&&(1===n?this._goToPayment():-1===n&&this._orderCheckFailure())}},{key:"_orderCheckFailure",value:function(){var e=this.props.orderCheck,i=e||{},t=i.fields,n=i.errors,c=void 0===n?[]:n,o=i.callbacks,s=void 0===o?[]:o;(0,j.jq)("order_check_failure",{fields:t,errors:c}),c.length?"\u8bf7\u5148\u9605\u8bfb\u5e76\u52fe\u9009\u534f\u8bae"===c[0]?((0,j.bd)("S_Flt_N_Confirm_mustread_toast_t"),this.onClosePopup("PRICE_DETAIL")):(0,hi.w)({content:c[0],buttons:[{text:"\u77e5\u9053\u4e86",callback:function(){}}]}):s.length&&s.forEach((function(e){e&&e()}))}},{key:"_goToPayment",value:function(){var e=(0,ti.Z)((0,ii.Z)().mark((function e(i){var t,n,c,o,s,a,r,l,d,u,p,g,m,h,x,k,v,P,_,C,w,N,T,y,b,I,S,V,L,Z,R,E,F,D,A,O,M,q,B,G,H,U,K=this;return(0,ii.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=this.props,c=n.searchKey,o=n.orderCheck,s=n.selectedPassengers,a=n.selectedCoupons,r=n.detail,l=n.authInfo,d=n.registerMemberType,u=n.flightPsgRegisterSettings,p=n.priceDetail,g=n.selectedLounge,m=n.selectedSecurity,h=n.selectedInsurances,x=n.selectedServicePackage,k=n.freeX,v=n.passengerCount,P=n.bookingSwitch,_=P||{},C=_.insuranceRuleSwitch,w=o||{},N=w.fields,T=void 0===N?{}:N,y=f.R.flatten((null===r||void 0===r||null===(t=r.policy)||void 0===t?void 0:t.productTypes)||[]),b=(null===r||void 0===r?void 0:r.policy)||{},I=b.policyNoteList,S=void 0===I?[]:I,V=f.R.find(f.R.propEq("type",_e.NF.RealNameTip),S),L=0,y.indexOf("LIMITED_REAL_NAME_REGISTER_PRODUCT")>-1&&(R=null===V||void 0===V||null===(Z=V.extendNoteEntityList)||void 0===Z?void 0:Z.find((function(e){return 0===e.type})),L="REAL_NAME_REGISTER_ONLY"===(null===R||void 0===R?void 0:R.content)?2:1),E=a.map((function(e){return e.code})),0===Object.values(T).filter((function(e){return!e})).length&&((0,j.jq)("order_check_success"),null!==h&&void 0!==h&&h.length&&(0,j.jq)("order_create_has_insurance",{length:null===h||void 0===h?void 0:h.length}),null!==g&&void 0!==g&&g.length&&(0,j.jq)("order_create_has_lounge",{length:null===g||void 0===g?void 0:g.length}),null!==m&&void 0!==m&&m.length&&(0,j.jq)("order_create_has_security",{length:null===m||void 0===m?void 0:m.length}),null!==x&&void 0!==x&&x.length&&(0,j.jq)("order_create_has_servicePackage",{length:null===x||void 0===x?void 0:x.length}),F=null===x||void 0===x?void 0:x[0],D=F||{},A=D.PackageDetailInfo,O=void 0===A?[]:A,M=O[0],q=M||{},B=q.PackageSalePolicyInfo,G=void 0===B?[]:B,H=G[0]||{},U=(0,X.Z)((0,X.Z)({},H),{},{channelType:null===F||void 0===F?void 0:F.channelType}),this.setState({showPayLoading:!0}),this.orderCreateTime=(new ji.Date).getTime(),(0,pi.vE)({searchKey:c,insuranceRuleSwitch:C,repeatOrder:i,authInfo:l,realNameType:L,registerMemberType:d,flightPsgRegisterSettings:u,priceDetail:p,couponCodeList:E,detail:r,selectedPassengers:s,selectedInsurances:h,selectedLounge:g,selectedSecurity:m,selectedPackage:U,freeX:k,passengerCount:v,selectedCoupons:a,selectedServicePackage:x},(function(){(0,j.jq)("order_create_success",{registerMemberType:d}),K._orderCreateCallback(mi.K.orderResult,!0)}),(function(){(0,j.jq)("order_create_failure",{registerMemberType:d}),K._orderCreateCallback(!1,!0)})));case 10:case"end":return e.stop()}}),e,this)})));function i(i){return e.apply(this,arguments)}return i}()},{key:"_resetPay",value:function(){this.setState({showPayLoading:!1,showLoading:!1}),this.orderCreateTime=0}},{key:"_orderCreateCallback",value:function(e,i){var t=this,n=this.props.bookingSwitch,c=n||{},o=c.insuranceRuleActive,s=c.insuranceRuleSwitch;if(this.orderCreateTime){var a=(new ji.Date).getTime()-this.orderCreateTime,r=o&&xi.Z.getSwitcher("insuranceAgentLayer")?5e3:3e3;a<r?setTimeout((function(){t._orderCreateCallback(e,i)}),r-a):(this.orderCreateTime=0,setTimeout((function(){t._orderCreateCallback(e,i)}),200))}else{if(this._resetPay(),!e)return(0,j.jq)("order_result_failure_nodata",{desc:"\u521b\u5efa\u8ba2\u5355\u5931\u8d25, \u8bf7\u91cd\u8bd5"}),(0,f.showToast)("\u521b\u5efa\u8ba2\u5355\u5931\u8d25, \u8bf7\u91cd\u8bd5");if(i&&e&&e.insuranceUrl&&!e.payToken&&s)return(0,j.jq)("order_result_go_insagent",{desc:"\u8df3\u4fdd\u4ee3"}),(0,re.G)("".concat(e.insuranceUrl,"&hideBack=1"));var l=this.props,d=l.passengerCount,u=l.selectedCoupons,p=l.selectedLounge,g=l.selectedSecurity,m=l.selectedInsurances,h=l.selectedServicePackage,x=l.freeX;w.F.orderErrorHandler(e,{passengerCount:d,selectedCoupons:u,selectedLounge:p,selectedSecurity:g,selectedInsurances:m,selectedServicePackage:h,freeX:x},gi.pw,(function(e){return t._goToPayment(e)}))||(e&&e.payToken&&!e.actionInfo?e.priceChanged&&e.totalPrice?((0,j.$J)("popup_price_change_show"),this.setState({popup:(0,X.Z)((0,X.Z)({},this.state.popup),{},{PRICE_CHANGE:!0}),priceChangeInfo:this._getPriceChangeInfo(e.totalPrice)})):((0,j.jq)("order_result_success_callpay",e),(0,gi.pw)("DOMESTIC")):this._handleErrorCode(e.actionInfo,e.orderIds||[],e.repeatOrderIds||[]))}}},{key:"_handleErrorCode",value:function(e,i,t){var n=this;if(!e)return(0,j.jq)("order_result_failure_errorcode01"),(0,f.showToast)("\u521b\u5efa\u8ba2\u5355\u5931\u8d25, \u8bf7\u91cd\u8bd5");var c=function(e,i){return function(){(0,j.jq)("order_result_dialog_button_click",{subType:e}),"TO_MIDDLE_PAGE"===e?(0,Le.n)():"TO_PAYMENT_PAGE"===e||"toPaymentPage"===e?(0,gi.pw)("DOMESTIC"):"TO_ORDER_DETAIL"===e&&i.length?1===i.length?(0,di.x)(i[0]):li.L.jump():"TO_LIST_PAGE"===e?w.F.isFlightHotel?w.F.jumpToFlightBunldeReload():ri.gY.jump((0,X.Z)((0,X.Z)({},(0,ui.Q)("DOMESTIC")),{},{isFrom:"fromBooking",type:ri.F_.reLaunch})):"PRIORITIZE_TO_MIDDLE_PAGE"===e?(0,Le.n)({delta:2}):"CONTINUE_ORDER"===e&&n._goToPayment(!0)}},o=i.length?i:t,s=[],a=e.mainBtn,r=e.mainType,l=e.subBtn,d=e.subType,u=e.title,p=void 0===u?"":u,g=e.subTitle,m=void 0===g?"\u7cfb\u7edf\u5f02\u5e38":g,h=e.icon,x=e.errorCodes;l&&s.push({text:l,class:"default",callback:c(d,o)}),s.push({text:a&&a.length>4?"\u77e5\u9053\u4e86":a||"\u77e5\u9053\u4e86",class:"primary",callback:c(r,o)}),(0,j.jq)("order_result_failure_errorcode02",{title:p,errorCodes:x}),Ci({icon:h,title:p,subTitle:m,buttons:s})}},{key:"_getPriceChangeInfo",value:function(e){var i=this.props.priceDetail.total;return{oldPrice:i,newPrice:e,changeTitle:"\u822a\u73ed"+(i>e?"\u964d\u4ef7\u4e86":"\u6da8\u4ef7\u4e86"),bookingcnt:6}}},{key:"render",value:function(){var e=this.state,i=e.popup,t=e.showLoading,n=e.priceChangeInfo,c=e.showPayLoading,o=this.props,s=o.showTimePromote,a=o.timePromoteTextJest,r=o.detail,l=o.tripType,d=o.departCity,u=o.arrivalCity,p=o.passengerCount,g=o.priceDetail,m=o.children,h=o.reservationAnimate,x=o.selectedPassengers,k=o.selectedLounge,f=o.selectedSecurity,v=o.selectedInsurances,P=o.selectedServicePackage,_=o.bookingSwitch,C=o.selectedCoupons,j=o.freeX,w=r||{},N=w.sections;return(0,y.jsx)(fi.Z,{freeX:j,selectedCoupons:C,children:m,priceDetail:g,passengerCount:p,onSwitchPopup:this.onSwitchPopup.bind(this),popup:i,reservationAnimate:h,showTimePromote:s,timePromoteTextJest:a,clickPayment:this.clickPayment.bind(this),timePromoteText:this.timePromoteText,showLoading:t,priceChangeInfo:n,showPayLoading:c,sections:N,tripType:l,departCity:d,arrivalCity:u,selectedPassengers:x,selectedLounge:k,selectedSecurity:f,selectedInsurances:v,selectedServicePackage:P,bookingSwitch:_,onClosePopup:this.onClosePopup.bind(this),priceChangeCallback:function(){(0,gi.pw)("DOMESTIC")}})}}]),t}(o.Component),Ni=(0,o.memo)(wi),Ti=t(54972),yi=t(68618),bi=t(16445),Ii=function(e){var i=e.showTimePromote,t=(0,ke.T)(),n=(0,m.Ck)(m.e_),c=(0,m.Ck)(m.s7),o=(0,m.Ck)(m.C3),s=(0,m.Ck)(m.xt),a=(0,m.Ck)(m.gs),r=(0,m.Ck)(m.Lj),l=(0,m.Ck)(m.mg),d=(0,m.Ck)(m.Gi),u=(0,g.GX)(g.DK),p=(0,ke.C)(Xe.c7),h=(0,bi.XC)(yi.Dr),x=(0,Be.Ft)(Be.LJ),k=(0,G.r0)(G.zY),f=(0,G.r0)(G.yd),v=(0,B.f3)(B.FG),P=(0,he.NK)(he.hc),C=(0,he.NK)(he.Iz),j=(0,he.NK)(he.cs),w=(0,he.NK)(he.xR),T=(0,N.a8)(N.Zc),b=function(){return t((0,N.EZ)())},I=(0,_.Sl)("dmsTermsDoubleCheckPop");return(0,y.jsx)(M.Z,{children:(0,y.jsx)(ei,{userId:p,authInfo:h,passengerCount:f,selectedCoupons:x,selectedPassengers:k,selectedInsurances:v,selectedLounge:P,selectedSecurity:C,freeX:w,selectedServicePackage:j,policy:null===c||void 0===c?void 0:c.policy,initOrderCheckResult:b,termsSwitch:I,children:function(e){var t,p=e.reservationCheck,g=e.setReservationCheck,m=e.reservationAnimate,_=e.setReservationAnimate,N=e.checkReservationBtn,b=e.goToPayment,S=e.priceDetail,V=e.isForceShowScheduledDoubleCheckPop,L=e.setForceShowScheduledDoubleCheckPop;return(0,y.jsx)(Ni,{searchKey:l,tripType:n,goToPayment:b,orderCheck:T,bookingSwitch:u,selectedCoupons:x,selectedPassengers:k,passengerCount:f,selectedInsurances:v,selectedLounge:P,selectedSecurity:C,selectedServicePackage:j,freeX:w,showTimePromote:i,reservationCheck:p,authInfo:h,flightPsgRegisterSettings:null===c||void 0===c||null===(t=c.policy)||void 0===t?void 0:t.flightPsgRegisterSettings,registerMemberType:d,detail:c,departCity:a,arrivalCity:r,priceDetail:S,reservationAnimate:m,isIntl:!1,children:(0,y.jsx)(Ye.I,{sections:o,productTypes:s,selectedInsurances:v,setReservationCheck:g,isIntl:!1,termsSwitch:I,children:function(e){var i=e.terms,t=e.personalInfoTerm,n=e.displayPolicyNote,c=e.setScheduledCheck;return(0,y.jsx)(Ti.Z,{reservationAnimate:m,setReservationAnimate:_,reservationCheck:p,checkReservationBtn:N,terms:i,displayPolicyNote:n,personalInfoTerm:t,isIntl:!1,termsSwitch:I,goToPayment:b,setReservationCheck:g,setScheduledCheck:c,isForceShowScheduledDoubleCheckPop:V,setForceShowScheduledDoubleCheckPop:L})}})})}})})},Si=Ii,Vi=Si,Li={"booking-page":"BookingPage-module_7gbR7","new-bg-color":"BookingPage-module_hgVR6"},Zi=t(35102),Ri={"pop-title":"index-module_vRWUM"},Ei=function(e){var i=e.priceLockPop,t=void 0===i?[]:i;return(0,y.jsx)(v.View,{className:Ri["price-lock-pop"],children:(0,y.jsx)(P.Z,{scrollY:!0,className:Ri["container-box"],id:"id_14288",onScroll:(0,f.trackFn)("id_14288"),children:(0,y.jsx)(v.View,{className:Ri["scroll-div"],children:t.map((function(e,i){var t=e.title,n=e.content;return(0,y.jsxs)(v.View,{className:Ri["detail-box"],children:[(0,y.jsxs)(v.View,{className:Ri["detail-title"],children:[(0,y.jsx)(v.Text,{className:Ri["title-number"],children:i+1}),(0,y.jsx)(v.Text,{className:Ri["title-text"],children:t}),(0,y.jsx)(v.View,{className:Ri["title-bg"]})]}),(0,y.jsx)(v.View,{className:Ri["detail-content"],children:n})]},i)}))})})})},Fi=function(e){var i=e||{},t=i.priceLockPop,n=void 0===t?[]:t,c=i.pageTitle,o=void 0===c?"":c;n.length&&(0,a.K4)({close:{position:"top-left"},closeMethod:"close",title:o,content:(0,y.jsx)(Ei,{priceLockPop:n,pageTitle:o}),position:"bottom"})},Di=t(44682),Ai=function(e){var i=e.departureCityCode,t=e.arrivalCityCode,n=e.departDateTime,c=e.airline,s=e.currentPrice,a=e.lockPriceSwitcher,r=e.lockPriceStimulus,l=e.priceLockConfigs,d=e.policyNoteList,u=r&&a,p=l||{},g=p.priceLockIcon,m=void 0===g?"":g,h=p.lockSecIcon,x=void 0===h?"":h,k=(0,o.useMemo)((function(){return f.R.find(f.R.propEq("type",_e.NF.LockPriceNoteNew),d)}),[d]);return(0,o.useEffect)((function(){u&&(0,se.ff)("S_Flt_N_TinyApp_PriceFreeze_AfterSale_FillShow",{aCityCode:t,takeofftime:n,flightNo:c,currentPrice:s})}),[c,t,s,n,i,u]),(0,y.jsxs)(y.Fragment,{children:[u?(0,y.jsx)(v.View,{className:Di.Z.imply,children:(0,y.jsxs)(v.View,{className:Di.Z["lock-left"],children:[(0,y.jsx)(xe.Z,{className:Di.Z["lock-security"],src:x}),(0,y.jsx)(v.View,{className:Di.Z["security-text"],children:r})]})}):null,!u&&k&&(0,y.jsxs)(v.View,{className:Di.Z.imply,onClick:(0,f.trackFn)("onClick--1205e",(function(){(0,j.jq)("click lockPrice popup in booking"),Fi(l)})),children:[(0,y.jsxs)(v.View,{className:Di.Z["lock-left"],children:[(0,y.jsx)(xe.Z,{className:Di.Z["lock-tag"],src:m}),(0,y.jsx)(v.View,{className:Di.Z["lock-text"],children:k.title})]}),(0,y.jsx)(v.View,{className:(0,f.classnames)("iconfont-h5 icon-arrow-right",Di.Z.right)})]})]})},Xi=Ai,Oi=function(e){var i=e.lockPriceSwitcher,t=(0,m.Ck)(m.s7),n=(0,m.Ck)(m.Dq),c=(0,m.Ck)(m.Wt),o=(0,m.Ck)(m.ww),s=(0,m.Ck)(m.lI),a=(0,m.Ck)(m.cA),r=(0,m.Ck)(m.sq),l=(0,m.Ck)(m.FT),d=(0,G.r0)(G.yd),u=(0,_.Gm)("bookingPageText",{}),p=(0,_.Gm)("priceLockConfigs",{});return(0,y.jsx)(Zi.Z,{detail:t,passengerCount:d,bookingPageText:u,priceLockConfigs:p,lockPriceStimulus:l,lockPriceSwitcher:i,isIntl:!1,children:(0,y.jsx)(Xi,{departureCityCode:c,arrivalCityCode:o,departDateTime:a,airline:s,currentPrice:null===r||void 0===r?void 0:r.ADULT,lockPriceSwitcher:i,lockPriceStimulus:l,priceLockConfigs:p,policyNoteList:n})})},Mi=(0,o.memo)(Oi),qi=Mi,Bi=function(e){var i=e.refetch,t=e.detail,n=e.loadingFlight,s=t||{},a=s.invoiceNote,r=s.notiInfo,l=(0,o.useState)(""),d=(0,c.Z)(l,2),u=d[0],p=d[1],g=(0,o.useState)(!0),h=(0,c.Z)(g,2),x=h[0],k=h[1],b=(0,_.Sl)("lockSwitcher"),S=(0,m.Ck)(m.Gi),D=function(){return V((function(e){e&&e.realNameDatas&&e.realNameDatas.idNumber&&i()}))};(0,o.useEffect)((function(){S&&"NONE"!==S&&(0,j.$J)(S)}),[S]);var X=function(){u&&p(""),x&&k(!1)},O=(0,_.aT)(X,i,12e5),M=O.callback,q=(0,C.R2)(),B=q.bottom,G=void 0===B?0:B,H=(0,o.useCallback)((function(){w.F.logTrace("exit","back",{passengerCount:{},selectedCoupons:[],selectedInsurance:[],selectedLounge:[],selectedSecurity:[],selectedServicePackage:[],freeX:[]}),(0,R.Ss)()}),[]);return(0,y.jsx)(N.ZP,{children:function(){return(0,y.jsxs)(v.View,{className:Li["booking-page"],onTouchStart:M,id:"dom-booking-page",children:[(0,y.jsx)(T.Z,{clsName:"booking",pageName:"booking",onBack:H}),(0,y.jsx)(P.Z,{className:"wrapper",scrollY:!0,scrollIntoView:u,scrollWithAnimation:!0,id:"dom-booking-page_id_e4265",onScroll:(0,f.trackFn)("dom-booking-page_id_e4265"),children:(0,y.jsx)(v.View,{className:(0,f.classnames)("container",Li["new-bg-color"]),style:{paddingBottom:"".concat(140+G,"px")},children:n?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(I,{}),A]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(qi,{lockPriceSwitcher:b}),(0,y.jsx)(oe,{setTargetView:p,lockPriceSwitcher:b,goToRealNameFn:D}),(0,y.jsx)(me,{}),(0,y.jsx)(qe,{}),(0,y.jsx)(Ke,{}),(0,y.jsx)(F.Z,{invoiceNote:a}),(0,y.jsx)(v.View,{className:"card-mt-top",children:(null===t||void 0===t?void 0:t.policy)&&(0,y.jsx)(Z.Z,{notiInfo:r,isIntl:!1})}),(0,y.jsx)(L.Z,{pageName:"\u586b\u5199\u9875"})]})})}),(0,y.jsx)(Vi,{showTimePromote:x}),(0,y.jsx)(E.Z,{})]})}})},Gi=(0,o.memo)(Bi),Hi={},Ui=function(e){var i=e.setCurrentPageId,t=(0,o.useState)(!1),n=(0,c.Z)(t,2),h=n[0],f=n[1];return(0,o.useLayoutEffect)((function(){if(!(0,l.s)()){var e=(0,u.um)({}),t=e.timestamp,n=(0,r.Vj)();return d.ZP.on(d.aN,(function(e){i(e),(0,p.Hj)({pageId:e,timestamp:t,key:"middle-to-booking",name:"\u4e2d\u95f4\u9875\u5230\u586b\u5199\u9875"})}),n),function(){d.ZP.off(d.aN,n)}}}),[i]),Hi=(0,k.i)(),(0,s.useShareAppMessage)((function(){return f(!0),Hi})),(0,o.useEffect)((function(){h&&(0,a.K4)({closeMethod:"close",content:(0,y.jsx)(x.Z,{content:"\u597d\u53cb\u4fe1\u606f\u586b\u5199\u5b8c\u6210\u540e\uff0c\u5373\u53ef\u4e0eta\u4e00\u8d77\u8d2d\u7968\u4e86\u54e6\uff01"}),animationClassName:"animate__animated animate__slideInUp animate__faster",buttons:[{text:"\u77e5\u9053\u4e86",class:"primary",callback:function(){f(!1)}}]})}),[h]),(0,y.jsx)(g.ZP,{children:function(e){var i=e.bookingSwitch;return(0,y.jsx)(m.ZP,{children:function(e){var t=e.loadingFlight,n=e.refetch,c=e.detail;return(0,y.jsx)(Gi,{refetch:n,detail:c,loadingFlight:t,bookingSwitch:i})}})}})},Ki=(0,h.Z)({needLogin:!0,createNonUser:!0})(Ui),Yi={navigationBarTitleText:"\u643a\u7a0b\u673a\u7968",navigationBarTextStyle:"white",titleBarColor:"#006ff6",navigationStyle:"custom",usingComponents:{captcha:"/commonComponent/captcha_min/captcha","perinfo-protect-float":"@miniapp/cwx/component/perInfoProtectFloat/index"}};Ki.enableShareAppMessage=!0;Page((0,n.createPageConfig)(Ki,"pages/flightBooking/pages/booking/index",{root:{cn:[]}},Yi||{}))},79181:function(e){e.exports=require("../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../cwx/ext/global")}},function(e){var i=function(i){return e(e.s=i)};e.O(0,[6011,2107,1216,8592],(function(){return i(21417)}));e.O()}]);
//# sourceMappingURL=index.js.map