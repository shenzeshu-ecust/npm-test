"use strict";require("../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[1360],{98040:function(e,t,i){var n=i(32180),o=i(17311),a=i(81789),c=i(62171),l=i(90201),s=i(71515),r=i(63871),u=i(90129),d=i(49386),m=i(69905),y=i(10073),v=function(e){return c.R.map((function(e){var t=e.ename,i=e.globalid,n=e.code;return{ename:t,globalid:i,code:n}}),e||[])},C=y.Z.injectEndpoints({endpoints:function(e){return{getCity:e.query({query:function(e){return{url:"/13373/getLocationInfoByParent",queryParams:{parameterList:[{key:"valid",value:"1"},{key:"administrative",value:"2"}],parentgeocategoryid:e.parentgeocategoryid,parentgeoid:e.parentgeoid,type:"base"}}},transformResponse:function(e){return v(e.locationInfos)}})}}}),f=(C.useGetCityQuery,C.usePrefetch,C.useLazyGetCityQuery),p=new d.ZP({version:"2020-05-29",key:function(){return"CITY_LIST"},expires:function(){return 7*d.v0}}),g=function(e){var t=e.props,i=e.cityInfo,n=e.children,o=(0,l.useState)(),a=(0,u.Z)(o,2),c=a[0],s=a[1],r=(0,l.useState)(),d=(0,u.Z)(r,2),y=d[0],v=d[1],C=(0,l.useState)(),g=(0,u.Z)(C,2),x=g[0],L=g[1],h=(0,l.useState)(),b=(0,u.Z)(h,2),w=b[0],I=b[1],S=(0,l.useState)(1),j=(0,u.Z)(S,2),N=j[0],k=j[1],_=f(),V=(0,u.Z)(_,1),Z=V[0],B=(0,l.useCallback)((function(){var e=p.get();e?s(e):Z({parentgeocategoryid:1,parentgeoid:66}).then((function(e){var t=e.data;p.set(t),s(t)}))}),[Z]),q=(0,l.useCallback)((function(e){Z({parentgeocategoryid:2,parentgeoid:e}).then((function(e){var t=e.data;L(t),k(2)}))}),[Z]);(0,l.useEffect)((function(){var e=JSON.parse(decodeURIComponent(i)),t=e||{},n=t.mainCity,o=t.subCity;B(),null!==n&&void 0!==n&&n.code&&null!==o&&void 0!==o&&o.ename&&(v(n),I(o),q(n.globalid))}),[i,B,q]);var P=(0,l.useCallback)((function(e,i){var n=e.globalid;2===i?(I(e),(0,m.Hm)(t.resolve,{mainCity:y,subCity:e})):(v(e),q(n))}),[y,t,q]);return n({mainCityList:c,mainCity:y,subCityList:x,subCity:w,showLevel:N,setShowLevel:k,onSelectCity:P})},x=(0,l.memo)(g),L=x,h=i(16921),b=i(94345),w=i(12809),I=i(61659),S={cityListContainer:"CityListComp-module_d9Qz4",tableBox:"CityListComp-module_D2P_U",tableItem:"CityListComp-module_BYhE4",active:"CityListComp-module_BIzgM",cityListScroll:"CityListComp-module_EMdVW",title:"CityListComp-module_Oguqc",cityBox:"CityListComp-module_GMqPt",bigLetters:"CityListComp-module_XPE1H",cityItem:"CityListComp-module_NQgi1",firstItem:"CityListComp-module_Nk2OH",selectedIcon:"CityListComp-module_K8uZK"},j=i(2269),N=function(e){var t=e.mainCityList,i=e.mainCity,n=e.subCityList,o=e.subCity,a=e.showLevel,r=e.setShowLevel,d=e.onSelectCity,m=1===a?t:n,y=1===a?i:o,v=1===a?"State/City":"City/Region",C=function(e,t){return(null===e||void 0===e?void 0:e.ename)>(null===t||void 0===t?void 0:t.ename)?1:-1},f=c.R.sort(C,m||[]),p=(0,l.useState)(f.findIndex((function(e){return e.ename===(null===y||void 0===y?void 0:y.ename)}))||0),g=(0,u.Z)(p,2),x=g[0],L=g[1];return(0,l.useEffect)((function(){var e=f.findIndex((function(e){return e.ename===(null===y||void 0===y?void 0:y.ename)})),t=0;e>5&&(t=e-5),L(t)}),[f,y,L]),(0,j.jsxs)(s.View,{className:S.cityListContainer,children:[(null===i||void 0===i?void 0:i.ename)&&(0,j.jsxs)(s.View,{className:S.tableBox,children:[(0,j.jsx)(s.View,{onClick:(0,c.trackFn)("onClick--8532a",(function(){return r(1)})),className:"".concat(S.tableItem," ").concat(1===a?S.active:null),children:null===i||void 0===i?void 0:i.ename}),(0,j.jsx)(s.View,{onClick:(0,c.trackFn)("onClick--fab22",(function(){return r(2)})),className:"".concat(S.tableItem," ").concat(2===a?S.active:null),children:(null===o||void 0===o?void 0:o.ename)||"Select city"})]}),(0,j.jsxs)(w.Z,{className:S.cityListScroll,scrollY:!0,scrollIntoView:"list-"+x,children:[(0,j.jsx)(s.View,{className:S.title,children:v}),null===f||void 0===f?void 0:f.map((function(e,t){var i,n,o=null===f||void 0===f||null===(i=f[t-1])||void 0===i||null===(i=i.ename)||void 0===i?void 0:i.slice(0,1),l=null===f||void 0===f||null===(n=f[t])||void 0===n||null===(n=n.ename)||void 0===n?void 0:n.slice(0,1),r=0===t||o!==l,u=(null===y||void 0===y?void 0:y.ename)===(null===e||void 0===e?void 0:e.ename);return(0,j.jsx)(s.View,{children:(0,j.jsxs)(s.View,{className:S.cityBox,id:"list-"+t,children:[r&&(0,j.jsx)(s.View,{className:S.bigLetters,children:e.ename.slice(0,1)}),(0,j.jsxs)(s.View,{className:"".concat(S.cityItem," ").concat(r?S.firstItem:null),children:[(0,j.jsx)(s.View,{onClick:(0,c.trackFn)("list-"+t+"--"+t+"--f0c06",(function(){return d(e,a)})),className:"".concat(u?S.active:null),children:"".concat(e.ename).concat(1===a?"[".concat(e.code,"]"):"")}),u&&(0,j.jsx)(I.Z,{className:S.selectedIcon,src:"https://pages.c-ctrip.com/flight_h5/tinyapp/domMiddle/policyGou.png"})]})]})},t)}))]})]})},k={"city-list-page":"index-module_QQBcY","m-indexes":"index-module_UFhXR"},_=function(e){var t=(0,r.aN)(e),i=t.title,n=void 0===i?"":i,o=t.cityInfo,a=void 0===o?"":o;return(0,j.jsxs)(s.View,{className:k["city-list-page"],children:[(0,j.jsx)(b.Z,{reject:e.reject,title:decodeURIComponent(n)}),(0,j.jsx)(s.View,{className:"city-container",style:{height:"".concat((0,h.If)(),"px")},children:(0,j.jsx)(L,{props:e,cityInfo:a,children:function(e){var t=e.mainCityList,i=e.mainCity,n=e.subCityList,o=e.subCity,a=e.showLevel,c=e.setShowLevel,l=e.onSelectCity;return(0,j.jsx)(N,{mainCityList:t,mainCity:i,subCityList:n,subCity:o,showLevel:a,setShowLevel:c,onSelectCity:l})}})})]})},V=_,Z=(0,a.Z)({pageId:o.gU})(V),B={navigationBarTitleText:"\u643a\u7a0b\u673a\u7968",navigationBarTextStyle:"black",titleBarColor:"#ffffff",navigationStyle:"custom"};Page((0,n.createPageConfig)(Z,"pages/flightBooking/pages/cityList/index",{root:{cn:[]}},B||{}))},79181:function(e){e.exports=require("../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../cwx/ext/global")}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[6011,2107,1216,8592],(function(){return t(98040)}));e.O()}]);
//# sourceMappingURL=index.js.map