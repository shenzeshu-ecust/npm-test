"use strict";require("../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[9183],{58355:function(e,t,a){var o=a(32180),i=a(90129),n=a(298),s=a(57042),l=a(24460),r=a(81876),c=a(21867),d=a(86066),u=a(45023),m=a(90201),x=a(70407),h={pageContainer:"style-module_fcpxJ",scrollWrapper:"style-module_KpA0l",errorContainer:"style-module_QLUfH",scrollView:"style-module_YDijA",loadingContainer:"style-module_oiqvs",infoContainer:"style-module_znqfz",headerBack:"style-module_tTrrP",headerContainer:"style-module_vQ7af",headerTitle:"style-module_uQX9r",explainContent:"style-module_hNql1",explainTrainIcon:"style-module_KlSzQ",explainText:"style-module_Kglwo",explainArrow:"style-module_riZTl",line:"style-module_IqVre",passengerView:"style-module__Z3r2",passengerText:"style-module_OsJ2m",passengerQIcon:"style-module_GRJht",seatRow:"style-module_bryn0",seatRowItem:"style-module_vAQ74",seatRowItemSelected:"style-module_WlbHj",seatRowItemChoice:"style-module_AfNEv",seatLevel:"style-module_I12Kc",seatPrice:"style-module_t37c6",seatNormalText:"style-module_Q0Ksn",breathRoot:"style-module_fw_Yq",seatListContainer:"style-module_Gli39",ticketContainer:"style-module_Ai_3_",ticketGradient:"style-module_eYz04",allText:"style-module_ubgGp",errorLayout:"style-module_cgLRx",errorImage:"style-module_Ighi2",dialogBg:"style-module_IthGL"},g=a(71515),f=a(14028),p=a(43881),T={cardContainer:"index-module_CDFUw",briefRow:"index-module_rBgwC",tagView:"index-module_OwWo_",tagText:"index-module_ZgmlL",timeText:"index-module_o1t3H",viewDetailButton:"index-module_qvAFE",viewDetailText:"index-module_UKCWh",viewDetailArrow:"index-module_aj6Cj"},S=a(43261),w=a(46208),v=a(2269),y=function(e){var t=e.cardInfo,a=e.showTransferSheet,o=t.transferTag,i=t.costTime,n=t.departureDate,s=t.departureWeekDay,l=t.stations;return(0,v.jsxs)(g.View,{className:T.cardContainer,children:[(0,v.jsxs)(g.View,{className:T.briefRow,children:[(0,v.jsx)(p.o,{className:T.tagView,start:{x:0,y:.5},end:{x:1,y:.5},locations:[0,1],colors:["#0088f6","#006ff6"],children:(0,v.jsx)(g.Text,{className:T.tagText,children:o})}),(0,v.jsx)(w.ZP,{className:T.timeText,children:"".concat(n," ").concat(s," \u8017\u65f6").concat(i)}),(0,v.jsxs)(p.En,{className:T.viewDetailButton,onClick:a,children:[(0,v.jsx)(g.Text,{className:T.viewDetailText,children:"\u884c\u7a0b\u8be6\u60c5"}),(0,v.jsx)(f.Z,{className:T.viewDetailArrow,children:"\ue944"})]})]}),(0,v.jsx)(S.Z,{stations:l,showTransferSheet:a})]})},C=m.memo(y,(function(e,t){return e.cardInfo===t.cardInfo})),k=a(22276),j={singleSeatContainer:"index-module_C6076",lowPriceContainer:"index-module_v5x0k",tagText:"index-module_lLnFV",singleSeatRow:"index-module_RgV0D",singleSeatRowLeft:"index-module_gOMCs",priceContainer:"index-module_deGyN",priceText:"index-module_UETnk",seatExplainContainer:"index-module_qqniU",seatExplain:"index-module_OYSmR",seatLine:"index-module_PYoDL",seatExplainLine:"index-module_J_L2j",priceUnit:"index-module_TiuhC",priceAmount:"index-module_yln9D",priceSuffix:"index-module_wwCaJ",tagContainer:"index-module_cLYH9",ruleArrow:"index-module_MA7KW",singleSeatRowRight:"index-module_BJLmi",bookButton:"index-module_zE8jH",bookTagContainer:"index-module_ZOJQo",bookTag:"index-module_bP7jU",bookText:"index-module_ta41d",bookTextDisable:"index-module_hkraH",rowView:"index-module_aX6PW",tagsText:"index-module_idLcm",tagsDisableColor:"index-module_SR_qQ",supportText:"index-module_RUtNV",unsupportedText:"index-module_TJUU9",supportLine:"index-module_nzo1Y",disableTitleColor:"index-module_goc68"},_=m.memo((function(e){var t=e.tag,a=e.isSoldOut,o=e.index,i=t.tagName,n=(t.tagIndex,t.type),s=void 0===n?0:n,l="";return l=a?j.tagsDisableColor:0===s?j.supportText:j.unsupportedText,(0,v.jsxs)(g.View,{className:j.rowView+" "+j.tagContainer,children:[0!==o&&(0,v.jsx)(g.View,{className:j.supportLine}),(0,v.jsx)(g.Text,{className:j.tagsText+" "+l,children:i})]})}),(function(e,t){var a=e.tag,o=t.tag;return a===o})),N=function(e){var t=e.data,a=e.minPriceFarePackage,o=e.onBookClick,i=e.openRuleClick,n=t.saleAvgPrice,s=void 0===n?0:n,l=t.serviceAvgFee,r=void 0===l?0:l,c=t.couponAvgFee,d=void 0===c?0:c,u=t.fares,x=void 0===u?[]:u,h=t.farePackageId,T=t.fareRelations,S=void 0===T?[]:T,y=t.localIsSoldOut,C=t.localTicketRemain,N=(0,m.useMemo)((function(){return s+r-d}),[s,r,d]),D=(0,m.useMemo)((function(){return a.id===h}),[h,a]),I=(0,m.useMemo)((function(){var e=[];return x.forEach((function(t){e=(0,k.Z)(t.tags)})),{tagList:e.filter((function(e){return e.needShow})),ticketInfo:x[0].ticketInfo}}),[x]),R=I.tagList,Z=I.ticketInfo,P=(0,m.useMemo)((function(){var e=y?j.disableTitleColor:j.priceText,t=y?" ".concat(j.disableTitleColor):"",a=y?["#f0f0f0","#f0f0f0"]:["#ff9900","#ff6600"],o=y?j.bookTextDisable:j.bookText;return{basePriceTextStyle:e,extendExplainTextStyle:t,ticketRemainTag:!y&&C<9?"\u5269".concat(C,"\u5f20"):"",bookBackground:a,bookTextStyle:o}}),[S,y,C]),b=P.basePriceTextStyle,E=P.extendExplainTextStyle,B=P.ticketRemainTag,L=P.bookBackground,A=P.bookTextStyle,V=(0,m.useCallback)((function(){i&&i(t)}),[t,y]);return(0,v.jsxs)(g.View,{className:j.singleSeatContainer,children:[D&&(0,v.jsx)(g.View,{className:j.lowPriceContainer,children:(0,v.jsx)(g.Text,{className:j.tagText,children:"\u6700\u4f4e\u4ef7"})}),(0,v.jsxs)(g.View,{className:j.singleSeatRow,children:[(0,v.jsxs)(g.View,{className:j.singleSeatRowLeft,children:[(0,v.jsxs)(g.View,{className:j.rowView+" "+j.priceContainer,children:[(0,v.jsx)(g.Text,{className:b+" "+j.priceUnit,children:"\xa5"}),(0,v.jsx)(w.ZP,{fontFamily:w.Fk.SemiBold,className:b+" "+j.priceAmount,children:N}),(0,v.jsx)(g.Text,{className:b+" "+j.priceSuffix,children:"/\u4eba"})]}),(0,v.jsx)(p.En,{className:j.rowView+" "+j.seatExplainContainer,onClick:V,children:(0,v.jsxs)(g.Text,{className:j.seatExplain+E,children:[Z.classNameShow,(0,v.jsx)(g.Text,{className:j.seatLine,children:" \ud834\udd05 "}),Z.name]})}),(0,v.jsxs)(p.En,{className:j.rowView,onClick:V,children:[R.map((function(e,t){return(0,v.jsx)(_,{isSoldOut:y,index:t,tag:e},t)})),(0,v.jsx)(f.Z,{className:j.ruleArrow,children:"\ue944"})]})]}),(0,v.jsxs)(g.View,{className:j.singleSeatRowRight,children:[(0,v.jsx)(p.En,{activeOpacity:.8,onClick:function(){y||o(t)},children:(0,v.jsx)(p.o,{start:{x:0,y:0},end:{x:1,y:0},locations:[0,1],colors:L,className:j.bookButton,children:(0,v.jsx)(g.Text,{className:A,children:y?"\u552e\u5b8c":"\u8ba2"})})}),B&&(0,v.jsx)(g.View,{className:j.bookTagContainer,children:(0,v.jsx)(g.Text,{className:j.bookTag,children:B})})]})]})]})},D=m.memo(N),I=a(39441),R=a(11478),Z=a(67215),P={sheetContainer:"style-module_yNwYA",headerRow:"style-module_QwBFy",closeButton:"style-module_PL5L0",closeIcon:"style-module_qDxzc",titleText:"style-module_gJULf",webView:"style-module_jqI81",htmlScrollContainer:"style-module_khla1"},b=a(92954),E=a.n(b),B=a(31789),L=E().getSystemInfoSync().windowHeight,A=.7*L,V=.5*L,M=function(e){(0,c.Z)(a,e);var t=(0,d.Z)(a);function a(){return(0,s.Z)(this,a),t.apply(this,arguments)}return(0,l.Z)(a,[{key:"render",value:function(){var e=this.props,t=e.onClose,a=e.ticketExplain,o=void 0===a?{}:a,i=e.isShowSupplierModal;if(!i)return null;var n=o.title,s=o.type,l=o.htmlString,r=!B.Z.isEmpty(l);return(0,v.jsxs)(g.View,{className:P.sheetContainer,children:[(0,v.jsxs)(g.View,{className:P.headerRow,children:[(0,v.jsx)(p.En,{className:P.closeButton,onClick:t,children:(0,v.jsx)(f.Z,{className:P.closeIcon,children:"\ue004"})}),(0,v.jsx)(g.Text,{className:P.titleText,children:r?"\u7968\u79cd\u8bf4\u660e":n})]}),r?(0,v.jsx)(g.ScrollView,{className:P.htmlScrollContainer,children:(0,v.jsx)(g.RichText,{nodes:l})}):(0,v.jsx)(g.WebView,{className:P.webView,style:{height:r?V:A},src:"https://m.ctrip.com/webapp/eurail/activity/pages/eucoach.html?vendor=".concat(s)})]})}}]),a}(m.Component),W=a(92835),O=a(25940),F=a(35706),q={dialogWrapper:"style-module_hOpQk",dialogBackgroundImage:"style-module_Qlg55",closeButton:"style-module_cImMy",closeIcon:"style-module_Dn9Nu",title:"style-module_WoWq5",content:"style-module_ztjr3",highlightContent:"style-module_rQplU",confirmButton:"style-module_ylJk_",gradientButtonBg:"style-module_IQByE",confirmText:"style-module_XxS19"},U=a(80741),Q=function(e){(0,c.Z)(a,e);var t=(0,d.Z)(a);function a(e){return(0,s.Z)(this,a),t.call(this,e)}return(0,l.Z)(a,[{key:"render",value:function(){var e,t=this.props,a=t.onClose,o=t.title,i=void 0===o?"\u6e29\u99a8\u63d0\u793a":o,n=t.contents;return B.Z.isString(n)?e=n:B.Z.isArray(n)&&(e=n.map((function(e){return e.highlight?(0,v.jsx)(g.Text,{className:q.highlightContent,children:e.content}):e.content}))),(0,v.jsxs)(g.View,{className:q.dialogWrapper,children:[(0,v.jsx)(g.Image,{className:q.dialogBackgroundImage,mode:"widthFix",src:U.Z.COMMON_CENTER_DIALOG_HEADER}),(0,v.jsx)(p.En,{className:q.closeButton,onClick:a,children:(0,v.jsx)(f.Z,{className:q.closeIcon,children:"\ue004"})}),(0,v.jsx)(g.Text,{className:q.title,children:i}),(0,v.jsx)(g.Text,{className:q.content,children:e}),(0,v.jsxs)(p.En,{className:q.confirmButton,onClick:a,children:[(0,v.jsx)(p.o,{className:q.gradientButtonBg,start:{x:1,y:.5},end:{x:0,y:.5},locations:[0,1],colors:["#0076f5","#00a7fa"]}),(0,v.jsx)(g.Text,{className:q.confirmText,children:"\u77e5\u9053\u4e86"})]})]})}}]),a}(m.Component),H=a(99415),Y=a(40876),G=a(51061),K=a(4151),J=a(21882),z=a(83090),X=a(83661),$=function(e){(0,c.Z)(a,e);var t=(0,d.Z)(a);function a(e){var o;(0,s.Z)(this,a),o=t.call(this,e),(0,u.Z)((0,r.Z)(o),"onCloseSupplierModal",(function(){H.W.userTraceDetail("closeSupplierModal","\u5173\u95ed\u7968\u79cd\u8bf4\u660e"),o.setState({isShowSupplierModal:!1})})),(0,u.Z)((0,r.Z)(o),"onCloseRefundRule",(function(){H.W.userTraceDetail("closeRefundRule","\u5173\u95ed\u9000\u7968\u89c4\u5219"),o.setState({isShowRefundRule:!1})})),(0,u.Z)((0,r.Z)(o),"onCloseReminderDialog",(function(){H.W.userTraceDetail("closeReminderDialog","\u5173\u95ed\u63d0\u9192\u5f39\u7a97"),o.setState({isShowReminderDialog:!1})})),(0,u.Z)((0,r.Z)(o),"gotoBookPage",(function(e){var t=o.state.trainData,a=void 0===t?{}:t,i=e.salePrice,n=e.saleAvgPrice,s=e.ticketPrice,l=e.serviceFee,r=e.serviceAvgFee,c=e.couponAvgFee,d=e.fareRelations,u=void 0===d?[]:d,m=e.fares,x=void 0===m?[]:m,h=R.Z.getFirstFares(x),g=h.ticketInfo,f=h.tags,T=void 0===f?[]:f;H.W.userTraceDetail("gotoNewBook","\u8df3\u8f6c\u65b0\u7248\u586b\u5199\u9875",{data:{salePrice:i,saleAvgPrice:n,ticketPrice:s,serviceFee:l,serviceAvgFee:r,couponAvgFee:c,fareRelations:u},showData:{showPrice:n+r-c,showName:"".concat(g.classNameShow," | ").concat(g.name),showTags:T.map((function(e){return e.needShow?e.tagName:e.tagName+"_hidden"}))}});var S={from:o.model.from,to:o.model.to,trainData:a,trainPackage:e,utmSource:o.model.utmSource,searchUniqueKey:o.model.searchUniqueKey};p.Nd.navigateTo({url:"/pages/trainAbroad/euBook/index",data:X.Z.setParams(S)})})),(0,u.Z)((0,r.Z)(o),"gotoBook",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",a=o.state.trainData,i=void 0===a?{}:a,n=o.model.searchAgeInfoList,s=G.Z.convertTraceObject({item:e,trainData:i,searchAgeInfoList:n});G.Z.bookClick(t,s);var l=p.Y8.user.isLogin();l?o.gotoBookPage(e):p.Y8.user.login({callback:function(t){t&&t.data?o.gotoBookPage(e):H.W.userTraceDetail("gotoBookUnLogin","\u8df3\u8f6c\u586b\u5199\u9875\u767b\u5f55\u5931\u8d25",{data:t})}})})),o.state={currentSeatIndex:0,loadingStatus:0,trainData:{},isShowTransferSheet:!1,scheduleDetailInfo:{},isShowRefundRule:!1,refundRuleData:{},isShowPolicy:!1};var i=X.Z.getParamsWithInstance((0,b.getCurrentInstance)());return o.model=(0,n.Z)((0,n.Z)({},i),{},{priceTipsObj:z.i.getPriceTip()}),H.W.userTraceDetail("constructor","\u521d\u59cb\u5316X\u9875",{params:i}),o}return(0,l.Z)(a,[{key:"getPageId",value:function(){return G.Z.getDetailPageId()}},{key:"componentDidMount",value:function(){this.loadTrainDetail(),this.loadSeatDetailConfig()}},{key:"fetchTicketExplain",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!(0,B.x)(e)){var a=e.supplier;if(t.length>0){var o=t.find((function(e){return e.type===a}));if(!(0,B.x)(o)){var i=o.desc;return i.type=a,i}}}}},{key:"adaptHtmlString",value:function(e){var t=["margin-bottom","line-height","margin-top"];return t.forEach((function(t){var a=new RegExp("".concat(t,":(\\d+)"),"g");e=e.replace(a,(function(e,t){var a=Number.parseInt(t);return e.replace(/\d+/g,(a/2).toString())}))})),e}},{key:"loadSeatHtml",value:function(e){var t=this;I.Z.postAsync("/19799/json/GetSysConfig",{ConfigKey:"RE_EURAIL_DETAIL_TICKET_DESC"}).then((function(a){var o=a.configValue;(0,B.x)(o)?(H.W.userTraceDetail("getSysConfigFailure","\u8bf7\u6c42\u8f66\u7968\u8bf4\u660e\u5931\u8d25",{response:a}),E().showToast({title:"\u83b7\u53d6\u8f66\u7968\u8bf4\u660e\u5931\u8d25",duration:2e3,icon:"none"})):(e.htmlString=t.adaptHtmlString(o),t.setState({isShowSupplierModal:!0}))})).catch((function(e){H.W.userTraceDetail("getSysConfigError","\u8bf7\u6c42\u8f66\u7968\u8bf4\u660e\u62a5\u9519",{error:e}),E().showToast({title:"\u83b7\u53d6\u8f66\u7968\u8bf4\u660e\u5931\u8d25",duration:2e3,icon:"none"})}))}},{key:"loadSeatDetailConfig",value:function(){var e=this;I.Z.postAsync("/27207/systemConfig",{}).then((function(t){t.isSuccess;var a=t.routes,o=void 0===a?[]:a,i=e.state,n=i.loadingStatus,s=i.trainData;e.ticketExplains=o,o.length>0?1===n&&e.setState({ticketExplain:e.fetchTicketExplain(s,o)}):H.W.userTraceDetail("systemConfigFailure","\u8bf7\u6c42\u8f66\u7968\u914d\u7f6e\u5931\u8d25",{response:t,loadingStatus:n})})).catch((function(e){H.W.userTraceDetail("systemConfigError","\u8bf7\u6c42\u8f66\u7968\u914d\u7f6e\u62a5\u9519",{error:e})}))}},{key:"loadTrainDetail",value:function(){var e=this,t=this.model.solutionId;I.Z.postAsync("/27207/searchDetail",{outboundTravelSolutionId:t}).then((function(a){var o=a.isSuccess,n=a.outboundTravelSolution;if(o&&!(0,B.x)(n)){H.W.userTraceDetail("loadTrainDetailSuccess","\u8bf7\u6c42\u8be6\u60c5\u63a5\u53e3\u6210\u529f",{solutionId:t}),G.Z.tracePageExpose(R.Z.formatProductLine(n));var s=R.Z.formatScheduleCard(n),l=n.notices,r=void 0===l?[]:l,c=n.departureLocation,d=void 0===c?{}:c,u=n.arrivalLocation,m=void 0===u?{}:u,x=n.segments,h=void 0===x?[]:x,g=(0,i.Z)(h,1),f=g[0],p=void 0===f?{}:f,T=p.legs,S=void 0===T?[]:T,w=(0,i.Z)(S,1),v=w[0],y=void 0===v?{}:v,C=e.ticketExplains,k=void 0===C?[]:C,j=Y.Z.formatSeatTagsInfo(n),_=j.formatTags,N=j.minPriceFarePackage;e.noticeParams={location:"xPage",departLocationCode:d.locationCode,arrivalLocationCode:m.locationCode,suppliers:y.suppliers};var D=R.Z.formatTransferData(n);e.setState({cardInfo:s,loadingStatus:1,trainData:n,scheduleDetailInfo:D,formatTags:_,minPriceFarePackage:N,isShowReminderDialog:r.length>0,dialogContent:r,ticketExplain:e.fetchTicketExplain(n,k)},(function(){r.length>0&&H.W.userTraceDetail("openReminderDialog","\u6253\u5f00\u63d0\u9192\u5f39\u7a97",{notices:r})}))}else H.W.userTraceDetail("loadTrainDetailFailure","\u8bf7\u6c42\u8be6\u60c5\u63a5\u53e3\u5931\u8d25",{solutionId:t,response:a}),e.setState({loadingStatus:-1})})).catch((function(a){H.W.userTraceDetail("loadTrainDetailError","\u8bf7\u6c42\u8be6\u60c5\u63a5\u53e3\u62a5\u9519",{solutionId:t,error:a}),e.setState({loadingStatus:-1})}))}},{key:"renderTagSeatList",value:function(e){var t=this;if(!e)return(0,v.jsxs)(g.View,{className:h.errorLayout,children:[(0,v.jsx)(g.Image,{className:h.errorImage,src:U.Z.COMMON_LOAD_ERROR}),(0,v.jsx)(g.Text,{className:h.allText,children:"\u52a0\u8f7d\u5931\u8d25"})]});var a=this.state,o=a.minPriceFarePackage,i=a.currentSeatIndex,n=a.formatTags,s=this.model,l=s.searchAgeInfoList,r=s.passengerAgeRanges,c=R.Z.convertPassengerInfo2List(l,r).join("+");return(0,v.jsxs)(g.View,{className:h.seatListContainer,children:[(0,v.jsxs)(g.View,{className:h.ticketContainer,children:[(0,v.jsx)(p.o,{start:{x:0,y:1},end:{x:0,y:0},locations:[0,1],colors:["rgba(255,255,255,0.37)","rgb(255,255,255)"],className:h.ticketGradient}),(0,v.jsxs)(p.En,{className:h.passengerView,withFeedback:!0,onClick:function(){t.setState({isShowPriceTip:!0})},children:[(0,v.jsxs)(g.Text,{className:h.passengerText,children:["\u4ee5\u4e0b\u6309\u201c".concat(c,"\u201d\u9884\u4f30\u4f18\u60e0\u540e"),(0,v.jsx)(g.Text,{style:{color:"#ff5600"},children:"\u5747\u4ef7"})]}),(0,v.jsx)(f.Z,{className:h.passengerQIcon,children:"\ue013"})]}),(0,v.jsx)(g.View,{className:h.seatRow,children:n.map((function(e,a){var o=a===i?h.seatRowItemSelected:h.seatRowItem,n=a===i?"":" ".concat(h.seatNormalText),s=e.tagName,l=e.minPrice;return(0,v.jsxs)(p.En,{className:o,style:{marginLeft:0===a?0:8,elevation:a===i?0:4,shadowColor:"rgb(0,0,0)",shadowOpacity:.1},onClick:function(){var e=t.state.currentSeatIndex;e!==a&&(H.W.userTraceDetail("changeSeat","\u5207\u6362\u5750\u5e2d",{tagName:s,minPrice:l}),G.Z.seatTypeClick(s),t.setState({currentSeatIndex:a}))},children:[(0,v.jsx)(g.Text,{className:h.seatLevel+n,children:s}),(0,v.jsx)(w.ZP,{className:h.seatPrice+n,children:"\xa5".concat(l,"/\u4eba\u8d77")}),a===i&&(0,v.jsx)(g.Image,{className:h.seatRowItemChoice,src:U.Z.DETAIL_SEAT_CHOICE})]},a)}))})]}),n[i].tagPackageList.map((function(e,a){return(0,v.jsx)(D,{minPriceFarePackage:o,data:e,onBookClick:function(e){t.gotoBook(e,"1")},openRuleClick:function(e){var a=t.model,o=a.solutionId,i=a.searchAgeInfoList,n=t.state.trainData,s=G.Z.convertTraceObject({item:e,trainData:n,searchAgeInfoList:i});G.Z.informationClick(s),Y.Z.loadRefundDetail(0,o,e,H.W.userTraceDetail,(function(a){t.setState({isShowRefundRule:!0,refundRuleData:{itemPackage:e,ruleList:a}})}))}},a)})),(0,v.jsx)(g.Text,{className:h.allText,children:"\u5df2\u5c55\u793a\u5168\u90e8\u8f66\u6b21"})]})}},{key:"renderDetailBody",value:function(){var e=this,t=this.state,a=t.loadingStatus,o=t.currentSeatIndex,i=t.formatTags,n=t.cardInfo,s=t.ticketExplain;if(0===a)return(0,v.jsx)(g.View,{className:h.loadingContainer,children:(0,v.jsx)(p.gb,{style:{flex:1,height:"100%",width:"100%"}})});if(-1===a)return(0,v.jsx)(g.View,{className:h.errorContainer,children:(0,v.jsx)(F.Z,{errorCode:"-1001",retryClick:function(t){"retry"===t&&e.setState({loadingStatus:0},(function(){e.loadTrainDetail(),(0,B.x)(e.ticketExplains)&&e.loadSeatDetailConfig()}))}})});if(1===a){var l=i[o];return(0,v.jsxs)(g.ScrollView,{className:h.scrollView,scrollY:!0,showScrollbar:!1,showsVerticalScrollIndicator:!1,children:[(0,v.jsx)(g.View,{className:h.infoContainer,children:(0,v.jsx)(C,{cardInfo:n,showTransferSheet:function(){H.W.userTraceDetail("showTransferSheet","\u6253\u5f00\u8f66\u6b21\u8be6\u60c5"),G.Z.routeDetailClick(),e.setState({isShowTransferSheet:!0})}})}),!(0,B.x)(s)&&(0,v.jsxs)(p.En,{className:h.explainContent,onClick:function(){H.W.userTraceDetail("showSupplierModal","\u6253\u5f00\u7968\u79cd\u8bf4\u660e",{data:e.state.ticketExplain});var t=s.type,a=s.htmlString;"re"===t||"re_ntv"===t?(0,B.x)(a)?e.loadSeatHtml(s):e.setState({isShowSupplierModal:!0}):p.OB.getPlatform()===p.OB.PLATFORM_TYPE.Mini?p.Nd.navigateTo({url:"https://m.ctrip.com/webapp/eurail/activity/pages/eucoach.html?vendor=".concat(t),other:{pageTitle:{title:"\u7968\u79cd\u8bf4\u660e"}}}):e.setState({isShowSupplierModal:!0})},children:[(0,v.jsx)(f.Z,{className:h.explainTrainIcon,children:"\ue95d"}),(0,v.jsx)(g.Text,{className:h.explainText,children:s.tip}),(0,v.jsx)(f.Z,{className:h.explainArrow,children:"\ue944"})]}),this.renderTagSeatList(l),(0,v.jsx)(K.Z,{}),(0,v.jsx)(g.View,{style:{height:34}}),(0,v.jsx)(p.kd.Bottom,{})]})}}},{key:"render",value:function(){var e=this,t=this.state,a=t.isShowTransferSheet,o=t.scheduleDetailInfo,i=t.isShowSupplierModal,n=t.isShowRefundRule,s=t.refundRuleData,l=t.dialogContent,r=t.ticketExplain,c=t.isShowReminderDialog,d=void 0!==c&&c,u=t.isShowPriceTip,m=void 0!==u&&u,x=this.model,f=x.from,T=x.to,S=x.solutionId,w=x.priceTipsObj,y=void 0===w?{}:w;return(0,v.jsxs)(g.View,{className:h.pageContainer,children:[(0,v.jsx)(W.Z,{pageId:this.getPageId(),fromCity:f,toCity:T,noticeParams:this.noticeParams,onBackClick:function(){H.W.userTraceDetail("headerBack","\u5bfc\u822a\u9000\u51fa\u8be6\u60c5\u9875"),p.Nd.navigateBack()}}),(0,v.jsx)(g.View,{className:h.scrollWrapper,children:this.renderDetailBody()}),(0,v.jsx)(p.lI,{crnModalProps:{statusBarTranslucent:!0},visible:a,closeOnMaskClick:!0,onClose:function(){H.W.userTraceDetail("closeTransferSheet","\u5173\u95ed\u8f66\u6b21\u8be6\u60c5"),e.setState({isShowTransferSheet:!1})},children:(0,v.jsx)(Z.Z,{hideBottom:!0,scheduleDetailInfo:o,onClose:function(){H.W.userTraceDetail("closeTransferSheet","\u5173\u95ed\u8f66\u6b21\u8be6\u60c5"),e.setState({isShowTransferSheet:!1})}})}),(0,v.jsx)(p.lI,{crnModalProps:{statusBarTranslucent:!0},visible:i,closeOnMaskClick:!0,onClose:this.onCloseSupplierModal,children:(0,v.jsx)(M,{isShowSupplierModal:i,ticketExplain:r,onClose:this.onCloseSupplierModal})}),(0,v.jsx)(p.lI,{crnModalProps:{statusBarTranslucent:!0},visible:n,closeOnMaskClick:!0,onClose:this.onCloseRefundRule,children:(0,v.jsx)(O.Z,{gotoPolicyPage:function(t){e.setState({isShowRefundRule:!1},(function(){p.Nd.navigateTo({url:"/pages/trainAbroad/policy/index",data:{solutionId:encodeURIComponent(S),fareId:encodeURIComponent(t)}})}))},ticketData:s,onClose:this.onCloseRefundRule,onClickBook:function(t){e.setState({isShowRefundRule:!1},(function(){e.gotoBook(t,"2")}))}})}),(0,v.jsx)(p.lI,{crnModalProps:{statusBarTranslucent:!0},className:h.dialogBg,contentStyle:{display:"flex",justifyContent:"center",alignItems:"center"},visible:d,children:(0,v.jsx)(Q,{contents:l,onClose:this.onCloseReminderDialog})}),(0,v.jsx)(p.lI,{crnModalProps:{statusBarTranslucent:!0},closeOnMaskClick:!0,onClose:function(){e.setState({isShowPriceTip:!1})},visible:m,children:(0,v.jsx)(J.Z,{title:y.title,content:y.content,onClose:function(){e.setState({isShowPriceTip:!1})}})})]})}}]),a}(x.Z),ee={rnPageName:"euDetail",navigationBarTitleText:"\u9009\u62e9\u7968\u79cd",disableScroll:!0,customHeader:!0,navigationStyle:"custom"};Page((0,o.createPageConfig)($,"pages/trainAbroad/euDetail/index",{root:{cn:[]}},ee||{}))},79181:function(e){e.exports=require("../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../cwx/cwx")},65238:function(e){e.exports=require("../../../cwx/ext/global")}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[202,2107,1216,8592],(function(){return t(58355)}));e.O()}]);
//# sourceMappingURL=index.js.map