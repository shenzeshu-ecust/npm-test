"use strict";require("../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[1093],{32421:function(e,t,n){var i=n(32180),o=n(57042),a=n(24460),r=n(81876),s=n(21867),l=n(86066),d=n(45023),c=n(90201),u=n(70407),m={__next:"index-module_k6X_c",resultContainer:"index-module_yQYYh",loadingContainer:"index-module_zVfrP",scroll:"index-module_c6HEI",commonContainer:"index-module_TyAeb",commonTitle:"index-module_YGOvO",commonContent:"index-module_xuqoC",commonButtonContainer:"index-module_FxjKR",buttonSpacer:"index-module_J0eI9",commonButton:"index-module_ZK41O",commonButtonText:"index-module_AERrR",infoContainer:"index-module_Dwgqm",infoTitle:"index-module_H5NLn",infoRowCenter:"index-module_emwyP",infoText:"index-module_oNAlz",passengerContainer:"index-module_gKyO6",nameText:"index-module_h1PwC",genderContainer:"index-module_uGzzQ",genderText:"index-module_I1Vrg",foldButton:"index-module_j2s6T",foldText:"index-module_dl1HV",foldArrow:"index-module_ktzgY",infoLine:"index-module_Ag6fx",activityIcon:"index-module_G6E4a",dialogBg:"index-module_VOwHj"},x=n(71515),v=n(96930),h=n(45185),g=n(39441),f=n(43881),p=n(71559),N=n(31789),T=n(95392),w=(0,a.Z)((function e(){(0,o.Z)(this,e)}));(0,d.Z)(w,"getResultCommonContent",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.orderInfo,n=void 0===t?{}:t,i=n.orderStatus,o=n.orderStatusName,a=n.orderStatusDesc;return(0,N.x)(e)||(0,N.x)(n)||i===T.D.waitPay?{title:"\u8ba2\u5355\u5df2\u63d0\u4ea4",content:"\u8ba2\u5355\u5df2\u63d0\u4ea4\u3002\u6211\u4eec\u5c06\u901a\u8fc7\u77ed\u4fe1\u544a\u77e5\u60a8\u51fa\u7968\u8fdb\u5ea6\u548c\u7ed3\u679c\u3002\u51fa\u7968\u6210\u529f\u540e\uff0c\u8f66\u7968\u76f8\u5173\u4fe1\u606f\u5c06\u53d1\u9001\u81f3\u9884\u8ba2\u4eba\u90ae\u7bb1\uff0c\u8bf7\u60a8\u8010\u5fc3\u7b49\u5f85\u5e76\u6ce8\u610f\u67e5\u6536"}:{title:o,content:a}})),(0,d.Z)(w,"formatPassengerName",(function(e){if((0,N.x)(e)||-1===e.indexOf("/"))return e;var t=e.split("/").map((function(e){var t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)}));return"".concat(t[1]," ").concat(t[0])}));var Z=n(12111),C=n(14028),y=n(89838),_=n(4151),j={container:"index-module_FLic7"},D=n(92954),k=n.n(D),S=n(2269),I=k().getSystemInfoSync().windowHeight,P=k().getSystemInfoSync().windowWidth,b=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;(0,o.Z)(this,n),i=t.call(this,e),(0,d.Z)((0,r.Z)(i),"onMove",(function(e){var t=e.nativeEvent,n=t.pageX,o=t.pageY,a=(0,r.Z)(i),s=a.startX,l=void 0===s?0:s,d=a.startY,c=void 0===d?0:d,u=k().createAnimation({delay:0,timingFunction:"linear"});u.left(n-l).top(o-c).step({duration:10}),i.setState({animation:u.export()})})),(0,d.Z)((0,r.Z)(i),"onStart",(function(e){var t=e.touches[0],n=t.clientX,o=void 0===n?0:n,a=t.clientY,r=void 0===a?0:a;i.startX=o,i.startY=r})),(0,d.Z)((0,r.Z)(i),"onCancel",(function(e){var t=e.nativeEvent,n=t.pageX,o=t.pageY;i.handleEnd(n,o)})),(0,d.Z)((0,r.Z)(i),"onEnd",(function(e){var t=e.changedTouches[0],n=t.pageX,o=void 0===n?0:n,a=t.pageY,r=void 0===a?0:a;i.handleEnd(o,r)})),(0,d.Z)((0,r.Z)(i),"onLayout",(function(e){var t=(0,r.Z)(i),n=t.width,o=void 0===n?0:n,a=t.height,s=void 0===a?0:a;if(!(o>0||s>0)){var l=e.nativeEvent.layout,d=l.width,c=l.height;i.width=d,i.height=c;var u=k().createAnimation({delay:0,timingFunction:"linear"});u.left(P-d-16).top(I-c-80).step({duration:0}),i.setState({animation:u.export()})}}));var a=k().createAnimation({delay:0,timingFunction:"linear"});return a.left(-1e3).top(0).step({duration:0}),i.state={animation:a.export()},i}return(0,a.Z)(n,[{key:"handleEnd",value:function(e,t){var n=this.startX,i=void 0===n?0:n,o=this.startY,a=void 0===o?0:o,r=this.width,s=void 0===r?0:r,l=this.height,d=void 0===l?0:l,c=k().createAnimation({delay:0,timingFunction:"linear"});e-i+s/2>P/2?c.left(P-s-16):c.left(16),t-a<80?c.top(80):t-a>I-80?c.top(I-d-80):c.top(t-a),this.setState({animation:c.step({duration:200}).export()})}},{key:"render",value:function(){var e=this.state.animation,t=this.props.onClick;return(0,S.jsx)(f.AF.View,{className:j.container,onTouchMove:this.onMove,onTouchStart:this.onStart,onClick:t,onTouchCancel:this.onCancel,onTouchEnd:this.onEnd,animation:e,onLayout:this.onLayout,children:this.props.children})}}]),n}(c.Component),R={dialogWrapper:"index-module_LhzuZ",dialogContent:"index-module_J483E",bgImage:"index-module_o0BFg",content:"index-module_saB2c",detailRow:"index-module_u490v",detailIcon:"index-module_zD0MP",detailColumn:"index-module_QzItz",detailTitleRow:"index-module_w_bQD",detailTitle:"index-module_K1zOv",markContainer:"index-module_B_lLc",markText:"index-module_DmnO_",detailText:"index-module_NOCTM",reminderRow:"index-module_zN9SR",reminderTitle:"index-module_pIlQG",reminderImage:"index-module_gHL59",viewDetailButton:"index-module_OiaNS",viewDetailGradient:"index-module_fwGqW",viewDetailText:"index-module__Gn2I",closeButton:"index-module_sabYe",closeIcon:"index-module_mdJUR"},A=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,o.Z)(this,n),t.call(this,e)}return(0,a.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.onViewDetail,i=e.activityData,o=void 0===i?{}:i,a=o.backgroundImage,r=o.mainContent,s=void 0===r?[]:r,l=o.highlightHint,d=o.highlightHintIcon,c=o.viewDetailTitle;o.detailLink;return(0,S.jsxs)(x.View,{className:R.dialogWrapper,children:[(0,S.jsxs)(x.View,{className:R.dialogContent,children:[(0,S.jsx)(x.Image,{className:R.bgImage,src:a}),(0,S.jsxs)(x.View,{className:R.content,children:[s.map((function(e){var t=e.icon,n=e.title,i=e.remark,o=e.subtitle;return(0,S.jsxs)(x.View,{className:R.detailRow,children:[(0,S.jsx)(x.Image,{className:R.detailIcon,src:t}),(0,S.jsxs)(x.View,{className:R.detailColumn,children:[(0,S.jsxs)(x.View,{className:R.detailTitleRow,children:[(0,S.jsx)(x.Text,{className:R.detailTitle,children:n}),!N.Z.isEmpty(i)&&(0,S.jsx)(x.View,{className:R.markContainer,children:(0,S.jsx)(x.Text,{className:R.markText,children:i})})]}),(0,S.jsx)(x.Text,{className:R.detailText,children:o})]})]},n)})),(0,S.jsxs)(x.View,{className:R.reminderRow,children:[(0,S.jsx)(x.Text,{className:R.reminderTitle,children:l}),(0,S.jsx)(x.Image,{className:R.reminderImage,src:d})]}),(0,S.jsx)(f.En,{className:R.viewDetailButton,onClick:n,children:(0,S.jsx)(f.o,{className:R.viewDetailGradient,start:{x:0,y:.5},end:{x:1,y:.5},locations:[0,1],colors:["#2f5ee0","#6e8bff"],children:(0,S.jsx)(x.Text,{className:R.viewDetailText,children:c})})})]})]}),(0,S.jsx)(f.En,{className:R.closeButton,onClick:t,children:(0,S.jsx)(C.Z,{className:R.closeIcon,children:"\ueb57"})})]})}}]),n}(c.Component),B=n(99415),V=n(11478),L=n(80741),O=n(6980),E=n(46208),F=n(83090),Y=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;(0,o.Z)(this,n),i=t.call(this,e),(0,d.Z)((0,r.Z)(i),"loadActivity",(function(){g.Z.postAsync("/27207/json/activityNotice",{orderId:i.orderNumber}).then((function(e){var t=e.isSuccess,n=e.notice;t&&!(0,N.x)(n)&&i.setState({activityData:n,showActivityDialog:!0})})).catch((function(e){}))})),(0,d.Z)((0,r.Z)(i),"loadPassRecommend",(function(e){g.Z.postAsync("/18483/json/passRecommend",e).then((function(e){var t=e.isSuccess,n=e.recommends,o=void 0===n?[]:n,a=e.link;t&&!(0,N.x)(o)&&i.setState({passListLink:a,recommends:o})})).catch((function(e){}))})),(0,d.Z)((0,r.Z)(i),"expandedPassengers",(function(e){B.W.tracePayResult({action:"buttonClick",desc:e?"\u66f4\u591a\u4e58\u5ba2":"\u6536\u8d77"}),i.setState({expandedPassengers:e})})),(0,d.Z)((0,r.Z)(i),"renderResultView",(function(){var e=i.state,t=e.loadingStatus,n=e.recommends,o=e.passListLink;if(0===t)return(0,S.jsx)(x.View,{className:m.loadingContainer,children:(0,S.jsx)(f.gb,{})});var a=i.state.orderData,r=void 0===a?{}:a,s=w.getResultCommonContent(r);return(0,S.jsxs)(x.ScrollView,{className:m.scroll,showScrollbar:!1,showsVerticalScrollIndicator:!1,children:[(0,S.jsxs)(x.View,{className:m.commonContainer,children:[(0,S.jsx)(x.Text,{className:m.commonTitle,children:s.title}),(0,S.jsx)(x.Text,{className:m.commonContent,children:s.content}),(0,S.jsxs)(x.View,{className:m.commonButtonContainer,children:[(0,S.jsx)(f.En,{className:m.commonButton,onClick:function(){var e=i.model.pageFrom;B.W.tracePayResult({action:"buttonClick",desc:"\u518d\u8ba2\u4e00\u5f20",data:{pageFrom:e}}),v.Z.actionButtonClick("1"),p.Z.gotoPlatHome()},children:(0,S.jsx)(x.Text,{className:m.commonButtonText,children:"\u518d\u8ba2\u4e00\u5f20"})}),(0,S.jsx)(x.View,{className:m.buttonSpacer}),(0,S.jsx)(f.En,{className:m.commonButton,onClick:function(){var e=i.model.pageFrom;B.W.tracePayResult({action:"buttonClick",desc:"\u8ba2\u5355\u8be6\u60c5",data:{pageFrom:e}}),v.Z.actionButtonClick("2"),"order"===e?f.Nd.navigateBack():F.i.getOrderSwitch()?f.Nd.navigateTo({url:"/pages/trainAbroad/order/index",data:{orderNumber:i.orderNumber}}):f.Nd.navigateTo({url:"/rn_eurail_order/_crn_config?CRNModuleName=EurailOrder&CRNType=1&initialPage=orderdetail&orderid=".concat(i.orderNumber)})},children:(0,S.jsx)(x.Text,{className:m.commonButtonText,children:"\u8ba2\u5355\u8be6\u60c5"})})]})]}),i.renderBookInfo(r),!N.Z.isEmpty(n)&&(0,S.jsx)(y.Z,{passListLink:o,recommends:n}),(0,S.jsx)(_.Z,{})]})})),(0,d.Z)((0,r.Z)(i),"onViewActivityDetail",(function(){i.setState({showActivityDialog:!1,showFloatButton:!0},(function(){v.Z.activityDialogClick("1","red"),i.gotoActivityDetail("dialog")}))})),(0,d.Z)((0,r.Z)(i),"gotoActivityDetail",(function(e){"button"===e&&v.Z.activityButtonClick("red");var t=i.state.activityData,n=void 0===t?{}:t,o=n.detailLink;f.Nd.navigateTo({url:o})})),V.Z.initialLocale();var a=(0,D.getCurrentInstance)().router.params;return i.orderNumber=a.orderNumber,i.bizType=a.bizType,i.model={pageFrom:a.pageFrom},i.state={showPassengerLength:1,orderData:{},loadingStatus:0,expandedPassengers:!1},i}return(0,a.Z)(n,[{key:"getPageId",value:function(){return v.Z.getResultPageId(this.bizType)}},{key:"componentDidMount",value:function(){B.W.tracePayResult({action:"init",desc:"\u521d\u59cb\u5316\u8bf7\u6c42\u8ba2\u5355",data:{orderNumber:this.orderNumber}}),this.loadOrderDetail()}},{key:"loadOrderDetail",value:function(){var e=this;T.Z.loadOrderDetail(this.orderNumber).then((function(t){var n=t.isSuccess,i=t.orderInfo,o=t.scheduledPTPInfo;if(n&&!(0,N.x)(i)){B.W.tracePayResult({action:"getOrderDetailThen",desc:"\u8bf7\u6c42\u8ba2\u5355\u6210\u529f"}),e.setState({loadingStatus:1,orderData:t});var a=o.outSolution,r=void 0===a?{}:a,s=r.departureLocation,l=void 0===s?{}:s,d=r.arrivalLocation,c=void 0===d?{}:d;v.Z.tracePageExpose(V.Z.formatProductLine(r));var u={scene:"orderDetail",departureCityCode:null===l||void 0===l?void 0:l.geoId,departureStationCode:null===l||void 0===l?void 0:l.locationCode,arrivalCityCode:null===c||void 0===c?void 0:c.geoId,arrivalStationCode:null===c||void 0===c?void 0:c.locationCode};e.loadPassRecommend(u),e.loadActivity()}else B.W.tracePayResult({action:"getOrderDetailThen",desc:"\u8bf7\u6c42\u8ba2\u5355\u5931\u8d25",data:{response:t}}),e.setState({loadingStatus:-1})})).catch((function(t){B.W.tracePayResult({action:"getOrderDetailCatch",desc:"\u8bf7\u6c42\u8ba2\u5355\u62a5\u9519",data:{error:t}}),e.setState({loadingStatus:-1})}))}},{key:"renderBookInfo",value:function(e){var t=this;if((0,N.x)(e))return null;var n=e.scheduledPTPInfo,i=void 0===n?{}:n,o=e.passengers,a=void 0===o?[]:o,r=i.outSolution,s=r.departureDateTime,l=r.arrivalDateTime,d=r.departureLocation,c=r.arrivalLocation,u=(0,Z.Z)(s).format("MM\u6708DD\u65e5 ddd HH:mm"),v=(0,Z.Z)(l).format("HH:mm"),h=V.Z.getTicketInfoFromSolution(r)||{},g=h.classNameShow,p=h.classSeatShow,T=a.length,w=this.state.expandedPassengers,y=void 0!==w&&w,_=y?a:a.slice(0,1),j=(0,Z.Z)((0,Z.Z)(l).format(V.Z.DATE_FORMAT_YYYY_MM_DD)).diff((0,Z.Z)(s).format(V.Z.DATE_FORMAT_YYYY_MM_DD),"d"),D="".concat(u," - ").concat(v);return j>0&&(D+="(+".concat(j,"\u5929)")),(0,S.jsxs)(x.View,{className:m.infoContainer,children:[(0,S.jsx)(x.Text,{className:m.infoTitle,children:"\u9884\u8ba2\u4fe1\u606f"}),(0,S.jsxs)(E.ZP,{className:m.infoText,children:[D," \u5355\u7a0b"]}),(0,S.jsx)(x.Text,{className:m.infoText,children:"".concat(null===d||void 0===d?void 0:d.name," - ").concat(null===c||void 0===c?void 0:c.name)}),(0,S.jsxs)(x.View,{className:m.infoRowCenter,children:[(0,S.jsx)(x.Text,{className:m.infoText,children:g}),!(0,N.x)(p)&&(0,S.jsx)(x.View,{className:m.infoLine}),!(0,N.x)(p)&&(0,S.jsx)(x.Text,{className:m.infoText,children:p})]}),_.map((function(e,n){var i="".concat(O.Z.formatName(null===e||void 0===e?void 0:e.lastName)," ").concat(O.Z.formatName(null===e||void 0===e?void 0:e.firstName));return(0,S.jsxs)(x.View,{className:m.passengerContainer,children:[(0,S.jsx)(x.Text,{className:m.nameText,children:i}),(0,S.jsx)(x.View,{className:m.genderContainer,children:(0,S.jsx)(x.Text,{className:m.genderText,children:O.Z.formatGender(null===e||void 0===e?void 0:e.gender)})}),0===n&&T>1&&!y&&(0,S.jsxs)(f.En,{className:m.foldButton,onClick:function(){return t.expandedPassengers(!0)},children:[(0,S.jsx)(x.Text,{className:m.foldText,children:"\u66f4\u591a\u4e58\u5ba2"}),(0,S.jsx)(C.Z,{className:m.foldArrow,children:"\uee55"})]}),n===T-1&&T>1&&y&&(0,S.jsxs)(f.En,{className:m.foldButton,onClick:function(){return t.expandedPassengers(!1)},children:[(0,S.jsx)(x.Text,{className:m.foldText,children:"\u6536\u8d77"}),(0,S.jsx)(C.Z,{className:m.foldArrow,children:"\uee56"})]})]},n)}))]})}},{key:"render",value:function(){var e=this,t=this.state,n=t.showActivityDialog,i=void 0!==n&&n,o=t.showFloatButton,a=void 0!==o&&o,r=t.activityData;return(0,S.jsxs)(x.View,{className:m.resultContainer,children:[(0,S.jsx)(h.Z,{title:"\u9884\u8ba2\u5b8c\u6210",onBackClick:function(){B.W.tracePayResult({action:"headerBack",desc:"\u5bfc\u822a\u9000\u51fa\u5b8c\u6210\u9875"}),f.Nd.navigateBack()}}),this.renderResultView(),a&&(0,S.jsx)(b,{onClick:function(){return e.gotoActivityDetail("button")},children:(0,S.jsx)(x.Image,{className:m.activityIcon,mode:"aspectFit",src:L.Z.COMMON_ACTIVITY_FLOAT_ICON})}),(0,S.jsx)(f.lI,{crnModalProps:{statusBarTranslucent:!0},visible:i,className:m.dialogBg,children:(0,S.jsx)(A,{onViewDetail:this.onViewActivityDetail,activityData:r,onClose:function(){v.Z.activityDialogClick("2","red"),e.setState({showActivityDialog:!1,showFloatButton:!0})}})})]})}}]),n}(u.Z),M={rnPageName:"payResult",navigationBarTitleText:"\u9884\u8ba2\u5b8c\u6210",disableScroll:!0,customHeader:!0,navigationStyle:"custom"};Page((0,i.createPageConfig)(Y,"pages/trainAbroad/payResult/index",{root:{cn:[]}},M||{}))},79181:function(e){e.exports=require("../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../cwx/cwx")},65238:function(e){e.exports=require("../../../cwx/ext/global")}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[202,2107,1216,8592],(function(){return t(32421)}));e.O()}]);
//# sourceMappingURL=index.js.map