"use strict";require("../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[836],{97209:function(e,t,n){n.r(t),n.d(t,{handleAddSingleRelatedX:function(){return N},handleCheckSelectRelated:function(){return S},handleClearStore:function(){return w},handleRelatedX:function(){return C},initSingleRelatedX:function(){return y}});var a,i=n(79301),r=n(95308),s=n(76168),o=n(59542),c=s._,l=s.moment,u=o,d=u.getDateTimeFromServer,p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";return""===e||c.isEmpty(e)?"":l(d(e)).format(t)},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],a=[],i=[];return c.each(e,(function(e){var r=f(e,t);i.push(r.token),"relatedX"===c.get(r,"type","")&&a.push(r),"free"===c.get(r,"type","")&&n.push(r)})),{freeList:n,relatedXList:a,tokens:i}},f=function(e,t){var n=e.Basic,a=e.Shoppings,i=e.Token,r=e.ResourceRelations,s=void 0===r?[]:r,o=c.get(a,0,{}),u=o.MaxCount,d=o.MinCount,g=o.DefaultCount,f=o.SelectedCount,h=o.StepCount,m=o.UnitPrice,v=o.UseDate,x=c.get(a,a.length-1,{}),b=x.UseDate,T=p(v),I=p(v,"YYYYMMDD"),k=p(b,"YYYYMMDD"),_=l(p(v)).valueOf(),w=l(p(b)).valueOf(),C=n.ResourceName,S=n.BMStatus,y=n.ChargeUnit,P=n.CategoryId,N=n.CityId,j=n.CityName,Z=n.Description,F=n.CategoryName,D=n.Tags,L=void 0===D?[]:D,R=m.Price,E=m.Original,M=m.TradePrice,V=m.OriginalTradePrice,O={};c.each(a,(function(e){var t=c.get(e,["UnitPrice","Price"],0),n=p(c.get(e,["UseDate"],""),"YYYYMMDD");O[n]={title:"\xa5".concat(t),disable:!1,highligtTitle:!0}}));var H=[],q=!1,A=!1;s.forEach((function(e){1===e.RelationType&&(H.push(e.ResourceRelationID),q=!0),2===e.RelationType&&(H.push(e.ResourceRelationID),A=!0)}));var B=0;B=t?f:g;var U="";return H.length>0?U="relatedX":0===H.length&&0===R&&51!==P&&(U="free"),{cityId:N,cityName:j,categoryName:F,relatedIds:H,isFlightRelated:q,isRoomRelated:A,type:U,token:i,categoryId:P,name:C,useDate:T,useStartStr:I,useEndStr:k,useStartTimer:_,useEndTimer:w,useDateInfo:O,price:R,tradePrice:M,originalPrice:E,originTradePrice:V,unit:y,min:d,max:u,step:h,count:B,tags:L,defaultCount:g,description:Z,isRequired:1===(1&S),isDateRequired:4===(4&S),isDefaultRequired:16===(16&S)}},h=n(76346),m=n(96086),v=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(t,n){var a,r,o,c,l,u,d,p,g,f,h,m=arguments;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=m.length>2&&void 0!==m[2]?m[2]:[],r=m.length>3?m[3]:void 0,o=m.length>4?m[4]:void 0,c=m.length>5?m[5]:void 0,l=m.length>6?m[6]:void 0,!s._.isEmpty(a)){e.next=7;break}return e.abrupt("return",{});case 7:return e.prev=7,e.next=10,x(t,n,a,r,o,c);case 10:if(e.t0=e.sent,e.t0){e.next=13;break}e.t0={};case 13:return u=e.t0,d=u.isTimeOut,p=void 0!==d&&d,g=u.XItems,f=void 0===g?[]:g,h=s._.sortBy(f,(function(e){var t=e.isRequire,n=e.resourceItem.basic.defaultCount;return t?1:n?2:3})),l({code:"shoppingCart-RelatedX-SearchX-res",type:1,desc:{relatedXList:h,shoppingId:t}}),e.abrupt("return",{isTimeOut:p,relatedXList:h});case 23:return e.prev=23,e.t1=e["catch"](7),console.log(e.t1),e.abrupt("return",{isTimeOut:!0,relatedXList:[]});case 27:case"end":return e.stop()}}),e,null,[[7,23]])})));return function(t,n){return e.apply(this,arguments)}}(),x=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(t,n){var o,c,l,u,d,p,g,f,h,v,x,T,I,k,_,w,C,S=arguments;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=S.length>2&&void 0!==S[2]?S[2]:[],c=S.length>3?S[3]:void 0,l=S.length>4?S[4]:void 0,u=S.length>5?S[5]:void 0,d=c,p=d.startDate,g=void 0===p?"":p,f=d.endDate,h=void 0===f?"":f,v=o.map((function(e){return{RelationId:e,RelationType:"hotel"===l?2:1,StartDate:g,EndDate:h}})),x=s.GraphqlClient.gql(a||(a=(0,m.Z)(["\n            query GetOptionX($params: GetOptionXParams){\n                OptionX(params: $params){\n                    ShoppingOptionXs\n                    OptionXData{\n                        isDateRequired\n                        isRoomRelated\n                        isFlightRelated\n                        isRequire\n                        resourceItem{\n                            token\n                            resourceType\n                            calendarInfo\n                            relatedIds\n                            basic{\n                                name\n                                price\n                                tradePrice\n                                unit\n                                maxCount\n                                minCount\n                                stepCount\n                                defaultCount\n                                defaultUseDate\n                                guardUseDate\n                                description\n                                tags\n                                resourceId\n                            }\n                        }\n                    }\n                }\n            }\n        "]))),T={ActionType:10,ShoppingId:t,ResourceType:"relatedX",Platform:u,ResourceRelations:v,IsNeedDetail:!0},e.prev=8,e.next=11,Promise.race([new Promise(function(){var e=(0,r.Z)((0,i.Z)().mark((function e(t){var a;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n(x,T);case 2:a=e.sent,t(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),b()]);case 11:if(e.t0=e.sent,e.t0){e.next=14;break}e.t0={};case 14:return I=e.t0,k=I.isTimeOut,_=void 0!==k&&k,w=I.OptionX,C=void 0===w?{}:w,e.abrupt("return",{isTimeOut:_,XItems:(null===C||void 0===C?void 0:C.OptionXData)||[]});case 22:return e.prev=22,e.t1=e["catch"](8),console.log("load relatedX error",e.t1),e.abrupt("return",{isTimeOut:!0,XItems:[]});case 26:case"end":return e.stop()}}),e,null,[[8,22]])})));return function(t,n){return e.apply(this,arguments)}}(),b=function(){return new Promise((function(e){setTimeout((function(){e({isTimeOut:!0,OptionX:{}})}),1e4)}))},T=function(e){var t=I(e);if(0!==t.length)return{isPass:!1,incompleteInfoRes:t,selectResourceList:[]};var n=[];return e.forEach((function(e){var t=e.isRequire,a=e.resourceItem,i=void 0===a?{}:a,r=i,o=r.token,c=r.basic,l=void 0===c?{}:c,u=l,d=u.defaultCount,p=u.defaultUseDate;(t||0!==d&&!s._.isEmpty(p))&&n.push({Count:d,Token:o,UseDate:p,UseEndDate:p})})),{isPass:!0,selectResourceList:n,incompleteInfoRes:[]}},I=function(e){var t=[];return e.forEach((function(e){var n=e.isRequire,a=e.resourceItem,i=void 0===a?{}:a,r=i,o=r.token,c=r.basic,l=void 0===c?{}:c,u=l,d=u.defaultCount,p=u.defaultUseDate;(n&&(0===d||s._.isEmpty(p))||0!==d&&s._.isEmpty(p))&&t.push(o)})),t},k=n(32180)["window"],_=h.Hq.XSEARCH,w=function(e){var t=e.actions;t.setPageFlag({showSkeletonPage:!1,showPageEmpty:!1,showPartialLoading:!1,showLoading:!1,showFlightInfoMask:!1,showTransferInfoMask:!1,showCabinFareRemark:!1,showNoticeModalPanel:!1,showCabinFareRemarkLoading:!1,showCabinFareRemarkLoadingFail:!1}),t.setPageParams({}),t.setTempData({cabinMaskReloadCache:{},cabinMaskInfo:{},planeDetailMaskInfo:{},transferMaskInfo:{},noticeModalInfo:{}}),t.setPageData({defaultFlightInfo:[],CabinListVMInfo:{},segmentTipsCardInfo:[],cabinListDictionary:{}})},C=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(t){var n,a,r,o,c,l,u,d,p,g,f,h,m,x,b,T,I,_,w,C,S,y,P,N;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.store,a=t.context,t.request,r=t.graphqlFetch,o=t.params,c=t.actions,l=n.getState(),l.CabinListVMInfo,u=l.pageParams,d=void 0===u?{}:u,p=a.pageType,g=a.traceEventLog,f="H5"===p?"h5":"PC"===p?"online":"rn",[],h=c.setPageData,m=c.setPageFlag,x=c.setTempData,b=d,T=b.shoppingId,I=b.chooseSingleResource,_=s._.get(o,"cabinObj",{}),x({cabinObj:_}),w=_.vacationItemIDs,C=void 0===w?[]:w,"1"===I){e.next=12;break}return e.abrupt("return",!1);case 12:return e.next=14,v(T,r,C,{startDate:"",endDate:""},"flight",f,g);case 14:if(e.t0=e.sent,e.t0){e.next=17;break}e.t0={};case 17:if(S=e.t0,y=S.isTimeOut,P=S.relatedXList,y||s._.isEmpty(P)){e.next=27;break}return h({showRelatedXList:P}),m({showRelatedXListMask:!0}),null!==(N=k)&&void 0!==N&&null!==(N=N.document)&&void 0!==N&&N.body&&(k.document.body.style.cssText="overflow: hidden;height: 100%;"),e.abrupt("return",!0);case 27:return e.abrupt("return",!1);case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(t){var n,a,r,s,o,c,l;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.store,t.context,t.request,n=t.actions,a=t.showRelatedXList,e.next=3,T(a);case 3:return r=e.sent,s=r.isPass,o=r.incompleteInfoRes,c=r.selectResourceList,l=void 0===c?[]:c,s?n.setTempData({selectResourceList:l}):n.setTempData({incompleteInfoRes:o}),e.abrupt("return",s);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(t){var n,a,r,o,c,l,u,d,p,f,h,m,v;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.shoppingId,a=t.request,r=t.ids,o=void 0===r?[]:r,c=t.type,!s._.isEmpty(o)){e.next=3;break}return e.abrupt("return",{});case 3:return e.next=5,P(n,a,o,c);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:return l=e.t0,u=l.isTimeOut,d=void 0!==u&&u,p=l.XItems,f=void 0===p?[]:p,h=[],d||(m=g(f),v=m.relatedXList,h=v),e.abrupt("return",{isTimeOut:d,relatedXList:h});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(t,n){var a,s,o,c,l,u,d,p,g=arguments;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=g.length>2&&void 0!==g[2]?g[2]:[],s=g.length>3?g[3]:void 0,o=a.map((function(e){return{ResourceRelationID:e,ResourceRelationType:"hotel"===s?2:1}})),e.prev=3,e.next=6,Promise.race([new Promise(function(){var e=(0,r.Z)((0,i.Z)().mark((function e(a){var r;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n(_,{ShoppingId:t,ActionType:7,ResourceRelations:o});case 2:r=e.sent,a(r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Z()]);case 6:if(e.t0=e.sent,e.t0){e.next=9;break}e.t0={};case 9:return c=e.t0,l=c.isTimeOut,u=void 0!==l&&l,d=c.XItems,p=void 0===d?[]:d,e.abrupt("return",{isTimeOut:u,XItems:p});case 17:return e.prev=17,e.t1=e["catch"](3),e.abrupt("return",{isTimeOut:!0,XItems:[]});case 20:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(t,n){return e.apply(this,arguments)}}(),N=function(e){var t=j(e);if(0!==t.length)return{isPass:!1,incompleteInfoRes:t,selectResourceList:[]};var n=[];return e.forEach((function(e){var t=e.count,a=e.useDate,i=e.isRequired,r=e.token;(i||0!==t&&!s._.isEmpty(a))&&n.push({Count:t,Token:r,UseDate:a,UseEndDate:a})})),{isPass:!0,selectResourceList:n,incompleteInfoRes:[]}},j=function(e){var t=[];return e.forEach((function(e){var n=e.isRequired,a=e.count,i=e.useDate,r=e.token;(n&&(0===a||s._.isEmpty(i))||0!==a&&s._.isEmpty(i))&&t.push(r)})),t},Z=function(){return new Promise((function(e){setTimeout((function(){e({isTimeOut:!0,XItems:[]})}),1e4)}))}},59542:function(e,t,n){n.r(t),n.d(t,{getDateTimeFromServer:function(){return s},getUTCMomentFromServer:function(){return o},parseMinuteToHourAndMinuteString:function(){return c},formatScheduleTime:function(){return l},formatDateString:function(){return u}});var a=n(90129),i=n(76168),r=i.moment,s=function(e){var t=/^\/Date\(([-]?\d+)[+-]?[0-9]{4}\)\/$/,n=/^([0-9]{4}-[0-9]{2}-[0-9]{2})[T,' '][0-9]{2}:[0-9]{2}:[0-9]{2}/,a=e.match(t),i=e.match(n);return null!==a&&void 0!==a&&a[1]&&"-62135596800000"!==a[1]?r.utc(parseInt(a[1],0)).utcOffset(8):null!==i&&void 0!==i&&i[1]&&"0001-01-01"!==i[1]?r.utc(e.substr(0,19)):void 0},o=s,c=function(e,t){var n=parseInt(String(e/60/24),10),a=parseInt(String(e/60%24),10),i=parseInt(String(e%60),10),r="",s="",o="CN"===t?"\u5c0f\u65f6":"h",c="CN"===t?"\u5206\u949f":"m";return(n||a>0)&&(r="".concat(24*n+a).concat(o)),i>0&&(s="".concat(i).concat(c)),"".concat(r).concat(s)},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=s(e);return null!==n&&void 0!==n&&n.format?"".concat(n.format("M\u6708D\u65e5")).concat(t?"":" ".concat(n.format("HH:mm"))):""},u=function(e){var t=e.split("-"),n=(0,a.Z)(t,3),i=n[1],r=n[2];return"".concat(parseInt(i,10),"\u6708").concat(parseInt(r,10),"\u65e5")}},16103:function(e,t,n){var a={};n.r(a),n.d(a,{setPageData:function(){return ge},setPageFlag:function(){return fe},setPageParams:function(){return he},setTempData:function(){return me}});var i={};n.r(i),n.d(i,{setHeaderInfo:function(){return Ze},updateShoppingCartConfig:function(){return De},updateShowTradePrice:function(){return Fe}});var r,s,o=n(32180),c=n(93212),l=n(57042),u=n(24460),d=n(81876),p=n(21867),g=n(86066),f=n(45023),h=n(298),m=n(76168),v=n(71515),x=n(75573),b=n(79301),T=n(95308),I=n(49762),k=n(22276),_=n(96086),w=n(76346),C=n(59542),S=n(59172),y=n(93204),P={ECONOMY:"\u7ecf\u6d4e\u8231",BUSINESS:"\u516c\u52a1\u8231",FIRST:"\u5934\u7b49\u8231",PREMIUM:"\u8d85\u7ea7\u7ecf\u6d4e\u8231"},N=m._,j="diy_flight_list_selectsub",Z="diy_flight_seat_expose",F=function(e){return function(t){try{var n;if(N.isEmpty(e))return null;var a=!1,i=[];null===(n=e.cabinList)||void 0===n||n.forEach((function(e){var t=e.originFlightSeats,n=void 0===t?[]:t;n.forEach((function(e){var t=e.RelatedFlights,n=void 0===t?[]:t,a=e.FlightSourceType;"Vacation"===a&&n.forEach((function(e){var t=e.FlightId,n=e.SegmentId;i.push({segmentId:t,flightId:n})}))}))}));var r=[];N.forEach(e.flightList,(function(e){var t=e.flightInfoList,n=void 0===t?[]:t,s=e.segmentId;N.forEach(n,(function(e,t){var o=e.stopStations,c=void 0===o?[]:o,l=N.get(e,"flightNo"),u=N.get(e,"airlineName"),d=N.get(e,"flightId"),p="",g="";(N.get(e,"carrier")||N.get(e,"carrierNo"))&&(g=N.get(e,"carrier"),p=N.get(e,"carrierNo"));var f=N.get(e,"departSchedule.cityId"),h=N.get(e,"arriveSchedule.cityId"),m=N.get(e,"departSchedule.scheduleTime"),v=N.get(e,"arriveSchedule.scheduleTime"),x=N.get(e,"punctualityRate",""),b=[],T=[];c&&!N.isEmpty(c)&&N.forEach(c,(function(e){b.push(e.cityName),T.push(e.duration)}));var I=b.join(","),k=T.join(","),_=0,w=0;1===n.length?(_=1,w=1):(0===t&&(_=1),t===n.length-1&&(w=1)),N.isEmpty(i)||N.each(i,(function(e){Number(e.segmentId)===Number(s)&&Number(e.flightId)===Number(d)&&(a=!0)})),r.push({rmk:s,segment:s,no:d,fltno:l,airline:u,sharedflt:p,sharedairline:g,startcityid:f,arrivecityid:h,departtime:m,arrivetime:v,ontimerate:x,stopcity:I,stoptime:k,first_seq:_,last_seq:w,is_pflt:a})}))})),t(Z,{flightlist:r})}catch(e){}}},D=function(e){return function(t){var n=e.briefFareRemark,a=void 0===n?{}:n,i=e.unrestrainedTag,r=void 0===i?{}:i,s=e.restrainedTag,o=void 0===s?{}:s,c=e.brieBaggageLimit,l=void 0===c?{}:c,u=N.map(N.keys(o),(function(e){return o[e]})),d=N.map(N.keys(r),(function(e){return r[e]})),p=l.CHECK,g=l.HANDLE;p.baggageBrief&&u.push(p.baggageBrief),g.baggageBrief&&u.push(g.baggageBrief),t.refund="".concat(a.minFundFee||""," ").concat(a.minBookFee||""),t.restrict=u,t.instrict=d,t.transitvisa=o.transitVisa?"YES":"NO"}},L=function(e){var t=e.data,n=e.savePriceType,a=e.passengerNum;return function(e){try{var i=t.showPrice,r=t.cabinClass,s=t.seatCount,o=(t.cabinIndex,t.classInfo),c=t.flightList,l=void 0===c?[]:c,u=t.reduceType,d=t.unitReducePrice,p=t.isIntl,g=t.flightPrice,f=void 0===g?{}:g,h=t.flightSeats,m=void 0===h?[]:h,v=t.cabin,x=N.get(l,[0])||{},b=l[l.length-1]||{},T={refund:"",restrict:"",instrict:"",transitvisa:""};D(v)(T);var I=!0;N.forEach(o,(function(e){N.keys(e).length>0&&(I=!1)}));var k=[],_={},w=[];N.forEach(l,(function(e){var t=e.flightInfoList,n=void 0===t?[]:t,a=e.segmentId;_[a]||(_[a]={}),N.forEach(n,(function(e){var t=e.flightId,n=e.flightNo,i=e.carrierNo;_[a][t]=n,k.push({segmentid:a,flightid:t,flightno:n,carrierno:i||""})}))})),N.each(m,(function(e){var t=e.RelatedFlights,n=void 0===t?[]:t,a=e.FlightSourceType,i=!1;"Vacation"===a&&(i=!0),N.each(n,(function(e){var t=e.SubClass,n=void 0===t?"":t,a=e.SegmentId,r=e.FlightId,s=e.Grade,o=void 0===s?"":s;w.push({fltno:N.get(_,[a,r]),subclass:n,class:N.get(P,[o]),is_pkgflt:i})}))}));var C=0,S=0,y=0,Z=f.Adult,F=void 0===Z?{}:Z,L=f.Child,R=void 0===L?{}:L,E=f.Infant,M=void 0===E?{}:E;N.isEmpty(F)||(C=p?F.Price+F.Oil+F.Tax:F.Price),N.isEmpty(R)||(S=p?R.Price+R.Oil+R.Tax:R.Price),N.isEmpty(M)||(y=p?M.Price+M.Oil+M.Tax:M.Price);var V="0";"CHEAPER_PRICE"===n&&(V="1"),"SPECIAL_PRICE"===n&&(V="2");var O={"sales-label":u,money:d};e(j,{pagebu:"dp2.0",totalprice:i,subclass:r.join(","),num:s,isdrct:I,expolist:T,fltinfo:k,discount_label:V,startdate:N.get(x,"briefFlight.departDateTime"),stcityname:N.get(x,"briefFlight.departCityName"),dtcityname:N.get(b,"briefFlight.arriveCityName"),flightclass_list:w,sales_label:O,headcount:a.passengerCount,adultnum:a.altCount,adultprice:C,childnum:a.cldCount,childprice:S,infantnum:a.iftCount,infantprice:y})}catch(e){}}},R=function(e){return function(t){t("diy_multicabin_error_cabinnodata",(0,h.Z)({},e))}},E=function(e,t){return function(n){try{var a=e.showPrice,i=e.cabinClass,r=e.seatCount,s=e.cabin,o=e.savePriceType,c=e.isIntl,l=e.flightSeats,u=void 0===l?[]:l,d=e.CabinListVMInfo,p=void 0===d?{}:d,g=e.reduceType,f=e.unitReducePrice,h=e.flightPrice,m=void 0===h?{}:h,v=[],x={},b=p.flightList,T=void 0===b?[]:b;N.each(T,(function(e){var t=e.segmentId,n=e.flightInfoList,a=void 0===n?[]:n;x[t]||(x[t]={}),N.each(a,(function(e){var n=e||{},a=e.flightId;x[t][a]=N.get(n,"flightNo")}))})),N.each(u,(function(e){var t=e.RelatedFlights,n=void 0===t?[]:t,a=e.FlightSourceType,i=!1;"Vacation"===a&&(i=!0),N.each(n,(function(e){var t=e.SubClass,n=void 0===t?"":t,a=e.SegmentId,r=e.FlightId,s=e.Grade,o=void 0===s?"":s;v.push({fltno:N.get(x,[a,r]),subclass:n,class:N.get(P,[o]),is_pkgflt:i})}))}));var I={refund:"",restrict:"",instrict:"",transitvisa:""},k="0";"CHEAPER_PRICE"===o&&(k="1"),"SPECIAL_PRICE"===o&&(k="2");var _={"sales-label":g,money:f},w=0,C=0,S=0,y=m.Adult,j=void 0===y?{}:y,F=m.Child,L=void 0===F?{}:F,R=m.Infant,E=void 0===R?{}:R;N.isEmpty(j)||(w=c?j.Price+j.Oil+j.Tax:j.Price),N.isEmpty(L)||(C=c?L.Price+L.Oil+L.Tax:L.Price),N.isEmpty(E)||(S=c?E.Price+E.Oil+E.Tax:E.Price),D(s)(I),n(Z,{pagebu:"dp2.0",totalprice:a,subclass:i.join(","),num:r,expolist:I,discount_label:k,is_overseas:c?0:1,flightclass_list:v,sales_label:_,headcount:t.passengerCount,adultnum:t.altCount,adultprice:w,childnum:t.cldCount,childprice:C,infantnum:t.iftCount,infantprice:S})}catch(e){}}},M=m._,V=function(e){return function(){var t=(0,T.Z)((0,b.Z)().mark((function t(n,a,i,r,s){var o,c,l,u,d,p,g,f,h,m,v,x,T,k,_,w,C,S,y,P,N,j;return(0,b.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s("100023026:booking_switch");case 2:if(o=t.sent,c=o.bookingResource,l=void 0===c||c,!l){t.next=46;break}return u={shoppingId:e.shoppingId,Tags:[{Key:"PageType",Value:"MoreSeat"}],ShoppingDetailUpdateRequest:{IsShoppingDetailUpdate:!0,ResourceType:1,SelectedResources:e.targetCabinTokenList}},t.prev=7,t.next=10,(0,I.gK)(u)({urlQuery:i,graphqlFetch:r});case 10:if(d=t.sent,p=d.AddShoppingAndBook,g=void 0===p?{}:p,f=g.isSuccess,h=g.message,void 0===h?"":h,g.type,m=g.ShoppingUpdateInfo,v=void 0===m?{}:m,x=v.ResourceStatus,T=void 0===x?{}:x,!f){t.next=18;break}return t.abrupt("return",v);case 18:return H({traceLog:a,ResourceStatus:T}),t.next=21,A(g);case 21:return k=t.sent,t.abrupt("return",{updateFail:!0,formarError:k});case 23:t.next=44;break;case 25:if(t.prev=25,t.t0=t["catch"](7),H({traceLog:a,ResponseStatus:t.t0.ResponseStatus}),!t.t0.ResponseStatus||"Success"!==t.t0.ResponseStatus.Ack&&"Warning"!==t.t0.ResponseStatus.Ack){t.next=39;break}if(!t.t0.Data||!t.t0.Data.IsSuccess){t.next=33;break}return t.abrupt("return",!0);case 33:return t.next=35,A(t.t0);case 35:return _=t.sent,t.abrupt("return",{name:"",message:"",updateFail:!0,formarError:_});case 37:t.next=44;break;case 39:if(!t.t0.updateFail){t.next=43;break}throw t.t0;case 43:throw new Error("timeout");case 44:t.next=83;break;case 46:return w={ShoppingId:e.shoppingId,ShoppingDetailUpdateRequest:{IsShoppingDetailUpdate:!0,ResourceType:1,SelectedResources:e.targetCabinTokenList}},t.prev=47,t.next=50,(0,I.IK)(w)(n,i);case 50:if(C=t.sent,S=C.Data,y=C.ResponseStatus,!S.IsSuccess){t.next=57;break}return P=S.ShoppingUpdateInfo,t.abrupt("return",P);case 57:return O({traceLog:a,ResponseStatus:y}),t.next=60,q(S);case 60:return N=t.sent,t.abrupt("return",{updateFail:!0,formarError:N});case 62:t.next=83;break;case 64:if(t.prev=64,t.t1=t["catch"](47),O({traceLog:a,ResponseStatus:t.t1.ResponseStatus}),!t.t1.ResponseStatus||"Success"!==t.t1.ResponseStatus.Ack&&"Warning"!==t.t1.ResponseStatus.Ack){t.next=78;break}if(!t.t1.Data||!t.t1.Data.IsSuccess){t.next=72;break}return t.abrupt("return",!0);case 72:return t.next=74,q(t.t1);case 74:return j=t.sent,t.abrupt("return",{name:"",message:"",updateFail:!0,formarError:j});case 76:t.next=83;break;case 78:if(!t.t1.updateFail){t.next=82;break}throw t.t1;case 82:throw new Error("timeout");case 83:case"end":return t.stop()}}),t,null,[[7,25],[47,64]])})));return function(e,n,a,i,r){return t.apply(this,arguments)}}()},O=function(e){var t=e.traceLog,n=e.ResponseStatus,a=n.Errors,i=void 0===a?[]:a;if(i.length){var r=i[0],s=r.ErrorCode,o=r.Message;t(s,{Message:o})}},H=function(e){var t=e.traceLog,n=e.ResponseStatus;if(null!==n&&void 0!==n&&n.length){var a=n[0].Desc;t("vac_10039",{Desc:a})}},q=function(){var e=(0,T.Z)((0,b.Z)().mark((function e(t){var n,a;return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={title:"",bottomTitle:"",contentList:[]},a=M.get(t,["ShoppingUpdateInfo","SupplyList"])||[],a.length>0?(n.contentList=[],a.forEach((function(e){100===e.Key?(n.title="\u822a\u73ed\u53ef\u80fd\u6709\u53d8\uff0c\u4e3a\u60a8\u91cd\u65b0\u67e5\u8be2",n.bottomTitle="\u786e\u8ba4"):(n.contentList.push(e.Value),n.bottomTitle="\u6211\u77e5\u9053\u4e86")}))):(n.title="\u822a\u73ed\u53ef\u80fd\u6709\u53d8\uff0c\u4e3a\u60a8\u91cd\u65b0\u67e5\u8be2",n.bottomTitle="\u786e\u8ba4"),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=(0,T.Z)((0,b.Z)().mark((function e(t){var n,a;return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={title:"",bottomTitle:"",contentList:[]},a=M.get(t,["ShoppingUpdateInfo","ResourceStatus"])||[],a.length>0?(n.title="\u822a\u73ed\u53ef\u80fd\u6709\u53d8\uff0c\u4e3a\u60a8\u91cd\u65b0\u67e5\u8be2",n.bottomTitle="\u6211\u77e5\u9053\u4e86",n.contentList=[],a.forEach((function(e){"flight"===e.ResourceType&&(n.title="\u822a\u73ed\u53ef\u80fd\u6709\u53d8\uff0c\u4e3a\u60a8\u91cd\u65b0\u67e5\u8be2",n.bottomTitle="\u786e\u8ba4")}))):(n.title="\u822a\u73ed\u53ef\u80fd\u6709\u53d8\uff0c\u4e3a\u60a8\u91cd\u65b0\u67e5\u8be2",n.bottomTitle="\u786e\u8ba4"),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=n(22731),U=n(32180)["window"],X=w.Hq.GET_SHOPPING_DETAIL,Y=(w.Hq.FLIGHT_SEAT_SEARCH,w.Hq.INTERNATIONAL_REMARK_SEARCH,w.Hq.INTERNATIONAL_EXTEND_SEARCH,w.Hq.DOMESTIC_REMARK_SEARCH,w.Hq.BookingResource,w.Hq.XSEARCH,w.Hq.SEARCH_FLIGHT_HORN_CONTENT),G=function(e){var t=e.actions,n=e.context,a=n.urlQuery,i=n.pageType,r=void 0===i?"":i,s=e.paramsFromOnline,o="tour_channel"===(null===a||void 0===a?void 0:a.sourcefrom),c="customtravel"===(null===a||void 0===a?void 0:a.sourcefrom),l="qunar"===(null===a||void 0===a?void 0:a.sourcefrom);"PC"===r?(t.setPageParams((0,h.Z)((0,h.Z)({},s),{},{isTour:o,isDingZhi:c,isQunar:l})),t.setPageData({defaultFlightInfo:null===s||void 0===s?void 0:s.defaultFlightInfo})):t.setPageParams((0,h.Z)((0,h.Z)({},(0,S.Gi)(a)),{},{isTour:o,isDingZhi:c,isQunar:l}),"setSourcefrom",{jsonData:[{key:"\u662f\u5426\u662f\u8ddf\u56e2",value:o},{key:"\u662f\u5426\u662f\u5b9a\u5236",value:c},{key:"\u662f\u5426\u662f\u53bb\u54ea\u513f",value:l}]})},K=function(e){var t=e.flagName,n=e.actions;n.setPageFlag((0,f.Z)({},t,!1))},Q=function(){var e=(0,T.Z)((0,b.Z)().mark((function e(t){var n,a,i,r,s,o,c,l;return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.context,a=void 0===n?{}:n,i=t.store,r=i.getState(),s=r.pageFlag.hasPreload,o=a,c=o.pageType,l=o.urlQuery,!s){e.next=7;break}ne(t),e.next=12;break;case 7:if("PC"===c){e.next=10;break}return e.next=10,z(t);case 10:"PC"===c&&null!==l&&void 0!==l&&l.locale&&"zh-CN"!==(null===l||void 0===l?void 0:l.locale)||pe(t),ne(t);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=(0,T.Z)((0,b.Z)().mark((function e(t){var n,a,i,r;return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.context,a=void 0===n?{}:n,i=a,r=i.pageType,G((0,h.Z)((0,h.Z)({},t),{},{paramsFromOnline:{}})),"PC"===r){e.next=6;break}return e.next=6,z((0,h.Z)((0,h.Z)({},t),{},{ssr:!0}));case 6:return e.next=8,pe(t);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(e,t){var n={},a={};return e.Flights&&e.Flights.length>0&&m._.forEach(e.Flights,(function(e){a[e.FlightId]=(0,h.Z)({},e)})),n=J(a,t.getShark),n},J=function(e,t){var n={},a=m._.keys(e).length,i=e[m._.keys(e)[0]],r=m._.get(i,"DepartInfo.DateTime"),s=r?(0,C.getDateTimeFromServer)(r):"";n.departDateTime=s?(0,m.moment)(s).format("YYYY-MM-DD HH:mm:ss"):"",n.departTime=s?(0,m.moment)(s).format("HH:mm"):"";var o=m._.get(i,"DepartInfo.CityName");n.departCityName=o;var c={};c=a>1?e[m._.keys(e)[a-1]]:e[m._.keys(e)[0]];var l=m._.get(c,"ArriveInfo.CityName");return n.arriveCityName=l,n},z=function(){var e=(0,T.Z)((0,b.Z)().mark((function e(t){var n,a,i,r,s,o,c,l,u,d,p,g,f,v,x,T,I,k,_,w,C,P,N,j,Z,F,D,L,R,E,M,V,O,H,q,A,B;return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.request,a=t.actions,i=t.context,r=t.store,s=t.ssr,o=void 0!==s&&s,c=a.setPageFlag,l=a.setPageData,u=a.setPageParams,d=r.getState(),p=d.pageParams,g=p.shoppingId,e.prev=4,f=i.SharkUtil,v=i.platform,x=i.urlQuery,T=x.shoppingBriefFromBFF&&JSON.parse(x.shoppingBriefFromBFF),T&&(I=T.isIntl,k=T.isIBU,_=T.Passengers,w=T.ShoppingSegments,C=(0,h.Z)((0,h.Z)({},(0,S.sm)(_)),{},{isIntl:I,isIBU:k}),l({ShoppingSegments:w,segmentTipsCardInfo:(0,y.W)((0,h.Z)((0,h.Z)({},C),{},{isTour:p.isTour}),v,f)})),c({showSkeletonPage:!0,showPageEmpty:!1},"startLoading",{value:(0,m.moment)().format("YYYY-MM-DD HH:mm:ss")}),e.next=11,n(X,{ShoppingId:g,Header:[{Name:"UpdateLastVisitTime",Value:"1"}]});case 11:P=e.sent,N=P.Flight,j=void 0===N?{}:N,Z=m._.get(P,["Flight","Segments"],[]),Z.map((function(e){return e.briefFlight=$(e,f),e})),F=m._.get(P,["Shopping","Tags"],[]),D=m._.findIndex(F,(function(e){return"isIbu"===e.Key&&"true"===e.Value}))>-1,L=m._.get(P,["ResponseStatus"])||[],R=(0,S.cr)(L),E=m._.get(P,["Shopping","Basic","Passengers"],[]),M=j,V=M.Tokens,O=void 0===V?[]:V,H=M.IsIntl,O.map((function(e){return e.SegmentId=e.SegmentNo,e.SegmentToken=e.CompareToken,!0})),q={Flight:j,Shopping:m._.get(P,["Shopping"],{})},A=(0,h.Z)((0,h.Z)({},(0,S.sm)(E)),{},{isIntl:H,isIBU:D}),B={defaultFlightInfo:O,ShoppingSegments:Z,toBFFShoppingDetail:q},T||(B.segmentTipsCardInfo=(0,y.W)((0,h.Z)((0,h.Z)({},A),{},{isTour:p.isTour}),v,f)),l(B,"getShoppingDetail",{jsonData:[{key:"\u8d2d\u7269\u8f66\u5df2\u9009\u822a\u73edtoken",value:O}],RootMessageId:R}),o&&ee(c,!0,!1,"startLoading"),u(A),e.next=35;break;case 31:return e.prev=31,e.t0=e["catch"](4),ee(c,!0,!1,"endLoading"),e.abrupt("return",Promise.reject());case 35:case"end":return e.stop()}}),e,null,[[4,31]])})));return function(t){return e.apply(this,arguments)}}(),ee=function(e,t,n,a){e({showSkeletonPage:t,showPageEmpty:n},a,{value:(0,m.moment)().format("YYYY-MM-DD HH:mm:ss")})},te=function(){var e=(0,T.Z)((0,b.Z)().mark((function e(){var t,n,a,i,s,o,c,l,u,d,p,g,v,x,T,I,k,w,C,y,P,N,j,Z,D,L,R,E,M,V,O,H,q,A,B,U,X,Y,G,K,Q,W,$,J,z,ee,ne,ie,re,se,oe,ce,le,ue,de,pe,ge,fe,he,me,ve,xe,be,Te,Ie=arguments;return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=Ie.length>0&&void 0!==Ie[0]?Ie[0]:"",s=Ie.length>1?Ie[1]:void 0,o=s.graphqlFetch,c=s.actions,l=s.store,u=s.context,d=s.firFeeBag,p=u.traceLog,g=u.urlQuery,v=g.selectedToken,x=g.sourcefrom,T=g.freeCheckBaggage,I=u.platform,k=u.pageType,w=c.setPageFlag,C=c.setPageData,y=c.setPageParams,P=c.logPageInfo,N=l.getState(),j=N.defaultFlightInfo,Z=void 0===j?[]:j,D=N.pageParams,L=void 0===D?{}:D,R=N.cabinListDictionary,E=void 0===R?{}:R,M=N.toBFFShoppingDetail,V=void 0===M?{}:M,O=L.isTour,H=L.isDingZhi,q=L.upgradeClass,A=L.shoppingId,B=L.cachekey1,U=H||O,X=!0,Y=m._.last(Z),G=v||(null===Y||void 0===Y?void 0:Y.Token)||(null===Y||void 0===Y?void 0:Y.token),"PC"===k&&(G=L.selectedToken||""),K={ShoppingId:A||L.shoppingId,ToBFFShoppingDetail:V,SelectedToken:m._.isEmpty(G)?"":decodeURIComponent(G),Headers:[U||"4126"===x?"":{Name:"SearchPKGRefer",Value:"T"},"1"===q?{Name:"SearchMoreGrade",Value:"T"}:""].filter(Boolean),WaitToken:i,Platform:I},Q=m.GraphqlClient.gql(r||(r=(0,_.Z)(["\n        query CabinInfoList($params: CabinIfoListReq) {\n            CabinInfoList(params: $params) {\n                CabinListVMForShopping\n            }\n        }\n    "]))),e.next=16,o(Q,K,B&&X?{cachePolicy:{enableCache:!0,cacheExpireTime:5,cacheLocation:"MEM",cacheKey:B}}:void 0);case 16:for(ue in W=e.sent,$=W.CabinInfoList,$.CabinListVM,J=$.CabinListVMForShopping,m._.isEmpty(B)||y((0,h.Z)((0,h.Z)({},L),{},{cachekey1:""})),z=J,ee=z.waitMilliseconds,ne=z.waitToken,ie=z.isIBU,re=void 0!==ie&&ie,se=z.newCabinObject,oe=void 0===se?{}:se,ce=!(null!==(t=z.flightList)&&void 0!==t&&t.length)||!(null!==(n=z.cabinList)&&void 0!==n&&n.length),z.cabinList.sort((function(e,t){return parseInt(e.sortKey||"0",10)-parseInt(t.sortKey||"0",10)})),le=z.cabinList.findIndex((function(e){var t=e.segmentToken,n=void 0===t?[]:t;return Z.every((function(e){return n.find((function(t){return t.SegmentToken===e.CompareToken||t.SegmentToken===e.SegmentToken}))}))})),-1===le||m._.isEmpty(Z)||z.cabinList.unshift((0,h.Z)((0,h.Z)({},z.cabinList.splice(le,1)[0]),{},{isSelect:!0})),oe)pe=null===(de=oe[ue])||void 0===de?void 0:de.findIndex((function(e){var t=e.segmentToken,n=void 0===t?[]:t;return Z.every((function(e){return n.find((function(t){return t.SegmentToken===e.SegmentToken}))}))})),-1!==pe&&oe[ue].unshift((0,h.Z)((0,h.Z)({},oe[ue].splice(pe,1)[0]),{},{isSelect:!0}));if(ge=(0,S.zy)(z),fe=Object.keys(oe)||[],ge.defaultCabinTab=fe[0],he=!1,null===(a=ge.cabinList)||void 0===a||a.map((function(e){var t;null!==(t=e.restrainedTag)&&void 0!==t&&t.hasFreeBaggage&&(he=!0)})),me=m._.cloneDeep(ge),(0,S.JX)(ge,"PC"===k?d:T),ve=ae(ge,L),xe=m._.last(z.flightList),be=null===xe||void 0===xe?void 0:xe.segmentTokensForSelect,Te=E[be]||{},"PC"===k&&C({cabinListDictionary:(0,h.Z)((0,h.Z)({},E),{},(0,f.Z)({},be,(0,h.Z)((0,h.Z)({},Te),{},{cabinList:null===ge||void 0===ge?void 0:ge.cabinList,flightList:null===ge||void 0===ge?void 0:ge.flightList,briefTransferInfo:null===ge||void 0===ge?void 0:ge.briefTransferInfo,transferInfoViewData:null===ge||void 0===ge?void 0:ge.transferInfoViewData,loadingNoData:!1,loading:0===ee,loadingFail:!1})))}),ce){e.next=47;break}C({originCabinListVMInfo:me,CabinListVMInfo:ge,flightContents:ve}),y({isIBU:re}),(X||0===ee)&&P({contents:ve}),w({hasFreeBaggage:he,showSkeletonPage:!1},"endLoading",{value:(0,m.moment)().format("YYYY-MM-DD HH:mm:ss"),desc:"\u6709\u6570\u636e\uff0c\u7ed3\u675f\u52a0\u8f7d"}),e.next=50;break;case 47:if(!ce||0!==ee){e.next=50;break}throw w({},"noResult",{value:(0,m.moment)().format("YYYY-MM-DD HH:mm:ss"),desc:"\u65e0\u6570\u636e\uff0c\u5217\u8868\u8fd4\u56de\u7a7a"}),new Error;case 50:if(X=!1,w({showPartialLoading:ee>0}),!(ee>0)){e.next=59;break}return e.next=55,new Promise((function(e){return setTimeout(e,ee)}));case 55:return e.next=57,te(ne,s);case 57:e.next=60;break;case 59:F(z)(p);case 60:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=(0,T.Z)((0,b.Z)().mark((function e(t){var n,a,i,r,s,o,c,l,u,d,p,g,v;return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.actions,a=t.store,i=t.context,r=i.pageType,s=n.setPageFlag,o=n.setPageData,c=a.getState(),l=c.pageParams,u=void 0===l?{}:l,d=c.cabinListDictionary,p=void 0===d?{}:d,g=u.segmentToken,v=p[g]||{},e.prev=6,"PC"===r&&o({cabinListDictionary:(0,h.Z)((0,h.Z)({},p),{},(0,f.Z)({},g,(0,h.Z)((0,h.Z)({},v),{},{loading:!0,loadingNoData:!1,loadingFail:!1})))}),e.next=10,te("",t);case 10:e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](6),s({showPageEmpty:!0,showSkeletonPage:!1},"noResultEmpty",{value:(0,m.moment)().format("YYYY-MM-DD HH:mm:ss"),desc:"\u5c55\u793a\u91cd\u9009\u822a\u73ed\u9875"}),"PC"===r&&o({cabinListDictionary:(0,h.Z)((0,h.Z)({},p),{},(0,f.Z)({},g,(0,h.Z)((0,h.Z)({},v),{},{loading:!1,loadingNoData:!1,loadingFail:!0})))});case 16:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(t){return e.apply(this,arguments)}}(),ae=function(e,t){var n={L:"\u5927",M:"\u4e2d",S:"\u5c0f"},a=e||{},i=a.flightList,r=void 0===i?[]:i,s=a.briefTransferInfo,o=void 0===s?[]:s,c=[];r.forEach((function(e,t){var a=e||{},i=a.flightInfoList,r=void 0===i?[]:i,s=a.briefFlight,l=s.duration,u=s.departCityName,d=s.arriveCityName;c.push({key:"\u7b2c".concat(t+1,"\u7a0b"),value:"".concat(u," -> ").concat(d," \u603b\u65f6\u957f").concat(l)}),r.forEach((function(e,t){var a=e||{},i=a.airlineName,r=a.flightNo,s=a.carrier,l=a.carrierNo,u=a.segmentId,d=a.flightId,p=a.stopStations,g=void 0===p?[]:p,f=a.flightType,h=f.name,v=f.type,x=a.arriveSchedule,b=x.airportShortName,T=x.airportCode,I=x.terminal,k=a.departSchedule,_=k.airportShortName,w=k.scheduleTime,C=k.airportCode,S=k.terminal,y=m._.get(o,"[".concat(u,"][").concat(d,"]"))||[],P=t>=1?"\u4e2d\u8f6c":"",N=s||l?"":"".concat(h).concat(n[v]),j="";y.forEach((function(e){"city"===e.type&&(j+="\u4e2d\u8f6c"),j+=" ".concat(e.text)}));var Z="";g.forEach((function(e){var t=e||{},n=t.cityName,a=void 0===n?"":n;Z+="\u7ecf\u505c".concat(a)})),t>=1&&c.push({key:"\u4e2d\u8f6c\u63d0\u9192",value:j}),c.push({key:"".concat(P,"\u51fa\u53d1\u673a\u573a"),value:"".concat(C).concat(_).concat(S)}),c.push({key:"".concat(P,"\u5230\u8fbe\u673a\u573a"),value:"".concat(T).concat(b).concat(I)}),c.push({key:"".concat(P,"\u822a\u73ed\u4fe1\u606f"),value:"".concat(w," ").concat(i).concat(r).concat(N)}),(s||l)&&c.push({key:"".concat(P,"\u5171\u4eab\u822a\u73ed\u4fe1\u606f"),value:"".concat(w," ").concat(s).concat(l).concat(h).concat(n[v])}),!m._.isEmpty(g)&&c.push({key:"\u7ecf\u505c\u63d0\u9192",value:Z})}))}));var l=t.adt,u=t.ift,d=t.cldAges,p=void 0===d?[]:d,g=null===p||void 0===p?void 0:p.filter((function(e){return e>=12})).length,f=p.length-g,h=l?"".concat(l,"\u6210\u4eba"):"",v=g?"".concat(g,"\u5927\u7ae5"):"",x=f?"".concat(f,"\u5c0f\u7ae5"):"",b=u?"".concat(u,"\u5a74\u513f"):"";return c.push({key:"\u4e58\u5ba2\u4fe1\u606f",value:"".concat(h).concat(v).concat(x).concat(b)}),c},ie=function(){var e=(0,T.Z)((0,b.Z)().mark((function e(t){var n,a,i,r,s,o,c,l,u,d,p,g,m,v,x,T;return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.params,a=t.actions,i=t.store,t.graphqlFetch,t.context,r={1:{flag:"showFlightInfoMask",tem:"planeDetailMaskInfo"},2:{flag:"showTransferInfoMask",tem:"transferMaskInfo"}},s=i.getState(),o=s.pageParams,c=void 0===o?{}:o,c.shoppingId,l=n.type,u=n.data,n.isSelect,d=a.setPageFlag,p=a.setTempData,!Object.keys(r).includes(l)){e.next=13;break}return g=r[l],m=g.flag,v=g.tem,x={showFlightInfoMask:"\u6253\u5f00\u822a\u73ed\u8be6\u60c5\u8499\u5c42",showTransferInfoMask:"\u6253\u5f00\u4e2d\u8f6c\u8499\u5c42"},T=re(m,u),d((0,f.Z)({},m,!0),"showMask",{desc:x[m],jsonData:T}),p((0,f.Z)({},v,(0,h.Z)({},u))),e.abrupt("return");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(e,t){var n=[];if("showFlightInfoMask"===e){var a={L:"\u5927",M:"\u4e2d",S:"\u5c0f"},i=t.flightType,r=void 0===i?{}:i,s=t.airlineName,o=t.arriveSchedule,c=o.terminal,l=o.airport,u=t.departSchedule,d=u.terminal,p=u.airport,g=t.flightNo,f=(t.mealType,t.arrivePunctuality),h=t.departPunctuality,m=t.carrier,v=void 0===m?"":m,x=t.carrierNo,b=void 0===x?"":x,T=r.type||"",I=r.name||a[T];return n.push({key:"\u822a\u73ed\u4fe1\u606f",value:"".concat(s).concat(g)}),(v||b)&&n.push({key:"\u5171\u4eab\u822a\u73ed\u4fe1\u606f",value:"\u5b9e\u9645\u4e58\u5750".concat(v," ").concat(b)}),n.push({key:"\u8d77\u98de\u673a\u573a",value:"".concat(p).concat(d)}),n.push({key:"\u5230\u8fbe\u673a\u573a",value:"".concat(l).concat(c)}),I&&n.push({key:"\u98de\u673a\u673a\u578b",value:"".concat(r.name).concat(a[T]?"".concat(a[T],"\u578b\u673a"):"")}),h&&n.push({key:"\u51fa\u53d1\u51c6\u70b9\u7387",value:"".concat(h)}),f&&n.push({key:"\u5230\u8fbe\u51c6\u70b9\u7387",value:"".concat(f)}),n}if("showTransferInfoMask"===e){var k=t.title,_=t.contentList,w=void 0===_?[]:_;return n.push({key:"\u4e2d\u8f6c\u4fe1\u606f",value:"".concat(k)}),w.forEach((function(e){var t=e.title,a=e.content,i=e.contentList;n.push({key:t,value:a||i})})),n}},se=function(){var e=(0,T.Z)((0,b.Z)().mark((function e(t){var n,a,i,r,s,o,c,l,u,d,p,g,f,m,v,x,T,I,_,w,C,y,P,N,j,Z,F,D,E,M,O,H,q,A,B,X,Y,G,K,Q;return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.params,i=t.store,r=t.context,s=t.actions,o=t.request,c=t.graphqlFetch,l=r.traceLog,u=r.urlQuery.basePrice,d=a.cabinObj,p=a.traceLogObj,g=void 0===p?{}:p,f=s.setPageFlag,m=s.setTempData,v=s.kmDevTraceLog,x=s.getQconfig,T=i.getState(),I=T.pageParams,_=T.tempData,w=T.flightContents,C=_.selectResourceList,void 0===C?[]:C,y=I.isTour,P=I.chooseSingleResource,N=I.shoppingId,j=g.showPrice,Z=g.classInfo,g.cabinClass,g.seatCount,g.flightList,g.reduceType,g.unitReducePrice,g.flightPrice,g.isIntl,F=g.cabin,D=void 0===F?{}:F,E=g.passengerCount,D.viewModelForFareRemark,M=d.segmentToken,O=d.savePriceType,H=d.isJump,q=void 0!==H&&H,null!==(n=U)&&void 0!==n&&null!==(n=n.document)&&void 0!==n&&n.body&&(U.document.body.style.cssText=""),f({showCabinFareRemark:!1,showLoading:!0,showRelatedXListMask:!1},"chooseCabin",{contents:[].concat((0,k.Z)(w),[{key:"\u5269\u4f59\u7968\u6570",value:g.seatCount},{key:"\u5dee\u4ef7",value:j},{key:"\u603b\u4ef7",value:Number(u)+j*E},{key:"\u8231\u4f4d\u8be6\u7ec6\u4fe1\u606f",value:JSON.stringify(Z)},{key:"\u8def\u7531\u4fe1\u606f",value:JSON.stringify(r.urlQuery)},{key:"\u5e73\u53f0",value:r.platform}])}),g&&(A=(0,S.YL)(I),L({data:g,savePriceType:O,passengerNum:A})(l)),e.prev=13,"1"!==P){e.next=20;break}return e.next=17,ce((0,h.Z)((0,h.Z)({},t),{},{isJump:q}),M);case 17:e.t0=e.sent,e.next=23;break;case 20:return e.next=22,V({shoppingId:N,targetCabinTokenList:M.map((function(e){var t=e.SegmentId,n=e.Token;return{SegmentId:t,Token:n}})),tokens:M.map((function(e){var t=e.Token;return t})),channel:y?"tour":""})(o,l,r.urlQuery,c,x);case 22:e.t0=e.sent;case 23:if(B=e.t0,null===B||void 0===B||!B.updateFail){e.next=26;break}throw B;case 26:if("1"!==P){e.next=33;break}if(X=B.AddShoppingAndBook,Y=void 0===X?{}:X,G=Y.isSuccess,K=Y.message,Y.type,!0===G){e.next=33;break}return s.setTempData({noticeModalInfo:{title:K,bottomTitle:"\u91cd\u65b0\u9009\u62e9"}}),s.setPageFlag({showNoticeModalPanel:!0}),e.abrupt("return");case 33:return Q=oe((0,h.Z)((0,h.Z)({},t),{},{tokenMapping:B.TokenMapping,segmentToken:M})),e.abrupt("return",Q);case 37:if(e.prev=37,e.t1=e["catch"](13),e.t1.updateFail){e.next=41;break}return e.abrupt("return");case 41:null===v||void 0===v||v({messageId:S.n6.no_checkcabin,desc:S.DV.no_checkcabin,contents:null!==e.t1&&void 0!==e.t1&&e.t1.formarError?[{errorReason:null===e.t1||void 0===e.t1?void 0:e.t1.formarError}]:[]}),m({noticeModalInfo:e.t1.formarError}),f({showNoticeModalPanel:!0}),R({error:e.t1.formarError})(l);case 45:return e.prev=45,f({showLoading:!1}),e.finish(45);case 48:case"end":return e.stop()}}),e,null,[[13,37,45,48]])})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=(0,T.Z)((0,b.Z)().mark((function e(t){var n,a,i,r,s,o,c,l,u,d,p,g,f,h,m,v,x,T,I,k,_,w,C,S,y;return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.context,t.tokenMapping,t.segmentToken,a=t.store,i=t.actions,r=n.platform,s=n.diyForwardPage,o=n.pageOptions,c=void 0===o?{}:o,l=n.urlQuery,u=n.diyBackPage,d=n.popToPage,p=i.setPageFlag,g=c.changeTrainToFlight,f=c.returnOptions,h=l.confirmCallback,m=l.fromPage,v=l.sourcefrom,x=l.srcfrom,T=n.jumpForChooseSingleResource,I=a.getState(),k=I.pageParams,_=void 0===k?{}:k,w=_.chooseSingleResource,C=_.shoppingId,"1"!==w){e.next=11;break}return T(C),e.abrupt("return");case 11:if("CtripApp"!==r&&"TripApp"!==r){e.next=21;break}if("tour_channel"!==v){e.next=16;break}d(m,{flightUpdated:!0}),e.next=19;break;case 16:return e.next=18,null===h||void 0===h?void 0:h({needUpdateShopping:!0});case 18:null===u||void 0===u||u(m);case 19:e.next=25;break;case 21:return S=l.isFromList,y=void 0===S?"":S,p({backPageStart:!0}),"middle"===x?null===s||void 0===s||s("confirm",{shoppingId:C,sourcefrom:v},{pageOptions:{}}):null===u||void 0===u||u({isBack:!0,pageOptions:{doOrder:!1,shoppingUpdated:!0,flightChanged:!0,changeTrainToFlight:g,returnOptions:f},params:{flightUpdated:!0},sourceName:y?"flightList":"",deleteCachePageList:["flightList","cabinList"]},y?-2:-1),e.abrupt("return","onlineStartBack");case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=(0,T.Z)((0,b.Z)().mark((function e(t,n){var a,i,r,s,o,c,l,u,d,p,g,f,h,v,x,T,I,k;return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.params,a=t.store,t.context,t.actions,t.request,i=t.graphqlFetch,r=t.isJump,s=a.getState(),o=s.pageParams,c=void 0===o?{}:o,l=s.defaultFlightInfo,u=void 0===l?[]:l,d=s.tempData,p=c.backurl,g=c.shoppingId,f=c.xItemTokenList,void 0===f?[]:f,h=d.selectResourceList,v=void 0===h?[]:h,x=m._.map(u,(function(e){return{Token:e.Token||e.token}})),T=m._.map(n,(function(e){return{SegmentId:e.SegmentId,Token:e.Token}})),I={shoppingId:g,needBook:!p,Tags:[{Key:"PageType",Value:"MoreSeat"}],requestData:{IsShoppingDetailUpdate:!0,SelectedResources:r?T:T.concat(v),ResourceType:0,AddType:1}},m._.isEmpty(x)||(I.requestData.DeletedResources=x),I.clearType=[4],e.next=11,i("query AddShoppingAndBook($params: AddShoppingAndBookParams){\n        AddShoppingAndBook(params: $params) {\n            isSuccess,\n            type,\n            message\n        }\n    }",I);case 11:return k=e.sent,e.abrupt("return",k);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),le=function(e){var t=e.context,n=t.Event,a=t.diyBackPage;null===n||void 0===n||n.sendEvent("reloadFlightList",{reload:!0}),null===a||void 0===a||a()},ue=function(e){var t=e.actions,n=e.store,a=e.freeCheckBaggage,i=t.setPageData,r=n.getState(),s=r.originCabinListVMInfo,o=m._.cloneDeep(s);(0,S.JX)(o,a),i({CabinListVMInfo:o})},de=function(e){var t=e.traceLogObj,n=e.store,a=e.context,i=a.traceLog,r=n.getState(),s=r.CabinListVMInfo,o=r.pageParams,c=(0,S.YL)(o);E((0,h.Z)((0,h.Z)({},t),{},{CabinListVMInfo:s}),c)(i)},pe=function(){var e=(0,T.Z)((0,b.Z)().mark((function e(t){var n,a,i,r,s,o,c,l,u,d,p,g,f,h,v,x,T,I,k,_,w,C,y,P,N,j;return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.store,a=t.request,i=t.actions,r=t.context,s=n.getState(),o=s.pageParams,c=void 0===o?{}:o,l=s.defaultFlightInfo,u=void 0===l?[]:l,d=c,p=d.shoppingId,g=d.isTour,f=d.isDingZhi,h=r.urlQuery.selectedToken,v=r.pageType,x="","PC"===v?x=c.selectedToken||"":(T=m._.last(u),x=h||(null===T||void 0===T?void 0:T.Token)||(null===T||void 0===T?void 0:T.token)),I=B.kc.dp,g&&(I=B.kc.tour),f&&(I=B.kc.dingzhi),k="".concat(B.dt.vacation).concat(I).concat(B.m0.middle),_={SearchCondition:{ShoppingId:p},PageId:k,PageType:"MoreSeat",FlightCombos:[{Token:x}]},e.prev=11,e.next=14,a(Y,_);case 14:w=e.sent,C=m._.get(w,["Notifications"])||[],y=m._.get(w,["ResponseStatus"])||[],P=(0,S.cr)(y),N=m._.get(r,["baseContext","distributionChannelConfig","common","replacedContent"],""),m._.isEmpty(C)||(j=m._.map(C,(function(e){var t=e.Content,n=e.NotificationLevel,a=e.Title;return N&&(t=t.replace("\u643a\u7a0b",N),a=a.replace("\u643a\u7a0b",N)),{content:t,notificationLevel:n,title:a}})),i.setPageData({flightSearchHornList:m._.sortBy(j,(function(e){return e.notificationLevel}))},"getFlightHornList",{jsonData:j.map((function(e){return{key:e.title,value:e.content}})),RootMessageId:P})),e.next=24;break;case 22:e.prev=22,e.t0=e["catch"](11);case 24:case"end":return e.stop()}}),e,null,[[11,22]])})));return function(t){return e.apply(this,arguments)}}(),ge=function(e,t){return(0,h.Z)((0,h.Z)({},e),t)},fe=function(e,t){return(0,h.Z)((0,h.Z)({},e),{},{pageFlag:(0,h.Z)((0,h.Z)({},e.pageFlag),t)})},he=function(e,t){return(0,h.Z)((0,h.Z)({},e),{},{pageParams:(0,h.Z)((0,h.Z)({},e.pageParams),t)})},me=function(e,t){return(0,h.Z)((0,h.Z)({},e),{},{tempData:(0,h.Z)((0,h.Z)({},e.tempData),t)})},ve=n(67859),xe={showMask:{module:"\u5361\u7247\u8499\u5c42",action:ve.o.UCL,desc:"\u70b9\u51fb\u5c55\u793a"},closeMask:{module:"\u5361\u7247\u8499\u5c42",action:ve.o.UCL,desc:"\u70b9\u51fb\u5173\u95ed"},chooseCabin:{module:"\u8231\u4f4d\u5361\u7247",action:ve.o.UCL,desc:"\u4fee\u6539\u8231\u4f4d"},getCabinInfoList:{module:"\u8231\u4f4d\u5217\u8868",action:ve.o.SS,desc:"\u8bf7\u6c42\u8231\u4f4d\u653f\u7b56\u63a5\u53e3"},startLoading:{module:"\u591a\u8231\u9875",action:ve.o.SS,desc:"\u5f00\u59cb loading"},endLoading:{module:"\u591a\u8231\u9875",action:ve.o.SS,desc:"\u7ed3\u675f loading"},noResult:{module:"\u591a\u8231\u9875",action:ve.o.SS,desc:"\u65e0\u6570\u636e\uff0c\u5217\u8868\u8fd4\u56de\u7a7a"},noResultEmpty:{module:"\u591a\u8231\u9875",action:ve.o.SS,desc:"\u5c55\u793a\u91cd\u9009\u822a\u73ed\u9875"},getFlightHornList:{module:"\u884c\u524d\u5fc5\u8bfb",action:ve.o.SS,desc:"\u8bf7\u6c42\u884c\u524d\u5fc5\u8bfb\u63a5\u53e3"},getShoppingDetail:{module:"\u591a\u8231\u9875",action:ve.o.SS,desc:"\u8bf7\u6c42shopping\u4fe1\u606f"},setSourcefrom:{module:"\u591a\u8231\u9875",action:ve.o.SS,desc:"\u8bb0\u5f55\u6765\u6e90"}},be=m.createReactModel,Te=m.setupContext,Ie=m.setupFinishCallback,ke=m.setupPreloadCallback,_e=m.setupEnvContext,we={pageParams:{},pageFlag:{showSkeletonPage:!0},tempData:{},defaultFlightInfo:[],CabinListVMInfo:{},segmentTipsCardInfo:[],flightSearchHornList:[]},Ce=function(){var e=_e(),t=Te(x.fH),i=Te(x.G1),r=Te(x.z1),s=Te(x.fI),o=t||{},c=o.baseContext,l=void 0===c?{}:c,u=o.requestFn,d=o.gqlRequestFn;console.log("request ctx",t);var p=u((0,h.Z)((0,h.Z)((0,h.Z)({},e),t),i)),g=d((0,h.Z)((0,h.Z)((0,h.Z)({},e),t),i)),f=(0,h.Z)((0,h.Z)((0,h.Z)((0,h.Z)((0,h.Z)({},e),r),i),s),t),m=null===l||void 0===l?void 0:l.isServer,v=(0,I.zn)({keyTraceMap:xe,name:"CabinListModel",initialState:we,reducers:a,logger:"fat"===e.env,devtools:"fat"===e.env}),k=v.store,_=v.actions,w={context:f,request:p,graphqlFetch:g,actions:_,store:k};Ie((function(){_.setPageData({cabinListDictionary:{},defaultFlightInfo:[],CabinListVMInfo:{},segmentTipsCardInfo:[]})})),ke((0,T.Z)((0,b.Z)().mark((function e(){return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("preload call back",m),!m){e.next=13;break}return e.prev=2,console.log("preload call back"),e.next=6,W(w);case 6:_.setPageFlag({hasPreload:!0}),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](2),console.log(e.t0),_.setPageFlag({hasPreload:!1});case 13:case"end":return e.stop()}}),e,null,[[2,9]])}))));var C={};if("PC"===f.pageType){var S=n(97209),y=S.handleClearStore,P=S.handleCheckSelectRelated,N=S.handleRelatedX;C.handleRelatedX=function(e){return N((0,h.Z)((0,h.Z)({},w),{},{params:{cabinObj:e}}))},C.handleClearStore=function(){return y(w)},C.handleCheckSelectRelated=function(e){return P((0,h.Z)((0,h.Z)({},w),{},{showRelatedXList:e}))}}return{store:k,actions:(0,h.Z)((0,h.Z)({},_),{},{initPageParams:function(e){return G((0,h.Z)((0,h.Z)({},w),{},{paramsFromOnline:e}))},initData:function(e){return Q((0,h.Z)((0,h.Z)({},w),{},{firFeeBag:e}))},handleCabinListShowMask:function(e,t,n){return ie((0,h.Z)((0,h.Z)({},w),{},{params:{type:e,data:t,isSelect:n}}))},handleCabinListHiddenMaskPanel:function(e){return K((0,h.Z)((0,h.Z)({},w),{},{flagName:e}))},handleClickDirectOrder:function(e,t){return se((0,h.Z)((0,h.Z)({},w),{},{params:{cabinObj:e,traceLogObj:t}}))},handleReturnFlightList:function(){return le(w)},handleFreeCheckBaggage:function(e){return ue((0,h.Z)((0,h.Z)({},w),{},{freeCheckBaggage:e}))},handleExposeSeat:function(e){return de((0,h.Z)((0,h.Z)({},w),{},{traceLogObj:e}))},operatFlightInfo:function(e,t){return re(e,t)}},C)}},Se=be(Ce),ye=n(39448),Pe=n(61245),Ne=n(96797),je=n(68277),Ze=function(e,t){return(0,h.Z)((0,h.Z)({},e),{},{headerInfo:t})},Fe=function(e,t){var n={down:!0,up:!1};return(0,h.Z)((0,h.Z)({},e),{},{showTradePrice:n[t]||!1})},De=function(e,t){return(0,h.Z)((0,h.Z)({},e),{},{shoppingCartConfig:t})},Le=n(32180)["window"],Re=["baseContext","gqlRequestFn"],Ee=m.setupStore,Me=m.setupContext,Ve=m.setupStartCallback,Oe=m._,He=m.createReactModel,qe=m.setupEnvContext,Ae=m.gql,Be={headerInfo:{title:""},showTradePrice:!1,shoppingCartConfig:{}},Ue=function(){var e=Me(x.z1),t=Me(x.fH),n=Me(x.QE),a=Me(x.fI),r=a.urlQuery,o=qe(),c=Ee({name:"BaseModel",initialState:Be,reducers:i,logger:!0}),l=c.store,u=c.actions,d=e.pageType,p=void 0===d?"":d,g=t.baseContext,f=void 0===g?{}:g,m=t.gqlRequestFn,v=(0,je.Z)(t,Re),I=n.BestonStorage,k=m((0,h.Z)((0,h.Z)({},o),{},{baseContext:f},v));return Ve((0,T.Z)((0,b.Z)().mark((function e(){var t,n,a,i;return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("bestone"!==f.appType||"H5"!==p||!I||!I.getInstance){e.next=7;break}return e.next=3,I.getInstance().getVolumeStatus();case 3:t=e.sent,t&&u.updateShowTradePrice(t),Le.testVol=u.updateShowTradePrice,"undefined"!==typeof Le.TDS&&Le.TDS.volume((function(e){1===Number(e.volume)&&(u.updateShowTradePrice("up"),I.getInstance().setVolumeStatus("up")),0===Number(e.volume)&&(u.updateShowTradePrice("down"),I.getInstance().setVolumeStatus("down"))}));case 7:if(n=r.shoppingId||r.shoppingid,!n||f.shoppingCartConfig){e.next=14;break}return e.next=11,k(Ae(s||(s=(0,_.Z)(["\n                    query ShoppingCartConfig($params: ShoppingCartConfigParams) {\n                        ShoppingCartConfig(params: $params) {\n                            config\n                        }\n                    }\n                "]))),{shoppingId:n});case 11:a=e.sent,i=Oe.get(a,"ShoppingCartConfig.config")||{},u.updateShoppingCartConfig(i);case 14:case"end":return e.stop()}}),e)})))),{store:l,actions:u}},Xe=He(Ue),Ye=n(97600),Ge=n(72854),Ke=n(90129),Qe=n(90201),We=n(66275),$e=n(75134),Je={L:"\u5927",M:"\u4e2d",S:"\u5c0f"},ze=n(2269),et=m._,tt=Qe.memo((function(e){var t=e.flightCard,n=e.pageId,a=t.flightType,i=t.duration,r=t.airlineCode,s=t.airlineName,o=t.carrier,c=t.carrierNo,l=t.flightNo,u=(t.mealType,t.commonComforts),d=(t.isAirlineTimeHold,(0,C.parseMinuteToHourAndMinuteString)(i),a.name),p=a.type,g="https://pic.c-ctrip.com/flight_intl/airline_logo/40x35/".concat(r,".png"),f=Se.useActions(),h=f.setTempData,m=f.setPageFlag,x=f.operatFlightInfo,b=p,T=function(e){if(!et.isEmpty(u)){h({planeDetailMaskInfo:e});var t=x("showFlightInfoMask",e);m({showFlightInfoMask:!0},"showMask",{desc:"\u6253\u5f00\u822a\u73ed\u8be6\u60c5\u8499\u5c42",jsonData:t})}},I=d||Je[b];return(0,ze.jsxs)(v.View,{className:"flit_single_items",children:[(0,ze.jsx)(v.View,{className:"pic",children:(0,ze.jsx)(v.Image,{className:"img",src:g})}),(0,ze.jsxs)(v.View,{className:"flit_single_con","data-testid":"diy-".concat(n,"-").concat(l,"-flight-detail-\u8be6\u60c5"),onClick:function(){return T(t)},children:[(0,ze.jsxs)(v.Text,{className:"flit_gap ".concat(I?"":"no_split"),children:[" ",s,l]}),o||c?null:(0,ze.jsxs)(ze.Fragment,{children:[I&&(0,ze.jsxs)(v.Text,{className:"flit_gap no_split",children:[d,Je[b]?"(".concat(Je[b],")"):""]}),!et.isEmpty(u)&&(0,ze.jsx)(v.Text,{className:"flit_gap",children:(0,ze.jsx)(v.Text,{className:"detail-arrowr"})})]})]})]})})),nt=tt,at=m._,it=function(e){var t=e.briefFlight,n=e.cardIndex,a=t.duration,i=t.departDateTime,r=t.departCityName,s=t.arriveCityName,o=t.isAirlineTimeHold,c=t.isAirlineNameHold,l="";o&&c?l="\u822a\u73ed\u5f85\u5b9a":o&&(l="\u65f6\u95f4\u5f85\u5b9a");var u=rt(i);return(0,ze.jsxs)(v.View,{className:"h3",children:[(0,ze.jsx)(v.Text,{className:"flit_index",children:(0,ze.jsxs)(v.Text,{className:"s",children:["\u7b2c",n+1,"\u7a0b"]})}),(0,ze.jsxs)(v.Text,{className:"flit_route flex_1",children:[u,"\xa0",r,(0,ze.jsx)(v.Text,{className:"flit_arrow_s"}),s,"\xa0",l?"| ":null,l?(0,ze.jsx)(v.Text,{className:"weight_color",children:l?"".concat(l):""}):null]}),a?(0,ze.jsxs)(v.Text,{className:"flit_time",children:["\u603b\u65f6\u957f\xa0",a]}):null]})},rt=function(e){var t=e.substring(5,10),n=new Date(e.replace(/-/g,"/")),a=st(n),i=t+" "+a;return i},st=function(e){if(!e)return"";switch(e.getDay()){case 0:return"\u5468\u65e5";case 1:return"\u5468\u4e00";case 2:return"\u5468\u4e8c";case 3:return"\u5468\u4e09";case 4:return"\u5468\u56db";case 5:return"\u5468\u4e94";case 6:return"\u5468\u516d";default:return""}},ot=function(e){var t=e.flightCard,n=t.flightType,a=t.carrier,i=t.carrierNo,r=t.commonComforts,s=n.name,o=n.type,c=o,l=Se.useActions(),u=l.setTempData,d=l.setPageFlag,p=l.operatFlightInfo,g=s||Je[c];return(0,ze.jsxs)(v.View,{className:"flit_single_items",children:[(0,ze.jsx)(v.View,{className:"pic",children:(0,ze.jsx)(v.Text,{className:"icon_sturn"})}),(0,ze.jsxs)(v.View,{className:"flit_single_con",onClick:function(){if(!at.isEmpty(r)){u({planeDetailMaskInfo:t});var e=p("showFlightInfoMask",t);d({showFlightInfoMask:!0},"showMask",{desc:"\u6253\u5f00\u5171\u4eab\u822a\u73ed\u8be6\u60c5\u8499\u5c42",jsonData:e})}},children:[a||i?(0,ze.jsxs)(v.Text,{className:"flit_gap ".concat(g?"":"no_split"),children:["\u5b9e\u9645\u4e58\u5750",a,"\xa0 ",i]}):null,g&&(0,ze.jsxs)(v.Text,{className:"flit_gap no_split",children:[s,Je[c]?"(".concat(Je[c],")"):""]}),!at.isEmpty(r)&&(0,ze.jsx)(v.Text,{className:"flit_gap",children:(0,ze.jsx)(v.Text,{className:"detail-arrowr"})})]})]})},ct=function(e){e.pageId;var t=e.briefTransferInfo,n=void 0===t?[]:t,a=e.transferInfoViewData,i=void 0===a?{}:a,r=Se.useActions(),s=r.setTempData,o=r.setPageFlag,c=r.operatFlightInfo;return(0,ze.jsx)(v.View,{className:"flit_single_items flit_sturn_stop",children:(0,ze.jsxs)(v.View,{className:"flit_single_con",onClick:function(){s({transferMaskInfo:i});var e=c("showTransferInfoMask",i);o({showTransferInfoMask:!0},"showMask",{desc:"\u6253\u5f00\u4e2d\u8f6c\u8499\u5c42",jsonData:e})},children:[(0,ze.jsx)(v.View,{className:"inline-block",children:n.map((function(e,t){return(0,ze.jsxs)(v.Text,{className:["city","duration"].includes(e.type)?"flit_gap_without_middle_line":"flit_gap",style:{color:e.color},children:["city"===e.type?"\u4e2d\u8f6c  ":"",e.text]},t)}))}),(0,ze.jsx)(v.Text,{className:"transfer-arrow-r"})]})})},lt=function(e){var t=e.index,n=e.firstDepartDate,a=e.flightCard,i=e.stopStations,r=a.arriveSchedule,s=void 0===r?{}:r,o=a.departSchedule,c=void 0===o?{}:o,l=(a.duration,a.isAirlineTimeHold),u=void 0!==l&&l,d=at.get(s,"scheduleTime").substring(5,10),p=at.get(s,"scheduleTime").substring(11,16),g=at.get(c,"scheduleTime").substring(5,10),f=at.get(c,"scheduleTime").substring(11,16),h=a.arriveSchedule,m=h.airportLight,x=h.terminalLight,b=h.airportShortName,T=h.airportCode,I=h.terminal,k=a.departSchedule,_=k.airportLight,w=k.terminalLight,S=k.airportShortName,y=k.airportCode,P=k.terminal;return(0,ze.jsxs)(v.View,{className:"flit_item",children:[(0,ze.jsxs)(v.View,{className:"flit_item_time",children:[u?null:(0,ze.jsxs)(v.Text,{className:"span",children:[t>0&&!(g===n)&&(0,ze.jsx)(v.Text,{className:"j1","data-testid":"departDateString_".concat(t),children:g}),f]}),u?null:(0,ze.jsxs)(v.Text,{className:"span",children:[!(n===d)&&(0,ze.jsx)(v.Text,{className:"j1",children:d}),p]})]}),(0,ze.jsx)(v.Text,{className:"flit_item_line"}),(0,ze.jsxs)(v.View,{className:"flit_item_port",children:[(0,ze.jsxs)(v.View,{className:"h4",children:[y,"\xa0",(0,ze.jsx)(v.Text,{className:_&&"light_tip",children:S})," ","\xa0",(0,ze.jsx)(v.Text,{className:w&&"light_tip",children:P})]}),!at.isEmpty(i)&&at.map(i,(function(e,t){var n=(0,C.parseMinuteToHourAndMinuteString)(e.duration);return(0,ze.jsxs)(v.View,{className:"flit_item_port_pass","data-testid":"\u7ecf\u505c".concat(e.cityName,"_").concat(n,"_").concat(t),children:["\u7ecf\u505c",e.cityName,"\xa0",n]},"stop"+t)})),(0,ze.jsxs)(v.View,{className:"h4",children:[T,"\xa0",(0,ze.jsx)(v.Text,{className:m&&"light_tip",children:b})," ","\xa0",(0,ze.jsx)(v.Text,{className:x&&"light_tip",children:I})]})]})]})},ut=Qe.memo((function(e){var t=e.segmentCard,n=e.pageParams,a=e.onHandleCabinListShowMask,i=e.pageId,r=e.cardIndex,s=e.briefTransferInfo,o=e.transferInfoViewData,c="",l=n.isIntl,u=t.briefFlight,d=void 0===u?{}:u,p=(t.segmentId,t.flightInfoList),g=void 0===p?[]:p;return at.each(g,(function(e,t){var n=e.departSchedule,a=void 0===n?{}:n;0===t&&(c=at.get(a,"scheduleTime").substring(5,10))})),(0,ze.jsxs)(v.View,{className:"flit_length",children:[(0,ze.jsx)(it,{briefFlight:d,cardIndex:r}),g.map((function(e,t){return(0,ze.jsxs)(v.View,{children:[!at.isEmpty(e.transferInfo)&&(0,ze.jsx)(v.View,{className:"flit_sturn",children:(0,ze.jsx)(v.View,{className:"flit_single_corp",children:(0,ze.jsx)(ct,{pageId:i,briefTransferInfo:at.get(s,"[".concat(e.segmentId,"][").concat(e.flightId,"]")),transferInfoViewData:at.get(o,"[".concat(e.segmentId,"][").concat(e.flightId,"]")),onHandleCabinListShowMask:a},"transfer"+t)})}),(0,ze.jsx)(lt,{index:t,firstDepartDate:c,flightCard:e,stopStations:e.stopStations},"SegmentBaseInfo"+t),(0,ze.jsx)(v.View,{className:"flit_sturn",children:(0,ze.jsxs)(v.View,{className:"flit_single_corp",children:[(0,ze.jsx)(nt,{flightCard:e,pageId:i}),(e.carrier||e.carrierNo)&&(0,ze.jsx)(ot,{index:t,isIntl:l,pageId:i,firstDepartDate:c,flightCard:e,stopStations:e.stopStations,onHandleCabinListShowMask:a},"CarrierFlightCard"+t)]})},"SoloFlightCard_".concat(t))]},"transferInfo"+t)}))]})})),dt=m._,pt=(m.classnames,function(){var e=Se.useState((function(e){var t;return null===e||void 0===e||null===(t=e.CabinListVMInfo)||void 0===t?void 0:t.transferVisaTip})),t=(0,Qe.useState)(!1),n=(0,Ke.Z)(t,2),a=n[0],i=n[1];return dt.isEmpty(e)?null:(0,ze.jsxs)(v.View,{className:"cabin_list_caption",children:[1===(null===e||void 0===e?void 0:e.length)&&(0,ze.jsxs)(v.View,{children:[(0,ze.jsx)(v.Text,{className:"organ-title",children:"\u3010".concat(e[0].title,"\u3011")}),e[0].des]}),(null===e||void 0===e?void 0:e.length)>1&&!a&&(0,ze.jsxs)(v.View,{children:[(0,ze.jsxs)(v.Text,{className:"single-title",children:[(0,ze.jsx)(v.Text,{className:"organ-title",children:"\u3010".concat(e[0].title,"\u3011")}),e[0].des+"..."]}),(0,ze.jsxs)(v.Text,{"data-testid":"tips_open",onClick:function(){i(!0)},children:[(0,ze.jsx)(v.Text,{className:"open-btn",children:"\u5c55\u5f00"}),(0,ze.jsx)(v.Text,{className:"open"})]})]}),(null===e||void 0===e?void 0:e.length)>1&&a&&(0,ze.jsxs)(v.View,{children:[dt.map(e,(function(e,t){return(0,ze.jsx)(v.View,{children:(0,ze.jsxs)(v.View,{className:"p",children:[(0,ze.jsx)(v.Text,{className:"organ-title",children:"\u3010".concat(e.title,"\u3011")}),e.des]})},"segmentCard"+t)})),(0,ze.jsxs)(v.View,{className:"close-body","data-testid":"tips_close",onClick:function(){i(!1)},children:[(0,ze.jsx)(v.Text,{className:"close-btn",children:"\u6536\u8d77"}),(0,ze.jsx)(v.Text,{className:"close"})]})]})]})}),gt=m._,ft=function(e){var t=e.pageId,n=e.pageParams,a=e.extendSegment,i=void 0===a?{}:a,r=e.CabinListVMInfo,s=void 0===r?{}:r,o=(e.onHandleCabinListShowMask,s.flightList),c=void 0===o?[]:o,l=s.briefTransferInfo,u=void 0===l?{}:l,d=s.transferInfoViewData,p=void 0===d?{}:d;return gt.isEmpty(c)?null:(0,ze.jsxs)(v.View,{className:"flit_length_box","data-testid":"vac_shoppingcart_flight_cabinlist_flightinfo",children:[c.map((function(e,a){var r=e.segmentId;return(0,ze.jsx)(ut,{cardIndex:a,pageId:t,pageParams:n,segmentCard:e,briefTransferInfo:u,transferInfoViewData:p,extendSegment:i[r]||{}},"segmentCard"+a)})),(0,ze.jsx)(pt,{})]})},ht=n(92954),mt=n.n(ht),vt=n(13450),xt={CHEAPER_PRICE:"\u673a\u9152\u540c\u8ba2\u4eab\u4f18\u60e0",SPECIAL_PRICE:"\u7279\u4ef7\u673a\u7968"},bt={REDUCED:"\u5df2\u51cf",BOOKREDUCE:"\u8ba2\u7acb\u51cf"},Tt=["IsPKG","PriceTags","SavePrice"],It=m._,kt=m.classnames,_t=function(e){var t=e.cabinIndex,n=e.pageId,a=e.cabinInfo,i=e.showPrice,r=(e.cabinClass,e.unrestrainedTag),s=(e.isSelect,e.newCabinClass),o=e.newCarrierInfo,c=e.savePriceType,l=void 0===c?"":c,u=e.reduceType,d=e.reducePrice,p=e.briefFareRemark,g=void 0===p?{}:p,f=e.springMembership,h=void 0===f?{}:f,m=e.setPageFlag,x=e.setTempData,b=e.isTour,T=(e.isIntl,e.isInTDS),I=e.showTradePrice,k=e.originFlightPrice,_=e.priceDetail,w=void 0===_?{}:_,C=e.shoppingCartConfig,S=void 0===C?{}:C,y=e.isShowGapPrice,P=a.restrainedTag,N=P.refundCouponTag,j=g.isWeightFund,Z=void 0===j||j,F=g.isWeightBook,D=void 0===F||F,L=g.minFundFee,R=g.minBookFee,E=Z&&D,M=r.isMemberShip,V=void 0===M?"":M,O=r.isPreferentialRoundTrip,H=void 0===O?"":O,q=r.isCombinedPU,A=void 0===q?"":q,B=r.isSQAlineName,U=void 0!==B&&B;L||R||(E=!1);var X=S.config,Y=void 0===X?{}:X,G=Y.flight,K=void 0===G?{}:G,Q=K.showPKGTag,W=void 0===Q||Q,$=K.showNewShopTag,J=void 0===$||$,z=K.showReduceTag,ee=void 0===z||z,te=function(){var e=[s.map((function(e,t){return(0,ze.jsxs)(v.View,{className:kt({flit_gap:!0,margin_left:0!==t}),children:[(0,ze.jsx)(v.Text,{className:"sequence",children:e.sequence.join("/")}),(0,ze.jsx)(v.Text,{className:"cabin_class_title",children:e.cabinClass})]},"newCabin"+t)})),(0,ze.jsx)(v.Text,{className:"vertical_line"},"reconup2"),(0,ze.jsxs)(v.Text,{className:kt({"flit_gap waring_txt":E,flit_gap:!E},"tracelog_cabin_refund_".concat(t)),children:[L||"",L&&R?"\uff0c":"",R?"".concat(R):"",R||L?"":"\u9000\u6539\u7b7e\u53ca\u8d2d\u7968\u8bf4\u660e"]},"reconup3"),(0,ze.jsx)(v.Text,{className:"vertical_line"},"reconup4")];return N&&e.push((0,ze.jsx)(v.Text,{className:"flit_gap tip_txt",children:N},"reconup5"),(0,ze.jsx)(v.Text,{className:"vertical_line"},"reconup6")),e.splice(e.length-1,1,(0,ze.jsx)(v.Text,{className:"flight_arrow_r",children:"\ue008"},"reconup7")),e},ne=T?!I:i>=0,ae=w.adult,ie=w.child,re=w.infant,se=!(ae&&!ie&&!re||!ae&&ie&&!re||!ae&&!ie&&re);return(0,ze.jsxs)(v.View,{className:"cabin_main flex_1","data-testid":"diy-".concat(n,"-").concat(t,"-cabincard"),children:[(0,ze.jsx)(v.View,{className:"cabin_prices",children:(0,ze.jsxs)(v.Text,{className:"price","data-testid":"showPrice_".concat(t),style:{marginRight:"20px",color:ne?"#FF6600":"#00B87A"},children:[(0,ze.jsxs)(v.Text,{className:"price-logo",style:{marginBottom:"6px"},children:[y?(0,ze.jsx)(v.Text,{style:{marginRight:"1px"},children:i>=0?"+":"-"}):null,"\xa5"]}),Math.abs(i)]})}),!b&&!k.IsPKG&&se&&(0,ze.jsxs)(v.View,{className:"cabin_type_prices",children:[!!ae&&(0,ze.jsxs)(v.Text,{className:"cabin_type_prices_item",children:["\u6210\u4eba",(0,ze.jsx)(v.Text,{className:"orange",children:ae})]}),!!ie&&(0,ze.jsxs)(ze.Fragment,{children:[!!ae&&(0,ze.jsx)(v.Text,{className:"vertical_line"}),(0,ze.jsxs)(v.Text,{className:"cabin_type_prices_item",children:["\u513f\u7ae5",(0,ze.jsx)(v.Text,{className:"orange",children:ie})]})]}),!!re&&(0,ze.jsxs)(ze.Fragment,{children:[!(!ae&&!ie)&&(0,ze.jsx)(v.Text,{className:"vertical_line"}),(0,ze.jsxs)(v.Text,{className:"cabin_type_prices_item",children:["\u5a74\u513f",(0,ze.jsx)(v.Text,{className:"orange",children:re})]})]})]}),(0,ze.jsxs)(v.View,{children:[!b&&W&&"SPECIAL_PRICE"===l&&(0,ze.jsx)(v.Text,{className:kt("s_label_ptag","tracelog_cabin_instrict_".concat(t)),children:xt.SPECIAL_PRICE}),"REDUCED"===u&&ee&&(0,ze.jsxs)(v.Text,{className:"s_label_org","data-testid":"reduced_\xa5_".concat(d,"_").concat(t),children:[bt.REDUCED,(0,ze.jsx)(v.Text,{className:"dfn",children:"\xa5"}),d]}),!b&&"BOOKREDUCE"===u&&ee&&(0,ze.jsxs)(v.Text,{className:"s_label_org",children:[bt.BOOKREDUCE,(0,ze.jsx)(v.Text,{className:"dfn",children:"\xa5"}),d]}),H&&(0,ze.jsx)(v.Text,{className:kt("s_label_org","tracelog_cabin_instrict_".concat(t)),children:"\u5f80\u8fd4\u66f4\u4f18\u60e0"}),V&&(0,ze.jsx)(v.Text,{className:kt("s_label_org","tracelog_cabin_instrict_".concat(t)),children:V}),!!h.value&&(0,ze.jsx)(v.Text,{className:"s_label_greennew",children:h.value}),A&&(0,ze.jsx)(v.Text,{className:kt("s_label_org","tracelog_cabin_instrict_".concat(t)),children:"\u7ec4\u5408\u7279\u4ef7"}),!b&&J&&U&&(0,ze.jsx)(v.Text,{className:"s_labels_pic",children:(0,ze.jsx)(v.Image,{className:"img","data-testid":"isSQAlineName_".concat(t),src:"https://pic.c-ctrip.com/VacationH5Pic/taocan/dp2/c_app.png"})})]}),(0,ze.jsx)(v.View,{className:"cabin_tags",id:"diy-".concat(n,"-flight-refund"),"data-testid":"diy-".concat(n,"-flight-refund"),onClick:function(){x({cabinMaskInfo:a.viewModelForFareRemark}),m({showCabinFareRemark:!0},"showMask",{desc:"\u6253\u5f00\u9000\u6539\u7b7e\u8499\u5c42",jsonData:[{key:"\u9000\u6539\u7b7e\u653f\u7b56",value:a.viewModelForFareRemark}]})},children:te()}),!It.isEmpty(o)&&(0,ze.jsx)(v.View,{className:"cabin_tags",children:o.map((function(e,t){return(0,ze.jsxs)(v.View,{className:kt({flit_gap:!0,margin_left:0!==t}),children:[(0,ze.jsx)(v.Text,{className:"sequence",children:e.sequence.join("/")}),(0,ze.jsx)(v.Text,{className:"cabin_class_title",children:"".concat(e.contractOperationDesc,"\uff5c").concat(e.actualOperationDesc)})]},"newCarrier"+t)}))})]})},wt=function(e){var t=e.CabinListVMInfo,n=e.cabinIndex,a=e.cabinInfo,i=e.isSelect,r=e.seatCount,s=e.passengerCount,o=e.showPrice,c=e.cabinClass,l=(e.onHandleClickDirectOrder,e.unitReducePrice),u=a.classInfo,d=a.reduceType,p=a.originFlightPrice,g=a.originFlightSeats,f=a.isIntl,h=t.flightList,m=void 0===h?[]:h,x={showPrice:o,passengerCount:s,classInfo:u,cabinClass:c,seatCount:r,cabinIndex:n,flightList:m,reduceType:d,unitReducePrice:l,flightPrice:p,isIntl:f,flightSeats:g,cabin:a},I=Se.useActions(),k=I.handleClickDirectOrder;return(0,ze.jsxs)(v.View,{className:"cabin_chose",children:[(0,ze.jsx)(v.Text,{className:kt({cabin_btn:!0,select_btn:i}),"data-testid":"left-".concat(r,"-ticket"),onClick:(0,T.Z)((0,b.Z)().mark((function e(){return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return mt().showLoading({title:"\u52a0\u8f7d\u4e2d",mask:!0}),e.next=3,k(a,x);case 3:mt().hideLoading();case 4:case"end":return e.stop()}}),e)}))),children:i?"\u5df2\u9009":"\u9009\u62e9"}),r<9&&(0,ze.jsxs)(v.Text,{className:"cabin_waring",children:["\u5269",r,"\u5f20"]})]})},Ct=function(e){var t,n=e.cabinIndex,a=e.cabinInfo,i=(e.isSelect,e.isIntl),r=e.showPrice,s=e.savePriceType,o=e.isTour,c=a.restrainedTag,l=void 0===c?{}:c,u=a.brieBaggageLimit,d=void 0===u?{}:u,p=l.ageRestriction,g=void 0===p?{}:p,f=l.confirmDurationMinute,h=l.nationalityLimit,m=l.confirmImmediately,x=l.specialChangeTextDesc,b=void 0===x?"":x,T=g.Adult||[],I=g.Child||[],k=d.CHECK||{},_=It.get(h,["Adult","nationalityNames"],""),w=(0,vt.B)(),C=Se.useActions(),S=C.setTempData,y=C.setPageFlag;return(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsxs)(v.View,{className:"cabin_attention",onClick:function(){S({cabinMaskInfo:a.viewModelForFareRemark}),y({showCabinFareRemark:!0})},children:[It.isEmpty(k.baggageBrief)?null:(0,ze.jsxs)(v.Text,{className:kt("span",k.isWeight?"cabin_waring":"","tracelog_cabin_restrict_".concat(n)),children:[(k.isWeight,(0,ze.jsx)(v.Text,{className:"iconfont"})),k.baggageBrief]}),!!f&&(0,ze.jsxs)(v.Text,{className:kt("span","tracelog_cabin_restrict_".concat(n)),children:[(0,ze.jsx)(v.Text,{className:"iconfont"}),f]}),m&&(0,ze.jsxs)(v.Text,{className:kt("span","tracelog_cabin_restrict_".concat(n)),children:[(0,ze.jsx)(v.Text,{className:"iconfont"}),"\u7acb\u5373\u786e\u8ba4"]}),!It.isEmpty(T)&&(0,ze.jsxs)(v.Text,{className:kt("span","cabin_waring","tracelog_cabin_restrict_".concat(n)),children:[(0,ze.jsx)(v.Text,{className:"iconfont"}),T]}),!It.isEmpty(I)&&i&&(0,ze.jsxs)(v.Text,{className:kt("span","cabin_waring","tracelog_cabin_restrict_".concat(n)),children:[(0,ze.jsx)(v.Text,{className:"iconfont"}),I&&"\u513f\u7ae5\uff1a\u9650".concat(I[0],"-").concat(I[1],"\u5468\u5c81\u9884\u8ba2")]}),_?(0,ze.jsxs)(v.Text,{className:kt("span","cabin_waring","tracelog_cabin_restrict_".concat(n)),style:_.length>11?{width:"100%"}:{},children:[(0,ze.jsx)(v.Text,{className:"iconfont"}),_]}):null,b?(0,ze.jsxs)(v.Text,{className:kt("span","tracelog_cabin_restrict_".concat(n)),style:b.length>11?{width:"100%"}:{},children:[(0,ze.jsx)(v.Text,{className:"iconfont"}),b]}):null]}),!o&&"CHEAPER_PRICE"===s&&(0,ze.jsxs)(v.View,{className:"cabin_taocanbao",children:[(0,ze.jsx)(v.View,{children:(0,ze.jsx)(v.Text,{className:kt("s_label_stag","tracelog_cabin_instrict_".concat(n)),children:xt.CHEAPER_PRICE})}),(0,ze.jsx)(v.View,{className:"p",children:null===(t=w.handleGetPkgTip)||void 0===t?void 0:t.call(w,"flight",{tipType:"cabin",placeholders:[(0,ze.jsxs)(v.View,{className:"s",children:[(0,ze.jsx)(v.Text,{children:"\xa5"}),r]})]})})]})]})},St=function(e){var t=e.pageId,n=e.cabinIndex,a=e.cabinInfo,i=Se.useState((function(e){return{pageParams:e.pageParams,CabinListVMInfo:e.CabinListVMInfo,pageFlag:e.pageFlag,isInTDS:e.isInTDS}})),r=i.pageParams,s=i.CabinListVMInfo,o=i.isInTDS,c=(i.pageFlag.showLoading,Se.useActions()),l=c.handleExposeSeat,u=c.setPageFlag,d=c.setTempData,p=a.cabinClass,g=a.isIntl,f=a.price,h=a.seatCount,m=a.submitInfo,x=a.unrestrainedTag,b=void 0===x?{}:x,T=a.isSelect,I=a.savePriceType,k=a.reduceType,_=a.newCabinClass,w=a.newCarrierInfo,C=a.reducePrice,S=a.briefFareRemark,y=a.springMembership,P=void 0===y?{}:y,N=a.originFlightPrice,j=void 0===N?{}:N,Z=a.tradePrice,F=void 0===Z?0:Z,D=a.originFlightSeats,L=a.viewModelForFareRemark;if(It.isEmpty(a))return null;var R=Xe.useState((function(e){return{showTradePrice:e.showTradePrice}})),E=R.showTradePrice,M=void 0!==E&&E,V=Se.useActions(),O=V.shoppingCartConfig,H=void 0===O?{}:O,q=r.passengerCount,A=void 0===q?1:q,B=r.isTour,U=r.basePrice,X=void 0===U?0:U,Y=r.baseTradePrice,G=void 0===Y?0:Y,K=r.isQunar;if(M&&(f=F),!g&&(B||K)){j.IsPKG,j.PriceTags,j.SavePrice;var Q=(0,je.Z)(j,Tt);Object.values(Q).forEach((function(e){var t=e.Oil,n=void 0===t?0:t,a=e.Tax,i=void 0===a?0:a;f+=n+i}))}var W=X||G;if(W){var $=M?G:X;f-=$}var J=Math.ceil(f/A),z=Math.floor(C/A);(0,Qe.useEffect)((function(){l({cabinIndex:n,cabin:a,cabinClass:p,seatCount:h,showPrice:J,savePriceType:I,isIntl:g,flightSeats:D,reduceType:k,unitReducePrice:z})}),[]);var ee=L.priceDetail;return(0,ze.jsxs)(v.View,{className:T?"cabin_list select_cabin":"cabin_list",children:[(0,ze.jsx)(_t,{cabinIndex:n,isInTDS:o,showTradePrice:M,isTour:B,pageId:t,showPrice:J,cabinClass:p,isIntl:g,unrestrainedTag:b,cabinInfo:a,isSelect:T,newCabinClass:_,newCarrierInfo:w,savePriceType:I,reduceType:k,reducePrice:z,briefFareRemark:S,springMembership:P,pageParams:r,setPageFlag:u,setTempData:d,originFlightPrice:j,priceDetail:ee,shoppingCartConfig:H,isShowGapPrice:W}),(0,ze.jsx)(wt,{CabinListVMInfo:s,cabinIndex:n,cabinInfo:a,isSelect:T,seatCount:h,submitInfo:m,showPrice:J,passengerCount:A,cabinClass:p,unitReducePrice:z}),(0,ze.jsx)(Ct,{cabinIndex:n,cabinInfo:a,isSelect:T,isIntl:g,savePriceType:I,showPrice:J,isTour:B})]})},yt=m._,Pt=function(e){var t=e.pageId,n=e.cabinList,a=Se.useState((function(e){return{pageFlag:e.pageFlag,pageParams:e.pageParams,CabinListVMInfo:e.CabinListVMInfo,defaultFlightInfo:e.defaultFlightInfo}})),i=a.pageParams,r=a.CabinListVMInfo,s=a.defaultFlightInfo,o=Se.useState((function(e){return{showPageEmpty:e.pageFlag.showPageEmpty,showSkeletonPage:e.pageFlag.showSkeletonPage}})),c=o.showPageEmpty,l=o.showSkeletonPage;return yt.isEmpty(n)?null:(0,ze.jsxs)(ze.Fragment,{children:[yt.map(n,(function(e,n){return(0,ze.jsx)(St,{className:"tracelog_cabin_".concat(n),pageParams:i,cabinInfo:e,pageId:t,cabinIndex:n,CabinListVMInfo:r,defaultFlightInfo:s},"cabinCard"+n)})),!c&&!l&&(0,ze.jsx)(v.View,{className:"data_no",children:(0,ze.jsx)(v.Text,{className:"text",children:"\u6ca1\u6709\u66f4\u591a\u4e86"})})]})},Nt=m._,jt=function(e){var t=e.pageId,n=e.segmentTipsCardInfo;return Nt.isEmpty(n)?null:(0,ze.jsx)(v.View,{id:"diy-".concat(t,"-mask-price"),"data-testid":"cabin_tips",className:"cabin_tips",children:Nt.map(n,(function(e,t){return(0,ze.jsx)(v.View,{className:"isP",children:e},"segmentTip"+t)}))})},Zt=function(){return(0,ze.jsxs)(v.View,{className:"fli",children:[(0,ze.jsxs)(v.View,{className:"fli1",children:[(0,ze.jsxs)(v.View,{className:"fli11",children:[(0,ze.jsx)(v.View,{className:"fli111"}),(0,ze.jsx)(v.View,{className:"fli112"})]}),(0,ze.jsx)(v.View,{className:"fli12"})]}),(0,ze.jsx)(v.View,{className:"fli2"})]})},Ft=function(){return(0,ze.jsxs)(v.View,{className:"flightcabin_render",children:[(0,ze.jsxs)(v.View,{className:"f",children:[(0,ze.jsx)(v.View,{className:"f1"}),(0,ze.jsxs)(v.View,{className:"f2",children:[(0,ze.jsxs)(v.View,{className:"f2l",children:[(0,ze.jsx)(v.View,{className:"f2l1"}),(0,ze.jsx)(v.View,{className:"f2l1"})]}),(0,ze.jsxs)(v.View,{className:"f2r",children:[(0,ze.jsx)(v.View,{className:"f2r1"}),(0,ze.jsx)(v.View,{className:"f2r1"}),(0,ze.jsx)(v.View,{className:"f2r2"})]})]})]}),(0,ze.jsxs)(v.View,{className:"ful",children:[(0,ze.jsx)(Zt,{}),(0,ze.jsx)(Zt,{}),(0,ze.jsx)(Zt,{}),(0,ze.jsx)(Zt,{}),(0,ze.jsx)(Zt,{})]})]})},Dt=n(37195),Lt=function(e){var t=e.children,n=e.renderBottom,a=e.onHide;return(0,ze.jsxs)(v.View,{children:[(0,ze.jsxs)(v.View,{className:"dp_pop_box",children:[(0,ze.jsx)(v.View,{className:"pop_bd",children:t}),n&&(0,ze.jsx)(v.View,{className:"pop_foot flexbox",children:n()})]}),(0,ze.jsx)(v.View,{className:"pop_mask",onClick:function(){a&&a()}})]})},Rt=m._,Et=function(e){var t=function(e,t){return e?(0,ze.jsx)(v.Text,{className:"pop_btn flex_1 f_ctrip",onClick:function(){t&&t()},children:e}):null},n=function(e){return(0,ze.jsx)(v.View,{className:"pro_pop_list",children:e.map((function(e){return(0,ze.jsx)(v.View,{className:"li",children:e})}))})},a=e.data,i=e.callback,r=a.title,s=a.bottomTitle,o=a.contentList;return(0,ze.jsxs)(Lt,{renderBottom:function(){return t(s,i)},children:[(0,ze.jsx)(v.View,{className:"pro_pop_tit",children:r}),!Rt.isEmpty(o)&&(0,ze.jsx)(v.View,{className:"pop_bd",children:n(o)})]})},Mt=Et,Vt=m._;function Ot(){var e=10650011116,t=Se.useActions(),n=t.initData,a=t.setPageFlag,i=t.setTempData,r=t.initPageParams,s=t.handleFreeCheckBaggage,o=t.handleReturnFlightList,c=t.setPageData,l=Se.useState((function(e){return{pageFlag:e.pageFlag,pageParams:e.pageParams,tempData:e.tempData,CabinListVMInfo:e.CabinListVMInfo,segmentTipsCardInfo:e.segmentTipsCardInfo,flightSearchHornList:e.flightSearchHornList}})),u=l.pageFlag,d=l.pageParams,p=l.tempData,g=l.CabinListVMInfo,h=l.segmentTipsCardInfo,m=l.flightSearchHornList,x=p,I=x.planeDetailMaskInfo,k=d.freeCheckBaggage,_=d.selectedToken,w=g.newCabinObject,C=void 0===w?{}:w,S=g.defaultCabinTab,y=Vt.keys(C)||[],P=(0,Qe.useState)(S),N=(0,Ke.Z)(P,2),j=N[0],Z=N[1],F=(0,Qe.useState)("1"===k),D=(0,Ke.Z)(F,2),L=D[0],R=D[1],E=(0,Qe.useState)(!1),M=(0,Ke.Z)(E,2),V=M[0],O=M[1],H=(0,vt.B)(),q=H.handleBackToFlightList,A=H.getQConfig,B=u.showFlightSearchHornMask,U=u.showNoticeModalPanel,X=u.hasFreeBaggage,Y=function(){q({selectedToken:_})},G=(0,Qe.useCallback)((function(e,t){a((0,f.Z)({},e,t))}),[]),K=function(){var e=(0,T.Z)((0,b.Z)().mark((function e(){var t;return(0,b.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,A("pkgtips");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:t=e.t0,c({pkgTips:t});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,Qe.useEffect)((function(){K(),r(),n()}),[]),(0,Qe.useEffect)((function(){R("1"===k)}),[d]),(null===y||void 0===y?void 0:y.length)>0&&setTimeout((function(){return O(!0)}),1e3),j=j||S,(0,ze.jsxs)(v.View,{className:"cabinlist-body",children:[(0,ze.jsx)($e.Z,{title:"\u9009\u62e9\u8231\u4f4d",handleBack:Y,pageId:e}),(0,ze.jsxs)(v.View,{className:"container",children:[m&&0!==m.length?(0,ze.jsx)(Dt.Z,{handleSetPageFlag:G,flightSearchHornList:m}):null,(0,ze.jsx)(ft,{pageId:e,pageParams:d,CabinListVMInfo:g}),!Vt.isEmpty(h)&&(0,ze.jsx)(jt,{segmentTipsCardInfo:h,pageId:e}),y.length>1?(0,ze.jsxs)(v.View,{className:"cabin_tab ".concat(V&&"cabin_tab_ease_in"),children:[(0,ze.jsxs)(v.View,{className:"btn_body",onClick:function(){return Z("EC")},children:[(0,ze.jsx)(v.Text,{style:{color:"EC"===j?"#0086F6":"#333333"},className:"cabin_btn","data-testid":"economy_class",children:"\u7ecf\u6d4e\u8231"}),"EC"===j&&(0,ze.jsx)(v.View,{className:"active_btn"})]}),(0,ze.jsx)(v.View,{className:"split_line"}),(0,ze.jsxs)(v.View,{className:"btn_body",onClick:function(){return Z("FC")},children:[(0,ze.jsx)(v.Text,{style:{color:"FC"===j?"#0086F6":"#333333"},"data-testid":"first_class",className:"cabin_btn",children:"\u516c\u52a1/\u5934\u7b49\u8231"}),"FC"===j&&(0,ze.jsx)(v.View,{className:"active_btn"})]}),V&&X&&(0,ze.jsxs)(v.View,{className:"free_baggage_body",children:[(0,ze.jsx)(v.Text,{className:L?"bag_icon select_bag":"bag_icon unselect_bag",onClick:function(){s(L?"0":"1"),R(!L)}}),(0,ze.jsx)(v.Text,{className:"free_txt",children:"\u4ec5\u770b\u514d\u8d39\u6258\u8fd0\u884c\u674e"})]})]}):!u.showSkeletonPage&&X&&(0,ze.jsxs)(v.View,{className:"free_baggage_body_inner cabin_tab ".concat(V&&"cabin_tab_ease_in"),children:[(0,ze.jsx)(v.Text,{className:L?"bag_icon select_bag":"bag_icon unselect_bag",onClick:function(){s(L?"0":"1"),R(!L)}}),(0,ze.jsx)(v.Text,{className:"free_txt",children:"\u4ec5\u770b\u514d\u8d39\u6258\u8fd0\u884c\u674e"})]}),!u.showSkeletonPage&&!u.showPageEmpty&&(0,ze.jsx)(v.View,{className:"cabin_list_content",children:(0,ze.jsx)(Pt,{pageId:e,cabinList:C[j]})}),u.showSkeletonPage&&(0,ze.jsx)(Ft,{}),u.showFlightInfoMask&&(0,ze.jsx)(v.View,{"data-testid":"FlightDetailMask",children:(0,ze.jsx)(We.FlightDetailMask,{flightDetailInfo:I,handleHiddenMask:function(){a({showFlightInfoMask:!1}),i({planeDetailMaskInfo:{}})}})}),u.showTransferInfoMask&&(0,ze.jsx)(We.FlightTransferMask,{handleHiddenMask:function(){a({showTransferInfoMask:!1}),i({transferMaskInfo:{}})},transferMaskInfo:null===p||void 0===p?void 0:p.transferMaskInfo}),u.showCabinFareRemark&&(0,ze.jsx)(We.FlightFareRemarkMask,{fareMaskInfo:null===p||void 0===p?void 0:p.cabinMaskInfo,handleHiddenMask:function(){a({showCabinFareRemark:!1}),i({cabinMaskInfo:{}})}}),u.showPageEmpty&&(0,ze.jsx)(v.View,{className:m?"page_status page_status_spc_horn":"page_status",children:(0,ze.jsxs)(v.View,{className:"full_failure",children:[(0,ze.jsx)(v.View,{className:"p",children:"\u5f53\u524d\u822a\u73ed\u4ef7\u683c\u53d1\u751f\u4e86\u53d8\u52a8\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u822a\u73ed"}),(0,ze.jsx)(v.View,{className:"full_failure_btn blue_bor",id:"diy-".concat(e,"-mask-button"),onClick:function(){o()},children:"\u91cd\u9009\u822a\u73ed"})]})}),B?(0,ze.jsx)(We.FlightTravelRemindMask,{onHidden:function(){G("showFlightSearchHornMask",!1)},flightSearchHornList:m}):null,U?(0,ze.jsx)(Mt,{data:null===p||void 0===p?void 0:p.noticeModalInfo,callback:o}):null]})]})}var Ht,qt,At=Ot,Bt=m._,Ut=m.PureModel,Xt=m.MODEL_CONTEXT;ye.Z.init((0,h.Z)((0,h.Z)((0,h.Z)({},Pe.R1),Pe.XN),Ne.Z));var Yt={getShark:ye.Z.getShark,getPriceString:ye.Z.numberFormat.currencyString},Gt=(Ht=Ut({CabinModel:Se,BaseModel:Xe}),Ht(qt=function(e){(0,p.Z)(n,e);var t=(0,g.Z)(n);function n(e){var a;return(0,l.Z)(this,n),a=t.call(this,e),(0,f.Z)((0,d.Z)(a),"pageId",10650011116),(0,f.Z)((0,d.Z)(a),Xt,(0,h.Z)((0,h.Z)({},a[Xt]),x.G1.impl({SharkUtil:Yt}))),(0,f.Z)((0,d.Z)(a),"handleBackToFlightList",(function(e){a.diyBackPage({pageOptions:e})})),(0,f.Z)((0,d.Z)(a),"handleGetPkgTip",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Se.useState((function(e){return{pkgTips:e.pkgTips}})),a=n.pkgTips;if(!Bt.isEmpty(a)&&"flight"===e){var i=t.tipType,r=t.placeholders,s=void 0===r?[]:r,o=Bt.get(a,"".concat(e,".").concat(i),"");return Bt.map(s,(function(e,t){o="object"!==(0,c.Z)(e)?o.replace("{".concat(t,"}"),e):(0,ze.jsxs)(v.View,{children:[o.split("{".concat(t,"}"))[0],e,o.split("{".concat(t,"}"))[1]]})})),o}})),a}return(0,u.Z)(n,[{key:"render",value:function(){return(0,ze.jsx)(Ge.Z.Provider,{value:this,children:(0,ze.jsx)(At,{})})}}]),n}(Ye.Z))||qt),Kt={navigationStyle:"custom"};Page((0,o.createPageConfig)(Gt,"pages/shoppingcartflight/flight/cabinList/index",{root:{cn:[]}},Kt||{}))},79181:function(e){e.exports=require("../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../cwx/ext/global")},33675:function(e){e.exports=require("../../../../cwx/cwx")},46346:function(e){e.exports=require("../../../../cwx/ext/global")}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[4517,2107,1216,8592],(function(){return t(16103)}));e.O()}]);
//# sourceMappingURL=index.js.map