"use strict";require("../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[9446],{88287:function(e,t,n){var r,i,a=n(32180),o=n(79301),s=n(95308),c=n(298),l=n(57042),u=n(24460),d=n(81876),f=n(21867),p=n(86066),m=n(45023),I=n(36517),h=n(90129),g=n(90201),v=n(92954),x=n.n(v),S=n(71515),T=n(68277),P=n(86582),y=n(22276),w=n(22394),C="37"===P.Mx.appId,N=!C,D=P.Mx.version,j=/(\d+)\.(\d+)\.?(\d+)?/,_=(D.replace(j,(function(e,t,n,r){var i=function(e,t){if(e=e.toString(),e.length<t){var n=new Array(t).join("0");e=(n+e).substr(-t)}return e};return n=i(n,2),r=r?i(r,3):"000",t+n+r})),{fat:"https://m.ctrip.fat67.qa.nt.ctripcorp.com",uat:"https://m.ctrip.uat.qa.nt.ctripcorp.com",prd:"https://m.ctrip.com",prod:"https://m.ctrip.com"}[P.Xb.getEnvType()]),b=["CostInfoList","FeeInfoList","OrderKnow","Visa","SelfPayInfoList","PMRecomendInfo","DescriptionInfo","TravelIntroductionInfo","priceCalendar","groupChildren","productExtend","servicePerson","userDestinationOrder","askStatus","imageStyleInfo"],k=["copiedOriginalProductState","newProcessSelectDate"],L=["copiedNewProductState","newProcessSelectDate"],B=["PriceInfo","CostInfoList","FeeInfoList","OrderKnow","Visa","SelfPayInfoList","PMRecomendInfo","DescriptionInfo","TravelIntroductionInfo","priceCalendar","groupChildren","servicePerson","userDestinationOrder","askStatus"],R={UPDATE_STATE:function(e,t){return(0,c.Z)((0,c.Z)({},e),t)},UPDATE_POP_STATUS:function(e,t){return(0,c.Z)((0,c.Z)({},e),t)},UPDATE_URL_QUERY:function(e,t){var n=e.query;return(0,c.Z)((0,c.Z)({},e),{},{query:(0,c.Z)((0,c.Z)({},n),t)})},UPDATE_PRODUCT_BASIC_INFO:function(e,t){var n=t.pageSetting,r=t.productInfo,i=t.userInfo,a=t.isLogin,o=t.CruiseDepartDate,s=t.wakenUpData,l=t.isPreSale,u=t.isShowD2DSwitch,d=t.isShowD2DSwitch_p2c,f=e.query,p=e.pageStatus,m=r.BasicInfo,I=r.MediaInfo,h=r.TagGroupInfo,g=r.BookInfo,v=r.ScheduleInfo,x=r.PriceInfo,S=r.BasicExtendInfo,T=r.TourGroupInfo,P=r.ExtInfo,y=r.qConfig,C=r.TravelList,N=r.SegmentInfo,D=m.isCruise,j=m.isStudy,_=m.isDiyfhxsdp,b=m.isPureDiyfhxsdp,k=I||{},L=k.ImgList,B=void 0===L?[]:L,R=k.categoryStrategy,M=I&&I.VideoInfoList&&I.VideoInfoList.length>0,E=!!g.EffectTime&&-1===g.EffectTime.indexOf("-0000"),A=E?{SaleStartTime:w.Z.transformTimeStamp(g.EffectTime),SaleEndTime:w.Z.transformTimeStamp(g.ExpireTime),ServerTime:w.Z.transformTimeStamp(v.ServiceDateTime),Status:""}:null,Z=!g.IsBook||!v||!v.HasInventory||A&&"end"===A.Status,O=T.TourGroupProductInfo,U=h.SpecialTagList,F=void 0===U?[]:U,G=!!O&&O.length>1,H=!!C&&C.length>1,K=m.ProductId,z=C&&C.length>0?C[0].Alias:"";p=(0,c.Z)((0,c.Z)({},p),{},{isRetail:"R"===m.SaleMode,isAgent:"P"===m.SaleMode,prodType:D?"cru":j?"stt":_?"diy":"grp",isCrhTag:"crh"===f.identifier,hasVideo:M,isSetCountDown:E,isShowSoldOutRecommend:Z,isMultiLine:G,isMultiTravel:H,activeProductId:K,activeAlias:z,isExtendedStay:b&&N&&!N.IsFixSegment});var W=V(P),q=W.isMemberDiscountProduct,Y=W.isShowMemberDiscountInfo,$=W.isShowFlightDiscountInfo,J=W.memeberDiscount,Q=y||{},X=Q.isPremium;6===m.Level&&(X=!0);var ee={isLoaded:!0,SubName:m.SubName,BookInfo:g,TagGroupInfo:h,BasicExtendInfo:S,PriceInfo:x,SegmentInfo:N,MediaInfo:I,isMemberDiscountProduct:q,isShowMemberDiscountInfo:Y,isShowFlightDiscountInfo:$,memeberDiscount:J,BookingDay:m.BookingDay,BookingTime:m.BookingTime},te={};G?O.forEach((function(e){te[e.ProductId]=e.ProductId===K?ee:{isLoaded:!1}})):H&&C.forEach((function(e){te[e.Alias]=e.Alias===z?ee:{isLoaded:!1}}));var ne={pageSetting:n,userInfo:i,isLogin:a,CruiseDepartDate:o,wakenUpData:s},re=2===R,ie=1===R||2===R,ae=!1,oe=!1;F.forEach((function(e,t){2173==(null===e||void 0===e?void 0:e.TagId)&&(ae=ie,oe=!0)}));var se=[];if(B&&B[0]&&B[0].UrlList&&B[0].UrlList[0]){var ce=B[0].UrlList[0].Value;ce&&(ce=ce.replace("750_420_Q90.jpg","640_640_Q80.webp"),se.push(ce))}return(0,c.Z)((0,c.Z)((0,c.Z)((0,c.Z)({},e),r),ne),{},{isPremium:X,pageStatus:p,currentRouteInfo:ee,countDownStatus:A,isMemberDiscountProduct:q,isShowMemberDiscountInfo:Y,isShowFlightDiscountInfo:$,memeberDiscount:J,routeInfo:te,isPreSale:l,isShowD2DSwitch:u,isShowD2DSwitch_p2c:d,isTpalStyle:ae,isTpalStyleForFlightDiscount:oe,mediaInfoCurRoute:I,isTabStyle:ie,isImageUpdateVersionB:re,preloadProductImageList:se})},SWITCH_TO_NEW_PRODUCT:function(e,t){var n=t.productInfo,r=e.pageStatus,i=e.MediaInfo,a=e.isTabStyle,o=n.BasicInfo,s=n.TagGroupInfo,l=n.BookInfo,u=n.PriceInfo,d=n.BasicExtendInfo,f=n.TourGroupInfo,p=n.ExtInfo,m=n.qConfig,I=n.TravelList,h=n.SegmentInfo,g=n.MediaInfo,v=(n.expertInfo,f.TourGroupProductInfo),x=!!v&&v.length>1,S=!!I&&I.length>1,T=o.ProductId,P=I&&I.length>0?I[0].Alias:"",y=g&&g.VideoInfoList&&g.VideoInfoList.length>0,w=r.hasVideo;r=(0,c.Z)((0,c.Z)({},r),{},{isMultiLine:x,isMultiTravel:S,activeProductId:T,activeAlias:P,hasVideo:a?y:w});var C=m.isPremium;6===o.Level&&(C=!0);var N=(0,c.Z)((0,c.Z)({isLoaded:!0,SubName:o.SubName,BookInfo:l,TagGroupInfo:s,BasicExtendInfo:d,PriceInfo:u,SegmentInfo:h,MediaInfo:g},V(p)),{},{BookingDay:o.BookingDay,BookingTime:o.BookingTime}),D={};return x?v.forEach((function(e){D[e.ProductId]=e.ProductId===T?N:{isLoaded:!1}})):S&&I.forEach((function(e){D[e.Alias]=e.Alias===P?N:{isLoaded:!1}})),(0,c.Z)((0,c.Z)((0,c.Z)((0,c.Z)({},e),{},{copiedOriginalProductState:e},n),{},{isPremium:C,pageStatus:r,currentRouteInfo:N},V(p)),{},{routeInfo:D,mediaInfoCurRoute:g,MediaInfo:i,priceCalendar:null,newProcessSelectDate:""})},SWITCH_TO_NEW_PRODUCT_SECOND:function(e,t){var n=t.other,r=t.PreSaleProductInfo,i=e.pageStatus,a=e.currentRouteInfo,o=e.routeInfo,s=e.productExtend,l=i.isMultiLine,u=i.isMultiTravel,d=i.activeProductId,f=i.activeAlias,p=n.CostInfoList,m=n.FeeInfoList,I=n.OrderKnow,h=n.Visa,g=n.SelfPayInfoList,v=n.PMRecomendInfo,x=n.DescriptionInfo,S=n.TravelIntroductionInfo,P=n.priceCalendar,y=(n.groupChildren,n.productExtend),w=n.servicePerson,C=n.userDestinationOrder,N=n.askStatus,D=n.imageStyleInfo,j=(0,T.Z)(n,b);return a=(0,c.Z)((0,c.Z)({},a),{},{CostInfoList:p,FeeInfoList:m,OrderKnow:I,Visa:h,SelfPayInfoList:g,PMRecomendInfo:v,DescriptionInfo:x,TravelIntroductionInfo:M(S),scheduleDates:P.scheduleDates,dailyMinPrices:P.dailyMinPrices,servicePerson:w,userDestinationOrder:C,askStatus:N,imageStyleInfo:D}),r&&r.PreSaleNotice&&(a=(0,c.Z)((0,c.Z)({},a),{},{PreSaleNotice:r.PreSaleNotice,PreSaleTagGroupInfo:r.TagGroupInfo})),l?o[d]=a:u&&(o[f]=a),y=(0,c.Z)((0,c.Z)({},y),{},{MoreRecommendProductList:s.MoreRecommendProductList}),(0,c.Z)((0,c.Z)((0,c.Z)({},e),j),{},{priceCalendar:P,currentRouteInfo:a,routeInfo:o,MainPMRecomendInfo:v,secondInfoLoaded:!0,productExtend:y})},SWITCH_BACKTO_ORIGINAL_PRODUCT:function(e){var t=e.copiedOriginalProductState,n=e.newProcessSelectDate,r=(0,T.Z)(e,k);return t?(0,c.Z)((0,c.Z)({},t),{},{copiedNewProductState:r,pageStatus:(0,c.Z)((0,c.Z)({},t.pageStatus),{},{curD2DSwitchType:t.pageStatus.initD2DSwitchType}),newProcessSelectDate:n}):e},SWITCH_BACKTO_NEW_PRODUCT:function(e){var t=e.copiedNewProductState,n=e.newProcessSelectDate,r=(0,T.Z)(e,L),i=1===t.pageStatus.initD2DSwitchType?2:1;return(0,c.Z)((0,c.Z)({},t),{},{copiedOriginalProductState:r,pageStatus:(0,c.Z)((0,c.Z)({},t.pageStatus),{},{curD2DSwitchType:i}),newProcessSelectDate:n})},RESET_D2DCOPIED_STORE:function(e){var t=e.pageStatus;return(0,c.Z)((0,c.Z)({},e),{},{copiedOriginalProductState:null,copiedNewProductState:null,pageStatus:(0,c.Z)((0,c.Z)({},t),{},{curD2DSwitchType:t.initD2DSwitchType})})},REFRESH_PRICE_INFO:function(e,t){var n=t.productInfo,r=e.pageStatus,i=e.currentRouteInfo,a=e.routeInfo,o=n.BasicInfo,s=n.BookInfo,l=n.ScheduleInfo,u=n.PriceInfo,d=n.priceCalendar,f=n.groupCard,p=o.ProductId,m=r,I=m.isMultiLine,h=m.isMultiTravel,g=m.activeProductId,v=m.activeAlias,x=i;return I&&(x=a[p]),h&&(x=a["A"]),i=(0,c.Z)((0,c.Z)({},x),{},{BookInfo:s,PriceInfo:u,scheduleDates:d.scheduleDates,dailyMinPrices:d.dailyMinPrices}),r=(0,c.Z)((0,c.Z)({},r),{},{activeProductId:p,activeAlias:"A"}),I?(a[p]=i,a[g].isLoaded=!1):h&&(a["A"]=i,a[v].isLoaded=!1),(0,c.Z)((0,c.Z)({},e),{},{pageStatus:r,ScheduleInfo:l,currentRouteInfo:i,routeInfo:a,groupCard:f})},UPDATE_PRODUCT_SECOND_INFO:function(e,t){var n,r=t.other,i=t.PreSaleProductInfo,a=t.isShowD2DSwitch,o=t.isShowD2DSwitch_p2c,s=e.pageStatus,l=e.currentRouteInfo,u=e.routeInfo,d=s,f=d.isMultiLine,p=d.isMultiTravel,m=d.activeProductId,I=d.activeAlias,h=r.PriceInfo,g=r.CostInfoList,v=r.FeeInfoList,x=r.OrderKnow,S=r.Visa,P=r.SelfPayInfoList,y=r.PMRecomendInfo,w=r.DescriptionInfo,C=r.TravelIntroductionInfo,N=r.priceCalendar,D=r.groupChildren,j=r.servicePerson,_=r.userDestinationOrder,b=r.askStatus,k=(0,T.Z)(r,B),L=r.expertInfo,R=r.imageStyleInfo;l=(0,c.Z)((0,c.Z)({},l),{},{PriceInfo:h,CostInfoList:g,FeeInfoList:v,OrderKnow:x,Visa:S,SelfPayInfoList:P,PMRecomendInfo:y,DescriptionInfo:w,TravelIntroductionInfo:M(C),scheduleDates:N.scheduleDates,dailyMinPrices:N.dailyMinPrices,servicePerson:j,userDestinationOrder:_,askStatus:b,imageStyleInfo:R});var E=null===L||void 0===L||null===(n=L.summary)||void 0===n?void 0:n.some((function(e){return(null===e||void 0===e?void 0:e.count)>0}));s.hasReviewInfo=E,i&&i.PreSaleNotice&&(l=(0,c.Z)((0,c.Z)({},l),{},{PreSaleNotice:i.PreSaleNotice,PreSaleTagGroupInfo:i.TagGroupInfo})),f?u[m]=l:p&&(u[I]=l);var V=!1,A=[];if(a&&D&&D.groups){var Z=D.groups;if(Z&&Z.length){var O=Z.filter((function(e){return 2===e.type}));O&&O.length&&(A=O.filter((function(e){return!!(e&&e.parentProductInfo&&e.parentProductInfo.canBook)})),s=(0,c.Z)((0,c.Z)({},s),{},{curD2DSwitchType:2,initD2DSwitchType:2}),A&&A.length&&(V=!0))}}var U=[];if(o&&D&&D.groups){var F=D.groups;if(F&&F.length){var G=F.filter((function(e){return 1===e.type&&!!e.childProductInfoList}));G&&G.length&&(U=G.map((function(e){var t=e.childProductInfoList,n=t.filter((function(e){return e.canBook}));return(0,c.Z)((0,c.Z)({},e),{},{childProductInfoList:n})})),s=(0,c.Z)((0,c.Z)({},s),{},{curD2DSwitchType:1,initD2DSwitchType:1}),U&&U.length&&(V=!0))}}return(0,c.Z)((0,c.Z)((0,c.Z)({},e),k),{},{PriceInfo:h,priceCalendar:N,currentRouteInfo:l,routeInfo:u,MainPMRecomendInfo:y,pageStatus:s,secondInfoLoaded:!0,ParentsProductList:A,ChildrenProductList:U,isShowD2DSwitchTab:V})},UPDATE_COMPOSITE_COUPON_INFO:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{compositeCoupon:t})},UPDATE_CRUISE_TIMING_INFO:function(e,t){var n=e.currentRouteInfo,r=t.PriceInfo,i=t.TravelIntroductionInfo;return n=(0,c.Z)((0,c.Z)({},n),{},{TravelIntroductionInfo:M(i)}),(0,c.Z)((0,c.Z)({},e),{},{PriceInfo:r,currentRouteInfo:n})},UPDATE_COUPON_COMPONENT_DATA:function(e,t){var n=t.availableClaimList,r=t.availableUseList,i=t.singkekList,a=t.receivedNouseList;return E(e,{CouponInfo:{availableClaimList:n,availableUseList:r,singkekList:i,receivedNouseList:a}})},UPDATE_EMPTY_COUPON_COMPONENT_DATA:function(e){return E(e,{CouponInfo:{}})},SET_USER_INFO:function(e,t){return(0,c.Z)((0,c.Z)({},e),t)},UPDATE_STORE_INFO:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{NearbyStoreInfo:t})},UPDATE_FAVOURITE_STATUS:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{myFavorites:t})},UPDATE_FAVOURITE_MENU:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{favoriteMenuStatus:t})},UPDATE_CURRENT_ROUTE:function(e,t){var n=e.pageStatus,r=e.isTabStyle,i=n.activeProductId,a=n.activeAlias,o=t.targetProductId,s=void 0===o?i:o,l=t.targetAlias,u=void 0===l?a:l,d=t.targetRouteItem,f=(null===d||void 0===d?void 0:d.MediaInfo)&&d.MediaInfo.VideoInfoList&&d.MediaInfo.VideoInfoList.length>0,p=n.hasVideo;return(0,c.Z)((0,c.Z)({},e),{},{pageStatus:(0,c.Z)((0,c.Z)({},n),{},{activeProductId:s,activeAlias:u,hasVideo:r?f:p}),currentRouteInfo:d,mediaInfoCurRoute:(null===d||void 0===d?void 0:d.MediaInfo)||{}})},UPDATE_MULTIPLE_LINE:function(e,t){var n=e.routeInfo,r=e.pageStatus,i=e.currentRouteInfo,a=e.isTabStyle,o=t.productInfo,s=t.targetProductId,l=t.PreSaleProductInfo,u=o.BasicInfo,d=o.TagGroupInfo,f=o.PMRecomendInfo,p=o.DescriptionInfo,I=o.TravelIntroductionInfo,h=o.CostInfoList,g=o.FeeInfoList,v=o.OrderKnow,x=o.Visa,S=o.SegmentInfo,T=o.SelfPayInfoList,P=o.BasicExtendInfo,y=o.BookInfo,w=o.PriceInfo,C=o.bookingRuleInfo,N=o.priceCalendar,D=o.emotionalCues,j=o.servicePerson,_=o.userDestinationOrder,b=o.askStatus,k=o.ExtInfo,L=o.MediaInfo,B=o.imageStyleInfo,R=L&&L.VideoInfoList&&L.VideoInfoList.length>0,E=(0,c.Z)((0,c.Z)({isLoaded:!0,SubName:u.SubName,TagGroupInfo:d,PMRecomendInfo:f,DescriptionInfo:p,TravelIntroductionInfo:M(I),CostInfoList:h,FeeInfoList:g,OrderKnow:v,Visa:x,SegmentInfo:S,SelfPayInfoList:T,BasicExtendInfo:P,BookInfo:y,CouponInfo:i.CouponInfo,PriceInfo:w,scheduleDates:N.scheduleDates,dailyMinPrices:N.dailyMinPrices,servicePerson:j,userDestinationOrder:_,askStatus:b,MediaInfo:L,imageStyleInfo:B},V(k)),{},{BookingDay:u.BookingDay,BookingTime:u.BookingTime});l&&l.PreSaleNotice&&(E=(0,c.Z)((0,c.Z)({},E),{},{PreSaleNotice:l.PreSaleNotice,PreSaleTagGroupInfo:l.TagGroupInfo}));var A=r.hasVideo;return(0,c.Z)((0,c.Z)({},e),{},{pageStatus:(0,c.Z)((0,c.Z)({},r),{},{activeProductId:s,hasVideo:a?R:A}),routeInfo:(0,c.Z)((0,c.Z)({},n),{},(0,m.Z)({},s,E)),currentRouteInfo:E,bookingRuleInfo:C,emotionalCues:D,mediaInfoCurRoute:L})},SET_LINE_SWITCH_LOADING:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{isShowLineSwitchLoading:t})},UPDATE_PROPOSAL_ORDER_STATUS:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{isProposalOrderTexted:t})},UPDATE_PROPOSAL_ORDER_INFO:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{proposalOrderInfo:t})},UPDATE_MULTIPLE_TRAVEL:function(e,t){var n=e.routeInfo,r=e.pageStatus,i=e.currentRouteInfo,a=t.productInfo,o=t.targetAlias,s=a.TravelIntroductionInfo,l=a.SegmentInfo,u=a.Visa,d=a.FeeInfoList,f=a.imageStyleInfo,p=(0,c.Z)((0,c.Z)({},i),{},{isLoaded:!0,TravelIntroductionInfo:M(s),SegmentInfo:l,Visa:u,FeeInfoList:d,imageStyleInfo:f});return(0,c.Z)((0,c.Z)({},e),{},{pageStatus:(0,c.Z)((0,c.Z)({},r),{},{activeAlias:o}),routeInfo:(0,c.Z)((0,c.Z)({},n),{},(0,m.Z)({},o,p)),currentRouteInfo:p})},TOGGLE_CITY_SELECT_MASK:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{isShowCitySelectMask:t})},UPDATE_NEWDEPARTCITY_INFO:function(e,t){var n,r,i,a,o,s=e.pageStatus,l=e.BasicInfo,u=e.MediaInfo,d=e.currentRouteInfo,f=e.PreSaleProductInfo,p=s,I=p.isMultiLine,h=p.isMultiTravel,g=p.activeAlias,v=t.MainProductInfo,x=v.BasicInfo,S=v.MediaInfo,T=v.TagGroupInfo,P=v.BookInfo,y=v.SegmentInfo,w=v.PriceInfo,C=v.PMRecomendInfo,N=v.DescriptionInfo,D=v.TourGroupInfo,j=v.TravelIntroductionInfo,_=v.CostInfoList,b=v.FeeInfoList,k=v.OrderKnow,L=v.Visa,B=v.SelfPayInfoList,R=v.BasicExtendInfo,E=v.TravelList,A=v.priceCalendar;x.ProductId!==l.ProductId&&(x=(0,c.Z)((0,c.Z)({},x),{},{ProductId:l.ProductId,MainName:l.MainName,SubName:l.SubName}),S=u);var Z={},O=(0,c.Z)((0,c.Z)({isLoaded:!0,SubName:x.SubName,TagGroupInfo:T,PMRecomendInfo:C,DescriptionInfo:N,TravelIntroductionInfo:M(j),CostInfoList:_,FeeInfoList:b,OrderKnow:k,Visa:L,SegmentInfo:y,SelfPayInfoList:B,BasicExtendInfo:R,BookInfo:P,PriceInfo:w,scheduleDates:A.scheduleDates,dailyMinPrices:A.dailyMinPrices,servicePerson:null===(n=t.MainProductInfo)||void 0===n?void 0:n.servicePerson,userDestinationOrder:null===(r=t.MainProductInfo)||void 0===r?void 0:r.userDestinationOrder,askStatus:null===(i=t.MainProductInfo)||void 0===i?void 0:i.askStatus,MediaInfo:S,imageStyleInfo:null===(a=t.MainProductInfo)||void 0===a?void 0:a.imageStyleInfo},V(null===(o=t.MainProductInfo)||void 0===o?void 0:o.ExtInfo)),{},{BookingDay:x.BookingDay,BookingTime:x.BookingTime});if(I){var U,F,G,H,K,z,W,q,Y,$,J,Q,X,ee,te,ne,re,ie,ae,oe,se,ce,le,ue;D.TourGroupProductInfo.forEach((function(e){Z[e.ProductId]=e.ProductId===x.ProductId?O:{isLoaded:!1}}));var de=(0,c.Z)((0,c.Z)({isLoaded:!0,SubName:null===(U=t.RouteProductInfo)||void 0===U?void 0:U.BasicInfo.SubName,TagGroupInfo:null===(F=t.RouteProductInfo)||void 0===F?void 0:F.TagGroupInfo,PMRecomendInfo:null===(G=t.RouteProductInfo)||void 0===G?void 0:G.PMRecomendInfo,DescriptionInfo:null===(H=t.RouteProductInfo)||void 0===H?void 0:H.DescriptionInfo,TravelIntroductionInfo:M(null===(K=t.RouteProductInfo)||void 0===K?void 0:K.TravelIntroductionInfo),CostInfoList:null===(z=t.RouteProductInfo)||void 0===z?void 0:z.CostInfoList,FeeInfoList:null===(W=t.RouteProductInfo)||void 0===W?void 0:W.FeeInfoList,OrderKnow:null===(q=t.RouteProductInfo)||void 0===q?void 0:q.OrderKnow,Visa:null===(Y=t.RouteProductInfo)||void 0===Y?void 0:Y.Visa,SegmentInfo:null===($=t.RouteProductInfo)||void 0===$?void 0:$.SegmentInfo,SelfPayInfoList:null===(J=t.RouteProductInfo)||void 0===J?void 0:J.SelfPayInfoList,BasicExtendInfo:null===(Q=t.RouteProductInfo)||void 0===Q?void 0:Q.BasicExtendInfo,BookInfo:null===(X=t.RouteProductInfo)||void 0===X?void 0:X.BookInfo,PriceInfo:null===(ee=t.RouteProductInfo)||void 0===ee?void 0:ee.PriceInfo,scheduleDates:null===(te=t.RouteProductInfo)||void 0===te?void 0:te.priceCalendar.scheduleDates,dailyMinPrices:null===(ne=t.RouteProductInfo)||void 0===ne?void 0:ne.priceCalendar.dailyMinPrices,servicePerson:null===(re=t.RouteProductInfo)||void 0===re?void 0:re.servicePerson,userDestinationOrder:null===(ie=t.RouteProductInfo)||void 0===ie?void 0:ie.userDestinationOrder,askStatus:null===(ae=t.RouteProductInfo)||void 0===ae?void 0:ae.askStatus,imageStyleInfo:null===(oe=t.RouteProductInfo)||void 0===oe?void 0:oe.imageStyleInfo,MediaInfo:S},V(null===(se=t.RouteProductInfo)||void 0===se?void 0:se.ExtInfo)),{},{BookingDay:null===(ce=t.RouteProductInfo)||void 0===ce?void 0:ce.BasicInfo.BookingDay,BookingTime:null===(le=t.RouteProductInfo)||void 0===le?void 0:le.BasicInfo.BookingTime});f&&f.PreSaleNotice&&(de=(0,c.Z)((0,c.Z)({},de),{},{PreSaleNotice:f.PreSaleNotice,PreSaleTagGroupInfo:f.TagGroupInfo}));var fe=null===(ue=t.RouteProductInfo)||void 0===ue?void 0:ue.BasicInfo.ProductId;Z=(0,c.Z)((0,c.Z)({},Z),{},(0,m.Z)({},fe,de)),s=(0,c.Z)((0,c.Z)({},s),{},{activeProductId:fe}),O=de}else if(h){var pe,me,Ie,he,ge,ve,xe,Se;E.forEach((function(e){Z[e.Alias]=e.Alias===E[0].Alias?O:{isLoaded:!1}}));var Te=(0,c.Z)((0,c.Z)({},O),{},{isLoaded:!0,TravelIntroductionInfo:M(null===(pe=t.RouteProductInfo)||void 0===pe?void 0:pe.TravelIntroductionInfo),SegmentInfo:null===(me=t.RouteProductInfo)||void 0===me?void 0:me.SegmentInfo,FeeInfoList:null===(Ie=t.RouteProductInfo)||void 0===Ie?void 0:Ie.FeeInfoList,servicePerson:null===(he=t.RouteProductInfo)||void 0===he?void 0:he.servicePerson,userDestinationOrder:null===(ge=t.RouteProductInfo)||void 0===ge?void 0:ge.userDestinationOrder,askStatus:null===(ve=t.RouteProductInfo)||void 0===ve?void 0:ve.askStatus,imageStyleInfo:null===(xe=t.RouteProductInfo)||void 0===xe?void 0:xe.imageStyleInfo,MediaInfo:S},V(null===(Se=t.RouteProductInfo)||void 0===Se?void 0:Se.ExtInfo));Z=(0,c.Z)((0,c.Z)({},Z),{},(0,m.Z)({},g,Te)),O=Te}return d&&d.CouponInfo&&(O=(0,c.Z)((0,c.Z)({},O),{},{CouponInfo:d.CouponInfo})),(0,c.Z)((0,c.Z)((0,c.Z)({},e),t.MainProductInfo),{},{pageStatus:s,MediaInfo:S,routeInfo:Z,currentRouteInfo:O})},UPDATE_SERVICE_PERSONS:function(e,t){var n=e.servicePersons,r=t||{},i=r.servicePersons;return n=n||{},i=i||{},(0,c.Z)((0,c.Z)({},e),{},{servicePersons:(0,c.Z)((0,c.Z)({},n),i)})},UPDATE_QCONFIG_INFO:function(e,t){return(0,c.Z)((0,c.Z)({},e),t)},TOGGLE_ROUTE_MODE:function(e){var t=e.isSimpleMode;return(0,c.Z)((0,c.Z)({},e),{},{isSimpleMode:!t})},TOGGLE_SHOW_MENU_POP:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{isShowMenuPop:t})},UPDATE_LOCATION_INFO:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{LocationInfo:t})},UPDATE_FLIGHTDISCOUNT_INFO:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{flightDiscountInfo:t})},SET_PAGE_ID:function(e,t){var n="";if(C)n="ibugrp-10650028586";else{var r=e.pageStatus,i=r.prodType;n="".concat(i,"-").concat(t)}return(0,c.Z)((0,c.Z)({},e),{},{pageId:t,actionIdSuffix:n})},UPDATE_BRAND_INFO:function(e,t){var n=e.BasicInfo,r=n.BrandFloorId,i=t.filter((function(e){return e.id===r}))[0];return(0,c.Z)((0,c.Z)({},e),{},{SpecialBrandInfo:i})},UPDATE_SERVICE_TIP:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{serviceTip:t})},UPDATE_ALERT_MASK:function(e,t){var n=e.isShowCalendarPop,r=t.isShowAlertMask;return(0,c.Z)((0,c.Z)({},e),{},{isShowAlertMask:r,isShowCalendarPop:!r&&n,alertInfo:t})},SET_CITY_SELECT_MASK_INFO:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{citySelectTargetProductId:t})},HIDE_ALL_MASK:function(e){return(0,c.Z)((0,c.Z)({},e),W)},SET_COUNTDOWN_STATUS:function(e,t){var n=e.countDownStatus;return(0,c.Z)((0,c.Z)({},e),{},{countDownStatus:(0,c.Z)((0,c.Z)({},n),{},{Status:t})})},TOGGLE_PRESALE_NOTICE_MASK:function(e,t){var n=t.status,r=t.selectType;return(0,c.Z)((0,c.Z)({},e),{},{isShowPreSaleNoticeMask:n,PreSaleNoticeMaskSelectType:r})},UPDATE_BOOKINGRULE_INFO:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{BookingRuleInfo:t})},SET_BOOKING_RULE_FETCHED:function(e){return(0,c.Z)((0,c.Z)({},e),{},{BookingRuleFetched:!0})},SET_CONCAT_DATA:function(e,t){var n={};return t.forEach((function(e){e&&Object.keys(e).forEach((function(t){n[t]=e[t]}))})),(0,c.Z)((0,c.Z)({},e),n)},SET_CONCAT_DATA_SECOND_SCREEN:function(e,t){var n={};return t.forEach((function(e){e&&Object.keys(e).forEach((function(t){n[t]=e[t]}))})),(0,c.Z)((0,c.Z)((0,c.Z)({},e),n),{},{second_screen_fetched:!0})},SET_ABTEST_RESULT:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{ABTestResult:t})},SET_VIPMEMBER_INFO:function(e,t){var n=e.BasicInfo,r=t.SuperMemberInfo,i=t.UserInterestList,a=0,o=0;if(i&&i.length){var s=i.filter((function(e){return 66===e.CreateProductLineId}))[0],l=i.filter((function(e){return 61===e.CreateProductLineId}))[0];s&&(a=s.InterestCounts),l&&(o=l.InterestCounts)}var u=r&&r.IsSuperMember&&n.IsInternal&&[1,3,4].includes(n.ProductPatternId)&&o>0;return u||(o=0),(0,c.Z)((0,c.Z)({},e),{},{SuperMemberInfo:r,UserInterestList:i,hasSuperMemberRight:u,commonMemberInterestCounts:a,superMemberInterestCounts:o})},SET_FAVOURITE_MENU_POSITION:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{isShowHeaderMenu:t})},SET_CALENDAR_SELECTED_DATE:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{CalendarSelectedDate:t})},TOGGLE_SELFFUND_MASK:function(e,t){return(0,c.Z)((0,c.Z)({},e),t)},SET_CRUISE_BOOKING_INFO:function(e,t){var n=t.curDate;return(0,c.Z)((0,c.Z)({},e),{},{CruiseDepartDate:n,SelectedCruiseRoomInfo:null,CruisePriceInfo:null})},INIT_CRUISE_DATA:function(e,t){var n=t.RoomInfos,r=t.Tags,i=t.ClassRooms,a=n[0].RoomType,o={RoomInfos:n,Tags:(0,m.Z)({},a,r),ClassRooms:(0,m.Z)({},a,i.filter((function(e){return e.RoomType===a}))),curRoomType:a};return(0,c.Z)((0,c.Z)({},e),{},{CruiseRoomInfo:o,CruiseBookingStatus:"canbooking"})},RESET_CRUISE_DATA:function(e){return(0,c.Z)((0,c.Z)({},e),{},{ShoppingId:"",CruiseRoomInfo:null,CruiseBookingStatus:"loading",SelectedCruiseRoomInfo:[],CruisePriceInfo:null})},UPDATE_CRUISE_BOOKING_STATUS:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{CruiseBookingStatus:t})},INIT_CRUISE_ROOM_INFO:function(e,t){var n=t.RoomInfos,r=t.Tags,i=t.ClassRooms,a=n[0].RoomType,o={RoomInfos:n,Tags:(0,m.Z)({},a,r),ClassRooms:(0,m.Z)({},a,i.filter((function(e){return e.RoomType===a}))),curRoomType:a};return(0,c.Z)((0,c.Z)({},e),{},{CruiseRoomInfo:o,CruiseBookingStatus:"canbooking"})},UPDATE_CRUISE_ROOM_INFO:function(e,t){var n=e.CruiseRoomInfo,r=n,i=r.ClassRooms,a=r.Tags,o=t.cabinFilter,s=(t.RoomInfos,t.Tags),l=t.ClassRooms,u=o.RoomType;return n=(0,c.Z)((0,c.Z)({},n),{},{Tags:(0,c.Z)((0,c.Z)({},a),{},(0,m.Z)({},u,s)),ClassRooms:(0,c.Z)((0,c.Z)({},i),{},(0,m.Z)({},u,l)),curRoomType:u}),(0,c.Z)((0,c.Z)({},e),{},{CruiseRoomInfo:n})},SET_CUR_ROOMTYPE:function(e,t){var n=e.CruiseRoomInfo;return(0,c.Z)((0,c.Z)({},e),{},{CruiseRoomInfo:(0,c.Z)((0,c.Z)({},n),{},{curRoomType:t})})},SET_SELECT_ROOM_TAG:function(e,t){var n=e.CruiseRoomInfo,r=n.selectedTags,i=n.curRoomType;if(r&&r[i])if(r[i].find((function(e){return e.Type===t.Type&&e.Id===t.Id})))r[i]=r[i].filter((function(e){return e.Type!==t.Type||e.Id!==t.Id}));else if(2===t.Type){var a=r[i].filter((function(e){return 2!==e.Type}));r[i]=[].concat((0,y.Z)(a),[t])}else r[i].push(t);else r=r?(0,c.Z)((0,c.Z)({},r),{},(0,m.Z)({},i,[t])):(0,m.Z)({},i,[t]);return(0,c.Z)((0,c.Z)({},e),{},{CruiseRoomInfo:(0,c.Z)((0,c.Z)({},n),{},{selectedTags:r})})},RESET_SELECT_ROOM_TAG:function(e){var t=e.CruiseRoomInfo;return(0,c.Z)((0,c.Z)({},e),{},{CruiseRoomInfo:(0,c.Z)((0,c.Z)({},t),{},{selectedTags:null})})},INIT_SELECT_CRUISE_ROOM:function(e,t){var n=t.SelectedCruiseRoomInfo,r=t.CruisePriceInfo;return(0,c.Z)((0,c.Z)({},e),{},{SelectedCruiseRoomInfo:n,CruisePriceInfo:r})},UPDATE_SELECT_CRUISE_ROOM:function(e,t){var n=e.SelectedCruiseRoomInfo,r=t.RoomInfo,i=t.CountInfo,a=r.OvaryRoomId,o=r.Name,s=r.MinNum,l=r.MaxNum,u=r.Token,d=r.RoomType,f=r.ClassId,p=i.SelectedCount,m=i.AdultCount,I=void 0===m?0:m,h=i.ChildCount,g=void 0===h?0:h,v=i.Type;n=n||[];var x=n.slice();"Person"===v&&I+g>l*p&&(p=Math.min(p+1,9)),"Room"===v&&I+g>l*p&&(g>0?g<s?(I=l*p,g=0):g=Math.max(l*p-I,0):I=l*p);var S={OvaryRoomId:a,Name:o,AdultCount:I,ChildCount:g,SelectedCount:p,Token:u,RoomType:d,ClassId:f,MinNum:s,MaxNum:l};if(n.some((function(e){return e.OvaryRoomId===a}))){var T=n.findIndex((function(e){return e.OvaryRoomId===a}));x[T]=S}else x.push(S);return(0,c.Z)((0,c.Z)({},e),{},{SelectedCruiseRoomInfo:x,CruiseErrorTokenList:[],CruiseErrorText:""})},UPDATE_CRUISE_PRICE:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{CruisePriceInfo:t})},UPDATE_OVARYROOM_DETAIL:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{OvaryRoomDetailPopId:t})},UPDATE_CRUISE_JOURNEY_DETAIL:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{CruiseJourneyTourId:t})},UPDATE_OVARYROOM_PRICE_INFO:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{PriceDesc:t})},UPDATE_CRUISE_JOURNEYINFO:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{CruiseJourneyInfo:t})},UPDATE_ERROR_CRUISE_TOKEN:function(e,t){var n=t.TokenList,r=t.ErrorText,i=void 0===r?"":r,a=n[0].split("_")[1],o=e.CruiseRoomInfo;return(0,c.Z)((0,c.Z)({},e),{},{CruiseErrorTokenList:n,CruiseErrorText:i,CruiseRoomInfo:(0,c.Z)((0,c.Z)({},o),{},{curRoomType:a})})},TOGGLE_PASSENGR_TIP:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{isShowPassengerTip:t})},UPDATE_XREC_PRODUCT:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{XRecProductList:t})},SET_PRICECALENDAR_DATA_H5:function(e,t){var n,r=t.flatDailyMinPrice,i={};return null===(n=Object.keys(r))||void 0===n||n.forEach((function(e){i[e]={productPrices:r[e]}})),(0,c.Z)((0,c.Z)({},e),{},{priceCalendarData:(0,c.Z)((0,c.Z)({},t),{},{dailyMinPrice:i}),scheduleDisableDates:null})},SET_PRICECALENDAR_DATA:function(e,t){var n=e.newProcessSelectDate;return n&&t&&t.dailyMinPrice&&(t.dailyMinPrice[n]||(n="")),(0,c.Z)((0,c.Z)({},e),{},{priceCalendarData:t,newProcessSelectDate:n,scheduleDisableDates:null})},SET_NEWPROCESS_SELECT_DATE:function(e,t){var n=e.newProcessSelectDate;return(0,c.Z)((0,c.Z)({},e),{},{newProcessSelectDate:t,ExtendedStayShoppingInfo:null,isSelectPreSale:!1,lastSelectDate:n})},SET_PRIVATE_TIP_STATUS:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{isPrivateTipStillShow:t})},SET_EXTENDSTAY_SHOPPING:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{ExtendedStayShoppingInfo:t})},SET_EXTENDSTAY_PATH:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{extendStayPath:t})},SET_SHOW_DEPARTCITYINFO:function(e){return(0,c.Z)((0,c.Z)({},e),{},{isShowInitDepartCity:!0})},SET_SELECT_PRESALE_DATE:function(e){return(0,c.Z)((0,c.Z)({},e),{},{isSelectPreSale:!0,newProcessSelectDate:""})},SET_SHOW_PRESALE_MULTIROUTE:function(e){return(0,c.Z)((0,c.Z)({},e),{},{isShowMulitiRouteInPreSale:!0})},UPDATE_D2DSWITCH_STATUS:function(e,t){var n=e.pageStatus;return(0,c.Z)((0,c.Z)({},e),{},{pageStatus:(0,c.Z)((0,c.Z)({},n),{},{curD2DSwitchType:t})})},UPDATE_REFRESH_SELECTDATE_FLAG:function(e){var t=e.refreshSelectDateFlag,n=void 0===t?0:t;return(0,c.Z)((0,c.Z)({},e),{},{refreshSelectDateFlag:n+1})},SET_MULTITRAVEL_SCHEDATES:function(e,t){var n=e.routeInfo,r=(0,c.Z)((0,c.Z)({},n),{},{multiTravelScheduleDates:t});return(0,c.Z)((0,c.Z)({},e),{},{routeInfo:r})},SET_SCHEDULE_DISABLE_DATE:function(e,t){var n=e.scheduleDisableDates;return n=n||[],n.push(t),(0,c.Z)((0,c.Z)({},e),{},{scheduleDisableDates:n})},UPDATE_TRADE_MINPRICE_MODE:function(e,t){var n=e.pageStatus;return(0,c.Z)((0,c.Z)({},e),{},{pageStatus:(0,c.Z)((0,c.Z)({},n),{},{isTradeMinPriceMode:t})})},SET_D2DSWITCH_LOADING:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{isD2DSwitchLoading:t})},UPDATE_SECKILL_LIMIT_STATUS:function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{isSecKillLimit:t})}},M=function(e){if(e){var t=e.TravelIntroductionList;if(!t)return e;var n=t[0].IntroductionInfoList,r=n.map((function(e){var t=e.Desc,n=e.FewDay,r=e.TrafficType,i=e.DailyList,a=e.TravelDate,o=[],s=[],c=[],l=[],u=[],d=[],f=[],p=[];return i&&i.forEach((function(e){f.push(e),9===e.ActiveType&&e.Desc&&d.push(e),8===e.ActiveType&&e.Desc&&d.push(e),2===e.ActiveType&&e.Desc&&o.push(e);var t=3===e.ActiveType&&e.ScenicSpotList.some((function(e){return e.Name||e.PreName||e.SuffixName}));(t||[4,6,7,11].includes(e.ActiveType))&&c.push(e),12===e.ActiveType&&e.Desc&&c.push(e);var n=0===e.ActiveType&&(e.DinnerInfo&&e.DinnerInfo.DinnerType||e.Desc);if(n&&s.push(e),1===e.ActiveType||18===e.ActiveType){var r=e.HotelInfoList,i=e.Desc;(r&&r.length&&r[0].HotelName||i)&&u.push(e)}e.Themes&&e.Themes.length&&e.Themes.forEach((function(t){if(p.some((function(e){return e.CustomTheme===t.CustomTheme}))){var n=p.find((function(e){return e.CustomTheme===t.CustomTheme}));n.Infos.push({Time:e.DepartTime,fields:t.fields})}else{var r={CustomTheme:t.CustomTheme,CustomThemeDesc:t.CustomThemeDesc,Infos:[{Time:e.DepartTime,fields:t.fields}]};p.push(r)}}))})),{Desc:t,FewDay:n,TrafficType:r,flightList:o,dinnerList:s,scenicList:c,themeList:l,hotelList:u,listByTime:d,orderList:f,TravelDate:a,themeInfos:p}}));return t=[(0,c.Z)((0,c.Z)({},t[0]),{},{TravelDetailList:r})],(0,c.Z)((0,c.Z)({},e),{},{TravelIntroductionList:t})}},E=function(e,t){var n=e.currentRouteInfo,r=e.routeInfo,i=e.pageStatus,a=i.activeProductId,o=i.activeAlias,s=i.isMultiLine,l=i.isMultiTravel,u=(0,c.Z)((0,c.Z)({},n),t);return s?(r[a]=u,(0,c.Z)((0,c.Z)({},e),{},{currentRouteInfo:u,routeInfo:r})):l?(r[o]=u,(0,c.Z)((0,c.Z)({},e),{},{currentRouteInfo:u,routeInfo:r})):(0,c.Z)((0,c.Z)({},e),{},{currentRouteInfo:u})},V=function(e){var t=!1;if(e&&e.length){var n=e.filter((function(e){return"isVipDiscountProduct"===e.Key}))[0];t=n&&n.Value&&"true"===n.Value}var r,i=!1,a=!1;if(e&&e.length){var o=e.filter((function(e){return"UserDetail"===e.Key}))[0],s=o&&o.Value?JSON.parse(o.Value):null;s&&s.userDiscounts&&s.userDiscounts.length&&(a=s.userDiscounts.some((function(e){return 1===e.type})),i=s.userDiscounts.some((function(e){return 2===e.type})))}if(e&&e.length){var c=e.filter((function(e){return"UserDetail"===e.Key}))[0];if(c&&c.Value){var l=JSON.parse(c.Value).ctrip_vip_discount;r=100-100*l}}return{isMemberDiscountProduct:t,isShowFlightDiscountInfo:i,isShowMemberDiscountInfo:a,memeberDiscount:r}},A=n(10932),Z={fetchProductBasicInfo:"\n    query getProductInfo(\n        $params: ProductArgs!\n        $bookFormEmotionalCuesParams: ProductBookFormEmotionalCuesArgs!\n    ) {\n        pageSetting\n        productInfo(params: $params) {\n        BasicInfo {\n            json\n        }\n        MediaInfo {\n            json\n        }\n        TagGroupInfo {\n            json\n        }\n        BookInfo {\n            json\n        }\n        ScheduleInfo {\n            json\n        }\n        PriceInfo {\n            json\n        }\n        BasicExtendInfo {\n            json\n        }\n        TourGroupInfo {\n            json\n        }\n        ExtInfo {\n            json\n        }\n        SegmentInfo {\n            json\n        }\n        VendorInfo {\n            json\n        }\n        TravelList {\n          Alias\n          Name\n          TourInfoId\n          isActive\n        }\n        PreSaleTourGroupInfo{\n            json\n        }\n        specialTag\n        serverTime\n        qConfig {\n            isPremium\n            consultant\n            bonusInfo\n            isShowHKTip\n            studyUrl\n            duringServiceIcon\n            sixSecurityInfo\n            membershipUrl\n        }\n        CruisesBaseInfo {\n            json\n        }\n        emotionalCues(params: $bookFormEmotionalCuesParams) {\n            urgentInfo\n            bookingDynamic\n            productSelling\n            riskCityPolicy\n        }\n        switchConfig\n        userInformation {\n            json\n        }\n        ResponseStatus\n        }\n    }\n  ",fetchProductBasicInfo_SecKill:"\n    query getProductInfo(\n        $params: ProductArgs!\n        $bookFormEmotionalCuesParams: ProductBookFormEmotionalCuesArgs!\n    ) {\n        pageSetting\n        productInfo(params: $params) {\n        BasicInfo {\n            json\n        }\n        MediaInfo {\n            json\n        }\n        TagGroupInfo {\n            json\n        }\n        BookInfo {\n            json\n        }\n        ScheduleInfo {\n            json\n        }\n        PriceInfo {\n            json\n        }\n        BasicExtendInfo {\n            json\n        }\n        TourGroupInfo {\n            json\n        }\n        ExtInfo {\n            json\n        }\n        SegmentInfo {\n            json\n        }\n        VendorInfo {\n            json\n        }\n        TravelList {\n          Alias\n          Name\n          TourInfoId\n          isActive\n        }\n        specialTag\n        serverTime\n        qConfig {\n            bonusInfo\n            studyUrl\n            sixSecurityInfo\n            membershipUrl\n        }\n        emotionalCues(params: $bookFormEmotionalCuesParams) {\n            urgentInfo\n            riskCityPolicy\n        }\n        switchConfig\n        userInformation {\n            json\n        }\n        ResponseStatus\n        }\n    }\n  ",fetchProductSecondInfo:function(e){return e?"query getProductInfo(\n          $params: ProductArgs!\n          $servicePersonParams: ProductServicePersonArg!\n          $expertParams: ProductExpertArgs!\n          $imEntryInfoParams: IMEntryInfoArgs!\n          $priceCalendarParams: PriceCalendarArgs!\n          $PreSaleParams: ProductArgs!\n          $groupChildrenParams: ProductGroupChildrenArgs!\n        ) {\n            productInfo(params: $params) {\n                PriceInfo {\n                  json\n                }\n                brandTag\n                productRanking\n                imageStyleInfo {\n                  json\n                }\n                productExtend {\n                    commonProblem\n                    bookingTip\n                    MultiLineInfo\n                    MoreRecommendProductList\n                    commonProblem\n                }\n                compositeCoupon {\n                    promotionList\n                    promotionCount\n                    recommendPromotion\n                    recommendPromotionTitle\n                }\n                CostInfoList {\n                    json\n                }\n                FeeInfoList {\n                    json\n                }\n                OrderKnow {\n                    json\n                }\n                Visa {\n                    json\n                }\n                SelfPayInfoList {\n                    json\n                }\n                PMRecomendInfo {\n                    json\n                }\n                DescriptionInfo {\n                    json\n                }\n                TravelIntroductionInfo {\n                    json\n                }\n                myFavorites {\n                    isFavorite\n                    isLogin\n                    favoriteId\n                }\n                servicePerson(params: $servicePersonParams) {\n                  json\n                }\n                brandScore {\n                  inLand\n                  shopId\n                  shopType\n                  success\n                  productCategoryList\n                  shopInfo\n                  productList\n                  showLocation\n                }\n                suggestInfo {\n                  searchName\n                }\n                liveCast {\n                  json\n                }\n                expertInfo(params: $expertParams) {\n                  summary\n                  datas\n                }\n                imEntryInfo(params: $imEntryInfoParams) {\n                  imInfo\n                  serviceInfo\n                }\n                groupCard{\n                  cards\n                  count\n                  oneWithN\n                }\n                bookingRuleInfo {\n                  bookingRule\n                }\n                promotionDisplayInfo {\n                  creditInfo\n                }\n                promotionDisplayInfoNew {\n                  creditInfo\n                }\n                priceCalendar(params: $priceCalendarParams) {\n                  scheduleDates\n                  json\n                }\n                groupChildren(params: $groupChildrenParams) {\n                  groups\n                }\n                userDestinationOrder {\n                  brandTag\n                  tags\n                  productDestinationOrderList\n                }\n                askStatus {\n                  json\n                }\n                productPlayLineEx {\n                  json\n                }\n                tPalClientInfo {\n                  tPalScheduleList\n                }\n                ResponseStatus\n            }\n            PreSaleProductInfo: productInfo(params: $PreSaleParams) {\n                PreSaleNotice {\n                  json\n                }\n                TagGroupInfo {\n                  json\n                }\n                askStatus {\n                  json\n                }\n                ResponseStatus\n            }\n        }":"query getProductInfo(\n          $params: ProductArgs!\n          $servicePersonParams: ProductServicePersonArg!\n          $expertParams: ProductExpertArgs!\n          $imEntryInfoParams: IMEntryInfoArgs!\n          $priceCalendarParams: PriceCalendarArgs!\n          $groupChildrenParams: ProductGroupChildrenArgs!\n        ) {\n            productInfo(params: $params) {\n                PriceInfo {\n                  json\n                }\n                brandTag\n                productRanking\n                imageStyleInfo {\n                  json\n                }\n                productExtend {\n                    commonProblem\n                    bookingTip\n                    MultiLineInfo\n                    MoreRecommendProductList\n                    commonProblem\n                }\n                compositeCoupon {\n                    promotionList\n                    promotionCount\n                    recommendPromotion\n                    recommendPromotionTitle\n                }\n                CostInfoList {\n                    json\n                }\n                FeeInfoList {\n                    json\n                }\n                OrderKnow {\n                    json\n                }\n                Visa {\n                    json\n                }\n                SelfPayInfoList {\n                    json\n                }\n                PMRecomendInfo {\n                    json\n                }\n                DescriptionInfo {\n                    json\n                }\n                TravelIntroductionInfo {\n                    json\n                }\n                myFavorites {\n                    isFavorite\n                    isLogin\n                    favoriteId\n                }\n                servicePerson(params: $servicePersonParams) {\n                  json\n                }\n                brandScore {\n                  inLand\n                  shopId\n                  shopType\n                  success\n                  productCategoryList\n                  shopInfo\n                  productList\n                  showLocation\n                }\n                suggestInfo {\n                  searchName\n                }\n                liveCast {\n                  json\n                }\n                expertInfo(params: $expertParams) {\n                  summary\n                  datas\n                }\n                imEntryInfo(params: $imEntryInfoParams) {\n                  imInfo\n                  serviceInfo\n                }\n                groupCard{\n                  cards\n                  count\n                  oneWithN\n                }\n                bookingRuleInfo {\n                  bookingRule\n                }\n                promotionDisplayInfo {\n                  creditInfo\n                }\n                promotionDisplayInfoNew {\n                  creditInfo\n                }\n                priceCalendar(params: $priceCalendarParams) {\n                  scheduleDates\n                  json\n                }\n                groupChildren(params: $groupChildrenParams) {\n                  groups\n                }\n                userDestinationOrder {\n                  brandTag\n                  tags\n                  productDestinationOrderList\n                }\n                askStatus {\n                  json\n                }\n                productPlayLineEx {\n                  json\n                }\n                tPalClientInfo {\n                  tPalScheduleList\n                }\n                ResponseStatus\n            }\n        }"},fetchProductSecondInfo_SecKill:"\n    query getProductInfo(\n      $params: ProductArgs!\n      $imEntryInfoParams: IMEntryInfoArgs!\n      $priceCalendarParams: PriceCalendarArgs!\n    ) {\n        productInfo(params: $params) {\n            PriceInfo {\n              json\n            }\n            brandTag\n            compositeCoupon {\n                promotionList\n                promotionCount\n                recommendPromotion\n                recommendPromotionTitle\n            }\n            CostInfoList {\n                json\n            }\n            FeeInfoList {\n                json\n            }\n            OrderKnow {\n                json\n            }\n            Visa {\n                json\n            }\n            SelfPayInfoList {\n                json\n            }\n            PMRecomendInfo {\n                json\n            }\n            DescriptionInfo {\n                json\n            }\n            TravelIntroductionInfo {\n                json\n            }\n            myFavorites {\n                isFavorite\n                isLogin\n                favoriteId\n            }\n            brandScore {\n              inLand\n              shopId\n              shopType\n              success\n              productCategoryList\n              shopInfo\n              productList\n              showLocation\n            }\n            imEntryInfo(params: $imEntryInfoParams) {\n              imInfo\n              serviceInfo\n            }\n            groupCard{\n              cards\n              count\n              oneWithN\n            }\n            priceCalendar(params: $priceCalendarParams) {\n              scheduleDates\n              json\n            }\n            ResponseStatus\n        }\n    }",fetchMultiLineDetailInfo:function(e){return e?"\n        query getProductInfo(\n          $params: ProductArgs!\n          $priceCalendarParams: PriceCalendarArgs!\n          $bookFormEmotionalCuesParams: ProductBookFormEmotionalCuesArgs!\n          $PreSaleParams: ProductArgs!\n          $servicePersonParams: ProductServicePersonArg!\n        ) {\n            productInfo(params: $params) {\n              BasicInfo {\n                json\n              }\n              BookInfo {\n                json\n              }\n              MediaInfo {\n                json\n              }\n              PriceInfo {\n                json\n              }\n              TagGroupInfo {\n                json\n              }\n              SegmentInfo {\n                json\n              }\n              PMRecomendInfo {\n                json\n              }\n              DescriptionInfo {\n                json\n              }\n              TravelIntroductionInfo {\n                json\n              }\n              CostInfoList {\n                json\n              }\n              FeeInfoList {\n                json\n              }\n              OrderKnow {\n                json\n              }\n              Visa {\n                json\n              }\n              BasicExtendInfo {\n                json\n              }\n              SelfPayInfoList {\n                json\n              }\n              bookingRuleInfo {\n                bookingRule\n              }\n              imageStyleInfo {\n                json\n              }\n              priceCalendar(params: $priceCalendarParams) {\n                scheduleDates\n                json\n              }\n              emotionalCues(params: $bookFormEmotionalCuesParams) {\n                urgentInfo\n                bookingDynamic\n                productSelling\n                riskCityPolicy\n              }\n              servicePerson(params: $servicePersonParams) {\n                json\n              }\n              userDestinationOrder {\n                brandTag\n                tags\n                productDestinationOrderList\n              }\n              askStatus {\n                json\n              }\n              ExtInfo {\n                json\n              }\n              ResponseStatus\n            }\n            PreSaleProductInfo: productInfo(params: $PreSaleParams) {\n              PreSaleNotice {\n                json\n              }\n              TagGroupInfo {\n                json\n              }\n              askStatus {\n                json\n              }\n              ResponseStatus\n            }\n          }\n        ":"\n          query getProductInfo(\n            $params: ProductArgs!\n            $priceCalendarParams: PriceCalendarArgs!\n            $bookFormEmotionalCuesParams: ProductBookFormEmotionalCuesArgs!\n            $servicePersonParams: ProductServicePersonArg!\n          ) {\n              productInfo(params: $params) {\n                BasicInfo {\n                  json\n                }\n                BookInfo {\n                  json\n                }\n                MediaInfo {\n                  json\n                }\n                PriceInfo {\n                  json\n                }\n                TagGroupInfo {\n                  json\n                }\n                SegmentInfo {\n                  json\n                }\n                PMRecomendInfo {\n                  json\n                }\n                DescriptionInfo {\n                  json\n                }\n                TravelIntroductionInfo {\n                  json\n                }\n                CostInfoList {\n                  json\n                }\n                FeeInfoList {\n                  json\n                }\n                OrderKnow {\n                  json\n                }\n                Visa {\n                  json\n                }\n                BasicExtendInfo {\n                  json\n                }\n                SelfPayInfoList {\n                  json\n                }\n                bookingRuleInfo {\n                  bookingRule\n                }\n                imageStyleInfo {\n                  json\n                }\n                priceCalendar(params: $priceCalendarParams) {\n                  scheduleDates\n                  json\n                }\n                emotionalCues(params: $bookFormEmotionalCuesParams) {\n                  urgentInfo\n                  bookingDynamic\n                  productSelling\n                  riskCityPolicy\n                }\n                servicePerson(params: $servicePersonParams) {\n                  json\n                }\n                userDestinationOrder {\n                  brandTag\n                  tags\n                  productDestinationOrderList\n                }\n                askStatus {\n                  json\n                }\n                ExtInfo {\n                  json\n                }\n                ResponseStatus\n              }\n            }\n          "},fetchMultiTravelDetailInfo:"\n  query getProductInfo($params: ProductArgs!) {\n      productInfo(params: $params) {\n        SegmentInfo {\n          json\n        }\n        TravelIntroductionInfo {\n          json\n        }\n        Visa {\n          json\n        }\n        FeeInfoList {\n          json\n        }\n        imageStyleInfo {\n          json\n        }\n        ResponseStatus\n      }\n    }\n  ",fetchNewDepartCityProductInfo:function(e,t,n){return n?"\n              query getProductInfo(\n                $MainParams: ProductArgs!\n                $bookFormEmotionalCuesParams: ProductBookFormEmotionalCuesArgs".concat(e||t?", $RouteParams: ProductArgs!":"","\n                $priceCalendarParams: PriceCalendarArgs!\n                $PreSaleParams: ProductArgs!\n                $servicePersonParams: ProductServicePersonArg!\n              ) {\n                  MainProductInfo: productInfo(params: $MainParams) {\n                    BasicInfo {\n                      json\n                    }\n                    MediaInfo {\n                      json\n                    }\n                    TagGroupInfo {\n                      json\n                    }\n                    BookInfo {\n                      json\n                    }\n                    ScheduleInfo {\n                      json\n                    }\n                    SegmentInfo {\n                      json\n                    }\n                    PriceInfo {\n                      json\n                    }\n                    PMRecomendInfo {\n                      json\n                    }\n                    DescriptionInfo {\n                      json\n                    }\n                    TourGroupInfo {\n                      json\n                    }\n                    VendorInfo {\n                      json\n                    }\n                    TravelIntroductionInfo {\n                      json\n                    }\n                    CostInfoList {\n                      json\n                    }\n                    FeeInfoList {\n                      json\n                    }\n                    OrderKnow {\n                      json\n                    }\n                    Visa {\n                      json\n                    }\n                    SelfPayInfoList {\n                      json\n                    }\n                    BasicExtendInfo {\n                      json\n                    }\n                    groupCard{\n                      cards\n                      count\n                    }\n                    promotionDisplayInfo {\n                      creditInfo\n                    }\n                    promotionDisplayInfoNew {\n                      creditInfo\n                    }\n                    bookingRuleInfo {\n                      bookingRule\n                    }\n                    specialTag\n                    serverTime\n                    qConfig {\n                      isPremium\n                      consultant\n                      bonusInfo\n                      isShowHKTip\n                      studyUrl\n                      duringServiceIcon\n                      sixSecurityInfo\n                      membershipUrl\n                    }\n                    compositeCoupon {\n                      promotionList\n                      promotionCount\n                      recommendPromotion\n                      recommendPromotionTitle\n                    }\n                    productExtend {\n                      commonProblem\n                      bookingTip\n                      MultiLineInfo\n                      MoreRecommendProductList\n                      commonProblem\n                    }\n                    brandScore {\n                      inLand\n                      shopId\n                      shopType\n                      success\n                      productCategoryList\n                      shopInfo\n                      productList\n                      showLocation\n                    }\n                    TravelList {\n                      Alias\n                      Name\n                      TourInfoId\n                      isActive\n                    }\n                    imageStyleInfo {\n                      json\n                    }\n                    emotionalCues(params: $bookFormEmotionalCuesParams) {\n                      urgentInfo\n                      bookingDynamic\n                      productSelling\n                      riskCityPolicy\n                    }\n                    priceCalendar(params: $priceCalendarParams) {\n                      scheduleDates\n                      json\n                    }\n                    userInformation {\n                      json\n                    }\n                    servicePerson(params: $servicePersonParams) {\n                      json\n                    }\n                    userDestinationOrder {\n                      brandTag\n                      tags\n                      productDestinationOrderList\n                    }\n                    askStatus {\n                      json\n                    }\n                    ExtInfo {\n                      json\n                    }\n                    productPlayLineEx {\n                      json\n                    }\n                    ResponseStatus\n                  }\n                  PreSaleProductInfo: productInfo(params: $PreSaleParams) {\n                    PreSaleNotice {\n                      json\n                    }\n                    TagGroupInfo {\n                      json\n                    }\n                    askStatus {\n                      json\n                    }\n                    ResponseStatus\n                  }\n                  ").concat(e||t?"\n                  RouteProductInfo: productInfo(params: $RouteParams) {\n                      BasicInfo {\n                        json\n                      }\n                      TravelIntroductionInfo {\n                        json\n                      }\n                      SegmentInfo {\n                        json\n                      }\n                      FeeInfoList {\n                        json\n                      }\n                      servicePerson(params: $servicePersonParams) {\n                        json\n                      }\n                      userDestinationOrder {\n                        brandTag\n                        tags\n                        productDestinationOrderList\n                      }\n                      askStatus {\n                        json\n                      }\n                      ExtInfo {\n                        json\n                      }\n                      ".concat(e?"\n                      TagGroupInfo {\n                        json\n                      }\n                      PriceInfo {\n                        json\n                      }\n                      SegmentInfo {\n                        json\n                      }\n                      PMRecomendInfo {\n                        json\n                      }\n                      DescriptionInfo {\n                        json\n                      }\n                      CostInfoList {\n                        json\n                      }\n                      OrderKnow {\n                        json\n                      }\n                      Visa {\n                        json\n                      }\n                      BasicExtendInfo {\n                        json\n                      }\n                      BookInfo {\n                        json\n                      }\n                      SelfPayInfoList {\n                        json\n                      }\n                      imageStyleInfo {\n                        json\n                      }\n                      priceCalendar(params: $priceCalendarParams) {\n                        scheduleDates\n                        json\n                      }\n                      ResponseStatus\n                      ":"","\n                    }\n                "):"","\n                }\n\n              "):"\n        query getProductInfo(\n          $MainParams: ProductArgs!\n          $bookFormEmotionalCuesParams: ProductBookFormEmotionalCuesArgs".concat(e||t?", $RouteParams: ProductArgs!":"","\n          $priceCalendarParams: PriceCalendarArgs!\n          $servicePersonParams: ProductServicePersonArg!\n        ) {\n            MainProductInfo: productInfo(params: $MainParams) {\n              BasicInfo {\n                json\n              }\n              MediaInfo {\n                json\n              }\n              TagGroupInfo {\n                json\n              }\n              BookInfo {\n                json\n              }\n              ScheduleInfo {\n                json\n              }\n              SegmentInfo {\n                json\n              }\n              PriceInfo {\n                json\n              }\n              PMRecomendInfo {\n                json\n              }\n              DescriptionInfo {\n                json\n              }\n              TourGroupInfo {\n                json\n              }\n              VendorInfo {\n                json\n              }\n              TravelIntroductionInfo {\n                json\n              }\n              CostInfoList {\n                json\n              }\n              FeeInfoList {\n                json\n              }\n              OrderKnow {\n                json\n              }\n              Visa {\n                json\n              }\n              SelfPayInfoList {\n                json\n              }\n              BasicExtendInfo {\n                json\n              }\n              groupCard{\n                cards\n                count\n              }\n              promotionDisplayInfo {\n                creditInfo\n              }\n              promotionDisplayInfoNew {\n                creditInfo\n              }\n              bookingRuleInfo {\n                bookingRule\n              }\n              specialTag\n              serverTime\n              qConfig {\n                isPremium\n                consultant\n                bonusInfo\n                isShowHKTip\n                studyUrl\n                duringServiceIcon\n                sixSecurityInfo\n                membershipUrl\n              }\n              compositeCoupon {\n                promotionList\n                promotionCount\n                recommendPromotion\n                recommendPromotionTitle\n              }\n              productExtend {\n                commonProblem\n                bookingTip\n                MultiLineInfo\n                MoreRecommendProductList\n                commonProblem\n              }\n              brandScore {\n                inLand\n                shopId\n                shopType\n                success\n                productCategoryList\n                shopInfo\n                productList\n                showLocation\n              }\n              TravelList {\n                Alias\n                Name\n                TourInfoId\n                isActive\n              }\n              imageStyleInfo {\n                json\n              }\n              emotionalCues(params: $bookFormEmotionalCuesParams) {\n                urgentInfo\n                bookingDynamic\n                productSelling\n                riskCityPolicy\n              }\n              priceCalendar(params: $priceCalendarParams) {\n                scheduleDates\n                json\n              }\n              userInformation {\n                json\n              }\n              servicePerson(params: $servicePersonParams) {\n                json\n              }\n              userDestinationOrder {\n                brandTag\n                tags\n                productDestinationOrderList\n              }\n              askStatus {\n                json\n              }\n              ExtInfo {\n                json\n              }\n              productPlayLineEx {\n                json\n              }\n              ResponseStatus\n            }\n            ").concat(e||t?"\n            RouteProductInfo: productInfo(params: $RouteParams) {\n                BasicInfo {\n                  json\n                }\n                TravelIntroductionInfo {\n                  json\n                }\n                SegmentInfo {\n                  json\n                }\n                FeeInfoList {\n                  json\n                }\n                servicePerson(params: $servicePersonParams) {\n                  json\n                }\n                userDestinationOrder {\n                  brandTag\n                  tags\n                  productDestinationOrderList\n                }\n                askStatus {\n                  json\n                }\n                ExtInfo {\n                  json\n                }\n                ".concat(e?"\n                TagGroupInfo {\n                  json\n                }\n                PriceInfo {\n                  json\n                }\n                SegmentInfo {\n                  json\n                }\n                PMRecomendInfo {\n                  json\n                }\n                DescriptionInfo {\n                  json\n                }\n                CostInfoList {\n                  json\n                }\n                OrderKnow {\n                  json\n                }\n                Visa {\n                  json\n                }\n                BasicExtendInfo {\n                  json\n                }\n                BookInfo {\n                  json\n                }\n                SelfPayInfoList {\n                  json\n                }\n                imageStyleInfo {\n                  json\n                }\n                priceCalendar(params: $priceCalendarParams) {\n                  scheduleDates\n                  json\n                }\n                ResponseStatus\n                ":"","\n                }\n            "):"","\n          }\n\n        ")},fetchRefreshPriceInfo:"\n    query getProductInfo(\n        $params: ProductArgs!\n        $priceCalendarParams: PriceCalendarArgs!\n    ) {\n        productInfo(params: $params) {\n        BasicInfo {\n            json\n        }\n        BookInfo {\n            json\n        }\n        ScheduleInfo {\n            json\n        }\n        PriceInfo {\n            json\n        }\n        groupCard{\n            cards\n            count\n        }\n        priceCalendar(params: $priceCalendarParams) {\n            scheduleDates\n            json\n        }\n        ResponseStatus\n        }\n    }\n  "},O=n(79666),U=n(50107),F=function(e){var t=e.ctx,n=function(e){try{t.getDHTLogger().logActionInfo(e)}catch(e){}},r=function(e){try{t.getDHTLogger().logPageInfo(e)}catch(e){}},i=function(e,n){var r={pageName:"detail",message:e,ex:n};try{t.getDHTLogger().logError(r)}catch(e){console.log("\ud83d\udc38 traceKMLogError",e)}},a=function(e){try{t.getDHTLogger().logMessage(e)}catch(e){console.log("\ud83d\udc38 traceKMLogMessage",e)}},o=function(e,n,r){try{var i="";if(n.startsWith("vac_1")?i="\u7cfb\u7edf\u5f02\u5e38":n.startsWith("vac_2")?i="\u8d44\u6e90\u4e0d\u53ef\u8ba2":n.startsWith("vac_3")?i="\u7528\u6237\u8f93\u5165\u9a8c\u8bc1":n.startsWith("vac_4")&&(i="\u641c\u7d22\u65e0\u7ed3\u679c"),""===i)return;0,t.getDHTLogger().logActionInfo({module:"\u963b\u65ad",scene:r||i,role:P.GD.sys,action:P.Us.show,value:e||"-",key:n})}catch(e){console.log("\ud83d\udc38 traceKMLogAction",e)}};return{traceKMLogAction:n,traceKMLogPage:r,traceKMLogError:i,traceKMLogMessage:a,traceKMInterruption:o}},G=["ResponseStatus","imEntryInfo"],H=["ResponseStatus"],K=["230505_VAC_ask1","230612_VAC_XTJMK"],z="undefined"!==typeof process&&"test"===(null===(r=process)||void 0===r||null===(r=r.env)||void 0===r?void 0:"production"),W=("undefined"!==typeof process&&(null===(i=process)||void 0===i||(i=i.env)),{isShowCitySelectMask:!1,isShowCouponMask:!1,isShowPromotionMask:!1,isShowCreditMask:!1,isShowServiceTagMask:!1,isShowSpecialBrandMask:!1,isShowMenuPop:!1,isShowCustomerServiceMask:!1,isShowPriceTipMask:!1,isShowAlertMask:!1,isShowUrgentMask:!1,isShowScenicMask:!1,isShowTrackOrderPop:!1,isShowCalendarPop:!1,isShowPresaleCalendarPop:!1,isShowCruisePriceDetail:!1,isShowSeaCruiseInfo:!1,isShowMemberShipMask:!1,isShowScenicExcludingFeeMask:!1,isShowThemeDifficultyMask:!1,isShowXRecommendMask:!1,isShowDiscountDetailMask:!1,isShowBookingLimitMask:!1,isShowGoldGuideMask:!1,isShowTpalMask:!1,isShowPreSaleNoticeMask:!1,isShowGODetailMask:!1}),q=(0,c.Z)((0,c.Z)({},W),{},{isSimpleMode:!1,isShowLazyLoadContent:!1,favoriteMenuStatus:"hide",isDefaultClause:!1,isShowHeaderMenu:!1,isSnapshot:!1,isShowSummaryLoading:!1,isShowErrorPage:!1,isShowCustomerService:!0,visaCountry:"",ABTestResult:[],currentImageIndex:0,isPremium:!1,isNewProcess:!0,isPreSale:!0,isShowD2DSwitch:!1,isShowD2DSwitch_p2c:!1,isTpalStyle:!1,isTabStyle:!1}),Y=(0,P.lU)((function(){var e=(0,A.Do)(),t=(0,A.$S)(),n={};Object.keys(t).forEach((function(e){n[e.toLocaleLowerCase()]=t[e]}));var r="1"===n.seckill,i=(0,P.zn)({initialState:(0,c.Z)((0,c.Z)((0,c.Z)({},q),{},{query:n,isSnapshot:!!n.snapshotid},(0,A.IP)()),{},{handlers:{},ShoppingId:n.shoppingid,issyncLiistInfo:"1"===n.syncdata,isShowInitDepartCity:!!n.departcityid,isShowMulitiRouteInPreSale:!n.presaleid,isSecKill:r,isSecKillLimit:!1}),reducers:R}),a=i.store,l=i.actions,u={},d=function(e){u[e]&&(u[e].cancel(),delete u[e])},f=[],p=!1,m=!1,I=!0,g=(0,U.c)({ctx:e}),v=F({ctx:e}),x=v.traceKMLogAction,S=v.traceKMInterruption,y=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!N){e.next=5;break}return e.next=3,Te();case 3:e.next=5;break;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n;return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=l.SET_CONCAT_DATA,!C){e.next=7;break}return e.next=4,Promise.all([]);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,Promise.all([re()]);case 9:e.t0=e.sent;case 10:n=e.t0,t(n);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,l;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!z){t.next=6;break}return t.next=3,B();case 3:return Re(),J(),t.abrupt("return");case 6:if("H5"!==(null===e||void 0===e?void 0:e.Platform)){t.next=17;break}return t.prev=7,t.next=10,B();case 10:n=a.getState(),r=n.query,i=n.BasicInfo,s=n.PriceInfo,c=n.BookInfo,l=n.SegmentInfo,e.triggerComponentWillCreateEvents({query:r,BasicInfo:i,PriceInfo:s,BookInfo:c,SegmentInfo:l}),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](7),console.log("preloadCallbackAction",t.t0);case 17:if("Taro"!==(null===e||void 0===e?void 0:e.Platform)){t.next=27;break}return t.prev=18,t.next=21,B();case 21:vt(),t.next=27;break;case 24:t.prev=24,t.t1=t["catch"](18),console.log("preloadCallbackAction",t.t1);case 27:case"end":return t.stop()}}),t,null,[[7,14],[18,24]])})));return function(){return t.apply(this,arguments)}}();(0,P.Ns)(j);var b=function(t){var n=t.url,r=t.params,i=t.options;e.jumpH5({url:n,params:r,options:i})},k=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,a;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=l.UPDATE_SECKILL_LIMIT_STATUS,t.prev=1,t.next=4,e.post("currentLimiting",{});case 4:r=t.sent,i=r.ResponseStatus,i&&i.Ack&&"Success"===i.Ack?(n(!1),a=400*Math.random()+100,setTimeout((0,s.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,B();case 2:t=e.sent,"error"!==t&&Qe();case 4:case"end":return e.stop()}}),e)}))),a)):n(!0),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),console.log(t.t0),n(!0);case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}(),L=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,u,d,f,p,m,I,h,g,v,x,S,T,P,y;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.BasicInfo,i=l.UPDATE_STATE,s="ProductInfo_App_Refresh_SecKill_BookInfo",u="\n      query getProductInfo(\n          $params: ProductArgs!\n      ) {\n          productInfo(params: $params) {\n            BookInfo {\n                json\n            }\n            ScheduleInfo {\n                json\n            }\n            ResponseStatus\n          }\n      }\n    ","H5"!==(null===e||void 0===e?void 0:e.Platform)){t.next=10;break}return t.next=7,e.getClientInfo();case 7:t.t0=t.sent,t.next=13;break;case 10:return t.next=12,e.getWakeUpData();case 12:t.t0=t.sent;case 13:return d=t.t0,f=d,p=f.allianceid,m=f.sid,I=f.awake_allianceid,h=f.awake_sid,d=(0,c.Z)((0,c.Z)({},d),{},{allianceid:Number(I||p||0),sid:Number(h||m||0)}),g={params:(0,c.Z)({ProductId:Number(r.ProductId),DepartureCityId:Number(r.DepartureId||2),MarketingInfo:{AllianceId:d.allianceid,SId:d.sid}},e.attachShardParams())},t.prev=17,t.next=20,e.gqlpost(u,g,s);case 20:v=t.sent,x=v.data,S=x.productInfo,T=S.ResponseStatus,"Success"===T.Ack&&(P=S.BookInfo,y=S.ScheduleInfo,i({BookInfo:P,ScheduleInfo:y})),t.next=30;break;case 27:t.prev=27,t.t1=t["catch"](17),console.log(t.t1);case 30:case"end":return t.stop()}}),t,null,[[17,27]])})));return function(){return t.apply(this,arguments)}}(),B=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,u,d,p,m,I,h,g,v,x,T,P,y,w,C,N,D,j,_,b,k,L,B,R,M,E,V,A,O,U,F,G,H,K,q,Y,$,J,Q,X,ee,te,ne,re,ie,ae,oe,se,ce,le,ue,de,fe,pe,me,Ie,he,ge,ve,xe,Se,Te;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=(new Date).getTime(),r=a.getState(),i=r.query,r.ABTestResult,r.pageStatus,s=r.isPreSale,u=r.isShowD2DSwitch,d=r.isShowD2DSwitch_p2c,p=r.isSecKill,m=l.UPDATE_PRODUCT_BASIC_INFO,I=i.productid,h=i.departcityid,g=i.departdate,v=p?"ProductInfo_App_1st_SecKill":"ProductInfo_App_1st_V2",x=p?Z.fetchProductBasicInfo_SecKill:Z.fetchProductBasicInfo,"H5"!==(null===e||void 0===e?void 0:e.Platform)){t.next=12;break}return t.next=9,e.getClientInfo();case 9:t.t0=t.sent,t.next=15;break;case 12:return t.next=14,e.getWakeUpData();case 14:t.t0=t.sent;case 15:return T=t.t0,P=T,y=P.allianceid,w=P.sid,C=P.awake_allianceid,N=P.awake_sid,T=(0,c.Z)((0,c.Z)({},T),{},{allianceid:Number(C||y||0),sid:Number(N||w||0)}),D={params:(0,c.Z)({ProductId:Number(I),DepartureCityId:Number(h||2),DepartureDate:g,MarketingInfo:{AllianceId:T.allianceid,SId:T.sid},HeadTagList:[{Key:"IsNonDepartureCityPrice",Value:"1"}]},e.attachShardParams()),bookFormEmotionalCuesParams:{HeadTagList:[{Key:"from_page",Value:"product"},{Key:"emotional_type",Value:"emergency_info_new"},{Key:"page_index",Value:"1002"},{Key:"business_line",Value:"1"}]}},z&&(D.params.testCaseId="44954748"),j=["rn_tour","detail",I,h,g].join("_"),_={needRetry:!0,cachePolicy:{enableCache:!0,cacheExpireTime:30,cacheLocation:"MEM",cacheKey:j}},i.nocache&&(_={needRetry:!0}),p&&(_={}),b=!z&&e.CRNFetch.isSameRequestOnRoad({cacheKey:j}),t.prev=25,t.next=28,Promise.all([e.gqlpost(x,D,v,_),e.getUserInfo()]);case 28:if(k=t.sent,L=(new Date).getTime(),B=k[0],R=B.data,M=B.errors,E=B.__isFromCache,V=void 0!==E&&E,A=B.extensions,O=k[1],U=O.userInfo,F=O.isLogin,!M){t.next=36;break}throw new Error(M[0].message);case 36:if(G=R.productInfo,H=R.pageSetting,K=G.ResponseStatus,q=G.ScheduleInfo,Y=G.BasicInfo,$=G.PreSaleTourGroupInfo,J=G.BookInfo,"Success"!==K.Ack){t.next=94;break}if(X=Y.isCruise,ee=Y.PreSaleStatus,"Taro"!==(null===e||void 0===e?void 0:e.Platform)){t.next=61;break}if(te=!1,G&&G.BasicInfo&&G.BasicInfo.isPureDiyfhxsdp&&(te=G&&G.SegmentInfo&&!G.SegmentInfo.IsFixSegment),!te){t.next=48;break}return ne="/webapp/vacations/tour/detail_o",re={isRedirect:!0},e.jumpH5({url:ne,params:i,options:re}),t.abrupt("return");case 48:if(!(G&&G.BasicInfo&&G.BasicInfo.isCruise)){t.next=53;break}return ie="/webapp/vacations/tour/cruise",ae={isRedirect:!0},e.jumpH5({url:ie,params:i,options:ae}),t.abrupt("return");case 53:if(!(G&&G.TagGroupInfo&&G.TagGroupInfo.SpecialTagList)){t.next=61;break}if(oe=G.TagGroupInfo.SpecialTagList,se=oe.some((function(e){return 2173===(null===e||void 0===e?void 0:e.TagId)})),!se){t.next=61;break}return ce="/webapp/vacations/tour/detail",le={isRedirect:!0},e.jumpH5({url:ce,params:i,options:le}),t.abrupt("return");case 61:if(2!==ee||!s){t.next=67;break}return t.next=64,$e({PreSaleTourGroupInfo:$,productid:I});case 64:if(ue=t.sent,!ue){t.next=67;break}return t.abrupt("return");case 67:return de=i.departdate,X&&!de&&(pe=q.ScheduleDateList,me=void 0===pe?[]:pe,de=null===(fe=me[0])||void 0===fe?void 0:fe.PriceDate),Ie=Je(Y,i),m({pageSetting:H,productInfo:G,userInfo:U,isLogin:F,CruiseDepartDate:de,wakenUpData:T,isPreSale:s,isShowD2DSwitch:u,isShowD2DSwitch_p2c:d}),he=l.SET_PAGE_ID,he(Ie),ge=(new Date).getTime(),e.sendKMLog({attrs:[{key:"productId",value:String(Y.ProductId)},{key:"cacheKey",value:j}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u9996\u5c4f /tour/bff/graphql/ProductInfo_App_1st_V2",action:"sys_show",rootMessageId:null===A||void 0===A||null===(Q=A.SoaResponseStatus)||void 0===Q||null===(Q=Q.ResponseStatus)||void 0===Q||null===(Q=Q.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===Q?void 0:Q.Value}),X&&(J.IsBook&&q.HasInventory||S("\u8d44\u6e90\u4e0d\u53ef\u8ba2","vac_25002")),t.next=78,e.getCurrentPageInfo();case 78:if(t.t1=t.sent,t.t1){t.next=81;break}t.t1={};case 81:if(ve=t.t1,xe=ve.prevpage,ve.page,Se={timeStamp:ge,content:[{key:"\u547d\u4e2d\u7f13\u5b58",value:String(V)},{key:"\u8bf7\u6c42\u5728\u9014",value:String(b)},{key:"\u524d\u5e8f\u9875\u9762",value:String(xe)},{key:"\u9996\u5c4f\u63a5\u53e3",value:String(L-n)},{key:"\u9996\u5c4f\u6e32\u67d3",value:String(ge-L)}]},f.push(Se),"RN"===e.Platform&&(e.traceDevLog("tour_detail_1st_count",{__isFromCache:V}),V&&e.traceDevLog("tour_detail_1st_from_cache",{__isFromCache:V})),"H5"===e.Platform){t.next=92;break}return t.next=90,De();case 90:return t.next=92,W();case 92:t.next=95;break;case 94:throw new Error(K.Errors[0].Message);case 95:t.next=104;break;case 97:return t.prev=97,t.t2=t["catch"](25),console.log(t.t2),Te=t.t2.message?t.t2.message:"\u83b7\u53d6\u4ea7\u54c1\u8be6\u60c5\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",e.showToast(Te),e.logPageError("fetchProductBasicInfo",t.t2),t.abrupt("return","error");case 104:case"end":return t.stop()}}),t,null,[[25,97]])})));return function(){return t.apply(this,arguments)}}(),M=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,u,d,f,p,m,h,g,v,x,S,T,P,y,w,C,N,D,j,_,b,k,L,B,R,M,E,V,A,O,U,F,G,H,K,z,q,Y,$,J,Q,X,ee,te,ne,re;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.query,n.ABTestResult,i=n.pageStatus,s=n.BasicInfo,u=n.isPreSale,d=n.isShowD2DSwitch,f=n.isShowD2DSwitch_p2c,p=n.copiedOriginalProductState,n.copiedNewProductState,m=n.isSecKill,h=l.UPDATE_PRODUCT_BASIC_INFO,g=l.RESET_D2DCOPIED_STORE,v=r.departdate,s){t.next=5;break}return t.abrupt("return");case 5:if(x=s.ProductId,S=s.DepartureId,T=s.DepartureId,P=i.activeProductId,y=i.curD2DSwitchType,w=i.initD2DSwitchType,y!==w&&p&&(x=p.BasicInfo.ProductId,S=p.BasicInfo.DepartureId),C="ProductInfo_App_Login_Refresh",N=m?Z.fetchProductBasicInfo_SecKill:Z.fetchProductBasicInfo,"H5"!==(null===e||void 0===e?void 0:e.Platform)){t.next=19;break}return t.next=16,e.getClientInfo();case 16:t.t0=t.sent,t.next=22;break;case 19:return t.next=21,e.getWakeUpData();case 21:t.t0=t.sent;case 22:return D=t.t0,j=D,_=j.allianceid,b=j.sid,k=j.awake_allianceid,L=j.awake_sid,D=(0,c.Z)((0,c.Z)({},D),{},{allianceid:Number(k||_||0),sid:Number(L||b||0)}),B={params:(0,c.Z)({ProductId:x,DepartureCityId:S,DepartureDate:v,MarketingInfo:{AllianceId:D.allianceid,SId:D.sid}},e.attachShardParams()),bookFormEmotionalCuesParams:{HeadTagList:[{Key:"from_page",Value:"product"},{Key:"emotional_type",Value:"emergency_info_new"},{Key:"page_index",Value:"1002"},{Key:"business_line",Value:"1"}]}},t.prev=26,t.next=29,Promise.all([e.gqlpost(N,B,C),e.getUserInfo()]);case 29:if(R=t.sent,M=R[0],E=M.data,V=M.errors,A=M.extensions,O=R[1],U=O.userInfo,F=O.isLogin,!V){t.next=36;break}throw new Error(V[0].message);case 36:if(G=E.productInfo,H=E.pageSetting,K=G.ResponseStatus,z=G.ScheduleInfo,q=G.BasicInfo,"Success"!==K.Ack){t.next=68;break}return $=q.isCruise,J=r.departdate,$&&!J&&(X=z.ScheduleDateList,J=null===(Q=X[0])||void 0===Q?void 0:Q.PriceDate),y!==w&&g(),h({pageSetting:H,productInfo:G,userInfo:U,isLogin:F,CruiseDepartDate:J,wakenUpData:D,isPreSale:u,isShowD2DSwitch:d,isShowD2DSwitch_p2c:f}),I=!1,t.next=47,W();case 47:if(I=!0,y&&y!==w){t.next=57;break}if(!i||i.activeProductId===q.ProductId){t.next=53;break}return I=!1,t.next=53,we.handleMultiLineChange(i.activeProductId);case 53:if(!i||!i.isMultiTravel||"A"===i.activeAlias){t.next=57;break}return I=!1,t.next=57,we.handleMultiTravelChange(i.activeAlias);case 57:if(e.sendKMLog({attrs:[{key:"productId",value:String(q.ProductId)}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u767b\u5f55\u540e\u5237\u65b0\u4ea7\u54c1\u4fe1\u606f /tour/bff/graphql/ProductInfo_App_Login_Refresh",action:"sys_show",rootMessageId:null===A||void 0===A||null===(Y=A.SoaResponseStatus)||void 0===Y||null===(Y=Y.ResponseStatus)||void 0===Y||null===(Y=Y.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===Y?void 0:Y.Value}),y===w){t.next=66;break}return ee=l.UPDATE_D2DSWITCH_STATUS,ee(y),t.next=63,ge();case 63:te=a.getState(),ne=te.BasicInfo,re=te.pageStatus,T!==ne.DepartureId&&we.handleChangeDepartCity(T,P),P!==re.activeProductId&&we.handleMultiLineChange(P);case 66:t.next=69;break;case 68:throw new Error(K.Errors[0].Message);case 69:t.next=76;break;case 71:return t.prev=71,t.t1=t["catch"](26),console.log(t.t1),e.logPageError("fetchLoginProductBasicInfo",t.t1),t.abrupt("return","error");case 76:case"end":return t.stop()}}),t,null,[[26,71]])})));return function(){return t.apply(this,arguments)}}(),E=function(){var n=(0,s.Z)((0,o.Z)().mark((function n(){var r,i,s,u,d,f,p,m,I,h,g,v,x,S,T,P,y,w,C,N,D;return(0,o.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=a.getState(),i=r.BasicInfo,s=r.pageStatus,u=l.REFRESH_PRICE_INFO,d=t.departdate,f="ProductInfo_App_Refresh",p=Z.fetchRefreshPriceInfo,"H5"!==(null===e||void 0===e?void 0:e.Platform)){n.next=11;break}return n.next=8,e.getClientInfo();case 8:n.t0=n.sent,n.next=14;break;case 11:return n.next=13,e.getWakeUpData();case 13:n.t0=n.sent;case 14:return m=n.t0,I=m,h=I.allianceid,g=I.sid,v=I.awake_allianceid,x=I.awake_sid,m=(0,c.Z)((0,c.Z)({},m),{},{allianceid:Number(v||h||0),sid:Number(x||g||0)}),S={params:(0,c.Z)({ProductId:Number(i.ProductId),DepartureCityId:Number(i.DepartureId||0),DepartureDate:d,MarketingInfo:{AllianceId:m.allianceid,SId:m.sid}},e.attachShardParams()),priceCalendarParams:{queryTourGroup:!1,needInventory:!1,needFlightDiscountPrice:!0}},z&&(S.params.testCaseId="44954748"),n.prev=19,e.showMaskLoading(),n.next=23,e.gqlpost(p,S,f);case 23:T=n.sent,P=T.data,y=T.extensions,w=P.productInfo,C=w.ResponseStatus,N=w.BasicInfo,"Success"===C.Ack&&(u({productInfo:w}),e.hideMaskLoading(),s.activeProductId!==N.ProductId&&we.handleMultiLineChange(s.activeProductId),e.sendKMLog({attrs:[{key:"productId",value:String(N.ProductId)}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u5237\u65b0\u4ea7\u54c1\u4fe1\u606f /tour/bff/graphql/ProductInfo_App_Refresh",action:"sys_show",rootMessageId:null===y||void 0===y||null===(D=y.SoaResponseStatus)||void 0===D||null===(D=D.ResponseStatus)||void 0===D||null===(D=D.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===D?void 0:D.Value})),n.next=36;break;case 31:n.prev=31,n.t1=n["catch"](19),console.log(n.t1),e.logPageError("fetchRefreshPriceInfo",n.t1),e.hideMaskLoading();case 36:case"end":return n.stop()}}),n,null,[[19,31]])})));return function(){return n.apply(this,arguments)}}(),V=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,s,u,d,f,p,m,I,h,g,v;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=a.getState(),i=r.BasicInfo,s=l.UPDATE_STATE,u="ProductInfo_App_RiskCityInfo",d="\n        query getProductInfo(\n            $params: ProductArgs!\n            $bookFormEmotionalCuesParams: ProductBookFormEmotionalCuesArgs!\n        ) {\n            productInfo(params: $params) {\n            emotionalCues(params: $bookFormEmotionalCuesParams) {\n                urgentInfo\n                bookingDynamic\n                productSelling\n                riskCityPolicy\n            }\n            ResponseStatus\n            }\n        }\n        ",f={params:(0,c.Z)({ProductId:n,DepartureCityId:i.DepartureId},e.attachShardParams()),bookFormEmotionalCuesParams:{HeadTagList:[{Key:"from_page",Value:"product"},{Key:"emotional_type",Value:"emergency_info_new"},{Key:"page_index",Value:"1002"},{Key:"business_line",Value:"1"}]}},z&&(f.params.testCaseId="44954748"),t.prev=6,t.next=9,e.gqlpost(d,f,u);case 9:if(p=t.sent,m=p.data,I=p.errors,!I){t.next=16;break}throw new Error(I[0].message);case 16:if(h=m.productInfo,g=h.ResponseStatus,v=h.emotionalCues,"Success"!==g.Ack){t.next=22;break}s({emotionalCues:v}),t.next=23;break;case 22:throw new Error(g.Errors[0].Message);case 23:t.next=29;break;case 25:t.prev=25,t.t0=t["catch"](6),console.log(t.t0),e.logPageError("fetchRiskCityInfo",t.t0);case 29:case"end":return t.stop()}}),t,null,[[6,25]])})));return function(e){return t.apply(this,arguments)}}(),W=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,u,d,m,I,h,g,v,x,S,P,y,w,C,N,D,j,_,b,k,L,B,R,M,E,V,A,O,U,F,H,K,W,q,Y,$,J,Q,X,ee,te;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=f[f.length-1],r=(new Date).getTime(),n&&n.timeStamp&&(r=n.timeStamp),i=a.getState(),s=i.query,u=i.wakenUpData,d=i.BasicInfo,m=i.PreSaleTourGroupInfo,I=i.isPreSale,h=i.isShowD2DSwitch,g=i.isShowD2DSwitch_p2c,v=i.pageStatus,x=i.LocationInfo,S=i.isSecKill,P=s.productid,y=s.departcityid,w=s.departdate,C=d.ProductId,N=d.DepartureId,D=v.activeProductId,I&&m&&m.PreSaleInfo&&(_=m.PreSaleInfo,_.length&&(b=_.find((function(e){return e.ProductId===C})),b&&b.PreSaleProductId&&(j=b.PreSaleProductId))),k=S?"ProductInfo_App_2nd_SecKill":"ProductInfo_App_2nd_V2",L=S?Z.fetchProductSecondInfo_SecKill:Z.fetchProductSecondInfo(j),B={params:(0,c.Z)({ProductId:Number(D||C||P),DepartureCityId:Number(N||y||2),DepartureDate:w,MarketingInfo:{AllianceId:u.allianceid,SId:u.sid}},e.attachShardParams()),servicePersonParams:{PageType:1,PageSize:10,PageIndex:1},expertParams:{exportType:1,pageIndex:1,pageSize:3},imEntryInfoParams:{pageFrom:"detail",sourceFrom:"1"===s.fromhhtravel?"hhtravel":""},priceCalendarParams:{queryTourGroup:!1,needInventory:!1,needFlightDiscountPrice:!0,needTradePrice:"H5"===e.Platform&&!!e.H5Util.isBestone()},groupChildrenParams:{locationCityId:Number((null===x||void 0===x?void 0:x.departureCityId)||2)}},j&&(B=(0,c.Z)((0,c.Z)({},B),{},{PreSaleParams:(0,c.Z)({ProductId:Number(j),DepartureCityId:Number(y||2)},e.attachShardParams())})),z&&(B.params.testCaseId="44954748"),t.prev=13,t.next=16,e.gqlpost(L,B,k);case 16:if(R=t.sent,M=R.data,E=R.errors,V=R.extensions,A=(new Date).getTime(),!E){t.next=25;break}throw new Error(E[0].message);case 25:if(O=M.productInfo,U=M.PreSaleProductInfo,F=O.ResponseStatus,H=O.imEntryInfo,K=(0,T.Z)(O,G),"Success"!==F.Ack){t.next=59;break}return t.next=30,de(H);case 30:if(q=t.sent,K.imEntryInfo=H,K.serviceTip=q,!O.groupChildren||!O.groupChildren.groups){t.next=48;break}if(Y=O.groupChildren.groups,!Y||!Y[0]){t.next=48;break}if($=Y[0].type,2!==$){t.next=42;break}return t.next=40,ze("221226_VAC_dst04");case 40:J=t.sent,"B"===J&&(h=!0);case 42:if(1!==$){t.next=48;break}return t.next=45,ze("230504_VAC_dst6");case 45:Q=t.sent,"B"===Q&&(g=!0),d&&9===d.ProductCategoryId&&(g=!0);case 48:X=l.UPDATE_PRODUCT_SECOND_INFO,X({other:K,PreSaleProductInfo:U,isShowD2DSwitch:h,isShowD2DSwitch_p2c:g}),He(),ee=(new Date).getTime(),e.sendKMLog({attrs:[{key:"productId",value:String(s.productid)}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u6b21\u5c4f /tour/bff/graphql/ProductInfo_App_2nd_V2",action:"sys_show",rootMessageId:null===V||void 0===V||null===(W=V.SoaResponseStatus)||void 0===W||null===(W=W.ResponseStatus)||void 0===W||null===(W=W.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===W?void 0:W.Value}),te={timeStamp:ee,content:[{key:"\u6b21\u5c4f\u63a5\u53e3",value:String(A-r)},{key:"\u6b21\u5c4f\u6e32\u67d3",value:String(ee-A)}]},f.push(te),p&&we.handleClickFavorite(),ce(),t.next=60;break;case 59:throw new Error(F.Errors[0].Message);case 60:t.next=66;break;case 62:t.prev=62,t.t0=t["catch"](13),e.logPageError("fetchProductSecondInfo",t.t0),console.log(t.t0);case 66:case"end":return t.stop()}}),t,null,[[13,62]])})));return function(){return t.apply(this,arguments)}}(),Y=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n,r,i,s,c,u,d,p;return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=f[f.length-1],n=(new Date).getTime(),t&&t.timeStamp&&(n=t.timeStamp),r=a.getState(),i=r.isSecKill,s=l.SET_CONCAT_DATA_SECOND_SCREEN,!i){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,Promise.all([ne(),re(),ie(),ae()]);case 9:c=e.sent,u=(new Date).getTime(),s(c),d=(new Date).getTime(),p={timeStamp:d,content:[{key:"\u5c3e\u5c4f\u63a5\u53e3",value:String(u-n)},{key:"\u5c3e\u5c4f\u6e32\u67d3",value:String(d-u)}]},f.push(p),$(f);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(t){var n=a.getState(),r=n.BasicInfo,i=n.ABTestResult;e.sendKMLog({attrs:[{key:"productId",value:r.ProductId}],action:"sys_pageinfo",contents:[{key:"\u4ea7\u54c1",value:"("+r.ProductId+") "+r.MainName},{key:"\u51fa\u53d1\u57ce\u5e02",value:"("+r.DepartureId+") "+r.DepartureCityName}],desc:"\u57fa\u672c\u4fe1\u606f"});var o=[];t.forEach((function(e){e.content&&e.content.length&&(o=o.concat(e.content))})),e.sendKMLog({attrs:[{key:"productId",value:r.ProductId}],action:"sys_pageinfo",desc:"\u9875\u9762\u8017\u65f6",contents:o}),e.sendKMLog({attrs:[{key:"productId",value:r.ProductId}],action:"sys_pageinfo",contents:Object.entries(i).map((function(e){var t=(0,h.Z)(e,2),n=t[0],r=t[1];return{key:n,value:r}})),desc:"AB\u5b9e\u9a8c"})},J=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,u,d,f,p,m,I,h,g,v,T,y,w,C,N,D,j,_,b,k,L,B,R,M,E;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.BasicInfo,i=n.CruiseDepartDate,n.currentRouteInfo,n.priceCalendarData,s=n.ScheduleInfo,u=l.UPDATE_CRUISE_BOOKING_STATUS,d=l.RESET_CRUISE_DATA,f=l.INIT_SELECT_CRUISE_ROOM,r.isCruise){t.next=4;break}return t.abrupt("return");case 4:if(d(),p=l.INIT_CRUISE_DATA,m=l.UPDATE_CRUISE_ROOM_INFO,I=0,h=s.ScheduleDateList,g=void 0===h?[]:h,v=g.filter((function(e){return e.PriceDate===i||e.FestivalDate===i}))[0],v&&v.DisplayPrice&&(I=v.DisplayPrice),T={extension:[{name:"calendar_price",value:I}]},y={head:T,CruiseCondition:{ProductId:r.ProductId,DepartCityId:r.DepartureId,DepartDate:i}},console.log("=== \u90ae\u8f6e\u8d77\u4ef7\u53cd\u66f4\u65b0 init ===",i,I),w={needRetry:!0},"H5"!==e.Platform){t.next=23;break}return N=null===e||void 0===e?void 0:e.Stores.SelectedCruiseRoomInfoStore.getInstance(),t.next=18,N.get();case 18:if(t.t0=t.sent,t.t0){t.next=21;break}t.t0="";case 21:D=t.t0,D&&(j=D.SelectedCruiseRoomInfo,_=void 0===j?[]:j,b=(null===_||void 0===_?void 0:_.length)&&_[0].RoomType,C={RoomType:b},C&&(y=(0,c.Z)((0,c.Z)({},y),{},{Filter:C})),f(D),N.clear());case 23:return t.prev=23,t.next=26,e.post("GetCruiseRoomInfo",y,w);case 26:L=t.sent,B=L.RoomInfos,R=L.Tags,M=L.ClassRooms,E=L.ResponseStatus,"Success"===E.Ack?(p({RoomInfos:B,Tags:R,ClassRooms:M}),"H5"===(null===e||void 0===e?void 0:e.Platform)&&C&&m({cabinFilter:C,RoomInfos:B,Tags:R,ClassRooms:M}),M&&M.length||S("\u6ca1\u6709\u627e\u5230\u7b26\u5408\u7b5b\u9009\u6761\u4ef6\u7684\u8231\u623f","vac_45001")):u("cannotbooking"),x({attrs:[{key:"productId",value:String(r.ProductId)}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u90ae\u8f6e\u8231\u623f 20168/GetCruiseRoomInfo",action:P.Us.show,value:"-",rootMessageId:null===E||void 0===E||null===(k=E.Extension)||void 0===k||null===(k=k.find((function(e){return"RootMessageId"===e.Id})))||void 0===k?void 0:k.Value}),t.next=41;break;case 35:t.prev=35,t.t1=t["catch"](23),u("cannotbooking"),e.logPageError("fetchInitCruiseInfo",t.t1),S((null===t.t1||void 0===t.t1?void 0:t.t1.message)||"\u7cfb\u7edf\u9519\u8bef","vac_15001"),console.log(t.t1);case 41:case"end":return t.stop()}}),t,null,[[23,35]])})));return function(){return t.apply(this,arguments)}}(),Q=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,s,f,p,m,I,h,g,v,x,T,P,y,w,C,N,D,j;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=a.getState(),i=r.BasicInfo,s=r.CruiseDepartDate,r.currentRouteInfo,r.priceCalendarData,f=r.ScheduleInfo,p=l.UPDATE_CRUISE_ROOM_INFO,m=l.INIT_CRUISE_ROOM_INFO,I=l.UPDATE_CRUISE_BOOKING_STATUS,h=0,g=f.ScheduleDateList,v=void 0===g?[]:g,x=v.filter((function(e){return e.PriceDate===s||e.FestivalDate===s}))[0],x&&x.DisplayPrice&&(h=x.DisplayPrice),T={extension:[{name:"calendar_price",value:h}]},P={head:T,CruiseCondition:{ProductId:i.ProductId,DepartCityId:i.DepartureId,DepartDate:s}},console.log("=== \u90ae\u8f6e\u8d77\u4ef7\u53cd\u66f4\u65b0 ===",s,h),n&&(P=(0,c.Z)((0,c.Z)({},P),{},{Filter:n})),t.prev=10,d("GetCruiseRoomInfo"),y=e.createRequest("GetCruiseRoomInfo",P),u["GetCruiseRoomInfo"]=y,!z){t.next=20;break}return t.next=17,e.post("GetCruiseRoomInfo",P,{chooseReq:1});case 17:t.t0=t.sent,t.next=23;break;case 20:return t.next=22,y.fetch();case 22:t.t0=t.sent;case 23:w=t.t0,C=w.RoomInfos,N=w.Tags,D=w.ClassRooms,j=w.ResponseStatus,delete u["GetCruiseRoomInfo"],"Success"===j.Ack?(n?p({cabinFilter:n,RoomInfos:C,Tags:N,ClassRooms:D}):m({RoomInfos:C,Tags:N,ClassRooms:D}),D&&D.length||S("\u6ca1\u6709\u627e\u5230\u7b26\u5408\u7b5b\u9009\u6761\u4ef6\u7684\u8231\u623f","vac_45002")):n?e.showToast("\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"):I("cannotbooking"),t.next=38;break;case 32:t.prev=32,t.t1=t["catch"](10),n?e.showToast("\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"):I("cannotbooking"),e.logPageError("fetchCruiseRoomInfo",t.t1),S((null===t.t1||void 0===t.t1?void 0:t.t1.message)||"\u7cfb\u7edf\u9519\u8bef","vac_15002"),console.log(t.t1);case 38:case"end":return t.stop()}}),t,null,[[10,32]])})));return function(e){return t.apply(this,arguments)}}(),X=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,u,d,f,p,m,I,h,g,v;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.currentRouteInfo,i=n.pageId,s=n.CruiseDepartDate,c=n.CruisesBaseInfo,u=n.BasicInfo,u.isCruise||z){t.next=3;break}return t.abrupt("return");case 3:return d=l.UPDATE_CRUISE_JOURNEYINFO,f=r.SegmentInfo,p=f.Segments,m=c.BoardingDay,I=z?"":p.find((function(e){return e.CruisePackageId})).CruisePackageId,h={cruPackageId:I,departureDate:new w.Z(s).addDay(m-1).format("YYYY-MM-DD"),cruHead:{channel:"115",localeLang:"zh-CN",pageId:i,currency:"CNY",clientInfo:{salesPlatform:"APP"}}},t.prev=9,t.next=12,e.post("CruisePackageJourneyInfo",h);case 12:g=t.sent,v=g.journeyInfos,d(v),t.next=21;break;case 17:t.prev=17,t.t0=t["catch"](9),e.logPageError("fetchCruiseJourneyInfo",t.t0),console.log(t.t0);case 21:case"end":return t.stop()}}),t,null,[[9,17]])})));return function(){return t.apply(this,arguments)}}(),ee=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,s,u,d,f,p,m,I,h,g;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=a.getState(),i=r.BasicInfo,s=l.UPDATE_CRUISE_TIMING_INFO,u="getProductInfo",d="\n            query getProductInfo($params: ProductArgs!) {\n                productInfo(params: $params) {\n                    PriceInfo {\n                        json\n                    }\n                    TravelIntroductionInfo {\n                        json\n                    }\n                    ResponseStatus\n                }\n            }\n        ",f={params:(0,c.Z)({ProductId:i.ProductId,DepartureCityId:i.DepartureId,DepartureDate:n},e.attachShardParams())},t.prev=5,t.next=8,e.gqlpost(d,f,u);case 8:if(p=t.sent,m=p.data,I=p.errors,!I){t.next=15;break}throw new Error(I[0].message);case 15:if(h=m.productInfo,g=h.ResponseStatus,"Success"!==g.Ack){t.next=21;break}s(h),t.next=22;break;case 21:throw new Error(g.Errors[0].Message);case 22:t.next=28;break;case 24:t.prev=24,t.t0=t["catch"](5),console.log(t.t0),e.logPageError("fecthCruiseTimingInfo",t.t0);case 28:case"end":return t.stop()}}),t,null,[[5,24]])})));return function(e){return t.apply(this,arguments)}}(),te=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,f,p,m,I,h,g,v,x,T;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.SelectedCruiseRoomInfo,i=n.BasicInfo,s=n.CruiseDepartDate,c=l.UPDATE_CRUISE_PRICE,f=r.filter((function(e){return e.SelectedCount>0&&e.AdultCount>0})).map((function(e){var t=e.OvaryRoomId,n=e.SelectedCount,r=e.AdultCount,i=e.ChildCount;return{OvaryRoomId:t,Passengers:[{Type:"Adult",Count:r},{Type:"Child",Count:i}],SelectedCount:n}})),f.length||z){t.next=6;break}return c({SelectOvaryRoomPrices:[],TotalPrice:0}),t.abrupt("return");case 6:if(p={SelectOvaryRooms:f,CruiseCondition:{ProductId:i.ProductId,DepartCityId:i.DepartureId,DepartDate:s}},t.prev=7,d("OvaryRoomPriceCalculate"),m=e.createRequest("OvaryRoomPriceCalculate",p),u["OvaryRoomPriceCalculate"]=m,!z){t.next=17;break}return t.next=14,e.post("OvaryRoomPriceCalculate",p);case 14:t.t0=t.sent,t.next=20;break;case 17:return t.next=19,m.fetch();case 19:t.t0=t.sent;case 20:I=t.t0,h=I.SelectOvaryRoomPrices,g=I.TotalPrice,v=I.TotalDiscountAmount,x=I.TotalDiscountTradeAmount,T=I.TotalTradePrice,I.ResponseStatus,delete u["OvaryRoomPriceCalculate"],c({SelectOvaryRoomPrices:h,TotalPrice:g,TotalDiscountAmount:v,TotalDiscountTradeAmount:x,TotalTradePrice:T}),t.next=37;break;case 31:t.prev=31,t.t1=t["catch"](7),"abort"!==t.t1&&e.showToast("\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"),e.logPageError("fetchOvaryRoomPrice",t.t1),S((null===t.t1||void 0===t.t1?void 0:t.t1.message)||"\u7cfb\u7edf\u9519\u8bef","vac_15003"),console.log(t.t1);case 37:case"end":return t.stop()}}),t,null,[[7,31]])})));return function(){return t.apply(this,arguments)}}(),ne=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,l,u;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.isLogin,i=n.userInfo,"RN"===(null===e||void 0===e?void 0:e.Platform)){t.next=3;break}return t.abrupt("return",null);case 3:if(r&&!i.IsNonUser){t.next=5;break}return t.abrupt("return",null);case 5:return s={RequestTypeList:[4]},t.prev=6,t.next=9,e.post("GetUserCommonInfo",s);case 9:if(c=t.sent,l=c.Data,l.ContactInfo){t.next=13;break}return t.abrupt("return",null);case 13:return u=l.ContactInfo.CommonContactList[0],t.abrupt("return",{commonUserInfo:u});case 17:return t.prev=17,t.t0=t["catch"](6),e.logPageError("fetchUserCommonInfoPromise",t.t0),console.log(t.t0),t.abrupt("return",null);case 22:case"end":return t.stop()}}),t,null,[[6,17]])})));return function(){return t.apply(this,arguments)}}(),re=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,u,d,f;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.pageStatus,i=n.BasicInfo,s=n.LocationInfo,l.UPDATE_STORE_INFO,"RN"===(null===e||void 0===e?void 0:e.Platform)){t.next=4;break}return t.abrupt("return",null);case 4:if(!r.isRetail){t.next=6;break}return t.abrupt("return",null);case 6:return u={cityId:i.DepartureId},s&&Number(s.latitude)&&Number(s.longitude)&&(u=(0,c.Z)((0,c.Z)({},u),{},{latitude:s.latitude,longitude:s.longitude,coordType:s.coordinateType})),t.prev=8,t.next=11,e.post("GetNearbyStore",u);case 11:return d=t.sent,f=d.Data,t.abrupt("return",{NearbyStoreInfo:f});case 16:return t.prev=16,t.t0=t["catch"](8),e.logPageError("fetchStoreInfoPromise",t.t0),console.log(t.t0),t.abrupt("return",null);case 21:case"end":return t.stop()}}),t,null,[[8,16]])})));return function(){return t.apply(this,arguments)}}(),ie=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,l,u,d,f,p,m,I,h;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.isLogin,i=n.BasicInfo,n.pageStatus,"RN"===(null===e||void 0===e?void 0:e.Platform)){t.next=3;break}return t.abrupt("return",null);case 3:if(r){t.next=5;break}return t.abrupt("return",null);case 5:return s={RequestType:[1,2,4,9]},t.prev=6,t.next=9,e.post("getuserinfo",s);case 9:return c=t.sent,l=c.Data,u=l.SuperMemberInfo,d=l.UserInterestList,f=0,p=0,d&&d.length&&(m=d.filter((function(e){return 66===e.CreateProductLineId}))[0],I=d.filter((function(e){return 61===e.CreateProductLineId}))[0],m&&(f=m.InterestCounts),I&&(p=I.InterestCounts)),i.isCruise&&(f=0,p=0),h=u&&u.IsSuperMember&&i.IsInternal&&[1,3,4].includes(i.ProductPatternId)&&p>0,h||(p=0),t.abrupt("return",{SuperMemberInfo:u,UserInterestList:d,hasSuperMemberRight:h,commonMemberInterestCounts:f,superMemberInterestCounts:p});case 21:return t.prev=21,t.t0=t["catch"](6),e.logPageError("fetchVipMemberInfoPromise",t.t0),console.log(t.t0),t.abrupt("return",null);case 26:case"end":return t.stop()}}),t,null,[[6,21]])})));return function(){return t.apply(this,arguments)}}(),ae=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,l,u,d,f,p;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.mediaInfoCurRoute,i=n.isSecKill,s=r.ImgList,c=void 0===s?[]:s,!i){t.next=4;break}return t.abrupt("return");case 4:if(l=[],c.forEach((function(e){var t,n=e.AccompanyTourInfo;if(n){var r=n.ImageTypeId,i=n.ContentInfoList,a=void 0===i?[]:i,o=Number(null===(t=a[0])||void 0===t?void 0:t.InfoContent);5!=r||isNaN(o)||l.push(o)}})),u={parameterList:[{key:"SourceCode",value:"3"}],servicePersonIds:l},0!==l.length){t.next=9;break}return t.abrupt("return");case 9:return t.prev=9,t.next=12,e.post("getServicePersonDetail",u);case 12:if(d=t.sent,f=d.servicePersons,f&&f.length){t.next=16;break}return t.abrupt("return");case 16:return p={},null===f||void 0===f||f.forEach((function(e){var t=e||{},n=t.servicePersonID,r=t.cName,i=t.isTpal,a=t.isNewGoodGuide,o=t.briefIntroduction,s=t.isDriver,c=t.isGuide,u=t.isNewGoodDriver;l.forEach((function(e){String(e)==n&&(p[n]={isTpal:i,isNewGoodGuide:a,briefIntroduction:o,cName:r,isDriver:s,isGuide:c,isNewGoodDriver:u})}))})),t.abrupt("return",{servicePersons:p});case 21:return t.prev=21,t.t0=t["catch"](9),e.logPageError("fetchServicePersonDetail",t.t0),console.log(t.t0),t.abrupt("return",null);case 26:case"end":return t.stop()}}),t,null,[[9,21]])})));return function(){return t.apply(this,arguments)}}(),oe=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,f,p,m,I,h,g,v,x,S,T,P,y,w;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.LocationInfo,i=n.newProcessSelectDate,n.ABTestResult,s=n.BasicInfo,c=n.isShowD2DSwitchTab,f=n.pageStatus,p=n.isSecKill,m=l.UPDATE_FLIGHTDISCOUNT_INFO,I=f||{},h=I.activeProductId,g=I.activeAlias,I.isMultiLine,v=I.isMultiTravel,!p){t.next=5;break}return t.abrupt("return");case 5:if(null!==r&&void 0!==r&&r.departureCityId&&(null===r||void 0===r?void 0:r.departureCityId)!=s.DepartureId&&!c&&(9===s.ProductCategoryId||26===s.ProductCategoryId)){t.next=7;break}return t.abrupt("return");case 7:return x={productId:h,locationCityId:null===r||void 0===r?void 0:r.departureCityId,departureDate:i,aliasName:v?g:"",needReturn:!f.isExtendedStay},t.prev=8,d("getFlightDiscountDetail"),S=e.createRequest("getFlightDiscountDetail",x),u["getFlightDiscountDetail"]=S,t.next=14,S.fetch();case 14:T=t.sent,P=T.data,delete u["getFlightDiscountDetail"],y=P||{scheduleInfos:[]},w=y.scheduleInfos,m(w),t.next=26;break;case 21:return t.prev=21,t.t0=t["catch"](8),e.logPageError("fetchFlightDiscountDetail",t.t0),console.log(t.t0),t.abrupt("return",null);case 26:case"end":return t.stop()}}),t,null,[[8,21]])})));return function(){return t.apply(this,arguments)}}(),se={},ce=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,f,p,m,I,h,g,v,x,S,T,P,y,C,N,D,j,_,b,k,L,B,R,M,E,V,A;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.BasicInfo,i=n.newProcessSelectDate,s=n.pageStatus,f=n.priceCalendarData,p=n.groupCard,m=l.UPDATE_STATE,I=s||{},h=I.activeProductId,g=I.activeAlias,I.isMultiLine,v=I.isMultiTravel,"RN"===e.Platform){t.next=5;break}return t.abrupt("return");case 5:if(x="",S=0,i?(x=i,f&&(T=f.dailyMinPrice,P=T[i],P&&P.productPrices&&(y=P.productPrices.find((function(e){return e.productId===h})),y&&(S=y.displayPrice)))):v?(C=yt(f),C&&C[g]&&(N=C[g],D=N.displayPrice,j=N.date,S=D,x=new w.Z(j).format("YYYY-MM-DD"))):p&&p.cards&&p.cards.length&&(_=p.cards,b=_.find((function(e){return e.productId===h})),b&&b.priceInfo&&(k=b.priceInfo,L=k.displayPrice,B=k.minPriceDate,x=new w.Z(w.Z.transformTimeStamp(B)).format("YYYY-MM-DD"),S=L)),R={productId:h,departureCityId:r.DepartureId,departureDate:x,minPrice:S,aliasName:g},x&&S){t.next=11;break}return t.abrupt("return");case 11:if(JSON.stringify(R)!==JSON.stringify(se)){t.next=15;break}return t.abrupt("return");case 15:se=R;case 16:return t.prev=16,m({priceEffectiveInfo:null}),d("getProductScheduleDesc"),M=e.createRequest("getProductScheduleDesc",R),u["getProductScheduleDesc"]=M,t.next=23,M.fetch();case 23:E=t.sent,V=E.data,delete u["getProductScheduleDesc"],A=(0,c.Z)((0,c.Z)({},V),{},{minPrice:S}),m({priceEffectiveInfo:A}),t.next=34;break;case 30:t.prev=30,t.t0=t["catch"](16),e.logPageError("fetchProductScheduleDesc",t.t0),console.log(t.t0);case 34:case"end":return t.stop()}}),t,null,[[16,30]])})));return function(){return t.apply(this,arguments)}}(),le=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,u;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.BasicInfo,i=l.UPDATE_STATE,"H5"===(null===e||void 0===e?void 0:e.Platform)){t.next=4;break}return t.abrupt("return");case 4:return s={ProductId:r.ProductId,clientSource:"MD_ServerFrom_MobileHtml5"},t.prev=5,t.next=8,e.post("getProductDisposition",s);case 8:c=t.sent,u=c.dispositions,u&&u&&u.find((function(e){return 1===e.dispositionType}))&&i({isSupportCommonIntention:!0}),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](5),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(){return t.apply(this,arguments)}}(),ue=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,u,d,f;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.isLogin,i=l.SET_VIPMEMBER_INFO,r){t.next=4;break}return t.abrupt("return");case 4:return s={RequestType:[1,2,4,9]},t.prev=5,t.next=8,e.post("getuserinfo",s);case 8:c=t.sent,u=c.Data,d=u.SuperMemberInfo,f=u.UserInterestList,i({SuperMemberInfo:d,UserInterestList:f}),t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](5),e.logPageError("fetchVipMemberInfoPromise",t.t0),console.log(t.t0);case 18:case"end":return t.stop()}}),t,null,[[5,14]])})));return function(){return t.apply(this,arguments)}}(),de=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,a,s;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n||!n.serviceInfo){t.next=11;break}return r=n.serviceInfo,i=r.shortServiceToast,a=r.serviceToast,t.next=6,e.loadStorage("TOUR_DETAIL_SERVICE_TIP_TEXT","tour");case 6:return s=t.sent,s===i?a="":e.Storage.save({key:"TOUR_DETAIL_SERVICE_TIP_TEXT",value:i,domain:"tour",expires:2592e3}),t.abrupt("return",{shortText:i,longText:a});case 11:return t.abrupt("return",null);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),fe=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,u,d,f,p,m,I,h,g,v,x,S,T;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.BasicInfo,i=n.userInfo,s=n.isLogin,n.pageStatus,u=l.UPDATE_FAVOURITE_STATUS,d=l.UPDATE_FAVOURITE_MENU,s){t.next=4;break}return t.abrupt("return");case 4:if(f=C?"GROUP_TRAVEL_IBU":"GROUP_TRAVEL",p="\u8ddf\u56e2\u6e38",!N){t.next=19;break}t.t0=r.ProductPatternId,t.next=2===t.t0?10:3===t.t0?13:4===t.t0?15:17;break;case 10:return f="PLANE_HOTEL",p="\u81ea\u7531\u884c",t.abrupt("break",18);case 13:return p="\u534a\u81ea\u52a9",t.abrupt("break",18);case 15:return p="\u79c1\u5bb6\u56e2",t.abrupt("break",18);case 17:f="GROUP_TRAVEL";case 18:r.isStudy&&(f="YOUXUE",p="\u6e38\u5b66");case 19:return m={FavoriteList:[{BizType:f,ProductID:String(r.ProductId),FromCityID:r.DepartureId,SaleCityID:r.DepartureId,ExtendList:N?[{Name:"Tag",Value:p}]:[]}]},"RN"===e.Platform&&(m=(0,c.Z)((0,c.Z)({},m),{},{UID:i.UserID})),t.prev=21,t.next=24,e.post("CreateFavorite",m);case 24:if(I=t.sent,h=I.ResultCode,g=I.FavoriteIdList,v=I.ResultMessage,x=0===h&&g&&g.length>0,!x){t.next=37;break}return S=g[0],T={isFavorite:x,favoriteId:S,clicked:!0},u(T),d("add"),t.abrupt("return",!0);case 37:throw new Error(v);case 38:t.next=47;break;case 40:return t.prev=40,t.t1=t["catch"](21),console.log(t.t1),N&&e.showToast("\u6536\u85cf\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5\u3002"),d("failed"),e.logPageError("fetchCreateFavorite",t.t1),t.abrupt("return",!1);case 47:case"end":return t.stop()}}),t,null,[[21,40]])})));return function(){return t.apply(this,arguments)}}(),pe=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,u,d,f,p;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.myFavorites,i=n.userInfo,s=n.isLogin,u=l.UPDATE_FAVOURITE_STATUS,d=l.UPDATE_FAVOURITE_MENU,s){t.next=4;break}return t.abrupt("return");case 4:return f={FavoriteIdList:[r.favoriteId]},"RN"===e.Platform&&(f=(0,c.Z)((0,c.Z)({},f),{},{UID:i.UserID})),t.prev=6,t.next=9,e.post("CancelFavorite",f);case 9:return p={isFavorite:!1},u(p),d("delete"),t.abrupt("return",!0);case 15:return t.prev=15,t.t0=t["catch"](6),N&&e.showToast("\u53d6\u6d88\u6536\u85cf\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5\u3002"),console.log(t.t0),e.logPageError("fetchCancelFavorite",t.t0),t.abrupt("return",!1);case 21:case"end":return t.stop()}}),t,null,[[6,15]])})));return function(){return t.apply(this,arguments)}}(),me=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,s,u,d,f,p,m,I,h,g,v,x,S,T,P,y,w,C,N;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=a.getState(),i=r.BasicInfo,s=r.wakenUpData,r.shark,u=r.PreSaleTourGroupInfo,d=r.isPreSale,f=l.UPDATE_MULTIPLE_LINE,p=l.SET_LINE_SWITCH_LOADING,d&&u&&u.PreSaleInfo&&(I=u.PreSaleInfo,I.length&&(h=I.find((function(e){return e.ProductId===n})),h&&h.PreSaleProductId&&(m=h.PreSaleProductId))),g="ProductInfo_App_MultiLine_V2",v=Z.fetchMultiLineDetailInfo(m),x={params:(0,c.Z)({ProductId:n,DepartureCityId:i.DepartureId,MarketingInfo:{AllianceId:s.allianceid,SId:s.sid}},e.attachShardParams()),priceCalendarParams:{queryTourGroup:!1,needInventory:!1,needFlightDiscountPrice:!0},bookFormEmotionalCuesParams:{HeadTagList:[{Key:"from_page",Value:"product"},{Key:"emotional_type",Value:"emergency_info_new"},{Key:"page_index",Value:"1002"},{Key:"business_line",Value:"1"}]},servicePersonParams:{PageType:1,PageSize:10,PageIndex:1}},m&&(x=(0,c.Z)((0,c.Z)({},x),{},{PreSaleParams:(0,c.Z)({ProductId:Number(m),DepartureCityId:Number(i.DepartureId)},e.attachShardParams())})),z&&(x.params.testCaseId="45305792"),t.prev=8,p(!0),t.next=12,e.gqlpost(v,x,g);case 12:if(S=t.sent,T=S.data,P=S.extensions,y=T.productInfo,w=T.PreSaleProductInfo,C=y.ResponseStatus,"Success"!==C.Ack){t.next=22;break}f({productInfo:y,targetProductId:n,PreSaleProductInfo:w}),p(!1),t.next=23;break;case 22:throw new Error(C.Errors[0].Message);case 23:return t.abrupt("return",P);case 26:t.prev=26,t.t0=t["catch"](8),console.log(t.t0),p(!1),N="\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",e.showToast(N),e.logPageError("fetchMultiLineDetailInfo",t.t0);case 33:case"end":return t.stop()}}),t,null,[[8,26]])})));return function(e){return t.apply(this,arguments)}}(),Ie=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,s,u,d,f,p,m,I,h,g,v;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=a.getState(),i=r.BasicInfo,r.shark,s=l.UPDATE_MULTIPLE_TRAVEL,u=l.SET_LINE_SWITCH_LOADING,d="ProductInfo_App_MultiTravel_V2",f=Z.fetchMultiTravelDetailInfo,p={params:(0,c.Z)({ProductId:i.ProductId,DepartureCityId:i.DepartureId,Alias:[n]},e.attachShardParams())},t.prev=5,u(!0),t.next=9,e.gqlpost(f,p,d);case 9:if(m=t.sent,I=m.data,h=I.productInfo,g=h.ResponseStatus,"Success"!==g.Ack){t.next=18;break}s({productInfo:h,targetAlias:n}),u(!1),t.next=19;break;case 18:throw new Error(g.Errors[0].Message);case 19:t.next=28;break;case 21:t.prev=21,t.t0=t["catch"](5),console.log(t.t0),u(!1),v="\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",e.showToast(v),e.logPageError("fetchMultiTravelDetailInfo",t.t0);case 28:case"end":return t.stop()}}),t,null,[[5,21]])})));return function(e){return t.apply(this,arguments)}}(),he=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n,r,i){var s,u,d,f,p,m,I,h,g,v,x,S,T,P,y,w,C,N,j,_,b,k,L,B,R,M,E,V,A,O,U,F,G,H,K,W;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=a.getState(),u=s.BasicInfo,d=s.pageStatus,f=s.currentRouteInfo,s.shark,p=s.TourGroupInfo,m=s.wakenUpData,I=s.PreSaleTourGroupInfo,h=s.isPreSale,g=d.isMultiLine,v=d.isMultiTravel,x=d.activeAlias,S=l.UPDATE_NEWDEPARTCITY_INFO,T=l.SET_LINE_SWITCH_LOADING,h&&I&&I.PreSaleInfo&&(y=I.PreSaleInfo,y.length&&(w=y.find((function(e){return e.ProductId===r})),w&&w.PreSaleProductId&&(P=w.PreSaleProductId))),C="ProductNewCity_App_1st_V1",N=Z.fetchNewDepartCityProductInfo(g,v,P),j=f.PriceInfo,_=j.DepartureCityPriceList,b=_&&null!==_&&void 0!==_&&_.filter((function(e){return e.DepartureCityId===n}))[0]?null===_||void 0===_?void 0:_.filter((function(e){return e.DepartureCityId===n}))[0].ProductIdList:[],k=b.includes(u.ProductId)?u.ProductId:r,L={MainParams:(0,c.Z)({ProductId:k,DepartureCityId:n,MarketingInfo:{AllianceId:m.allianceid,SId:m.sid}},e.attachShardParams()),bookFormEmotionalCuesParams:{HeadTagList:[{Key:"from_page",Value:"product"},{Key:"emotional_type",Value:"emergency_info_new"},{Key:"page_index",Value:"1002"},{Key:"business_line",Value:"1"}]},priceCalendarParams:{queryTourGroup:!1,needInventory:!1,needFlightDiscountPrice:!0},servicePersonParams:{PageType:1,PageSize:10,PageIndex:1}},g&&(L=(0,c.Z)((0,c.Z)({},L),{},{RouteParams:(0,c.Z)({ProductId:r,DepartureCityId:n,MarketingInfo:{AllianceId:m.allianceid,SId:m.sid}},e.attachShardParams())})),v&&(L=(0,c.Z)((0,c.Z)({},L),{},{RouteParams:(0,c.Z)({ProductId:u.ProductId,Alias:[x],DepartureCityId:n,MarketingInfo:{AllianceId:m.allianceid,SId:m.sid}},e.attachShardParams())})),P&&(L=(0,c.Z)((0,c.Z)({},L),{},{PreSaleParams:(0,c.Z)({ProductId:Number(P),DepartureCityId:n},e.attachShardParams())})),z&&(L.MainParams.testCaseId="44954748",L.RouteParams.testCaseId="44954748"),t.prev=15,t.next=18,e.gqlpost(N,L,C);case 18:R=t.sent,M=R.data,E=R.extensions,S(M),D(),e.sendKMLog({attrs:[{key:"productId",value:u.ProductId}],scene:"\u51fa\u53d1\u57ce\u5e02\u5207\u6362",action:i?"usr_change":"sys_change",value:M.MainProductInfo.BasicInfo.DepartureCityName,before:u.DepartureCityName,rootMessageId:null===E||void 0===E||null===(B=E.SoaResponseStatus)||void 0===B||null===(B=B.ResponseStatus)||void 0===B||null===(B=B.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===B?void 0:B.Value}),d.activeProductId!==r&&(A=p.TourGroupProductInfo.filter((function(e){return e.ProductId===r}))[0],O=["A","B","C","D","E","F","G","H","I","J"][A.SortNumber-1],U=p.TourGroupProductInfo.filter((function(e){return e.ProductId===d.activeProductId}))[0],F=["A","B","C","D","E","F","G","H","I","J"][U.SortNumber-1],e.sendKMLog({attrs:[{key:"productId",value:u.ProductId}],scene:"\u591a\u7ebf\u8def\u5207\u6362",action:"usr_change",value:"".concat(O,"\u7ebf\uff1a").concat(r),before:"".concat(F,"\u7ebf\uff1a").concat(d.activeProductId),rootMessageId:null===E||void 0===E||null===(V=E.SoaResponseStatus)||void 0===V||null===(V=V.ResponseStatus)||void 0===V||null===(V=V.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===V?void 0:V.Value})),G=M.MainProductInfo,H=G.BookInfo,K=G.ScheduleInfo,H.IsBook&&K.HasInventory&&T(!0),t.next=35;break;case 29:t.prev=29,t.t0=t["catch"](15),console.log(t.t0),W="\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",e.showToast(W),e.logPageError("fetchNewDepartCityProductInfo",t.t0);case 35:case"end":return t.stop()}}),t,null,[[15,29]])})));return function(e,n,r){return t.apply(this,arguments)}}(),ge=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,u,d,f,p,m,I,h,g,v,x,S,T,P,y,w,C,N,D,j;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.pageStatus,i=n.wakenUpData,s=n.ParentsProductList,u=n.ChildrenProductList,d=n.LocationInfo,f=n.isSecKill,p=l.SWITCH_TO_NEW_PRODUCT,m="RelatedProductInfo_App_1st_V2",I=f?Z.fetchProductBasicInfo_SecKill:Z.fetchProductBasicInfo,h=r.initD2DSwitchType,2!==h||s&&s[0]&&s[0].parentProductInfo){t.next=7;break}return t.abrupt("return");case 7:if(1!==h||u&&u[0]&&u[0].childProductInfoList&&u[0].childProductInfoList[0]){t.next=9;break}return t.abrupt("return");case 9:if(2===h&&(g=s[0].parentProductInfo.productId,x=s[0].parentProductInfo,v=x.departureCities&&x.departureCities[0]&&x.departureCities[0].DepartureCityId),1===h&&(g=u[0].childProductInfoList[0].productId,v=null===d||void 0===d?void 0:d.departureCityId),g){t.next=13;break}return t.abrupt("return");case 13:return S={params:(0,c.Z)({ProductId:Number(g),DepartureCityId:Number(v||2),MarketingInfo:{AllianceId:i.allianceid,SId:i.sid}},e.attachShardParams()),bookFormEmotionalCuesParams:{HeadTagList:[{Key:"from_page",Value:"product"},{Key:"emotional_type",Value:"emergency_info_new"},{Key:"page_index",Value:"1002"},{Key:"business_line",Value:"1"}]}},t.prev=14,t.next=17,e.gqlpost(I,S,m);case 17:if(T=t.sent,P=T.data,y=T.errors,w=T.extensions,!y){t.next=25;break}throw new Error(y[0].message);case 25:if(C=P.productInfo,N=C.ResponseStatus,D=C.BasicInfo,"Success"!==N.Ack){t.next=34;break}return p({productInfo:C}),e.sendKMLog({attrs:[{key:"productId",value:String(D.ProductId)}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u9996\u5c4f /tour/bff/graphql/RelatedProductInfo_App_1st_V2",action:"sys_show",rootMessageId:null===w||void 0===w||null===(j=w.SoaResponseStatus)||void 0===j||null===(j=j.ResponseStatus)||void 0===j||null===(j=j.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===j?void 0:j.Value}),t.next=32,ve();case 32:t.next=35;break;case 34:throw new Error(N.Errors[0].Message);case 35:t.next=41;break;case 37:t.prev=37,t.t0=t["catch"](14),console.log(t.t0),e.logPageError("fetchFullD2DProductInfo",t.t0);case 41:case"end":return t.stop()}}),t,null,[[14,37]])})));return function(){return t.apply(this,arguments)}}(),ve=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,u,d,f,p,m,I,h,g,v,x,S,P,y,w,C,N,D,j,_,b,k;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=a.getState(),r=n.query,i=n.wakenUpData,s=n.BasicInfo,u=n.PreSaleTourGroupInfo,d=n.isPreSale,f=n.isSecKill,p=s.ProductId,m=s.DepartureId,d&&u&&u.PreSaleInfo&&(h=u.PreSaleInfo,h.length&&(g=h.find((function(e){return e.ProductId===p})),g&&g.PreSaleProductId&&(I=g.PreSaleProductId))),v="RelatedProductInfo_App_2nd_V2",x=f?Z.fetchProductSecondInfo_SecKill:Z.fetchProductSecondInfo(I),S={params:(0,c.Z)({ProductId:Number(p),DepartureCityId:Number(m),MarketingInfo:{AllianceId:i.allianceid,SId:i.sid}},e.attachShardParams()),servicePersonParams:{PageType:1,PageSize:10,PageIndex:1},expertParams:{exportType:1,pageIndex:1,pageSize:3},imEntryInfoParams:{pageFrom:"detail",sourceFrom:"1"===r.fromhhtravel?"hhtravel":""},priceCalendarParams:{queryTourGroup:!1,needInventory:!1,needFlightDiscountPrice:!0},groupChildrenParams:{locationCityId:0}},I&&(S=(0,c.Z)((0,c.Z)({},S),{},{PreSaleParams:(0,c.Z)({ProductId:Number(I),DepartureCityId:Number(m)},e.attachShardParams())})),t.prev=7,t.next=10,e.gqlpost(x,S,v);case 10:if(P=t.sent,y=P.data,w=P.errors,C=P.extensions,!w){t.next=18;break}throw new Error(w[0].message);case 18:if(N=y.productInfo,D=y.PreSaleProductInfo,j=N.ResponseStatus,_=(0,T.Z)(N,H),"Success"!==j.Ack){t.next=26;break}k=l.SWITCH_TO_NEW_PRODUCT_SECOND,k({other:_,PreSaleProductInfo:D}),e.sendKMLog({attrs:[{key:"productId",value:String(s.ProductId)}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u6b21\u5c4f /tour/bff/graphql/RelatedProductInfo_App_2nd_V2",action:"sys_show",rootMessageId:null===C||void 0===C||null===(b=C.SoaResponseStatus)||void 0===b||null===(b=b.ResponseStatus)||void 0===b||null===(b=b.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===b?void 0:b.Value}),t.next=27;break;case 26:throw new Error(j.Errors[0].Message);case 27:t.next=33;break;case 29:t.prev=29,t.t0=t["catch"](7),e.logPageError("fetchFullProductSecondInfo",t.t0),console.log(t.t0);case 33:case"end":return t.stop()}}),t,null,[[7,29]])})));return function(){return t.apply(this,arguments)}}(),xe=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,a;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(n<=0)){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,e.post("GetCityNameByCityId",{CityIds:[n]});case 5:if(r=t.sent,i=r.CityList,!i||!i[0]){t.next=12;break}return a=i[0].NameCN,t.abrupt("return",a);case 12:return t.abrupt("return","");case 13:t.next=19;break;case 15:t.prev=15,t.t0=t["catch"](2),console.log(t.t0),e.logPageError("fetchCityNameByCityId",t.t0);case 19:case"end":return t.stop()}}),t,null,[[2,15]])})));return function(e){return t.apply(this,arguments)}}(),Se=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n,r){var i,s,c,l,u;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=a.getState(),s=i.BasicInfo,c={trackInfoType:{trackSBUType:"TeamTour",trackType:"WishOrder",trackFromType:"Wireless",trackSubChannel:12,orderUserType:{contactPhone:r},trackOrderType:{trackProductType:{productId:s.ProductId,startCityId:s.DepartureId,saleMode:s.SaleMode,destName:s.DestCityName},startDateFrom:n[0],startDateTo:n[1],remark:"\u65b0\u51a0\u80ba\u708e\u5f71\u54cd\uff0c\u8bf7\u5728\u533a\u57df\u4e1a\u52a1\u6062\u590d\u540e\u53ca\u65f6\u8054\u7cfb"}}},e.showMaskLoading(),t.prev=3,t.next=6,e.post("CreateTrack",c);case 6:if(l=t.sent,u=l.ResponseStatus,e.hideMaskLoading(),!u||"Success"!==u.Ack){t.next=14;break}return e.showToast("\u610f\u5411\u5355\u63d0\u4ea4\u6210\u529f\uff0c\u5ba2\u670d\u4f1a\u5728\u4ea7\u54c1\u5f00\u653e\u9884\u8ba2\u540e\u8054\u7cfb"),t.abrupt("return",!0);case 14:return e.showToast("\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"),t.abrupt("return",!1);case 16:t.next=25;break;case 18:return t.prev=18,t.t0=t["catch"](3),e.hideMaskLoading(),console.log(t.t0),e.showToast("\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"),e.logPageError("fetchCreateTrackOrder",t.t0),t.abrupt("return",!1);case 25:case"end":return t.stop()}}),t,null,[[3,18]])})));return function(e,n){return t.apply(this,arguments)}}(),Te=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,M();case 2:return e.next=4,ue();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Pe=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=a.getState(),r=n.isLogin,t.next=3,e.getUserInfo();case 3:i=t.sent,s=i.isLogin,s&&!r&&Te();case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ye=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,s,c,l,u,d,f;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=n.tourId,i=n.useDate,s=n.pageId,c=a.getState(),l=c.BasicInfo,l.isCruise||z){t.next=4;break}return t.abrupt("return");case 4:return u={tourId:r,useDate:i,cruHead:{channel:e.H5Util.isBestone()?"BST":"H5",channel3:e.H5Util.getServiceChannelId()||116,localeLang:"zh-CN",pageId:s,currency:"CNY",clientInfo:{salesPlatform:"H5"}}},t.prev=5,t.next=8,e.post("ProductDetailTourDetail",u);case 8:return f=t.sent,e.sendKMLog({attrs:[{key:"tourId",value:r}],scene:"\u8be6\u60c5\u9875\u70b9\u51fb\u5cb8\u4e0a\u6e38\u8d44\u6e90 /19658/ProductDetailTourDetail",action:P.Us.show,value:r,rootMessageId:null===f||void 0===f||null===(d=f.responseStatus)||void 0===d||null===(d=d.extension.find((function(e){return"RootMessageId"===e.id})))||void 0===d?void 0:d.value}),t.abrupt("return",f);case 13:t.prev=13,t.t0=t["catch"](5),e.logPageError("fetchProductDetailTourDetail",t.t0),console.log(t.t0);case 17:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(e){return t.apply(this,arguments)}}(),we={handleMultiLineChange:function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,s,c,u,d,f,p,m,h,g,v,x,S,T,P,y,w,N,D,j,_,b,k,L,B,R,M,E,A,Z,O=arguments;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=!(O.length>1&&void 0!==O[1])||O[1],s=!(O.length>2&&void 0!==O[2])||O[2],c=a.getState(),u=c.BasicInfo,d=c.pageStatus,f=c.routeInfo,p=c.TourGroupInfo,m=c.currentRouteInfo,c.shark,h=c.groupCard,g=c.isTabStyle,v=l.UPDATE_CURRENT_ROUTE,l.SET_LINE_SWITCH_LOADING,x=l.UPDATE_SERVICE_PERSONS,n!==d.activeProductId){t.next=6;break}return t.abrupt("return");case 6:if(S=null===p||void 0===p||null===(r=p.TourGroupProductInfo)||void 0===r?void 0:r.filter((function(e){return e.ProductId===n}))[0],S){t.next=9;break}return t.abrupt("return");case 9:if(T=S.DepartureCities,P=["A","B","C","D","E","F","G","H","I","J"][S.SortNumber-1],y=d.activeProductId,w=p.TourGroupProductInfo.filter((function(e){return e.ProductId===d.activeProductId}))[0],N=["A","B","C","D","E","F","G","H","I","J"][w.SortNumber-1],!C){t.next=17;break}t.next=60;break;case 17:if(!T||!T.includes(u.DepartureId)){t.next=40;break}if(D=void 0,j=f[n],!j||!j.isLoaded){t.next=25;break}v({targetProductId:n,targetRouteItem:j}),V(n),t.next=34;break;case 25:return t.next=27,me(n);case 27:if(b=t.sent,D=null===b||void 0===b||null===(_=b.SoaResponseStatus)||void 0===_||null===(_=_.ResponseStatus)||void 0===_||null===(_=_.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===_?void 0:_.Value,!g||!h||h.oneWithN){t.next=34;break}return t.next=32,ae();case 32:k=t.sent,k&&x(k);case 34:return s&&e.sendKMLog({attrs:[{key:"productId",value:u.ProductId}],scene:"\u591a\u7ebf\u8def\u5207\u6362",action:i?"usr_change":"sys_change",value:"".concat(P,"\u7ebf\uff1a").concat(n),before:"".concat(N,"\u7ebf\uff1a").concat(y),rootMessageId:D}),I=!0,Fe(),t.abrupt("return",!0);case 40:if(!T||1!==T.length){t.next=55;break}return L=T[0],B=m.PriceInfo,R=B&&B.DepartureCityPriceList&&B.DepartureCityPriceList.filter((function(e){return e.DepartureCityId===L}))[0],M=R?R.DepartureCityName:"",t.next=47,we.handleChangeDepartCity(L,n,!1,!0,M);case 47:e.showToast("".concat(P,"\u7ebf\u4ec5\u652f\u6301\u3010").concat(M,"\u3011\u51fa\u53d1\uff0c\u5df2\u4e3a\u60a8\u81ea\u52a8\u5207\u6362")),e.sendKMLog({attrs:[{key:"productId",value:u.ProductId}],scene:"\u591a\u7ebf\u8def\u5207\u6362",action:i?"usr_change":"sys_change",value:"".concat(P,"\u7ebf\uff1a").concat(n),before:"".concat(N,"\u7ebf\uff1a").concat(y)}),I=!0,Fe(),dt(1),ft(),t.next=60;break;case 55:E=l.TOGGLE_CITY_SELECT_MASK,A=l.SET_CITY_SELECT_MASK_INFO,Z={params:{message:"\u672c\u4ea7\u54c1\u4e0d\u652f\u6301\u4ece".concat(u.DepartureCityName,"\u51fa\u53d1\uff0c\u5efa\u8bae\u60a8\u5207\u6362\u51fa\u53d1\u57ce\u5e02"),textPositive:"\u9009\u62e9\u51fa\u53d1\u57ce\u5e02",textNegative:"\u53d6\u6d88"},positiveCallback:function(){console.log("\u7528\u6237\u70b9\u51fb\u786e\u5b9a"),E(!0),A(n)},negativeCallback:function(){console.log("\u7528\u6237\u70b9\u51fb\u53d6\u6d88")},style:{zIndex:999}},"Taro"===e.Platform&&(Z={content:"\u672c\u4ea7\u54c1\u4e0d\u652f\u6301\u4ece".concat(u.DepartureCityName,"\u51fa\u53d1\uff0c\u5efa\u8bae\u60a8\u5207\u6362\u51fa\u53d1\u57ce\u5e02"),cancelText:"\u53d6\u6d88",confirmText:"\u5207\u6362",showCancel:!0,confirmColor:"#0086f6",cancelColor:"#0086f6",success:function(e){e.confirm?(console.log("\u7528\u6237\u70b9\u51fb\u786e\u5b9a"),E(!0),A(n)):e.cancel&&console.log("\u7528\u6237\u70b9\u51fb\u53d6\u6d88")}}),e.showDialog(Z),ut();case 60:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}(),handleMultiTravelChange:function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,s,c,u,d,f;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=a.getState(),i=r.pageStatus,s=r.routeInfo,c=r.BasicInfo,u=l.UPDATE_CURRENT_ROUTE,n!==i.activeAlias){t.next=4;break}return t.abrupt("return");case 4:if(d=i.activeAlias,f=s[n],!f||!f.isLoaded){t.next=10;break}u({targetAlias:n,targetRouteItem:f}),t.next=12;break;case 10:return t.next=12,Ie(n);case 12:return I=!0,Fe(),e.sendKMLog({attrs:[{key:"productId",value:c.ProductId}],scene:"\u591a\u884c\u7a0b\u5207\u6362",action:"usr_change",value:"".concat(n,"\u7ebf"),before:"".concat(d,"\u7ebf")}),t.abrupt("return",!0);case 16:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}(),handleToggleCitySelectMask:function(e){var t=l.TOGGLE_CITY_SELECT_MASK,n=l.SET_CITY_SELECT_MASK_INFO;if(t(e),!e){var r=a.getState(),i=r.citySelectTargetProductId;i&&It("\u5173\u95ed"),C&&n(null)}},handleChangeDepartCity:function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n,r){var i,s,u,d,f,p,m,I,h,g,v,x,S,T,P,y=arguments;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=!(y.length>2&&void 0!==y[2])||y[2],s=!(y.length>3&&void 0!==y[3])||y[3],u=y.length>4&&void 0!==y[4]?y[4]:"",d=a.getState(),f=d.BasicInfo,p=d.citySelectTargetProductId,m=d.currentRouteInfo,I=d.issyncLiistInfo,h=d.pageStatus,g=d.query,v=l.SET_CITY_SELECT_MASK_INFO,x=l.SET_EXTENDSTAY_SHOPPING,n!==f.DepartureId){t.next=7;break}return t.abrupt("return");case 7:return N&&(lt(f.DepartureId,n),p&&(S=m.PriceInfo,T=S&&S.DepartureCityPriceList&&S.DepartureCityPriceList.filter((function(e){return e.DepartureCityId===n}))[0].DepartureCityName,It(T)),v(0)),"H5"===e.Platform&&(P="?".concat(O.stringify((0,c.Z)((0,c.Z)({},g),{},{departcityid:n}))),history.replaceState(null,"",P)),e.get("TOUR_SHOPPING_HISTORY")&&e.remove("TOUR_SHOPPING_HISTORY"),e.showMaskLoading(),t.next=13,he(n,r,i);case 13:return t.next=15,J();case 15:e.hideMaskLoading(),N&&I&&s&&Ce(n,u),h.isExtendedStay&&x();case 18:case"end":return t.stop()}}),t)})));function n(e,n){return t.apply(this,arguments)}return n}(),handleClickFavorite:function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,c,u,d,f,m,I;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=a.getState(),i=r.isLogin,c=r.myFavorites,u=l.TOGGLE_SHOW_MENU_POP,d=l.SET_FAVOURITE_MENU_POSITION,c){t.next=5;break}return p=!0,t.abrupt("return");case 5:if(i){t.next=9;break}e.isInWebviewH5()?e.loginInWebview():"Taro"===(null===e||void 0===e?void 0:e.Platform)?e.login({callback:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Te();case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}):_e({afterCallback:function(){we.handleClickFavorite(n)}}),t.next=21;break;case 9:if(f=c||{},m=f.isFavorite,!m){t.next=16;break}return t.next=13,pe();case 13:t.t0=t.sent,t.next=19;break;case 16:return t.next=18,fe();case 18:t.t0=t.sent;case 19:I=t.t0,C?d(n):I&&u(!0);case 21:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}(),handleHideFavoriteMenu:function(){var e=l.TOGGLE_SHOW_MENU_POP,t=l.UPDATE_FAVOURITE_MENU,n=a.getState(),r=n.favoriteMenuStatus;"hide"!==r&&(t("hide"),N&&e(!1))},handleGoTravelIntention:function(){var t=a.getState(),n=t.BasicInfo,r=t.pageStatus,i="/webapp/vacations/tour/travelintention",o={outtype:n.isDiyfhxsdp?"diy":"tour",subchannelid:12,sourcetype:2,productid:r.activeProductId||n.ProductId,dcityid:n.DepartureId,destid:n.DestCityId,dest:n.DestCityName};e.jumpH5({url:i,params:o})},handleGoLargeGroupIntention:function(){var t=a.getState(),n=t.BasicInfo,r=t.pageStatus,i="/webapp/vacations/tour/adjustintention",o={productId:r.activeProductId,departcityid:n.DepartureId,large:1};e.jumpH5({url:i,params:o})},handleToggleCouponMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowCouponMask:e})},handleToggleGatherInfoMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowGatherInfoMask:e})},handleTogglePromotionMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowPromotionMask:e}),e&&Tt({scene:"\u4f18\u60e0\u4fe1\u606f\u5f39\u5c42",value:"\u663e\u793a"})},handleToggleCreditMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowCreditMask:e})},handleToggleServiceTagMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowServiceTagMask:e}),Tt({scene:"\u670d\u52a1\u6807\u7b7e\u5f39\u5c42",value:e?"\u663e\u793a":"\u9690\u85cf"})},handleToggleSpecialBrandMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowSpecialBrandMask:e}),Tt({scene:"\u54c1\u724c\u5f39\u5c42",value:e?"\u663e\u793a":"\u9690\u85cf"})},handleToggleGoldGuideMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowGoldGuideMask:e}),Tt({scene:"\u91d1\u724c\u5bfc\u6e38\u5f39\u5c42",value:e?"\u663e\u793a":"\u9690\u85cf"})},handleToggleTpalMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowTpalMask:e}),Tt({scene:"Tpal\u5f39\u5c42",value:e?"\u663e\u793a":"\u9690\u85cf"})},handleToggleH5PageMask:function(e){var t=e.isShowH5PageMask,n=e.H5PageMaskUrl,r=l.UPDATE_POP_STATUS;r({isShowH5PageMask:t,H5PageMaskUrl:n}),Tt({scene:"H5\u5510\u56fe\u8425\u9500\u9875\u5f39\u5c42",value:t?"\u663e\u793a":"\u9690\u85cf"})},handleToggleCustomerServiceMask:function(t){if(we.handleHideFavoriteMenu(),"H5"===e.Platform||"Taro"===e.Platform){var n=l.UPDATE_POP_STATUS;n({isShowCustomerServiceMask:t})}else{var r=a.getState(),i=r.imEntryInfo,o=r.BasicInfo,s=r.actionIdSuffix,c=(r.pageStatus,r.pageId),u=o.isCruise;if(!i)return;var d=i.imInfo,f=i.serviceInfo,p=d.mobileServiceTime,m=d.afterSaleServiceTime,I=d.mobile,h=d.mobileCode,g=d.afterSaleTel,v=d.afterSaleExtTel,x=d.imSwitch,S=d.inquiry,T=d.imServiceTime,P=I;h&&(P="".concat(I,",").concat(h)),P=String(P).split("-").join("");var y=g;h&&(y="".concat(g,",").concat(v)),y=String(y).split("-").join("");var w=[],C="\u643a\u7a0b\u5ba2\u670d";if(f&&f.shortServiceToast&&"\u5546\u5bb6"===f.shortServiceToast&&(C="\u5546\u5bb6\u5ba2\u670d"),x){var N=We();w.push({consultItemDataList:[{itemDescription:u?"".concat(T?"\u670d\u52a1\u65f6\u95f4\uff1a".concat(T,"\n"):"").concat(C,"\u4e13\u5458\u63d0\u4f9b\u5728\u7ebf\u670d\u52a1\uff0c\u975e\u5de5\u4f5c\u65f6\u95f4\u53ef\u62e8\u6253\u7535\u8bdd\u8054\u7cfb\u6211\u4eec"):"".concat(T?"\u670d\u52a1\u65f6\u95f4\uff1a".concat(T,"\n"):"").concat(C,"\u4e13\u5458\u63d0\u4f9b\u5728\u7ebf\u670d\u52a1\uff0c\u89e3\u7b54\u5ea6\u5047\u76f8\u5173\u95ee\u9898"),itemType:"IM",jumpUrl:N}],moduleTitle:"\u8054\u7cfb\u5728\u7ebf\u5ba2\u670d"})}if(S&&(P||y)){var D=[];I&&P&&D.push({itemTitle:"\u552e\u524d\u54a8\u8be2",itemDescription:"".concat(p?"\u670d\u52a1\u65f6\u95f4\uff1a".concat(p,"\n"):"","\u7535\u8bdd\u63a5\u901a\u540e\uff0c\u8bf7\u544a\u77e5\u5ba2\u670d\u4ea7\u54c1\u7f16\u53f7: ").concat(o.ProductId),itemLightDescriptionList:["".concat(o.ProductId)],destinationNumber:I,channelNumber:h||"",destinationNumberDisplay:P,itemType:"PSTN",locationGlobalId:"1",locationName:"\u4e2d\u56fd"}),g&&y&&D.push({itemTitle:"\u552e\u540e\u54a8\u8be2",itemDescription:"".concat(m?"\u670d\u52a1\u65f6\u95f4\uff1a".concat(m,"\n"):"","\u5982\u60a8\u8ba2\u5355\u5df2\u63d0\u4ea4\uff0c\u53ef\u8054\u7cfb\u552e\u540e\u5ba2\u670d\u67e5\u8be2\u53ca\u4fee\u6539"),destinationNumber:g,channelNumber:v||"",destinationNumberDisplay:y,itemType:"PSTN",locationGlobalId:"1",locationName:"\u4e2d\u56fd"}),w.push({consultItemDataList:D,moduleTitle:"\u62e8\u6253\u5ba2\u670d\u7535\u8bdd"})}e.Business.doBusinessJob(10,"100011",{widgetTitle:"\u8054\u7cfb\u5ba2\u670d",consultModuleDataList:w,traceContent:"".concat(s,"-popups"),pageId:c},(new Date).valueOf().toString(),(function(){}))}Tt({scene:"\u5ba2\u670d\u5f39\u5c42",value:"\u5524\u8d77\u516c\u5171\u7ec4\u4ef6"})},handleGoSelectPhoneCode:function(e){var t="/webapp/vacations/tour/order_phone",n=e;b({url:t,params:n})},handleSubmitProposalOrder:function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n,r){var i,a,s;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=l.UPDATE_PROPOSAL_ORDER_STATUS,a=l.UPDATE_PROPOSAL_ORDER_INFO,a(n),e.showLoading(),t.next=5,Pt(n,r);case 5:return s=t.sent,s?(e.showToast("\u9884\u7ea6\u6210\u529f"),i(!0),e.hideLoading()):(e.showToast("\u63d0\u4ea4\u5931\u8d25"),e.hideLoading()),t.abrupt("return",s);case 8:case"end":return t.stop()}}),t)})));function n(e,n){return t.apply(this,arguments)}return n}(),handleToggleProposalOrderMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowProposalOrderMask:e}),we.handleToggleCustomerServiceMask(!e)},handleTogglePriceTipMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowPriceTipMask:e}),Tt({scene:"\u8d77\u4ef7\u8bf4\u660e\u5f39\u5c42",value:e?"\u663e\u793a":"\u9690\u85cf"})},handleToggleUrgentMask:function(t){var n=a.getState(),r=n.emotionalCues,i=n.BasicInfo,o=l.UPDATE_POP_STATUS;o({isShowUrgentMask:t});var s=r.urgentInfo.map((function(e,t){var n=e.RichContent,r=e.Title;return{key:"\u516c\u544a\u8be6\u60c5".concat(t+1,": ").concat(r),value:n}}));e.sendKMLog({attrs:[{key:"productId",value:i.ProductId}],scene:"\u75ab\u60c5\u516c\u544a\u5f39\u5c42",action:"usr_click",value:t?"\u663e\u793a":"\u9690\u85cf",jsonData:t?s:null})},handleTogglePreSaleNoticeMask:function(t){var n=a.getState(),r=n.BasicInfo,i=l.TOGGLE_PRESALE_NOTICE_MASK;i(t),e.sendKMLog({attrs:[{key:"productId",value:r.ProductId}],scene:"\u9884\u552e\u987b\u77e5\u5f39\u5c42",action:"usr_click",value:t.status?"\u663e\u793a":"\u9690\u85cf"})},handleToggleGODetailMask:function(t){var n=a.getState(),r=n.BasicInfo,i=l.UPDATE_POP_STATUS;i({isShowGODetailMask:t}),e.sendKMLog({attrs:[{key:"productId",value:r.ProductId}],scene:"GO\u8bf4\u660e\u5f39\u5c42",action:"usr_click",value:t?"\u663e\u793a":"\u9690\u85cf"})},handleToggleTpalMemberMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowTpalMemberMask:e})},handleToggleScenicMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowScenicMask:e})},handleToggleTrafficPriceTipMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowTrafficPriceTipMask:e})},handleRouteModeChange:function(){var e=l.TOGGLE_ROUTE_MODE;e()},handleToggleCalendarPop:function(t){var n=a.getState(),r=n.BasicInfo,i=l.UPDATE_POP_STATUS;if(i({isShowCalendarPop:t}),!t){var o=a.getState(),s=o.isShowCalendarPop;s||e.sendKMLog({attrs:[{key:"productId",value:r.ProductId}],module:"\u4ef7\u683c\u65e5\u5386\u5f39\u5c42",action:"usr_click",value:"\u5173\u95ed"})}},handleTogglePresaleCalendarPop:function(e){var t=l.UPDATE_POP_STATUS;t({isShowPresaleCalendarPop:e})},handleToggleCruisePriceDetail:function(e){var t=l.UPDATE_POP_STATUS;t({isShowCruisePriceDetail:e})},handleToggleMemberShipMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowMemberShipMask:e})},handleToggleScenicExcludingFeeMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowScenicExcludingFeeMask:e})},handleToggleThemeDifficultyMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowThemeDifficultyMask:e})},handleSwitchRoomType:function(e){var t,n,r,i=a.getState(),o=i.CruiseRoomInfo,s=i.BasicInfo,c=l.SET_CUR_ROOMTYPE,u=o.ClassRooms,d=o.curRoomType,f=o.RoomInfos;null!==(t=u[e])&&void 0!==t&&t.length?c(e):Q({RoomType:e});var p=null===(n=f.find((function(t){return t.RoomType===e})))||void 0===n?void 0:n.Name,m="".concat(p,"\uff08").concat(e,"\uff09"),I=null===(r=f.find((function(e){return e.RoomType===d})))||void 0===r?void 0:r.Name,h="".concat(I,"\uff08").concat(d,"\uff09");x({attrs:[{key:"productId",value:String(null===s||void 0===s?void 0:s.ProductId)}],scene:"\u8231\u623f\u7c7b\u578b",role:P.GD.usr,action:P.Us.change,value:m,before:h})},handleSelectRoomTag:function(e){var t,n=l.SET_SELECT_ROOM_TAG;n(e);var r=a.getState(),i=r.CruiseRoomInfo,o=r.BasicInfo,s=i.selectedTags,c=i.curRoomType;Q({RoomType:c,Tags:s[c]});var u=null===(t=s[c])||void 0===t||null===(t=t.map((function(e){return e.Name})))||void 0===t?void 0:t.join(",");x({attrs:[{key:"productId",value:String(null===o||void 0===o?void 0:o.ProductId)}],scene:"\u8231\u623f\u5feb\u7b5b\u6807\u7b7e",role:P.GD.usr,action:P.Us.change,value:u||"-"})},handleResetRoomTag:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n,r,i;return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=l.RESET_SELECT_ROOM_TAG,t(),n=a.getState(),r=n.CruiseRoomInfo,i=r.curRoomType,e.next=6,Q({RoomType:i,Tags:[]});case 6:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),handleToggleOvaryRoomDetail:function(e){var t=l.UPDATE_OVARYROOM_DETAIL;t(e)},handleToggleCruiseJourneyInfo:function(e){var t=l.UPDATE_CRUISE_JOURNEY_DETAIL;t(e)},handleToggleOvaryRoomPriceInfo:function(e){var t=l.UPDATE_OVARYROOM_PRICE_INFO;t(e)},handleToggleSeaCruiseInfo:function(e){var t=l.UPDATE_POP_STATUS;t({isShowSeaCruiseInfo:e})},handleShare:function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,l,u,d,f,p,m,I,h,g,v,x,S,T,P,y,w,C,N;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=a.getState(),r=n.BasicInfo,i=n.pageStatus,s=n.currentRouteInfo,l=n.query,n.switchConfig,u=s.PriceInfo,d=s.SegmentInfo,f=r.isPureDiyfhxsdp,p=r.isCruise,m={productId:r.ProductId,departCityId:r.DepartureId,AllianceID:263382,SID:1520352},i.isMultiLine?m=(0,c.Z)((0,c.Z)({},m),{},{pkgType:"multiline",lineProductId:i.activeProductId}):i.isMultiTravel&&(m=(0,c.Z)((0,c.Z)({},m),{},{pkgType:"multitravel",alias:i.activeAlias})),I="".concat(_,"/webapp/vacations/tour/detail?").concat(O.stringify(m)),h=Le(),g=r.Title,v="\u8fd9\u6761\u65c5\u6e38\u7ebf\u8def\u6027\u4ef7\u6bd4\u633a\u9ad8\uff0c\u6709\u8c01\u548c\u6211\u4e00\u8d77\u53bb\u5417\uff1f",x="".concat(_,"/tour/service/getShareImg?productId=").concat(r.ProductId,"&price=").concat(u.MinPrice),p&&(I="".concat(_,"/webapp/vacations/tour/cruise?").concat(O.stringify(m)),x=Le()),S=JSON.stringify({url:encodeURIComponent(I+"&ctm_ref=vdc_ctm_grp_wechat_friend")}),T="cwx/component/cwebview/cwebview?data="+S,P=f&&d&&!d.IsFixSegment,y=!P&&!p,y&&(T="/pages/vacations/detail/index?".concat(O.stringify(m))),w="gh_36ada103ba97",C=0,l&&l.miniprogramtype&&(C=l.miniprogramtype),N=[{shareType:"WeixinFriend",imageUrl:x,title:g,text:v,linkUrl:I+"&ctm_ref=vdc_ctm_grp_wechat_friend",miniProgramPath:T,miniProgramID:w,miniprogramType:C},{shareType:"WeixinCircle",imageUrl:h,title:g,text:v,linkUrl:I+"&ctm_ref=vdc_ctm_grp_wechat_moment"},{shareType:"QQ",imageUrl:h,title:g,text:v,linkUrl:I+"&ctm_ref=vdc_ctm_grp_qq_friend"},{shareType:"QQZone",imageUrl:h,title:g,text:v,linkUrl:I+"&ctm_ref=vdc_ctm_grp_qq_qzone"},{shareType:"SinaWeibo",imageUrl:h,title:g,text:v,linkUrl:I+"&ctm_ref=vdc_ctm_grp_weibo"},{shareType:"SMS",imageUrl:h,title:g,text:v,linkUrl:I+"&ctm_ref=vdc_ctm_grp_text"},{shareType:"Email",imageUrl:h,title:g,text:v,linkUrl:I+"&ctm_ref=vdc_ctm_grp_email"},{shareType:"Copy",imageUrl:h,title:g,text:v,linkUrl:I+"&ctm_ref=vdc_ctm_grp_copy"},{shareType:"Default",imageUrl:h,title:g,text:v,linkUrl:I+"&ctm_ref=vdc_ctm_grp_ctrip_friend"}],e.Share.customShare({dataList:N});case 21:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}(),handleToggleTrackOrderPop:function(e){var t=l.UPDATE_POP_STATUS;t({isShowTrackOrderPop:e})},handleSubmitTrackOrder:function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n,r){var i,a;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n&&n.length){t.next=3;break}return e.showToast("\u8bf7\u9009\u62e9\u51fa\u884c\u65e5\u671f"),t.abrupt("return");case 3:if(r&&11===r.length){t.next=6;break}return e.showToast("\u8bf7\u8f93\u5165\u6b63\u786e\u6709\u6548\u7684\u624b\u673a\u53f7\u7801"),t.abrupt("return");case 6:return i=n.map((function(e){return w.Z.transformServerDate(e)})),t.next=9,Se(i,r);case 9:a=t.sent,a&&we.handleToggleTrackOrderPop(!1);case 11:case"end":return t.stop()}}),t)})));function n(e,n){return t.apply(this,arguments)}return n}(),handleSendTraceLog:function(t,n){var r=a.getState(),i=r.pageId,o=r.pageStatus;e.traceKeyLog({event_value:t,event_bu:o.prodType,page_id:i,data:n})},handleTraceLog:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.tracelog(t,n)},handleShowSelfFundMask:function(e,t){var n=l.TOGGLE_SELFFUND_MASK;n({isShowSelfFundMask:!0,SelfFundedMaskInfo:{ScenicName:e,SelfFundedActivities:t}})},handleHideSelfFundMask:function(){var e=l.TOGGLE_SELFFUND_MASK;e({isShowSelfFundMask:!1})},handleSetCruiseBookingInfo:function(e){var t=a.getState(),n=t.CruiseDepartDate,r=t.BasicInfo,i=e.curDate,o=l.SET_CRUISE_BOOKING_INFO;o(e),Q(),n!==i&&(ee(i),X()),x({attrs:[{key:"productId",value:String(null===r||void 0===r?void 0:r.ProductId)}],scene:"\u51fa\u53d1\u65e5\u671f",role:P.GD.usr,action:P.Us.change,value:i,before:n})},handleSelectCruiseRoom:function(e,t){var n=l.UPDATE_SELECT_CRUISE_ROOM,r=l.TOGGLE_PASSENGR_TIP;n({RoomInfo:e,CountInfo:t});var i=e.MaxSelectCount,a=t.SelectedCount,o=t.AdultCount;i<5&&a>i&&S("\u4ec5\u5269".concat(i,"\u95f4\uff0c\u65e0\u6cd5\u5bb9\u7eb3\u66f4\u591a\u5ba2\u4eba"),"vac_25001","\u9009\u62e9\u8231\u623f\uff0c\u6821\u9a8c\u8231\u623f\u6570\u91cf"),a>o&&S("\u6bcf\u95f4\u8231\u623f\u5fc5\u987b\u5165\u4f4f1\u4f4d\u6210\u4eba","vac_35001","\u9009\u62e9\u8231\u623f\uff0c\u6821\u9a8c\u8231\u623f\u4eba\u6570"),te(),r(!1)},handleSetCanBookingErrorInfo:function(e){var t=e.ShoppingId,n=e.TokenList,r=a.getState(),i=r.BasicInfo,o=r.ShoppingId,s=l.UPDATE_ERROR_CRUISE_TOKEN,c=i.isCruise;c&&o===t&&n&&s({TokenList:n})},handleToggleDiscountDetailMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowDiscountDetailMask:e}),Tt({scene:"\u8d77\u4ef7\u4f18\u60e0\u660e\u7ec6\u5f39\u5c42",value:e?"\u663e\u793a":"\u9690\u85cf"})},handleSelectNewProcessDate:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=a.getState(),o=i.issyncLiistInfo,s=i.pageStatus,c=i.groupCard,u=l.SET_NEWPROCESS_SELECT_DATE;u(t),Tt({scene:"\u9009\u62e9\u65e5\u671f",value:"".concat(r?"\u63a8\u8350\u65e5\u671f--":"").concat(t," / ").concat(n)}),e.set("NewProcessSelectedDate",t,86400),o&&Ne(t);var d,f=s.activeProductId;if(c&&c.cards&&c.cards.length){var p=c.cards.find((function(e){return e.productId===f}));p&&p.preSaleProductInfo&&p.preSaleProductInfo.canBook&&(d=p.preSaleProductInfo.productId)}d&&e.remove("SelectPreSaleDate"),"RN"===e.Platform&&(oe(),ce())},handleSetNewProcessCacheDate:function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,u,d,f,p,I,h,g,v,x,S,T,P,y,w,C,N,D,j,_,b=arguments;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=b.length>0&&void 0!==b[0]&&b[0],r=l.SET_NEWPROCESS_SELECT_DATE,i=a.getState(),s=i.query,c=i.priceCalendarData,u=i.pageStatus,d=i.currentRouteInfo,f=i.newProcessSelectDate,p=i.groupCard,I=i.BasicInfo,t.next=5,e.get("NewProcessSelectedDate");case 5:return h=t.sent,t.next=8,e.get("SelectPreSaleDate");case 8:if(g=t.sent,console.log("\ud83d\udd25\ud83d\udd25\ud83d\udd25\ud83d\udd25\ud83d\udd25\ud83d\udd25",h,g),!n){t.next=16;break}if(m){t.next=15;break}return t.abrupt("return");case 15:m=!1;case 16:if(!s||!s.presaleid){t.next=19;break}if(n&&m){t.next=19;break}return t.abrupt("return");case 19:if(v=u.activeProductId,p&&p.cards&&p.cards.length&&(S=p.cards.find((function(e){return e.productId===v})),S&&S.preSaleProductInfo&&S.preSaleProductInfo.canBook&&(x=S.preSaleProductInfo.productId)),!x){t.next=25;break}if(!g){t.next=25;break}return we.handleSelectPreSaleDate(),t.abrupt("return");case 25:if(c){t.next=27;break}return t.abrupt("return");case 27:if(!h||h!==f){t.next=29;break}return t.abrupt("return");case 29:if(!h){t.next=38;break}if(T=u.activeProductId,P=u.isMultiTravel,y=u.activeAlias,w=c.dailyMinPrice,C=d.dailyMinPrices,N=d.SegmentInfo,!u.isExtendedStay){t.next=37;break}if(D=null===N||void 0===N?void 0:N.Segments[0],D.DepartureCityID!==D.DestinationCityID||!D.IsIncludeHotel){t.next=37;break}return t.abrupt("return");case 37:P?C&&C.length&&(j=C.filter((function(e){return null===e||void 0===e?void 0:e.productPrices.some((function(e){return e.alias===y}))})),j.some((function(e){return e.date===h}))&&(r(h),"RN"===e.Platform&&(oe(),ce()),e.sendKMLog({attrs:[{key:"productId",value:I.ProductId}],scene:"\u9009\u4e2d\u7f13\u5b58\u65e5\u671f",action:"sys_change",value:h}))):w[h]&&(_=w[h].productPrices,_&&_.find((function(e){return e.productId===T}))&&(r(h),"RN"===e.Platform&&(oe(),ce()),e.sendKMLog({attrs:[{key:"productId",value:I.ProductId}],scene:"\u9009\u4e2d\u7f13\u5b58\u65e5\u671f",action:"sys_change",value:h})));case 38:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}(),handleCheckPreSaleDateCache:function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,l,u;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=a.getState(),n.query,r=n.pageStatus,i=n.groupCard,t.next=3,e.get("SelectPreSaleDate");case 3:if(s=t.sent,c=r.activeProductId,i&&i.cards&&i.cards.length&&(u=i.cards.find((function(e){return e.productId===c})),u&&u.preSaleProductInfo&&u.preSaleProductInfo.canBook&&(l=u.preSaleProductInfo.productId)),!l){t.next=10;break}if(!s){t.next=10;break}return we.handleSelectPreSaleDate(),t.abrupt("return");case 10:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}(),handleToggleBookingLimitMask:function(e){var t=l.UPDATE_POP_STATUS;t({isShowBookingLimitMask:e})},handleSelectPreSaleDate:function(){var t,n,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=a.getState(),o=i.BasicInfo,s=i.groupCard,c=i.pageStatus,u=l.SET_SELECT_PRESALE_DATE;if(u(),s&&s.cards&&s.cards.length){var d=s.cards.find((function(e){return e.productId===c.activeProductId}));d&&d.preSaleProductInfo&&d.preSaleProductInfo.canBook&&(t=d.preSaleProductInfo.productId,n=["A","B","C","D","E","F","G","H","I","J"][d.sortNumber-1])}e.sendKMLog({attrs:[{key:"productId",value:o.ProductId}],scene:"\u9009\u4e2d\u9884\u552e\u65e5\u671f",action:r?"usr_click":"sys_change",value:"\u9884\u552e\u4ea7\u54c1".concat(n,"\u7ebf\uff1a").concat(t)}),e.set("SelectPreSaleDate","1",86400)},handleSwitchD2DTab:function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,s,c,u,d,f,p;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=a.getState(),i=r.BasicInfo,s=r.pageStatus,c=r.copiedNewProductState,r.ParentsProductList,r.ChildrenProductList,u=l.SWITCH_BACKTO_NEW_PRODUCT,d=l.SWITCH_BACKTO_ORIGINAL_PRODUCT,n!==s.curD2DSwitchType){t.next=4;break}return t.abrupt("return");case 4:if(f=l.UPDATE_D2DSWITCH_STATUS,p=l.SET_D2DSWITCH_LOADING,f(n),p(!0),n===s.initD2DSwitchType){t.next=18;break}if(!c){t.next=12;break}u(),t.next=16;break;case 12:return e.showMaskLoading(),t.next=15,ge();case 15:e.hideMaskLoading();case 16:t.next=19;break;case 18:d();case 19:p(!1),e.sendKMLog({attrs:[{key:"productId",value:i.ProductId}],scene:"\u70b9\u51fb\u5207\u6362\u51fa\u53d1\u5730\u76ee\u7684\u5730TAB",action:"usr_click",value:1===n?"\u5207\u6362\u81f3\u76ee\u7684\u5730\u53c2\u56e2":"\u5207\u6362\u81f3\u51fa\u53d1\u5730\u53c2\u56e2"});case 21:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}(),handleGoBooking:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];we.handleHideFavoriteMenu();var r=a.getState(),i=r.BookInfo,o=r.ScheduleInfo,s=r.pageStatus,c=r.countDownStatus,u=r.BasicInfo;if(o&&i&&i.IsBook&&o.HasInventory&&(!s.isSetCountDown||!c||"start"===c.Status)){var d=l.SET_CALENDAR_SELECTED_DATE;d(t),e.Storage.save({key:"TOUR_DETAIL_JUMP_CALENDAR",value:"1",domain:"tour",expires:600}),we.handleToggleCalendarPop(!0),t?e.sendKMLog({attrs:[{key:"productId",value:u.ProductId}],scene:"\u51fa\u53d1\u65e5\u671f",action:"usr_click",value:t}):e.sendKMLog({attrs:[{key:"productId",value:u.ProductId}],action:"usr_click",value:n?"\u66f4\u591a\u73ed\u671f":"\u7acb\u5373\u9884\u8ba2"})}},handleGoCalendarPage:function(t){var n=t.ShoppingId,r=t.alias,i=t.line,l=a.getState(),u=l.BasicInfo,d=l.BookInfo,f=l.pageStatus,p=l.query,m=l.LocationInfo,I=l.CalendarSelectedDate,h=l.ShoppingSelectedResources,g=l.isLogin,v=l.pageSetting,x=l.wakenUpData,S=l.liveCast,T=l.pageId,P=l.SegmentInfo,y={pdid:u.ProductId,dcid:u.DepartureId,scid:u.SaleCityId,shoppingid:n,startDate:new w.Z(w.Z.transformTimeStamp(d.Start)).format(),endDate:new w.Z(w.Z.transformTimeStamp(d.End)).format(),date:I,line:i,istour:!u.isPureDiyfhxsdp,iscruise:u.isCruise,detailpagename:e.RegisterPageName,isnewshopping:1,newprocess:u.isCruise?0:1};f.isMultiTravel&&(y=(0,c.Z)((0,c.Z)({},y),{},{alias:r}));var C=!u.isDiyfhxsdp&&!u.isCruise;C&&(y=(0,c.Z)((0,c.Z)({},y),{},{showCompetition:C})),u.isCruise||(y=(0,c.Z)((0,c.Z)({},y),{},{stype:P.IsFixSegment?1:0}));var N=p.crhdepartname,D=p.crhdeparttype,j=p.crhdestname,_=p.crhdesttype;N&&(y=m&&m.LocationCityId&&m.LocationCityId===u.DepartureId?(0,c.Z)((0,c.Z)({},y),{},{crhdepartname:N,crhdeparttype:D,crhdestname:j,crhdesttype:_}):(0,c.Z)((0,c.Z)({},y),{},{crhdepartname:u.DepartureCityName,crhdeparttype:2,crhdestname:j,crhdesttype:_})),p.activitycode&&(y=(0,c.Z)((0,c.Z)({},y),{},{activitycode:p.activitycode})),p.qstagecount&&(y=(0,c.Z)((0,c.Z)({},y),{},{qstagecount:p.qstagecount})),"1"===p.fromhhtravel&&(y=(0,c.Z)((0,c.Z)({},y),{},{fromhhtravel:1})),u.isCruise&&h&&h.length&&(y=(0,c.Z)((0,c.Z)({},y),{},{isnewshopping:1})),S&&S.liveId&&(y=(0,c.Z)((0,c.Z)({},y),{},{liveid:S.liveId,pageid:T})),xt();var b="/rn_tour/main.js?CRNModuleName=CTTourApp&CRNType=1&initialPage=price_calendar_new&"+O.stringify(y),k=function(){e.openURL(b)};if(v&&v.prefetch&&v.prefetch.resource){var L=v.prefetch.resource,B=L.newmodule,R=L.enabled,M=L.expiredtime;if(B){var E=x.allianceid,V=x.sid;R&&n?k=function(){e.ResourceEntry.open(y,{line:f.activeProductId,departCityId:u.DepartureId,alias:r,shoppingid:n,allianceid:E,sid:V,clientid:e.Application.clientID,usecouponstate:0,expiredtime:M,showCompetition:C,sourceFrom:"1"===p.fromhhtravel?"hhtravel":""})}:(b="/rn_tour/main.js?CRNModuleName=CTTourApp&CRNType=1&initialPage=resource&"+O.stringify(y),k=function(){e.openURL(b)})}}console.log("==resource url==",b),g?(k(),setTimeout((function(){we.handleToggleCalendarPop(!1)}),500)):"Taro"===(null===e||void 0===e?void 0:e.Platform)?e.login({callback:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Te();case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}):_e({beforeCallback:function(){k(),setTimeout((function(){we.handleToggleCalendarPop(!1)}),500)}})},handleGoResource_NewProcess:function(t){var n=t.ShoppingId,r=a.getState(),i=r.BasicInfo,u=r.BookInfo,d=r.pageStatus,f=r.query,p=r.LocationInfo,I=r.newProcessSelectDate,h=r.ShoppingSelectedResources,g=r.isLogin,v=r.pageSetting,x=r.wakenUpData,S=(r.TourGroupInfo,r.liveCast),T=r.pageId,P=r.SegmentInfo,y=r.isSecKill,C=l.UPDATE_STATE,N={pdid:i.ProductId,dcid:i.DepartureId,scid:i.SaleCityId,shoppingid:n,startDate:new w.Z(w.Z.transformTimeStamp(u.Start)).format(),endDate:new w.Z(w.Z.transformTimeStamp(u.End)).format(),date:I,line:d.activeProductId,istour:!i.isPureDiyfhxsdp,iscruise:i.isCruise,detailpagename:e.RegisterPageName,isnewshopping:1,newprocess:1},D=void 0;d.isMultiTravel&&(D=d.activeAlias,N=(0,c.Z)((0,c.Z)({},N),{},{alias:D}));var j=!i.isDiyfhxsdp&&!i.isCruise;j&&(N=(0,c.Z)((0,c.Z)({},N),{},{showCompetition:j})),i.isCruise||(N=(0,c.Z)((0,c.Z)({},N),{},{stype:P.IsFixSegment?1:0})),y&&(N=(0,c.Z)((0,c.Z)({},N),{},{isSecKill:1}));var _=f.crhdepartname,k=f.crhdeparttype,L=f.crhdestname,B=f.crhdesttype;_&&(N=p&&p.LocationCityId&&p.LocationCityId===i.DepartureId?(0,c.Z)((0,c.Z)({},N),{},{crhdepartname:_,crhdeparttype:k,crhdestname:L,crhdesttype:B}):(0,c.Z)((0,c.Z)({},N),{},{crhdepartname:i.DepartureCityName,crhdeparttype:2,crhdestname:L,crhdesttype:B})),f.activitycode&&(N=(0,c.Z)((0,c.Z)({},N),{},{activitycode:f.activitycode})),f.qstagecount&&(N=(0,c.Z)((0,c.Z)({},N),{},{qstagecount:f.qstagecount})),"1"===f.fromhhtravel&&(N=(0,c.Z)((0,c.Z)({},N),{},{fromhhtravel:1})),i.isCruise&&h&&h.length&&(N=(0,c.Z)((0,c.Z)({},N),{},{isnewshopping:1})),S&&S.liveId&&(N=(0,c.Z)((0,c.Z)({},N),{},{liveid:S.liveId,pageid:T})),xt();var R,M="/rn_tour/main.js?CRNModuleName=CTTourApp&CRNType=1&initialPage=price_calendar_new&"+O.stringify(N),E=function(){e.openURL(M)};if("RN"===e.Platform&&v&&v.prefetch&&v.prefetch.resource){var V=v.prefetch.resource,A=V.newmodule,Z=V.enabled,U=V.expiredtime;if(A){var F=x.allianceid,G=x.sid;Z&&n?E=function(){e.ResourceEntry.open(N,{line:d.activeProductId,departCityId:i.DepartureId,alias:D,shoppingid:n,allianceid:F,sid:G,clientid:e.Application.clientID,usecouponstate:0,expiredtime:U,showCompetition:j,sourceFrom:"1"===f.fromhhtravel?"hhtravel":""})}:(M="/rn_tour/main.js?CRNModuleName=CTTourApp&CRNType=1&initialPage=resource&"+O.stringify(N),E=function(){e.openURL(M)})}}if(console.log("==resource url==",M),"H5"===e.Platform){var H;if(M="/webapp/vacations/tour/resourcenew",N=(0,c.Z)((0,c.Z)({},N),{},{from:null===(H=location)||void 0===H?void 0:H.href}),e.isInWebviewH5()&&!e.isInZTApp())return void e.jumpH5InWebview({url:M,params:N});E=function(){b({url:M,params:N})}}"Taro"===e.Platform&&(M="/pages/vacations/resource/index",N=(0,c.Z)((0,c.Z)({},N),{},{from:null===(R=location)||void 0===R?void 0:R.href}),E=function(){e.navigateTo({url:M,params:N})});if(g)C({backFromResourcePage:!0}),m=!0,E();else if("Taro"===(null===e||void 0===e?void 0:e.Platform))e.login({callback:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Te();case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()});else if("H5"!==(null===e||void 0===e?void 0:e.Platform)||e.isH5InCtripApp())_e({beforeCallback:function(){C({backFromResourcePage:!0}),m=!0,E()}});else{var K="/webapp/vacations/tour/resourcenew?"+O.stringify(N);e.handleH5Login({fromUrl:K})}},handleGoResource_V3:function(t){var n=t.ShoppingId,r=a.getState(),i=r.BasicInfo,u=r.BookInfo,d=r.pageStatus,f=r.query,p=r.LocationInfo,I=r.newProcessSelectDate,h=r.ShoppingSelectedResources,g=r.isLogin,v=(r.pageSetting,r.wakenUpData,r.TourGroupInfo,r.liveCast),x=r.pageId,S=r.SegmentInfo,T=r.isSecKill,P=l.UPDATE_STATE,y={pdid:i.ProductId,dcid:i.DepartureId,scid:i.SaleCityId,shoppingid:n,startDate:new w.Z(w.Z.transformTimeStamp(u.Start)).format(),endDate:new w.Z(w.Z.transformTimeStamp(u.End)).format(),date:I,line:d.activeProductId,istour:!i.isPureDiyfhxsdp,iscruise:i.isCruise,detailpagename:e.RegisterPageName},C=void 0;d.isMultiTravel&&(C=d.activeAlias,y=(0,c.Z)((0,c.Z)({},y),{},{alias:C})),i.isCruise||(y=(0,c.Z)((0,c.Z)({},y),{},{stype:S.IsFixSegment?1:0})),T&&(y=(0,c.Z)((0,c.Z)({},y),{},{isSecKill:1}));var N=f.crhdepartname,D=f.crhdeparttype,j=f.crhdestname,_=f.crhdesttype;N&&(y=p&&p.LocationCityId&&p.LocationCityId===i.DepartureId?(0,c.Z)((0,c.Z)({},y),{},{crhdepartname:N,crhdeparttype:D,crhdestname:j,crhdesttype:_}):(0,c.Z)((0,c.Z)({},y),{},{crhdepartname:i.DepartureCityName,crhdeparttype:2,crhdestname:j,crhdesttype:_})),f.activitycode&&(y=(0,c.Z)((0,c.Z)({},y),{},{activitycode:f.activitycode})),f.qstagecount&&(y=(0,c.Z)((0,c.Z)({},y),{},{qstagecount:f.qstagecount})),"1"===f.fromhhtravel&&(y=(0,c.Z)((0,c.Z)({},y),{},{fromhhtravel:1})),i.isCruise&&h&&h.length&&(y=(0,c.Z)((0,c.Z)({},y),{},{isnewshopping:1})),v&&v.liveId&&(y=(0,c.Z)((0,c.Z)({},y),{},{liveid:v.liveId,pageid:x})),xt();var b="/rn_tour/main.js?CRNModuleName=CTTourApp&CRNType=1&initialPage=resource_v3&"+O.stringify(y),k=function(){e.openURL(b)};if(console.log("==resource url==",b),g)P({backFromResourcePage:!0}),m=!0,k();else if("Taro"===(null===e||void 0===e?void 0:e.Platform))e.login({callback:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Te();case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()});else if("H5"!==(null===e||void 0===e?void 0:e.Platform)||e.isH5InCtripApp())_e({beforeCallback:function(){P({backFromResourcePage:!0}),m=!0,k()}});else{var L="/webapp/vacations/tour/resourcenew?"+O.stringify(y);e.handleH5Login({fromUrl:L})}},handleGoOrderPage:function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,u,d,f,p,I,h,g,v,x,S;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=n.ShoppingId,i=a.getState(),u=i.BasicInfo,d=i.pageStatus,f=i.query,p=i.isLogin,i.pageSetting,I=i.isSecKill,h=l.UPDATE_STATE,g=d.activeProductId,v=u.DepartureId;try{x={productId:g,departCityId:v,shoppingId:r,detailpagename:e.RegisterPageName,timestamp:(new Date).valueOf(),flightTip:0,productType:d.prodType,hasAirport:0,isnewshopping:1},u.isCruise||(x.isQuickBooking=1),d.isMultiTravel&&(x=(0,c.Z)((0,c.Z)({},x),{},{alias:d.activeAlias})),"1"===f.fromhhtravel&&(x=(0,c.Z)((0,c.Z)({},x),{},{fromhhtravel:1})),I&&(x=(0,c.Z)((0,c.Z)({},x),{},{isSecKill:1})),f.activitycode&&(x=(0,c.Z)((0,c.Z)({},x),{},{activitycode:f.activitycode})),f.qstagecount&&(x=(0,c.Z)((0,c.Z)({},x),{},{qstagecount:f.qstagecount})),S="/rn_tour_order/main.js?CRNModuleName=CTTourApp&CRNType=1&inavbarhidden=1&ishidenavbar=yes&initialPage=tour_orderv3&timestamp="+(new Date).getTime(),2===(null===u||void 0===u?void 0:u.PreSaleStatus)&&(S="/rn_tour_order/main.js?CRNModuleName=CTTourApp&CRNType=1&initialPage=order_presale&timestamp="+(new Date).getTime()),"H5"===e.Platform&&(S="/booking"),"Taro"===e.Platform&&(S="/pages/tourbooking/order/index"),m=!0,p?(h({backFromOrderPage:!0}),e.goTo({url:S,params:x}),setTimeout((function(){we.handleToggleCalendarPop(!1)}),500)):"Taro"===(null===e||void 0===e?void 0:e.Platform)?e.login({callback:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Te();case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}):_e({beforeCallback:function(){h({backFromOrderPage:!0}),e.goTo({url:S,params:x}),setTimeout((function(){we.handleToggleCalendarPop(!1)}),500)}})}catch(t){e.logPageError("handleBooking",t)}case 6:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}(),handleGoOrderPage_PreSale:function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,c,l,u,d,f,p,I,h,g;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=n.ShoppingId,i=n.PreSaleProductId,c=a.getState(),l=c.BasicInfo,u=c.pageStatus,c.query,d=c.isLogin,c.pageSetting,f=l.DepartureId;try{p="/rn_tour_order/main.js?CRNModuleName=CTTourApp&CRNType=1&inavbarhidden=1&ishidenavbar=yes&initialPage=order_presale","H5"===e.Platform&&(p="/presale"),"Taro"===e.Platform&&(p="/webapp/vacations/tour/presale"),I={productId:i,departCityId:f,shoppingId:r,detailpagename:e.RegisterPageName,productType:u.prodType},m=!0,d?"Taro"===(null===e||void 0===e?void 0:e.Platform)?e.jumpH5({url:p,params:I}):e.goTo({url:p,params:I}):"Taro"===(null===e||void 0===e?void 0:e.Platform)?e.login({callback:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Te();case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}):"H5"!==(null===e||void 0===e?void 0:e.Platform)||e.isH5InCtripApp()?_e({beforeCallback:function(){e.goTo({url:p,params:I})}}):(I.from=null===(h=location)||void 0===h?void 0:h.href,g="/webapp/vacations/tour/presale?"+O.stringify(I),e.handleH5Login({fromUrl:g}))}catch(t){e.logPageError("handleGoOrderPage_PreSale",t)}case 4:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}(),handleOrderBackError:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t&&t.TokenInfoList,null!==n&&void 0!==n&&n.length&&setTimeout((function(){we.handleToggleCalendarPop(!0)}),500);case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),handleNextPage:function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,c,u,d,f,p,m,I,h,v,x,S,T,y,w,C,N,D,j,_,b,k,L;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.pageStatus,i=n.BasicInfo,c=n.newProcessSelectDate,u=n.isLogin,n.isSecKill,d=l.UPDATE_REFRESH_SELECTDATE_FLAG,f=l.SET_NEWPROCESS_SELECT_DATE,p=l.SET_SCHEDULE_DISABLE_DATE,m=l.UPDATE_SECKILL_LIMIT_STATUS,I=i.DepartureId,u){t.next=7;break}if("Taro"!==(null===e||void 0===e?void 0:e.Platform)){t.next=7;break}return e.login({callback:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Te();case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}),t.abrupt("return");case 7:return t.next=9,(0,P.KI)({pageName:"detail",productId:r.activeProductId,alias:r.isMultiTravel?r.activeAlias:"",departCityId:I});case 9:if(h=t.sent,v=h.result,x=h.payload,x=x||{},!v){t.next=34;break}if(S=x,T=S.recommendSearch,S.cabinInfo,S.shoppingDetail,y=S.extraResource,w=T.ShoppingId,C=y.settings.isQuickBookingV2,"RN"===e.Platform&&e.tracelog("grp_caldarflo_ordimde_click",{is_jump_respage:C?"T":"F"}),!C){t.next=22;break}we.handleGoOrderPage({ShoppingId:w}),t.next=32;break;case 22:if(g.cacheFirstScreenData(x),N=1===i.ProductPatternId,!N){t.next=31;break}return t.next=27,ze("230609_VAC_res3");case 27:D=t.sent,["B","C"].includes(D)?we.handleGoResource_V3({ShoppingId:w}):we.handleGoResource_NewProcess({ShoppingId:w}),t.next=32;break;case 31:we.handleGoResource_NewProcess({ShoppingId:w});case 32:t.next=36;break;case 34:j=x,_=j.toastMessage,b=j.errorCode,_?"Taro"===e.Platform?(k={content:_,confirmText:"\u77e5\u9053\u4e86",showCancel:!1,success:function(e){we.handleToggleCalendarPop(!0)}},f(""),d(),p(c),e.showDialog(k)):"429"===b?m(!0):(L={params:{message:_,textPositive:"\u77e5\u9053\u4e86"},positiveCallback:function(){we.handleToggleCalendarPop(!0)},style:{zIndex:999}},f(""),d(),p(c),e.showDialog(L)):we.handleGoResource_NewProcess({ShoppingId:""});case 36:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}(),handleNextPage_Cruise:function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,s,c,u,d,f,p,m,I,h,v,x,T,y,w,C,N,D,j,_,b,k,L,B,R,M,E,V;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=a.getState(),i=r.isLogin,s=r.BasicInfo,c=r.CruiseDepartDate,u=r.SelectedCruiseRoomInfo,d=r.CruiseRoomInfo,f=r.CruisePriceInfo,p=l.UPDATE_ERROR_CRUISE_TOKEN,m=l.UPDATE_CRUISE_BOOKING_STATUS,I=l.TOGGLE_PASSENGR_TIP,!d||!d.selectedTags){t.next=6;break}if(!Object.values(d.selectedTags).some((function(e){return e.length>0}))){t.next=6;break}return t.next=6,we.handleResetRoomTag();case 6:if(h=u&&u.filter((function(e){return e.SelectedCount})).reduce((function(e,t){return e+t.SelectedCount}),0),v="\u70b9\u51fb\u4e0b\u4e00\u6b65",!(h>5)){t.next=12;break}return e.showToast("\u5df2\u9009\u8231\u623f\u8d85\u8fc75\u95f4\u65e0\u6cd5\u9884\u8ba2\uff0c\u53ef\u5206\u62c6\u6210\u591a\u4e2a\u8ba2\u5355"),S("\u5df2\u9009\u8231\u623f\u8d85\u8fc75\u95f4\u65e0\u6cd5\u9884\u8ba2\uff0c\u53ef\u5206\u62c6\u6210\u591a\u4e2a\u8ba2\u5355","vac_35002",v),t.abrupt("return");case 12:if(x=[],u.forEach((function(e){var t=e.SelectedCount,n=e.AdultCount,r=e.ChildCount,i=e.MinNum,a=e.Token;i*t>n+r?(x.push(a),S("\u6bcf\u95f4\u8231\u623f\u5fc5\u987b\u5165\u4f4f1\u4f4d\u6210\u4eba\uff0c\u4eba\u6570\u4e0d\u6ee1\u8db3\u6700\u5c0f\u53ef\u4f4f\u4eba\u6570","vac_35003",v)):t>n&&(x.push(a),S("\u6bcf\u95f4\u8231\u623f\u5fc5\u987b\u5165\u4f4f1\u4f4d\u6210\u4eba","vac_35004",v))})),!x.length){t.next=18;break}return p({TokenList:x}),setTimeout((function(){var t;"RN"===e.Platform?e.scrollToElement("CabinRoomError"):n&&n(null===(t=e.ctrl)||void 0===t?void 0:t.elementPosition["CabinRoomError"])}),100),t.abrupt("return");case 18:if(i){t.next=22;break}return"H5"===(null===e||void 0===e?void 0:e.Platform)&&(T=null===e||void 0===e?void 0:e.Stores.SelectedCruiseRoomInfoStore.getInstance(),y=[],u.map((function(e){e.SelectedCount>0&&(e.AdultCount>0||e.ChildCount>0)&&y.push(e)})),w={SelectedCruiseRoomInfo:y,CruisePriceInfo:f},T.set(w)),_e({beforeCallback:function(){we.handleNextPage_Cruise()}}),t.abrupt("return");case 22:return m("loading"),C=0,N=0,D=u.filter((function(e){return e.SelectedCount>0})).map((function(e){var t=e.Token,n=e.SelectedCount,r=e.AdultCount,i=e.ChildCount,a=void 0===i?0:i;return C+=r,N+=a,{Token:t,Count:n,ExtendInfos:[{ExtendMaps:[{Key:"AdultNum",Value:r},{Key:"ChildNum",Value:a}]}]}})),t.next=28,(0,P.KI)({pageName:"cruise_detail",productId:s.ProductId,departCityId:s.DepartureId,departureDate:c,alias:"",adultCount:C,childCount:N,selectedResources:D});case 28:j=t.sent,!0===j.result?(_=j.payload,b=_.recommendSearch,k=_.extraResource,L=b.ShoppingId,B=k.settings.isQuickBookingV2,B?we.handleGoOrderPage({ShoppingId:L}):(g.cacheFirstScreenData(_),we.handleGoResource_NewProcess({ShoppingId:L})),m("canbooking"),I(!1)):j.payload&&j.payload.ResourceStatuses?(R=j.payload.ResourceStatuses,e.showToast("\u5df2\u9009\u8231\u623f\u5e93\u5b58\u4e0d\u8db3\uff0c\u8bf7\u8c03\u6574\u540e\u91cd\u8bd5"),M=R.map((function(e){return e.Token})),p({TokenList:M}),m("canbooking"),"RN"===e.Platform?e.scrollToElement("Cabin"):n&&n(null===(E=e.ctrl)||void 0===E?void 0:E.elementPosition["Cabin"])):(e.showToast("\u5df2\u9009\u8231\u623f\u5e93\u5b58\u4e0d\u8db3\uff0c\u8bf7\u8c03\u6574\u540e\u91cd\u8bd5"),m("canbooking"),"RN"===e.Platform?e.scrollToElement("Cabin"):n&&n(null===(V=e.ctrl)||void 0===V?void 0:V.elementPosition["Cabin"]));case 30:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}(),handleNextPage_Presale:function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,l,u,d,f,p,m,I,h,g,v,x,S,T,y,w,C;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.pageStatus,i=n.BasicInfo,s=n.isSelectPreSale,c=n.groupCard,l=n.isPreSale,u=i.DepartureId,d=r.activeProductId,f=r.isMultiLine,s&&l){t.next=5;break}return t.abrupt("return");case 5:return c&&c.cards&&c.cards.length&&(h=c.cards.find((function(e){return e.productId===d})),h&&h.preSaleProductInfo&&h.preSaleProductInfo.canBook&&(p=h.preSaleProductInfo.productId,m=["A","B","C","D","E","F","G","H","I","J"][h.sortNumber-1],I=h.preSaleProductInfo.inventory)),t.next=8,(0,P.KI)({pageName:"presale_detail",productId:p,alias:f?m:"",departCityId:u,mainProductId:d,inventory:I});case 8:g=t.sent,g.result,v=g.payload,v=v||{},v&&v.shoppingId?(x=v,S=x.shoppingId,we.handleGoOrderPage_PreSale({ShoppingId:S,PreSaleProductId:p})):(T=v,y=T.toastMessage,"Taro"===e.Platform?(w={content:y||"\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",confirmText:"\u77e5\u9053\u4e86",showCancel:!1},e.showDialog(w)):(C={params:{message:y||"\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",textPositive:"\u77e5\u9053\u4e86"},style:{zIndex:999}},e.showDialog(C)));case 13:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}(),handleGoSecurityInfo:function(){var e=a.getState(),t=e.BasicInfo,n=t.isDiyfhxsdp,r=t.isCruise,i=n?"diytour":r?"cruise":"grouptravel",o="https://m.ctrip.com/webapp/sp/serviceensure?bu=travel&sub=".concat(i);b({url:o}),Tt({scene:"\u516d\u91cd\u4fdd\u969c\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoCustomize:function(){var t=a.getState(),n=t.BasicInfo,r="/webapp/dingzhi/demandAssign",i={productid:n.ProductId,departure:n.DepartureCityName,departureid:n.DepartureId,destination:n.DestCityName,destinationid:n.DestCityId,productOrigin:n.isDiyfhxsdp?2:1,isHideNavBar:"YES"};"H5"===(null===e||void 0===e?void 0:e.Platform)&&(i=(0,c.Z)((0,c.Z)({},i),{},{from:location.href})),b({url:r,params:i}),Tt({scene:"\u5b9a\u5236\u65c5\u884c",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoTravelNote:function(e){var t=e.ename,n=e.id,r=e.did,i="/webapp/you/travels/".concat(t+r,"/").concat(n,".html?navBarStyle=white");b({url:i})},handleGoRecommendDetail:function(t){if("RN"===e.Platform){var n="/rn_tour/main.js?CRNModuleName=CTTourApp&CRNType=1&initialPage=detail&"+O.stringify(t)+"&navBarStyle=white";e.openURL(n)}else{var r="/webapp/vacations/tour/detail_new",i=t;b({url:r,params:i})}},handleGoStarInfo:function(){var t=a.getState(),n=t.BasicInfo,r="https://m.ctrip.com/tangram/MjExOA==?isHideNavBar=YES&ctm_ref=vactang_page_2118";n.isDiyfhxsdp&&(r="https://m.ctrip.com/tangram/NDUxNg==?isHideNavBar=YES&ctm_ref=vactang_page_4516"),"H5"!==e.Platform&&"Taro"!==e.Platform&&mt(),b({url:r}),Tt({scene:"\u94bb\u7ea7\u8bf4\u660e\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoTagUrl:function(e){e&&(St(),b({url:e}),Tt({scene:"\u8425\u9500\u6807\u7b7e\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"}))},handleGoCreditInfo:function(){var e=a.getState(),t=e.promotionDisplayInfo,n=t.creditInfo.CampaignUrl;b({url:n})},handleGoBonusPage:function(){var t={},n="https://m.ctrip.com/webapp/rewards/pointexplain?isHideNavBar=YES";t="Taro"===e.Platform?{url:n,options:{needLogin:!0}}:{url:n},b(t)},handleGoSuperVipPage:function(){var e="https://contents.ctrip.com/buildingblocksweb/special/membershipcard/rightsDetailList.html?ishidenavbar=yes&groupid=1&rightsid=2499&ishideheader=no&ishidefooter=yes";b({url:e})},handleGoSDPServicePage:function(){var e="https://pages.c-ctrip.com/groupTravelUED/app/201606/service_guarantee/service_guarantee.html";b({url:e})},handleGoSDPShop:function(){var e="/webapp/vacations/tour/supplier",t={isHideNavBar:"YES"};b({url:e,params:t})},handleGoSelfLicenseInfo:function(){var t="/webapp/vacations/tour/supplier";e.jumpH5({url:t})},handleGoLicensePage:function(e){var t="/webapp/vacations/tour/supplier_pic",n={providerId:e,all:1,isHideNavBar:"YES"};b({url:t,params:n})},handleGoComment:function(){var t=a.getState(),n=t.BasicInfo,r=n.isPureDiyfhxsdp,i=r?"vacations-diy":"vacations-grp",o=n.ProductId,s=r?"SINGLE_PRODUCT_QUERY":"PRODUCT_QUERY",c="/rn_vac_comment/_crn_config?CRNModuleName=ctrip-app&CRNType=1&initialPage=CommentList&channel=".concat(i,"&queryid=").concat(o,"&scene=").concat(s);e.openURL(c),Tt({scene:"\u70b9\u8bc4\u5217\u8868\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoShopDetail:function(){we.handleHideFavoriteMenu();var e=a.getState(),t=e.BasicInfo,n=e.VendorInfo,r=e.brandScore;if(n&&r&&(!r||r.shopInfo)&&"G"!==t.SaleMode){var i="/webapp/vacations/shop/home",o={productid:t.ProductId,brandId:n.BrandId,desCityId:t.DestCityId,detailId:t.ProductId,proId:n.VenderId,shopId:r.shopId,saleMode:t.SaleMode,isHideNavBar:"YES"};b({url:i,params:o}),Tt({scene:"\u5e97\u94fa\u8be6\u60c5\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})}},handleGoGuideList:function(){var t=a.getState(),n=t.BasicInfo,r=t.VendorInfo,i=t.currentRouteInfo,o=t.pageStatus,s=i.servicePerson;if(r){var c="/webapp/vacations/shop/guidelist",l=0;s&&s.roleType&&(l=s.roleType);var u={productid:o.activeProductId,departcityid:n.DepartureId,proId:r.VenderId,isgold:n.IsGoodGuideProduct?"1":"0",isself:"S"===n.SaleMode,detailpagename:e.RegisterPageName,roleType:l,isHideNavBar:"YES"};b({url:c,params:u}),Tt({scene:"\u5bfc\u6e38\u5217\u8868\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})}},handleGoGuideDetail:function(e){var t=a.getState(),n=t.VendorInfo;if(n&&e){var r=qe(e),i=r.url,o=r.params;b({url:i,params:o}),Tt({scene:"\u5bfc\u6e38\u8be6\u60c5\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})}},handleGoTopList:function(t){var n=a.getState(),r=n.BasicInfo;t&&(t+="&destinationCityId=".concat(r.DestCityId,"&transDepartureId=").concat(r.DepartureId),"RN"===e.Platform?e.openURL(t):b({url:t}),Tt({scene:"\u699c\u5355\u5217\u8868\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"}))},handleGoStudyStandard:function(){var e=a.getState(),t=e.qConfig,n=t.studyUrl;b({url:n})},handleGoStoreInfo:function(){var e=a.getState(),t=e.NearbyStoreInfo,n=t.nearbyStoreUrl,r={navBarStyle:"white"};b({url:n,params:r}),Tt({scene:"\u9644\u8fd1\u95e8\u5e97\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoCostMore:function(e){var t=a.getState(),n=t.BasicInfo,r=n.SaleCityId,i=n.DepartureId,o="/webapp/vacations/tour/detail_cost_more",s={productId:e,saleCityId:r,departCityId:i,isHideNavBar:"YES"};b({url:o,params:s}),Tt({scene:"\u63a8\u8350\u6d3b\u52a8\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoVisa:function(){var e=a.getState(),t=e.pageStatus,n=e.BasicInfo,r=(e.ABTestResult,"/webapp/vacations/tour/detail_visa_new"),i={productId:n.ProductId,saleCityId:n.SaleCityId,departCityId:n.DepartureId,lineProductId:t.activeProductId||n.ProductId,isHideNavBar:"YES"};t.isMultiTravel&&(i=(0,c.Z)((0,c.Z)({},i),{},{alias:t.activeAlias})),b({url:r,params:i}),Tt({scene:"\u7b7e\u8bc1\u4fe1\u606f\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoBookingNote:function(e){var t=e.Code,n=a.getState(),r=n.pageStatus,i=n.BasicInfo,o=n.LocationInfo,s=i.ProductId,l=i.SaleCityId,u=i.DepartureId,d="/webapp/vacations/tour/detail_booking_note",f={productId:s,saleCityId:l,departCityId:u,lineProductId:r.activeProductId||s,Code:t,isHideNavBar:"YES"};o&&o.locationCityId&&(f=(0,c.Z)((0,c.Z)({},f),{},{locateCityId:o.locationCityId})),b({url:d,params:f}),Tt({scene:"\u9884\u8ba2\u9650\u5236\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoDefaultInfo:function(){var e=a.getState(),t=e.pageStatus,n=e.BasicInfo,r=n.ProductId,i=n.DepartureId,o="/webapp/vacations/tour/defaultinfo",s={productId:r,departCityId:i,lineProductId:t.activeProductId||r,isHideNavBar:"YES"};b({url:o,params:s})},handleGoThemeEquipment:function(){var e=a.getState(),t=e.pageStatus,n=e.BasicInfo,r=n.DepartureId,i="/webapp/vacations/tour/theme_equipment",o={productId:t.activeProductId,departCityId:r,isHideNavBar:"YES"};t.isMultiTravel&&(o=(0,c.Z)((0,c.Z)({},o),{},{alias:t.activeAlias})),b({url:i,params:o}),Tt({scene:"\u88c5\u5907\u4fe1\u606f\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoThemeGuide:function(){var e=a.getState(),t=e.pageStatus,n=e.BasicInfo,r=n.DepartureId,i="/webapp/vacations/tour/theme_guide",o={productId:t.activeProductId,departCityId:r,isHideNavBar:"YES"};t.isMultiTravel&&(o=(0,c.Z)((0,c.Z)({},o),{},{alias:t.activeAlias})),b({url:i,params:o}),Tt({scene:"\u5411\u5bfc\u4fe1\u606f\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoIM:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if("Taro"===(null===e||void 0===e?void 0:e.Platform)){var n=a.getState(),r=n.imEntryInfo,i=n.BasicInfo,c=n.VendorInfo,l=n.pageId,u=n.isLogin,d=r||{},f=d.imInfo,p=f||{},m=p.resolveImCode;if(u){var I={IMCode:m,productId:i.ProductId,departureCityId:i.DepartureId,destinationIdList:JSON.stringify([i.DestCityId]),platformId:1,extendJson:JSON.stringify({Platform:"H5",providerId:c&&c.VenderId}),providerId:c&&String(c.VenderId),pageId:l,isPreSale:"1"},h="/tour/im/group",g=I,v={needLogin:!0,needHost:!0};e.jumpH5({url:h,params:g,options:v})}else e.login({callback:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Te();case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()})}else{var x=We(t);e.openURL(x)}},handleGoPrivateIM:function(){var t=a.getState(),n=t.BasicInfo,r=t.pageId,i=t.VendorInfo,o=t.pageStatus,s=t.TourGroupInfo,c=o.activeProductId,l=o.activeAlias,u=o.isMultiLine,d=o.isMultiTravel,f=s||{},p=f.TourGroupProductInfo;if(i){var m={providerId:String(i.VenderId)};if(u){var I=p.filter((function(e){return e.ProductId==c}))[0];if(I){var h=["A","B","C","D","E","F","G","H","I","J"];m.lineDesc=h[I.SortNumber-1]}}else d&&(m.routeDesc=l);var g={IMCode:6===(null===n||void 0===n?void 0:n.Level)?"01090504":"01090502",productId:String(n.ProductId),destinationIdList:[n.DestCityId],departureCityId:String(n.DepartureId),saleCityId:String(n.SaleCityId),pageId:r,isPreSale:"1",providerId:String(i.VenderId),ExtendJson:JSON.stringify(m)};e.Storage.save({key:"TOUR_GROUPCHAT_ROBOT",value:JSON.stringify(g),domain:"tour"});var v="ctrip://wireless/tour_groupchat_robot?groupBizType=1105";e.openURL(v)}},handleGoFavouriteList:function(){var t,n=a.getState(),r=n.BasicInfo,i=n.isLogin,c=r.isStudy?"YOUXUE":r.isDiyfhxsdp?"FREE_TRAVEL_GROUP":"GROUP_TRAVEL";if("H5"===e.Platform){t="/webapp/favorite/index";var l={tagid:c,from:location.href};e.jumpH5({url:t,params:l})}else if("Taro"===e.Platform){if(!i)return void e.login({callback:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Te();case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()});var u=r.isDiyfhxsdp?"FREE_TRAVEL_GROUP":"GROUP_TRAVEL",d="https://m.ctrip.com/webapp/favorite/index?tagid=".concat(u);e.jumpH5({url:d})}else t=e.Util.base64Encode("/favorite/index.html?tagid="+c+"&isHideNavBar=YES"),e.openURL("ctrip://wireless/h5?type=1&url="+t)},handleGoHistory:function(){var t="https://m.ctrip.com/webapp/history/?tagid=VACATION&ctm_ref=vactang_page_1144&sid=711465&allianceid=262684&autoawaken=close";e.jumpH5({url:t})},handleGoHotKey:function(t){e.openURL("ctrip://wireless/tour_vacation_search?kwd="+t)},handleGoPicList:function(t){var n=a.getState(),r=n.BasicInfo,i=n.MediaInfo,o=void 0===i?{}:i,s=n.isTabStyle,c=n.pageStatus,l=n.isShowD2DSwitchTab,u=o.ImgList,d=r.ProductId,f=r.DepartureId,p=r.isCruise,m=c.activeProductId,I=c.initD2DSwitchType,h=c.curD2DSwitchType;if(u&&!(u.length<2))if("H5"===(null===e||void 0===e?void 0:e.Platform)||"Taro"===(null===e||void 0===e?void 0:e.Platform)){var g="/webapp/vacations/tour/detail_picture_list",v={productId:d};b({url:g,params:v})}else{if(pt(t),p){var x="/webapp/vacations/tour/detail_picture_list",S={productId:d,isHideNavBar:"YES"};b({url:x,params:S})}else{var T=s;T&&l&&I&&(T=I==h);var P="/rn_tour/main.js?CRNModuleName=CTTourApp&CRNType=1&initialPage=album&productid=".concat(s?m:d,"&departcityid=").concat(f,"&isNewStyle=").concat(T?1:0);e.openURL(P)}Tt({scene:"\u56fe\u7247\u5217\u8868\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})}},handleGoAlbumReview:function(){var t=a.getState(),n=t.BasicInfo,r=t.isTabStyle,i=t.pageStatus,o=t.isShowD2DSwitchTab,s=n.ProductId,c=n.DepartureId,l=i.activeProductId,u=i.initD2DSwitchType,d=i.curD2DSwitchType,f=r;f&&o&&u&&(f=u==d);var p="/rn_tour/main.js?CRNModuleName=CTTourApp&CRNType=1&initialPage=album&productid=".concat(r?l:s,"&departcityid=").concat(c,"&isNewStyle=").concat(f?1:0,"&isreview=1");e.openURL(p)},handleGoEpidemicPolicy:function(){var t=a.getState(),n=t.BasicInfo,r="/webapp/train/activity/ctrip-isolation-policy-query",i={isHideNavBar:"YES",source:"coronavirus",from:n.DepartureCityName,to:n.DestCityName};e.tracelog("grp_yiqinggonggao_trace",{}),b({url:r,params:i})},handleGoTourPoiPage:function(t){var n=a.getState(),r=n.BasicInfo,i=n.currentRouteInfo,o=n.pageStatus;if("RN"===e.Platform){var s=i.TravelIntroductionInfo,c=s.TravelIntroductionList[0],l=c.IntroductionInfoList,u=c.TravelDetailList,d=c.TravelSummaryInfoList,f=d&&d.some((function(e){return e.SummaryItems.some((function(e){return 5===e.ItemId}))})),p={IntroductionInfoList:l,TravelDetailList:u,BasicInfo:r,TravelSummaryInfoList:d,tabIndex:t?0:1,isShowScenic:f};e.set("TourPoiDetailData",p);var m="/rn_tour/main.js?CRNModuleName=CTTourApp&CRNType=1&initialPage=poidetail";e.openURL(m)}else{var I=t?0:1,h="/webapp/vacations/tour/poidetail",g={productId:o.activeProductId,departCityId:r.DepartureId,alias:o.activeAlias,tabindex:I,from:"Taro"===e.Platform?null:location.href},v={alwaysjump:1};b({url:h,params:g,options:v})}Tt({scene:"\u666f\u70b9\u53ca\u4f4f\u5bbf\u8be6\u60c5\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoHotelDetail:function(t){var n=t.HotelID,r=t.CityId;if("RN"===e.Platform){var i={cityid:r,hotelid:n,sourcefrom:"tour_poi"};new e.HotelPreFetch(i,{needJump:!0,pageName:"hotelDetail",env:e.Env.getEnvType(),jumpOptions:{hotel:!0}})}else{var a="/webapp/vacations/idiytour/hotelDetail",o={cityid:r,hotelid:n,sourcefrom:"tour_poi",from:"Taro"===e.Platform?null:location.href},s={isInZTAppToctrip:!0};b({url:a,params:o,options:s})}},handleGoScenicDetail:function(e){Be();var t=e.id,n=e.day,r="/webapp/vacations/tour/detail_scenic",i={id:t,day:n,isDinner:"0",ctstore:1,isHideNavBar:"YES"};b({url:r,params:i})},handleGoPoiPage:function(t,n){var r=t.DistrictID,i=t.GSScenicSpotID,a=t.PoiTypeId,o=t.BusinessId;if(3===a||66===a)if("RN"===e.Platform){var s=e.Util.base64Encode("/rn_destination_poi/index.main.js?CRNModuleName=rn_destination_poi&CRNType=1&initialPage=sightDetail&poiId=".concat(i,"&districtId=").concat(r,"&scene=grouptours&hideTicket=yes"));e.openURL("ctrip://wireless/h5?type=5&url="+s)}else{var c="/webapp/you/gspoi/sight/".concat(r,"/").concat(o,".html?poiId=").concat(i,"&scene=grouptours&seo=0&isHideNavBar=YES"),l={isInZTAppToctrip:!0};b({url:c,params:{},options:l})}else if(5===a){var u="/webapp/you/gsshopping/shops/".concat(r,"/").concat(o,".html"),d={isHideNavBar:"YES",seo:0,scene:"grouptours"},f={isInZTAppToctrip:!0};b({url:u,params:d,options:f})}else if(2===a){var p="/webapp/you/foods/".concat(r,"/").concat(o,".html"),m={fromType:"hotel",isHideHeader:!0,navBarStyle:"white",isHideNavBar:"YES"},I={isInZTAppToctrip:!0};b({url:p,params:m,options:I})}else{if(!i)return;we.handleGoScenicDetail({id:i,day:n})}Tt({scene:"POI\u8be6\u60c5\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoRestaurantDetail:function(e){var t=e.destCityId,n=e.restId,r="/webapp/you/foods/".concat(t,"/").concat(n,".html"),i={fromType:"hotel",isHideHeader:!0,navBarStyle:"white",isHideNavBar:"YES"},a={isInZTAppToctrip:!0};b({url:r,params:i,options:a}),Tt({scene:"\u9910\u996e\u8be6\u60c5\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoMapDetail:function(){var t=a.getState(),n=t.pageStatus,r=n.activeProductId,i=n.activeAlias,o="/rn_destination_journey/main.js?CRNModuleName=rn_destination_journey&CRNType=1&initialPage=mapToolsPage&productId=".concat(r,"&productType=2&alias=").concat(i);e.openURL(o)},handleGoShipDetail:function(){var t=a.getState(),n=t.CruisesBaseInfo,r=n.ShipInfo,i=r.EnName,o=r.Company;if("RN"===e.Platform){var s="/rn_cruise_webapp/index.ios.js?CRNModuleName=rn_cruise_webapp&CRNType=1&initialPage=Poi&companyNameEN=".concat(o.EnName,"&shipNameEN=").concat(i);e.openURL(s)}else{var c="https://m.ctrip.com/webapp/cw/cruise/poi.html?companyNameEN=".concat(o.EnName,"&shipNameEN=").concat(i);e.jumpH5({url:c})}},handleGoMemberShip:function(){var t=a.getState(),n=t.qConfig,r=t.userInfo,i=t.hasSuperMemberRight;if(n&&n.membershipUrl){var o=n.membershipUrl,s=r.VipGrade,c=s>=20?s:"";c=i?c+"s":c,"H5"===e.Platform||"Taro"===e.Platform?e.jumpH5({url:o[c]}):e.openURL(o[c]),Tt({scene:"\u4f1a\u5458\u6743\u76ca\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})}},handleGoFlightDiscountPage:function(){var t;"H5"===(null===e||void 0===e?void 0:e.Platform)||"Taro"===(null===e||void 0===e?void 0:e.Platform)?(t="https://m.ctrip.com/tangram/MTU2MjQ=?ctm_ref=vactang_page_15624&isHideNavBar=YES",b({url:t})):(t="/rn_tour_tangram/_crn_config?CRNModuleName=rn_tangram&CRNType=1&initialPage=VacationTangram&pageId=MTU2MjQ=&ctm_ref=vactang_page_15624",e.openURL(t)),Tt({scene:"\u673a\u7968\u7528\u6237\u6743\u76ca\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoSuggestDestination:function(t){var n=a.getState(),r=n.BasicInfo,i=r.isDiyfhxsdp?{searchtype:"diy",tab:2,kwd:t}:{searchtype:"tour",tab:64,kwd:t};if("RN"===e.Platform){var o="ctrip://wireless/tour_vacation_search?".concat(O.stringify(i));e.openURL(o)}else{var s="/webapp/vacations/tour/list";b({url:s,params:i})}Tt({scene:"\u63a8\u8350\u76ee\u7684\u5730\u5217\u8868",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoSearchTag:function(t){var n=a.getState(),r=n.BasicInfo,i=r.ProductCategoryId,o=r.isDiyfhxsdp,s=r.DestCityName,c=r.isStudy,l=o?{searchtype:"diy",tab:9===i?65536:2,kwd:"".concat(s," ").concat(t)}:c?{searchtype:"study",tab:8192,kwd:"".concat(s," ").concat(t)}:{searchtype:"tour",tab:9===i?512:64,kwd:"".concat(s," ").concat(t)},u="ctrip://wireless/tour_vacation_search?".concat(O.stringify(l));e.openURL(u),Tt({scene:"\u8df3\u8f6c\u641c\u7d22\u5217\u8868\u9875",value:"\u8df3\u8f6c\u4e8c\u7ea7\u9875"})},handleGoCruiseRoomDiffPage:function(){if("RN"===e.Platform){var t="/rn_cruise_webapp/main.js?CRNModuleName=rn_cruise_webapp&CRNType=1&initialPage=ClassDetail&lessonId=15";e.openURL(t)}else{var n="https://m.ctrip.com/webapp/cw/cruise/classdetail.html?lessonId=15";e.jumpH5({url:n})}},handleGoCruiseCommonProblem:function(){var t=a.getState(),n=t.CruisesBaseInfo,r=n.ShipInfo,i=r.EnName,o=r.Company;if("RN"===e.Platform){var s="/rn_cruise_webapp/index.ios.js?CRNModuleName=rn_cruise_webapp&CRNType=1&initialPage=PoiFAQ&companyName=".concat(o.EnName,"&shipName=").concat(i);e.openURL(s)}else{var c="https://m.ctrip.com/webapp/cw/cruise/poifaq.html?companyName=".concat(o.EnName,"&shipName=").concat(i);e.jumpH5({url:c})}},handleGoCruiseBookingTip:function(){if("RN"===e.Platform){var t="/rn_cruise_webapp/index.ios.js?CRNModuleName=rn_cruise_webapp&CRNType=1&initialPage=ClassIndex&tabid=5";e.openURL(t)}else{var n="https://m.ctrip.com/webapp/cw/cruise/classindex.html?tabid=5";e.jumpH5({url:n})}},handleGoHotelStarPage:function(){var t="/rn_hotel_ct/main.js?CRNType=1&initialPage=HotelStarDiamondDescriptionPage&CRNModuleName=RN_CT_Hotel&isHideNavBar=YES&isMainland=1";e.openURL(t)},handleGoTrackOrder:function(){var t=a.getState(),n=t.BasicInfo,r=t.pageStatus,i="/webapp/vacations/tour/travelintention",o={outtype:n.isDiyfhxsdp?"diy":"tour",subchannelid:12,sourcetype:2,productid:r.activeProductId||n.ProductId,dcityid:n.DepartureId,destid:n.DestCityId,dest:n.DestCityName,from:"Taro"===e.Platform?null:location.href};b({url:i,params:o})},handleGoEnterpriseWechatPage:function(){var t=a.getState(),n=t.BasicInfo,r=n.SaleMode,i=n.IsInternal,o="",s=(Number(null===n||void 0===n?void 0:n.ProductId)||0)%2===0;if("S"===r?o=i?s?"https://m.ctrip.com/tangram/MzMxMDQ=?ctm_ref=vactang_page_33104&isHideNavBar=YES&apppgid=10650019968":"https://m.ctrip.com/tangram/MzY2Nzc=?ctm_ref=vactang_page_36677&isHideNavBar=YES&apppgid=10650019968":"https://m.ctrip.com/tangram/MzMzNDE=?ctm_ref=vactang_page_33341&isHideNavBar=YES&apppgid=10650019968":"P"===r&&(o=i?s?"https://m.ctrip.com/tangram/MzY3ODA=?ctm_ref=vactang_page_36780&isHideNavBar=YES&apppgid=10650019968":"https://m.ctrip.com/tangram/MzY2ODA=?ctm_ref=vactang_page_36680&isHideNavBar=YES&apppgid=10650019968":"https://m.ctrip.com/tangram/MzMzNDI=?ctm_ref=vactang_page_33342&isHideNavBar=YES&apppgid=10650019968"),o){var c=JSON.stringify({url:encodeURIComponent(o)});if("Taro"===e.Platform){var l="/cwx/component/cwebview/cwebview?data="+c;e.navigateTo({url:l})}else{var u="cwx/component/cwebview/cwebview?data="+c,d=e.Util.base64Encode(u),f="ctrip://wireless/login/openMiniProgram?username=gh_36ada103ba97&path=".concat(d,"&type=0");e.openURL(f)}}},handleGoComplexRoutePage:function(){var t=a.getState(),n=t.BasicInfo,r=t.pageStatus,i=(r.isMultiLine,r.isMultiTravel,r.activeProductId,r.activeAlias,"/pages/vacations/detailComplexRoute/index"),o={ProductId:r.activeProductId,DepartCityId:n.DepartureId,Alias:r.activeAlias};e.navigateTo({url:i,params:o})},handleGoAsk:function(){var t=a.getState(),n=t.BasicInfo,r=t.pageStatus,i=t.pageId,o=t.VendorInfo;if("RN"===(null===e||void 0===e?void 0:e.Platform)){var s="/webapp/you/askAnswer/ask/list",c="01090800",l="R"===n.SaleMode,u=l?1115:1105,d=String(o.VenderId),f='{"IMCode":"'.concat(c,'","pageId":"').concat(i,'","providerId":"').concat(d,'","destinationIdList":[').concat(n.DestCityId,'],"productId":"').concat(n.ProductId,'","orderStatus":"0","isPreSale":"1"}'),p="ctrip://wireless/tour_groupchat_robot_url?groupBizType=".concat(u,"&args=").concat(encodeURIComponent(e.Util.base64Encode(f))),m={id:r.activeProductId,pageType:"groupTravel",imShowtext:"\u95ee\u5ba2\u670d",imUrl:encodeURIComponent(p),isHideHeader:!0,isHideNavBar:"YES"};e.jumpH5({url:s,params:m})}}},Ce=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n,r){var i,s,l,u,d;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=a.getState(),s=i.BasicInfo,r){t.next=3;break}return t.abrupt("return");case 3:return l="DETAIL_LIST_LINKAGE",t.next=6,e.loadStorage(l,"tour");case 6:u=t.sent,d=u?JSON.parse(u):{},d=(0,c.Z)((0,c.Z)({},d),{},{departureCityId:n,departureCityName:r}),e.sendKMLog({attrs:[{key:"productId",value:s.ProductId}],scene:"\u8054\u52a8\u5217\u8868\u9875\u5199\u5165\u7f13\u5b58\u57ce\u5e02",action:"sys_change",jsonData:d}),e.Storage.save({key:"DETAIL_LIST_LINKAGE",value:JSON.stringify(d),domain:"tour"});case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Ne=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,s,l,u;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=a.getState(),i=r.BasicInfo,s="DETAIL_LIST_LINKAGE",t.next=4,e.loadStorage(s,"tour");case 4:l=t.sent,u=l?JSON.parse(l):{},u=(0,c.Z)((0,c.Z)({},u),{},{seletedDate:n}),e.sendKMLog({attrs:[{key:"productId",value:i.ProductId}],scene:"\u8054\u52a8\u5217\u8868\u9875\u5199\u5165\u7f13\u5b58\u65e5\u671f",action:"sys_change",jsonData:u}),e.Storage.save({key:"DETAIL_LIST_LINKAGE",value:JSON.stringify(u),domain:"tour"});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),De=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("RN"===(null===e||void 0===e?void 0:e.Platform)){t.next=2;break}return t.abrupt("return");case 2:return n=a.getState(),r=n.BasicInfo,i=l.UPDATE_LOCATION_INFO,t.next=6,e.getDepartureCityCache();case 6:s=t.sent,s=s||{},i(s),e.sendKMLog({attrs:[{key:"productId",value:r.ProductId}],scene:"\u7f13\u5b58\u57ce\u5e02\u4fe1\u606f\uff08\u53ea\u8bfb\u53d6\uff0c\u4e0d\u81ea\u52a8\u5207\u6362\uff09",action:"sys_change",jsonData:s});case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),je=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,a;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getUserInfo();case 2:n=t.sent,r=n.userInfo,i=n.isLogin,a=l.SET_USER_INFO,a({userInfo:r,isLogin:i});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),_e=function(t){var n=t.beforeCallback,r=t.afterCallback,i=t.showNonMember,c=void 0!==i&&i;e.User.userLoginWithParams({showNonMember:c},(0,s.Z)((0,o.Z)().mark((function e(){var t,i;return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,je();case 2:if(t=a.getState(),i=t.isLogin,!i){e.next=8;break}return n&&n(),e.next=7,y();case 7:r&&r();case 8:case"end":return e.stop()}}),e)}))))},be=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,je();case 2:y();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ke=function(){var e=a.getState(),t=e.imEntryInfo;return t&&t.imInfo&&t.imInfo.resolveImCode?t.imInfo.resolveImCode:"01090100"},Le=function(){var e=a.getState(),t=e.MediaInfo,n=t.ImgList,r="https://pic.c-ctrip.com/vacation_v2/h5/group_travel/pic_none.png";return n&&n[0]&&n[0].UrlList[0]&&n[0].UrlList[0].Value&&(r=n[0].UrlList[0].Value.replace("_750_420","_160_160")),r},Be=function(){var t=a.getState(),n=t.currentRouteInfo;if(n){var r=n.TravelIntroductionInfo;if(!r)return null;var i=r.TravelIntroductionList[0].TravelDetailList;if(i&&i.length){var o=[],s=[],c=[];i.forEach((function(e){var t=e.FewDay,n={day:t,data:[]},r={day:t,data:[]};e.hotelList.forEach((function(e){e.HotelInfoList.forEach((function(e,n){o.push({day:t,id:e.HotelID,name:e.HotelName,orFlag:0!==n})}))})),e.scenicList.forEach((function(e,t){e.ScenicSpotList.forEach((function(t,r){var i=r>0&&!!e.ScenicSpotList[r-1].OrFlag;t.GSScenicSpotID&&n.data.push({id:t.GSScenicSpotID,name:t.Name,classic:t.IsClassic,orFlag:i})}))})),e.dinnerList.forEach((function(e,t){var n=e.DinnerInfo,i=n||{},a=i.DinnerPoiInfoList;a&&a.forEach((function(e,t){e.GSScenicSpotID&&r.data.push({id:e.GSScenicSpotID,name:e.Name,classic:!1,orFlag:!1})}))})),n.data.length&&s.push(n),r.data.length&&c.push(r)}));var l=JSON.stringify({detail_hotel_list:o,detail_scenic_list:s,detail_dinner_list:c});e.Storage.save({key:"VACATION_TOURE_VIEW",value:l,domain:"tour"})}}},Re=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n,r,i;return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.getState(),n=t.pageStatus,r=t.BookInfo,t.ScheduleInfo,i=l.SET_SHOW_DEPARTCITYINFO,n.curD2DSwitchType===n.initD2DSwitchType){e.next=4;break}return e.abrupt("return");case 4:if(r.IsBook){e.next=7;break}return i(),e.abrupt("return");case 7:return n.isCrhTag&&Ee(),e.next=10,Ve();case 10:if(e.t1=e.sent,!e.t1){e.next=15;break}return e.next=14,Ze();case 14:e.t1=e.sent;case 15:if(e.t0=e.t1,!e.t0){e.next=20;break}return e.next=19,Ue();case 19:e.t0=e.sent;case 20:if(e.t2=e.t0,!e.t2){e.next=24;break}return e.next=24,Oe();case 24:Ae(),i();case 26:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Me=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,u,d,f,p,m,I,h,g,v,x,S,T,P;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=a.getState(),r=n.BasicInfo,i=n.query,s=n.pageStatus,c=n.groupCard,u=l.SET_NEWPROCESS_SELECT_DATE,d=a.getState(),f=d.currentRouteInfo,p=f.dailyMinPrices,t.next=6,e.loadStorage("DETAIL_LIST_LINKAGE","tour");case 6:return m=t.sent,t.next=9,e.get("NewProcessSelectedDate");case 9:return I=t.sent,t.next=12,e.get("SelectPreSaleDate");case 12:if(h=t.sent,!i||!i.presaleid){t.next=15;break}return t.abrupt("return");case 15:if(g=s.activeProductId,c&&c.cards&&c.cards.length&&(x=c.cards.find((function(e){return e.productId===g})),x&&x.preSaleProductInfo&&x.preSaleProductInfo.canBook&&(v=x.preSaleProductInfo.productId)),!v){t.next=21;break}if(!h){t.next=21;break}return we.handleSelectPreSaleDate(),t.abrupt("return");case 21:if(m){t.next=23;break}return t.abrupt("return");case 23:if(S=JSON.parse(m),S){t.next=26;break}return t.abrupt("return");case 26:if(T=S.dateArr,e.sendKMLog({attrs:[{key:"productId",value:r.ProductId}],scene:"\u8054\u52a8\u5217\u8868\u9875\u8bfb\u53d6\u65e5\u671f\u7f13\u5b58",action:"sys_change",value:T?T.join("; "):"",jsonData:S}),T&&T.length){t.next=30;break}return t.abrupt("return");case 30:if(!T.includes(I)){t.next=32;break}return t.abrupt("return");case 32:P="",T.some((function(e){var t=!1;return null===p||void 0===p||p.forEach((function(n){n.date===e&&(P=e,t=!0)})),t})),P?(u(P),"RN"===e.Platform&&(oe(),ce()),e.set("NewProcessSelectedDate",P,86400)):we.handleTraceLog("grp_toast_details_products_exposure");case 35:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Ee=function(){var e=a.getState(),t=e.productGroupInfo,n=e.pageStatus;if(t){var r=t.TagGroupInfoList,i=[];r&&r.forEach((function(e){e.SpecialTagList.forEach((function(t){"\u52a8\u8f66\u9ad8\u94c1\u6e38"===t.TagName&&i.push(e.ProductId)}))})),i.length&&!i.includes(n.activeProductId)&&we.handleMultiLineChange(i[0],!1)}},Ve=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,l,u,d,f,p,m,I,h,g;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.query,i=n.BasicInfo,s=n.LocationInfo,c=n.currentRouteInfo,l=n.TourGroupInfo,u=c.PriceInfo,s=s||{},r.departcityid){t.next=29;break}if(d=s.departureCityId||s.locationCityId,f=u&&u.DepartureCityPriceList&&u.DepartureCityPriceList.map((function(e){return e.DepartureCityId})),l&&l.TourGroupProductInfo){t.next=8;break}return t.abrupt("return",!0);case 8:if(p=l.TourGroupProductInfo.filter((function(e){return e.ProductId===Number(i.ProductId)}))[0],!p||!p.DepartureCities.includes(Number(d))){t.next=13;break}return t.next=12,we.handleChangeDepartCity(Number(d),i.ProductId,!1);case 12:return t.abrupt("return",!1);case 13:if(!f||!f.includes(Number(d))){t.next=26;break}if(m=l.TourGroupProductInfo.filter((function(e){return e.DepartureCities.includes(Number(d))}))[0],m.ProductId===i.ProductId){t.next=26;break}return t.next=18,we.handleChangeDepartCity(Number(d),m.ProductId,!1,!1);case 18:return I=l.TourGroupProductInfo.filter((function(e){return e.ProductId===m.ProductId}))[0],t.next=21,xe(d);case 21:return h=t.sent,g=["A","B","C","D","E","F","G","H","I","J"],e.showToast("".concat(g[p.SortNumber-1],"\u7ebf\u4e0d\u652f\u6301").concat(h,"\u51fa\u53d1\uff0c\u5df2\u4e3a\u60a8\u81ea\u52a8\u5207\u6362\u5230").concat(g[I.SortNumber-1],"\u7ebf")),ht({sceneType:1,isAccept:!0}),t.abrupt("return",!1);case 26:return t.abrupt("return",!0);case 29:return t.abrupt("return",!0);case 30:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Ae=function(){var e=a.getState(),t=e.groupCard,n=e.pageStatus,r=e.TourGroupInfo,i=(e.BasicInfo,e.query);if(!n.isMultiLine||!t||!r)return!0;if(i&&i.presaleid)return!0;var o=t.cards,s=[];return o&&o.forEach((function(e){e.canBook&&Number.isInteger(e.priceDesc)&&s.push(e.productId)})),!(s.length&&!s.includes(n.activeProductId))||(we.handleMultiLineChange(s[0],!1),ht({sceneType:1,isAccept:!0}),!1)},Ze=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,l,u,d;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.query,i=n.currentRouteInfo,s=n.BasicInfo,c=i.PriceInfo,!c||!c.DepartureCityPriceList){t.next=14;break}if(l=c.DepartureCityPriceList.filter((function(e){return e.ProductIdList.includes(s.ProductId)})),u=c.DepartureCityPriceList.map((function(e){return e.DepartureCityId})),1!==l.length||u.includes(Number(r.departcityid))){t.next=14;break}if(d=l[0],r.departcityid){t.next=9;break}return t.abrupt("return",!1);case 9:if(d.DepartureCityId===Number(r.departcityid)){t.next=14;break}return e.showToast("\u672c\u4ea7\u54c1\u4ec5\u652f\u6301\u3010".concat(d.DepartureCityName,"\u3011\u51fa\u53d1\uff0c\u5df2\u4e3a\u60a8\u81ea\u52a8\u5207\u6362"),2),dt(0),ht({sceneType:2,isAccept:!0}),t.abrupt("return",!1);case 14:return t.abrupt("return",!0);case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Oe=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,u,d,f,p,m,I,h,g,v,x;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.getState(),r=n.query,i=n.BasicInfo,s=n.currentRouteInfo,c=n.TourGroupInfo,u=s.PriceInfo,!r.departcityid||Number(r.departcityid)===i.DepartureId||!Number(r.departcityid)){t.next=32;break}if(u.DepartureCityPriceList){t.next=5;break}return t.abrupt("return",!0);case 5:if(d=u.DepartureCityPriceList.map((function(e){return e.DepartureCityId})),!(d.includes(Number(r.departcityid))&&c&&c.TourGroupProductInfo)){t.next=22;break}return f=c.TourGroupProductInfo.filter((function(e){return e.DepartureCities.includes(Number(r.departcityid))}))[0],t.next=10,we.handleChangeDepartCity(Number(r.departcityid),f.ProductId,!1,!1);case 10:return p=c.TourGroupProductInfo.filter((function(e){return e.ProductId===Number(r.productid)}))[0],m=c.TourGroupProductInfo.filter((function(e){return e.ProductId===f.ProductId}))[0],t.next=14,xe(r.departcityid);case 14:return I=t.sent,h=["A","B","C","D","E","F","G","H","I","J"],e.showToast("".concat(h[p.SortNumber-1],"\u7ebf\u4e0d\u652f\u6301").concat(I,"\u51fa\u53d1\uff0c\u5df2\u4e3a\u60a8\u81ea\u52a8\u5207\u6362\u5230").concat(h[m.SortNumber-1],"\u7ebf")),ft(),ht({sceneType:1,isAccept:!0}),t.abrupt("return",!1);case 22:return g=l.UPDATE_ALERT_MASK,t.next=25,xe(r.departcityid);case 25:return v=t.sent,x={type:"choose_other_city",isShowAlertMask:!0,mainBtnText:"\u9009\u62e9\u51fa\u53d1\u57ce\u5e02",subBtnText:"\u53d6\u6d88",title:"\u672c\u4ea7\u54c1\u4e0d\u652f\u6301\u4ece".concat(v,"\u51fa\u53d1\uff0c\u5efa\u8bae\u60a8\u5207\u6362\u51fa\u53d1\u57ce\u5e02")},g(x),ut(),t.abrupt("return",!1);case 30:t.next=33;break;case 32:return t.abrupt("return",!0);case 33:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Ue=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n,r,i,s,c,u,d,f,p,m;return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.getState(),n=t.query,r=t.BasicInfo,i=t.LocationInfo,s=t.currentRouteInfo,c=s.PriceInfo,n.departcityid){e.next=24;break}if(i&&(i.locationCityId||i.departureCityId)){e.next=5;break}return e.abrupt("return",!0);case 5:if(u=Number(i.departureCityId)||0,d=Number(i.locationCityId)||0,f=c&&c.DepartureCityPriceList&&c.DepartureCityPriceList.map((function(e){return e.DepartureCityId})),!f||!f.includes(u)){e.next=14;break}if(u===r.DepartureId){e.next=12;break}return e.next=12,we.handleChangeDepartCity(u,r.ProductId,!1,!1);case 12:e.next=21;break;case 14:if(!f||!f.includes(d)){e.next=20;break}if(d===r.DepartureId){e.next=18;break}return e.next=18,we.handleChangeDepartCity(d,r.ProductId,!1,!1);case 18:e.next=21;break;case 20:f&&f.length&&(p=l.UPDATE_ALERT_MASK,m={type:"choose_other_city",isShowAlertMask:!0,mainBtnText:"\u9009\u62e9\u51fa\u53d1\u57ce\u5e02",subBtnText:"\u53d6\u6d88",title:"\u672c\u4ea7\u54c1\u652f\u6301\u591a\u5730\u51fa\u53d1\uff0c\u5efa\u8bae\u60a8\u5207\u6362\u51fa\u53d1\u57ce\u5e02"},p(m),ut());case 21:return e.abrupt("return",!1);case 24:return e.abrupt("return",!0);case 25:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Fe=function(){var t=a.getState(),n=t.newProcessSelectDate,r=t.priceCalendarData,i=t.pageStatus,o=t.currentRouteInfo,s=t.groupCard,c=l.SET_NEWPROCESS_SELECT_DATE,u=l.SET_LINE_SWITCH_LOADING;if(I){if(!n){ce();var d=i.curD2DSwitchType;return d?void Ge():void u(!1)}var f=i.activeProductId,p=i.isMultiTravel,m=i.activeAlias,h=o.dailyMinPrices;if(p){if(h&&h.length){var g=h.filter((function(e){return null===e||void 0===e?void 0:e.productPrices.some((function(e){return e.alias===m}))}));g.some((function(e){return e.date===n}))?console.log("\u7ebf\u8def\u5305\u542b\u5f53\u524d\u65e5\u671f"):(c(""),console.log("\u5df2\u9009\u65e5\u671f\u4e0d\u53ef\u8ba2\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9",1),e.showToast("\u5df2\u9009\u65e5\u671f\u4e0d\u53ef\u8ba2\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9"))}}else if(h&&h.length){if(r){var v=r.dailyMinPrice;if(v[n]){var x=v[n].productPrices;x&&x.find((function(e){return e.productId===f}))?console.log("\u7ebf\u8def\u5305\u542b\u5f53\u524d\u65e5\u671f"):(c(""),console.log("\u5df2\u9009\u65e5\u671f\u4e0d\u53ef\u8ba2\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9",2),e.showToast("\u5df2\u9009\u65e5\u671f\u4e0d\u53ef\u8ba2\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9"))}else c(""),console.log("\u5df2\u9009\u65e5\u671f\u4e0d\u53ef\u8ba2\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9",3),e.showToast("\u5df2\u9009\u65e5\u671f\u4e0d\u53ef\u8ba2\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9")}}else{var S;if(s&&s.cards&&s.cards.length){var T=s.cards.find((function(e){return e.productId===f}));T&&T.preSaleProductInfo&&T.preSaleProductInfo.canBook&&(S=T.preSaleProductInfo.productId)}S||(c(""),e.showToast("\u65e0\u53ef\u8ba2\u65e5\u671f\uff0c\u8bf7\u5207\u6362\u5957\u9910\u6216\u51fa\u53d1\u5730"))}u(!1),ce()}},Ge=function(){var t,n,r,i,o,s=a.getState(),c=s.copiedOriginalProductState,u=s.copiedNewProductState,d=s.pageStatus,f=s.priceCalendarData,p=l.SET_NEWPROCESS_SELECT_DATE,m=l.SET_LINE_SWITCH_LOADING,I=d.curD2DSwitchType,h=d.activeProductId,g=d.initD2DSwitchType;if(console.log("checkD2DSwitchSelectedDateAvailable",I),I!==g){if(console.log("checkD2DSwitchSelectedDateAvailable1",c),!c)return;t=c.newProcessSelectDate,n=c.currentRouteInfo,r=c.groupCard,i=c.pageStatus.isMultiTravel,o=c.pageStatus.activeAlias}else{if(!u)return;t=u.newProcessSelectDate,n=u.currentRouteInfo,r=u.groupCard,i=u.pageStatus.isMultiTravel,o=u.pageStatus.activeAlias}if(t){var v=n,x=v.dailyMinPrices;if(i){if(x&&x.length){var S=x.filter((function(e){return null===e||void 0===e?void 0:e.productPrices.some((function(e){return e.alias===o}))}));S.some((function(e){return e.date===t}))?console.log("\u7ebf\u8def\u5305\u542b\u5f53\u524d\u65e5\u671f"):(p(""),console.log("\u5df2\u9009\u65e5\u671f\u4e0d\u53ef\u8ba2\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9",4),e.showToast("\u5df2\u9009\u65e5\u671f\u4e0d\u53ef\u8ba2\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9"))}}else if(console.log("checkD2DSwitchSelectedDateAvailable2",x,t,h,f),x&&x.length){if(f){var T=f.dailyMinPrice;if(T[t]){var P=T[t].productPrices;P&&P.find((function(e){return e.productId===h}))?(console.log("\u7ebf\u8def\u5305\u542b\u5f53\u524d\u65e5\u671f"),p(t),"RN"===e.Platform&&(oe(),ce())):(p(""),console.log("\u5df2\u9009\u65e5\u671f\u4e0d\u53ef\u8ba2\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9",5),e.showToast("\u5df2\u9009\u65e5\u671f\u4e0d\u53ef\u8ba2\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9"))}else p(""),console.log("\u5df2\u9009\u65e5\u671f\u4e0d\u53ef\u8ba2\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9",6),e.showToast("\u5df2\u9009\u65e5\u671f\u4e0d\u53ef\u8ba2\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9")}}else{var y;if(r&&r.cards&&r.cards.length){var w=r.cards.find((function(e){return e.productId===h}));w&&w.preSaleProductInfo&&w.preSaleProductInfo.canBook&&(y=w.preSaleProductInfo.productId)}y||(p(""),e.showToast("\u65e0\u53ef\u8ba2\u65e5\u671f\uff0c\u8bf7\u5207\u6362\u5957\u9910\u6216\u51fa\u53d1\u5730"))}m(!1)}},He=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n,r,i,s,c,u,d,f,p;return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.getState(),n=t.query,r=t.groupCard,i=t.pageStatus,s=t.isPreSale,c=l.SET_SHOW_PRESALE_MULTIROUTE,u=i.activeProductId,s){e.next=6;break}return c(),e.abrupt("return");case 6:if(!n||!n.presaleid){e.next=17;break}if(r&&r.cards&&r.cards.length&&(p=r.cards.find((function(e){return!(!e||!e.preSaleProductInfo||e.preSaleProductInfo.productId!==Number(n.presaleid))})),p&&p.preSaleProductInfo&&p.preSaleProductInfo.canBook&&(d=p.preSaleProductInfo.productId,f=p.productId)),!d){e.next=16;break}if(u!==f){e.next=13;break}we.handleSelectPreSaleDate(),e.next=16;break;case 13:return e.next=15,we.handleMultiLineChange(f);case 15:we.handleSelectPreSaleDate();case 16:c();case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ke=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,c,u;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=a.getState(),n.query,r=l.SET_ABTEST_RESULT,l.UPDATE_STATE,i={},c=K.map(function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getABTest(n);case 2:return r=t.sent,t.abrupt("return",{code:n,version:r.ExpVersion||"A"});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=6,Promise.all(c);case 6:u=t.sent,u.forEach((function(e){var t=e.code,n=e.version;i[t]=n})),r(i);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ze=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("RN"===(null===e||void 0===e?void 0:e.Platform)){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.getABTest(n);case 4:return r=t.sent,i=(null===r||void 0===r?void 0:r.ExpVersion)||"A",t.abrupt("return",i);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),We=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=a.getState(),r=n.BasicInfo,i=n.pageId,o=n.VendorInfo,s=n.pageStatus,c=n.TourGroupInfo,l=s.activeProductId,u=s.activeAlias,d=s.isMultiLine,f=s.isMultiTravel,p=c||{},m=p.TourGroupProductInfo;if(o){var I="R"===r.SaleMode,h=I?1115:1105,g={providerId:String(o.VenderId)};if(d){var v=m.filter((function(e){return e.ProductId==l}))[0];if(v){var x=["A","B","C","D","E","F","G","H","I","J"];g.lineDesc=x[v.SortNumber-1]}}else f&&(g.routeDesc=u);var S={IMCode:t?"01090800":ke(),productId:String(r.ProductId),destinationIdList:[r.DestCityId],departureCityId:String(r.DepartureId),saleCityId:String(r.SaleCityId),pageId:i,isPreSale:"1",providerId:String(o.VenderId),ExtendJson:JSON.stringify(g)};return e.Storage.save({key:"TOUR_GROUPCHAT_ROBOT",value:JSON.stringify(S),domain:"tour"}),"ctrip://wireless/tour_groupchat_robot?groupBizType="+h}},qe=function(t){var n=a.getState(),r=n.BasicInfo,i=n.VendorInfo,o=n.currentRouteInfo;if(!i)return{};var s=o.servicePerson,l="S"===r.SaleMode,u=i.VenderId,d="/webapp/vacations/shop/tourguide",f={servicepersonid:t,supplierid:l?"0":String(u),productid:r.ProductId,departcityid:r.DepartureId,detailpagename:e.RegisterPageName,showproduct:1,showserveproducts:1,isHideNavBar:"YES"};s&&s.roleType&&3===s.roleType&&(f=(0,c.Z)((0,c.Z)({},f),{},{tpal:1}));var p=d;return"RN"===e.Platform&&(p=e.parseUrl(d,f),0===p.indexOf("/webapp/")&&(p=_+p)),{url:d,params:f,guideJumpUrl:p}},Ye=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,l;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,n=a.getState(),r=n.pageStatus,i=r.isMultiLine,s=r.isMultiTravel,!i){t.next=8;break}return t.next=6,e.get("CALENDAR_SELECT_LINE");case 6:c=t.sent,c&&(we.handleMultiLineChange(Number(c),!1,!1),e.remove("CALENDAR_SELECT_LINE"));case 8:if(!s){t.next=13;break}return t.next=11,e.get("CALENDAR_SELECT_ALIAS");case 11:l=t.sent,l&&(we.handleMultiTravelChange(l),e.remove("CALENDAR_SELECT_ALIAS"));case 13:t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](0),console.log("refreshSelectedLine",t.t0);case 18:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(){return t.apply(this,arguments)}}(),$e=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){var r,i,a,s,c,u;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=n.PreSaleTourGroupInfo,i=n.productid,a=l.UPDATE_URL_QUERY,!(r&&r.PreSaleInfo&&r.PreSaleInfo.length)){t.next=13;break}if(s=r.PreSaleInfo,c=s.find((function(e){return e.PreSaleProductId===Number(i)})),!c){t.next=13;break}if(u=c.ProductId,!u){t.next=13;break}return a({productid:u,presaleid:i,nocache:1}),t.next=11,B();case 11:return e.sendKMLog({attrs:[{key:"productId",value:i}],scene:"\u9884\u552e\u4ea7\u54c1Id\u76f4\u8fbe\u8be6\u60c5\u9875",action:"sys_change",value:"\u4fee\u6b63\u540e\u4ea7\u54c1Id\uff1a".concat(u),before:"\u539f\u59cbURL\u4ea7\u54c1Id\uff1a".concat(i)}),t.abrupt("return",!0);case 13:return t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Je=function(t,n){var r="RN"===e.Platform?{11:"401019",10:"401020",9:"401021",26:"401023",13:"404027",33:"600001573",34:"600001573",41:"600001573",42:"600001573",sale:"401007",route:"401040",theme:"600005140",privileged:"220241",original:"220240",diyfhxsdp:"600000786",pureDiyfhxsdp:"411017",cruise:"10650053814",default:"600001573"}:{11:"220102",10:"220103",9:"220104",26:"220106",13:"223027",33:"600001565",34:"600001565",41:"600001565",42:"600001565",sale:"104313",route:"220133",theme:"600005137",privileged:"220241",original:"220240",diyfhxsdp:"600000785",pureDiyfhxsdp:"234017",cruise:"10650053814",default:"600001565"};if(t){var i=t.ProductCategoryId;t.isCruise?i="cruise":t.isPureDiyfhxsdp?i="pureDiyfhxsdp":t.isDiyfhxsdp?i="diyfhxsdp":n.sharetype?i=n.sharetype:t.IsThemeProduct&&(i="theme");var a=r[i]||r["default"];return"Taro"===(null===e||void 0===e?void 0:e.Platform)?e.sendPV({pageId:a,url:e.url}):(e.asyncSetPageId&&e.asyncSetPageId(a),e.Log.logPage(a,{targetPageRef:e.pageviewIdentity,__page_hierarchy_id:e.__page_hierarchy_id})),a}},Qe=function(){Xe(),tt(),nt(),rt(),it(),at(),ot(),ct(),gt(),vt()},Xe=function(){var t=a.getState(),n=t.BasicInfo,r=t.pageStatus,i=t.BookInfo,o=t.ScheduleInfo,s=t.currentRouteInfo,c=s.PriceInfo;if(i&&o&&c){var l,u="RN"===e.Platform?"pkg_detail_view_app_basic":"pkg_detail_view_h5_basic";switch(n.ProductPatternId){case 2:l="diy";break;case 3:l="self";break;case 4:l="private";break;default:l="pkg"}n.isCruise&&(l="Cruise_New"),et();var d=r.isMultiLine?"\u591a\u7ebf\u8def":r.isMultiTravel?"\u591a\u884c\u7a0b":"\u5355\u7ebf\u8def",f={to_poi:{poiname:n.DestCityName,poiid:n.DestCityId},from:{cityname:n.DepartureCityName,cityid:n.DepartureId},vacationtype:l,productid:n.ProductId,is_sold:i.IsBook&&o.HasInventory?0:1,price:c.MinPrice,line_type:d,ispresell:1===n.PreSaleStatus,originprice:c.OriginPrice,displayprice:c.DisplayPrice};e.tracelog(u,f)}},et=function(){var t=a.getState(),n=t.BasicInfo,r=t.pageId,i=t.isLogin;if(i){var o="Tour_pkg";switch(n.ProductPatternId){case 2:o="Tour_diy";break;case 3:o="Tour_self";break;case 4:o="Tour_private";break;default:o="Tour_pkg"}n.isCruise&&(o="Cruise_New");var s={pageType:"Detail",channel:"App",site:"ctrip",bizType:o,commonData:{fromCityId:n.DepartureId,productId:String(n.ProductId),pageId:r}};try{e.post("saveBrowseHistory",s)}catch(e){console.log(e)}}},tt=function(){var t=a.getState(),n=(t.pageStatus,t.BasicInfo),r=n.ProductCategoryId,i=n.ProductId,o=n.DepartureId,s=n.SaleCityId,c="p".concat(i,"s").concat(s,"d").concat(o);if([9,10,33,41].includes(r)){var l="";l=n.isStudy?"youxue-detail-inland-".concat(c):"grouptravel-detail-domestic-".concat(c),e.Business.logGoogleRemarking(l,{type:"hybrid"})}if([11,26,34,42].includes(r)){var u="";u=n.isStudy?"youxue-detail-int-".concat(c):"grouptravel-detail-overseas-".concat(c),e.Business.logGoogleRemarking(u,{type:"hybrid"})}},nt=function(){var t=a.getState(),n=t.BasicInfo,r=t.userInfo,i=n.ProductCategoryId,o=n.ProductId,s=n.DepartureId,c=n.DestCityId,l={UID:r.UserID,IP:"",From:s,To:c,ProductID:o},u=[],d="";if(10==i?d="TOUR.BROWSE.DOMESTIC.LONG":9==i?d="TOUR.BROWSE.DOMESTIC.NDAY":11==i?d="TOUR.BROWSE.ABROAD.LONG":26==i&&(d="TOUR.BROWSE.ABROAD.NDAY"),d){for(var f in l)u.push([f,"=",l[f]].join(""));e.tracelog(d,u.join("&"))}},rt=function(){var t=a.getState(),n=t.BasicInfo,r=n.ProductCategoryId,i=n.ProductId;if(33==r||34==r||41==r||42==r){var o="\u56fd\u5185\u6e38\u5b66";34==r?o="\u51fa\u5883\u6e38\u5b66":41==r?o="\u56fd\u5185\u5fae\u6e38\u5b66":42==r&&(o="\u51fa\u5883\u5fae\u6e38\u5b66");var s="RN"===e.Platform?"pkg_youxue_protype_APP":"pkg_youxue_protype_h5",c="type="+o+"&productid="+i;e.tracelog(s,c)}},it=function(){var t=a.getState(),n=t.BasicInfo,r=t.pageStatus,i="RN"===e.Platform?"pkg_dtl_loading_app":"pkg_dtl_loading_h5",o={pkgid:n.ProductId,stcityid:n.DepartureId,slcityid:n.SaleCityId,pagebu:r.prodType};e.tracelog(i,o)},at=function(){var e=a.getState(),t=e.BookInfo,n=e.ScheduleInfo;t.IsBook&&n&&n.HasInventory||st({operation:"\u9875\u9762\u52a0\u8f7d",messageid:"vac_0080",message:"\u5df2\u552e\u5b8c"})},ot=function(){var e=a.getState(),t=e.BookInfo;t.IsActive||st({operation:"\u9875\u9762\u52a0\u8f7d",messageid:"vac_0079",message:"\u62b1\u6b49\uff0c\u8be5\u4ea7\u54c1\u65e0\u6548"})},st=function(t){var n=a.getState(),r=n.BasicInfo,i=n.pageId,o="vacation_usershoppinginterruption_vac",s={businessline:r.isPureDiyfhxsdp?"sdp1.0":"grp",merchandiseid:r.ProductId,startcity:r.DepartureId,pageid:i,operation:t.operation,messageid:t.messageid,message:t.message};e.tracelog(o,s)},ct=function(){var t=a.getState(),n=t.BasicInfo,r=t.query,i=n.DepartureId;if(i!=r.departcityid&&r.departcityid){var o="pkg_detail_url_unmatch_city",s={pkgid:n.ProductId,departcityid:r.departcityid,citycode:i};e.tracelog(o,s)}},lt=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n,r){var i,s,c,l,u;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=a.getState(),s=i.BasicInfo,t.next=3,e.loadStorage("TOUR_DETAIL_JUMP_CALENDAR","tour");case 3:c=t.sent,"H5"===e.Platform?e.remove({key:"TOUR_DETAIL_JUMP_CALENDAR",domain:"tour"}):e.Storage.remove({key:"TOUR_DETAIL_JUMP_CALENDAR",domain:"tour"}),l="pkg_detail_change_city",u={pkgid:s.ProductId,cityname_original:n,citycode:r,yes_or_no:c?1:0},e.tracelog(l,u);case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ut=function(){var t=a.getState(),n=t.LocationInfo,r=t.query,i="grp_detail_switchpop_expo",o=Number(null===n||void 0===n?void 0:n.departureCityId)||0,s=Number(null===n||void 0===n?void 0:n.locationCityId)||0,c={departcityid:r.departcityid,citycode:o,geo_cityid:s,sourcetype:0};e.tracelog(i,c)},dt=function(t){var n="grp_detail_switchcity_expo",r={sourcetype:t};e.tracelog(n,r)},ft=function(){var t="grp_detail_swtichtoast_expo",n={};e.tracelog(t,n)},pt=function(t){var n=a.getState(),r=n.actionIdSuffix,i=n.BasicInfo,o=n.pageId,s=n.pageStatus,c="".concat(r,"-picture-more-").concat(i.ProductId,"-").concat(t);e.traceKeyLog({event_value:c,event_bu:s.prodType,page_id:o})},mt=function(){var t=a.getState(),n=t.actionIdSuffix,r=t.pageId,i=t.pageStatus,o="".concat(n,"-info-star");e.traceKeyLog({event_value:o,event_bu:i.prodType,page_id:r})},It=function(t){var n=a.getState(),r=n.actionIdSuffix,i=n.pageId,o=n.pageStatus,s="".concat(r,"-popups-switch-").concat(t,"-0");e.traceKeyLog({event_value:s,event_bu:o.gprodType,page_id:i}),ht({sceneType:2,isAccept:"\u5173\u95ed"===t,selectedCity:"\u5173\u95ed"!==t})},ht=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,c,l,u,d,f,p,m,I,h=arguments;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=h.length>0&&void 0!==h[0]?h[0]:{},r=n.sceneType,i=void 0===r?1:r,s=n.isAccept,c=void 0===s||s,l=n.selectedCity,u=void 0!==l&&l,d=a.getState(),f=d.LocationInfo,p=d.pageStatus,m=d.query,f=f||{},I={ProductId:p.activeProductId,UrlDepartureCityId:m.departcityid?m.departcityid:0,LocationCityId:f.locationCityId?f.locationCityId:0,CacheCityId:f.departureCityId?f.departureCityId:0,SceneType:i,IsAccept:c,RecommendType:f.locationCityId?3:f.departureCityId?2:m.departcityid?5:u?6:4},t.prev=4,t.next=7,e.post("DepartureCityMetric",I);case 7:t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](4),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[4,9]])})));return function(){return t.apply(this,arguments)}}(),gt=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(){var n,r,i,s,l,u,d,f,p,m,I;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("RN"===e.Platform){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,n=a.getState(),r=n.query,i=n.isSecKill,s=r.productid,l=r.departcityid,!i){t.next=7;break}return t.abrupt("return");case 7:return u="getProductInfo",d="\n            query getProductInfo($params: ProductArgs!) {\n                productInfo(params: $params) {\n                  BookInfo {\n                    json\n                  }\n                  ScheduleInfo {\n                    json\n                  }\n                }\n              }\n            ",t.next=11,e.Business.doBusinessJobPromise(9,"80052",{},(new Date).valueOf().toString());case 11:f=t.sent,p=f.className,m=f.ref,I={params:(0,c.Z)({ProductId:Number(s),DepartureCityId:Number(l||0),HeadTagList:[{Key:"pageReference",Value:m||p||""}]},e.attachShardParams())},e.gqlpost(d,I,u),t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](2),console.log(t.t0);case 21:case"end":return t.stop()}}),t,null,[[2,18]])})));return function(){return t.apply(this,arguments)}}(),vt=function(){var t=a.getState(),n=t.query,r=t.TourGroupInfo,i=t.pageStatus,o=t.BasicInfo;if(n.ctm_ref){var s=o.ProductId;if(i&&i.isMultiLine&&r&&r.TourGroupProductInfo){var c=r.TourGroupProductInfo;c&&c[0]&&(s=c[0].ProductId)}e.set("ctm_ref_".concat(s),n.ctm_ref,28800)}},xt=function(){try{var t=a.getState(),n=t.query;n.traceid?e.set("UrlQueryTraceId",n.traceid,86400):e.remove("UrlQueryTraceId")}catch(e){console.log(e)}},St=function(){var t="grp_prddtl_priceribbon_click",n={};e.tracelog(t,n)},Tt=function(t){var n=t.scene,r=t.value,i=a.getState(),o=i.BasicInfo;e.sendKMLog({attrs:[{key:"productId",value:o.ProductId}],scene:n,action:"usr_click",value:r})},Pt=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n,r){var i,s,c,l,u;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=a.getState(),s=i.BasicInfo,i.pageStatus,c={trackInfoType:{trackSBUType:s.isDiyfhxsdp?"FreeTour":"TeamTour",trackType:"WishOrder",trackFromType:"H5",trackSubChannel:9,orderUserType:{contactName:n.nameInput,contactPhone:n.phoneInput,intCode:String(r.code)},trackOrderType:{trackProductType:{productId:s.ProductId,startCityId:s.DepartureId,destName:s.DestCityName,saleMode:s.SaleMode,productPatterns:[{id:s.isDiyfhxsdp?2:1,name:s.isDiyfhxsdp?"\u81ea\u7531\u884c":"\u8ddf\u56e2\u6e38"}]},remark:n.textInput}}},t.prev=2,t.next=5,e.post("CreateTrack",c);case 5:return l=t.sent,u=l.ResponseStatus,t.abrupt("return","Success"===u.Ack);case 10:return t.prev=10,t.t0=t["catch"](2),console.log(t.t0),t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,n){return t.apply(this,arguments)}}(),yt=function(e){if(!e||!e.dailyMinPrice)return{};var t=e.dailyMinPrice,n={};return Object.entries(t).forEach((function(e){var t=(0,h.Z)(e,2),r=(t[0],t[1]);if(r&&r.productPrices&&r.productPrices[0]){var i=r.productPrices[0];if(i&&i.alias){var a=i.alias,o=(i.date,i.displayPrice);if(n[a]){var s=n[a].displayPrice;o>0&&o<s&&(n[a]=i)}else n[a]=i}}})),n};return{store:a,actions:(0,c.Z)((0,c.Z)({},l),{},{fetchCurrentLimiting:k,fetchRefreshSecKillBookInfo:L,fetchProductBasicInfo:B,fetchProductSecondInfo:W,setPageId:Je,checkLoginStatusUpdate:Pe,getLocationInfo:De,fetchSecondScreen:Y,getABTestResult:Ke,handlers:we,traceInitLogs:Qe,checkShouldChangeDepartCity:Re,refreshSelectedLine:Ye,fetchCruiseRoomInfo:Q,fetchOvaryRoomPrice:te,fetchCruiseJourneyInfo:X,fetchInitCruiseInfo:J,loginCallback:be,sendKMLog:e.sendKMLog,traceKMInterruption:S,checkNewProcessSelectedDateAvailable:Fe,checkShouldChangeSelectDate:Me,fetchCityNameByCityId:xe,fetchProductDisposition:le,formatServiceUrlForPhotoBrowser:qe,setUserInfo:je,fetchRefreshPriceInfo:E,fetchCruiseTourDetail:ye,fetchServicePersonDetail:ae,sendPV:e.sendPV,ut:{fetchVipMemberInfo:ue,fetchCreateFavorite:fe,fetchCancelFavorite:pe,fetchCityNameByCityId:xe,fetchCruiseRoomInfo:Q,fetchCruiseJourneyInfo:X,fetchOvaryRoomPrice:te}})}})),$=n(2269);function J(){var e,t=Y.useState((function(e){var t=e.actionIdSuffix,n=e.BasicInfo,r=e.currentRouteInfo;return{actionIdSuffix:t,BasicInfo:n,currentRouteInfo:r}})),n=(t.actionIdSuffix,t.BasicInfo),r=t.currentRouteInfo,i=Y.useActions().handlers.handleTraceLog,a=n||{},o=a.isDiyfhxsdp,s=(0,g.useState)(!1),c=(0,h.Z)(s,2),l=c[0],u=c[1],d=(0,g.useState)(0),f=(0,h.Z)(d,2),p=f[0],m=f[1],I=(0,g.useRef)(0),T=(0,g.useRef)(!1),P="\u987b\u77e5",y=r.Visa;if(([11,12,26,34].includes(n.ProductCategoryId)||n.isCruise)&&y){var w=y.VisaCountryList,C=y.VisaDescList;if(w&&w.length||C&&C.length){var N="\u7b7e\u8bc1";53===n.DestProvinceId&&(N="\u5165\u53f0\u8bc1"),[58,59].indexOf(n.DestCityId)>-1&&(N="\u7b7e\u6ce8"),P="".concat(N,"/\u987b\u77e5")}}e=o?[{text:"\u7279\u8272",ele:"#FakeProductSummary"},{text:"\u63a8\u8350\u884c\u7a0b",ele:"#RouteInfo"},{text:"\u8d39\u7528",ele:"#CostDescription"},{text:P,ele:"#OrderKnow"},{text:"\u8bc4\u4ef7",ele:"#Comment"}]:[{text:"\u7279\u8272",ele:"#ProductSummary"},{text:"\u884c\u7a0b",ele:"#RouteInfo"},{text:"\u8d39\u7528",ele:"#CostDescription"},{text:P,ele:"#OrderKnow"},{text:"\u8bc4\u4ef7",ele:"#Comment"}],(0,v.usePageScroll)((function(t){var r,i=t.scrollTop;if(I.current=i,!T.current){var a=null===(r=e[0])||void 0===r?void 0:r.ele,o=x().createSelectorQuery().select(a);o&&o.boundingClientRect((function(e){var t;e&&(t=n.isDiyfhxsdp?e.top-65<0:e.top-150<0,t?!l&&u(!0):l&&(u(!1),m(0)))})).exec(),e.forEach((function(t,n){t.text;var r=t.ele,i=x().createSelectorQuery().select(r);i&&i.boundingClientRect((function(t){if(t){var r=t.top<0;if(r&&n+1<5){var i=x().createSelectorQuery().select(e[n+1]["ele"]);i&&i.boundingClientRect((function(e){if(e){var t=e.top>0&&e.top<(0,v.getSystemInfoSync)().screenHeight-700;t&&p!==n+1&&m(n+1)}})).exec()}}})).exec()}))}}));var D=(0,v.getSystemInfoSync)(),j=D.statusBarHeight,_=(0,v.getMenuButtonBoundingClientRect)(),b=_.top-j,k=_.height+j+55,L=(0,g.useCallback)((function(e,t){T.current=!0;var n=x().createSelectorQuery().select(e);n&&n.boundingClientRect((function(e){if(e){var n=I.current+e.top-k;x().pageScrollTo({scrollTop:n,duration:300,complete:function(){T.current=!1,0===t&&u(!1)}})}})).exec()}),[]);return(0,$.jsx)(S.View,{className:"HeaderBoxNew",style:{visibility:l?"visible":"hidden",top:j+b+_.height},children:(0,$.jsx)(S.View,{className:"HeaderTabBox",children:e.map((function(e,t){var n=e.text,r=e.ele;return(0,$.jsxs)(S.View,{className:"HeaderTabItem ".concat(p===t?"FontWeightBold":""),onClick:function(e){p!==t&&(L(r,t),setTimeout((function(){m(t)}),50)),i("grp_prddtl_ptab_click",{tabid:t+1})},children:[(0,$.jsx)(S.Text,{children:n}),p===t&&(0,$.jsx)(S.View,{className:o&&1===t?"TabBarlineLong":"TabBarline"})]},t)}))})})}var Q=n(33675),X=n.n(Q),ee=g.memo(ne),te=ee;function ne(e){var t=e.isShowHeavyData,n=(0,g.useState)(0),r=(0,h.Z)(n,2),i=r[0],a=r[1],o=(0,v.getSystemInfoSync)(),s=o.windowWidth,l=Y.useState((function(e){var t=e.MediaInfo;return{MediaInfo:t}})),u=l.MediaInfo;if(!u)return null;var d=u.VideoInfoList,f=void 0===d?[]:d,p=u.ImgList,m=void 0===p?[]:p,I="";m&&m.length&&m[0].UrlList&&m[0].UrlList[0]&&(I=m[0].UrlList[0].Value);var T=I.replace("750_420_Q90.jpg","750_750_Q80.webp"),P="";f&&f.length>0&&(P=f[0].PlayUrl),T||(T="https://pic.c-ctrip.com/vacation_v2/h5/group_travel/pic_none.png");var y=(0,g.useState)({coverImageUrl:T,originalCoverImageUrl:I,isHighQualityCoverImageReady:!1,videoUrl:P,isReady:!1,isPlaying:!1,isAutoplay:!1}),w=(0,h.Z)(y,2),C=w[0],N=w[1];return(0,g.useEffect)((function(){if(C.videoUrl)if(C.isReady){if(t&&C.isHighQualityCoverImageReady&&I!==C.coverImageUrl){var e=(0,c.Z)((0,c.Z)({},C),{},{coverImageUrl:I});N(e)}x().getNetworkType({success:function(e){var t=e.networkType,n="wifi"===t;if(n&&!C.isAutoplay){var r=(0,c.Z)((0,c.Z)({},C),{},{isAutoplay:!0});N(r)}}})}else setTimeout((function(){var e=(0,c.Z)((0,c.Z)({},C),{},{isReady:!0});N(e)}),1e3)}),[t,C]),(0,$.jsxs)(S.View,{className:"ImageInfoBox",children:[!C.isPlaying&&(0,$.jsx)(S.View,{className:"PicAndVideoTop",children:(0,$.jsx)(de,{imgIndex:i,setImgIndex:a})}),(0,$.jsx)(S.View,{style:{minHeight:s,marginBottom:-80},children:(0,$.jsx)(re,{isShowHeavyData:t,mediaSetting:C,changeMediaSetting:N,setImgIndex:a,imgIndex:i,isPlaying:C.isPlaying})}),!C.isPlaying&&(0,$.jsxs)(S.View,{className:"bottomIndex",children:[(0,$.jsx)(S.View,{className:"MaskBgGradient"}),(0,$.jsx)(S.View,{className:"maskSecondPart"})]}),(0,$.jsx)(oe,{})]})}var re=g.memo(ie);function ie(e){var t,n=e.isShowHeavyData,r=e.mediaSetting,i=e.changeMediaSetting,a=e.setImgIndex,o=e.imgIndex,s=(e.isPlaying,(0,v.getSystemInfoSync)()),l=s.windowWidth,u=Y.useActions().handlers.handleGoPicList,d=Y.useState((function(e){var t=e.MediaInfo,n=e.pageId,r=e.actionIdSuffix;return{MediaInfo:t,pageId:n,actionIdSuffix:r}})),f=d.MediaInfo,p=(d.pageId,d.actionIdSuffix),m=f||{},I=m.ImgList,h=void 0===I?[]:I,T=m.VideoInfoList;if(!h||!h.length)return(0,$.jsx)(S.View,{children:(0,$.jsx)(S.View,{className:"ImageInfoPicContainer",children:(0,$.jsx)(S.Image,{lazyLoad:!0,className:"ImageInfoPic",mode:"widthFix",src:"https://pic.c-ctrip.com/vacation_v2/h5/group_travel/pic_none.png"})})});var P=(0,g.useCallback)((function(){var e=x().createVideoContext("video");if(e&&(e.pause(),r.isPlaying)){var t=(0,c.Z)((0,c.Z)({},r),{},{isPlaying:!1});i(t)}}),[r]),y=null===(t=h[0])||void 0===t||null===(t=t.UrlList[0])||void 0===t?void 0:t.Value,w=(y.replace("750_420_Q90.jpg","750_750_Q80.webp"),T&&T.length&&T[0]||{}),C=w.ImageUrl;C&&(C=C.replace("750_420_Q90.jpg","750_750_Q80.webp"));var N=[{UrlList:[{Value:r.coverImageUrl}]}];return n&&r.isHighQualityCoverImageReady&&(N=h),(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(S.Image,{mode:"widthFix",src:r.originalCoverImageUrl,style:{width:1,height:1,visibility:"hidden",position:"absolute"},onLoad:function(){if(!r.isHighQualityCoverImageReady){var e=(0,c.Z)((0,c.Z)({},r),{},{isHighQualityCoverImageReady:!0});i(e)}}}),(0,$.jsxs)(S.Swiper,{className:"ImageInfoSwiper_New",circular:!0,autoplay:!1,onChange:function(e){var t=e.detail.current;a(t),P()},current:o,onClick:function(e){u(),X().uploadUserAction(e,"".concat(p,"-picture-more"))},children:[r.isReady&&(0,$.jsxs)(S.SwiperItem,{children:[(0,$.jsx)(S.View,{className:"videoPlayingImgMask",style:{background:"black"}}),(0,$.jsx)(ae,{mediaSetting:r,changeMediaSetting:i,VideoImageUrl:C})]}),N.map((function(e,t){var n,r,i,a=null===e||void 0===e||null===(n=e.UrlList[0])||void 0===n?void 0:n.Value;return a=null===(r=a)||void 0===r?void 0:r.replace("750_420_Q90.jpg","750_750_Q80.webp"),a=null===(i=a)||void 0===i?void 0:i.replace("750_420_Q90.png","750_750_Q80.webp"),(0,$.jsx)(S.SwiperItem,{children:(0,$.jsx)(S.View,{className:"ImageInfoPicContainer",children:(0,$.jsx)(S.Image,{className:"ImageInfoPic",mode:"widthFix",style:{height:l},src:a})})},t)}))]})]})}function ae(e){var t=e.mediaSetting,n=e.changeMediaSetting,r=e.VideoImageUrl,i=(0,v.getSystemInfoSync)(),a=i.windowWidth,o=Y.useState((function(e){var t=e.pageId,n=e.actionIdSuffix;return{pageId:t,actionIdSuffix:n}})),s=(o.pageId,o.actionIdSuffix);return(0,$.jsx)($.Fragment,{children:(0,$.jsx)(S.View,{className:"ImageInfoPicContainer SwiperItemVideoPlayer",onClick:function(e){X().uploadUserAction(e,"".concat(s,"-picture-video")),e.stopPropagation()},children:(0,$.jsx)(S.Video,{style:{width:"100%",height:.56*a},id:"video",playBtnPosition:"center",showPlayBtn:!0,enableProgressGesture:!1,muted:!0,showMuteBtn:!0,src:t.videoUrl,poster:r||t.coverImageUrl,controls:!0,autoplay:t.isAutoplay&&t.isReady,loop:!1,onPlay:function(e){if(!t.isPlaying){var r=(0,c.Z)((0,c.Z)({},t),{},{isPlaying:!0});n(r)}},onPause:function(){if(t.isPlaying){var e=(0,c.Z)((0,c.Z)({},t),{},{isPlaying:!1});n(e)}},onEnded:function(){if(t.isPlaying){var e=(0,c.Z)((0,c.Z)({},t),{},{isPlaying:!1});n(e)}}})})})}function oe(){var e=Y.useState((function(e){var t=e.BasicInfo,n=e.pageStatus,r=e.VendorInfo;return{BasicInfo:t,pageStatus:n,VendorInfo:r}})),t=e.BasicInfo;e.pageStatus,e.VendorInfo;return t?(0,$.jsx)(S.View,{className:"productInfoBigPicBox",children:(0,$.jsxs)(S.View,{style:{position:"relative",zIndex:1},children:[(0,$.jsx)(se,{}),(0,$.jsx)(le,{}),(0,$.jsx)(ce,{})]})}):null}function se(){var e=Y.useState((function(e){var t=e.BasicInfo,n=e.VendorInfo,r=e.brandScore;return{BasicInfo:t,VendorInfo:n,brandScore:r}})),t=e.BasicInfo,n=e.VendorInfo,r=e.brandScore,i=Y.useActions().handlers,a=i.handleGoShopDetail,o=i.handleTraceLog,s=t.IsInternal,c=t.ProductPatternId,l=!1;!s||1!==c&&3!==c&&4!==c||(l=!0);var u="S"===t.SaleMode,d=(null===r||void 0===r?void 0:r.shopInfo)||{},f=d.storeType,p=f&&1===f.storeTypeId,m=!0;return(t.isDiyfhxsdp||t.isStudy)&&(m=!1),"G"===t.SaleMode&&(m=!1),(0,$.jsx)($.Fragment,{children:(0,$.jsxs)(S.View,{className:"SupplierWithIdContainer",children:[(0,$.jsx)(S.View,{onClick:function(){m&&(a(),o("grp_prddtl_shoptag_click"))},style:{display:"flex"},children:u?l?(0,$.jsx)(S.Image,{style:{width:119,height:16},src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/salebyself@3x.png"}):(0,$.jsx)(S.Image,{style:{width:69,height:16},src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/salebyself_normal.png"}):(0,$.jsxs)(S.View,{className:"shopNameContainer",children:[!!p&&(0,$.jsx)(S.Image,{style:{width:64,height:17},src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/title_goldshop.png"}),(0,$.jsx)(S.View,{className:"supplierShowInfo",children:(0,$.jsx)(S.Text,{className:p?"SupplierBgGoldShop":"SupplierBg",children:!!n&&(n.VendorBrand||n.VendorName)})})]})}),(0,$.jsxs)(S.Text,{className:"productidMargin",onClick:function(){x().setClipboardData({data:String(t.ProductId),success:function(e){x().showToast({title:"\u4ea7\u54c1\u7f16\u53f7\u5df2\u590d\u5236\u5230\u526a\u8d34\u677f",duration:2e3,icon:"none"})}})},children:["\u7f16\u53f7 ",t.ProductId]})]})})}function ce(){var e=(0,v.getSystemInfoSync)(),t=(e.windowWidth,Y.useState((function(e){var t=e.BasicInfo,n=e.query,r=e.CompositePromotionInfo,i=e.currentRouteInfo,a=e.MarketingInfo,o=e.actionIdSuffix,s=e.pageStatus,c=e.isShowMemberDiscountInfo,l=e.isShowFlightDiscountInfo,u=e.userInfo,d=e.PriceInfo,f=e.pageId;return{BasicInfo:t,query:n,CompositePromotionInfo:r,currentRouteInfo:i,MarketingInfo:a,actionIdSuffix:o,pageStatus:s,isShowMemberDiscountInfo:c,isShowFlightDiscountInfo:l,userInfo:u,PriceInfo:d,pageId:f}}))),n=t.BasicInfo,r=(t.query,t.CompositePromotionInfo,t.currentRouteInfo,t.MarketingInfo,t.actionIdSuffix),i=t.pageStatus,a=(t.isShowMemberDiscountInfo,t.isShowFlightDiscountInfo),o=(t.userInfo,t.PriceInfo),s=(t.pageId,Y.useActions().handlers),c=s.handleTogglePriceTipMask,l=(s.handleGoTagUrl,s.handleGoMemberShip),u=s.handleGoFlightDiscountPage,d=s.handleToggleDiscountDetailMask,f=s.handleTraceLog,p=(o.MinPrice,o.MinPriceRemark),m=(o.OriginPrice,o.DisplayPrice),I=o.PreferentialPriceDetail,h=(i.isCruise,n.OrderPersonCount),x=(n.PersonsAnnual,n.PersonsMonth,h>0?"\u5df2\u552e".concat(h,"\u4eba"):""),T=fe(),P=T.isMemberPrice,y=(T.backgroundImage,T.fontColor),w=T.priceTitle,C=(T.discountInfoColor,[]),N=0,D=!1;if(I){var j=I.PreferentialAmountDetails,_=I.PreferentialPriceItems;I.UserDetail;_&&(_.forEach((function(e){C.some((function(t){return t.PreferentialTitle===e.PreferentialTitle}))||C.push(e)})),N=j&&j[0]&&j[0].PreferentialAmount,D=N>0)}return(0,g.useEffect)((function(){try{var e="";if(D){var t=I.PreferentialPriceItems;t&&t.length&&(e=t.map((function(e){return e.PreferentialTitle})).join(","))}f("grp_prddtl_discntprice_expo",{isdiscount:D?1:0,disctprice:m,discnt:N,discnttagtype:e,cityname:n.DestCityName})}catch(e){console.log(e)}}),[]),P?D&&I?(0,$.jsx)(S.View,{className:"NewProfileSpecialTagContainer",style:{display:"flex"},onClick:function(){a?u():l()},children:(0,$.jsx)(S.View,{className:"NewProfilePriceBox",children:(0,$.jsxs)(S.View,{className:"NewProfileMemberPriceInfo",children:[(0,$.jsxs)(S.View,{className:"NewProfilePriceFirstLine",children:[m>0?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(S.Text,{className:"ProfilePriceIconBigPic",children:"\uffe5"}),(0,$.jsx)(S.Text,{className:"ProfilePricePanelPriceNumVipBigPic",children:m}),(0,$.jsx)(S.Text,{className:"ProfilePriceText",children:"/\u4eba\u8d77"})]}):(0,$.jsx)(S.Text,{className:"NewProfilePriceNone",children:"\u5b9e\u65f6\u8ba1\u4ef7"}),(0,$.jsxs)(S.View,{className:"NewdiscountPriceMemberTagBox NewdiscountPriceTagBox NewdiscountPriceTagItemLast",onClick:function(e){e.stopPropagation(),d(!0),f("grp_prddtl_discnt_click")},children:[N>0&&(0,$.jsxs)(S.View,{className:"NewdiscountPriceDiscount",children:[(0,$.jsxs)(S.Text,{style:{color:"rgb(255, 119, 0)",fontSize:12,fontWeight:"bold"},children:["\u5df2\u51cf",N]}),(0,$.jsx)(S.View,{className:"NewdetaildiscountPriceTagIcon"})]}),C.length>0&&(0,$.jsx)(S.View,{className:"displayPreferentialPriceItemsBox",children:C.map((function(e,t){var n=e.PreferentialTitle,r=t+1===C.length;return(0,$.jsxs)(g.Fragment,{children:[(0,$.jsx)(S.View,{className:"NewdiscountPriceTagItem",children:(0,$.jsx)(S.Text,{style:{color:"rgb(255, 119, 0)",fontSize:12,fontWeight:"bold"},children:n})}),r?(0,$.jsx)(S.Text,{className:"PreferentialDetailIcon",children:"\uebc3"}):(0,$.jsx)(S.Text,{className:"discountPriceTagPoint",children:"."})]},t)}))})]})]}),!!x&&(0,$.jsx)(S.View,{className:"NewProfileTravelCountTex",children:(0,$.jsx)(S.Text,{className:"fontsize-20",style:{color:y.count},children:x})})]})})}):(0,$.jsx)(S.View,{className:"NewProfileSpecialTagContainer",style:{display:"flex"},onClick:function(){a?u():l()},children:(0,$.jsx)(S.View,{className:"NewProfilePriceBox",children:(0,$.jsxs)(S.View,{className:"NewProfileMemberPriceInfo",children:[(0,$.jsxs)(S.View,{className:"NewProfilePriceFirstLine",children:[(0,$.jsxs)(S.Text,{className:"fontsize-20",style:{color:y.price},children:[w,"\xa0"]}),m>0?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(S.Text,{className:"ProfilePriceIconBigPic",children:"\uffe5"}),(0,$.jsx)(S.Text,{className:"ProfilePricePanelPriceNumVipBigPic",children:m}),(0,$.jsx)(S.Text,{className:"ProfilePriceText",children:"/\u4eba\u8d77"})]}):(0,$.jsx)(S.Text,{className:"NewProfilePriceNone",children:"\u5b9e\u65f6\u8ba1\u4ef7"})]}),(0,$.jsxs)(S.View,{className:"NewProfilePriceSecondLine",children:[!!p&&(0,$.jsx)(S.Text,{className:"NewProfilePriceIcon",style:{color:y.price},onClick:function(e){e.stopPropagation(),c(!0),X().uploadUserAction(e,"".concat(r,"-info-policy"))},children:"\ue931"}),!!x&&(0,$.jsx)(S.View,{className:"NewProfileTravelCountTex",children:(0,$.jsx)(S.Text,{className:"fontsize-20",style:{color:y.count},children:x})})]})]})})}):(0,$.jsx)($.Fragment,{children:(0,$.jsx)(S.View,{className:"NewProfilePriceBox",children:(0,$.jsxs)(S.View,{className:"NewProfilePriceInfo",children:[m>0?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(S.Text,{className:"ProfilePriceIconBigPic",children:"\uffe5"}),(0,$.jsx)(S.Text,{className:"ProfilePricePanelPriceNumVipBigPic",children:m}),(0,$.jsx)(S.Text,{className:"ProfilePriceText",children:"/\u4eba\u8d77"})]}):(0,$.jsx)(S.Text,{className:"NewProfilePriceNone",children:"\u5b9e\u65f6\u8ba1\u4ef7"}),!!p&&!D&&(0,$.jsx)(S.Text,{className:"NewProfilePriceIcon",style:{top:2},onClick:function(e){c(!0),X().uploadUserAction(e,"".concat(r,"-info-policy"))},children:"\ue931"}),D&&(0,$.jsxs)(S.View,{className:"NewdiscountPriceTagBox NewdiscountPriceTagItemLast",onClick:function(){d(!0),f("grp_prddtl_discnt_click")},children:[N>0&&(0,$.jsxs)(S.View,{className:"NewdiscountPriceDiscount",children:[(0,$.jsxs)(S.Text,{style:{color:"rgb(255, 119, 0)",fontSize:12,fontWeight:"bold"},children:["\u5df2\u51cf",N]}),(0,$.jsx)(S.View,{className:"NewdetaildiscountPriceTagIcon"})]}),C.length>0&&(0,$.jsx)(S.View,{className:"displayPreferentialPriceItemsBox",children:C.map((function(e,t){var n=e.PreferentialTitle,r=t+1===C.length;return(0,$.jsxs)(g.Fragment,{children:[(0,$.jsx)(S.View,{className:"NewdiscountPriceTagItem",children:(0,$.jsx)(S.Text,{style:{color:"rgb(255, 119, 0)",fontSize:12,fontWeight:"bold"},children:n})}),r?(0,$.jsx)(S.Text,{className:"PreferentialDetailIcon",children:"\uebc3"}):(0,$.jsx)(S.Text,{className:"discountPriceTagPoint",children:"."})]},t)}))})]}),!!x&&(0,$.jsx)(S.View,{children:(0,$.jsx)(S.Text,{className:"NewProfileTravelCountTex",children:x})})]})})})}function le(){var e,t=Y.useState((function(e){var t=e.BasicInfo,n=e.currentRouteInfo,r=e.pageId,i=e.actionIdSuffix;return{BasicInfo:t,currentRouteInfo:n,pageId:r,actionIdSuffix:i}})),n=t.BasicInfo,r=(t.currentRouteInfo,t.pageId,t.actionIdSuffix),i=Y.useActions().handlers.handleGoStarInfo,a=n.isStudy;return n.Level>0&&(e="https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/bigpic/star_".concat(n.Level,"_new.png")),(0,$.jsxs)(S.View,{children:[(0,$.jsx)(S.Text,{className:"NewProfileMainNameText",children:a?n.Title:n.MainName}),n.Level>0&&(0,$.jsx)(S.Image,{className:"ProfileStarContainerBigPic ProfileStarBigPicImg",src:e,onClick:function(e){i(),X().uploadUserAction(e,"".concat(r,"-info-star"))}}),(0,$.jsx)(ue,{})]})}function ue(){var e=Y.useState((function(e){return e.currentRouteInfo})),t=e.TagGroupInfo;if(!t)return null;var n=t.StudyCharacterTagList||[];if(!n.length)return null;var r=n.filter((function(e){return 1248===e.TagId})).length>0,i=n.filter((function(e){return 1249===e.TagId})).length>0;return(0,$.jsxs)(S.Text,{children:[r&&(0,$.jsxs)(S.Text,{className:"StudyGoldIcon",children:[(0,$.jsx)(S.Text,{className:"StudyGoldIconFont",children:"\ue509"}),(0,$.jsx)(S.Text,{className:"StudyGoldIconText",children:"\u91d1\u724c\u8425"})]}),i&&(0,$.jsxs)(S.Text,{className:"StudySilverIcon",children:[(0,$.jsx)(S.Text,{className:"StudySilverIconFont",children:"\ue509"}),(0,$.jsx)(S.Text,{className:"StudySilverIconText",children:"\u94f6\u724c\u8425"})]})]})}function de(e){var t=e.imgIndex,n=e.setImgIndex,r=Y.useState((function(e){var t=e.MediaInfo;return{MediaInfo:t}})),i=r.MediaInfo,a=i.ImgList,o=void 0===a?[]:a,s=o.length,c=i&&i.VideoInfoList&&i.VideoInfoList.length>0,l=c&&0===t;l?"\u89c6\u9891 ".concat(t+1,"/").concat(s):"\u56fe\u7247 ".concat(t+1,"/").concat(s);return o.length<=0?null:(0,$.jsxs)(S.View,{className:"ImageInfoPicIndex",children:[c&&(0,$.jsx)(S.View,{className:l?"videoCur":"",children:(0,$.jsx)(S.Text,{style:{fontSize:12,color:l?"#333":"#fff"},onClick:function(){n(0)},children:"\u89c6\u9891"})}),(0,$.jsx)(S.View,{children:(0,$.jsxs)(S.Text,{style:{fontSize:12,color:!c||l?"#fff":"#333"},className:c&&!l?"picCur":"",onClick:function(){n(1)},children:["\u56fe\u7247",!l&&"".concat(c?t:t+1,"/").concat(i.ImgList.length)]})})]})}function fe(){var e=Y.useState((function(e){var t=e.isShowMemberDiscountInfo,n=e.isShowFlightDiscountInfo,r=e.userInfo;return{isShowMemberDiscountInfo:t,isShowFlightDiscountInfo:n,userInfo:r}})),t=e.isShowMemberDiscountInfo,n=e.isShowFlightDiscountInfo,r=e.userInfo,i={isMemberPrice:!1,backgroundImage:"",fontColor:{title:"",price:"",count:""},discountInfoColor:{border:"",font:"",discountText:"",discountBg:""},priceTitle:""};if(!t&&!n)return i;if(!r||!r.ExtendInfo)return i;var a=r.ExtendInfo,o=a.VipGrade,s=a.LevelName;i.isMemberPrice=!0,t&&(i.priceTitle=s+"\u4ef7"),n&&(i.priceTitle="\u673a\u7968\u7528\u6237\u4e13\u4eab\u4ef7");var c={20:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/vip/pricebg_20.png",30:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/vip/pricebg_30.png",35:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/vip/pricebg_35.png",40:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/vip/pricebg_40.png",flightCross:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/vip/pricebg_flight.png"},l={20:{title:"rgb(255, 255, 255)",price:"rgb(255, 255, 255)",count:"rgba(255, 255, 255, 0.6)"},30:{title:"rgb(248, 228, 195)",price:"rgb(250, 229, 193)",count:"rgba(248, 228, 195,0.6)"},35:{title:"rgb(255, 240, 215)",price:"rgb(250, 229, 193)",count:"rgba(248, 228, 195,0.6)"},40:{title:"rgb(255, 240, 215)",price:"rgb(250, 229, 193)",count:"rgba(248, 228, 195,0.6)"},flightCross:{title:"rgb(255, 255, 255)",price:"rgb(255, 255, 255)",count:"rgba(255, 255, 255,0.6)"}},u={20:{border:"rgb(255, 255, 255)",font:"rgb(255, 255, 255)",discountText:"rgb(88, 153, 174)",discountBg:"linear-gradient(90deg, rgb(228, 251, 251) 0%, rgb(220, 242, 249) 100%)"},30:{border:"rgb(255, 255, 255)",font:"rgb(255, 255, 255)",discountText:"rgb(62, 69, 137)",discountBg:"linear-gradient(90deg, rgb(217, 220, 247) 0%, rgb(210, 213, 247) 100%)"},35:{border:"rgb(255, 255, 255)",font:"rgb(255, 255, 255)",discountText:"rgb(62, 69, 137)",discountBg:"linear-gradient(-255.34deg, rgb(217, 224, 244) 0%, rgb(197, 207, 239) 100%)"},40:{border:"rgb(250, 229, 193)",font:"rgb(250, 229, 193)",discountText:"rgb(72, 72, 72)",discountBg:"linear-gradient(90deg, rgb(255, 245, 226) 0%, rgb(241, 221, 188) 100%)"},flightCross:{border:"rgb(255, 255, 255)",font:"rgb(255, 255, 255)",discountText:"rgb(12, 121, 235)",discountBg:"linear-gradient(90deg, rgb(233, 243, 255) 0%, rgb(208, 231, 255) 100%)"}},d="";return d=n?"flightCross":o+"",i.backgroundImage=c[d]||"",i.fontColor=l[d]||{},i.discountInfoColor=u[d]||{},i}function pe(){var e=Y.useState((function(e){var t=e.BasicInfo,n=e.suggestInfo,r=e.bookingRuleInfo,i=e.actionIdSuffix,a=e.pageId;return{BasicInfo:t,suggestInfo:n,bookingRuleInfo:r,actionIdSuffix:i,pageId:a}})),t=e.BasicInfo,n=e.suggestInfo,r=e.bookingRuleInfo,i=e.actionIdSuffix,a=(e.pageId,Y.useActions().handlers.handleGoSuggestDestination),o=t.DestCityName;if(!n||!r)return null;var s=r.bookingRule;if(!s||!s.IsHitTheRule||1!==s.BookingRuleType)return null;var c=n.searchName;return c?(0,$.jsxs)(S.View,{className:"ModuleBox NewDestinationContainer",onClick:function(){a(c),X().uploadUserAction(event,"".concat(i,"-middle-entry"))},children:[(0,$.jsxs)(S.View,{className:"NewDestinationInfoBox",children:[(0,$.jsx)(S.Text,{className:"NewDestinationInfoLimit",children:"\u5f53\u524d\u4ea7\u54c1\u4e0d\u53ef\u8ba2"}),(0,$.jsxs)(S.Text,{className:"NewDestinationInfoDesc FontW600",children:["\u4e0d\u5982\u6765",(0,$.jsx)(S.Text,{className:"FontBlue",children:c}),"\u4f53\u9a8c\u201c",o,"\u98ce\u5149\u201d"]}),(0,$.jsxs)(S.View,{className:"NewDestinationInfoBtn",children:[(0,$.jsx)(S.Text,{className:"NewDestinationInfoBtnText",children:"\u53bb\u770b\u770b"}),(0,$.jsx)(S.Text,{className:"NewDestinationInfoBtnIcon FontW600",children:"\ue944"})]})]}),(0,$.jsx)(S.View,{className:"NewDestinationImgBox",children:(0,$.jsx)(S.Image,{lazyLoad:!0,className:"NewDestinationImg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/destrec.png"})})]}):null}var me=(0,g.forwardRef)(Ie);function Ie(e,t){var n=Y.useState((function(e){var t=e.pageStatus,n=e.TourGroupInfo,r=e.TravelList;return{pageStatus:t,TourGroupInfo:n,TravelList:r}})),r=n.pageStatus,i=n.TourGroupInfo,a=n.TravelList,o=(0,g.useState)("multiRouteId_".concat((null===r||void 0===r?void 0:r.activeProductId)||"")),s=(0,h.Z)(o,2),c=s[0],l=s[1],u=(0,g.useState)("multiTravelAlias_".concat((null===r||void 0===r?void 0:r.activeAlias)||"A")),d=(0,h.Z)(u,2),f=d[0],p=d[1];if((0,g.useImperativeHandle)(t,(function(){return{setMultiRouteId:l,setMultiTravelAlias:p}})),!r)return null;var m=r.isMultiLine,I=r.isMultiTravel;if(!m&&!I)return null;var v,x=i.TourGroupProductInfo,T=void 0===x?[]:x,P=null===T||void 0===T?void 0:T.length;return v=m?P>1&&"".concat(P,"\u4e2a\u5957\u9910"):(null===a||void 0===a?void 0:a.length)>1&&"".concat(null===a||void 0===a?void 0:a.length,"\u4e2a\u5957\u9910"),(0,$.jsxs)(S.View,{className:"MultiRouteContainer_New",id:"Taro_Scroll_To",children:[!!v&&(0,$.jsx)(S.View,{className:"leftSuspend",children:(0,$.jsx)(S.Text,{className:"compressionVersionBText",children:v})}),(0,$.jsx)(S.ScrollView,{scrollX:!0,scrollWithAnimation:!0,scrollIntoView:m?c:f,children:(0,$.jsx)(S.View,{className:"MultiRouteScrollContainer",children:m?(0,$.jsx)(he,{setMultiRouteId:l}):I?(0,$.jsx)(ge,{setMultiTravelAlias:p}):null})})]})}function he(e){var t,n=e.setMultiRouteId,r=Y.useState((function(e){var t=e.groupCard,n=e.pageStatus,r=e.isPremium,i=e.isPreSale,a=e.BasicInfo;return{groupCard:t,pageStatus:n,isPremium:r,isPreSale:i,BasicInfo:a}})),i=r.groupCard,a=r.pageStatus,o=r.isPremium,s=r.isPreSale,c=(r.BasicInfo,Y.useActions().handlers.handleMultiLineChange),l=a.activeProductId,u=i||{},d=u.cards;if(!d||!d.length)return null;d.map((function(e,n){if(e){var r=e.name;/\d/.test(r)||r.includes("+")?r.length>7&&(t=!0):r.length>6&&(t=!0)}}));var f=i.cards.some((function(e){var t=e.preSaleProductInfo;return!!(s&&t&&t.canBook)})),p=we(d);return(0,$.jsx)(g.Fragment,{children:p.map((function(e,r){var i=e.productId,a=e.name,u=e.lineName,d=e.hasPrice,p=e.priceDesc,m=e.preSaleProductInfo,I=e.canBook,h=e.priceInfo,g=l===i,v=h||{},x=v.preferentialPriceDetail,S=v.baseCarMinPrice,T=x||{},P=T.preferentialAmountDetails,y=P&&P[0]&&P[0].preferentialAmount,w=!1;S&&(w=!0);var C=s&&m&&m.canBook;return C?(0,$.jsx)(xe,{isCurrent:g,handleMultiLineChange:c,productId:i,route:u,hasPrice:d,priceDesc:p,description:a,lineOfDescription:t,isPremium:o,preSaleProductInfo:m,setMultiRouteId:n,canBook:I,isCarInfoVerssionB:w,baseCarMinPrice:S,discountPriceInRoute:y},i):(0,$.jsx)($.Fragment,{children:(0,$.jsx)(ve,{isCurrent:g,handleMultiLineChange:c,productId:i,route:u,hasPrice:d,price:p,description:a,lineOfDescription:t,isPremium:o,setMultiRouteId:n,hasAnyPreSale:f,isCarInfoVerssionB:w,baseCarMinPrice:S,discountPriceInRoute:y},i)})}))})}function ge(e){var t=e.setMultiTravelAlias,n=Y.useState((function(e){var t=e.TravelList,n=e.isPremium,r=e.priceCalendarData,i=e.pageStatus,a=e.BasicInfo,o=e.groupCard;return{TravelList:t,isPremium:n,priceCalendarData:r,pageStatus:i,BasicInfo:a,groupCard:o}})),r=n.TravelList,i=n.isPremium,a=n.priceCalendarData,o=n.pageStatus;n.BasicInfo,n.groupCard;if((0,g.useEffect)((function(){u(f)}),[a]),!r)return null;var s,c=Y.useActions().handlers.handleMultiTravelChange,l=Y.useActions(),u=l.SET_MULTITRAVEL_SCHEDATES,d=o.activeAlias;r.map((function(e,t){if(e){var n=e.Name;n.length>7&&(s=!0)}}));var f=Te(a),p=Ce(r);return(0,$.jsx)(g.Fragment,{children:p.map((function(e,n){var r=e.Alias,a=e.Name,o=e.TourInfoId,l=e.isActive,u=e.priceInfo,p=d===r,m=a,I=f[r],h=f.priceInTimeLines.includes(r)?"\u5b9e\u65f6\u8ba1\u4ef7":"";I=I||h;var v=u||{},x=v.baseCarMinPrice,S=!1;return x&&(S=!0),(0,$.jsx)(g.Fragment,{children:(0,$.jsx)(Se,{handleMultiTravelChange:c,Alias:r,isActive:l,isCurrent:p,productId:o,route:r+"\u7ebf",description:m,isPremium:i,lineOfName:s,multiTravelRouteDisplayPrice:I,setMultiTravelAlias:t,isCarInfoVerssionB:S,baseCarMinPrice:x,multiTravelPrice:f})},n)}))})}function ve(e){var t=e.handleMultiLineChange,n=e.productId,r=e.isCurrent,i=void 0===r||r,a=(e.disabled,e.route),c=e.hasPrice,l=void 0!==c&&c,u=e.price,d=e.description,f=e.lineOfDescription,p=e.isPremium,m=e.setMultiRouteId,I=e.hasAnyPreSale,h=void 0!==I&&I,g=e.isCarInfoVerssionB,v=e.baseCarMinPrice,x=e.discountPriceInRoute;return(0,$.jsxs)(S.View,{onClick:(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t(n);case 2:m("multiRouteId_".concat(n));case 3:case"end":return e.stop()}}),e)}))),className:i?p?"MultiRouteInfo_New MultiRouteActive_New_Premium":"MultiRouteInfo_New MultiRouteActive_New":"MultiRouteInfo_New",style:h?{}:{paddingTop:8},children:[(0,$.jsx)(S.View,{className:"ScrollToDestination",id:"multiRouteId_".concat(n)}),(0,$.jsxs)(S.View,{className:"MultiRoutePriceBox",children:[u?l?(0,$.jsxs)(S.Text,{className:"colorPrice_Label2",children:["\xa5",(0,$.jsx)(S.Text,{className:"MultiRoutePrice colorPrice_38",children:u}),(0,$.jsx)(S.Text,{style:{color:"#888"},children:"\u8d77"})]}):(0,$.jsx)(S.Text,{className:"MultiRouteNoPrice",children:u}):null,!!x&&(0,$.jsx)(S.View,{className:"afterPricePromotionBox",children:(0,$.jsxs)(S.Text,{style:{color:"#ff6600",fontSize:11,fontWeight:"bold"},children:["\u5df2\u51cf",x]})})]}),!!g&&(0,$.jsx)(S.View,{style:{marginBottom:0,alignSelf:"flex-start"},children:(0,$.jsxs)(S.Text,{className:"baseCarMinPriceText",children:["\u6ee13\u4eba\u518d\u51cf\xa5",v,"\u8d77"]})}),!!d&&(0,$.jsx)(S.View,{className:"MarginTop4 MultiRouteDescriptionBox",children:(0,$.jsxs)(S.Text,{className:"MultiRouteDescription_New",style:{height:f?33:null},children:[a,(0,$.jsx)(S.Text,{style:{color:"rgba(136,136,136,.8)",marginLeft:2,marginRight:2},children:"|"}),d]})}),(0,$.jsx)(Pe,{productId:n,alias:!1}),!!i&&(0,$.jsx)(S.Image,{className:"currentSelectedRoute",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/bigpic/route_select_icon".concat(p?"_new":"",".png")})]})}function xe(e){var t=e.handleMultiLineChange,n=e.productId,r=e.isCurrent,i=void 0===r||r,a=(e.disabled,e.route),c=e.hasPrice,l=void 0!==c&&c,u=e.priceDesc,d=e.description,f=e.lineOfDescription,p=e.isPremium,m=e.preSaleProductInfo,I=e.setMultiRouteId,h=e.canBook,g=e.isCarInfoVerssionB,v=e.baseCarMinPrice,x=e.discountPriceInRoute;return(0,$.jsxs)(S.View,{onClick:(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t(n);case 2:I("multiRouteId_".concat(n));case 3:case"end":return e.stop()}}),e)}))),className:i?"MultiRouteInfo_New MultiRouteActive_New":"MultiRouteInfo_New",children:[(0,$.jsx)(S.View,{className:"ScrollToDestination",id:"multiRouteId_".concat(n)}),!!i&&(0,$.jsx)(S.Image,{className:"MultiRouteItemPresaleImgBg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/presaledlinebg.png"}),(0,$.jsx)(S.View,{className:i?"CurrentMultiRouteItemPresalePriceBox":"MultiRouteItemPresalePriceBox",children:(null===m||void 0===m?void 0:m.minPrice)>0?(0,$.jsxs)(S.Text,{className:i?"MultiRouteItemPresalePriceTextCur":"MultiRouteItemPresalePriceText",children:["\u9884\u552e\u4ef7\xa5",m.minPrice,"\u8d77"]}):(0,$.jsx)(S.Text,{className:i?"MultiRouteItemPresalePriceTextCur":"MultiRouteItemPresalePriceText",children:"\u9884\u552e\u4ef7\u5b9e\u65f6\u8ba1\u4ef7"})}),(0,$.jsxs)(S.View,{className:"MultiRoutePriceBox",children:[u?(0,$.jsx)(S.View,{children:h?l?(0,$.jsxs)(S.View,{className:"priceDescContainer",children:[(0,$.jsx)(S.Text,{className:"colorPrice_Label2",children:"\xa5"}),(0,$.jsx)(S.Text,{className:"detaiNumFont20THBold colorPrice_38",children:u}),(0,$.jsx)(S.Text,{className:"toUpPosition color3_Label2",children:"\u8d77"})]}):(0,$.jsx)(S.Text,{className:"priceDescNoSale",children:u}):(0,$.jsx)(S.Text,{className:"priceDescNoSale2",children:"\u53ef\u9009\u9884\u552e"})}):null,!!x&&(0,$.jsx)(S.View,{className:"afterPricePromotionBox",children:(0,$.jsxs)(S.Text,{style:{color:"#ff6600",fontSize:11,fontWeight:"bold"},children:["\u5df2\u51cf",x]})})]}),!!g&&(0,$.jsx)(S.View,{style:{marginBottom:0,alignSelf:"flex-start"},children:(0,$.jsxs)(S.Text,{className:"baseCarMinPriceText",children:["\u6ee13\u4eba\u518d\u51cf\xa5",v,"\u8d77"]})}),(0,$.jsx)(S.View,{className:"MarginTop4 MultiRouteDescriptionBox",children:(0,$.jsxs)(S.Text,{className:"MultiRouteDescription_New",style:{height:f?33:null},children:[a,(0,$.jsx)(S.Text,{style:{color:"rgba(136,136,136,.8)",marginLeft:2,marginRight:2},children:"|"}),d]})}),(0,$.jsx)(Pe,{productId:n,alias:!1}),!!i&&(0,$.jsx)(S.Image,{className:"currentSelectedRoute",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/bigpic/route_select_icon".concat(p?"_new":"",".png")})]})}function Se(e){var t=e.handleMultiTravelChange,n=e.Alias,r=(e.productId,e.isCurrent),i=void 0!==r&&r,a=(e.disabled,e.route),c=e.description,l=e.isPremium,u=e.lineOfName,d=e.isActive,f=e.multiTravelRouteDisplayPrice,p=e.setMultiTravelAlias,m=e.isCarInfoVerssionB,I=e.baseCarMinPrice,h=e.multiTravelPrice;return(0,$.jsxs)(S.View,{onClick:(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t(n);case 2:p("multiTravelAlias_".concat(n));case 3:case"end":return e.stop()}}),e)}))),className:i?"MultiTravelInfo_New MultiRouteActive_New":"MultiTravelInfo_New",children:[(0,$.jsx)(S.View,{className:"ScrollToDestination",id:"multiTravelAlias_".concat(n)}),(0,$.jsx)(S.View,{className:"MultiRoutePriceBox",children:d?!!f&&(f>0?(0,$.jsx)($.Fragment,{children:(0,$.jsxs)(S.View,{className:"priceDescContainer",children:[(0,$.jsx)(S.Text,{style:{color:"#ff6600",fontSize:12,fontWeight:"bold"},children:"\xa5"}),(0,$.jsx)(S.Text,{className:"detaiNumFont20THBold",style:{color:"#ff6600",fontSize:20},children:f}),(0,$.jsx)(S.Text,{style:{position:"relative",bottom:2,color:"#888",fontSize:12},children:"\u8d77"}),!!h.allMinPriceDiscount&&Number.isInteger(h.allMinPriceDiscount[n])&&h.allMinPriceDiscount[n]>0&&(0,$.jsx)(S.View,{className:"afterPricePromotionBox",children:(0,$.jsxs)(S.Text,{style:{color:"#ff6600",fontSize:11,fontWeight:"bold"},children:["\u5df2\u51cf",h.allMinPriceDiscount[n]]})})]})}):(0,$.jsx)($.Fragment,{children:(0,$.jsx)(S.Text,{style:{fontSize:16,color:"#ff6600"},className:"priceDescNoSale",children:"\u5b9e\u65f6\u8ba1\u4ef7"})})):(0,$.jsx)(S.View,{className:"multiTravelNoSaleBox",children:(0,$.jsx)(S.Text,{className:"isActiveText",children:"\u6682\u65e0\u53ef\u552e"})})}),!!m&&(0,$.jsx)(S.View,{style:{marginBottom:0,alignSelf:"flex-start"},children:(0,$.jsxs)(S.Text,{className:"baseCarMinPriceText",children:["\u6ee13\u4eba\u518d\u51cf\xa5",I,"\u8d77"]})}),(0,$.jsx)(S.View,{className:"MarginTop8 FlexAlignCenter",style:{width:"100%"},children:(0,$.jsxs)(S.Text,{className:"MultiRouteDescription_New",style:{height:u?33:null},children:[a,!!c&&(0,$.jsx)(S.Text,{style:{color:"rgba(136,136,136,.8)",marginLeft:2,marginRight:2},children:"|"}),c]})}),(0,$.jsx)(Pe,{productId:"multiTravel",alias:n}),!!i&&(0,$.jsx)(S.Image,{className:"currentSelectedRoute",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/bigpic/route_select_icon".concat(l?"_new":"",".png")})]})}var Te=function(e){var t,n={priceInTimeLines:[],everyLineIncludesSchedule:{},allMinPriceDiscount:{}};if(!e)return n;var r=e.dailyMinPrice,i={};return null===(t=Object.values(r))||void 0===t||t.forEach((function(e,t){if(e){var a=e.productPrices,o=a[0]||[],s=o.alias,c=o.displayPrice,l=Object.keys(r)[t];n.everyLineIncludesSchedule[s]?n.everyLineIncludesSchedule[s].push(l):n.everyLineIncludesSchedule[s]=[l],"\u5b9e\u65f6\u8ba1\u4ef7"!==c&&0!==c?n[s]?c>0&&c<n[s]&&(n[s]=c,i[s]=l):(n[s]=c,i[s]=l):n.priceInTimeLines.includes(s)||n.priceInTimeLines.push(s)}})),Object.entries(i).forEach((function(e){if(e&&e[1]&&r[e[1]]){var t=r[e[1]].productPrices;if(t){var i=t[0],a=i.displayPrice,o=i.originalPriceInfo,s=(null===o||void 0===o?void 0:o.originalPrice)-a;n.allMinPriceDiscount[e[0]]=s}}})),n};function Pe(e){var t=e.productId,n=e.alias,r=Y.useState((function(e){var t=e.groupCard;return{groupCard:t}})),i=r.groupCard;if(!i)return null;var a,o=i.cards,s=void 0===o?[]:o;return s.length?(a="multiTravel"===t?s.find((function(e){return e.alias===n})):s.find((function(e){return e.productId===t})),a?(0,$.jsx)(S.View,{className:"distinctionInformationBox",children:!!a.cardItems&&a.cardItems.map((function(e,t){if(!e)return null;var n=e.descItems,r=e.isBest,i=e.groupName,a=e.isHidden,o=e.displayContent;return!n||a?null:(0,$.jsx)(ye,{icon:i,text:o,isBest:r},t)}))}):null):null}function ye(e){var t=e.icon,n=e.text,r=e.isBest,i={"\u4f4f":"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/besttext_zhu.png","\u56e2":"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/besttext_tuan.png","\u6e38":"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/besttext_you.png","\u9910":"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/besttext_can.png","\u6d3b":"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/besttext_huo.png"},a=i[t];return(0,$.jsxs)(S.View,{className:"distinctionText",children:[(0,$.jsx)(S.View,{className:"distinctionIconBox",children:(0,$.jsx)(S.Text,{className:"distinctionTextIcon",style:{position:"relative",bottom:0},children:t})}),(0,$.jsxs)(S.View,{className:"distinctionInfo",children:[(0,$.jsx)(S.Text,{className:"distinctionNoInfoTextColor",children:n}),!!r&&!!a&&(0,$.jsx)(S.Image,{style:{width:33,height:12,paddingLeft:2,position:"relative",top:2},src:a})]})]})}var we=function(e){var t=e.slice();return t.sort((function(e,t){return e.canBook&&!t.canBook?-1:!e.canBook&&t.canBook?1:0}))},Ce=function(e){var t=e.slice();return t.sort((function(e,t){return e.isActive&&!t.isActive?-1:!e.isActive&&t.isActive?1:0}))},Ne=n(98933),De=n(13336),je=De.Z.isIphoneX(),_e={lowest:"\u672c\u6708\u6700\u4f4e",nextlowest:"\u6b21\u6708\u6700\u4f4e",weekend:"\u5468\u672b\u51fa\u884c",festival:"\u8282\u65e5",minprice:"\u4f4e\u4ef7\u73ed\u671f"},be=g.memo(Le),ke=be;function Le(){var e=Y.useState((function(e){var t=e.isSelectPreSale;return{isSelectPreSale:t}})),t=e.isSelectPreSale,n=(0,g.useRef)(null);return(0,$.jsxs)(S.View,{className:"ModuleBoxBigPic",children:[(0,$.jsx)(Ke,{}),(0,$.jsx)(Be,{}),(0,$.jsx)(me,{ref:n}),(0,$.jsx)(Me,{routeRef:n}),(0,$.jsx)(We,{}),!!t&&(0,$.jsx)(Fe,{}),(0,$.jsx)(ze,{})]})}function Be(){var e=Y.useState((function(e){var t=e.BasicInfo,n=e.currentRouteInfo,r=e.pageStatus,i=e.TourGroupInfo,a=e.TravelList;return{BasicInfo:t,currentRouteInfo:n,pageStatus:r,TourGroupInfo:i,TravelList:a}})),t=e.BasicInfo,n=e.currentRouteInfo,r=e.pageStatus,i=(e.TourGroupInfo,e.TravelList,Y.useActions().handlers),a=i.handleToggleCitySelectMask,o=(i.handleChangeDepartCity,r.isMultiLine),s=r.isMultiTravel,c=!(o||s);if(!t||c)return null;var l=t.DepartureCityName,u=n.PriceInfo,d=u||{},f=d.DepartureCityPriceList;return(0,$.jsxs)(S.View,{className:"FlexAlignCenter ",children:[(0,$.jsx)(S.View,{onClick:function(){f&&f.length>1&&a(!0)},children:(0,$.jsxs)(S.Text,{className:"RouteDepartTitle",children:[l,"\u51fa\u53d1"]})}),f&&f.length>1&&(0,$.jsxs)(S.View,{className:"FlexAlignCenter",onClick:function(){a(!0)},style:{fontSize:14},children:[(0,$.jsx)(S.Text,{className:"ModuleTitleSwitcTextBlue",children:"\u66f4\u6362\u51fa\u53d1\u5730"}),(0,$.jsx)(S.Text,{className:"ModuleTitleArrowIconBlue",children:"\ue944"})]})]})}function Re(e,t,n,r){if(!r||(null===t||void 0===t?void 0:t.date)===r)return 0;if((null===n||void 0===n?void 0:n.date)===r)return 1;var i=0,a=!0;return null===e||void 0===e||e.forEach((function(e,o){(null===e||void 0===e?void 0:e.date)===r&&(a=!1,t&&i++,n&&i++,i+=o)})),a?t||n?t&&n?2:1:0:i}function Me(e){var t,n,r,i=e.routeRef,a=Y.useActions().handlers,o=a.handleToggleCalendarPop,s=(a.handleToggleBookingLimitMask,a.handleTraceLog,a.handleToggleCitySelectMask),l=Y.useState((function(e){var t=e.ScheduleInfo,n=e.groupCard,r=e.BasicInfo,i=e.actionIdSuffix,a=e.newProcessSelectDate,o=e.priceCalendarData,s=e.pageStatus,c=e.isPreSale,l=e.TourGroupInfo,u=e.currentRouteInfo,d=e.isSelectPreSale,f=e.routeInfo;return{ScheduleInfo:t,groupCard:n,BasicInfo:r,actionIdSuffix:i,newProcessSelectDate:a,priceCalendarData:o,pageStatus:s,isPreSale:c,TourGroupInfo:l,currentRouteInfo:u,isSelectPreSale:d,routeInfo:f}})),u=l.ScheduleInfo,d=l.groupCard,f=l.BasicInfo,p=l.actionIdSuffix,m=l.newProcessSelectDate,I=l.priceCalendarData,v=l.pageStatus,x=l.isPreSale,T=l.TourGroupInfo,P=l.currentRouteInfo,w=l.isSelectPreSale,C=l.routeInfo,N=v.activeProductId,D=v.activeAlias,j=v.isMultiTravel,_=v.isMultiLine,b=T||{},k=b.TourGroupProductInfo,L=P.scheduleDates,B=P.TagGroupInfo,R=P.PriceInfo,M=R||{},E=M.DepartureCityPriceList,V=(0,g.useState)(0),A=(0,h.Z)(V,2),Z=A[0],O=A[1],U=Ge(),F=U.commonDates,G=U.top1Date,H=U.top2Date;U.isShowTopDates;if(!1,(0,g.useEffect)((function(){if(!w){var e=Re(F,G,H,m),t=30+84*(e-1)-60;O(t)}}),[m]),(0,g.useEffect)((function(){var e=Re(F,G,H,m),t=30+74*(e-1);if(r){t=Math.random();var n="multiRouteId_".concat(N);_&&i.current&&i.current.setMultiRouteId(n)}z&&(t+=40),O(t)}),[N]),(0,g.useEffect)((function(){var e="multiTravelAlias_".concat(D);j&&i.current&&i.current.setMultiTravelAlias(e),r&&O(Math.random())}),[D]),!u)return null;var K,z=!1;if(d&&d.cards&&d.cards.length){var W=d.cards.find((function(e){return e.productId===N}));x&&W&&W.preSaleProductInfo&&W.preSaleProductInfo.canBook&&(z=!0,W.preSaleProductInfo.productId)}if(v.isMultiLine){var q,J=null===T||void 0===T||null===(q=T.TourGroupProductInfo)||void 0===q?void 0:q.filter((function(e){return e.ProductId===v.activeProductId}))[0],Q=["A","B","C","D","E","F","G","H","I","J"];J&&(K=Q[J.SortNumber-1])}v.isMultiTravel&&(K=v.activeAlias,F||G||H||(L=[]));var ee=!(_||j);ee&&"\u73ed\u671f\u9009\u62e9\xb7".concat((null===f||void 0===f?void 0:f.DepartureCityName)||"","\u51fa\u53d1");if(!L||!L.length)return z?(0,$.jsxs)($.Fragment,{children:[ee&&(0,$.jsxs)(S.View,{style:{marginLeft:16},children:[(0,$.jsxs)(S.Text,{style:{fontWeight:"bold",color:"#333",fontSize:17},children:[f.DepartureCityName,"\u51fa\u53d1"]}),E&&E.length>1&&(0,$.jsx)(S.View,{className:"DepartSwitchBigPic",onClick:function(){s(!0)},children:(0,$.jsxs)(S.View,{className:"detailMoreLeft",children:[(0,$.jsx)(S.Text,{style:{color:"#666",fontSize:12},children:"\u66f4\u6362\u51fa\u53d1\u5730"}),(0,$.jsx)(S.Text,{className:"mergeDetailIcon",children:"\ue944"})]})})]}),(0,$.jsxs)(S.View,{className:"ScheduleBoxNewWithTip",children:[(0,$.jsx)(S.Text,{className:"datePreText",children:"\u73ed\u671f\u9009\u62e9"}),(0,$.jsx)(Ue,{showDividingLine:!1,isShowInventoryTip:!1})]})]}):(0,$.jsxs)($.Fragment,{children:[ee&&(0,$.jsxs)(S.View,{className:"detailTitleItemBox",children:[(0,$.jsxs)(S.Text,{style:{fontWeight:"bold",color:"#333",fontSize:17},children:[f.DepartureCityName,"\u51fa\u53d1"]}),E&&E.length>1&&(0,$.jsx)(S.View,{className:"DepartSwitchBigPic",onClick:function(){s(!0)},children:(0,$.jsxs)(S.View,{className:"detailMoreLeft",children:[(0,$.jsx)(S.Text,{style:{color:"#666",fontSize:12},children:"\u66f4\u6362\u51fa\u53d1\u5730"}),(0,$.jsx)(S.Text,{className:"mergeDetailIcon",children:"\ue944"})]})})]}),(0,$.jsxs)(S.View,{className:"detailNodateBigPic",children:[(0,$.jsx)(S.Text,{className:"detailNodateText Color1_Cap1",children:"\u6682\u65e0\u53ef\u552e\u73ed\u671f"}),(0,$.jsx)(S.Image,{className:"detailNodateImg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/bgnodate.png"})]})]});if(!F)return null;var te=F;H&&(te=[H].concat((0,y.Z)(te))),G&&(te=[G].concat((0,y.Z)(te)));var ne=B||{},re=ne.MoreTagList,ie=void 0===re?[]:re,ae=(null===ie||void 0===ie?void 0:ie.some((function(e){return 1807===e.TagId})))||!1,oe=null===f||void 0===f?void 0:f.isPrivateGroup,se=te&&te.some((function(e){return e.inventory>0&&e.inventory<10||e.showGroup&&!oe&&!ae})),ce=F&&!F.some((function(e){return e.date===m}))&&(null===G||void 0===G?void 0:G.date)!==m&&(null===H||void 0===H?void 0:H.date)!==m,le={};if(I&&m&&ce){var ue=I.dailyMinPrice;if(le=(0,c.Z)((0,c.Z)({},ue[m]),{},{date:m}),le&&le.productPrices){var de=le.productPrices.find((function(e){return e.productId===N}));de&&(le.price=de.price,le.displayPrice=de.displayPrice,le.inventory=de.inventory,le.showGroup=de.showGroup)}}var fe=0;(G||H||ce)&&(G&&fe++,H&&fe++,ce&&fe++);var pe,me=[],Ie=C||{},he=Ie.multiTravelScheduleDates;if(j&&I&&I.dailyMinPrice&&he&&he.everyLineIncludesSchedule){var ge=Object.entries(he.everyLineIncludesSchedule).find((function(e){return e[0]===D})),ve=ge&&ge[1]&&ge[1].length||0,xe=Object.entries(I.dailyMinPrice);if(r=ve<=4&&xe.length>ve,r){var Se=[];Object.entries(he.everyLineIncludesSchedule).forEach((function(e){e&&e[0]&&e[0]!==D&&(Se=[].concat((0,y.Z)(Se),(0,y.Z)(e[1])))})),Se=Se.sort((function(e,t){var n=new Date(e).getTime(),r=new Date(t).getTime();return n-r})).slice(0,10),Se.forEach((function(e){var t=I.dailyMinPrice[e];if(t&&t.productPrices){var n=(0,c.Z)({date:e},t.productPrices[0]);me.length+ve<10&&me.push(n)}}))}}if(_&&P&&(null===(t=P.dailyMinPrices)||void 0===t?void 0:t.length)<=4&&I&&I.dailyMinPrice&&k){var Te=P.dailyMinPrices,Pe=Object.entries(I.dailyMinPrice),ye=["A","B","C","D","E","F","G","H","I","J"],we={};k.forEach((function(e){e&&(we[e.ProductId]=ye[e.SortNumber-1]||"")})),Pe.length>Te.length&&(r=!0,Pe.forEach((function(e){if(e){var t=e[1]||{},n=t.productPrices,r=null===n||void 0===n?void 0:n.every((function(e){var t;return(null===e||void 0===e?void 0:e.productId)!==(null===(t=P.TagGroupInfo)||void 0===t?void 0:t.ProductId)}));if(r){var i,a,o,s={},l=1/0;null===n||void 0===n||n.forEach((function(e){e&&we[e.productId]&&(0===e.displayPrice&&(o=we[e.productId]),e.displayPrice>0&&e.displayPrice<l&&(l=e.displayPrice,a=we[e.productId]),s[we[e.productId]]=(0,c.Z)({},e))})),a=a||o,i=(0,c.Z)({date:e[0],showLineName:a,hasMultiLine:(null===n||void 0===n?void 0:n.length)>1},s[a]),me.length+Te.length<10&&me.push(i)}}})))}ce&&r&&I&&I.dailyMinPrice&&I.dailyMinPrice[m]&&(ce=null===(pe=I.dailyMinPrice[m].productPrices)||void 0===pe?void 0:pe.some((function(e){return N===(null===e||void 0===e?void 0:e.productId)})));var Ce=K?K+"\u7ebf\u73ed\u671f":"\u73ed\u671f\u9009\u62e9";ee&&"".concat(Ce,"\xb7").concat((null===f||void 0===f?void 0:f.DepartureCityName)||"","\u51fa\u53d1");return(0,$.jsxs)(S.View,{children:[!!ee&&(0,$.jsx)(S.View,{className:"FlexAlignCenter FlexBetween MarginBottom16",children:(0,$.jsxs)(S.View,{style:{display:"flex",marginLeft:9},children:[(0,$.jsxs)(S.Text,{style:{fontWeight:"bold",color:"#333",fontSize:17},children:[f.DepartureCityName,"\u51fa\u53d1"]}),E&&E.length>1&&(0,$.jsx)(S.View,{className:"DepartSwitchBigPic",onClick:function(){s(!0)},children:(0,$.jsxs)(S.View,{className:"detailMoreLeft",children:[(0,$.jsx)(S.Text,{style:{color:"#666",fontSize:12},children:"\u66f4\u6362\u51fa\u53d1\u5730"}),(0,$.jsx)(S.Text,{className:"mergeDetailIcon",children:"\ue944"})]})})]})}),(0,$.jsxs)(S.View,{className:"ScheduleDetailContainer",children:[(0,$.jsx)(S.Text,{className:"datePreText",children:Ce}),!!z&&(0,$.jsx)(Ue,{isShowInventoryTip:se}),(0,$.jsx)(S.ScrollView,{scrollX:!0,scrollWithAnimation:!0,className:z?"ShowPreSaleDateScheduleDetailScroll":me.length>0?"":"ScheduleDetailScroll",scrollLeft:Z,style:{marginLeft:0,paddingRight:6},children:(0,$.jsxs)(S.View,{className:"ScheduleDetailList",children:[!!G&&(0,$.jsx)(Ze,{item:G,setScrollLeft:O,index:0,isShowInventoryTip:se,isShowGroupTip:G.showGroup&&!oe&&!ae}),!!H&&(0,$.jsx)(Ze,{item:H,setScrollLeft:O,index:1,isShowInventoryTip:se,isShowGroupTip:H.showGroup&&!oe&&!ae}),I&&ce&&!!m&&(0,$.jsx)(Ze,{item:le,setScrollLeft:O,index:2,isShowInventoryTip:se,isShowGroupTip:le.showGroup&&!oe&&!ae}),F.map((function(e,t){return(0,$.jsx)(Ze,{item:e,setScrollLeft:O,index:fe+t,isShowInventoryTip:se,isShowGroupTip:e.showGroup&&!oe&&!ae},t)})),me.length>0&&(0,$.jsx)(Ee,{recommandSchedule:me,isShowInventoryTip:se})]})}),((null===(n=te)||void 0===n?void 0:n.length)||0)+((null===me||void 0===me?void 0:me.length)||0)>4&&(0,$.jsxs)(S.View,{className:"ScheduleDetailMoreContainer",children:[(0,$.jsx)(S.View,{className:"ScheduleDetailMoreShadow"}),(0,$.jsxs)(S.View,{className:"ScheduleDetailMore",onClick:function(e){o(!0),X().uploadUserAction(e,"".concat(p,"-start-more-").concat(f.ProductId))},children:[(0,$.jsx)(S.Text,{className:"ScheduleDetailMoreText",children:"\u5168\u90e8\u73ed\u671f"}),(0,$.jsx)(S.View,{className:"ScheduleDetailMoreArrow",children:(0,$.jsx)(S.Text,{className:"ScheduleDetailMoreArrowIcon",children:"\ue944"})})]})]})]})]})}var Ee=function(e){var t=e.recommandSchedule,n=e.isShowInventoryTip;return(0,$.jsxs)(S.View,{className:"recommandSchedulesModule",children:[(0,$.jsx)(S.View,{className:"recommandSchedulesBox",children:(0,$.jsx)(S.Text,{className:"moreRecommandText",children:"\u66f4\u591a\u63a8\u8350"})}),t.map((function(e){return(0,$.jsx)(Ve,{schedule:e,isShowInventoryTip:n})}))]})};function Ve(e){var t=e.schedule,n=e.isShowInventoryTip,r=Y.useState((function(e){var t=e.pageStatus;return{pageStatus:t}})),i=r.pageStatus,a=Y.useActions().handlers,c=a.handleMultiLineChange,l=a.handleMultiTravelChange,u=a.handleSelectNewProcessDate,d=i.isMultiLine,f=i.isMultiTravel,p=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t,n,r,i){return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(u(i,r),!d){e.next=8;break}return e.next=6,c(n);case 6:e.next=11;break;case 8:if(!f){e.next=11;break}return e.next=11,l(t);case 11:x().showToast({title:"\u5df2\u4e3a\u60a8\u5207\u6362\u81f3".concat(t,"\u7ebf"),duration:2e3,icon:"none"});case 12:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}();if(!t)return null;var m=t.date,I=t.displayPrice,h=t.alias,g=t.showLineName,v=t.hasMultiLine,T=t.productId,P=d?g:h,y=d?"\u53ef\u9009".concat(g,"\u7ebf").concat(v?"\u7b49":""):"\u53ef\u9009".concat(h,"\u7ebf"),w=new Date(null===m||void 0===m?void 0:m.replace(/-/g,"/")).getDay(),C=!!v&&I>=Math.pow(10,5);return(0,$.jsxs)(S.View,{className:"ScheduleDetailItem FlexColumn",onClick:function(){p(d?g:h,T,I,m)},children:[(0,$.jsx)(S.Text,{className:"ScheduleDetailItemWeek",children:Ae[w]?"\u661f\u671f".concat(Ae[w]):""}),!!m&&(0,$.jsx)(S.Text,{className:"ScheduleDetailItemDay",children:null===m||void 0===m?void 0:m.slice(5,10)}),I>0?(0,$.jsx)($.Fragment,{children:(0,$.jsxs)(S.Text,{className:"".concat(C?"ScheduleDetailItemPriceRecommand":"ScheduleDetailItemPrice"," FontNumberBold"),style:C?{position:"relative",top:2}:null,children:["\xa5"+I,(0,$.jsx)(S.Text,{className:"RecommandPriceMin",children:v?"\u8d77":""})]})}):(0,$.jsx)(S.Text,{className:"ScheduleDetailItemPriceInTime",children:"\u5b9e\u65f6\u8ba1\u4ef7"}),(0,$.jsx)(S.View,{className:v?"otherLineSchedule":"otherLineScheduleMultiLine",style:v?C?{bottom:2}:{marginBottom:-1}:null,children:(0,$.jsx)(S.Text,{className:n?"SchedulePricePresaleWithTip":"otherLineScheduleText",children:P?y:""})})]})}var Ae={0:"\u65e5",1:"\u4e00",2:"\u4e8c",3:"\u4e09",4:"\u56db",5:"\u4e94",6:"\u516d"};function Ze(e){var t=e.item,n=e.setScrollLeft,r=e.index,i=e.isShowInventoryTip,a=e.isShowGroupTip,o=Y.useState((function(e){var t=e.actionIdSuffix,n=e.newProcessSelectDate,r=e.isPremium,i=e.scheduleDisableDates;return{actionIdSuffix:t,newProcessSelectDate:n,isPremium:r,scheduleDisableDates:i}})),s=o.actionIdSuffix,c=o.newProcessSelectDate,l=o.isPremium,u=o.scheduleDisableDates,d=Y.useActions().handlers.handleSelectNewProcessDate,f=(0,g.useCallback)((function(e,t){u&&u.includes(e)?x().showToast({title:"\u8be5\u73ed\u671f\u5df2\u552e\u7f44",icon:"none",duration:2e3}):d(e,t)}),[u]);if(!t||!t.date)return null;var p=t.Festival,m=t.date,I=void 0===m?"":m,h=t.festivalName,v=t.FestivalDate,T=t.displayPrice,P=t.type,y=t.inventory;t.showGroup;p&&v&&(I=v);var w=c===I,C=I.slice(5,10),N="\u661f\u671f"+(Ae[new Date(I).getDay()]||""),D=T>0?"\xa5":null,j="festival"===P?h:_e[P];return(0,$.jsxs)(S.View,{className:"ScheduleDetailItem FlexColumn ".concat(w?l?"ScheduleDetailItemActivePremium":"ScheduleDetailItemActive":""),onClick:function(e){f(I,T),n(30+74*(r-1)),X().uploadUserAction(e,"".concat(s,"-start-date-").concat(I.replace(/-/g,"")))},children:[!!j&&(0,$.jsx)(S.View,{className:"CommonTopDateTagPresale",children:(0,$.jsx)(S.Text,{style:{color:"#F5190A",fontSize:11,fontWeight:500},children:j})}),(0,$.jsx)(S.Text,{className:"ScheduleDetailItemWeek",children:N}),!!C&&(0,$.jsx)(S.Text,{className:"ScheduleDetailItemDay",children:C}),T>0?(0,$.jsx)(S.Text,{className:"ScheduleDetailItemPrice FontNumberBold",children:D+T}):(0,$.jsx)(S.Text,{className:"ScheduleDetailItemPriceInTime",children:"\u5b9e\u65f6\u8ba1\u4ef7"}),i&&(0,$.jsx)(S.View,{className:"ScheduleDateBottomTip",children:y>0&&y<10?(0,$.jsxs)(S.Text,{style:{color:"#999",fontSize:11},children:[a?"\u6210\u56e2\xb7":"","\u4f59",y]}):(0,$.jsx)(S.Text,{style:{color:"#999",fontSize:11},children:a?"\u6210\u56e2":""})}),!!w&&(0,$.jsx)(S.Image,{className:"currentSelectedDate",style:je?null:{right:"-1px"},src:l?"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/bigpic/date_select_icon.png":"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/bigpic/route_select_icon.png"})]})}function Oe(e){var t=e.MinPrice,n=e.isSelected,r=e.isRecommandSchedule,i=void 0!==r&&r;return t>0?(0,$.jsx)($.Fragment,{children:i?(0,$.jsxs)(S.View,{className:"RecommandSchedulePrice",children:[(0,$.jsx)(S.View,{children:(0,$.jsxs)(S.Text,{className:"RecommandPrice1",children:["\xa5",t]})}),(0,$.jsx)(S.View,{style:{position:"relative"},children:(0,$.jsx)(S.Text,{className:"RecommandPrice",children:"\u8d77"})})]}):(0,$.jsxs)(S.Text,{className:n?"isSelectedPrice":"noSelectedPrice",children:["\xa5",t]})}):(0,$.jsx)(S.Text,{style:{position:"relative",top:0,color:"#333",fontSize:13,fontWeight:n?"bold":"normal"},children:"\u5b9e\u65f6\u8ba1\u4ef7"})}function Ue(e){var t=e.showDividingLine,n=void 0===t||t,r=e.isShowInventoryTip,i=Y.useState((function(e){var t=e.pageStatus,n=e.groupCard,r=e.isSelectPreSale;return{pageStatus:t,groupCard:n,isSelectPreSale:r}})),a=i.pageStatus,o=i.groupCard,s=i.isSelectPreSale,c=Y.useActions().handlers.handleSelectPreSaleDate,l=a.activeProductId,u=0;if(o&&o.cards&&o.cards.length){var d=o.cards.find((function(e){return e.productId===l}));d&&d.preSaleProductInfo&&d.preSaleProductInfo.canBook&&(u=d.preSaleProductInfo.minPrice,d.preSaleProductInfo.productId)}var f=s;return(0,$.jsxs)(S.View,{onClick:function(){c(!0)},className:n?"PreSaleDateContainer":"",children:[(0,$.jsxs)(S.View,{className:f?"PreSaleDateBoxCur":"PreSaleDateBox",style:{height:r?108:100},children:[(0,$.jsx)(S.Text,{className:f?"PreSaleDateTopTextCur":"PreSaleDateTopText",children:"\u9884\u552e"}),(0,$.jsxs)(S.View,{className:"PreSaleDateInfo",style:{height:r?90:82},children:[(0,$.jsx)(S.Text,{className:"PreSaleDateText",style:{marginTop:6},children:"\u8d2d\u4e70\u540e"}),(0,$.jsx)(S.Text,{className:"PreSaleDateText",children:"\u9884\u7ea6\u65e5\u671f"}),(0,$.jsx)(S.Text,{className:"PreSaleDateTipText",children:"\u672a\u7ea6\u5168\u9000"}),(0,$.jsx)(Oe,{MinPrice:u,isSelected:!0}),!!f&&(0,$.jsx)(S.Image,{className:"currentSelectedDate",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/bigpic/route_select_icon.png"})]})]}),!!n&&(0,$.jsx)(S.View,{className:"PreSaleDateBetweenLine"})]})}function Fe(){var e=Y.useState((function(e){var t=e.currentRouteInfo,n=e.pageStatus,r=e.isPreSale,i=e.groupCard;return{currentRouteInfo:t,pageStatus:n,isPreSale:r,groupCard:i}})),t=e.currentRouteInfo,n=e.pageStatus,r=e.isPreSale,i=e.groupCard,a=Y.useActions().handlers,o=a.handleTogglePresaleCalendarPop,s=a.handleTogglePreSaleNoticeMask,c=t.PreSaleNotice,l=t.PreSaleTagGroupInfo;if(!r)return null;if(!c)return null;var u,d=n.activeProductId;if(i&&i.cards&&i.cards.length){var f=i.cards.find((function(e){return e.productId===d}));f&&f.preSaleProductInfo&&f.preSaleProductInfo.canBook&&(u=f.preSaleProductInfo.productId)}if(!u)return null;var p="",m="";if(c&&c.PreSaleRule){var I=c.PreSaleRule,h=I.PreSaleTravelStartDay,g=I.PreSaleTravelEndDay,v=I.AdvanceBookingDays,x=I.AdvanceBookingTime;h&&g&&(p="".concat(Ne.Z.parse(h,!1).format("YYYY\u5e74MM\u6708DD\u65e5"),"-").concat(Ne.Z.parse(g,!1).format("YYYY\u5e74MM\u6708DD\u65e5"),"\u671f\u95f4\u53ef\u51fa\u884c")),v&&x&&(m="\u81f3\u5c11\u63d0\u524d".concat(v,"\u5929").concat(x,"\u524d\u9884\u7ea6"))}var T=!1,P=!1;if(l&&l.SpecialTagList&&l.SpecialTagList.length){var y=l.SpecialTagList;y.find((function(e){return 2171===e.TagId}))&&(T=!0),y.find((function(e){return 2172===e.TagId}))&&(P=!0)}return(0,$.jsxs)(S.View,{className:"PreSaleNoticeContainer",children:[(0,$.jsx)(S.View,{className:"PreSaleNoticeArrow"}),(0,$.jsx)(S.View,{className:"PreSaleNoticeTopLine"}),(0,$.jsxs)(S.View,{className:"PreSaleNoticeBox",children:[!!p&&(0,$.jsxs)(S.View,{className:"PreSaleNoticeItem",children:[(0,$.jsx)(S.View,{className:"PreSaleNoticeItemIcon",children:(0,$.jsx)(S.Text,{className:"detailIcon_presale Color1_Body2",children:"\udb82\udc63"})}),(0,$.jsx)(S.View,{className:"PreSaleNoticeItemText",children:(0,$.jsx)(S.Text,{className:"Color1_Cap2",children:p})}),(0,$.jsxs)(S.View,{className:"PreSaleNoticeItemEntry",onClick:function(){o(!0)},children:[(0,$.jsx)(S.Text,{className:"Color1_Cap2",children:"\u65e5\u5386"}),(0,$.jsx)(S.Text,{className:"detailIcon_presale Color1_Cap2",children:"\ue944"})]})]}),!!c&&(0,$.jsxs)(S.View,{className:"PreSaleNoticeItem",children:[(0,$.jsx)(S.View,{className:"PreSaleNoticeItemIcon",children:(0,$.jsx)(S.Text,{className:"detailIcon_presale Color1_Body2",children:"\udb84\udcf6"})}),(0,$.jsxs)(S.View,{className:"FlexWrap",children:[(0,$.jsxs)(S.View,{className:"PreSaleNoticeItemText",children:[(0,$.jsx)(S.Text,{className:"Color1_Cap2",children:"\u8d2d\u4e70\u540e\u9700\u7ea6\u51fa\u884c\u65e5\u671f"}),(0,$.jsx)(S.Text,{className:"Color3_Cap2",style:{opacity:.5},children:"\xa0|\xa0"}),!!m&&(0,$.jsx)(S.Text,{className:"Color1_Cap2",children:m})]}),(0,$.jsxs)(S.View,{className:"PreSaleNoticeItemEntry",onClick:function(){s({status:!0,selectType:"PreSaleRule"})},children:[(0,$.jsx)(S.Text,{className:"Color1_Cap2",children:"\u9884\u7ea6\u89c4\u5219"}),(0,$.jsx)(S.Text,{className:"detailIcon_presale Color1_Cap2",children:"\ue944"})]})]})]}),(0,$.jsxs)(S.View,{className:"PreSaleNoticeItem",children:[(0,$.jsx)(S.View,{className:"PreSaleNoticeItemIcon",children:(0,$.jsx)(S.Text,{className:"detailIcon_presale Colorg_Body2",children:"\udb84\udcf7"})}),(0,$.jsxs)(S.View,{className:"PreSaleNoticeItemText",children:[!!P&&(0,$.jsx)(S.Text,{className:"Colorg_Cap2",children:"\u672a\u7ea6\u5168\u9000"}),!!P&&!!T&&(0,$.jsx)(S.Text,{className:"Color3_Cap2",style:{opacity:.5},children:"\xa0|\xa0"}),!!T&&(0,$.jsx)(S.Text,{className:"Colorg_Cap2",children:"\u8fc7\u671f\u81ea\u52a8\u9000"})]}),(0,$.jsxs)(S.View,{className:"PreSaleNoticeItemEntry",onClick:function(){s({status:!0,selectType:"PreSaleUnbooking"})},children:[(0,$.jsx)(S.Text,{className:"Color1_Cap2",children:"\u9000\u6539\u653f\u7b56"}),(0,$.jsx)(S.Text,{className:"detailIcon_presale Color1_Cap2",children:"\ue944"})]})]})]})]})}var Ge=function(){var e=Y.useState((function(e){var t=e.priceCalendarData,n=e.currentRouteInfo,r=e.pageStatus;return{priceCalendarData:t,currentRouteInfo:n,pageStatus:r}})),t=e.priceCalendarData,n=e.currentRouteInfo,r=e.pageStatus,i=n.dailyMinPrices,a=n.scheduleDates;n.PriceInfo;i&&a&&a.length&&(a=a.map((function(e){var t=(null===i||void 0===i?void 0:i.find((function(t){return t.date===e.date})))||{};return(0,c.Z)((0,c.Z)({},e),t)})));var o=[];if(i&&i.length&&t&&t.flatDailyMinPrice){var s=t.dailyMinPrice;i.forEach((function(e){var t=e.date;if(s[t]){var n=s[t].productPrices;n.find((function(e){return e.productId===r.activeProductId}))&&o.push(e)}}))}else o=i;if(o=o||[],r.isMultiTravel){var l=r.activeAlias;o&&(o=o.filter((function(e){var t=e.productPrices;return!(!t||!t.length)&&t.some((function(e){return e.alias===l}))}))),a&&(a=a.filter((function(e){var t=e.productPrices;return!(!t||!t.length)&&t.some((function(e){return e.alias===l}))})))}if(!o||!o.length)return{commonDates:null,top1Date:null,top2Date:null};var u=o.slice(0,12),d=null,f=null,p=(new Ne.Z).format("MM"),m=(new Ne.Z).addMonth(1).format("MM"),I=o.filter((function(e){var t;return(null===(t=e.date)||void 0===t?void 0:t.slice(5,7))===p})),h=o.filter((function(e){var t;return(null===(t=e.date)||void 0===t?void 0:t.slice(5,7))===m})),g=0;I&&I.length&&(g=I.filter((function(e){return e.displayPrice>0})).length?I.filter((function(e){return e.displayPrice>0})).sort((function(e,t){return e.displayPrice-t.displayPrice}))[0].displayPrice:0,I.filter((function(e){return e.displayPrice===g})).sort((function(e,t){return Number(e.date.split("-").join(""))-Number(t.date.split("-").join(""))}))[0]);var v=0;h&&h.length&&(v=h.filter((function(e){return e.displayPrice>0})).length?h.filter((function(e){return e.displayPrice>0})).sort((function(e,t){return e.displayPrice-t.displayPrice}))[0].displayPrice:0,h.filter((function(e){return e.displayPrice===v})).sort((function(e,t){return Number(e.date.split("-").join(""))-Number(t.date.split("-").join(""))}))[0]);var x=a.filter((function(e){return!!e.festivalName})).sort((function(e,t){return new Ne.Z(e.date).getTime()-new Ne.Z(t.date).getTime()})),S=o.filter((function(e){return e.displayPrice>0})).length?o.filter((function(e){return e.displayPrice>0})).sort((function(e,t){return e.displayPrice-t.displayPrice}))[0].date:"";if(console.log("--minPriceDate--",S),S)if(d=o.find((function(e){return e.date===S})),d.type="minprice",x&&x[0]){var T=(new Ne.Z).format("YYYY-MM-DD");if(Ne.Z.dayDiff(T,x[0].date)<=60&&x[0].date!==d.date)f=x[0],f.type="festival";else if(x[1]&&Ne.Z.dayDiff(T,x[1].date)<=60)f=x[1],f.type="festival";else{var P=He(o);P&&P.date!==d.date&&(f=P,f.type="weekend")}}else{var y=He(o);y&&y.date!==d.date&&(f=y,f.type="weekend")}else if(x&&x[0]){var w=(new Ne.Z).format("YYYY-MM-DD"),C=Ne.Z.dayDiff(w,x[0].date);if(C<=60)d=x[0],d.type="festival";else{var N=He(o);N&&N.date&&(d=N,d.type="weekend")}if(x[1]){var D=(new Ne.Z).format("YYYY-MM-DD"),j=Ne.Z.dayDiff(D,x[1].date);j<=60&&(f=x[1],f.type="festival")}else{var _=He(o);_&&_.date!==d.date&&(f=_,f.type="weekend")}}else{var b=He(o);b&&b.date&&(d=b,d.type="weekend")}d&&(u=u.filter((function(e){return e.date!==d.date}))),f&&(u=u.filter((function(e){return e.date!==f.date}))),u=u.slice(0,10);var k=!0,L=u.length;return d&&(L+=1),f&&(L+=1),k=L>5,console.log("getScheduleTopDate",{commonDates:u,top1Date:d,top2Date:f,isShowTopDates:k}),{commonDates:u,top1Date:d,top2Date:f,isShowTopDates:k}},He=function(e){for(var t=null,n=(new Ne.Z).format("YYYY-MM-DD"),r=e.filter((function(e){var t=Ne.Z.dayDiff(n,e.date);return!(t>30)})),i=0;i<r.length;i++){var a=r[i].date,o=new Ne.Z(a).format("w");if(["\u516d","\u65e5"].includes(o)){t=r[i];break}}return t};function Ke(){var e=Y.useState((function(e){var t=e.BasicInfo,n=e.query,r=e.specialTag,i=e.brandTag,a=e.currentRouteInfo,o=e.pageSetting;return{BasicInfo:t,query:n,specialTag:r,brandTag:i,currentRouteInfo:a,pageSetting:o}})),t=(e.BasicInfo,e.query,e.specialTag,e.brandTag),n=(e.currentRouteInfo,e.pageSetting,Y.useActions().handlers),r=(n.handleToggleSpecialBrandMask,n.handleGoTagUrl);n.handleTraceLog;if(!t||!t.ImgUrl||!t.ImgUrl.mini)return null;var i=t.ImgUrl.mini,a=t.linkUrl;t.isJump,t.code;return(0,$.jsx)(S.View,{onClick:function(){a&&r(a)},className:"ImageBannerBoxBigPicBrand",children:(0,$.jsx)(S.Image,{className:"ImageBannerImgBigPicBrand",src:i})})}function ze(){var e,t=Y.useState((function(e){var t=e.BasicInfo,n=e.currentRouteInfo,r=e.userInfo,i=e.groupCard,a=e.isPreSale,o=e.pageStatus,s=e.isSelectPreSale,c=e.priceCalendarData,l=e.priceCalendar,u=e.routeInfo,d=e.isTpalStyle;return{BasicInfo:t,currentRouteInfo:n,userInfo:r,groupCard:i,isPreSale:a,pageStatus:o,isSelectPreSale:s,priceCalendarData:c,priceCalendar:l,routeInfo:u,isTpalStyle:d}})),n=t.BasicInfo,r=t.currentRouteInfo,i=t.userInfo,a=t.groupCard,o=t.isPreSale,s=t.pageStatus,c=t.isSelectPreSale,l=t.priceCalendarData,u=t.priceCalendar,d=t.routeInfo,f=(t.isTpalStyle,Y.useActions().handlers),p=f.handleTraceLog,m=f.handleToggleBookingLimitMask;if(!r)return null;var I=r.BasicExtendInfo,h=r.isShowFlightDiscountInfo,g=r.isShowMemberDiscountInfo,v=r.BookInfo,x=r.TagGroupInfo,T=r.scheduleDates,P=i||{},y=P.VipGradeRemark,w=P.VipGrade,C=!1;if(a&&a.cards&&a.cards.length){var N=a.cards.find((function(e){return e.productId===s.activeProductId}));o&&N&&N.preSaleProductInfo&&N.preSaleProductInfo.canBook&&(C=!0)}var D=!0;!u||T&&T.length||C||(D=!1);var j=d||{},_=j.multiTravelScheduleDates,b=s.isMultiLine,k=s.isMultiTravel,L=s.activeProductId,B=s.activeAlias;k&&_&&!_[B]&&!_.priceInTimeLines.includes(B)&&(D=!1);var R="";n.isStudy&&I&&I.AdapteAgeText&&(R=I.AdapteAgeText);var M="";w&&w>=20&&(M="\u6b64\u4ef7\u683c\u5df2\u4e3a".concat(y,C?"\u4e13\u4eab\u8d77\u4ef7\uff08\u4e0d\u542b\u9884\u552e\uff09":"\u4e13\u4eab\u8d77\u4ef7")),h&&(M=C?"\u6b64\u4ef7\u683c\u4e3a\u673a\u7968\u7528\u6237\u4e13\u4eab\u8d77\u4ef7\uff08\u4e0d\u542b\u9884\u552e\uff09":"\u6b64\u4ef7\u683c\u4e3a\u673a\u7968\u7528\u6237\u4e13\u4eab\u8d77\u4ef7"),(c&&C||!g&&!h)&&(M="");var E,V="",A=(n.DestCityId,n.DepartureId,n.ProductId,null===x||void 0===x||null===(e=x.MoreTagList)||void 0===e?void 0:e.slice());A&&A.forEach((function(e){2146===(null===e||void 0===e?void 0:e.TagId)&&(E=!0)}));var Z,O,U=(new Ne.Z).format("YYYY-MM-DD"),F=(new Ne.Z).addDay(1).format("YYYY-MM-DD");if(null!==l&&void 0!==l&&l.dailyMinPrice&&null!==l&&void 0!==l&&l.dailyMinPrice[F]){var G=null===l||void 0===l?void 0:l.dailyMinPrice[F],H=G.productPrices;Z=null===H||void 0===H?void 0:H.some((function(e){var t=e.productId,n=e.alias;return b?t===L:!k||n===B}))}if(null!==l&&void 0!==l&&l.dailyMinPrice&&null!==l&&void 0!==l&&l.dailyMinPrice[U]){var K=null===l||void 0===l?void 0:l.dailyMinPrice[U],z=K.productPrices;O=null===z||void 0===z?void 0:z.some((function(e){var t=e.productId,n=e.alias;return b?t===L:!k||n===B}))}var W=Z?E?"\u660e\u65e5\u53ef\u8ba2\u4e14\u4e0b\u5355\u7acb\u5373\u786e\u8ba4 | ":"\u660e\u65e5\u53ef\u8ba2 | ":"",q=O?E?"\u4eca\u65e5\u53ef\u8ba2\u4e14\u4e0b\u5355\u7acb\u5373\u786e\u8ba4 | ":"\u4eca\u65e5\u53ef\u8ba2 | ":"";Z&&n.BookingTime&&1==n.BookingDay&&(W=n.BookingTime+"\u524d"+W),0==n.BookingDay&&n.BookingTime&&O&&(W=n.BookingTime+"\u524d"+q),W=c?"":W,W="";var J=!0,Q=!0;if(I&&I.PriceStandardList){var X=I.PriceStandardList;if(X&&X.length){var ee=X.find((function(e){return 1===e.PassengerType})),te=X.find((function(e){return 2===e.PassengerType}));J=ee&&ee.IsCanBook,Q=te&&te.IsCanBook}}var ne=v||{},re=ne.MinBookPerson,ie=J?Q?"":"\u513f\u7ae5\u4e0d\u53ef\u8ba2":"\u6210\u4eba\u4e0d\u53ef\u8ba2",ae=b||k?"\u8be5\u7ebf\u8def":"\u8be5\u4ea7\u54c1";re>1?V=W+ae+"".concat(re,"\u4eba\u8d77\u8ba2")+(ie?",".concat(ie):""):ie?V=W+ae+ie:W&&(V=W.slice(0,-3)),v||(V="");var oe,se,ce=0;return R&&ce++,V&&ce++,M&&ce++,2==ce&&(V?R?oe=!0:se=!0:oe=!0),3===ce&&(oe=!0,se=!0),D||0!==ce?(0,$.jsxs)(S.View,{className:"compressionAll",children:[!!D&&(0,$.jsxs)(S.View,{className:"bookLimitAllCompression",onClick:function(){m(!0),p("grp_prddtl_booking_clause_click")},children:[(0,$.jsx)(S.Text,{className:"bookLimitAllCompressionText",children:"\u9884\u8ba2\u9650\u5236"}),(0,$.jsx)(S.Text,{className:"bookingDetailIconAll",children:"\ue931"})]}),!D&&ce>0&&(0,$.jsx)(S.Text,{className:"bookingDetailIconAll",children:"\ue931\xa0"}),(0,$.jsxs)(S.Text,{className:"allCompressionTextBox",style:D?{textIndent:"70px",minHeight:10}:null,children:[ce>0&&!!D&&(0,$.jsx)(S.Text,{className:"splitText",children:"|"}),R?" ".concat(R," "):"",!!oe&&(0,$.jsx)(S.Text,{className:"splitText",children:"|"}),V?" ".concat(V," "):"",!!se&&(0,$.jsx)(S.Text,{className:"splitText",children:"|"}),M?" ".concat(M):""]})]}):null}function We(){var e=Y.useState((function(e){var t=e.groupCard,n=e.BasicInfo,r=e.pageStatus;return{groupCard:t,BasicInfo:n,pageStatus:r}})),t=e.groupCard,n=(e.BasicInfo,e.pageStatus),r=t||{},i=r.cards;if(!i)return null;var a=i[0]||{},o=a.priceInfo,s=o||{},c=s.baseCarMinPrice,l=!(n.isMultiLine||n.isMultiTravel);return c&&l?(0,$.jsx)(S.View,{className:"carInfoBox",children:(0,$.jsxs)(S.Text,{className:"baseCarMinPriceText",children:["\u6ee13\u4eba\u518d\u51cf\xa5",c,"\u8d77"]})}):null}var qe=g.memo($e),Ye=qe;function $e(){var e=Y.useState((function(e){var t=e.BasicInfo,n=e.currentRouteInfo,r=e.actionIdSuffix;return{BasicInfo:t,currentRouteInfo:n,actionIdSuffix:r}})),t=e.BasicInfo,n=e.currentRouteInfo,r=(e.actionIdSuffix,t.IsThemeProduct),i=Y.useActions().handlers.handleToggleThemeDifficultyMask;if(!r)return null;var a=n.TravelIntroductionInfo;if(!a||!a.TravelIntroductionList||!a.TravelIntroductionList[0])return null;var o=a.TravelIntroductionList[0].ThemeOverviewInfo;return o&&o.length?(0,$.jsxs)(S.View,{className:"ModuleBox",children:[(0,$.jsx)(S.View,{className:"FlexAlignCenter MarginBottom24",children:(0,$.jsx)(S.Text,{className:"ModuleTitleText Flex1",children:"\u6d3b\u52a8\u8bf4\u660e"})}),(0,$.jsx)(S.View,{className:"ProductSummaryDetailContainer",children:(0,$.jsx)(S.View,{children:o.map((function(e,t){var n=e.Key,r=e.Desc,a=e.Title;return"difficulty"===n?(0,$.jsxs)(S.View,{className:"ProductSummaryDetailItem MarginBottom16",children:[(0,$.jsx)(S.View,{className:"ProductSummaryDetailItemThemeLeft",children:(0,$.jsx)(S.Text,{className:"ProductSummaryDetailItemText FontW600",children:a})}),(0,$.jsxs)(S.View,{className:"ProductSummaryDetailItemRight",onClick:function(e){i(!0)},children:[(0,$.jsx)(S.Text,{className:"ProductSummaryDetailItemText",children:r}),(0,$.jsx)(S.Text,{className:"ProductSummaryDetailItemBtnText MarginLeft12",children:"\u67e5\u770b\u8be6\u60c5"}),(0,$.jsx)(S.Text,{className:"ProductSummaryDetailItemBtnIcon",children:"\ue944"})]})]},t):(0,$.jsxs)(S.View,{className:"ProductSummaryDetailItem MarginBottom16",children:[(0,$.jsx)(S.View,{className:"ProductSummaryDetailItemThemeLeft",children:(0,$.jsx)(S.Text,{className:"ProductSummaryDetailItemText FontW600",children:a})}),(0,$.jsx)(S.View,{className:"ProductSummaryDetailItemRight",children:(0,$.jsx)(S.Text,{className:"ProductSummaryDetailItemText",children:r})})]},t)}))})})]}):null}var Je=g.memo(Xe),Qe=Je;function Xe(){var e=Y.useState((function(e){var t=e.BasicInfo;return{BasicInfo:t}})),t=e.BasicInfo,n=De.Z.getEnv();"prd"===n&&(n="prod");var r=t.isPureDiyfhxsdp,i={channel:r?"vacations-diy":"vacations-grp",env:n,queryId:t.ProductId,scene:r?"SINGLE_PRODUCT_QUERY":"PRODUCT_QUERY",jump:function(e){var t={url:encodeURIComponent(e),pageTitle:{color:{backgroundColor:"#ffffff",frontColor:"#000000"}}};X().navigateTo({url:"/cwx/component/cwebview/cwebview?data="+JSON.stringify(t)})}};return(0,$.jsx)(S.View,{className:"ModuleBoxWithoutPadding commentMargin",id:"Comment",children:(0,$.jsx)(I.SimpleCommentList,(0,c.Z)({},i))})}var et=g.memo(nt),tt=et;function nt(){var e=Y.useState((function(e){var t=e.brandScore,n=e.BasicInfo;return{brandScore:t,BasicInfo:n}})),t=e.brandScore,n=e.BasicInfo;if(n.isCruise)return null;if(!t)return null;var r=t.productList,i=t.shopInfo;if(!i&&(!r||r.length<1))return null;i.isGoldShop,n.SaleMode;var a=n.isDiyfhxsdp,o=n.isStudy;return a||o?(0,$.jsxs)(S.View,{className:"ModuleBox",children:[(0,$.jsx)(rt,{}),(0,$.jsx)(at,{productList:r})]}):(0,$.jsxs)(S.View,{className:"ModuleBox",children:[(0,$.jsx)(it,{shopInfo:i}),(0,$.jsx)(at,{productList:r})]})}function rt(){var e=Y.useState((function(e){return e.BasicInfo})),t=Y.useState((function(e){return e.VendorInfo})),n=Y.useState((function(e){return e.brandScore})),r=Y.useActions().handlers,i=r.handleGoSelfLicenseInfo,a=r.handleGoLicensePage,o=e.isDiyfhxsdp,s=e.isPureDiyfhxsdp,c=e.isStudy,l=e.IsInternal,u=e.ProductPatternId,d=(null===n||void 0===n?void 0:n.shopInfo)||{},f=d.storeType,p=!(!f||1!==f.storeTypeId),m="S"===e.SaleMode,I=!1;!l||1!==u&&3!==u&&4!==u||(I=!0);var h=p?"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/shop/goldbg.png":m?"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/detailshop_newbg.png":null;if(s||c&&"S"===e.SaleMode)return(0,$.jsxs)(S.View,{children:[(!!p||!!m)&&(0,$.jsx)(S.View,{className:"BrandInfoBg",children:(0,$.jsx)(S.Image,{className:"BrandInfoBgImg",src:h})}),(0,$.jsxs)(S.View,{className:"BrandInfoContent",onClick:function(){i()},style:{marginBottom:12},children:[(0,$.jsxs)(S.View,{className:"FlexAlignCenter",children:[(0,$.jsxs)(S.View,{className:"FlexAlignCenter Flex1",children:[!m&&(0,$.jsx)(S.Text,{className:"ModuleTitleText",children:"\u643a\u7a0b\u81ea\u8425"}),p&&(0,$.jsx)(S.View,{className:"BrandInfoTitleImgBox",children:(0,$.jsx)(S.Image,{lazyLoad:!0,mode:"widthFix",className:"BrandInfoTitleImg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/gold_brand.png"})}),m&&(0,$.jsx)(S.View,{className:"BrandInfoTitleImgBox_self_new",children:(0,$.jsx)(S.Image,{lazyLoad:!0,mode:"widthFix",className:"BrandInfoTitleImg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/salebyself_newicon.png"})}),m&&!!I&&(0,$.jsx)(S.View,{className:"detailBusinessSelfNewIconUpgrade",children:(0,$.jsx)(S.Image,{lazyLoad:!0,mode:"widthFix",className:"BrandInfoTitleImg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/salebyself_newgrade_icon.png"})})]}),(0,$.jsxs)(S.View,{className:"ModuleTitlePosition",children:[(0,$.jsx)(S.Text,{className:"ModuleTitleSwitchText",children:"\u7ecf\u8425\u8bb8\u53ef\u8bc1/\u8425\u4e1a\u6267\u7167"}),(0,$.jsx)(S.Text,{className:"ModuleTitleArrowIcon",children:"\ue944"})]})]}),m&&(0,$.jsx)(S.View,{className:"BrandInfoCompanyBox",children:(0,$.jsx)(S.Text,{className:"BrandInfoCompanyName",children:"\u643a\u7a0b\u56fd\u9645\u65c5\u884c\u793e(\u5b98\u65b9)"})})]})]});if(o||c){if(!t||!t.BCScanningCopy)return null;var g=t.VenderId,v=t.VendorBrand,x=t.VendorName;return(0,$.jsxs)(S.View,{children:[(!!p||!!m)&&(0,$.jsx)(S.View,{className:"BrandInfoBg",children:(0,$.jsx)(S.Image,{className:"BrandInfoBgImg",src:h})}),(0,$.jsxs)(S.View,{onClick:function(){a(g)},className:"BrandInfoContent",style:{marginBottom:12},children:[(0,$.jsxs)(S.View,{className:"FlexAlignCenter",children:[(0,$.jsxs)(S.View,{className:"FlexAlignCenter Flex1",children:[!m&&(0,$.jsx)(S.Text,{className:"ModuleTitleText",children:v}),p&&(0,$.jsx)(S.View,{className:"BrandInfoTitleImgBox",children:(0,$.jsx)(S.Image,{lazyLoad:!0,mode:"widthFix",className:"BrandInfoTitleImg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/gold_brand.png"})}),m&&(0,$.jsx)(S.View,{className:"BrandInfoTitleImgBox_self_new",children:(0,$.jsx)(S.Image,{lazyLoad:!0,mode:"widthFix",className:"BrandInfoTitleImg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/salebyself_newicon.png"})}),m&&!!I&&(0,$.jsx)(S.View,{className:"detailBusinessSelfNewIconUpgrade",children:(0,$.jsx)(S.Image,{lazyLoad:!0,mode:"widthFix",className:"BrandInfoTitleImg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/salebyself_newgrade_icon.png"})})]}),(0,$.jsxs)(S.View,{className:"ModuleTitlePosition",children:[(0,$.jsx)(S.Text,{className:"ModuleTitleSwitchText",children:"\u7ecf\u8425\u8bb8\u53ef\u8bc1/\u8425\u4e1a\u6267\u7167"}),(0,$.jsx)(S.Text,{className:"ModuleTitleArrowIcon",children:"\ue944"})]})]}),(0,$.jsx)(S.View,{className:"BrandInfoCompanyBox",children:(0,$.jsx)(S.Text,{className:"BrandInfoCompanyName",children:x})})]})]})}return null}function it(e){var t=e.shopInfo,n=Y.useState((function(e){var t=e.brandScore,n=e.actionIdSuffix,r=e.BasicInfo,i=e.VendorInfo;return{brandScore:t,actionIdSuffix:n,BasicInfo:r,VendorInfo:i}})),r=n.brandScore,i=n.actionIdSuffix,a=n.BasicInfo,o=(n.VendorInfo,Y.useActions().handlers.handleGoShopDetail);if(!r||!t)return null;var s=a.IsInternal,c=a.ProductPatternId,l=t.brandName,u=t.providerName,d=t.totalScore,f=t.customersCount,p=t.storeEvaluation,m=t.serviceDestinationName,I=t.isGoldShop,h=t.cmtGuidePosiRate,g=p||{},v=g.gradeName,x=g.gradeIconUrl,T=st(h),P="S"===a.SaleMode,y="\u8fdb\u5165\u5e97\u94fa",w=!1;!s||1!==c&&3!==c&&4!==c||(w=!0);var C=I?"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/shop/goldbg.png":P?"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/detailshop_newbg.png":null;return(0,$.jsxs)(S.View,{children:[(!!I||!!P)&&(0,$.jsx)(S.View,{className:"BrandInfoBg",children:(0,$.jsx)(S.Image,{className:"BrandInfoBgImg",src:C})}),(0,$.jsxs)(S.View,{className:"BrandInfoContent",onClick:function(e){o(),X().uploadUserAction(e,"".concat(i,"-shop-entry"))},children:[(0,$.jsxs)(S.View,{className:"FlexAlignCenter",children:[(0,$.jsxs)(S.View,{className:"FlexAlignCenter Flex1",children:[!P&&(0,$.jsx)(S.Text,{className:"ModuleTitleText",children:l}),I&&(0,$.jsx)(S.View,{className:"BrandInfoTitleImgBox",children:(0,$.jsx)(S.Image,{lazyLoad:!0,mode:"widthFix",className:"BrandInfoTitleImg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/gold_brand.png"})}),P&&(0,$.jsx)(S.View,{className:"BrandInfoTitleImgBox_self_new",children:(0,$.jsx)(S.Image,{lazyLoad:!0,mode:"widthFix",className:"BrandInfoTitleImg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/salebyself_newicon.png"})}),P&&!!w&&(0,$.jsx)(S.View,{className:"detailBusinessSelfNewIconUpgrade",children:(0,$.jsx)(S.Image,{lazyLoad:!0,mode:"widthFix",className:"BrandInfoTitleImg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/salebyself_newgrade_icon.png"})})]}),(0,$.jsxs)(S.View,{className:"ModuleTitlePosition",children:[(0,$.jsx)(S.Text,{className:"ModuleTitleSwitchText",children:y}),(0,$.jsx)(S.Text,{className:"ModuleTitleArrowIcon",children:"\ue944"})]})]}),(0,$.jsx)(S.View,{className:"BrandInfoCompanyBox",children:(0,$.jsx)(S.Text,{className:"BrandInfoCompanyName",children:P?"\u643a\u7a0b\u56fd\u9645\u65c5\u884c\u793e(\u5b98\u65b9)":u})}),(0,$.jsxs)(S.View,{className:"BrandInfoGradeBox",children:[d>0&&(0,$.jsxs)(S.View,{className:"BrandInfoGrade",style:{minWidth:140},children:[(0,$.jsxs)(S.View,{className:"FlexVerticalCenter MarginBottom16",children:[(0,$.jsx)(S.Text,{className:"BrandInfoGradeNumText",children:d}),!(!x||!v)&&(0,$.jsxs)(S.View,{className:"BrandInfoGradeContent FlexAlignCenter",children:[(0,$.jsx)(S.Image,{lazyLoad:!0,className:"BrandInfoGradeImg",src:x}),(0,$.jsx)(S.Text,{className:"BrandInfoContentText FontDark",children:v})]})]}),(0,$.jsx)(S.View,{className:"BrandInfoGradeDesc",children:(0,$.jsxs)(S.Text,{className:"BrandInfoContentText",children:["\u5546\u6237\u5728",(0,$.jsx)(S.Text,{className:"FontDark FontW500",children:m}),"\u7684\u7efc\u5408\u8bc4\u5206"]})})]}),!!T&&Number(T)>0&&(0,$.jsxs)(S.View,{className:"BrandInfoGrade",children:[(0,$.jsx)(S.View,{className:"BrandInfoGradeNum",children:(0,$.jsxs)(S.Text,{className:"BrandInfoGradeNumText",children:[T,"%"]})}),(0,$.jsx)(S.View,{className:"BrandInfoGradeDesc",children:(0,$.jsx)(S.Text,{className:"BrandInfoContentText",children:"\u5bfc\u6e38\u597d\u8bc4\u7387"})})]}),!!f&&(0,$.jsxs)(S.View,{className:"BrandInfoGrade",children:[(0,$.jsx)(S.View,{className:"BrandInfoGradeNum",children:(0,$.jsx)(S.Text,{className:"BrandInfoGradeNumText",children:f})}),(0,$.jsx)(S.View,{className:"BrandInfoGradeDesc",children:(0,$.jsx)(S.Text,{className:"BrandInfoContentText",children:"\u7d2f\u8ba1\u670d\u52a1\u4eba\u6570"})})]})]})]})]})}function at(e){var t=e.productList,n=Y.useState((function(e){var t=e.BasicInfo,n=e.actionIdSuffix;return{BasicInfo:t,actionIdSuffix:n}})),r=n.BasicInfo,i=n.actionIdSuffix;if(!t||!t.length)return null;var a=Y.useActions().handlers.handleGoRecommendDetail;return(0,$.jsx)(S.ScrollView,{scrollX:!0,scrollWithAnimation:!0,children:(0,$.jsx)(S.View,{className:"BrandInfoCardContainer",children:t.map((function(e){var t=e.ProductId,n=e.Name,o=e.MinPrice,s=e.ImgUrl,c=e.TagGroup.RecDesc,l=e.Active;return(0,$.jsx)(ot,{DepartureId:r.DepartureId,handleGoRecommendDetail:a,Active:l,ProductId:t,Name:n,RecDesc:c,MinPrice:o,ImgUrl:s,actionIdSuffix:i,BasicInfo:r},t)}))})})}function ot(e){var t=e.DepartureId,n=e.Name,r=e.MinPrice,i=e.ImgUrl,a=e.RecDesc,o=e.Active,s=e.handleGoRecommendDetail,c=e.ProductId,l=e.actionIdSuffix,u=e.BasicInfo;return i=i?i.replace("_326_210_Q90.","_210_210_Q90."):"",(0,$.jsxs)(S.View,{className:"BrandInfoCard",onClick:function(e){o&&(s({productid:c,departcityid:t}),X().uploadUserAction(e,"".concat(l,"-recommend-product-0-").concat(u.ProductId,"-").concat(c)))},children:[(0,$.jsxs)(S.View,{className:"BrandInfoImgBox",children:[(0,$.jsx)(S.Image,{lazyLoad:!0,className:"BrandInfoImgPic",mode:"widthFix",src:i||""}),(0,$.jsx)(S.View,{className:"BrandInfoTag",children:(0,$.jsx)(S.Text,{className:"BrandInfoTagText",children:a})})]}),(0,$.jsxs)(S.View,{className:"BrandInfoNameBox",children:[(0,$.jsx)(S.View,{className:"BrandInfoTitleBox",children:(0,$.jsx)(S.Text,{className:"BrandInfoTitleText MultipuleLineOverflow2",children:n})}),(0,$.jsx)(S.View,{className:"BrandInfoPriceNumber",children:o?r>0?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(S.Text,{className:"BrandInfoPriceYuan",children:"\uffe5"}),(0,$.jsx)(S.Text,{className:"BrandInfoPriceNu",children:r}),(0,$.jsx)(S.Text,{className:"BrandInfoPriceTip",children:"\u8d77"})]}):(0,$.jsx)(S.Text,{className:"BrandInfoPriceInTime",children:"\u5b9e\u65f6\u8ba1\u4ef7"}):(0,$.jsx)(S.Text,{className:"BrandInfoPriceInTime",children:"\u4e0d\u53ef\u8ba2"})})]})]})}function st(e){if(e&&e>0){var t=100*e;return Number.isInteger(t)?Number(t):Number(t).toFixed(1)}return""}function ct(){var e=Y.useState((function(e){var t=e.currentRouteInfo;return{currentRouteInfo:t}})),t=e.currentRouteInfo;return t?(0,$.jsx)($.Fragment,{children:(0,$.jsx)(S.View,{className:"detailoneTipBg",children:(0,$.jsxs)(S.View,{className:"OrderKnowBoxNew",id:"OrderKnow",children:[(0,$.jsx)(ut,{}),(0,$.jsx)(lt,{}),(0,$.jsx)(dt,{}),(0,$.jsx)(mt,{Code:"31"}),(0,$.jsx)(mt,{Code:"10001"}),(0,$.jsx)(mt,{Code:"38"}),(0,$.jsx)(mt,{Code:"72"}),(0,$.jsx)(mt,{Code:"10002"}),(0,$.jsx)(mt,{Code:"10000"}),(0,$.jsx)(ft,{})]})})}):null}function lt(){var e=Y.useState((function(e){var t=e.pageStatus,n=e.currentRouteInfo,r=e.isSelectPreSale,i=e.isPremium,a=e.isPreSale;return{pageStatus:t,currentRouteInfo:n,isSelectPreSale:r,isPremium:i,isPreSale:a}})),t=(e.pageStatus,e.currentRouteInfo),n=e.isSelectPreSale,r=e.isPremium,i=e.isPreSale,a=Y.useActions().handlers.handleTogglePreSaleNoticeMask,o=t.PreSaleNotice;if(!i)return null;if(!o)return null;if(!n)return null;var s="https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/orderknow_presale.png";return r&&(s.endsWith("_p.png")||(s=s.replace(".png","_p.png"))),(0,$.jsx)(S.View,{className:"OrderKnowItemNewBg",children:(0,$.jsxs)(S.View,{onClick:function(){a({status:!0,selectType:"PreSaleRule"})},className:"OrderKnowItemNew",children:[(0,$.jsx)(S.View,{className:"OrderKnowItemIcon",children:(0,$.jsx)(S.Image,{className:"OrderKnowItemIconImg",src:s})}),(0,$.jsxs)(S.View,{className:"OrderKnowItemTitle",children:[(0,$.jsx)(S.Text,{className:"Color1_Body2_Bold",children:"\u9884\u552e\u8bf4\u660e"}),(0,$.jsx)(S.Text,{className:"OrderKnowItemSub Color3_Cap2",children:"\u9884\u7ea6\u89c4\u5219\u53ca\u6d41\u7a0b\u3001\u9000\u6539\u653f\u7b56\u3001\u53d1\u7968\u4fe1\u606f"})]}),(0,$.jsx)(S.View,{className:"OrderKnowItemNewIcon",children:(0,$.jsx)(S.Text,{className:"Color1_Body2 detailIcon",children:"\ue944"})})]})})}function ut(){var e=Y.useState((function(e){var t=e.currentRouteInfo;return{currentRouteInfo:t}})),t=e.currentRouteInfo,n=void 0===t?{}:t,r=n.OrderKnow;if(!r)return null;var i=r.ContractDesc;return i?(i=i.replace(/<br\s*\/?>/g,"\n"),(0,$.jsxs)(S.View,{className:"ContractDescBox",children:[(0,$.jsx)(S.Text,{className:"bookingNeedKnow",children:"\u8d2d\u4e70\u987b\u77e5"}),(0,$.jsx)(S.Text,{className:"OrderKnowContractDesc",children:i})]})):null}function dt(){var e=Y.useState((function(e){return e.BasicInfo})),t=Y.useState((function(e){return e.currentRouteInfo})),n=(Y.useState((function(e){return e.actionIdSuffix})),Y.useActions().handlers.handleGoVisa),r=t.Visa,i=t.TravelIntroductionInfo;if(!e)return null;var a=[11,12,26,34].includes(e.ProductCategoryId)||e.isCruise;if(!r||!a)return null;var o=r.VisaCountryList,s=r.VisaDescList;if((!o||!o.length)&&(!s||!s.length))return null;var c="\u7b7e\u8bc1";53===e.DestProvinceId&&(c="\u5165\u53f0\u8bc1"),[58,59].indexOf(e.DestCityId)>-1&&(c="\u7b7e\u6ce8");var l="https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/orderknow_visa.png",u=It(r,i);return(0,$.jsx)(S.View,{className:"OrderKnowItemNewBg",children:(0,$.jsxs)(S.View,{className:"OrderKnowItemNew",onClick:function(){n()},children:[(0,$.jsx)(S.View,{className:"OrderKnowItemIcon",children:(0,$.jsx)(S.Image,{className:"OrderKnowItemIconImg",src:l})}),(0,$.jsxs)(S.View,{className:"OrderKnowItemTitle",children:[(0,$.jsx)(S.Text,{className:"OrderKnowItemText",children:c}),(0,$.jsx)(S.Text,{className:"OrderKnowItemVisaSub MultipuleLineOverflow2",children:u})]}),(0,$.jsx)(S.View,{className:"OrderKnowItemNewIcon",children:(0,$.jsx)(S.Text,{className:"detailIcon",children:"\ue944"})})]})})}function ft(){var e=Y.useState((function(e){return e.currentRouteInfo})),t=Y.useState((function(e){return e.pageStatus})),n=(Y.useState((function(e){return e.actionIdSuffix})),Y.useActions().handlers.handleGoCostMore),r=e||{},i=r.SelfPayInfoList,a=t.activeProductId;if(!i||!i.length)return null;var o="https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/orderknow_cost.png";return(0,$.jsxs)(S.View,{className:"OrderKnowItemNew OrderKnowItemNewBg",onClick:function(){n(a)},children:[(0,$.jsx)(S.View,{className:"OrderKnowItemIcon",children:(0,$.jsx)(S.Image,{className:"OrderKnowItemIconImg",src:o})}),(0,$.jsxs)(S.View,{className:"OrderKnowItemTitle",children:[(0,$.jsx)(S.Text,{className:"OrderKnowItemText",children:"\u63a8\u8350\u81ea\u8d39\u9879\u76ee\uff0c\u4ec5\u4f9b\u53c2\u8003"}),(0,$.jsx)(S.Text,{className:"OrderKnowItemSub",children:"\u5efa\u8bae\u6027\u9879\u76ee\u3001\u81ea\u613f\u81ea\u8d39\u3001\u65e0\u5f3a\u5236\u6d88\u8d39"})]}),(0,$.jsx)(S.View,{className:"OrderKnowItemNewIcon",children:(0,$.jsx)(S.Text,{className:"detailIcon",children:"\ue944"})})]})}var pt={31:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/orderknow_bookinglimit.png",10001:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/orderknow_hotelinfo.png",38:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/orderknow_tourdesc.png",10002:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/orderknow_notes.png",72:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/orderknow_defaultinfo.png",1e4:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/orderknow_tips.png"};function mt(e){var t=e.Code,n=Y.useState((function(e){return e.currentRouteInfo})),r=(Y.useState((function(e){return e.actionIdSuffix})),Y.useActions().handlers.handleGoBookingNote),i=n.OrderKnow;if(!i)return null;var a=i.OrderKnowList;if(!a||!a.length)return null;var o=a.find((function(e){return e.Code===t}));if(!o||!o.InfrastructureInfoList&&!o.DescList)return null;var s="";o.InfrastructureInfoList&&o.InfrastructureInfoList.length&&(s=o.InfrastructureInfoList.map((function(e){return e.Category})).slice(0,4).join("\u3001"));var c=pt[t];return(0,$.jsx)(S.View,{className:"OrderKnowItemNewBg",children:(0,$.jsxs)(S.View,{className:"OrderKnowItemNew",onClick:function(){r({Code:t})},children:[(0,$.jsx)(S.View,{className:"OrderKnowItemIcon",children:(0,$.jsx)(S.Image,{className:"OrderKnowItemIconImg",src:c})}),(0,$.jsxs)(S.View,{className:"OrderKnowItemTitle",children:[(0,$.jsx)(S.Text,{className:"OrderKnowItemText",children:o.Title}),!!s&&(0,$.jsx)(S.Text,{className:"OrderKnowItemSub",children:s})]}),(0,$.jsx)(S.View,{className:"OrderKnowItemNewIcon",children:(0,$.jsx)(S.Text,{className:"detailIcon",children:"\ue944"})})]})})}var It=function(e,t){var n={1:"\u4e0d\u9700\u672c\u4eba\u5230\u573a",2:"\u9700\u7b49\u5f85\u643a\u7a0b\u901a\u77e5\u662f\u5426\u9700\u672c\u4eba\u5230\u573a",3:"\u9700\u672c\u4eba\u5230\u573a"},r="";if(t&&t.TravelIntroductionList&&t.TravelIntroductionList[0]){var i=t.TravelIntroductionList[0].TravelSummaryInfoList,a=i.find((function(e){return 9===e.SummaryType}));a&&a.SummaryItems&&a.SummaryItems[0]&&(r=a.SummaryItems[0].ItemText)}var o=[];if(e&&e.VisaCountryList&&e.VisaCountryList.length){var s=e.VisaCountryList;if(1===s.length){var c=s[0],l=c.VisaInterview,u=(c.VisaType,c.VisaTypeName),d=l?"".concat(n[l],"\uff0c\u529e\u7406\u7c7b\u578b\u4e3a").concat(u):"\u529e\u7406\u7c7b\u578b\u4e3a".concat(u);o.push(d)}else{var f=s.every((function(e){return e.VisaInterview===s[0].VisaInterview&&e.VisaType===s[0].VisaType}));if(f){var p=s[0],m=p.VisaInterview,I=(p.VisaType,p.VisaTypeName),h=m?"".concat(n[m],"\uff0c\u529e\u7406\u7c7b\u578b\u4e3a").concat(I):"\u529e\u7406\u7c7b\u578b\u4e3a".concat(I);o.push(h)}else s.forEach((function(e){var t=e.Country,r=e.VisaInterview,i=(e.VisaType,e.VisaTypeName),a=r?"".concat(t,"\uff1a").concat(n[r],"\uff0c\u529e\u7406\u7c7b\u578b\u4e3a").concat(i):"".concat(t,"\uff1a\u529e\u7406\u7c7b\u578b\u4e3a").concat(i);o.push(a)}))}}var g=o.join("\u3002");return r&&g?"".concat(r,"\uff0c").concat(g):"".concat(r).concat(g)},ht={1:"\u6210\u4eba",2:"\u513f\u7ae5"},gt={1:"\u6210\u4eba",2:"*\u513f\u7ae5"},vt=g.memo(St),xt=vt;function St(){var e=Y.useState((function(e){var t=e.currentRouteInfo,n=t.CostInfoList,r=t.FeeInfoList,i=t.BasicExtendInfo,a=e.BasicInfo,o=e.actionIdSuffix;return{CostInfoList:n,FeeInfoList:r,BasicExtendInfo:i,BasicInfo:a,actionIdSuffix:o}})),t=e.CostInfoList,n=e.FeeInfoList,r=e.BasicExtendInfo,i=e.BasicInfo,a=e.actionIdSuffix,o=i.isPureDiyfhxsdp,s=i.isStudy,c=i.isCruise,l=s?2:1,u=r||{},d=u.PriceStandardList,f=void 0===d?[]:d;if(f&&f.length>0){var p=f.filter((function(e){return 2===e.PassengerType}))[0].IsCanBook;p||(l=1)}var m,I,v=(0,g.useState)(l),x=(0,h.Z)(v,2),T=x[0],P=x[1];if(o||c){if(!t||!Object.values(t)||!Object.values(t).length)return null}else if(!n||!f)return null;if(n&&(m=n&&n.filter((function(e){return 15===Number(e.SubTitleCode)}))[0]&&n.filter((function(e){return 15===Number(e.SubTitleCode)}))[0].ProductClauseList,I=n&&n.filter((function(e){return 71===Number(e.SubTitleCode)}))[0]&&n.filter((function(e){return 71===Number(e.SubTitleCode)}))[0].ProductClauseList),o||c)return(0,$.jsx)(yt,{CostInfoList:t});var y=f.slice().sort((function(e){return s?-e.PassengerType:e.PassengerType})),w=f.filter((function(e){return e.PassengerType===T}))[0].Title,C=T!==l,N=!1;if(f&&f.length){var D=f.filter((function(e){return 2===e.PassengerType}))[0];if(D){var j=D.MinHeight,_=D.MaxHeight,b=D.MinAge,k=D.MaxAge;(j||_)&&(b||k)&&(N=!0)}}return 2!==T&&(N=!1),(0,$.jsxs)(S.View,{className:"NewModuleBox",id:"CostDescription",children:[(0,$.jsx)(S.Text,{className:"NewCostDescriptionTitle NewModuleTitleText MarginBottom24",children:"\u8d39\u7528\u4fe1\u606f"}),(0,$.jsx)(S.View,{className:"FlexAlignCenter MarginBottom24",children:y.map((function(e,t){var n=e.PassengerType,r=e.IsCanBook,i=n===T;return(0,$.jsx)(S.View,{className:"NewCostDescriptionPassenger ".concat(r?"":"NewCostDescriptionPassengerDisabled"," ").concat(i?"NewCostDescriptionPassengerSelected":"","\n                        "),onClick:function(e){r&&P(n),X().uploadUserAction(e,"".concat(a,"-labelblock-select-").concat(n-1))},children:(0,$.jsxs)(S.Text,{className:"NewCostDescriptionPassengerText",children:[gt[n],!r&&"\u4e0d\u53ef\u8ba2"]})})}))}),(0,$.jsxs)(S.View,{className:"NewCostDescriptionApplicablePerson",children:["\u4ee5\u4e0b\u8bf4\u660e\u4ec5\u9002\u7528",ht[T],!!w&&" (".concat(w,")")]}),C&&(0,$.jsx)(S.View,{className:"NewCostDescriptionApplicablePerson",children:s?"* \u4e3a\u6210\u4eba\u4e0e\u513f\u7ae5\u6709\u5dee\u5f02\u7684\u9879\u76ee\uff0c\u8bf7\u7279\u522b\u7559\u610f":"* \u4e3a\u513f\u7ae5\u4e0e\u6210\u4eba\u6709\u5dee\u5f02\u7684\u9879\u76ee\uff0c\u8bf7\u7279\u522b\u7559\u610f"}),N&&(0,$.jsx)(S.View,{className:"NewCostDescriptionApplicablePerson",children:"* \u6ee1\u8db3\u5e74\u9f84\u6761\u4ef6\u7684\u513f\u7ae5\u8eab\u9ad8\u4e0d\u7b26\u65f6\uff0c\u8bf7\u6309\u513f\u7ae5\u4e0b\u5355\uff0c\u53ef\u80fd\u4f1a\u6d89\u53ca\u73b0\u573a\u8865\u5dee\u4ef7\uff0c\u7531\u670d\u52a1\u4eba\u5458\u73b0\u573a\u534f\u52a9\u5904\u7406\uff0c\u5177\u4f53\u5dee\u4ef7\u91d1\u989d\u4ee5\u73b0\u573a\u62a5\u4ef7\u4e3a\u51c6\u3002"}),!!m&&m.length>0&&(0,$.jsx)(Tt,{feeInfos:m,setCurPassengerType:P,curPassengerType:T,initPassengerType:l,PriceStandardList:f,isStudy:s,actionIdSuffix:a}),!!I&&I.length>0&&(0,$.jsx)(Pt,{feeInfos:I,PriceStandardList:f})]})}function Tt(e){var t=e.feeInfos,n=(e.setCurPassengerType,e.initPassengerType),r=e.curPassengerType,i=e.PriceStandardList,a=(e.isStudy,e.actionIdSuffix,Y.useActions().handlers.handleToggleGODetailMask),o=r!==n;if(i&&i.length){var s=i.filter((function(e){return 2===e.PassengerType}))[0];if(s){var c=s.MinHeight,l=s.MaxHeight,u=s.MinAge,d=s.MaxAge;(c||l)&&(u||d)&&!0}}return 2!==r&&!1,(0,$.jsx)(S.View,{className:"NewCostDescriptionBlock",children:(0,$.jsxs)(S.View,{className:"NewCostDescriptionTable",children:[(0,$.jsxs)(S.View,{className:"NewCostDescriptionTableTitleBg",children:[(0,$.jsx)(S.Text,{className:"NewCostDescriptionTableTitleIcon",children:"\ued1e"}),(0,$.jsx)(S.Text,{className:"NewCostDescriptionTableTitleText",children:"\u8d39\u7528\u5305\u542b"})]}),t.map((function(e,n){if(!e)return null;var i=e.ClauseTypeName,s=e.ClauseTypeId,c=e.ClauseSubItemList;if(!c||!c.length)return null;t.length;var l=c.some((function(e){return 0!==e.DifferenceType}))&&o;return(0,$.jsxs)(S.View,{className:"NewCostDescriptionTableTd",children:[(0,$.jsx)(S.View,{className:"NewCostDescriptionTableTdLeft",children:(0,$.jsxs)(S.View,{className:"NewCostDescriptionTableConsistent",children:[l&&(0,$.jsx)(S.Text,{className:"NewCostDescriptionTipIconNew",children:"*"}),(0,$.jsx)(S.Text,{className:"NewCostDescriptionTableTextLeft",children:i})]})}),(0,$.jsx)(S.View,{className:"NewCostDescriptionTableTdRight",children:c.map((function(e,t){e.DifferenceType;var n=e.SubTitle,i=e.TargetPopulationItemList,o=i&&i.filter((function(e){return[1,r+1].includes(e.TargetPopulation)}));return(0,$.jsxs)(g.Fragment,{children:[o.map((function(e,t){var r=e.ClauseId,i=e.Description,o=e.IsHighlight;if(!i)return null;i=i.replace(/<br\s*\/?>/g,"\n");var s=o?{color:"#ff7700",fontWeight:600}:{},c=32666===r;return(0,$.jsxs)(S.Text,{className:"NewCostDescriptionTableTextRight",style:s,onClick:function(){c&&a(!0)},children:[!!n&&"".concat(n,"\uff1a"),i,!!c&&(0,$.jsxs)(S.Text,{className:"bookingDetailIcon",children:[" ","\ue931"]})]},r)})),(0,$.jsx)(wt,{ClauseTypeId:s,infos:o})]})}))})]},s)}))]})})}function Pt(e){var t=e.feeInfos,n=(e.PriceStandardList,Y.useActions().handlers.handleToggleScenicExcludingFeeMask),r=Y.useState((function(e){var t=e.currentRouteInfo;return{currentRouteInfo:t}})),i=r.currentRouteInfo,a=!1,o=i.TravelIntroductionInfo;if(o&&o.TravelIntroductionList){var s=(o.TravelIntroductionList||{})[0]||{},l=s.TravelOverviewInfo,u=l||{},d=u.ScenicSportSelfActiveList;a=d&&d.length}return(0,$.jsxs)(S.View,{className:"NewCostDescriptionBlock NewCostDescriptionBlock_new",children:[(0,$.jsxs)(S.View,{className:"NewCostDescriptionBlockBg",children:[(0,$.jsx)(S.Text,{className:"NewCostDescriptionBlockIcon",children:"\ued1f"}),(0,$.jsx)(S.Text,{className:"NewCostDescriptionBlockexclude",children:"\u8d39\u7528\u4e0d\u542b"})]}),(0,$.jsx)(S.View,{className:"NewCostDescriptionTable_new",children:t.map((function(e,t){if(!e)return null;var r=e.ClauseTypeName,i=e.ClauseTypeId,o=e.ClauseSubItemList,s={};o.forEach((function(e){var t=e.TargetPopulationItemList,n=e.SubTitle;t.forEach((function(e){var t=e.TargetPopulation,r=e.Description,i=(0,c.Z)((0,c.Z)({},e),{},{Description:n?"".concat(n,"\uff1a").concat(r):r});s[t]?s[t].push(i):s[t]=[i]}))}));var l=58===i&&a;return(0,$.jsxs)(S.View,{className:"NewCostDescriptionTableTd",children:[(0,$.jsx)(S.View,{className:"NewCostDescriptionTableTdLeft",children:(0,$.jsx)(S.Text,{className:"NewCostDescriptionTableTextLeft",children:r})}),(0,$.jsx)(S.View,{className:"NewCostDescriptionTableTdRight",children:Object.keys(s).map((function(e,t){var r=s[e];return(0,$.jsxs)(S.View,{children:[r.map((function(e){var t=e.ClauseId,n=e.Description,r=e.IsHighlight;if(!n)return null;n=n.replace(/<br\s*\/?>/g,"\n");var i=r?{color:"#ff7700",fontWeight:600}:{};return(0,$.jsx)(S.Text,{className:"NewCostDescriptionTableTextRight",style:i,children:n},t)})),l&&(0,$.jsxs)(S.View,{className:"NewSelfFundBtn",onClick:function(){n(!0)},children:[(0,$.jsx)(S.Text,{className:"NewSelfFundBtnText",children:"\u67e5\u770b\u5b8c\u6574\u4fe1\u606f"}),(0,$.jsx)(S.Text,{className:"NewSelfFundBtnIcon",children:"\ue944"})]})]})}))})]},i)}))})]})}function yt(e){var t=e.CostInfoList;return t?(0,$.jsxs)(S.View,{className:"NewModuleBox",id:"CostDescription",children:[(0,$.jsx)(S.Text,{className:"NewCostDescriptionTitle NewModuleTitleText MarginBottom24",children:"\u8d39\u7528\u4fe1\u606f"}),Object.values(t).map((function(e,t){var n=e.Category,r=e.DescriptionList;return r.length?(0,$.jsx)(S.View,{className:"NewCostDescriptionBlock",children:(0,$.jsxs)(S.View,{className:"NewCostDescriptionTable",children:[(0,$.jsx)(S.View,{className:"NewCostDescriptionTableTitleBg",children:(0,$.jsx)(S.Text,{className:"NewCostDescriptionTableTitleText",children:n})}),r.map((function(e,t){return e?(e=e.replace(/<(\/?)(?!br).*?>/gi,"").replace(/<br\s*\/?>/g,"\n"),(0,$.jsxs)(S.View,{className:"NewCostDescriptionTableTd",children:[(0,$.jsx)(S.View,{className:"NewCostDescriptionTableTdLeftWithIndex",children:(0,$.jsx)(S.Text,{className:"NewCostDescriptionTableTextLeft",children:t+1})}),(0,$.jsx)(S.View,{className:"NewCostDescriptionTableTdRight",children:(0,$.jsx)(S.Text,{className:"NewCostDescriptionTableTextRight",children:e})})]},t)):null}))]})},t):null}))]}):null}function wt(e){var t=e.ClauseTypeId,n=e.infos,r=Y.useActions().handlers,i=r.handleGoThemeEquipment,a=r.handleGoThemeGuide;return 1001===t?(0,$.jsxs)(S.View,{className:"NewSelfFundBtn",onClick:function(){i()},children:[(0,$.jsx)(S.Text,{className:"NewSelfFundBtnText",children:"\u67e5\u770b\u5b8c\u6574\u88c5\u5907\u4fe1\u606f"}),(0,$.jsx)(S.Text,{className:"NewSelfFundBtnIcon",children:"\ue944"})]}):4===t&&n.some((function(e){return 101===e.ClauseId}))?(0,$.jsxs)(S.View,{className:"NewSelfFundBtn",onClick:function(){a()},children:[(0,$.jsx)(S.Text,{className:"NewSelfFundBtnText",children:"\u67e5\u770b\u5b8c\u6574\u5411\u5bfc\u4fe1\u606f"}),(0,$.jsx)(S.Text,{className:"NewSelfFundBtnIcon",children:"\ue944"})]}):4===t&&n.some((function(e){return 102===e.ClauseId}))?(0,$.jsxs)(S.View,{className:"NewSelfFundBtn",onClick:function(){a()},children:[(0,$.jsx)(S.Text,{className:"NewSelfFundBtnText",children:"\u67e5\u770b\u5b8c\u6574\u6559\u7ec3\u4fe1\u606f"}),(0,$.jsx)(S.Text,{className:"NewSelfFundBtnIcon",children:"\ue944"})]}):4===t&&n.some((function(e){return 103===e.ClauseId}))?(0,$.jsxs)(S.View,{className:"NewSelfFundBtn",onClick:function(){a()},children:[(0,$.jsx)(S.Text,{className:"NewSelfFundBtnText",children:"\u67e5\u770b\u5b8c\u6574\u5411\u5bfc/\u6559\u7ec3\u4fe1\u606f"}),(0,$.jsx)(S.Text,{className:"NewSelfFundBtnIcon",children:"\ue944"})]}):null}var Ct=g.memo(Dt),Nt=Ct;function Dt(){var e=Y.useState((function(e){var t=e.productExtend;return{productExtend:t}})),t=e.productExtend;if(!t)return null;var n=Y.useActions().handlers.handleGoRecommendDetail,r=t.MoreRecommendProductList;return!r||r.length<1?null:(0,$.jsxs)(S.View,{className:"MoreRecommendContainer",children:[(0,$.jsx)(S.View,{className:"MoreRecommendTextBox FlexVerticalCenter",children:(0,$.jsx)(S.Text,{className:"MoreRecommendText",children:"\u66f4\u591a\u63a8\u8350"})}),(0,$.jsx)(S.View,{className:"RecommendCardContainer",children:r.map((function(e){if(!e.ImageUrl)return null;var t=e.ImageUrl.replace("_500_280","_500_333").replace("_192_192","_500_333").replace("_Q70.","_Q90."),r={productid:e.ProductId,departcityid:e.StartCityId},i=(e.StartCityId,e.StartCityId,e.ProductId,e.ProductId),a=e.Pattern,o=e.ProductName,s=e.MinPrice;return(0,$.jsx)(jt,{productInfo:r,handleGoRecommendDetail:n,ImageUrl:t,Pattern:a,ProductName:o,MinPrice:s},i)}))})]})}function jt(e){var t=e.ImageUrl,n=e.Pattern,r=e.ProductName,i=e.MinPrice,a=e.handleGoRecommendDetail,o=e.productInfo;return t?(0,$.jsxs)(S.View,{onClick:function(){return a(o)},className:"RecommendCard",children:[(0,$.jsx)(S.View,{className:"RecommendTag FlexVerticalCenter",children:(0,$.jsx)(S.Text,{className:"RecommendTagText",children:n})}),(0,$.jsx)(S.View,{className:"RecommendImgBox",children:(0,$.jsx)(S.Image,{lazyLoad:!0,className:"RecommendImgPic",mode:"aspectFill",src:t})}),(0,$.jsxs)(S.View,{className:"RecommendInfoBox",children:[(0,$.jsx)(S.View,{className:"RecommendTitleBox",children:(0,$.jsx)(S.Text,{className:"RecommendTitleText MultipuleLineOverflow2 FontW600",children:r})}),(0,$.jsx)(S.View,{className:"RecommendPriceNumber",children:i>0?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(S.Text,{className:"RecommendPriceYuan",children:"\uffe5"}),(0,$.jsx)(S.Text,{className:"RecommendPriceNum",children:i}),(0,$.jsx)(S.Text,{className:"RecommendPriceTip",children:"\u8d77"})]}):(0,$.jsx)(S.Text,{className:"RecommendPriceInTime ",children:"\u5b9e\u65f6\u8ba1\u4ef7"})})]})]}):null}function _t(){var e=Y.useActions().handlers.handleGoSecurityInfo,t=Y.useState((function(e){var t=e.BasicInfo,n=e.actionIdSuffix;return{BasicInfo:t,actionIdSuffix:n}})),n=t.BasicInfo,r=t.actionIdSuffix,i=n.isDiyfhxsdp?"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/axd_diy.png":"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/axd_grp.png";return(0,$.jsx)(S.View,{className:"SecurityInfoContainer",onClick:function(t){e(),X().uploadUserAction(t,"".concat(r,"-recommend-ins"))},children:(0,$.jsx)(S.Image,{lazyLoad:!0,className:"SecurityInfoImg",mode:"widthFix",src:i})})}var bt=n(60403);function kt(e){var t=e.selectDateFn;return(0,$.jsxs)(S.View,{className:"FixedButtom",children:[(0,$.jsx)(Et,{}),(0,$.jsx)(Vt,{}),(0,$.jsxs)(S.View,{className:"FooterContainer",children:[(0,$.jsxs)(S.View,{className:"FooterFunctionContainer",children:[(0,$.jsx)(Lt,{}),(0,$.jsx)(Bt,{}),(0,$.jsx)(Rt,{})]}),(0,$.jsx)(Mt,{selectDateFn:t})]}),(0,$.jsx)(bt.Z,{})]})}function Lt(){var e=Y.useState((function(e){var t=e.brandScore,n=e.actionIdSuffix,r=e.BasicInfo;return{brandScore:t,actionIdSuffix:n,BasicInfo:r}})),t=e.brandScore,n=e.actionIdSuffix,r=e.BasicInfo,i=Y.useActions().handlers.handleGoShopDetail;return r.isDiyfhxsdp||r.isStudy||t&&!t.shopInfo||"G"===r.SaleMode?null:(0,$.jsxs)(S.View,{className:"FooterFunction",onClick:function(e){i(),X().uploadUserAction(e,"".concat(n,"-bottom-shop"))},children:[(0,$.jsx)(S.Text,{className:"FooterFunctionIcon",children:"\udb80\udc1b"}),(0,$.jsx)(S.Text,{className:"FooterFunctionText",children:"\u5e97\u94fa"})]})}function Bt(){var e=Y.useActions().handlers.handleClickFavorite,t=Y.useState((function(e){var t=e.myFavorites,n=e.actionIdSuffix;return{myFavorites:t,actionIdSuffix:n}})),n=t.myFavorites,r=t.actionIdSuffix,i=n||{},a=i.isFavorite;return(0,$.jsxs)(S.View,{className:"FooterFunction",onClick:function(t){e(),X().uploadUserAction(t,"".concat(r,"-bottom-fav"))},children:[a?(0,$.jsx)(S.Text,{className:"FooterFunctionIcon FontRed",children:"\ue958"}):(0,$.jsx)(S.Text,{className:"FooterFunctionIcon",children:"\ue957"}),(0,$.jsx)(S.Text,{className:"FooterFunctionText",children:"\u6536\u85cf"})]})}function Rt(){var e=Y.useState((function(e){var t=e.imEntryInfo,n=e.actionIdSuffix,r=e.BasicInfo;return{imEntryInfo:t,actionIdSuffix:n,BasicInfo:r}})),t=e.imEntryInfo,n=e.actionIdSuffix,r=e.BasicInfo,i=Y.useActions().handlers.handleToggleCustomerServiceMask;if(!t)return null;var a=t.imInfo,o=t.serviceInfo;if(!a)return null;var s=a.isShowEntry;if(!s)return null;var c=null===o||void 0===o?void 0:o.shortServiceToast;return(0,$.jsxs)(S.View,{className:"FooterFunction",onClick:function(e){i(!0),X().uploadUserAction(e,"".concat(n,"-bottom-IM-").concat(r.ProductId))},children:[(0,$.jsx)(S.Text,{className:"FooterFunctionIcon",children:"\udb80\udcd6"}),(0,$.jsx)(S.Text,{className:"FooterFunctionText",children:"\u5ba2\u670d"}),!!c&&(0,$.jsx)(S.View,{className:"FooterFunctionTips",children:(0,$.jsx)(S.Text,{className:"FooterFunctionTipsText",children:c})})]})}function Mt(e){var t=e.selectDateFn,n=Y.useState((function(e){var t=e.currentRouteInfo,n=e.ScheduleInfo,r=e.bookingRuleInfo,i=e.isShowLineSwitchLoading,a=e.actionIdSuffix,o=e.isSelectPreSale,s=e.pageStatus,c=e.groupCard,l=e.isPreSale,u=e.TourGroupInfo,d=e.newProcessSelectDate,f=e.routeInfo,p=e.priceCalendarData,m=e.BasicInfo,I=e.isPremium,h=e.BookInfo;return{currentRouteInfo:t,ScheduleInfo:n,bookingRuleInfo:r,isShowLineSwitchLoading:i,actionIdSuffix:a,isSelectPreSale:o,pageStatus:s,groupCard:c,isPreSale:l,TourGroupInfo:u,newProcessSelectDate:d,routeInfo:f,priceCalendarData:p,BasicInfo:m,isPremium:I,BookInfo:h}})),r=n.currentRouteInfo,i=n.ScheduleInfo,a=n.bookingRuleInfo,c=n.isShowLineSwitchLoading,l=n.actionIdSuffix,u=n.isSelectPreSale,d=n.pageStatus,f=n.groupCard,p=n.isPreSale,m=n.TourGroupInfo,I=n.newProcessSelectDate,h=n.routeInfo,T=n.priceCalendarData,P=n.BasicInfo,y=n.isPremium,w=n.BookInfo,C=Y.useActions().handlers,N=C.handleGoTravelIntention,D=C.handleNextPage,j=C.handleNextPage_Presale,_=C.handleTraceLog,b=!1,k=(0,g.useRef)(0),L=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var n,i,a;return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(f&&f.cards&&f.cards.length&&(i=f.cards.find((function(e){return e.productId===d.activeProductId})),p&&i&&i.preSaleProductInfo&&i.preSaleProductInfo.canBook&&(n=i.preSaleProductInfo.productId)),!(p&&u&&n)){e.next=8;break}return x().showLoading({title:"\u52a0\u8f7d\u4e2d",mask:!0}),e.next=5,j();case 5:x().hideLoading(),e.next=26;break;case 8:if(a=r.dailyMinPrices,a&&a.length||u){e.next=13;break}return x().pageScrollTo({selector:"#Taro_Scroll_To_Offset",duration:300}),x().showToast({title:"\u8bf7\u9009\u62e9\u73ed\u671f",duration:2e3,icon:"none"}),e.abrupt("return");case 13:if(!I){e.next=23;break}if(x().showLoading({title:"\u52a0\u8f7d\u4e2d",mask:!0}),!t.current){e.next=20;break}return e.next=18,t.current.handleSyncSelectDateStorage(I);case 18:return e.next=20,D();case 20:x().hideLoading(),e.next=26;break;case 23:return x().pageScrollTo({selector:"#Taro_Scroll_To_Offset",duration:300}),x().showToast({title:"\u8bf7\u9009\u62e9\u73ed\u671f",duration:2e3,icon:"none"}),e.abrupt("return");case 26:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=!1;if(a&&a.bookingRule&&a.bookingRule.CanBookingSingleResource&&(B=!0),r&&r.TravelIntroductionInfo&&!r.TravelIntroductionInfo.TravelIntroductionList&&(B=!1),i&&i.HasInventory&&w.IsBook&&!w.IsBookChannelError||(B=!1),a&&a.bookingRule&&a.bookingRule.IsHitTheRule){var R=a.bookingRule.BookingRuleType,M=2===R;M||(B=!1)}var E=r.scheduleDates;if(d.isMultiLine&&(!E||!E.length)){var V;if(f&&f.cards&&f.cards.length){var A=f.cards.find((function(e){return e.productId===d.activeProductId}));p&&A&&A.preSaleProductInfo&&A.preSaleProductInfo.canBook&&(V=A.preSaleProductInfo.productId)}V||(b=!0)}var Z="";if(d.isMultiLine){var O=m||{},U=O.TourGroupProductInfo,F=null===U||void 0===U?void 0:U.filter((function(e){return e.ProductId==d.activeProductId}))[0];if(F){var G=["A","B","C","D","E","F","G","H","I","J"];Z=G[F.SortNumber-1]}}var H=(0,v.getSystemInfoSync)(),K=H.statusBarHeight,z=(0,v.getMenuButtonBoundingClientRect)(),W=z.height+K+55;(0,v.usePageScroll)((function(e){var t=e.scrollTop;k.current=t}));var q=(0,g.useCallback)((function(e){var t=x().createSelectorQuery().select(e);t&&t.boundingClientRect((function(e){if(e){var t=k.current+e.top-W;x().pageScrollTo({scrollTop:t,duration:300,complete:function(){}})}})).exec()}),[]),J=h||{},Q=J.multiTravelScheduleDates,ee=d.activeAlias,te=d.isMultiTravel;if(te&&T&&Q&&!Q[ee]&&!Q.priceInTimeLines.includes(ee)&&(b=!0,Z=ee),!E)return(0,$.jsx)(S.View,{className:"Flex1 loadingButton",children:(0,$.jsx)(S.Text,{children:"\u52a0\u8f7d\u4e2d"})});if(!w.IsBook||b)return(0,$.jsx)(S.Button,{className:"FooterBtn SoldOut",children:(0,$.jsx)(S.Text,{className:"FooterBtnText",children:b?"".concat(Z,"\u7ebf\u4e0d\u53ef\u8ba2"):"\u4e0d\u53ef\u8ba2"})});if(y=!1,B){var ne=y?["#E0B770","#D1A04B"]:["#FFB114","#FF7700"];return(0,$.jsxs)(S.View,{className:"FooterBtnTwoBox",children:[(0,$.jsx)(S.View,{className:"Flex1",onClick:function(){q("#RouteInfo"),_("grp_prddtl_bottom_bar_click",{productid:P.ProductId})},children:(0,$.jsx)(S.View,{className:y?"FooterBtnContentTwoBigPicPremium":"FooterBtnContentTwoBigPic",children:(0,$.jsx)(S.Text,{className:y?"routeTextColorPremium":"routeTextColor",children:"\u770b\u6bcf\u65e5\u884c\u7a0b"})})}),c?(0,$.jsx)(S.View,{className:"Flex1",children:(0,$.jsx)(S.View,{className:"loadingButton",style:{backgroundImage:"linear-gradient(90deg, ".concat(ne[0]," 0%,").concat(ne[1]," 100%)")},children:(0,$.jsx)(S.Text,{style:{color:"#fff",fontSize:15,fontWeight:"bold"},children:"\u52a0\u8f7d\u4e2d"})})}):b?(0,$.jsx)(S.View,{className:"Flex1",children:(0,$.jsx)(S.View,{className:"FooterBtnContentTwo",children:(0,$.jsxs)(S.Text,{style:{color:"#999",fontSize:15,fontWeight:"bold"},children:[Z,"\u7ebf\u4e0d\u53ef\u8ba2"]})})}):(0,$.jsx)(S.View,{className:"Flex1",onClick:function(){L()},children:(0,$.jsx)(S.View,{className:"FooterBtnContentTwo",style:{backgroundImage:"linear-gradient(90deg, ".concat(ne[0]," 0%,").concat(ne[1]," 100%)")},children:(0,$.jsx)(S.Text,{style:{color:"#fff",fontSize:15,fontWeight:"bold"},children:"\u7acb\u5373\u9884\u8ba2"})})})]})}if(a&&a.bookingRule&&a.bookingRule.IsHitTheRule){var re=a.bookingRule,ie=re.BookingRuleType,ae=2===ie;return ae?(0,$.jsx)(S.Button,{className:"FooterBtn",onClick:function(){L()},children:(0,$.jsx)(S.Text,{className:"FooterBtnText",children:"\u7acb\u5373\u9884\u8ba2"})}):(0,$.jsx)(S.Button,{className:"FooterBtn",onClick:function(){N()},children:(0,$.jsx)(S.Text,{className:"FooterBtnText",children:"\u63d0\u4ea4\u9700\u6c42"})})}if(!i||!i.HasInventory){var oe;if(f&&f.cards&&f.cards.length){var se=f.cards.find((function(e){return e.productId===d.activeProductId}));p&&se&&se.preSaleProductInfo&&se.preSaleProductInfo.canBook&&(oe=se.preSaleProductInfo.productId)}return oe?(0,$.jsx)(S.Button,{className:"FooterBtn",onClick:function(e){L(),X().uploadUserAction(e,"".concat(l,"-bottom-order"))},children:(0,$.jsx)(S.Text,{className:"FooterBtnText",children:"\u7acb\u5373\u9884\u8ba2"})}):(0,$.jsx)(S.Button,{className:"FooterBtn SoldOut",children:(0,$.jsx)(S.Text,{className:"FooterBtnText",children:"\u4e0d\u53ef\u8ba2"})})}return(0,$.jsx)(S.Button,{className:"FooterBtn",onClick:function(e){L(),X().uploadUserAction(e,"".concat(l,"-bottom-order"))},children:(0,$.jsx)(S.Text,{className:"FooterBtnText",children:"\u7acb\u5373\u9884\u8ba2"})})}function Et(){var e=Y.useState((function(e){var t=e.bookingRuleInfo;return{bookingRuleInfo:t}})),t=e.bookingRuleInfo;if(!t||!t.bookingRule)return null;var n=t.bookingRule,r=n.BookingRuleType,i=n.BookingRuleNotice,a=n.IsHitTheRule;if(!a)return null;var o=i?i.Content:[];return(0,$.jsxs)(S.View,{className:"WarningBox",children:[(0,$.jsx)(S.View,{className:"WarningContentList",children:o.map((function(e,t){return(0,$.jsxs)(S.View,{className:"WarningItem",children:[(0,$.jsx)(S.View,{className:"WarningIcon",children:"\uef89"}),(0,$.jsx)(S.View,{className:"WarningText",children:e})]},t)}))}),(0,$.jsx)(At,{BookingRuleType:r})]})}function Vt(){var e=Y.useState((function(e){var t=e.BasicInfo,n=e.pageStatus,r=e.newProcessSelectDate,i=e.TourGroupInfo,a=e.isIPhoneX,o=e.isIOS,s=e.isSelectPreSale,c=e.currentRouteInfo,l=e.isPreSale,u=e.groupCard;return{BasicInfo:t,pageStatus:n,newProcessSelectDate:r,TourGroupInfo:i,isIPhoneX:a,isIOS:o,isSelectPreSale:s,currentRouteInfo:c,isPreSale:l,groupCard:u}})),t=e.BasicInfo,n=e.pageStatus,r=e.newProcessSelectDate,i=e.TourGroupInfo,a=(e.isIPhoneX,e.isIOS,e.isSelectPreSale),o=e.currentRouteInfo,s=e.isPreSale,c=e.groupCard,l=Y.useActions().handlers.handleTraceLog,u=(0,g.useState)(!1),d=(0,h.Z)(u,2),f=d[0],p=d[1];if((0,v.usePageScroll)((function(e){var t=e.scrollTop;p(t>5)})),!t||!n)return null;if(!f)return null;var m=t.DepartureCityName,I=t.TravelDays,T=n.activeProductId,P=n.isMultiLine,y=n.isMultiTravel,w=n.activeAlias,C="";if(P&&i&&i.TourGroupProductInfo){var N=i.TourGroupProductInfo.find((function(e){return e.ProductId===T}));C=["A","B","C","D","E","F","G","H","I","J"][N.SortNumber-1]}y&&(C=w);var D=o.dailyMinPrices;D&&D.length||(r="");var j="",_="";if(r){var b=new Ne.Z(r).format("YYYY\u5e74MM\u6708DD\u65e5"),k=new Ne.Z(r).addDay(I-1).format("YYYY\u5e74MM\u6708DD\u65e5");j=b.slice(-9),_=k.slice(-9)}var L="".concat(m,"\u51fa\u53d1");L.length>5&&(L=L.slice(0,4)+"..");var B,R=o.PreSaleNotice;if(s||(a=!1),R||(a=!1),c&&c.cards&&c.cards.length){var M=c.cards.find((function(e){return e.productId===T}));M&&M.preSaleProductInfo&&M.preSaleProductInfo.canBook&&(B=M.preSaleProductInfo.productId)}return B||(a=!1),(0,$.jsx)(S.View,{children:(0,$.jsxs)(S.View,{className:"FooterBookingInfoBox",children:[(0,$.jsx)(S.View,{className:"FooterBookingInfoTitle",children:(0,$.jsx)(S.Text,{className:"Color1_Cap2_Bold",children:"\u5df2\u9009"})}),a?(0,$.jsxs)(S.View,{className:"FooterBookingInfoContent",children:[!!C&&(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(S.Text,{className:"Color1_Cap2",children:[C,"\u7ebf"]}),(0,$.jsx)(S.View,{className:"FooterBookingInfoContentLine"})]}),(0,$.jsx)(S.Text,{className:"Color1_Cap2",children:"\u9884\u552e\xb7\u8d2d\u4e70\u540e\u9884\u7ea6\u65e5\u671f"}),(0,$.jsx)(S.View,{className:"FooterBookingInfoContentLine"}),(0,$.jsx)(S.Text,{className:"Color1_Cap2",children:L})]}):(0,$.jsxs)(S.View,{className:"FooterBookingInfoContent",children:[!!C&&(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(S.Text,{className:"Color1_Cap2",children:[C,"\u7ebf"]}),(0,$.jsx)(S.View,{className:"FooterBookingInfoContentLine"})]}),!!j&&!!_&&(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(S.Text,{className:"Color1_Cap2",children:[j,"-",_]}),(0,$.jsx)(S.View,{className:"FooterBookingInfoContentLine"})]}),(0,$.jsx)(S.Text,{className:"Color1_Cap2",children:L})]}),(0,$.jsx)(S.View,{className:"FooterBookingInfoButton",onClick:function(){x().pageScrollTo({selector:"#Taro_Scroll_To_Offset",duration:300}),l("grp_prddtl_revise_click")},children:(0,$.jsx)(S.Text,{className:"ColorBlue_Cap2",children:"\u4fee\u6539"})})]})})}function At(e){var t=e.BookingRuleType,n=Y.useState((function(e){var t=e.BasicInfo;return{BasicInfo:t}})),r=n.BasicInfo,i=Y.useActions().handlers,a=i.handleGoSuggestDestination,o=i.handleGoTravelIntention;switch(t){case 2:return(0,$.jsx)(S.View,{className:"WarningButton",onClick:function(){o()},children:"\u63d0\u4ea4\u9700\u6c42"});case 3:return(0,$.jsx)(S.View,{className:"WarningButton",onClick:function(){a(r.DestCityName)},children:"\u9884\u8ba2\u7701\u5185\u6e38"});default:return null}}function Zt(){return(0,$.jsx)(S.View,{className:"EndPageContainer"})}var Ot=n(94503),Ut=[2148,2147,2149,2150,2151,2152];function Ft(){var e=Y.useState((function(e){var t=e.isShowServiceTagMask,n=e.currentRouteInfo;return{isShowServiceTagMask:t,currentRouteInfo:n}})),t=e.isShowServiceTagMask,n=e.currentRouteInfo,r=Y.useActions().handlers,i=r.handleToggleServiceTagMask,a=r.handleGoSecurityInfo,o=r.handleGoDefaultInfo;if(!t)return null;var s=n||{},c=s.TagGroupInfo,l=c.MoreTagList.slice();return(0,$.jsx)(Ot.Z,{title:"\u670d\u52a1\u4fdd\u969c",headerBgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/servicebg.png",handleClose:function(){i(!1)},children:(0,$.jsx)(S.View,{className:"PopContentContainer PopMaskContainer",children:l.map((function(e,t){var n=e.TagName,r=e.TagId;return 10001001===r?(0,$.jsxs)(S.View,{className:"ServiceTagItem",children:[(0,$.jsx)(S.View,{className:"ServiceTagImgBox",children:(0,$.jsx)(S.Image,{className:"ServiceTagImgPic",mode:"widthFix",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/securetravel.png"})}),(0,$.jsxs)(S.View,{className:"ServiceTagContentBox",children:[(0,$.jsxs)(S.View,{className:"ServiceTagContentTitle",onClick:function(){a()},children:[(0,$.jsx)(S.Text,{className:"ServiceTagContentTitleText",children:"\u653e\u5fc3\u6e38"}),(0,$.jsx)(S.Text,{className:"ServiceTagContentTitleIcon",children:"\ue944"})]}),(0,$.jsx)(S.View,{className:"ServiceTagContentInfo",children:(0,$.jsx)(S.Text,{className:"ServiceTagContentInfoText",children:"\u9488\u5bf9\u6e38\u5ba2\u75db\u70b9\u7684\u4e00\u7ad9\u5f0f\u89e3\u51b3\u65b9\u6848\u3002\u7701\u5fc3\u7701\u529b\u4e0d\u82b1\u94b1\uff0c\u53ea\u4e3a\u60a8\u7684\u5e78\u798f\u65c5\u7a0b"})})]})]}):Ut.includes(r)?(n+="\uff08\u4fdd\u9669\u9664\u5916\uff09",(0,$.jsxs)(S.View,{className:"ServiceTagItem",children:[(0,$.jsx)(S.View,{className:"ServiceTagImgBox",children:(0,$.jsx)(S.Image,{className:"ServiceTagImgPic",mode:"widthFix",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/securetravel.png"})}),(0,$.jsxs)(S.View,{className:"ServiceTagContentBox",children:[(0,$.jsxs)(S.View,{className:"ServiceTagContentTitle",onClick:function(){o()},children:[(0,$.jsx)(S.Text,{className:"ServiceTagContentTitleText",children:n}),(0,$.jsx)(S.Text,{className:"ServiceTagContentTitleIcon",children:"\ue944"})]}),(0,$.jsx)(S.View,{className:"ServiceTagContentInfo",children:(0,$.jsx)(S.Text,{className:"ServiceTagContentInfoText",children:e.Description})})]})]})):(0,$.jsxs)(S.View,{className:"ServiceTagItem",children:[(0,$.jsx)(S.View,{className:"ServiceTagImgBox",children:(0,$.jsx)(S.Image,{className:"ServiceTagImgPic",mode:"widthFix",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/securetravel.png"})}),(0,$.jsxs)(S.View,{className:"ServiceTagContentBox",children:[(0,$.jsx)(S.View,{className:"ServiceTagContentTitle",children:(0,$.jsx)(S.Text,{className:"ServiceTagContentTitleText",children:n})}),(0,$.jsx)(S.View,{className:"ServiceTagContentInfo",children:(0,$.jsx)(S.Text,{className:"ServiceTagContentInfoText",children:e.Description})})]})]})}))})})}function Gt(){var e=Y.useState((function(e){var t=e.isShowPriceTipMask,n=e.currentRouteInfo;return{isShowPriceTipMask:t,currentRouteInfo:n}})),t=e.isShowPriceTipMask,n=e.currentRouteInfo,r=Y.useActions().handlers.handleTogglePriceTipMask,i=n.PriceInfo;return t&&i&&i.MinPriceRemark?(0,$.jsx)(Ot.Z,{title:"\u8d77\u4ef7\u8bf4\u660e",handleClose:function(){r(!1)},children:(0,$.jsx)(S.View,{className:"PopMaskContainer MarginX32",children:(0,$.jsx)("mp-html",{content:i.MinPriceRemark,copyLink:!1,onLinktap:function(e){}})})}):null}function Ht(){var e=Y.useState((function(e){var t=e.qConfig,n=e.BasicInfo;return{qConfig:t,BasicInfo:n}})),t=e.qConfig,n=e.BasicInfo,r=Y.useActions().handlers.handleGoEnterpriseWechatPage;if(!n)return null;var i=n.isStudy,a=n.IsThemeProduct,o=n.SaleMode;if(i||a)return null;if(!["S","P"].includes(o))return null;if(!t||!t.consultant)return null;var s=t.consultant,c=s.backgroundImg,l=s.content,u=s.title;s.wechatNumber;return(0,$.jsxs)(S.View,{className:"SimpleBanner ModuleBoxWithoutPadding FlexAlignCenter",children:[(0,$.jsx)(S.Image,{lazyLoad:!0,className:"WeChatBannerBgImage",src:c}),(0,$.jsxs)(S.View,{className:"SimpleBannerCenterBox FlexAlignStart FlexColumn",children:[(0,$.jsx)(S.Text,{className:"SimpleBannerTitle MarginBottom8",children:u}),(0,$.jsx)(S.Text,{className:"SimpleBannerContent",children:l})]}),(0,$.jsx)(S.View,{className:"SimpleBannerBtn FlexVerticalCenter",onClick:function(){r()},children:(0,$.jsx)(S.Text,{className:"SimpleBannerBtnText",children:"\u7acb\u5373\u6dfb\u52a0"})})]})}function Kt(){var e=Y.useActions().handlers.handleGoCustomize,t=Y.useState((function(e){var t=e.pageStatus,n=e.actionIdSuffix;return{pageStatus:t,actionIdSuffix:n}})),n=t.pageStatus,r=t.actionIdSuffix;if(n.isCruise)return null;var i="https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/customize.png",a="\u5b9a\u5236\u65c5\u884c\uff0c\u884c\u7a0b\u66f4\u7075\u6d3b",o="\u72ec\u7acb\u6210\u56e2\u6b22\u4e50\u884c\u627e\u65c5\u884c\u5b9a\u5236\u5e08\u6765\u641e\u5b9a\uff01";return(0,$.jsxs)(S.View,{className:"SimpleBanner ModuleBoxWithoutPadding FlexAlignCenter MarginTop24 MarginBottom24",children:[(0,$.jsx)(S.Image,{lazyLoad:!0,className:"CustomizeBannerBgImage",src:i}),(0,$.jsxs)(S.View,{className:"SimpleBannerCenterBox FlexAlignStart FlexColumn",children:[(0,$.jsx)(S.Text,{className:"SimpleBannerTitle MarginBottom8",children:a}),(0,$.jsx)(S.Text,{className:"SimpleBannerContent",children:o})]}),(0,$.jsx)(S.View,{className:"SimpleBannerBtn FlexVerticalCenter",onClick:function(t){e(),X().uploadUserAction(t,"".concat(r,"-recommend-travel"))},children:(0,$.jsx)(S.Text,{className:"SimpleBannerBtnText",children:"\u7acb\u5373\u5b9a\u5236"})})]})}function zt(){var e=Y.useState((function(e){var t=e.isSimpleMode,n=e.actionIdSuffix;return{isSimpleMode:t,actionIdSuffix:n}})),t=(e.isSimpleMode,e.actionIdSuffix),n=(0,g.useState)(!1),r=(0,h.Z)(n,2),i=r[0],a=r[1],o=(0,g.useRef)(0);Y.useActions().handlers.handleRouteModeChange;return(0,v.usePageScroll)((function(e){var t=e.scrollTop,n=x().createSelectorQuery().select("#Route");n&&n.boundingClientRect((function(e){e&&(e.top<38?i||(a(!0),o.current=t):i&&a(!1))})).exec()})),i?(0,$.jsx)(S.View,{className:"FixedButtonBox",children:(0,$.jsx)(S.View,{className:"FixedButtonItem",onClick:function(e){x().pageScrollTo({scrollTop:0,duration:300}),X().uploadUserAction(e,"".concat(t,"-mask-back"))},children:(0,$.jsx)(S.Image,{lazyLoad:!0,mode:"widthFix",className:"FixedButtonImg",src:"https://pic.c-ctrip.com/VacationH5Pic/group_travel/tourcrn/top.png"})})}):null}var Wt=n(32180)["document"],qt=void 0,Yt=function(e){(0,f.Z)(n,e);var t=(0,p.Z)(n);function n(e){var r;return(0,l.Z)(this,n),r=t.call(this,e),(0,m.Z)((0,d.Z)(r),"pageHeightArr",[]),(0,m.Z)((0,d.Z)(r),"initList",[]),(0,m.Z)((0,d.Z)(r),"windowHeight",0),(0,m.Z)((0,d.Z)(r),"currentPage",x().getCurrentInstance()),(0,m.Z)((0,d.Z)(r),"observer",void 0),(0,m.Z)((0,d.Z)(r),"getSystemInformation",(function(){try{var e=(0,v.getSystemInfoSync)();r.windowHeight=e.windowHeight}catch(e){console.error("\u83b7\u53d6\u7cfb\u7edf\u4fe1\u606f\u5931\u8d25\uff1a".concat(e))}})),(0,m.Z)((0,d.Z)(r),"handleComplete",(function(){var e=r.props.onComplete;r.setState({isComplete:!0},(function(){null===e||void 0===e||e()}))})),(0,m.Z)((0,d.Z)(r),"renderNext",(function(){var e=r.props,t=e.onBottom,n=e.listType,i=e.scrollViewProps,a=e.list;if("single"===n){var o,s=r.state.wholePageIndex+1;if(null===(o=r.initList[s])||void 0===o||!o.length)return void r.handleComplete();null===t||void 0===t||t(),r.setState({wholePageIndex:s},(function(){var e=r.state,t=e.wholePageIndex,n=e.twoList;n[t]=r.initList[t],r.setState({twoList:(0,y.Z)(n)},(function(){x().nextTick((function(){r.setHeight(a)}))}))}))}else if("multi"===n){var c;null===i||void 0===i||null===(c=i.onScrollToLower)||void 0===c||c.call(i)}})),(0,m.Z)((0,d.Z)(r),"webObserve",(function(){var e=r.props.listId,t=Wt.querySelectorAll("#".concat(e," .zt-main-list>taro-view-core")),n={root:Wt.querySelector("#".concat(e)),rootMargin:"500px 0px"};r.observer=new IntersectionObserver(r.observerCallBack,n),t.forEach((function(e){var t;null===(t=r.observer)||void 0===t||t.observe(e)}))})),(0,m.Z)((0,d.Z)(r),"observerCallBack",(function(e){var t=r.state.twoList;e.forEach((function(e){var n=e.target["data-index"];e.isIntersecting?(t[n]=r.initList[n],r.setState({twoList:(0,y.Z)(t)})):(t[n]={height:r.pageHeightArr[n]},r.setState({twoList:(0,y.Z)(t)}))}))})),(0,m.Z)((0,d.Z)(r),"handleObserve",(function(){r.miniObserve()})),(0,m.Z)((0,d.Z)(r),"miniObserve",(function(){var e,t=r.state.wholePageIndex,n=r.props,i=n.scrollViewProps,a=n.listId,o=n.screenNum,s=void 0===o?2:o,c=(null===i||void 0===i||null===(e=i.style)||void 0===e?void 0:e.height)||r.windowHeight,l=x().createIntersectionObserver(r.currentPage.page).relativeToViewport({top:s*c,bottom:s*c});l.observe("#".concat(a," .wrap_").concat(t),(function(e){var n,i=r.state.twoList;(null===e||void 0===e?void 0:e.intersectionRatio)<=0?(i[t]={height:r.pageHeightArr[t]},r.setState({twoList:(0,y.Z)(i)})):null!==(n=i[t])&&void 0!==n&&n.length||(i[t]=r.initList[t],r.setState({twoList:(0,y.Z)(i)}))}))})),(0,m.Z)((0,d.Z)(r),"handleScroll",$t((function(e){var t,n,i=r.props.listId;null===(t=(n=r.props).onGetScrollData)||void 0===t||t.call(n,(0,m.Z)({},"".concat(i),e))}),300,300)),r.state={wholePageIndex:0,twoList:[],isComplete:!1,innerScrollTop:0},r}return(0,u.Z)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.list,n=e.listType;this.getSystemInformation(),"single"===n?this.formatList(t):"multi"===n&&this.formatMultiList(t)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t,n=this,r=this.props,i=r.list,a=r.listType,o=r.pageNum,s=void 0===o?1:o;if("single"===a)this.setState({innerScrollTop:1}),JSON.stringify(e.list)!==JSON.stringify(i)&&(this.pageHeightArr=[],this.setState({wholePageIndex:0,isComplete:!1,twoList:[],innerScrollTop:0},(function(){var t;null!==(t=e.list)&&void 0!==t&&t.length?n.formatList(e.list):n.handleComplete()})));else if("multi"===a){var c=e.pageNum,l=void 0===c?1:c;JSON.stringify(e.list)!==JSON.stringify(i)&&(l<s&&1==l?(this.initList=[],this.pageHeightArr=[],this.setState({innerScrollTop:1}),this.setState({wholePageIndex:0,isComplete:!1,twoList:[]},(function(){var t;null!==(t=e.list)&&void 0!==t&&t.length?n.formatMultiList(e.list,l):n.handleComplete()})),x().nextTick((function(){n.setState({innerScrollTop:0})}))):this.formatMultiList(e.list,l))}null!==(t=e.list)&&void 0!==t&&t.length||this.handleComplete()}},{key:"formatMultiList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=this.state.twoList;null!==t&&void 0!==t&&t.length&&(this.segmentList(t),r[n-1]=this.initList[n-1],this.setState({twoList:(0,y.Z)(r),wholePageIndex:n-1},(function(){x().nextTick((function(){e.setHeight(t)}))})))}},{key:"segmentList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.props.segmentNum,n=void 0===t?10:t,r=[],i=[];e.forEach((function(e,t){r.push(e),(t+1)%n===0&&(i.push(r),r=[])}));var a=e.slice(i.length*n);null!==a&&void 0!==a&&a.length&&(i.push(a),i.length<=1&&this.handleComplete()),this.initList=i}},{key:"formatList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.segmentList(t),this.setState({twoList:this.initList.slice(0,1)},(function(){x().nextTick((function(){e.setHeight(t)}))}))}},{key:"setHeight",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this.state.wholePageIndex,r=this.props.listId,i=(0,v.createSelectorQuery)();i.select("#".concat(r," .wrap_").concat(n)).boundingClientRect(),i.exec((function(n){var r;null!==t&&void 0!==t&&t.length&&e.pageHeightArr.push(null===n||void 0===n||null===(r=n[0])||void 0===r?void 0:r.height)})),this.handleObserve()}},{key:"render",value:function(){var e=this.state,t=e.twoList,n=e.isComplete,r=e.innerScrollTop,i=this.props,a=i.segmentNum,o=void 0===a?10:a,s=i.scrollViewProps,l=i.onRenderTop,u=i.onRenderBottom,d=i.onRender,f=i.onRenderLoad,p=i.listId,m=i.className,I=i.autoScrollTop,h={height:"100%"},g=(0,c.Z)((0,c.Z)({},s),{},{scrollTop:I?0===r?0:"":null===s||void 0===s?void 0:s.scrollTop});return(0,$.jsxs)(S.ScrollView,(0,c.Z)((0,c.Z)({scrollY:!0,id:p,style:h,onScrollToLower:this.renderNext,lowerThreshold:250,className:"zt-virtual-list-container ".concat(m),onScroll:this.handleScroll},g),{},{children:[(0,$.jsx)(S.Block,{children:null===l||void 0===l?void 0:l()}),(0,$.jsx)(S.View,{className:"zt-main-list",children:null===t||void 0===t?void 0:t.map((function(e,t){return(0,$.jsx)(S.View,{"data-index":t,className:"wrap_".concat(t),children:(null===e||void 0===e?void 0:e.length)>0?(0,$.jsx)(S.Block,{children:e.map((function(e,n){return null===d||void 0===d?void 0:d(e,t*o+n,t)}))}):(0,$.jsx)(S.View,{style:{height:"".concat(null===e||void 0===e?void 0:e.height,"px")}})},t)}))}),(0,$.jsx)(S.Block,{children:(null===f||void 0===f?void 0:f())&&(0,$.jsx)(S.View,{className:"zt-loading-text",children:f()})}),(0,$.jsx)(S.Block,{children:n&&(null===u||void 0===u?void 0:u())})]}))}}]),n}(g.Component);(0,m.Z)(Yt,"defaultProps",void 0),Yt.defaultProps={list:[],pageNum:1,listId:"zt-virtial-list",listType:"single",segmentNum:10,screenNum:2,scrollViewProps:{},className:"",autoScrollTop:!0,onRender:function(){return(0,$.jsx)(S.View,{})}};var $t=function(e,t,n){var r,i;return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];var c=Date.now();clearTimeout(r),i||(i=c),c-i>=n?(e.apply(qt,o),i=c):r=setTimeout((function(){e.apply(this,o)}),t)}};function Jt(){var e=Y.useState((function(e){var t=e.currentRouteInfo,n=e.pageStatus,r=e.BasicInfo,i=e.isShowCitySelectMask,a=e.citySelectTargetProductId;return{currentRouteInfo:t,pageStatus:n,BasicInfo:r,isShowCitySelectMask:i,citySelectTargetProductId:a}})),t=e.currentRouteInfo,n=e.pageStatus,r=e.BasicInfo,i=e.isShowCitySelectMask,a=e.citySelectTargetProductId,o=Y.useActions().handlers,s=o.handleToggleCitySelectMask,c=o.handleChangeDepartCity,l=(0,g.useState)(""),u=(0,h.Z)(l,2),d=u[0];u[1];if(!i)return null;var f=t.PriceInfo,p=f.DepartureCityPriceList||[],m=(p.length,d?p.filter((function(e){var t=e.DepartureCityName,n=e.DepartureCityPy;return t.includes(d)||n.toLowerCase().includes(d.toLowerCase())})):p),I=[],v=[];m.forEach((function(e){var t,n=null===e||void 0===e||null===(t=e.DepartureCityPy[0])||void 0===t?void 0:t.toUpperCase();if(I.includes(n)){var r,i=I.indexOf(n);null===(r=v[i])||void 0===r||r.data[0].push(e)}else I.push(n),v.push({key:n,data:[[e]]})})),v=v.slice().sort();var x=f.PreferentialPriceDetail,T=0;if(x){var P=x.PreferentialAmountDetails,y=x.PreferentialPriceItems;y&&(T=P&&P[0]&&P[0].PreferentialAmount,T>0)}return(0,$.jsx)(Ot.Z,{title:"\u8bf7\u9009\u62e9\u51fa\u53d1\u5730",handleClose:function(){s(!1)},isScrollView:!1,children:(0,$.jsx)(S.View,{className:"PopMaskContainer CitySelectContainer",children:(0,$.jsx)(Yt,{list:v,onRender:function(e,t,i){var o=e.key,l=e.data,u=l[0];return(0,$.jsxs)(S.View,{className:"CitySelectGroup",children:[(0,$.jsx)(S.View,{className:"CitySelectGroupLetter",children:o}),(0,$.jsx)(S.View,{className:"CitySelectCityList",children:u.map((function(e,t){var i=e.DepartureCityId,o=e.DepartureCityName,l=(e.MinPrice,e.ProductIdList),u=n.activeProductId,d=a||u,f=l.includes(d),p=r.DepartureId===i;return f?(0,$.jsxs)(S.View,{className:p?"CitySelectCityBg cur":"CitySelectCityBg",onClick:function(){c(i,d),s(!1)},children:[(0,$.jsxs)(S.View,{className:"CitySelectCityBox",children:[(0,$.jsx)(S.View,{className:"CitySelectCityText",children:o}),!1]},t),p&&(0,$.jsx)(S.Image,{className:"CitySelectCurIcon",mode:"widthFix",src:"https://pic.c-ctrip.com/VacationH5Pic/group_travel/tourcrn/dui.png"})]}):(0,$.jsx)(S.View,{className:"CitySelectCityBg",children:(0,$.jsx)(S.View,{className:"CitySelectCityBox",children:(0,$.jsx)(S.View,{className:"CitySelectCityText unavailable",children:o})},t)})}))})]},t)},scrollViewProps:{style:{maxHeight:"calc(94vh - 110px)"}}})})})}function Qt(){var e=Y.useState((function(e){var t=e.isShowUrgentMask,n=e.emotionalCues,r=e.BasicInfo;return{isShowUrgentMask:t,emotionalCues:n,BasicInfo:r}})),t=e.isShowUrgentMask,n=e.emotionalCues,r=e.BasicInfo,i=Y.useActions().handlers.handleToggleUrgentMask,a=n.urgentInfo,o=n.riskCityPolicy,s=Xt({EmotionalCues:a,riskCityPolicy:o,BasicInfo:r});return console.log("formatData",n,s),(0,$.jsx)(I.UrgentInfo,{riskPolicyInfo:s,isShow:!!t,onClose:function(){i(!1)}})}var Xt=function(e){var t=e.EmotionalCues,n=e.riskCityPolicy,r=e.BasicInfo,i=r.IsOverSea||r.IsHkMcTw,a=[];if(t&&t.length){var o=[];t.forEach((function(e){var t=e.Title,n=e.RichContent,r=e.Weight;o.push({title:t,policyText:n,urgencyLevel:r})})),a.push({tabTitle:"\u65c5\u884c\u63d0\u9192",tabType:"0",policies:o})}if(n){var s,c,l=n.startCityPolicy,u=n.endCityPolicy,d=n.startCityRevPolicy,f=n.endCityRevPolicy;l&&l[0]||(l=[{}]),u&&u[0]||(u=[{}]),f&&f[0]||(f=[{}]),d&&d[0]||(d=[{}]),l[0].srcId===d[0].srcId&&(d[0]={}),u[0].srcId===f[0].srcId&&(f[0]={});var p=l[0],m=p.levelTagName,I=p.leavePolicy,h=p.phoneInfos,g=(p.levelTag,p.city),v=p.ctripCreateTime,x=p.tags,S=p.title,T=f[0],P=T.policy,y=T.title,w=T.city,C=T.tags,N=T.ctripCreateTime,D=(T.levelTag,T.levelTagName),j=u[0],_=j.levelTagName,b=j.phoneInfos,k=(j.levelTag,j.city),L=j.comePolicy,B=j.ctripCreateTime,R=j.tags,M=j.title,E=d[0],V=E.policy,A=E.title,Z=E.city,O=E.tags,U=E.ctripCreateTime,F=(E.levelTag,E.levelTagName);if(i&&("",""),g===k){if(I){var G=[{title:S,subTitle:m,policyText:I,phoneTitle:"".concat(g,"\u75ab\u60c5\u54a8\u8be2\u7535\u8bdd"),phoneInfos:h,ctripCreateTime:v,tags:x}];s={tabTitle:"\u51fa".concat(g),tabType:"1",policies:G}}if(L){var H=[{title:M,subTitle:_,policyText:L,phoneTitle:"".concat(k,"\u75ab\u60c5\u54a8\u8be2\u7535\u8bdd"),phoneInfos:b,ctripCreateTime:B,tags:R}];c={tabTitle:"\u8fdb".concat(k),tabType:"1",policies:H}}}else{if(I)if(L){var K=[{title:S,subTitle:m,policyText:I,phoneTitle:"".concat(g,"\u75ab\u60c5\u54a8\u8be2\u7535\u8bdd"),phoneInfos:h,ctripCreateTime:v,tags:x},{title:M,subTitle:_,policyText:L,phoneTitle:"".concat(k,"\u75ab\u60c5\u54a8\u8be2\u7535\u8bdd"),phoneInfos:b,ctripCreateTime:B,tags:R}];s={tabTitle:"".concat(g,"-").concat(k),tabType:"1",policies:K}}else{var z=[{title:S,subTitle:m,policyText:I,phoneTitle:"".concat(g,"\u75ab\u60c5\u54a8\u8be2\u7535\u8bdd"),phoneInfos:h,ctripCreateTime:v,tags:x}];s={tabTitle:"\u51fa".concat(g),tabType:"1",policies:z}}else if(L){var W=[{title:M,subTitle:_,policyText:L,phoneTitle:"".concat(k,"\u75ab\u60c5\u54a8\u8be2\u7535\u8bdd"),phoneInfos:b,ctripCreateTime:B,tags:R}];s={tabTitle:"\u8fdb".concat(k),tabType:"1",policies:W}}if(V)if(P){var q=[{title:A,subTitle:F,policyText:V,phoneTitle:"".concat(Z,"\u75ab\u60c5\u54a8\u8be2\u7535\u8bdd"),ctripCreateTime:U,tags:O},{title:y,subTitle:D,policyText:P,phoneTitle:"".concat(w,"\u75ab\u60c5\u54a8\u8be2\u7535\u8bdd"),ctripCreateTime:N,tags:C}];c={tabTitle:"".concat(Z,"-").concat(w),tabType:"1",policies:q}}else{var Y=[{title:A,subTitle:F,policyText:V,phoneTitle:"".concat(Z,"\u75ab\u60c5\u54a8\u8be2\u7535\u8bdd"),ctripCreateTime:U,tags:O}];c={tabTitle:"\u51fa".concat(Z),tabType:"1",policies:Y}}else if(P){var $=[{title:y,subTitle:D,policyText:P,phoneTitle:"".concat(w,"\u75ab\u60c5\u54a8\u8be2\u7535\u8bdd"),ctripCreateTime:N,tags:C}];c={tabTitle:"\u8fdb".concat(w),tabType:"1",policies:$}}}s&&a.push(s),c&&a.push(c)}return a},en=n(8700);function tn(){var e=Y.useState((function(e){var t=e.isShowCustomerServiceMask,n=e.imEntryInfo,r=e.BasicInfo;return{isShowCustomerServiceMask:t,imEntryInfo:n,BasicInfo:r}})),t=e.isShowCustomerServiceMask,n=e.imEntryInfo,r=e.BasicInfo,i=Y.useActions().handlers,a=i.handleToggleCustomerServiceMask,o=i.handleGoIM;if(!t||!n)return null;var s=n.imInfo,c=n.serviceInfo,l=s.mobileServiceTime,u=s.afterSaleServiceTime,d=s.mobile,f=s.mobileCode,p=s.afterSaleTel,m=s.afterSaleExtTel,I=s.imSwitch,h=s.inquiry,g=s.imServiceTime,v=d;f&&(v="".concat(d,",").concat(f)),v=String(v).split("-").join("");var T=p;f&&(T="".concat(p,",").concat(m)),T=String(T).split("-").join("");var P="\u643a\u7a0b\u5ba2\u670d";c&&c.shortServiceToast&&"\u5546\u5bb6"===c.shortServiceToast&&(P="\u5546\u5bb6\u5ba2\u670d");var y=r.isCruise?"".concat(P,"\u4e13\u5458\u63d0\u4f9b\u5728\u7ebf\u670d\u52a1\uff0c\u975e\u5de5\u4f5c\u65f6\u95f4\u53ef\u62e8\u6253\u7535\u8bdd\u8054\u7cfb\u6211\u4eec"):"".concat(P,"\u4e13\u5458\u63d0\u4f9b\u5728\u7ebf\u670d\u52a1\uff0c\u89e3\u7b54\u5ea6\u5047\u76f8\u5173\u95ee\u9898");return(0,$.jsx)(Ot.Z,{title:"\u5ba2\u670d",handleClose:function(){a(!1)},children:(0,$.jsxs)(S.View,{className:"PopMaskContainer CustomerServiceContainer",children:[I&&(0,$.jsxs)(S.View,{className:"CustomerServiceType",children:[(0,$.jsx)(S.View,{className:"CustomerServiceTypeTitle",children:"\u5728\u7ebf\u5ba2\u670d"}),(0,$.jsxs)(S.View,{className:"CustomerServiceInfo",children:[(0,$.jsxs)(S.View,{className:"CustomerServiceContent",children:[!!g&&(0,$.jsxs)(S.Text,{className:"CustomerServiceText",children:["\u670d\u52a1\u65f6\u95f4 ",g]}),(0,$.jsx)(S.Text,{className:"CustomerServiceText",children:y})]}),(0,$.jsx)(S.View,{className:"CustomerServiceIcon",onClick:function(){o()},children:"\uee3b"})]})]}),h&&(!!v||!!T)&&(0,$.jsxs)(S.View,{className:"CustomerServiceType",children:[(0,$.jsx)(S.View,{className:"CustomerServiceTypeTitle",children:"\u7535\u8bdd\u5ba2\u670d"}),!!d&&!!v&&(0,$.jsxs)(S.View,{className:"CustomerServiceInfo",children:[(0,$.jsxs)(S.View,{className:"CustomerServiceContent",children:[(0,$.jsxs)(S.Text,{className:"CustomerServiceText",children:["\u552e\u524d\u54a8\u8be2 \u670d\u52a1\u65f6\u95f4 ",l]}),(0,$.jsxs)(S.Text,{className:"CustomerServiceText",children:["\u7535\u8bdd\u63a5\u901a\u540e\uff0c\u8bf7\u544a\u77e5\u5ba2\u670d\u4ea7\u54c1\u7f16\u53f7:",r.ProductId]})]}),(0,$.jsx)(S.View,{className:"CustomerServiceIcon",onClick:function(){x().makePhoneCall({phoneNumber:v})},children:"\ue952"})]}),!!p&&!!T&&(0,$.jsxs)(S.View,{className:"CustomerServiceInfo",children:[(0,$.jsxs)(S.View,{className:"CustomerServiceContent",children:[(0,$.jsxs)(S.Text,{className:"CustomerServiceText",children:["\u552e\u540e\u54a8\u8be2 \u670d\u52a1\u65f6\u95f4 ",u]}),(0,$.jsx)(S.Text,{className:"CustomerServiceText",children:"\u5982\u60a8\u8ba2\u5355\u5df2\u63d0\u4ea4\uff0c\u53ef\u8054\u7cfb\u552e\u540e\u5ba2\u670d\u67e5\u8be2\u53ca\u4fee\u6539"})]}),(0,$.jsx)(S.View,{className:"CustomerServiceIcon",onClick:function(){x().makePhoneCall({phoneNumber:T})},children:"\ue952"})]})]})]})})}var nn=n(63906);function rn(){var e=Y.useState((function(e){var t=e.isShowSelfFundMask,n=e.SelfFundedMaskInfo;return{isShowSelfFundMask:t,SelfFundedMaskInfo:n}})),t=e.isShowSelfFundMask,n=e.SelfFundedMaskInfo,r=Y.useActions().handlers.handleHideSelfFundMask;if(!t)return null;var i=n.ScenicName,a=n.SelfFundedActivities;return(0,$.jsx)(Ot.Z,{title:"\u81ea\u8d39\u8be6\u60c5",subtitle:i,handleClose:function(){r(!1)},children:(0,$.jsx)(S.View,{className:"PopMaskContainer MarginX32",children:a.map((function(e,t){var n=e.ActivityName,r=e.ActivityDesc,i=e.Currency,a=e.Price,o=e.UseListingPrice;return(0,$.jsxs)(S.View,{className:"ScenicItem",children:[(0,$.jsx)(S.View,{className:"ScenicTitle",children:n}),(0,$.jsx)(S.View,{className:"ScenicContent",children:r}),(a>0||o)&&(0,$.jsxs)(S.View,{className:"ScenicContent",children:["\u53c2\u8003\u4ef7\u683c\uff1a",o?"\u666f\u533a\u6302\u724c\u4ef7":"".concat(i).concat(a)]})]},t)}))})})}function an(){var e=Y.useState((function(e){var t=e.isShowScenicExcludingFeeMask,n=e.currentRouteInfo;return{isShowScenicExcludingFeeMask:t,currentRouteInfo:n}})),t=e.isShowScenicExcludingFeeMask,n=e.currentRouteInfo,r=Y.useActions().handlers.handleToggleScenicExcludingFeeMask,i=n.TravelIntroductionInfo;if(!i||!i.TravelIntroductionList)return null;var a=(i.TravelIntroductionList||{})[0]||{},o=a.TravelOverviewInfo,s=o||{},c=s.ScenicSportSelfActiveList;return t&&c&&c.length?(0,$.jsx)(Ot.Z,{title:"\u666f\u70b9/\u573a\u9986\u6536\u8d39\u4fe1\u606f",handleClose:function(){r(!1)},children:(0,$.jsx)(S.View,{className:"PopMaskContainer ScenicExcludingFeeBox",children:c.map((function(e,t){var n=e.PoiName,r=e.SelfFundedActivities;return n&&r&&r.length?(0,$.jsxs)(S.View,{className:"ExcludingFeeItem",children:[(0,$.jsx)(S.View,{className:"ExcludingFeeItemTitle",children:(0,$.jsx)(S.Text,{className:"ExcludingFeeItemTitleText",children:n})}),(0,$.jsxs)(S.View,{className:"ExcludingFeeItemTable",children:[(0,$.jsxs)(S.View,{className:"ExcludingFeeItemTableHeader",children:[(0,$.jsx)(S.View,{className:"ExcludingFeeItemTableHeader1",children:(0,$.jsx)(S.Text,{className:"ExcludingFeeItemTableHeaderText",children:"\u6536\u8d39\u7c7b\u578b"})}),(0,$.jsx)(S.View,{className:"ExcludingFeeItemTableHeader2",children:(0,$.jsx)(S.Text,{className:"ExcludingFeeItemTableHeaderText",children:"\u53c2\u8003\u4ef7\u683c"})}),(0,$.jsx)(S.View,{className:"ExcludingFeeItemTableHeader3",children:(0,$.jsx)(S.Text,{className:"ExcludingFeeItemTableHeaderText",children:"\u6536\u8d39\u8be6\u60c5"})})]}),r.map((function(e,t){var n=e.ActivityDesc,r=e.ActivityName,i=e.Currency,a=e.Price,o=e.UseListingPrice;return(0,$.jsxs)(S.View,{className:"ExcludingFeeItemTableContent",children:[(0,$.jsx)(S.View,{className:"ExcludingFeeItemTableContent1",children:(0,$.jsx)(S.Text,{className:"ExcludingFeeItemTableContentText",children:r})}),(0,$.jsx)(S.View,{className:"ExcludingFeeItemTableContent2",children:(0,$.jsx)(S.Text,{className:"ExcludingFeeItemTableContentText",children:o?"\u666f\u533a\u6302\u724c\u4ef7":"".concat(i).concat(a)})}),(0,$.jsx)(S.View,{className:"ExcludingFeeItemTableContent3",children:(0,$.jsx)(S.Text,{className:"ExcludingFeeItemTableContentText",children:n})})]},t)}))]})]},t):null}))})}):null}function on(){return(0,$.jsxs)(S.View,{className:"InvalidPage",children:[(0,$.jsx)(S.Image,{lazyLoad:!0,className:"InvalidPageImg",src:"https://pic.c-ctrip.com/VacationH5Pic/group_travel/tourcrn/nofor.png"}),(0,$.jsx)(S.View,{className:"InvalidPageText",children:"\u62b1\u6b49\uff0c\u8be5\u4ea7\u54c1\u5df2\u4e0b\u7ebf"}),(0,$.jsx)(S.View,{className:"InvalidPageBtn",onClick:function(){X().navigateBack()},children:"\u8fd4\u56de\u4e0a\u4e00\u9875"})]})}function sn(){var e=Y.useState((function(e){var t=e.BasicInfo,n=e.VendorInfo;return{BasicInfo:t,VendorInfo:n}})),t=e.BasicInfo,n=e.VendorInfo,r=Y.useActions().handlers,i=r.handleGoSelfLicenseInfo,a=r.handleGoLicensePage,o=t.isCruise;if(o&&"S"===t.SaleMode)return(0,$.jsx)(S.View,{className:"ModuleBox",onClick:function(){i()},children:(0,$.jsxs)(S.View,{className:"LicenseInfoBox",children:[(0,$.jsxs)(S.View,{className:"LicenseInfoTitle",children:[(0,$.jsx)(S.Image,{lazyLoad:!0,className:"LicenseInfoImg",src:"https://pic.c-ctrip.com/VacationH5Pic/group_travel/tourcrn/logo.png"}),(0,$.jsx)(S.View,{className:"LicenseInfoName",children:"\u643a\u7a0b\u81ea\u8425"})]}),(0,$.jsxs)(S.View,{className:"LicenseInfoTip",children:[(0,$.jsx)(S.View,{className:"LicenseInfoTipText",children:"\u7ecf\u8425\u8bb8\u53ef\u8bc1/\u8425\u4e1a\u6267\u7167"}),(0,$.jsx)(S.View,{className:"LicenseInfoTipIcon",children:"\ue944"})]})]})});if(o||"G"===t.SaleMode){if(!n||!n.BCScanningCopy)return null;var s=n.VendorFullName,c=n.VenderId;return(0,$.jsx)(S.View,{className:"ModuleBox",onClick:function(){a(c)},children:(0,$.jsxs)(S.View,{className:"LicenseInfoBox",children:[(0,$.jsxs)(S.View,{className:"LicenseInfoTitle",children:[(0,$.jsx)(S.View,{className:"LicenseInfoIcon",children:"\uf3c4"}),(0,$.jsx)(S.View,{className:"LicenseInfoName",children:s})]}),(0,$.jsxs)(S.View,{className:"LicenseInfoTip",children:[(0,$.jsx)(S.View,{className:"LicenseInfoTipText",children:"\u7ecf\u8425\u8bb8\u53ef\u8bc1/\u8425\u4e1a\u6267\u7167"}),(0,$.jsx)(S.View,{className:"LicenseInfoTipIcon",children:"\ue944"})]})]})})}return null}function cn(){var e=Y.useState((function(e){var t=e.isShowDiscountDetailMask,n=e.currentRouteInfo,r=e.BasicInfo;return{isShowDiscountDetailMask:t,currentRouteInfo:n,BasicInfo:r}})),t=e.isShowDiscountDetailMask,n=e.currentRouteInfo,r=e.BasicInfo,i=Y.useActions().handlers.handleToggleDiscountDetailMask,a=n.PriceInfo;if(!t)return null;var o=r.ProductPatternId,s=(a.MinPrice,a.MinPriceRemark),c=a.OriginPrice,l=a.DisplayPrice,u=a.PreferentialPriceDetail;if(!u)return null;var d=u.PreferentialAmountDetails,f=u.PreferentialPriceItems,p=(u.UserDetail,d&&d[0]&&d[0].PreferentialAmount),m=[];return f.forEach((function(e){var t=e.PreferentialType,n=e.PreferentialTitle;m.some((function(e){return e.PreferentialType===t}))?m.find((function(e){return e.PreferentialType===t})).Items.push(e):m.push({PreferentialType:t,PreferentialTitle:n,Items:[e]})})),s&&(s=s.replace(/<br\s*\/?>/g,"\n")),(0,$.jsx)(Ot.Z,{title:"\u4f18\u60e0\u660e\u7ec6",handleClose:function(){i(!1)},children:(0,$.jsxs)(S.View,{className:"DiscountDetailBox",children:[(0,$.jsxs)(S.View,{className:"DiscountPkgPriceBox",children:[(0,$.jsx)(S.View,{className:"DiscountPriceTitle",children:(0,$.jsx)(S.Text,{style:{color:"rgb(51, 51, 51)",fontSize:16,fontWeight:"bold"},children:2===o?"\u5957\u9910\u8d39":"\u57fa\u672c\u56e2\u8d39"})}),(0,$.jsxs)(S.View,{className:"DiscountPriceText",children:[(0,$.jsx)(S.Text,{style:{color:"rgb(102, 102, 102)",fontSize:13},children:"\u6bcf\u6210\u4eba\xa0"}),(0,$.jsx)(S.Text,{style:{color:"rgb(255, 119, 0)",fontSize:12},children:"\xa5"}),(0,$.jsx)(S.Text,{style:{color:"rgb(255, 119, 0)",fontFamily:"20TH_bold",fontSize:16},children:c})]})]}),(0,$.jsxs)(S.View,{className:"DiscountListPriceBox",children:[(0,$.jsxs)(S.View,{className:"DiscountPriceTitleBox",children:[(0,$.jsx)(S.View,{className:"DiscountPriceTitle",children:(0,$.jsx)(S.Text,{style:{color:"rgb(51, 51, 51)",fontSize:16,fontWeight:"bold"},children:"\u4f18\u60e0"})}),(0,$.jsxs)(S.View,{className:"DiscountPriceText",children:[(0,$.jsx)(S.Text,{style:{color:"rgb(102, 102, 102)",fontSize:13},children:"\u6bcf\u6210\u4eba\xa0"}),(0,$.jsx)(S.Text,{style:{color:"rgb(255, 119, 0)",fontSize:12},children:"-\xa5"}),(0,$.jsx)(S.Text,{style:{color:"rgb(255, 119, 0)",fontFamily:"20TH_bold",fontSize:16},children:p})]})]}),(0,$.jsxs)(S.View,{className:"DiscountInfoList",children:[m.map((function(e,t){var n=e.PreferentialTitle,r=e.Items;return(0,$.jsxs)(S.View,{className:"DiscountInfoItem",children:[(0,$.jsx)(S.View,{className:"DiscountInfoTag",children:(0,$.jsx)(S.Text,{style:{color:"rgb(255, 119, 0)",fontSize:11},children:n})}),r.map((function(e,t){return(0,$.jsx)(ln,{priceItem:e},t)}))]},t)})),(0,$.jsx)(S.View,{style:{color:"rgb(153, 153, 153)",fontSize:12},children:"*\u5177\u4f53\u4f18\u60e0\u91d1\u989d\u4ee5\u63d0\u4ea4\u8ba2\u5355\u663e\u793a\u4e3a\u51c6"})]})]}),(0,$.jsxs)(S.View,{className:"DiscountTotalBox",children:[(0,$.jsx)(S.View,{className:"DiscountPriceTitle",children:(0,$.jsx)(S.View,{style:{color:"rgb(51, 51, 51)",fontSize:16,fontWeight:"bold"},children:"\u5f53\u524d\u8d77\u4ef7"})}),(0,$.jsxs)(S.View,{className:"DiscountPriceText",children:[(0,$.jsx)(S.View,{style:{color:"rgb(102, 102, 102)",fontSize:13},children:"\u6bcf\u6210\u4eba\xa0"}),(0,$.jsx)(S.View,{style:{color:"rgb(255, 119, 0)",fontSize:12},children:"\xa5"}),(0,$.jsx)(S.View,{style:{color:"rgb(255, 119, 0)",fontFamily:"20TH_bold",fontSize:25,position:"relative",top:4},children:l})]})]}),!!s&&(0,$.jsxs)(S.View,{className:"DiscountDescBox",children:[(0,$.jsx)(S.View,{className:"DiscountPriceTitle",children:(0,$.jsx)(S.View,{style:{color:"rgb(51, 51, 51)",fontSize:16,fontWeight:"bold"},children:"\u8d77\u4ef7\u8bf4\u660e"})}),(0,$.jsx)(S.Text,{className:"DiscountDescContent",dangerouslySetInnerHTML:{__html:s}})]}),(0,$.jsx)(S.View,{style:{height:70}})]})})}function ln(e){var t=e.priceItem,n=t.PreferentialName,r=t.PreferentialPrice,i=(0,g.useState)(!1),a=(0,h.Z)(i,2),o=a[0],s=a[1],c=n&&n.length>18;return(0,$.jsxs)(S.View,{className:"DiscountInfoDetail",children:[(0,$.jsx)(S.View,{className:"DiscountInfoDetailText",children:(0,$.jsx)(S.Text,{style:{color:"rgb(102, 102, 102)",fontSize:12,display:"-webkit-box","-webkit-line-clamp":o?"9":"1",textOverflow:"ellipsis",overflow:"hidden","-webkit-box-orient":"vertical"},children:n})}),c&&(0,$.jsxs)(S.View,{className:"DiscountInfoDetailMore",onClick:function(){s(!o)},children:[(0,$.jsx)(S.Text,{style:{color:"rgb(153, 153, 153)",fontSize:12},children:"\u8be6\u7ec6\u8bf4\u660e"}),o?(0,$.jsx)(S.Text,{style:{color:"rgb(153, 153, 153)",fontSize:12,fontFamily:"crn_font_Ctrip_GroupTour"},children:"\ue946"}):(0,$.jsx)(S.Text,{style:{color:"rgb(153, 153, 153)",fontSize:12,fontFamily:"crn_font_Ctrip_GroupTour"},className:"detailIcon",children:"\ue945"})]}),(0,$.jsx)(S.View,{className:"DiscountInfoDetailNum",children:(0,$.jsxs)(S.Text,{style:{color:"rgb(102, 102, 102)",fontSize:13},children:["-\xa5",r]})})]})}function un(e){var t,n=e.isShowMenu,r=e.setIsShowMeanu,i=Y.useState((function(e){var t=e.BasicInfo;return{BasicInfo:t}})),a=i.BasicInfo,o=(0,v.getSystemInfoSync)(),s=o.statusBarHeight,c=(o.system,(0,v.getMenuButtonBoundingClientRect)()),l=c.top-s,u=(null===(t=a.Title)||void 0===t?void 0:t.length)>10?a.Title.slice(0,9)+"...":a.Title,d=(0,g.useState)(!1),f=(0,h.Z)(d,2),p=f[0],m=f[1];(0,v.usePageScroll)((function(e){var t=e.scrollTop;r(!1),t>200?p||(m(!0),x().setNavigationBarColor({backgroundColor:"#ffffff",frontColor:"#000000"})):p&&(m(!1),x().setNavigationBarColor({backgroundColor:"rgba(0,0,0,0.25)",frontColor:"#ffffff"}))}));var I=x().getCurrentPages(),T=1===I.length;return(0,$.jsxs)(S.View,{className:p?"NavBarBox":"NavBarBoxOpacity",onClick:function(){r(!1)},children:[(0,$.jsx)(S.View,{className:"NavBarPlaceHolder",style:{height:s}}),(0,$.jsxs)(S.View,{className:"NavBarTitleLine",style:{paddingTop:l,height:c.height},children:[(0,$.jsxs)(S.View,{className:"NavBarLeftBox",children:[T?(0,$.jsx)(S.View,{className:"NavBarLeftBtnBox",onClick:function(){X().switchTab({url:"/pages/home/homepage"})},children:(0,$.jsx)(S.Text,{className:"NavBarIcon",children:"\ueffe"})}):(0,$.jsx)(S.View,{className:"NavBarLeftBtnBox",onClick:function(){X().navigateBack()},children:(0,$.jsx)(S.Text,{className:"NavBarIcon",children:"\ue1a9"})}),(0,$.jsx)(S.View,{className:"NavBarLeftBetweenLine"}),(0,$.jsx)(S.View,{className:"NavBarLeftBtnBox",onClick:function(e){e.stopPropagation(),r(!n)},children:(0,$.jsx)(S.Text,{className:"NavBarIcon",children:"\uf7eb"})})]}),(0,$.jsx)(S.View,{className:"NavBarTitle",children:!!u&&(0,$.jsx)(S.Text,{className:"NavBarTitleText",children:p?u:""})})]}),n&&(0,$.jsx)(dn,{setIsShowMeanu:r})]})}function dn(e){var t=e.setIsShowMeanu,n=Y.useActions().handlers,r=n.handleGoFavouriteList,i=n.handleGoHistory;return(0,$.jsxs)(S.View,{className:"NavMenuBox",children:[(0,$.jsx)(S.View,{className:"NavMenuArrow"}),(0,$.jsxs)(S.View,{className:"NavMenuItem",onClick:function(e){e.stopPropagation(),i(),t(!1)},children:[(0,$.jsx)(S.Text,{className:"NavMenuItemIcon",children:"\ue15a"}),(0,$.jsx)(S.Text,{className:"NavMenuItemText",children:"\u6d4f\u89c8\u5386\u53f2"})]}),(0,$.jsxs)(S.View,{className:"NavMenuItem",onClick:function(e){e.stopPropagation(),r(),t(!1)},children:[(0,$.jsx)(S.Text,{className:"NavMenuItemIcon",children:"\udb80\udc18"}),(0,$.jsx)(S.Text,{className:"NavMenuItemText",children:"\u6536\u85cf\u5217\u8868"})]})]})}var fn=g.memo(mn),pn=fn;function mn(){var e=(0,g.useState)(!0),t=(0,h.Z)(e,2),n=t[0],r=t[1],i=(0,g.useState)(!1),a=(0,h.Z)(i,2),c=a[0],l=a[1],u=(0,g.useRef)(0),d=Y.useState((function(e){var t=e.currentRouteInfo,n=e.actionIdSuffix;return{currentRouteInfo:t,actionIdSuffix:n}})),f=d.currentRouteInfo,p=d.actionIdSuffix,m=f.DescriptionInfo;if((0,g.useEffect)((function(){function e(){return t.apply(this,arguments)}function t(){return t=(0,s.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=setInterval((function(){var e=x().createSelectorQuery(),n=e.select(".Layout >>> .ProductFeatureInfoBox");n&&n.boundingClientRect((function(e){e&&(console.log(e.height),e.height<=u.current?clearInterval(t):(u.current=e.height,e.height>600&&(l(!0),r(!1))))})).exec()}),750);case 1:case"end":return e.stop()}}),e)}))),t.apply(this,arguments)}e()}),[m]),!m||!m.Introduction)return null;var I=m.Introduction;return I=I.replace(/src="\/\//g,'src="https://'),I=I.replace(/style="/g,'style="font-size: 14px !important;text-align: left!important;line-height: 1.3!important;float: none!important;padding: 0!important;position: static!important;height: auto!important;'),I=I.replace(/<img(.*?)src="(.*?)"(.*?)\/?>/g,'<img style="display: block!important;vertical-align: top!important;width: 100%!important;" src="$2" />'),(0,$.jsxs)(S.View,{className:"FeatureModuleBox",id:"ProductFeature",children:[(0,$.jsx)(S.View,{className:"ModuleTitle",children:(0,$.jsx)(S.Text,{className:"ModuleTitleText",children:"\u4ea7\u54c1\u7279\u8272"})}),(0,$.jsx)(In,{}),(0,$.jsxs)(S.View,{className:"ProductFeatureBox",children:[(0,$.jsx)(S.View,{className:"ProductFeatureInfoBox ".concat(n?"active":""),children:(0,$.jsx)("mp-html",{content:I,copyLink:!1,onLinktap:function(e){}})}),c&&(0,$.jsxs)(S.View,{className:"ProductFeatureExpandTextBox FlexVerticalCenter",onClick:function(e){n&&x().pageScrollTo({selector:".ProductFeatureBox",duration:300}),r((function(e){return!e})),X().uploadUserAction(e,"".concat(p,"-info-spread"))},children:[(0,$.jsx)(S.Text,{className:"ContentExpandToggleText",children:n?"\u70b9\u51fb\u6536\u8d77":"\u5c55\u5f00\u5168\u90e8"}),n?(0,$.jsx)(S.Text,{className:"ContentExpandToggleText FontIcon MarginLeft8",children:"\ue946"}):(0,$.jsx)(S.Text,{className:"ContentExpandToggleText FontIcon MarginLeft8",children:"\ue945"})]})]})]})}function In(){var e=Y.useState((function(e){return e.currentRouteInfo})),t=Y.useState((function(e){return e.MainPMRecomendInfo})),n=Y.useState((function(e){return e.pageStatus})),r=Y.useState((function(e){return e.isPremium})),i=e||{},a=i.PMRecomendInfo;if(!a)return null;var o=a.RecommendList;if(!o&&n.isMultiTravel&&(o=t.RecommendList||[]),!o||!o.length)return null;var s=o.slice(0,3),c=s.every((function(e,t){var n=e.RecommendTag,r=e.DescDetail;return n.length+r.length<=22}));return(0,$.jsx)(S.View,{className:"SellingNewBoxInFeature",children:(0,$.jsx)(S.View,{children:s.map((function(e,t){var n=e.DescDetail.replace(/<(\/?)(?!br).*?>/gi,""),i="https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/point_no".concat(t+1,".png");return r&&(i.endsWith("_p.png")||(i=i.replace(".png","_p.png"))),(0,$.jsx)(S.View,{className:"SellingNewBoxItemInFeature",children:(0,$.jsxs)(S.View,{className:"SellingContentBox",children:[s.length>1&&(0,$.jsx)(S.Image,{className:"SellingNumberImgInFeature",src:i}),(0,$.jsxs)(S.Text,{className:"SellingTextMaxWidth",children:[(0,$.jsxs)(S.Text,{style:{color:"#333",fontSize:12,fontWeight:"bold"},children:[e.RecommendTag,"\xa0"]}),(0,$.jsx)(S.Text,{style:{color:"#666",fontSize:12},className:c?"SellingTextMaxWidth":"SellingInfoBoxText",children:n})]})]})},t)}))})})}function hn(){return(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(S.View,{className:"RouteInfoContainer",children:[(0,$.jsx)(gn,{}),(0,$.jsxs)(S.View,{className:"RouteInfoPadding",children:[(0,$.jsx)(vn,{}),(0,$.jsx)(xn,{}),(0,$.jsx)(pn,{})]})]}),(0,$.jsx)(S.View,{className:"RouteDetailBox",children:(0,$.jsx)(Sn,{})})]})}function gn(){var e,t=Y.useState((function(e){var t=e.pageStatus,n=e.isPremium,r=e.BasicInfo,i=e.currentRouteInfo;return{pageStatus:t,isPremium:n,BasicInfo:r,currentRouteInfo:i}})),n=(t.pageStatus,t.isPremium,t.BasicInfo),r=t.currentRouteInfo,i=Y.useActions().handlers.handleTraceLog,a=(0,g.useRef)(0),o="\u987b\u77e5",s=r.Visa;if(([11,12,26,34].includes(n.ProductCategoryId)||n.isCruise)&&s){var c=s.VisaCountryList,l=s.VisaDescList;if(c&&c.length||l&&l.length){var u="\u7b7e\u8bc1";53===n.DestProvinceId&&(u="\u5165\u53f0\u8bc1"),[58,59].indexOf(n.DestCityId)>-1&&(u="\u7b7e\u6ce8"),o="".concat(u,"/\u987b\u77e5")}}e=n.isDiyfhxsdp?[{text:"\u7279\u8272",ele:"#FakeProductSummary"},{text:"\u63a8\u8350\u884c\u7a0b",ele:"#RouteInfo"},{text:"\u8d39\u7528",ele:"#CostDescription"},{text:o,ele:"#OrderKnow"},{text:"\u8bc4\u4ef7",ele:"#Comment"}]:[{text:"\u7279\u8272",ele:"#ProductSummary"},{text:"\u884c\u7a0b",ele:"#RouteInfo"},{text:"\u8d39\u7528",ele:"#CostDescription"},{text:o,ele:"#OrderKnow"},{text:"\u8bc4\u4ef7",ele:"#Comment"}];var d=(0,v.getSystemInfoSync)(),f=d.statusBarHeight,p=(0,v.getMenuButtonBoundingClientRect)(),m=p.height+f+55;(0,v.usePageScroll)((function(e){var t=e.scrollTop;a.current=t}));var I=(0,g.useCallback)((function(e,t){var n=x().createSelectorQuery().select(e);n&&n.boundingClientRect((function(e){if(e){var t=a.current+e.top-m;x().pageScrollTo({scrollTop:t,duration:300,complete:function(){}})}})).exec()}),[]);return(0,$.jsx)(S.View,{style:{zIndex:1},children:(0,$.jsx)(S.View,{className:"RouteTabBox",id:"FakeProductSummary",children:e.map((function(e,t){var n=e.text,r=e.ele;return(0,$.jsxs)(S.View,{className:"HeaderTabItem ".concat(0===t?"FontWeightBold":""),onClick:function(){I(r,t),i("grp_prddtl_ptab_click",{tabid:t+1})},children:[(0,$.jsx)(S.Text,{children:n}),0===t&&(0,$.jsx)(S.View,{className:"TabBarline"})]},t)}))})})}function vn(){var e,t=Y.useState((function(e){var t=e.BasicInfo,n=e.pageStatus,r=e.groupInfo;return{BasicInfo:t,pageStatus:n,groupInfo:r}})),n=t.BasicInfo,r=t.pageStatus,i=t.groupInfo,a=r.isMultiLine,o=r.isMultiTravel,s=r.activeAlias,c=r.activeProductId,l="\u7ebf\u8def";a&&(l=null===i||void 0===i||null===(e=i.groupPriceList)||void 0===e||null===(e=e.find((function(e){return e.ProductId===c})))||void 0===e?void 0:e.lineName);return o&&(l="".concat(s,"\u7ebf")),(n.isDiyfhxsdp||n.isStudy)&&(l="\u4ea7\u54c1"),(0,$.jsxs)(S.View,{className:"RouteTitleBoxNew",children:[(0,$.jsx)(S.View,{className:"RouteTitleLine"}),(0,$.jsx)(S.View,{className:"RouteTitleText",children:(0,$.jsxs)(S.Text,{children:[l,"\u603b\u89c8"]})}),(0,$.jsx)(S.View,{className:"RouteTitleLine"})]})}function xn(){var e=Y.useState((function(e){var t=e.BasicInfo,n=e.currentRouteInfo,r=e.actionIdSuffix;return{BasicInfo:t,currentRouteInfo:n,actionIdSuffix:r}})),t=e.BasicInfo,n=e.currentRouteInfo,r=(e.actionIdSuffix,Y.useActions().handlers),i=r.handleGoTourPoiPage,a=r.handleTraceLog,o=r.handleGoVisa,s=n.TravelIntroductionInfo,c=(n.TagGroupInfo,n.Visa);if(!s||!s.TravelIntroductionList)return null;var l=(s.TravelIntroductionList||{})[0]||{},u=l.TravelSummaryInfoList,d=l.TravelOverviewInfo;if(!u||!u.length)return null;d&&d.DinnerTimeAssign,[11,12,26,34].includes(t.ProductCategoryId)||t.isCruise;t.IsInternal||t.DestProvinceId;var f=!0,p=c||{},m=p.VisaCountryList,I=p.VisaDescList;m&&m.length||I&&I.length||(f=!1);var h=jn(c),g=t.IsGoodGuideProduct;return(0,$.jsx)(S.View,{className:"SummaryBox",id:"ProductSummary",children:u.map((function(e,t){var n=e.SummaryIcon,r=e.SummaryTitle,s=e.SummaryType,c=e.SummaryItems,l=9===s;return(0,$.jsxs)(S.View,{className:"SummaryItem",children:[(0,$.jsxs)(S.View,{className:"SummaryItemTitle",children:[(0,$.jsx)(S.Image,{className:"SummaryItemTitleImg",src:n}),(0,$.jsx)(S.Text,{children:r})]}),(0,$.jsx)(S.View,{className:"SummaryItemContentBox",children:c.map((function(e,t){var n=e.ItemId,r=e.ItemText,s=e.SubItemText,c=5===n,u=22===n,d=[103,203].includes(n),p=[303].includes(n),m=[403].includes(n);return d||p||m?(0,$.jsx)(Cn,{IsGoodGuideProduct:g,ItemText:r,SubItemText:s,isDriver:p,isTPalItem:m},t):(l&&r.length>40&&(r=r.slice(0,36)+"..."),(0,$.jsxs)(S.View,{className:"SummaryItemContentItem",children:[(0,$.jsxs)(S.View,{className:"SummaryItemMainContent",children:[(0,$.jsx)(S.Text,{className:"SummaryItemMainContenDot",children:"\u2022\xa0"}),(0,$.jsxs)(S.View,{className:"SummaryItemMainContentTitle",children:[r,(c||u)&&(0,$.jsx)(S.Text,{className:"SummaryItemMainSubTitle",onClick:function(){i(c),u&&a("grp_prddtl_hoteldtl_click",{})},children:"\xa0\xa0\u8be6\u60c5"}),l&&f&&(0,$.jsx)(S.Text,{className:"SummaryItemMainSubTitle",onClick:function(){o()},children:"\xa0\xa0\u8be6\u60c5"})]})]}),!!s&&(0,$.jsx)(S.View,{className:"SummaryItemSubContent",children:(0,$.jsx)(S.Text,{children:s})}),l&&!!h&&(0,$.jsx)($.Fragment,{children:h.map((function(e,t){return(0,$.jsx)(S.View,{className:"SummaryItemSubContent",children:(0,$.jsx)(S.Text,{children:e})},t)}))})]},t))}))})]},t)}))})}function Sn(){var e=Y.useState((function(e){return e.currentRouteInfo.TravelIntroductionInfo}));if(!e||!e.TravelIntroductionList)return null;var t,n=e.TravelIntroductionList[0]||{},r=n.LocalTimeDesc,i=n.TravelHotelDesc,a=n.IntroductionInfoList;return null===a||void 0===a||a.forEach((function(e){if(e){var n=e.DailyList,r=void 0===n?[]:n;r.forEach((function(e,n){null!==e&&void 0!==e&&e.HotelInfoList&&null!==e&&void 0!==e&&e.HotelInfoList.length&&(t=!0)}))}})),(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(Tn,{TravelIntroductionInfo:e}),(0,$.jsx)(Pn,{}),!!r&&(0,$.jsxs)(S.View,{className:"RouteDetailTitleTextSub",children:[(0,$.jsx)(S.Text,{className:"RouteDetailIcon",children:"\uef89"}),(0,$.jsx)(S.Text,{className:"RouteTimeTipText",children:r})]}),!!t&&(0,$.jsxs)(S.View,{className:"RouteDetailTitleTextSub",children:[(0,$.jsx)(S.Text,{className:"RouteDetailIcon",children:"\uef89"}),(0,$.jsx)(S.Text,{className:"RouteTimeTipText",children:"\u9152\u5e97\u94bb\u7ea7\u7531\u643a\u7a0b\u5e73\u53f0\u8bc4\u5b9a,\u5177\u4f53\u8bc4\u5b9a\u6807\u51c6\u53ef\u89c1\u643a\u7a0b\u5e73\u53f0\u9152\u5e97\u9891\u9053"})]}),!!i&&(0,$.jsxs)(S.View,{className:"RouteDetailTitleTextSub",children:[(0,$.jsx)(S.Text,{className:"RouteDetailIcon",children:"\uef89"}),(0,$.jsx)(S.Text,{className:"RouteTimeTipText",children:i})]}),(0,$.jsxs)(S.View,{className:"RouteDetailTitleTextSub",children:[(0,$.jsx)(S.Text,{className:"RouteDetailIcon",children:"\uef89"}),(0,$.jsx)(S.Text,{className:"RouteTimeTipText",children:"\u666f\u70b9\u56fe\u7247\u4ec5\u4f9b\u53c2\u8003"})]})]})}function Tn(e){var t=e.TravelIntroductionInfo,n=t.TravelIntroductionList[0],r=n.TravelDetailList,i=(n.LocalTimeDesc,n.TravelOverviewInfo),a=Y.useState((function(e){var t=e.BasicInfo,n=e.actionIdSuffix;return{BasicInfo:t,actionIdSuffix:n}})),o=a.BasicInfo,s=(a.actionIdSuffix,o.isDiyfhxsdp),c=(Y.useActions().handlers.handleGoMapDetail,i||{}),l=c.TravelSummaryModuleList;o.TravelDays;if(l){var u=l.filter((function(e){return 5===e.ModuleId}));u&&u[0]&&u[0].Description||!1}return(0,$.jsx)(S.View,{className:"RouteDetailTitleBox",id:"RouteInfo",children:(0,$.jsx)(S.View,{className:"RouteDetailTitleInfo",children:(0,$.jsx)(S.Text,{className:"RouteDetailTitleText",children:s?"\u63a8\u8350\u884c\u7a0b":"".concat(r.length,"\u65e5\u884c\u7a0b")})})})}function Pn(){var e=Y.useState((function(e){var t=e.currentRouteInfo,n=t.TravelIntroductionInfo;return{TravelIntroductionInfo:n}})),t=e.TravelIntroductionInfo,n=Y.useActions().handlers,r=n.handleGoComplexRoutePage,i=(n.handleTraceLog,0);t&&t.TravelIntroductionList&&t.TravelIntroductionList[0]&&(i=t.TravelIntroductionList[0].IntroductionInfoList.length);var a=i>2?Array(i).fill(!1):Array(i).fill(!0),o=(0,g.useState)(a),s=(0,h.Z)(o,2),c=s[0],l=s[1];if(!t||!t.TravelIntroductionList)return null;var u=t.TravelIntroductionList[0],d=u.IntroductionInfoList;u.LocalTimeDesc,u.TravelHotelDesc,c.every((function(e){return e}));return(0,$.jsxs)(S.View,{className:"RouteDetailContentBox",children:[null===d||void 0===d?void 0:d.map((function(e,t){return(0,$.jsx)(wn,{day:e,dayIndex:t,allToggleStatus:c,setAllToggleStatus:l},e.FewDay)})),(0,$.jsx)(S.View,{className:"RouteExpandBox",onClick:function(){r()},children:(0,$.jsxs)(S.View,{className:"RouteExpandBoxBg",children:[(0,$.jsx)(S.Text,{className:"RouteExpandBoxText",style:{color:"#007FE9",fontSize:"12px"},children:"\u67e5\u770b\u8be6\u7ec6\u884c\u7a0b"}),(0,$.jsx)(S.Text,{className:"RouteExpandBoxIcon",children:"\ue944"})]})})]})}var yn=function(e){var t=e.scenicList.filter((function(e,t){return[3,12].includes(e.ActiveType)})),n=[];t.map((function(e){e.ScenicSpotList[0]&&(e.ScenicSpotList[0].timeIndex=0),n.push.apply(n,(0,y.Z)(e.ScenicSpotList))}));var r=new Set;n.map((function(e){if(e.PoiDistrictInfo)if("City"==e.PoiDistrictInfo.DistrictType)r.add(e.PoiDistrictInfo.Name);else if(e.PoiDistrictInfo.ParentDistrictPath[0]){var t=e.PoiDistrictInfo.ParentDistrictPath[0],n=t.Name,i=t.DistrictType;"Country"===i?r.add(e.PoiDistrictInfo.Name):r.add(n)}}));var i=[];return n.map((function(e,t){var r=e.Name,a=0!==e.timeIndex&&!!n[t-1].OrFlag,o=i.length-1;a?i[o]=i[o]+" \u6216 "+r:i.push(r)})),i};function wn(e){var t,n=e.day,r=e.dayIndex,i=(e.allToggleStatus,e.setAllToggleStatus,Y.useState((function(e){var t=e.currentRouteInfo,n=e.BasicInfo,r=e.pageStatus,i=e.TourGroupInfo,a=e.TravelList,o=e.isPremium,s=e.CruiseJourneyInfo,c=e.ABTestResult,l=t.TravelIntroductionInfo,u=t.TagGroupInfo,d=i.TourGroupProductInfo;return{TravelIntroductionInfo:l,BasicInfo:n,pageStatus:r,TourGroupProductInfo:d,TravelList:a,isPremium:o,CruiseJourneyInfo:s,TagGroupInfo:u,ABTestResult:c}}))),a=i.TravelIntroductionInfo,o=i.BasicInfo,s=(i.pageStatus,i.TourGroupProductInfo,i.TravelList,i.CruiseJourneyInfo),c=i.TagGroupInfo,l=(i.ABTestResult,Y.useActions().handlers),u=l.handleTraceLog,d=l.handleGoPoiPage;if(!a||!a.TravelIntroductionList)return null;o.isPureDiyfhxsdp;var f=a.TravelIntroductionList[0],p=f.IntroductionInfoList,m=f.TravelDetailList,I=n.FewDay,h=n.Desc,g=n.DailyList,v=n.TravelDate,x=s&&s.filter((function(e){return e.date===v})),T=x&&x[0]&&(null===(t=x[0])||void 0===t||null===(t=t.journeyItemList[0])||void 0===t?void 0:t.tours);T&&T.length,yn(m[r]);c&&c.MoreTagList&&c.MoreTagList.some((function(e){return 1895===e.TagId}));e:for(var P=0;P<p.length;P++){var y=p[P].DailyList;y=y||[];for(var w=0;w<y.length;w++)if(8===y[w].ActiveType){[P,w];break e}}var C=[];g=g||[];var N="https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/defaultscenic.png";return g.forEach((function(e,t){var n=e.ActiveType,r=e.ScenicSpotList;[3,12].includes(n)&&r.forEach((function(e,t){if(0!==t&&r[t-1].OrFlag||!e.GSScenicSpotID);else{var n=e.Name,i=e.ImgList,a=e.SuffixName,o=e.GSScenicSpotID,s=n+(a||""),c=i&&i[0]&&i[0].UrlList[0].Value||N;c=c.replace("360_202","480_240"),C.find((function(e){return e.GSScenicSpotID===o}))||C.push({ImgUrl:c,fullname:s,scenic:e,GSScenicSpotID:o})}}))})),(0,$.jsxs)(S.View,{className:"RouteDetailDayBox",children:[(0,$.jsxs)(S.Text,{className:"RouteDetailDay",children:[(0,$.jsxs)(S.Text,{className:"RouteDetailDayTitleNum detaiNumFont20THBold",children:["D",I]}),(0,$.jsx)(S.Text,{className:"RouteDetailDayTitleNumLine",children:"|"}),(0,$.jsx)(S.Text,{className:"RouteDetailDayTitleText",children:h})]},I),(0,$.jsx)(S.ScrollView,{scrollX:!0,scrollWithAnimation:!0,enableFlex:!0,className:"scrollViewBox",children:(0,$.jsx)(S.View,{className:"routeImgsList",children:C.map((function(e,t){var n=e.scenic;return(0,$.jsxs)(S.View,{className:"RouteImgsContainer",onClick:function(){u("grp_prddtl_exposedpoi_trace",{position:t+1}),d(n)},children:[(0,$.jsx)(S.Image,{src:e.ImgUrl,className:"RouteImgNew"}),(0,$.jsx)(S.View,{className:"RouteImgNewMask"}),(0,$.jsx)(S.View,{className:"RouteImgText",children:(0,$.jsx)(S.Text,{children:e.fullname})})]},t)}))})})]})}function Cn(e){var t=e.IsGoodGuideProduct,n=e.ItemText,r=e.SubItemText,i=e.isDriver,a=void 0!==i&&i,o=e.isTPalItem,s=void 0!==o&&o,c=Y.useActions().handlers,l=(c.handleToggleGoldGuideMask,c.handleGoGuideList),u=(c.handleToggleTpalMask,c.handleGoTagUrl),d=Y.useState((function(e){var t=e.currentRouteInfo;return{currentRouteInfo:t}})),f=d.currentRouteInfo,p="* \u4ee5\u4e0a\u4e3a\u8fd1\u671f\u5e26\u8fc7\u672c\u56e2\u7684\u5bfc\u6e38\uff08\u5177\u4f53\u5bfc\u6e38\u4ee5\u5b9e\u9645\u5206\u914d\u4e3a\u51c6\uff09";s?p="* \u4ee5\u4e0a\u4e3a\u8fd1\u671f\u5e26\u8fc7\u672c\u56e2\u7684T.PAL\uff08\u5177\u4f53T.PAL\u4ee5\u5b9e\u9645\u5206\u914d\u4e3a\u51c6\uff09":a&&(p="* \u4ee5\u4e0a\u4e3a\u8fd1\u671f\u5e26\u8fc7\u672c\u56e2\u7684\u53f8\u673a\uff08\u5177\u4f53\u53f8\u673a\u4ee5\u5b9e\u9645\u5206\u914d\u4e3a\u51c6\uff09");var m=f.servicePerson;return m&&m.servicePersons&&m.servicePersons.length||(p=""),t?(0,$.jsxs)(S.View,{children:[(0,$.jsx)(S.Image,{className:"GuideListContanerBg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/shop/guide/detailgoldbg.png"}),(0,$.jsxs)(S.View,{className:"SummaryItemContentItem",children:[(0,$.jsxs)(S.View,{className:"SummaryItemMainContent",onClick:function(){u("https://m.ctrip.com/tangram/Mjk0MDk=?ctm_ref=vactang_page_29409&isHideNavBar=YES&apppgid=401019")},children:[(0,$.jsx)(S.Text,{className:"SummaryItemMainContenDot",children:"\u2022\xa0"}),(0,$.jsx)(S.View,{className:"SummaryItemMainContentTitle",children:"\u5168\u7a0b\u7531\u91d1\u724c\u5bfc\u6e38\u5e26\u56e2"}),(0,$.jsx)(S.Text,{className:"SummaryGuideEntryIcon",children:"\ue944"})]}),!!r&&(0,$.jsx)(S.View,{className:"SummaryItemSubContent",children:(0,$.jsx)(S.Text,{style:{zIndex:2},children:r})}),(0,$.jsx)(Nn,{}),!!p&&(0,$.jsx)(S.View,{className:"SummaryItemBottomContent",children:(0,$.jsx)(S.Text,{children:p})})]})]}):s?(0,$.jsxs)(S.View,{children:[(0,$.jsx)(S.Image,{className:"GuideListContanerBg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/shop/guide/detailtpalbg.png"}),(0,$.jsxs)(S.View,{className:"SummaryItemContentItem",children:[(0,$.jsxs)(S.View,{className:"SummaryItemMainContent",onClick:function(){u("https://m.ctrip.com/tangram/MzE0MDA=?ctm_ref=vactang_page_31400&isHideNavBar=YES&apppgid=401019")},children:[(0,$.jsx)(S.Text,{className:"SummaryItemMainContenDot",children:"\u2022\xa0"}),(0,$.jsx)(S.View,{className:"SummaryItemMainContentTitle",children:n}),(0,$.jsx)(S.Text,{className:"SummaryGuideEntryIcon",children:"\ue944"})]}),!!r&&(0,$.jsx)(S.View,{className:"SummaryItemSubContent",children:(0,$.jsx)(S.Text,{style:{zIndex:2},children:r})}),(0,$.jsx)(Nn,{}),!!p&&(0,$.jsx)(S.View,{className:"SummaryItemBottomContent",children:(0,$.jsx)(S.Text,{children:p})})]})]}):(0,$.jsxs)(S.View,{className:"SummaryItemContentItem",children:[(0,$.jsxs)(S.View,{className:"SummaryItemMainContent",onClick:function(){a&&l()},children:[(0,$.jsx)(S.Text,{className:"SummaryItemMainContenDot",children:"\u2022\xa0"}),(0,$.jsx)(S.View,{className:"SummaryItemMainContentTitle",children:n}),!!a&&(0,$.jsx)(S.Text,{className:"SummaryGuideEntryIcon",children:"\ue944"})]}),!!r&&(0,$.jsx)(S.View,{className:"SummaryItemSubContent",children:(0,$.jsx)(S.Text,{children:r})}),(0,$.jsx)(Nn,{}),!!p&&(0,$.jsx)(S.View,{className:"SummaryItemBottomContent",children:(0,$.jsx)(S.Text,{children:p})})]})}function Nn(){var e=Y.useActions().handlers,t=e.handleGoGuideList,n=e.handleGoGuideDetail,r=(e.handleTraceLog,Y.useState((function(e){var t=e.currentRouteInfo,n=e.BasicInfo;return{currentRouteInfo:t,BasicInfo:n}}))),i=r.currentRouteInfo,a=(r.BasicInfo,"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/shop/avatar.png"),o=i.servicePerson;if(!o||!o.servicePersons||!o.servicePersons.length)return null;var s=o.rowCount,c=o.servicePersons,l=!1,u=l?c.slice(0,3):c.slice(0,2);return(0,$.jsxs)(S.View,{className:"GuideListContaner",children:[(0,$.jsx)(S.View,{className:"GuideList",children:u.map((function(e,t){var r=e.servicePersonID,i=e.cName,o=e.lifePhoto,s=e.guideCommentAverageScore,c=e.workExperience,l=e.isNewGoodGuide,u=s&&s>0?Number(s).toFixed(1):0;o=o.replace(".jpg","_R_200_200.jpg?proc=autoorient");var d=l&&"1"===l,f=c&&Number(c)>0?Math.floor(Number(c)/12):0,p=Number(c)-12*f;return(0,$.jsxs)(S.View,{className:"GuideListItem",onClick:function(){n(r)},children:[!!d&&(0,$.jsx)(S.Image,{className:"GuideListItemGoldIcon",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/shop/guide/goldicontag.png"}),(0,$.jsx)(S.Image,{className:"GuideListItemImg",src:o||a}),(0,$.jsxs)(S.View,{className:"GuideListInfo",children:[(0,$.jsxs)(S.View,{className:"GuideListInfoName",children:[(0,$.jsx)(S.Text,{className:"GuideListInfoNameText",children:i}),(0,$.jsx)(S.Text,{className:"GuideListInfoNameIcon",children:"\ue944"})]}),(0,$.jsxs)(S.View,{className:"GuideListInfoTag",children:[!!u&&u>0&&(0,$.jsx)(S.Text,{className:"GuideListInfoTagText",children:"".concat(u,"\u5206")}),!!u&&u>0&&!!c&&Number(c)>0&&(0,$.jsx)(S.View,{className:"GuideListInfoTagLine"}),!!c&&Number(c)>0&&(0,$.jsxs)(S.Text,{className:"GuideListInfoTagText",children:["\u4ece\u4e1a",f>0?"".concat(f,"\u5e74"):"".concat(p,"\u6708")]})]})]})]},t)}))}),(0,$.jsxs)(S.View,{className:"GuideListButton",onClick:function(){t()},style:{zIndex:2},children:[(0,$.jsx)(S.Text,{className:"GuideEntryButtonText",children:"\u5168"}),(0,$.jsx)(S.Text,{className:"GuideEntryButtonText",children:"\u90e8"}),(0,$.jsx)(S.Text,{className:"GuideEntryButtonText",children:s}),(0,$.jsx)(S.Text,{className:"GuideEntryButtonText",children:"\u4f4d"}),(0,$.jsx)(S.Text,{className:"GuideEntryButtonIcon",children:"\udb80\udcf9"})]})]})}var Dn={1:"\u4e0d\u9700\u672c\u4eba\u5230\u573a",2:"\u9700\u7b49\u5f85\u643a\u7a0b\u901a\u77e5\u662f\u5426\u9700\u672c\u4eba\u5230\u573a",3:"\u9700\u672c\u4eba\u5230\u573a"},jn=function(e){if(!e)return null;var t=e.VisaCountryList;if(!t||!t.length)return null;var n=[];if(1===t.length){var r=t[0],i=r.VisaInterview,a=(r.VisaType,r.VisaTypeName),o=i?"".concat(Dn[i],"\uff0c\u529e\u7406\u7c7b\u578b\u4e3a").concat(a):"\u529e\u7406\u7c7b\u578b\u4e3a".concat(a);n.push(o)}else{var s=t.every((function(e){return e.VisaInterview===t[0].VisaInterview&&e.VisaType===t[0].VisaType}));if(s){var c=t[0],l=c.VisaInterview,u=(c.VisaType,c.VisaTypeName),d=l?"".concat(Dn[l],"\uff0c\u529e\u7406\u7c7b\u578b\u4e3a").concat(u):"\u529e\u7406\u7c7b\u578b\u4e3a".concat(u);n.push(d)}else t.forEach((function(e){var t=e.Country,r=e.VisaInterview,i=(e.VisaType,e.VisaTypeName),a=r?"".concat(t,"\uff1a").concat(Dn[r],"\uff0c\u529e\u7406\u7c7b\u578b\u4e3a").concat(i):"".concat(t,"\uff1a\u529e\u7406\u7c7b\u578b\u4e3a").concat(i);n.push(a)}))}return n};function _n(){var e=Y.useState((function(e){var t=e.pageId,n=e.pageStatus,r=e.BasicInfo,i=e.wakenUpData,a=e.isShowPromotionMask;return{pageId:t,pageStatus:n,BasicInfo:r,wakenUpData:i,isShowPromotionMask:a}})),t=(e.pageId,e.pageStatus,e.BasicInfo,e.wakenUpData,e.isShowPromotionMask),n=Y.useActions().handlers.handleTogglePromotionMask;return t?(0,$.jsx)(Ot.Z,{title:"\u4f18\u60e0\u4fe1\u606f",handleClose:function(){n(!1)},backgroundColor:"#f8f8f8",children:(0,$.jsxs)(S.View,{className:"PopMaskContainer",style:{margin:12,marginTop:0,backgroundColor:"#f8f8f8"},children:[(0,$.jsx)(kn,{}),(0,$.jsx)(Ln,{}),(0,$.jsx)(Bn,{}),(0,$.jsx)(Rn,{}),(0,$.jsx)(En,{}),(0,$.jsx)(An,{}),(0,$.jsx)(On,{}),(0,$.jsx)(bn,{})]})}):null}function bn(){var e=Y.useState((function(e){var t=e.pageId,n=e.pageStatus,r=e.BasicInfo,i=e.currentRouteInfo,a=i.CouponInfo;return{pageId:t,pageStatus:n,BasicInfo:r,CouponInfo:a}})),t=e.pageId,n=e.pageStatus,r=e.BasicInfo,i=e.CouponInfo,a=(0,g.useState)(0),o=(0,h.Z)(a,2),s=o[0],l=o[1];if(![1,2,3,4].includes(r.ProductPatternId)||![9,10,11,26,33,34,41,42].includes(r.ProductCategoryId)||!["S","O","P","G","R"].includes(r.SaleMode))return null;if(!i)return null;var u=i.availableClaimList,d=i.availableUseList,f=i.singkekList,p=i.receivedNouseList;u=u||[],d=d||[],f=f||[],p=p||[];var m=[].concat((0,y.Z)(u),(0,y.Z)(f),(0,y.Z)(d),(0,y.Z)(p));if(!m||!m.length)return null;var v=X().mkt.getUnion(),x=v.allianceid,S=v.sid,T=De.Z.getEnv();"prd"===T&&(T="prod");var P={needPopover:!1,visible:!0,isShowEmptyContent:!1,clientEnv:{env:T,ctType:0,clientType:3},Header:null,data:{forceReloadTimestamp:String(s),source:"TOUR",saleChannel:117,allianceId:x,siteId:S,clientId:X().clientID,pageId:t,locale:"zh-CN",currency:"CNY",productId:n.activeProductId},onLoadData:function(e){console.log("onLoadData",e)},onClaim:function(e){l(s+1)}};return(0,$.jsx)(I.ClaimCoupon,(0,c.Z)({},P))}function kn(){var e=Y.useState((function(e){var t=e.userInformation;return{userInformation:t}})),t=e.userInformation,n=Y.useActions().handlers,r=n.handleGoMemberShip,i=n.handleGoBonusPage;if(!t||!t.levelMember)return null;var a=t.levelMember,o=a.levelCode,s=a.rights;if(o<20||1===s.length&&s[0]&&"LEVELMEMBER_BONUS"===s[0].type)return null;var c={0:"#4daaf8",5:"#6291d5",10:"#c49d59",20:"#218db1",30:"#595cb3",35:"#5533b0",40:"#a27a4f"},l={LEVELMEMBER_PRICE:r,LEVELMEMBER_CANCEL:r,LEVELMEMBER_BONUS:i};return(0,$.jsxs)(S.View,{className:"PromotionMemeberBox",children:[(0,$.jsx)(S.Image,{className:"PromotionMemeberBg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/vipbg/vip_".concat(o,".png")}),(0,$.jsx)(S.View,{className:"PromotionMemberContentBox",children:s.map((function(e,t){var n=e.title,r=e.type,i=e.desc,a=l[r];return(0,$.jsxs)(S.View,{className:"PromotionMemberItem",onClick:function(){a()},children:[(0,$.jsxs)(S.View,{className:"PromotionMemberInfo",children:[(0,$.jsx)(S.View,{className:"PromotionMemberTitle",children:(0,$.jsxs)(S.Text,{style:{color:c[o],fontSize:12,fontWeight:"bold"},children:["\u2022\xa0",n]})}),(0,$.jsx)(S.View,{className:"PromotionMemberContent",children:(0,$.jsx)(S.Text,{style:{color:"#333333",fontSize:12},children:i})})]}),!!a&&(0,$.jsx)(S.Text,{style:{color:"#666666",fontSize:12},className:"PromotionDetailIcon",children:"\ue944"})]},t)}))})]})}function Ln(){var e=Y.useState((function(e){var t=e.userInformation;return{userInformation:t}})),t=e.userInformation,n=Y.useActions().handlers.handleGoMemberShip;if(!t||!t.superMember)return null;var r=t.superMember,i=r.rights;return i&&i.length?(0,$.jsxs)(S.View,{className:"PromotionMemeberBox",children:[(0,$.jsx)(S.Image,{className:"PromotionMemeberBg",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/vipbg/vip_s.png"}),(0,$.jsx)(S.View,{className:"PromotionMemberContentBox",children:i.map((function(e,t){var r=e.title,i=e.desc;return(0,$.jsxs)(S.View,{className:"PromotionMemberItem",onClick:function(){n()},children:[(0,$.jsxs)(S.View,{className:"PromotionMemberInfo",children:[(0,$.jsx)(S.View,{className:"PromotionMemberTitle",children:(0,$.jsxs)(S.Text,{style:{color:"#7b3e29",fontSize:12,fontWeight:"bold"},children:["\u2022\xa0",r]})}),(0,$.jsx)(S.View,{className:"PromotionMemberContent",children:(0,$.jsx)(S.Text,{style:{color:"#333333",fontSize:12},children:i})})]}),(0,$.jsx)(S.Text,{style:{color:"#666666",fontSize:12},className:"PromotionDetailIcon",children:"\ue944"})]},t)}))})]}):null}function Bn(){var e=Y.useState((function(e){var t=e.userInformation;return{userInformation:t}})),t=e.userInformation,n=Y.useActions().handlers.handleGoFlightDiscountPage;if(!t||!t.crossMember)return null;var r=t.crossMember,i=r.rights;if(!i||!i.length)return null;var a=i[0].desc;return a?(0,$.jsxs)(S.View,{className:"PromotionItemBox",children:[(0,$.jsx)(S.View,{className:"PromotionItemTitle",children:(0,$.jsx)(S.Text,{style:{color:"#333333",fontSize:15,fontWeight:"bold"},children:"\u673a\u7968\u7528\u6237\u6743\u76ca"})}),(0,$.jsx)(S.View,{className:"PromotionItemContentList",children:(0,$.jsx)(S.View,{className:"PromotionItemContentItem",onClick:function(){n()},children:(0,$.jsxs)(S.View,{className:"PromotionTitleBox",children:[(0,$.jsx)(S.View,{className:"PromotionTitleText",children:(0,$.jsx)(S.Text,{style:{color:"#333333",fontSize:12},children:a})}),(0,$.jsx)(S.Text,{style:{color:"#666666",fontSize:12},className:"PromotionDetailIcon",children:"\ue944"})]})})})]}):null}function Rn(){var e=Y.useState((function(e){var t=e.BasicInfo,n=e.actionIdSuffix,r=e.pageId,i=e.promotionDisplayInfo;return{BasicInfo:t,actionIdSuffix:n,pageId:r,promotionDisplayInfo:i}})),t=e.BasicInfo,n=(e.actionIdSuffix,e.pageId,e.promotionDisplayInfo),r=Y.useActions().handlers,i=r.handleGoCreditInfo,a=r.handleTraceLog,o=t.isCruise,s=(0,g.useState)(!1),c=(0,h.Z)(s,2),l=c[0],u=c[1];if(o)return null;if(!n||!n.creditInfo)return null;var d=n.creditInfo,f=d.PromotionWords,p=d.ButtonText,m=d.IsCreditSuccess;return f?(0,$.jsxs)(S.View,{className:"PromotionItemBox",children:[(0,$.jsx)(S.View,{className:"PromotionItemTitle",children:(0,$.jsx)(S.Text,{style:{color:"#333333",fontSize:15,fontWeight:"bold"},children:"\u62ff\u53bb\u82b1\u5206\u671f"})}),(0,$.jsx)(S.View,{className:"PromotionItemContentList",children:(0,$.jsxs)(S.View,{className:"PromotionItemContentItem",onClick:function(){m?u(!l):i(),a("grp_prddtl_naquhua_click",{})},children:[(0,$.jsxs)(S.View,{className:"PromotionTitleBox",children:[(0,$.jsx)(S.View,{className:"PromotionTitleText",children:!!f&&(0,$.jsx)(S.Text,{style:{color:"#333333",fontSize:12},children:f})}),(0,$.jsxs)(S.View,{className:"PromotionTitleArrow",children:[!!p&&(0,$.jsx)(S.Text,{className:"PromotionDetailIcon",style:{color:"#666666",fontSize:12},children:p}),m?(0,$.jsx)(Zn,{isShowAll:l,setIsShowAll:u}):(0,$.jsx)(S.Text,{className:"PromotionDetailIcon",style:{color:"#666666",fontSize:12},children:"\ue944"})]})]}),!!l&&(0,$.jsx)(Mn,{})]})})]}):null}function Mn(){var e=Y.useState(),t=e.promotionDisplayInfo;if(!t||!t.creditInfo)return null;var n=t.creditInfo,r=n.ActivityInfo,i=n.FirstRepayDay;return(0,$.jsxs)(S.View,{className:"PromotionContentText",children:[(0,$.jsxs)(S.View,{className:"PromotionCreditInfoBox",children:[!!r&&(0,$.jsx)(S.Text,{className:"PromotionCreditInfoItem",style:{color:"#333333",fontSize:12},children:r}),!!i&&(0,$.jsxs)(S.Text,{className:"PromotionCreditInfoItem",style:{color:"#333333",fontSize:12},children:["\u4eca\u5929\u9884\u8ba2\uff0c\u9884\u8ba1",i,"\u8fd8\u6b3e\u3002"]})]}),(0,$.jsx)(S.Text,{className:"PromotionCreditTip",style:{color:"#999999",fontSize:13},children:"\u2022\xa0\u62ff\u53bb\u82b1\u7528\u6237\u5728\u53ef\u7528\u989d\u5ea6\u5185\uff0c\u53ef\u4f7f\u7528\u62ff\u53bb\u82b1\u5206\u671f\u4ed8\u6b3e\u3002"}),(0,$.jsx)(S.Text,{className:"PromotionCreditTip",style:{color:"#999999",fontSize:13},children:"\u2022\xa0\u5f53\u524d\u5206\u671f\u670d\u52a1\u4ec5\u4f9b\u53c2\u8003\uff0c\u8be6\u7ec6\u4fe1\u606f\u4ee5\u6536\u94f6\u53f0\u5c55\u793a\u4e3a\u51c6\u3002"}),(0,$.jsx)(S.Text,{className:"PromotionCreditTip",style:{color:"#999999",fontSize:13},children:"\u2022\xa0\u8d26\u6237\u5185\u5982\u6709\u53ef\u7528\u7684\u62ff\u53bb\u82b1\u4f18\u60e0\uff0c\u4f1a\u9ed8\u8ba4\u4f7f\u7528\uff0c\u5c55\u793a\u7684\u670d\u52a1\u8d39\u5373\u4e3a\u5df2\u4eab\u4f18\u60e0\u7684\u670d\u52a1\u8d39\u3002"}),(0,$.jsx)(S.Text,{className:"PromotionCreditTip",style:{color:"#999999",fontSize:13},children:"\u2022\xa0\u5177\u4f53\u7684\u5206\u671f\u670d\u52a1\u63d0\u4f9b\u5546\u53ca\u534f\u8bae\uff0c\u8bf7\u81f3\u62ff\u53bb\u82b1\u9996\u9875-\u8bbe\u7f6e-\u534f\u8bae\u4e0e\u58f0\u660e\u4e2d\u67e5\u770b\u8be6\u60c5\u3002"})]})}function En(){var e=Y.useState(),t=e.compositeCoupon;if(!t)return null;var n=t.promotionList,r=t.promotionCount;return r?(0,$.jsx)($.Fragment,{children:n.map((function(e,t){return(0,$.jsx)(Vn,{type:e},t)}))}):null}function Vn(e){var t=e.type,n=t.list,r=t.title,i=(0,g.useState)(!1),a=(0,h.Z)(i,2),o=a[0],s=a[1],c=n[0];return(0,$.jsxs)(S.View,{className:"PromotionItemBox",children:[(0,$.jsx)(S.View,{className:"PromotionItemTitle",children:(0,$.jsx)(S.Text,{style:{color:"#333333",fontSize:15,fontWeight:"bold"},children:r})}),o?(0,$.jsx)(S.View,{className:"PromotionItemContentList",children:n.map((function(e,t){var n=e.promotionSubTypeName,r=e.name,i=e.linePrefix,a=e.description;return(0,$.jsxs)(S.View,{className:"PromotionItemContentItem",children:[(0,$.jsxs)(S.View,{className:"PromotionTitleTopBox",children:[(0,$.jsx)(S.View,{className:"PromotionTitleTextShowAll",children:(0,$.jsxs)(S.Text,{style:{color:"#333333",fontSize:12},children:[n,r,i]})}),0===t&&(0,$.jsx)(S.View,{className:"PromotionTitleArrow",children:(0,$.jsx)(Zn,{isShowAll:o,setIsShowAll:s})})]}),!!a&&(0,$.jsx)(S.View,{className:"PromotionContentText",children:(0,$.jsx)(S.Text,{style:{color:"#999999",fontSize:12},children:a})})]},t)}))}):(0,$.jsx)(S.View,{className:"PromotionItemContentList",children:(0,$.jsx)(S.View,{className:"PromotionItemContentItem",children:(0,$.jsxs)(S.View,{className:"PromotionTitleTopBox",children:[(0,$.jsx)(S.View,{className:"PromotionTitleText",children:(0,$.jsxs)(S.Text,{style:{color:"#333333",fontSize:12},className:"ellipsis",children:[c.promotionSubTypeName,c.name,c.linePrefix]})}),(n.length>1||c.description||c.name.length>16)&&(0,$.jsx)(S.View,{className:"PromotionTitleArrow",children:(0,$.jsx)(Zn,{isShowAll:o,setIsShowAll:s})})]})})})]})}function An(){var e=Y.useState((function(e){var t=e.userInformation;return{userInformation:t}})),t=e.userInformation,n=Y.useActions().handlers.handleGoBonusPage;if(!t||!t.levelMember)return null;var r=t.levelMember,i=r.rights,a=i.find((function(e){return"LEVELMEMBER_BONUS"===e.type}));return!a||!a.desc||i.length>1?null:(0,$.jsxs)(S.View,{className:"PromotionItemBox",children:[(0,$.jsx)(S.View,{className:"PromotionItemTitle",children:(0,$.jsx)(S.Text,{style:{color:"#333333",fontSize:15,fontWeight:"bold"},children:a.title})}),(0,$.jsx)(S.View,{className:"PromotionItemContentList",children:(0,$.jsx)(S.View,{className:"PromotionItemContentItem",onClick:function(){n()},children:(0,$.jsxs)(S.View,{className:"PromotionTitleBox",children:[(0,$.jsx)(S.View,{className:"PromotionTitleText",children:(0,$.jsx)(S.Text,{style:{color:"#333333",fontSize:12},children:a.desc})}),(0,$.jsx)(S.Text,{className:"PromotionDetailIcon",style:{color:"#666666",fontSize:12},children:"\ue944"})]})})})]})}function Zn(e){var t=e.isShowAll,n=e.setIsShowAll;return(0,$.jsx)(S.View,{onClick:function(){n(!t)},className:"PromotionToggleBtn",children:t?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(S.Text,{className:"PromotionDetailIcon",style:{color:"#666666",fontSize:12},children:"\u6536\u8d77"}),(0,$.jsx)(S.Text,{className:"PromotionDetailIcon",style:{color:"#666666",fontSize:12},children:"\ue0b3"})]}):(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(S.Text,{className:"PromotionDetailIcon",style:{color:"#666666",fontSize:12},children:"\u5c55\u5f00"}),(0,$.jsx)(S.Text,{className:"PromotionDetailIcon",style:{color:"#666666",fontSize:12},children:"\ue0b2"})]})})}function On(){var e=Y.useState((function(e){var t=e.specialTag;return{specialTag:t}})),t=e.specialTag,n=Y.useActions().handlers,r=n.handleGoTagUrl;n.handleTraceLog;if(!t)return null;var i=t&&t.ImageUrl;return(0,$.jsx)(S.View,{onClick:function(){t.AlbumUrl&&r(t.AlbumUrl)},className:"ImageBannerBoxBigPic",children:(0,$.jsx)(S.Image,{className:"ImageBannerImg",src:i})})}var Un=[{description:"18\u5c81\u4ee5\u4e0b\u672a\u6210\u5e74\u4eba\u9700\u8981\u81f3\u5c11\u4e00\u540d\u5bb6\u957f\u6216\u6210\u5e74\u65c5\u5ba2\u5168\u7a0b\u966a\u540c\u3002"},{description:"\u4ee5\u4e0a\u4ef7\u683c\u5747\u4e3a\u4eba\u5747\u4ef7"}];function Fn(e){var t=e.controller,n=Y.useState((function(e){var t=e.isShowBookingLimitMask,n=e.BasicInfo,r=e.pageStatus,i=e.currentRouteInfo;return{isShowBookingLimitMask:t,BasicInfo:null!==n&&void 0!==n?n:{},pageStatus:r,currentRouteInfo:i}})),r=n.isShowBookingLimitMask,i=n.BasicInfo,a=n.pageStatus,o=n.currentRouteInfo,s=o.SegmentInfo,c=o.BookInfo,l=o.OrderKnow,u=c.MinBookPerson,d=c.MaxBookPerson,f=i.IsOverSea,p=Y.useActions().handlers.handleToggleBookingLimitMask;if(!r)return null;var m=s.Segments||[],I=m.some((function(e){return!0===e.IsIncludeSystemFlight})),h=m.some((function(e){return!0===e.IsIncludeHotel})),g=m.some((function(e){return!0===e.IsIncludeSystemTrain})),v=(null===l||void 0===l?void 0:l.OrderKnowList)||[],x=v.find((function(e){return"\u9884\u8ba2\u9650\u5236"==e.Title})),T=(null===x||void 0===x?void 0:x.DescList)||[],P=a.isPureDiyfhxsdp?"sdp":"grp";return(0,$.jsx)(Ot.Z,{title:"\u9884\u8ba2\u9650\u5236",handleClose:function(){p(!1)},children:(0,$.jsxs)(S.View,{className:"PopMaskContainer MarginX32",children:["grp"===P&&(0,$.jsxs)(S.View,{children:[(0,$.jsxs)(S.View,{className:"BookingLimitMaskLine",children:[(0,$.jsx)(S.View,{className:"BookingLimitMaskIcon",children:"\ue167"}),(0,$.jsxs)(S.View,{className:"BookingLimitMaskText",children:["\u8be5\u4ea7\u54c1\u6700\u5c11",u,"\u4eba\u8d77\u8ba2\uff0c\u6210\u4eba+\u513f\u7ae5\u6700\u591a\u652f\u6301",d,"\u4eba"]})]}),!!T&&(0,$.jsx)(S.View,{children:T.map((function(e,n){var r=e.IsHighlight;return(0,$.jsxs)(S.View,{className:"BookingLimitMaskLine",children:[(0,$.jsx)(S.View,{className:"BookingLimitMaskIcon",children:"\ue167"}),(0,$.jsx)(S.View,{className:r?"BookingLimitMaskTextHighlight":"BookingLimitMaskText",children:(0,$.jsx)("mp-html",{content:e.Detail,copyLink:!1,onLinktap:function(e){e&&e.detail&&e.detail.href&&t.jumpH5({url:e.detail.href})}})})]},n)}))}),(0,$.jsxs)(S.View,{className:"BookingLimitMaskLine",children:[(0,$.jsx)(S.View,{className:"BookingLimitMaskIcon",children:"\ue167"}),(0,$.jsx)(S.View,{className:"BookingLimitMaskText",children:"\u4ee5\u4e0a\u4ef7\u683c\u5747\u4e3a\u4eba\u5747\u4ef7"})]})]}),"sdp"===P&&!f&&!g&&(0,$.jsxs)(S.View,{className:"BookingLimitMaskLine",children:[(0,$.jsx)(S.View,{className:"BookingLimitMaskIcon",children:"\ue167"}),(0,$.jsxs)(S.View,{className:"BookingLimitMaskText",children:["\u8be5\u4ea7\u54c1\u6700\u5c11",u,"\u4eba\u8d77\u8ba2\uff0c\u6210\u4eba+\u513f\u7ae5+\u5a74\u513f\u6700\u591a\u652f\u6301",d,"\u4eba"]})]}),"sdp"===P&&!f&&g&&(0,$.jsxs)(S.View,{className:"BookingLimitMaskLine",children:[(0,$.jsx)(S.View,{className:"BookingLimitMaskIcon",children:"\ue167"}),(0,$.jsxs)(S.View,{className:"BookingLimitMaskText",children:["\u8be5\u4ea7\u54c1\u6700\u5c11",u,"\u4eba\u8d77\u8ba2\uff0c\u6210\u4eba+\u513f\u7ae5\u6700\u591a\u652f\u6301",d,"\u4eba\uff0c\u4e14\u603b\u4eba\u6570\u6700\u591a9\u4eba"]})]}),"sdp"===P&&!!f&&(0,$.jsxs)(S.View,{className:"BookingLimitMaskLine",children:[(0,$.jsx)(S.View,{className:"BookingLimitMaskIcon",children:"\ue167"}),(0,$.jsxs)(S.View,{className:"BookingLimitMaskText",children:["\u8be5\u4ea7\u54c1\u6700\u5c11",u,"\u4eba\u8d77\u8ba2\uff0c\u8be5\u4ea7\u54c1\u6210\u4eba+\u513f\u7ae5\u6700\u591a",d,"\u4eba\u4e14\u5a74\u513f\u6700\u591a4\u540d"]})]}),"sdp"===P&&g&&(0,$.jsxs)(S.View,{className:"BookingLimitMaskLine",children:[(0,$.jsx)(S.View,{className:"BookingLimitMaskIcon",children:"\ue167"}),(0,$.jsx)(S.View,{className:"BookingLimitMaskText",children:"\u706b\u8f66\u7968\u8d2d\u4e70\uff1a\u4e00\u540d\u6210\u5e74\u4eba\u65c5\u5ba2\u53ef\u4ee5\u514d\u8d39\u643a\u5e26\u4e00\u540d\u8eab\u9ad8\u4e0d\u8db31.2\u7c73\u7684\u513f\u7ae5\uff08\u542b\u5a74\u513f\uff09\uff1b1.2~1.5\u7c73\u7684\u513f\u7ae5\u51fa\u51fa\u513f\u7ae5\u7968\uff1b\u8d85\u8fc71.5\u7c73\u7684\u513f\u7ae5\u51fa\u5168\u4ef7\u5750\u7968\u3002"})]}),"sdp"===P&&I&&(0,$.jsxs)(S.View,{className:"BookingLimitMaskLine",children:[(0,$.jsx)(S.View,{className:"BookingLimitMaskIcon",children:"\ue167"}),(0,$.jsx)(S.View,{className:"BookingLimitMaskText",children:"12\u5468\u5c81\u53ca\u4ee5\u4e0a\u7684\u513f\u7ae5\u89c6\u4f5c\u6210\u4eba\u67e5\u8be2\u673a\u7968\uff0c\u4ee5\u6210\u4eba\u4ef7\u8ba1\u4ef7\uff1b\u51fa\u884c\u5f53\u65e5\u672a\u6ee114\u5929\u7684\u5a74\u513f\u9700\u81f3\u822a\u7a7a\u516c\u53f8\u552e\u7968\u5904\u7533\u8bf7\u8d2d\u4e70\u673a\u7968\u3002"})]}),"sdp"===P&&h&&(0,$.jsxs)(S.View,{className:"BookingLimitMaskLine",children:[(0,$.jsx)(S.View,{className:"BookingLimitMaskIcon",children:"\ue167"}),(0,$.jsx)(S.View,{className:"BookingLimitMaskText",children:"\u513f\u7ae5/\u5a74\u513f\u5165\u4f4f\u9075\u5faa\u9152\u5e97\u653f\u7b56\u3002"})]}),"sdp"===P&&(0,$.jsx)(S.View,{children:Un.map((function(e,n){return(0,$.jsxs)(S.View,{className:"BookingLimitMaskLine",children:[(0,$.jsx)(S.View,{className:"BookingLimitMaskIcon",children:"\ue167 "}),(0,$.jsx)(S.View,{className:"BookingLimitMaskText",children:(0,$.jsx)("mp-html",{content:e.description,copyLink:!1,onLinktap:function(e){e&&e.detail&&e.detail.href&&t.jumpH5({url:e.detail.href})}})})]},n)}))})]})})}function Gn(){var e=Y.useActions().handlers.handleTogglePreSaleNoticeMask,t=Y.useState(),n=t.isShowPreSaleNoticeMask,r=t.PreSaleNoticeMaskSelectType,i=t.currentRouteInfo,a=i.PreSaleNotice;return a?(0,$.jsx)(I.PresaleNotice,{notice:a,type:r,isShow:n,onClose:function(){e({status:!1,selectType:""})}}):null}function Hn(){var e=Y.useState((function(e){var t=e.isShowGODetailMask;return{isShowGODetailMask:t}})),t=e.isShowGODetailMask,n=Y.useActions().handlers.handleToggleGODetailMask;return t?(0,$.jsx)(Ot.Z,{title:"\u8bf4\u660e",handleClose:function(){n(!1)},children:(0,$.jsx)(S.View,{className:"PopMaskContainer MarginX32",children:(0,$.jsx)(S.View,{children:"T\u961f\uff08Trip Pal\uff09\u662f\u9762\u5411\u5e74\u8f7b\u4eba\u65c5\u884c\u7684\u300e\u7ed3\u4f34\u6e38\u300f\u4e13\u5c5e\u9886\u961f\uff0c\u4ed6\u4eec\u6027\u683c\u6d3b\u6cfc\uff0c\u719f\u6089\u5f53\u5730\u5403\u559d\u73a9\u4e50\uff0c\u5404\u6000\u6240\u957f\uff0c\u662f\u5e26\u7740\u4f60\u73a9\u7684\u9760\u8c31\u73a9\u4f34\uff0c\u662f\u56e2\u961f\u6c14\u6c1b\u7684\u7ec4\u7ec7\u8005\u3002"})})}):null}function Kn(){var e=Y.useState((function(e){var t=e.BasicInfo;return{BasicInfo:t}})),t=e.BasicInfo,n=t.isPureDiyfhxsdp,r=De.Z.getEnv();"prd"===r&&(r="prod");var i={channel:n?"vacations-diy":"vacations-grp",env:r,queryId:t.ProductId,scene:n?"SINGLE_PRODUCT_QUERY":"PRODUCT_QUERY",isFillet:!1,jump:function(e){var t={url:encodeURIComponent(e),pageTitle:{color:{backgroundColor:"#ffffff",frontColor:"#000000"}}};X().navigateTo({url:"/cwx/component/cwebview/cwebview?data="+JSON.stringify(t)})}};return(0,$.jsx)(S.View,{className:"ModuleBoxWithoutPadding",id:"Taro_Scroll_To_Offset",children:(0,$.jsx)(I.SimpleCommentBar,(0,c.Z)((0,c.Z)({},i),{},{isPlaceholder:!0}))})}function zn(){var e=Y.useState((function(e){var t=e.isPremium,n=e.BasicInfo,r=e.currentRouteInfo,i=e.ABTestResult,a=e.CruisesBaseInfo,o=e.productRanking,s=e.isIOS;return{isPremium:t,BasicInfo:n,currentRouteInfo:r,ABTestResult:i,CruisesBaseInfo:a,productRanking:o,isIOS:s}})),t=(e.isPremium,e.BasicInfo),n=e.currentRouteInfo,r=e.ABTestResult,i=(e.CruisesBaseInfo,e.productRanking),a=(e.isIOS,n.TagGroupInfo),o=t.isPureDiyfhxsdp,s=(t.isCruise,i&&i.rankingDesc),c=!0,l=a.SpecialTagList||[],u=a.MoreTagList||[],d=a.NewPromotionTagList||[],f=a.TravelServiceTagList||[];o||(u=[]),u.length||l.length||d.length||f.length||(c=!1);r&&r["220808_VAC_xqtlb"]&&r["220808_VAC_xqtlb"];var p=s||c,m=De.Z.getEnv();return"prd"===m&&(m="prod"),(0,$.jsxs)(S.View,{className:"sellingPointWithCommentBox",children:[(0,$.jsxs)(S.View,{className:"sellingPointSubBox",children:[(0,$.jsx)(Wn,{}),!!p&&(0,$.jsx)(qn,{})]}),(0,$.jsx)(S.View,{style:{marginTop:-7},children:(0,$.jsx)(Kn,{})})]})}function Wn(){var e=Y.useState((function(e){var t=e.currentRouteInfo,n=e.BasicInfo,r=e.isIOS;return{currentRouteInfo:t,BasicInfo:n,isIOS:r}})),t=e.currentRouteInfo,n=e.BasicInfo,r=(e.isIOS,Y.useActions().handlers.handleTraceLog),i=(0,g.useState)(!1),a=(0,h.Z)(i,2),o=a[0],s=a[1],c=(0,g.useState)(!1),l=(0,h.Z)(c,2),u=l[0],d=l[1],f=null===t||void 0===t?void 0:t.SubName;(0,g.useEffect)((function(){d(!1),s(!1),x().nextTick((function(){var e=x().createSelectorQuery().select("#SellingPointRef");e&&e.boundingClientRect((function(e){(null===e||void 0===e?void 0:e.height)>65&&d(!0)})).exec()}))}),[f]);var p=function(e){s(e)};return n.isStudy||!f?null:(f="         "+f.replace(/\n/g," "),(0,$.jsxs)(S.View,{children:[(0,$.jsx)(S.Image,{className:"sellingPointIcon",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/bigpic/sellingpoint_icon.png"}),o?(0,$.jsxs)(S.View,{className:"titleContainer",children:[(0,$.jsx)(S.Text,{className:"subNameTextColor",children:f}),(0,$.jsxs)(S.View,{className:"expandStatus",onClick:function(){p(!o)},children:[(0,$.jsx)(S.Text,{style:{color:"rgb(17,17,17)",fontSize:13},children:"\u6536\u8d77"}),(0,$.jsx)(S.Text,{className:"detailIconExpand",children:"\ue946"})]})]}):(0,$.jsx)(S.View,{className:"detaiDiscountTextNew",children:(0,$.jsxs)(S.View,{children:[(0,$.jsx)(S.Text,{className:"subtitleText",children:f}),u&&(0,$.jsxs)(S.View,{className:"iconContainer",onClick:function(){p(!o),r("grp_prddtl_subtitle_spread_trace")},children:[(0,$.jsx)(S.View,{className:"expandLeftLinear"}),(0,$.jsx)(S.View,{style:{backgroundColor:"rgba(255,255,255,1)",width:6,height:20}}),(0,$.jsxs)(S.View,{className:"expandTextDesc",children:[(0,$.jsx)(S.Text,{style:{color:"rgb(17,17,17)",fontSize:13},children:"\u5c55\u5f00"}),(0,$.jsx)(S.Text,{className:"detailIconExpand",children:"\ue945"})]})]})]})}),(0,$.jsx)(S.View,{id:"SellingPointRef",className:"SubNameAllText",children:(0,$.jsx)(S.Text,{className:"subtitleText2",style:{display:"flex"},children:f})})]}))}function qn(){return(0,$.jsxs)(S.View,{className:"ProfileTagLineBigPic",children:[(0,$.jsx)($n,{}),(0,$.jsx)(Yn,{})]})}function Yn(){var e=Y.useState((function(e){return e.BasicInfo})),t=Y.useState((function(e){return e.currentRouteInfo})),n=Y.useActions().handlers,r=(n.handleGoSearchTag,n.handleToggleThemeDifficultyMask),i=n.handleTraceLog,a=t.TagGroupInfo,o=e.isPureDiyfhxsdp,s=a.MarketingTagList||[],c=a.SpecialTagList||[],l=a.MoreTagList||[],u=a.NewPromotionTagList||[],d=a.TravelServiceTagList||[];if(o||(l=[]),!s.length&&!l.length&&!c.length&&!u.length&&!d.length)return null;var f=c.some((function(e){return[2103,2104,2105,2106,2107].includes(e.TagId)})),p=null,m=[].concat((0,y.Z)(c.slice()),(0,y.Z)(d.slice()));return f&&(p=c.find((function(e){return[2103,2104,2105,2106,2107].includes(e.TagId)})),p&&(m=c.filter((function(e){return e.TagId!==p.TagId})))),(0,$.jsxs)($.Fragment,{children:[!!p&&(0,$.jsxs)(S.View,{className:"detailLabelTheme",onClick:function(){r(!0)},children:[(0,$.jsx)(S.Text,{style:{fontSize:11,color:"#fff"},children:p.TagName}),(0,$.jsx)(S.View,{className:"detailThemeIcon"})]}),u.concat(m).map((function(t,n){var r=t.TagName,a=t.TagDisplayName;return(0,$.jsx)(S.View,{className:"ProfileTagGrayBigPic",onClick:function(){i("grp_xqtlb_trace",{pttype:e.ProductPatternId,tag:r})},children:(0,$.jsx)(S.Text,{style:{color:"rgba(0,0,0,0.7)",fontSize:11},children:a||r})},n)}))]})}function $n(){var e=Y.useState((function(e){return e.BasicInfo})),t=Y.useState((function(e){return e.productRanking})),n=Y.useActions().handlers,r=n.handleGoTopList,i=n.handleTraceLog;if(![9,26].includes(e.ProductCategoryId))return null;if(!t||!t.rankingDesc)return null;var a=t.rankingDesc,o=t.jumpUrl,s=o&&o.h5Url,c=null===o||void 0===o?void 0:o.h5Url,l={pkgid:e.ProductId,pttype:e.ProductPatternId,dest_id:e.DestCityId,toplistname:a};return(0,$.jsx)(S.View,{onClick:function(){s&&r(c),i("grp_bangdan_trace",l)},className:"detailRankingBoxBigPic",children:(0,$.jsxs)(S.View,{className:"detailLabelRankingBigPic",children:[(0,$.jsx)(S.Text,{style:{color:"rgb(168,112,64)",fontSize:10},children:a}),!!s&&c&&(0,$.jsx)(S.Text,{className:"jumpRankingIcon",children:"\ue944"})]})})}function Jn(){return(0,$.jsxs)(S.View,{className:"bannerContainer",children:[(0,$.jsx)(Qn,{}),(0,$.jsx)(Xn,{}),(0,$.jsx)(tr,{})]})}function Qn(){var e=Y.useState((function(e){return e.emotionalCues})),t=(e&&e.riskCityPolicy&&e.riskCityPolicy.riskType,Y.useActions().handlers),n=t.handleToggleUrgentMask,r=t.handleTraceLog,i=!1;if(e&&e.urgentInfo&&e.urgentInfo.length&&(i=!0),e&&e.riskCityPolicy){var a=e.riskCityPolicy,o=a.startCityPolicy,s=a.endCityPolicy,c=a.startCityRevPolicy,l=a.endCityRevPolicy;(o||s||c||l)&&(i=!0)}return i?(0,$.jsxs)(S.View,{className:"ProfileServiceTagBoxPeerBigPic",onClick:function(){n(!0),r("grp_prddtl_notice_click",{type:"\u516c\u5171\u516c\u544a"})},children:[(0,$.jsx)(S.Text,{className:"noticeText",children:"\u516c\u544a"}),(0,$.jsxs)(S.View,{className:"ProfileServiceTagUrgentInfo",children:[(0,$.jsx)(S.Text,{style:{fontSize:13,color:"#666",marginRight:20},children:"\u51fa\u884c\u653f\u7b56\u63d0\u9192"}),(0,$.jsx)(S.View,{className:"UrgentInfoIcon",children:(0,$.jsx)(S.Text,{style:{fontSize:14,color:"#999"},className:"baseIcon",children:"\ue944"})})]})]}):null}function Xn(){var e=Y.useState((function(e){return e.currentRouteInfo})),t=Y.useState((function(e){return e.BasicInfo})),n=(Y.useState((function(e){return e.actionIdSuffix})),Y.useActions().handlers),r=n.handleToggleServiceTagMask,i=n.handleGoSecurityInfo,a=e||{},o=a.TagGroupInfo,s=t.isDiyfhxsdp;if(s){var c=er(t,o.MoreTagList);return(0,$.jsxs)(S.View,{className:"ProfileServiceTagBoxPeerBigPicSdp",onClick:function(){i()},children:[(0,$.jsx)(S.Text,{className:"noticeText",children:"\u670d\u52a1"}),(0,$.jsx)(S.View,{className:"ProfileServiceTagCenterBigPic",children:c.map((function(e,t){return 0===t?(0,$.jsxs)(S.View,{className:"ProfileServiceTagItemBigPic",children:[(0,$.jsx)(S.Image,{className:"ProfileSecureIconBigPicSdp",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/securetravel.png"}),(0,$.jsx)(S.View,{className:"ProfileServiceTagItemBigPic",children:(0,$.jsxs)(S.Text,{style:{color:"#0dba0d",fontSize:12},children:[e,"\uff1a"]})})]},t):(0,$.jsx)(g.Fragment,{children:(0,$.jsx)(S.View,{className:"ProfileServiceTagItemBigPicRe",children:(0,$.jsx)(S.View,{className:"ProfileServiceTagItemBigPic",children:(0,$.jsxs)(S.Text,{style:{color:"#0dba0d",fontSize:12},children:[1===t?"":"\xb7",e]})})})},t)}))}),(0,$.jsx)(S.View,{className:"ProfileServiceTagItemBigPic",children:(0,$.jsx)(S.Text,{style:{fontSize:14,color:"#999"},className:"baseIcon",children:"\ue944"})})]})}if(!o||!o.MoreTagList||0===o.MoreTagList.length)return null;var l=o.MoreTagList.slice(),u=l.some((function(e){return[2147,1747].includes(e.TagId)}))&&l.find((function(e){return 2154===e.TagId}));return(0,$.jsxs)(S.View,{className:"ProfileServiceTagBoxPeerBigPicProm",onClick:function(){r(!0)},children:[(0,$.jsx)(S.Text,{className:"noticeText",children:"\u670d\u52a1"}),(0,$.jsxs)(S.View,{className:"ProfileServiceTagCenterLineUrgentBigPic",children:[(0,$.jsxs)(S.View,{className:"ProfileServiceTagItemBigPic",children:[(0,$.jsx)(S.Image,{className:"ProfileSecureIconContainigPic",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/securetravel.png"}),u&&(0,$.jsx)(S.Image,{className:"ProfileAXDIconBigPic",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/axd_wyx.png"})]}),(0,$.jsx)(S.View,{className:"contextContainer",children:l.map((function(e,t){var n=e.TagName,r=e.TagDisplayName;return(0,$.jsxs)(S.Text,{style:{fontSize:12,color:u?"#666":"#0dba0d"},children:[0===t?"":"\xb7",r||n]},t)}))})]}),(0,$.jsx)(S.View,{className:"ProfileServiceTagItemBigPic",children:(0,$.jsx)(S.Text,{style:{fontSize:14,color:"#999"},className:"baseIcon",children:"\ue944"})})]})}function er(e,t){e.isPureDiyfhxsdp;var n=e.isDiyfhxsdp,r=e.IsHkMcTw,i=e.IsInternal,a=[];if(n){var o=!r&&!i;a=o?["\u62d2\u7b7e\u65e0\u5fe7","\u51fa\u884c\u4fdd\u969c"]:["\u822a\u53d8\u65e0\u5fe7","\u51fa\u884c\u4fdd\u969c"],a.unshift("\u653e\u5fc3\u6e38")}else t.slice().forEach((function(e){var t=e.TagName;a.push(t)}));return a}function tr(){var e=Y.useState((function(e){var t=e.currentRouteInfo,n=e.pageStatus,r=e.pageId;return{currentRouteInfo:t,pageStatus:n,pageId:r}})),t=e.currentRouteInfo,n=e.pageStatus,r=e.pageId,i=Y.useActions().handlers,a=i.handleTogglePromotionMask,o=(i.handleTraceLog,Y.useActions()),s=o.UPDATE_COUPON_COMPONENT_DATA,c=n.activeProductId;(0,g.useEffect)((function(){dr({pageId:r,activeProductId:c,UPDATE_COUPON_COMPONENT_DATA:s})}),[c]);var l=ur(),u=l?"".concat(l,"\u9879\u4f18\u60e0"):"\u5168\u90e8\u4f18\u60e0",d=t.CouponInfo,f=d&&d.availableClaimList&&d.availableClaimList.length>0;return(0,$.jsxs)(S.View,{className:"PromotionBannerBoxBigPic",onClick:function(){a(!0)},children:[(0,$.jsx)(S.Text,{className:"PromotionText",children:"\u4f18\u60e0"}),(0,$.jsxs)(S.View,{className:"PromotionBannerListBigPic",children:[(0,$.jsx)(nr,{}),(0,$.jsx)(rr,{}),(0,$.jsx)(ir,{}),(0,$.jsx)(ar,{}),(0,$.jsx)(or,{}),(0,$.jsx)(sr,{}),(0,$.jsx)(cr,{}),(0,$.jsx)(lr,{})]}),(0,$.jsxs)(S.View,{className:"PromotionBannerBoxBigPic",children:[(0,$.jsx)(S.Text,{className:"NewBannerDiscountsCount",children:f?"\u53bb\u9886\u5238":u}),(0,$.jsx)(S.Text,{className:"NewBannerItemIconText",children:"\ue944"})]})]})}function nr(){var e=Y.useState((function(e){var t=e.userInformation;return{userInformation:t}})),t=e.userInformation;if(!t||!t.levelMember)return null;var n=t.levelMember,r=n.levelCode,i=n.tags;if(!i||!i.length)return null;var a=["LEVELMEMBER_PRICE","LEVELMEMBER_DEFAULT"],o=i.find((function(e){return a.includes(e.key)}));if(!o||!o.value)return null;var s="https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/detail/bigpic/",c={"\u9ed1\u94bb":s+"black_diamond.png","\u94c2\u91d1":s+"Platinum.png","\u91d1\u94bb":s+"gold_diamond.png","\u94bb\u77f3":s+"diamond.png"},l=c[o.value.substr(0,2)],u={0:"#0086f6",5:"#4274bc",10:"#B3802D",20:"rgb(21,123,157)",30:"rgb(70,82,144)",35:"rgb(39,57,111)",40:"#ead6b1"},d={0:["#E5F4FF","#E5F4FF"],5:["#e6f0ff","#e6f0ff"],10:["#FFFAF2","#FFFAF2"],20:["rgb(255, 255, 255)","rgb(255, 255, 255)"],30:["rgb(255, 255, 255)","rgb(255, 255, 255)"],35:["rgb(255, 255, 255)","rgb(255, 255, 255)"],40:["rgb(102, 102, 102)","rgb(51, 51, 51)"]},f=d[r]||["#E5F4FF","#E5F4FF"],p=(0,h.Z)(f,2),m=p[0],I=p[1];return(0,$.jsxs)(S.View,{style:{borderColor:u[r],backgroundImage:"linear-gradient(to right bottom, ".concat(m," 25%, ").concat(I," 75%)")},className:"PromotionBannerMemberTagBigPic",children:[!!l&&(0,$.jsx)(S.Image,{className:"levelMemberIcon",src:l}),(0,$.jsxs)(S.Text,{style:{fontSize:11,color:u[r]},children:["\xa0",o.value,"\xa0"]})]})}function rr(){var e=Y.useState((function(e){var t=e.userInformation;return{userInformation:t}})),t=e.userInformation;if(!t||!t.crossMember)return null;var n=t.crossMember,r=n.tags;if(!r||!r.length)return null;var i=["FLIGHTMEMBER_PRICE"],a=r.find((function(e){return i.includes(e.key)}));return a&&a.value?(0,$.jsx)(S.View,{style:{background:"#f2f8fe"},className:"PromotionBannerMemberTagBigPic",children:(0,$.jsxs)(S.Text,{style:{fontSize:11,color:"#0086F6"},children:["\xa0",a.value,"\xa0"]})}):null}function ir(){var e=Y.useState((function(e){var t=e.userInformation;return{userInformation:t}})),t=e.userInformation;if(!t||!t.superMember)return null;var n=t.superMember,r=n.tags;if(!r||!r.length)return null;var i=["SUPERMEMBER_DEFAULT"],a=r.find((function(e){return i.includes(e.key)}));return a&&a.value?(0,$.jsx)(S.View,{style:{background:"#ffefe1",borderColor:"#7b3e29"},className:"PromotionBannerMemberTagBigPic",children:(0,$.jsxs)(S.Text,{style:{fontSize:11,color:"#7b3e29"},children:["\xa0",a.value,"\xa0"]})}):null}function ar(){var e=Y.useState((function(e){var t=e.specialTag;return{specialTag:t}})),t=e.specialTag;if(!t)return null;var n=t.TagName;return(0,$.jsx)(S.View,{className:"PromotionBannerItemBigPic",children:(0,$.jsx)(S.Text,{style:{fontSize:11,color:"#FF6600"},children:n})})}function or(){var e=Y.useState((function(e){var t=e.BasicInfo,n=e.currentRouteInfo;return{BasicInfo:t,currentRouteInfo:n}})),t=(e.BasicInfo,e.currentRouteInfo),n=t.CouponInfo;if(!n)return null;var r=n.availableClaimList,i=n.availableUseList,a=n.singkekList,o=n.receivedNouseList;r=r||[],i=i||[],a=a||[],o=o||[];var s=[].concat((0,y.Z)(r),(0,y.Z)(a),(0,y.Z)(i),(0,y.Z)(o));return s&&s.length?(0,$.jsx)($.Fragment,{children:s.map((function(e,t){var n=e.promotionLabel;return(0,$.jsx)(S.View,{className:"PromotionBannerItemBigPic",children:(0,$.jsx)(S.Text,{style:{fontSize:11,color:"#FF6600"},children:n})})}))}):null}function sr(){var e=Y.useState((function(e){var t=e.BasicInfo,n=e.promotionDisplayInfo;return{BasicInfo:t,promotionDisplayInfo:n}})),t=e.BasicInfo,n=e.promotionDisplayInfo,r=t.isCruise;if(r)return null;if(!n||!n.creditInfo)return null;var i=n.creditInfo.PromotionWords;return i?(0,$.jsx)(S.View,{className:"PromotionBannerItemBigPic",children:(0,$.jsx)(S.Text,{style:{fontSize:11,color:"#FF6600"},children:"\u62ff\u53bb\u82b1\u5206\u671f"})}):null}function cr(){var e=Y.useState((function(e){var t=e.compositeCoupon;return{compositeCoupon:t}})),t=e.compositeCoupon;if(!t)return null;var n=t.promotionList,r=t.promotionCount;return r?(0,$.jsx)($.Fragment,{children:n.map((function(e,t){e.title;var n=e.tag;return n?(0,$.jsx)(S.View,{className:"PromotionBannerItemBigPic",children:(0,$.jsx)(S.Text,{style:{fontSize:11,color:"#FF6600"},children:n})},t):null}))}):null}function lr(){var e=Y.useState((function(e){var t=e.userInformation;return{userInformation:t}})),t=e.userInformation;if(!t||!t.levelMember)return null;var n=t.levelMember,r=n.tags;if(!r||!r.length)return null;var i=["LEVELMEMBER_BONUS"],a=r.find((function(e){return i.includes(e.key)}));return a&&a.value?(0,$.jsx)(S.View,{className:"PromotionBannerItemBigPic",children:(0,$.jsx)(S.Text,{style:{fontSize:11,color:"#FF6600"},children:a.value})}):null}var ur=function(){var e=Y.useState((function(e){var t=e.userInformation,n=e.compositeCoupon,r=e.promotionDisplayInfo;return{userInformation:t,compositeCoupon:n,promotionDisplayInfo:r}})),t=e.userInformation,n=e.compositeCoupon,r=e.promotionDisplayInfo,i=0;if(t){var a=t.levelMember,o=t.crossMember,s=t.superMember,c=[a,o,s].some((function(e){if(e){var t=e.tags;if(t&&t.length){var n=["LEVELMEMBER_PRICE","LEVELMEMBER_DEFAULT","FLIGHTMEMBER_PRICE","SUPERMEMBER_DEFAULT"];if(t.find((function(e){return n.includes(e.key)})))return!0}}return!1}));c&&(i+=1)}if(n&&n.promotionCount&&(i+=n.promotionCount),r&&r.creditInfo){var l=r.creditInfo.PromotionWords;l&&(i+=1)}return i};function dr(e){var t=e.pageId,n=e.activeProductId,r=e.UPDATE_COUPON_COMPONENT_DATA,i=X().mkt.getUnion(),a=i.allianceid,o=i.sid,s=De.Z.getEnv();"prd"===s&&(s="prod");var c={env:s,ctType:0,clientType:3,source:"TOUR",saleChannel:117,allianceId:a,siteId:o,clientId:X().clientID,pageId:t,locale:"zh-CN",currency:"CNY",productId:n};(0,I.fetchClaimCouponList)(c).then((function(e){console.log("---fetchClaimCouponList---",e),r(e)}))}function fr(e){var t=e.controller,n=Y.useState((function(e){var t=e.query,n=e.BasicInfo,r=e.pageStatus,i=e.currentRouteInfo,a=e.isShowCalendarPop,o=e.isShowPresaleCalendarPop,s=e.isLogin,c=e.CalendarSelectedDate,l=e.pageId,u=e.PageUrl,d=e.newProcessSelectDate,f=e.groupCard,p=e.isPreSale,m=e.TourGroupInfo,I=e.refreshSelectDateFlag,h=e.scheduleDisableDates,g=i||{},v=g.PriceInfo,x=g.BookInfo;return{query:t,BasicInfo:n,pageStatus:r,PriceInfo:v,isShowCalendarPop:a,isShowPresaleCalendarPop:o,isLogin:s,CalendarSelectedDate:c,BookInfo:x,pageId:l,PageUrl:u,newProcessSelectDate:d,groupCard:f,isPreSale:p,TourGroupInfo:m,refreshSelectDateFlag:I,scheduleDisableDates:h}})),r=n.query,i=n.BasicInfo,a=n.pageStatus,l=n.PriceInfo,u=n.isShowCalendarPop,d=n.isShowPresaleCalendarPop,f=(n.isLogin,n.CalendarSelectedDate,n.BookInfo),p=n.pageId,m=n.PageUrl,T=n.newProcessSelectDate,P=n.groupCard,y=n.isPreSale,w=n.TourGroupInfo,C=n.refreshSelectDateFlag,N=n.scheduleDisableDates,D=Y.useActions().handlers,j=D.handleToggleCalendarPop,_=D.handleTogglePresaleCalendarPop,b=D.handleSetNewProcessCacheDate,k=D.handleSelectNewProcessDate,L=D.handleCheckPreSaleDateCache,B=D.handleMultiTravelChange,R=D.handleMultiLineChange,M=D.handleTraceLog,E=Y.useActions(),V=E.sendPV,A=E.SET_PRICECALENDAR_DATA_H5,Z=E.checkNewProcessSelectedDateAvailable,O=(0,g.useRef)(null),U=(0,g.useRef)(null),F=(0,v.getSystemInfoSync)(),G=(F.windowHeight,F.screenHeight),H=(F.safeArea,De.Z.isIphoneX(),(0,g.useState)(!1)),K=(0,h.Z)(H,2),z=K[0],W=K[1];(0,g.useEffect)((function(){i&&setTimeout((function(){W(!0)}),200)}),[i]),(0,v.useDidShow)((function(){V({pageId:p,url:m}),b(!0)})),(0,g.useEffect)((function(){i&&x().setNavigationBarTitle({title:null===i||void 0===i?void 0:i.Title})}),[null===i||void 0===i?void 0:i.Title]),(0,g.useEffect)((function(){t.onShareAppMessage=i?function(){var e=(0,c.Z)((0,c.Z)({},r),{},{departcityid:i.DepartureId}),t="/pages/vacations/detail/index?".concat(I.querystring.stringify(e));return{path:t,title:i?i.Title:"\u65c5\u6e38",imageUrl:"".concat(nn.I,"/tour/service/getShareImg?productId=").concat(i.ProductId,"&price=").concat(l.MinPrice)}}:function(){var e="/pages/vacations/detail/index?".concat(I.querystring.stringify(r));return{path:e,title:"\u65c5\u6e38"}}}),[i]);var q=(0,g.useRef)(!1);(0,g.useEffect)((function(){O.current&&a.activeProductId&&O.current.initCalendar({productId:a.activeProductId,alias:a.isMultiTravel?a.activeAlias:"",departCityId:i.DepartureId}).then((function(e){console.log("\u65e5\u5386\u7ec4\u4ef6\u56de\u8c03\u6570\u636e",e);var t=e.flatDailyMinPrice;t?(A(e),Z(),q.current||(b(),q.current=!0)):L()}))}),[O.current,a,i]),(0,g.useEffect)((function(){console.log("\u91cd\u65b0\u521d\u59cb\u5316\u65e5\u5386"),C&&N&&O.current&&a.activeProductId&&O.current.initCalendar({productId:a.activeProductId,alias:a.isMultiTravel?a.activeAlias:"",departCityId:i.DepartureId,disableDates:N}).then((function(){}))}),[C,N]),(0,g.useEffect)((function(){if(U.current&&a.activeProductId){var e,t=a.activeProductId,n=a.activeAlias;if(P&&P.cards&&P.cards.length){var r=P.cards.find((function(e){return e.productId===t}));y&&r&&r.preSaleProductInfo&&r.preSaleProductInfo.canBook&&(e=r.preSaleProductInfo.productId)}e&&(null===U||void 0===U||U.current.initCalendar({productId:e,alias:n,departCityId:i.DepartureId}))}}),[U.current,a,i,P]);var Q=(0,g.useCallback)(function(){var e=(0,s.Z)((0,o.Z)().mark((function e(n){var r,s,c,l,u,d,f,p,m,I,h,g;return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a.activeProductId,a.activeAlias,r=a.isMultiTravel,s=n.date,c=n.displayPrice,l=n.price,u=n.originalPriceInfo,d=n.productId,f=n.alias,!r){e.next=10;break}return k(s,c),e.next=6,B(f);case 6:p=e.sent,p&&f&&t.showToast("\u5df2\u4e3a\u60a8\u5207\u6362\u81f3".concat(f,"\u7ebf")),e.next=17;break;case 10:return k(s,c),I=null===w||void 0===w||null===(m=w.TourGroupProductInfo)||void 0===m?void 0:m.find((function(e){return e.ProductId===d})),h=["A","B","C","D","E","F","G","H","I","J"][(null===I||void 0===I?void 0:I.SortNumber)-1],e.next=15,R(d);case 15:g=e.sent,g&&h&&t.showToast("\u5df2\u4e3a\u60a8\u5207\u6362\u81f3".concat(h,"\u7ebf"));case 17:M("grp_prddtl_cldr_date_click",{lead_time:s,price:l,displayprice:c,originprice:null===u||void 0===u?void 0:u.originalPrice,productid:d,departcityid:i.DepartureId});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[a,w]),X=(0,g.useState)(!1),ee=(0,h.Z)(X,2),ne=ee[0],re=ee[1];return i?f&&!f.IsActive?(0,$.jsx)(on,{}):(0,$.jsxs)(g.Fragment,{children:[(0,$.jsxs)(S.View,{className:"Layout",onClick:function(){re(!1)},children:[(0,$.jsx)(un,{setIsShowMeanu:re,isShowMenu:ne}),(0,$.jsx)(S.View,{children:(0,$.jsx)(J,{})}),(0,$.jsxs)(S.View,{children:[(0,$.jsx)(te,{isShowHeavyData:z}),(0,$.jsx)(zn,{}),(0,$.jsx)(Jn,{}),(0,$.jsx)(pe,{}),(0,$.jsx)(ke,{}),(0,$.jsx)(hn,{}),z&&(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(Ye,{}),(0,$.jsx)(Ht,{}),(0,$.jsx)(S.View,{children:(0,$.jsx)(xt,{})}),(0,$.jsx)(ct,{}),(0,$.jsx)(sn,{}),(0,$.jsx)(Qe,{}),(0,$.jsx)(tt,{}),(0,$.jsx)(Kt,{}),(0,$.jsx)(Nt,{}),(0,$.jsx)(_t,{})]}),(0,$.jsx)(Zt,{})]}),(0,$.jsx)(kt,{selectDateFn:O}),(0,$.jsx)(S.View,{children:(0,$.jsx)(zt,{})}),(0,$.jsx)(S.View,{children:(0,$.jsx)(Gt,{})}),(0,$.jsx)(S.View,{children:(0,$.jsx)(Ft,{})}),(0,$.jsx)(S.View,{children:(0,$.jsx)(_n,{})}),(0,$.jsx)(S.View,{children:(0,$.jsx)(Jt,{})}),(0,$.jsx)(S.View,{children:(0,$.jsx)(tn,{})}),(0,$.jsx)(S.View,{children:(0,$.jsx)(rn,{})}),(0,$.jsx)(S.View,{children:(0,$.jsx)(an,{})}),(0,$.jsx)(S.View,{children:(0,$.jsx)(cn,{})}),(0,$.jsx)(S.View,{children:(0,$.jsx)(Fn,{controller:t})}),(0,$.jsx)(S.View,{children:(0,$.jsx)(Hn,{})})]}),(0,$.jsx)(S.View,{children:(0,$.jsx)(Gn,{})}),(0,$.jsx)(S.View,{children:(0,$.jsx)(Qt,{})}),(0,$.jsx)(S.View,{children:(0,$.jsx)(I.SelectDate,{pageName:"detail",selectedDate:T,isShow:u,onClose:function(){return j(!1)},onSelect:Q,onRef:function(e){return O.current=e},logger:!0})}),(0,$.jsx)(S.View,{children:(0,$.jsx)(I.SelectDate,{pageName:"presale_detail",isShow:d,onClose:function(){return _(!1)},onRef:function(e){return U.current=e},logger:!0})})]}):(0,$.jsx)(S.Image,{mode:"widthFix",style:{width:"100%"},src:en})}var pr,mr,Ir=n(85198),hr=(pr=(0,I.PureModel)({Model:Y}),pr(mr=function(e){(0,f.Z)(n,e);var t=(0,p.Z)(n);function n(){var e;(0,l.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),(0,m.Z)((0,d.Z)(e),"pageId","ignore_page_pv"),(0,m.Z)((0,d.Z)(e),I.MODEL_CONTEXT,(0,c.Z)((0,c.Z)({},A.p.impl((0,c.Z)((0,c.Z)({},e.tourContext),{},{url:e.getPageUrl(),isInWebviewH5:function(){return!1},isInZTApp:function(){return!1}}))),A.fI.impl((0,c.Z)({},e.getUrlQuery())))),e}return(0,u.Z)(n,[{key:"componentWillMount",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n,r,i,a;return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return x().loadFontFace({family:"crn_font_Ctrip_GroupTour",source:'url("https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/iconfont/crn_font_Ctrip_GroupTour.ttf?v=3")'}),x().loadFontFace({family:"20TH_bold",source:'url("https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/iconfont/20TH_bold.ttf")'}),x().loadFontFace({family:"20TH_regular",source:'url("https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/iconfont/20TH_regular.ttf")'}),e.next=5,this.fetchSwitch();case 5:t=e.sent,n="taro_vacation"===this.getMiniProgramPlatform(),n&&(t=!0),t||(r="/webapp/vacations/tour/detail",i=this.getUrlQuery(),a={isRedirect:!0},this.jumpH5({url:r,params:i,options:a}));case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"fetchSwitch",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var t,n,r,i,a;return(0,o.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={KeyList:["main_weapp_detail_switch"]},e.prev=1,e.next=4,Promise.all([this.post("Getabpreinfo",{}),this.post("QConfig",t)]);case 4:return n=e.sent,r=n[0].Data.IsAB,i=n[1].Data.AppSettingList,a=function(e,t){return JSON.parse(e.filter((function(e){return e.Key===t}))[0].Value)},e.abrupt("return",r||a(i,"main_weapp_detail_switch").open);case 11:return e.prev=11,e.t0=e["catch"](1),console.log(e.t0),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this,[[1,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(){return(0,$.jsx)(fr,{controller:this})}}]),n}(Ir.Z))||mr),gr={enableShareAppMessage:!0,usingComponents:{"mp-html":"../common/mp-html/index"},navigationBarBackgroundColor:"#fff",navigationStyle:"custom"};hr.enableShareAppMessage=!0;Page((0,a.createPageConfig)(hr,"pages/vacations/detail/index",{root:{cn:[]}},gr||{}))},8700:function(e,t,n){e.exports=n.p+"pages/vacations/detail/skeleton.png"},79181:function(e){e.exports=require("../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../cwx/cwx")},65238:function(e){e.exports=require("../../../cwx/ext/global")},33675:function(e){e.exports=require("../../../cwx/cwx")},46346:function(e){e.exports=require("../../../cwx/ext/global")}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[4666,2107,1216,8592],(function(){return t(88287)}));e.O()}]);
//# sourceMappingURL=index.js.map