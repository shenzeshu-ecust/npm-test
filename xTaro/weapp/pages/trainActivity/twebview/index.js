"use strict";require("../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[1338],{29340:function(e,t,n){var a=n(32180),i=n(90983),r=n(298),c=n(79301),o=n(95308),s=n(57042),l=n(24460),u=n(21867),p=n(86066),d=n(90201),f=n(92954),h=n.n(f),m=n(71515),g=n(56884),v=n.n(g),b=n(65542),x=n(13854),k=n(64477),w=n(43460),N=n(12936),y=n(43479),P=n.n(y),C=n(22276),T=n(90129),Z=(n(47929),n(68277)),j=n(2269),S=["displayValue"],V=function(e){var t=e.displayValue,n=(0,Z.Z)(e,S),a=(0,d.useState)(!1),i=(0,T.Z)(a,2),c=i[0],o=i[1],s=(0,d.useState)(""),l=(0,T.Z)(s,2),u=l[0],p=l[1],f=function(e){var t;o(!0),null===(t=n.onFocus)||void 0===t||t.call(n,e)},h=function(e){var t;o(!1),null===(t=n.onBlur)||void 0===t||t.call(n,e)},g=function(){var e;o(!0),null===(e=n.onFocus)||void 0===e||e.call(n)};return(0,d.useEffect)((function(){var e,a=n.password||"password"==n.type;p(a?(null===(e=n.value)||void 0===e?void 0:e.replace(/./g,"\u2022"))||"":t||n.value)}),[t,n.password,n.type,n.value]),(0,j.jsx)(j.Fragment,{children:c?(0,j.jsx)(m.Input,(0,r.Z)((0,r.Z)({},n),{},{focus:c,cursor:n.value.length,adjustPosition:!0,onFocus:f,onBlur:h})):(0,j.jsx)(m.View,{className:n.value?n.className:n.className+" "+n.placeholderClass,onClick:g,children:n.value?u:n.placeholder})})},I=V,_=n(79608),U=function(e){var t=e.visible,n=e.mobilePhone,a=e.smsVerify,i=e.close;return(0,j.jsx)(_.Z,{visible:t,direction:"middle",clickMaskClose:!0,close:i,children:(0,j.jsxs)(m.View,{className:"scan-pop",children:[(0,j.jsx)(m.Text,{className:"icon-face-scan"}),(0,j.jsx)(m.View,{className:"tit",children:"\u5efa\u8bae\u5b8c\u6210\u77ed\u4fe1\u6838\u9a8c"}),(0,j.jsx)(m.View,{className:"sub",children:"\u4e3a\u4fdd\u8bc1\u60a8\u7684\u8d26\u53f7\u5b89\u5168\uff0c\u5efa\u8bae\u60a8\u5b8c\u6210\u77ed\u4fe1\u6838\u9a8c\u4e4b\u540e\u518d\u6dfb\u52a0\u4e58\u5ba2"}),(0,j.jsxs)(m.View,{className:"grey-tips",children:["\u8bf7\u786e\u8ba4\u60a8\u662f",n?":".concat(n):"","\u673a\u4e3b"]}),(0,j.jsx)(m.View,{className:"btn-box",children:(0,j.jsx)(m.Button,{className:"btn-blue",onClick:a,children:"\u5f00\u59cb\u6838\u9a8c"})}),(0,j.jsx)(m.Text,{className:"ifont-closed",onClick:i})]})})},B=U,W={title:"\u9700\u5b8c\u6210\u4eba\u8bc1\u6838\u9a8c",subTitle:"\u4e3a\u4e86\u4fdd\u8bc1\u60a8\u7684\u8d26\u53f7\u5b89\u5168\uff0c\u8bf7\u60a8\u8fdb\u884c\u4eba\u8bc1\u6838\u9a8c",tips:function(e){return"\u8bf7\u786e\u8ba4\u60a8\u662f\u8d26\u53f7\u672c\u4eba".concat(e?":".concat(e):"")}},D={title:"\u5efa\u8bae\u5b8c\u6210\u4eba\u8bc1\u6838\u9a8c",subTitle:"\u4e3a\u4fdd\u8bc1\u60a8\u7684\u8d26\u53f7\u5b89\u5168\uff0c\u5efa\u8bae\u60a8\u5b8c\u6210\u4eba\u8bc1\u6838\u9a8c\u4e4b\u540e\u518d\u6dfb\u52a0\u4e58\u5ba2",tips:function(e){return"\u8bf7\u786e\u8ba4\u60a8\u662f\u8d26\u53f7\u672c\u4eba".concat(e?":".concat(e):"")}},F=function(e){var t,n=e.visible,a=e.action,i=e.realName,r=e.jumpCheckPage,c=e.jumpServicePage,o=e.faceVerify,s=e.close,l=e.closeCb,u=(0,d.useState)(!1),p=(0,T.Z)(u,2),f=p[0],h=p[1];t="frontAutoLogin"==a?D:W;var g=function(){h(!f)},v=function(){if(!f)return x.ZP.showToast("\u8bf7\u9605\u8bfb\u5e76\u52fe\u9009\u534f\u8bae","none");s(),o()};(0,d.useEffect)((function(){h(!1)}),[n]);var b=(0,d.useCallback)((function(){s(),l&&l()}),[]);return(0,j.jsx)(_.Z,{visible:n,direction:"middle",clickMaskClose:!0,close:b,children:(0,j.jsxs)(m.View,{className:"scan-pop",children:[(0,j.jsx)(m.Text,{className:"icon-face-scan"}),(0,j.jsx)(m.View,{className:"tit",children:t.title}),(0,j.jsx)(m.View,{className:"sub",children:t.subTitle}),(0,j.jsx)(m.View,{className:"grey-tips",children:t.tips(i)}),(0,j.jsx)(m.View,{className:"btn-box",children:(0,j.jsx)(m.Button,{className:"btn-blue",onClick:v,children:"\u540c\u610f\u534f\u8bae\u5e76\u5f00\u59cb\u6838\u9a8c"})}),(0,j.jsxs)(m.View,{className:"info",children:[(0,j.jsxs)(m.View,{className:"desc",children:[(0,j.jsx)(m.Text,{className:f?"ifont-checked blue":"ifont-checkbox",onClick:g}),"\u5df2\u9605\u8bfb\u540c\u610f\xa0",(0,j.jsx)(m.Text,{className:"blue",onClick:c,children:"\u670d\u52a1\u534f\u8bae"}),"\xa0",(0,j.jsx)(m.Text,{className:"blue",onClick:r,children:"\u8ba4\u8bc1\u534f\u8bae"})]}),!f&&(0,j.jsx)(m.View,{className:"tip",children:"\u8bf7\u9605\u8bfb\u5e76\u52fe\u9009\u534f\u8bae"})]}),(0,j.jsx)(m.Text,{className:"ifont-closed",onClick:b})]})})},A=F,R={title:"\u9700\u5b8c\u6210\u4eba\u8bc1\u6838\u9a8c",subTitle:"\u4e3a\u4e86\u4fdd\u8bc1\u60a8\u7684\u8d26\u53f7\u5b89\u5168\uff0c\u8bf7\u60a8\u8fdb\u884c\u4eba\u8bc1\u6838\u9a8c",tips:function(e){return"\u8bf7\u786e\u8ba4\u60a8\u662f\u8d26\u53f7\u672c\u4eba".concat(e?":".concat(e):"")}},M={title:"\u5efa\u8bae\u5b8c\u6210\u4eba\u8bc1\u6838\u9a8c",subTitle:"\u4e3a\u4fdd\u8bc1\u60a8\u7684\u8d26\u53f7\u5b89\u5168\uff0c\u5efa\u8bae\u60a8\u5b8c\u6210\u4eba\u8bc1\u6838\u9a8c\u4e4b\u540e\u518d\u6dfb\u52a0\u4e58\u5ba2",tips:function(e){return"\u8bf7\u786e\u8ba4\u60a8\u662f\u8d26\u53f7\u672c\u4eba".concat(e?":".concat(e):"")}},O=function(e){var t,n=e.visible,a=e.action,i=e.realName,r=e.jumpCheckPage,c=e.jumpServicePage,o=e.faceVerify,s=e.smsVerify,l=e.close,u=(0,d.useState)(!1),p=(0,T.Z)(u,2),f=p[0],h=p[1];t="frontAutoLogin"==a?M:R;var g=function(){h(!f)},v=function(){if(!f)return x.ZP.showToast("\u8bf7\u9605\u8bfb\u5e76\u52fe\u9009\u534f\u8bae","none");l(),o()},b=function(){if(!f)return x.ZP.showToast("\u8bf7\u9605\u8bfb\u5e76\u52fe\u9009\u534f\u8bae","none");l(),s({mobileCheck:0})};return(0,d.useEffect)((function(){h(!1)}),[n]),(0,j.jsx)(_.Z,{visible:n,direction:"middle",clickMaskClose:!0,close:l,children:(0,j.jsxs)(m.View,{className:"more-scan-pop",children:[(0,j.jsx)(m.Text,{className:"icon-face-scan"}),(0,j.jsx)(m.View,{className:"tit",children:t.title}),(0,j.jsx)(m.View,{className:"sub",children:t.subTitle}),(0,j.jsx)(m.View,{className:"grey-tips",children:t.tips(i)}),(0,j.jsx)(m.View,{className:"btn-box",children:(0,j.jsx)(m.Button,{className:"btn-blue",onClick:v,children:"\u540c\u610f\u534f\u8bae\u5e76\u5237\u8138\u6838\u9a8c"})}),(0,j.jsx)(m.View,{className:"btn-box btn-sms",children:(0,j.jsx)(m.Button,{className:"btn-line",onClick:b,children:"\u77ed\u4fe1\u6838\u9a8c"})}),(0,j.jsxs)(m.View,{className:"info",children:[(0,j.jsxs)(m.View,{className:"desc",children:[(0,j.jsx)(m.Text,{className:f?"ifont-checked blue":"ifont-checkbox",onClick:g}),"\u5df2\u9605\u8bfb\u540c\u610f\xa0",(0,j.jsx)(m.Text,{className:"blue",onClick:c,children:"\u670d\u52a1\u534f\u8bae"}),"\xa0",(0,j.jsx)(m.Text,{className:"blue",onClick:r,children:"\u8ba4\u8bc1\u534f\u8bae"})]}),!f&&(0,j.jsx)(m.View,{className:"tip",children:"\u8bf7\u9605\u8bfb\u5e76\u52fe\u9009\u534f\u8bae"})]}),(0,j.jsx)(m.Text,{className:"ifont-closed",onClick:l})]})})},z=O,L=g.__global.env,K="https://m.ctrip.com";"fat"==L?K="https://m.fws.qa.nt.ctripcorp.com":"uat"==L&&(K="https://m.ctrip.uat.qa.nt.ctripcorp.com");var G="bind12306",E="12306Accounts",H={title:"\u8bf7\u767b\u5f55\u60a8\u768412306\u8d26\u53f7",subTitle:"\u94c1\u8def\u5c40\u89c4\u5b9a\uff0c\u8d2d\u7968\u9700\u5b8c\u6210\u5b9e\u540d\u8ba4\u8bc1",phonePlaceHolder:"12306\u7528\u6237\u540d/\u90ae\u7bb1/\u624b\u673a\u53f7",pwdPlaceHolder:"\u8bf7\u8f93\u516512306\u8d26\u53f7\u5bc6\u7801"},q={mobile:"",userName:"",loginPW:"",displayName:"",defaultUserName:""},Q="frontPassengerLogin",J="frontPassengerClick",X=function(e){var t=new Map([[7,91],[8,94],[9,96]]);return t.get(e)},Y=function(){},$=function(e){var t,n=e.pageId,a=e.loginName,i=void 0===a?"":a,s=e.visible,l=e.isOrdinary,u=e.push,p=e.textConfig,f=void 0===p?{}:p,h=e.pkg,g=void 0===h?{}:h,b=e.action,k=void 0===b?"":b,w=e.done,y=void 0===w?Y:w,P=e.close,Z=void 0===P?Y:P,S=e.finish,V=void 0===S?Y:S,U=e.freeDone,W=void 0===U?Y:U,D=(0,d.useState)(q),F=(0,T.Z)(D,2),R=F[0],M=F[1],O=(0,d.useState)({}),L=(0,T.Z)(O,2),$=L[0],ee=L[1],te=(0,d.useState)(!1),ne=(0,T.Z)(te,2),ae=ne[0],ie=ne[1],re=(0,d.useState)(!1),ce=(0,T.Z)(re,2),oe=ce[0],se=ce[1],le=(0,d.useState)(!1),ue=(0,T.Z)(le,2),pe=ue[0],de=ue[1],fe=(0,d.useState)(!1),he=(0,T.Z)(fe,2),me=he[0],ge=he[1],ve=(0,d.useState)(!1),be=(0,T.Z)(ve,2),xe=be[0],ke=be[1],we=(0,d.useState)(!1),Ne=(0,T.Z)(we,2),ye=Ne[0],Pe=Ne[1],Ce=(0,d.useState)(!1),Te=(0,T.Z)(Ce,2),Ze=Te[0],je=Te[1],Se=(0,d.useState)(!0),Ve=(0,T.Z)(Se,2),Ie=Ve[0],_e=Ve[1],Ue=(0,d.useState)(0),Be=(0,T.Z)(Ue,2),We=Be[0],De=Be[1],Fe=(0,d.useState)({}),Ae=(0,T.Z)(Fe,2),Re=Ae[0],Me=Ae[1],Oe=(0,d.useRef)(null),ze=(0,d.useRef)(null),Le=(0,d.useRef)(null),Ke=v().getCurrentPage(),Ge=function(){var e=N.WG.getAttr(E)||[],t=N.WG.getAttr(G)||{};if(!$.userNameInputFlag&&s&&e.length)if(R.userName){if(!R.loginPW){var n=x.ZP.convetFakePhone(i),a=e.find((function(e){return e.displayName==n||e.displayName==R.displayName||e.displayName==R.userName})),r=a.displayName,c=a.userName,o=a.loginPW;M({userName:c||i,defaultUserName:c,displayName:r,loginPW:o})}}else{var l=e.find((function(e){return e.displayName==t.displayName}))||e[0],u=l.displayName,p=l.userName,d=l.loginPW;M({userName:p||i,defaultUserName:p||i,displayName:u||i,loginPW:d})}else Ee()},Ee=function(){ie(!1),ge(!1),se(!1),de(!1),Pe(!1),je(!1)},He=function(){var e=R.userName;return!!e||(x.ZP.showToast("\u624b\u673a\u53f7\u4e0d\u80fd\u4e3a\u7a7a\uff01","none"),!1)},qe=function(e){var t=e.detail.value;_e(!0),M((0,r.Z)((0,r.Z)({},R),{},{userName:t,displayName:t})),ee((0,r.Z)((0,r.Z)({},$),{},{userNameInputFlag:!0}))},Qe=function(e){var t=e.detail.value;_e(!0),M((0,r.Z)((0,r.Z)({},R),{},{loginPW:t})),ee((0,r.Z)((0,r.Z)({},$),{},{loginPWInputFlag:!0}))},Je=function(){M((0,r.Z)((0,r.Z)({},R),{},{userName:""}))},Xe=function(){ie(!ae)},Ye=function(){var e=R.userName,t=R.defaultUserName,n=$.userNameInputFlag?e:t||e,a="".concat(K,"/webapp/train/activity/ctrip-train-12306/#/retrieve?userName=").concat(n,"&from=loginSheet");Ke.navigateTo({url:"/pages/trainActivity/twebview/index",data:{url:a,needLogin:!0,bridgeIns:it}})},$e=function(){Ke.navigateTo({url:"/pages/train/webview/webview",data:{url:"https://m.ctrip.com/webapp/train/activity/orderservice/InsuranceDetail.aspx?ProductID=1111&&disable_redirect_https=1&terminal=1"}})},et=function(){Ke.navigateTo({url:"/pages/train/webview/webview",data:{url:"https://m.ctrip.com/webapp/train/activity/orderservice/InsuranceDetail.aspx?ProductID=2021&disable_redirect_https=1&terminal=1"}})},tt=function(){Ye(),x.ZP.ubtTrace("c_trn_c_".concat(n),{bizKey:"loginSecondStepClick",clickType:4})},nt=function(){de(!pe)},at=function(){se(!oe)},it=function(e){var t=e.detail.data;return gt(t[0])},rt=function(e){var t=e.detail.data;return gt(t[0])},ct=function(){var e=He();return me?(x.ZP.ubtTrace("c_trn_c_".concat(n),{bizKey:"loginSecondStepClick",clickType:1}),R.loginPW?oe?void gt():x.ZP.showToast("\u8bf7\u5148\u540c\u610f\u8d26\u53f7\u6388\u6743\u534f\u8bae","none"):x.ZP.showToast("\u8bf7\u5148\u8f93\u516512306\u5bc6\u7801","none")):(x.ZP.ubtTrace("c_trn_c_".concat(n),{bizKey:"loginFirstStepClick",clickType:1}),e&&ge(!0))},ot=function(){Ke.navigateTo({url:"/pages/train/webview/webview",data:{url:"https://m.ctrip.com/webapp/train/activity/orderservice/InsuranceDetail.aspx?ProductID=1111&&disable_redirect_https=1&terminal=1"}})},st=function(){x.ZP.ubtTrace("c_trn_c_".concat(n),{bizKey:me?"loginSecondStepClick":"loginFirstStepClick",clickType:3});var e="".concat(K,"/webapp/train/activity/ctrip-train-12306/#/register?from=loginSheet");Ke.navigateTo({url:"/pages/trainActivity/twebview/index",data:{url:e,needLogin:!0,bridgeIns:rt}})},lt=function(){return ke(!0)},ut=function(){return Pe(!0)},pt=function(){return je(!0)},dt=function(){ke(!1),Pe(!1),je(!1),V(),k==J&&x.ZP.ubtTrace("c_trn_c_".concat(n),{exposureType:"popup",bizKey:"verificationPopupClick",errorCode:X(We),clickType:3,result:2})},ft=function(){var e=R.userName,t=R.loginPW,a=R.defaultUserName,i=$.userNameInputFlag?e:a,r="/pages/train/face/face?fromType=4&userName=".concat(i,"&loginPW=").concat(t);if(k==J){var s=N.WG.getAttr(E);r="/pages/train/face/face?fromType=4&userName=".concat(s[0].displayName,"&loginPW=").concat(s[0].loginPW)}Pe(!1),je(!1),Ke.navigateTo({url:r,callback:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(t){return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:setTimeout((function(){if(!t.certificationResultCode||1!=t.certificationResultCode)return k==J&&(V(),x.ZP.ubtTrace("c_trn_c_".concat(n),{exposureType:"popup",bizKey:"verificationPopupClick",errorCode:X(We),clickType:1,result:2})),x.ZP.showModal({m:"\u6838\u9a8c\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"});k==J?(vt(),x.ZP.ubtTrace("c_trn_c_".concat(n),{exposureType:"popup",bizKey:"verificationPopupClick",errorCode:X(We),clickType:1,result:1})):gt()}),500);case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()})},ht=function(e){var t=e.account,n=e.accounts,a=e.realUserName,i=e.displayName,r=e.loginPW;return new Promise((function(e){x.ZP.showModal({m:t?"\u5bc6\u7801\u5df2\u4fee\u6539\uff0c\u4e0b\u6b21\u4e00\u952e\u767b\u5f55\u514d\u8f93\u5165\uff0c\u8981\u66f4\u65b0\u8bb0\u4f4f\u5bc6\u7801\u5417":"\u4e3a\u4e86\u60a8\u7684\u65b9\u4fbf\u8bb0\u4f4f12306\u8d26\u53f7\u5bc6\u7801\uff0c\u4e0b\u6b21\u4e00\u952e\u767b\u5f55\u514d\u8f93\u5165",showCancel:!0,cancelText:"\u6b8b\u5fcd\u62d2\u7edd",cancelColor:"#0086F6",confirmColor:"#0086F6",confirmText:t?"\u66f4\u65b0\u5bc6\u7801":"\u8bb0\u4f4f\u5bc6\u7801",done:function(c){var o=c.confirm;if(o){var s=t?n.filter((function(e){return e.userName!==t.userName})):n;N.WG.setAttr(E,[{userName:a,displayName:i,loginPW:r}].concat((0,C.Z)(s.slice(0,9))))}x.ZP.showToast("\u767b\u5f55\u6210\u529f"),e()}})}))},mt=function(){return new Promise((function(e){x.ZP.showModal({m:"\u5bc6\u7801\u592a\u4e45\u672a\u4fee\u6539\uff0c\u5efa\u8bae\u5c1d\u8bd5\u627e\u56de\u5bc6\u7801",showCancel:!0,cancelText:"\u8fd4\u56de\u4fee\u6539",cancelColor:"#0086F6",confirmColor:"#0086F6",confirmText:"\u627e\u56de\u5bc6\u7801",done:function(t){var n=t.confirm;n&&Ye(),e()}})}))},gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=e.userName,a=e.loginPW,i=e.defaultUserName,s=$.userNameInputFlag?t:i||t,p={UserName:s,Password:a,normalLogin:!0,displayName:R.displayName};(0,x.Xx)({params:p,outerParams:{userName:t},succ:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(i){var r,o,s,p,d,f,h,m,g;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=i.memberStatus,o=i.mobilePhone,s=i.userID12306,p=o||t,d=s||t,f=N.WG.getAttr(E)||[],h=f.find((function(e){return e.userName==d})),h&&h.loginPW===a){e.next=16;break}if(!pe){e.next=12;break}m=h?f.filter((function(e){return e.userName!==h.userName})):f,N.WG.setAttr(E,[{userName:d,displayName:p,loginPW:a}].concat((0,C.Z)(m.slice(0,9)))),x.ZP.showToast("\u767b\u5f55\u6210\u529f"),e.next=14;break;case 12:return e.next=14,ht({account:h,accounts:f,realUserName:d,displayName:p,loginPW:a});case 14:e.next=18;break;case 16:x.ZP.showToast("\u767b\u5f55\u6210\u529f"),x.ZP.ubtTrace("c_trn_c_".concat(n),{bizKey:"loginResult",loginState:0,failReason:""});case 18:if(!u||"0"===r||l){e.next=23;break}return e.next=21,kt();case 21:return g=e.sent,e.abrupt("return",y({login12306Name:(null===g||void 0===g?void 0:g.userName)||d,displayName:(null===g||void 0===g?void 0:g.displayName)||p,login12306Pas:(null===g||void 0===g?void 0:g.loginPW)||a,activateSuccess:null===g||void 0===g?void 0:g.activateSuccess}));case 23:return e.abrupt("return",y({login12306Name:d,displayName:p,login12306Pas:a}));case 24:case"end":return e.stop()}}),e)})));function i(t){return e.apply(this,arguments)}return i}(),fail:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(t){var a,i,o,s;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.originData,i=void 0===a?{}:a,o=t.errmsg,s=t.failCode,Oe.current=i.userID12306,ze.current=i.realName||"",Le.current=i.mobilePhone||"",M((0,r.Z)({},R)),x.ZP.ubtTrace("c_trn_c_".concat(n),{bizKey:"loginResult",loginState:1,failReason:o}),console.log("error",t),6!=s){e.next=9;break}return e.abrupt("return",x.ZP.showModal({title:"\u6e29\u99a8\u63d0\u793a",m:"\u7528\u6237\u540d\u6216\u5bc6\u7801\u8f93\u5165\u9519\u8bef\uff0c\u8d85\u8fc74\u6b21\u60a8\u7684\u8d26\u53f7\u5c06\u88ab\u9501\u5b9a\uff0c\u82e5\u5fd8\u8bb0\u7528\u6237\u540d\u6216\u5bc6\u7801\uff0c\u8bf7\u5c1d\u8bd5\u627e\u56de\u5bc6\u7801\u3002",showCancel:!0,confirmText:"\u627e\u56de\u5bc6\u7801",cancelText:"\u77e5\u9053\u4e86",done:function(e){var t=e.confirm;if(t)return Ye()}}));case 9:if(7!=s){e.next=11;break}return e.abrupt("return",xt({mobileCheck:0,accountInfo:R}));case 11:if(8!=s){e.next=16;break}return e.next=14,(0,x.lu)({});case 14:if(!e.sent){e.next=16;break}return e.abrupt("return",ut());case 16:if(9!=s){e.next=18;break}return e.abrupt("return",pt());case 18:if(13!=s){e.next=20;break}return e.abrupt("return",mt());case 20:if(!((null===o||void 0===o?void 0:o.length)>24)){e.next=22;break}return e.abrupt("return",x.ZP.showModal({m:o||"\u7f51\u7edc\u5f00\u5c0f\u5dee\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"}));case 22:x.ZP.showToast(o||"\u7f51\u7edc\u5f00\u5c0f\u5dee\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5","none");case 23:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()})},vt=function(){var e=N.WG.getAttr(E);if(null===e||void 0===e||!e.length)return V();(0,x.Xx)({params:{UserName:e[0].userName,Password:e[0].loginPW,normalLogin:!0},outerParams:{userName:e[0].userName},succ:function(t){return V((0,r.Z)((0,r.Z)({},t),{},{userName:e[0].displayName,succ:!0}))},fail:function(e){N.WG.removeAttr(G),Me(e),V()}})},bt=function(){var e=(0,o.Z)((0,c.Z)().mark((function e(){var t,a,i,r;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=Re.originData,a=void 0===t?{}:t,i=Re.failCode,r=void 0===i?0:i,Le.current=a.mobilePhone||"",ze.current=a.realName||"",De(r),7!=r){e.next=7;break}return x.ZP.ubtTrace("s_trn_c_trace_".concat(n),{exposureType:"popup",bizKey:"verificationPopup",errorCode:"91"}),e.abrupt("return",lt());case 7:if(8!=r){e.next=13;break}return e.next=10,(0,x.lu)({});case 10:if(!e.sent){e.next=13;break}return x.ZP.ubtTrace("s_trn_c_trace_".concat(n),{exposureType:"popup",bizKey:"verificationPopup",errorCode:"94"}),e.abrupt("return",ut());case 13:if(9!=r){e.next=16;break}return x.ZP.ubtTrace("s_trn_c_trace_".concat(n),{exposureType:"popup",bizKey:"verificationPopup",errorCode:"96"}),e.abrupt("return",pt());case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xt=function(e){var t=e.mobileCheck,a=e.accountInfo,i=a||R,r=i.loginPW,c="".concat(K,"/webapp/train/activity/ctrip-train-12306/#/verify?mobile=").concat(Le.current||"\u60a8\u7684\u4e0b\u5355\u624b\u673a","&userName=").concat(encodeURIComponent(ze.current),"&password=").concat(encodeURIComponent(r),"&userID12306=").concat(Oe.current,"&mobileCheck=").concat(t,"&source=login12306sheet");if(k==J){var o=N.WG.getAttr(E);c="".concat(K,"/webapp/train/activity/ctrip-train-12306/#/verify?mobile=").concat(o[0].displayName||"\u60a8\u7684\u4e0b\u5355\u624b\u673a","&userName=").concat(encodeURIComponent(o[0].displayName),"&password=").concat(encodeURIComponent(o[0].loginPW),"&userID12306=").concat(o[0].userName,"&mobileCheck=").concat(t,"&source=login12306sheet")}dt(),Ke.navigateTo({url:"/pages/trainActivity/twebview/index",data:{url:c,needLogin:!0,bridgeIns:function(e){var t=e.detail.data,i=(0,T.Z)(t,1),r=i[0].unRisk,c=void 0!==r&&r;setTimeout((function(){c?k==J?(vt(),x.ZP.ubtTrace("c_trn_c_".concat(n),{exposureType:"popup",bizKey:"verificationPopupClick",errorCode:X(We),clickType:96==X(We)?2:1,result:1})):gt(a):(k==J&&x.ZP.ubtTrace("c_trn_c_".concat(n),{exposureType:"popup",bizKey:"verificationPopupClick",errorCode:X(We),clickType:96==X(We)?2:1,result:2}),V())}),500)}}})},kt=function(){return new Promise((function(e){var t="".concat(K,"/webapp/train/activity/ctrip-train-12306/#/login?userName=").concat(encodeURIComponent(R.userName),"&loginPW=").concat(encodeURIComponent(R.loginPW),"&source=login12306sheet&push=").concat(u,"&autoLogin=1");Ke.navigateTo({url:"/pages/trainActivity/twebview/index",data:{url:t,bridgeIns:function(t){var n,a=null===t||void 0===t||null===(n=t.detail.data)||void 0===n?void 0:n[0];e(a)}}})}))},wt=function(){var e=(0,o.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:k==Q?vt():k==J&&bt();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,d.useEffect)((function(){Ge()}),[s,i]),(0,d.useEffect)((function(){wt()}),[k]),(0,j.jsxs)(j.Fragment,{children:[s&&x.ZP.ubtTrace("s_trn_c_trace_".concat(n),{exposureType:"actionbar",bizKey:"loginFirstStep"}),(0,j.jsx)(_.Z,{visible:s,children:(0,j.jsxs)(m.View,{className:"login12306-pop",children:[(0,j.jsxs)(m.View,{className:"login12306-pop-hd",children:[(0,j.jsx)(m.View,{className:"tit",children:f.title||H.title}),(0,j.jsx)(m.View,{className:"sub",children:f.subTitle||H.subTitle}),(0,j.jsx)(m.Text,{className:"ifont-closed-line",onClick:Z})]}),(0,j.jsxs)(m.View,{className:"login12306-pop-bd",children:[(0,j.jsxs)(m.View,{className:"input-box ".concat(me?"active":""),children:[(0,j.jsxs)(m.View,{className:"input-item",children:[(0,j.jsx)(I,{className:"input-text",type:"text",displayValue:R.displayName,value:R.userName,placeholder:H.phonePlaceHolder,placeholderClass:"placeHolder",cursorSpacing:x.ZP.isIphone13()?30:20,onBlur:qe,onFocus:function(){return _e(!1)}}),Ie&&0!==R.userName.length&&(0,j.jsx)(m.Text,{className:"ifont-clean",onClick:Je})]}),me&&(0,j.jsxs)(j.Fragment,{children:[x.ZP.ubtTrace("s_trn_c_trace_".concat(n),{exposureType:"actionbar",bizKey:"loginSecondStep"}),(0,j.jsxs)(m.View,{className:"input-item",children:[(0,j.jsx)(I,{className:"input-pwd",password:!ae,value:R.loginPW,placeholder:H.pwdPlaceHolder,placeholderClass:"placeHolder",cursorSpacing:x.ZP.isIphone13()?40:ae?20:0,onBlur:Qe,onFocus:function(){return _e(!1)}}),(0,j.jsx)(m.Text,{className:"".concat(ae?"icon-eyeopen":"icon-eyecloed"),onClick:Xe}),(0,j.jsx)(m.View,{className:"btn-forget",onClick:tt,children:"\u5fd8\u8bb0\u5bc6\u7801\uff1f"})]}),(0,j.jsxs)(m.View,{className:"detail-info ".concat(oe?"no-tip":""),children:[(0,j.jsxs)(m.View,{className:"protocol",children:[(0,j.jsx)(m.Text,{className:"".concat(oe?"ifont-checked blue":"ifont-checkbox"),onClick:at}),"\u5df2\u9605\u8bfb\u5e76\u540c\u610f\xa0",(0,j.jsx)(m.View,{className:"blue",onClick:ot,children:"\u8d26\u53f7\u6388\u6743\u534f\u8bae"}),!oe&&(0,j.jsx)(m.View,{className:"tip",children:"\u8bf7\u5148\u52fe\u9009\u540c\u610f\u540e\u518d\u8fdb\u884c\u767b\u5f55"})]}),(0,j.jsxs)(m.View,{className:"remember",onClick:nt,children:[(0,j.jsx)(m.Text,{className:"".concat(pe?"ifont-checked blue":"ifont-checkbox")}),(0,j.jsx)(m.View,{className:"txt",children:"\u8bb0\u4f4f\u5bc6\u7801"})]})]})]})]}),(0,j.jsxs)(m.View,{className:"btn-box",children:[(0,j.jsx)(m.Button,{className:"btn-submit",onClick:ct,children:me?"\u767b\u5f5512306\u8d26\u53f7":"\u4e0b\u4e00\u6b65"}),(0,j.jsxs)(m.View,{className:"txt blue ".concat(x.ZP.isIos()?"":"noios"),onClick:st,children:["\u6ca1\u6709\u8d26\u53f7\uff0c10S\u5b8c\u6210\u6781\u901f\u6ce8\u518c",(0,j.jsx)(m.Text,{className:"ifont-arr"})]})]})]}),(null===g||void 0===g||null===(t=g.package)||void 0===t?void 0:t.productTitle)&&(0,j.jsxs)(m.View,{className:"login12306-pop-bd pkg",children:[(0,j.jsx)(m.Image,{className:"img",src:"https://pic.c-ctrip.com/train/wechat/icon-youxian-new.png"}),(0,j.jsxs)(m.View,{className:"cont",children:[(0,j.jsxs)(m.View,{className:"tit",children:[g.package.productTitle," ",(0,j.jsxs)(m.Text,{className:"price",children:[g.package.productPrice,"\u5143/\u4eba"]})]}),(0,j.jsx)(m.View,{className:"sub",children:"\u6781\u901f\u8d2d\u7968\uff0c\u65e0\u9700\u6392\u961f"})]}),(0,j.jsx)(m.Button,{className:"btn-pkg",onClick:function(){x.ZP.ubtTrace("c_trn_c_".concat(n),{bizKey:me?"loginSecondStepClick":"loginFirstStepClick",clickType:2}),W()},children:"\u7acb\u5373\u51fa\u7968"})]})]})}),(0,j.jsx)(B,{visible:xe,mobilePhone:Le.current,smsVerify:function(){return xt({mobileCheck:0})},close:dt}),(0,j.jsx)(A,{visible:ye,action:k,realName:ze.current,jumpCheckPage:et,jumpServicePage:$e,faceVerify:ft,close:dt}),(0,j.jsx)(z,{visible:Ze,action:k,realName:ze.current,jumpCheckPage:et,jumpServicePage:$e,faceVerify:ft,smsVerify:function(){return xt({mobileCheck:0})},close:dt})]})},ee=$,te=v().train,ne=P().URLSearchParams,ae=function(){},ie=function(e){return e?e.startsWith("#")?e:"#".concat(e):""},re=function(){h().getCurrentPages().length<=1?v().redirectTo({url:"/pages/train/index/index"}):v().navigateBack()},ce=function(){v().navigateTo({url:"/pages/train/webview/webview",data:{url:"https://m.ctrip.com/webapp/train/activity/orderservice/InsuranceDetail.aspx?ProductID=1111&&disable_redirect_https=1&terminal=1"}})},oe=function(){v().navigateTo({url:"/pages/train/webview/webview",data:{url:"https://m.ctrip.com/webapp/train/activity/orderservice/InsuranceDetail.aspx?ProductID=2021&disable_redirect_https=1&terminal=1"}})},se=function(e){(0,u.Z)(n,e);var t=(0,p.Z)(n);function n(e){var a;return(0,s.Z)(this,n),a=t.call(this,e),a.checkPerformance=!0,a.pageId=k.Z.twebview,a.state={canWebView:h().canIUse("web-view"),wsg:"",url:""},a.shareData={bu:"",title:"",path:"",imageUrl:"",desc:"",customer:null},a.bridgeIns=ae,a.openId=v().cwx_mkt.openid,a.unionId=v().cwx_mkt.unionid,a.searchParams=null,a.cityName="",a.longitude=null,a.latitude=null,a}return(0,l.Z)(n,[{key:"onLoad",value:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(t){var n,a,i;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.data,a=void 0===n?{}:n,i=a.url||decodeURIComponent(t.url),this.pageUrl=i,this.bridgeIns=a.bridgeIns||ae,console.log("twebview \u9875\u9762\u8def\u5f84",i),e.next=7,this.initSocket(i);case 7:i=e.sent,this.initPage(i);case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"componentDidShow",value:function(){var e,t,n=this;null!==(e=te.webviewData)&&void 0!==e&&e.needReload&&null!==(t=te.webviewData)&&void 0!==t&&t.reloadUrl&&(this.setState({url:""}),setTimeout((function(){n.initPage(te.webviewData.reloadUrl),te.webviewData=null}),800))}},{key:"initSocket",value:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(t){var n,a,i,r,o,s=this;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=this,a=new ne(t.replace(/#.*/,"").split("?")[1]),i=a.get("needSocket"),r=a.get("socketObserverKey"),o=t,!i||!r){e.next=15;break}return e.prev=6,e.next=9,new Promise((function(e){var a=v().createMiniSocket({socketObserverKey:r,url:t,source:i,onGetKey:function(n){console.log("onGetKey",n),t=n,e(n)},onMessage:function(e){console.log("onMessage:",e),"function"===typeof n.onSocketMessage&&n.onSocketMessage(e)},onOpen:function(e){console.log("onOpen:",e),"function"===typeof n.onSocketOpen&&n.onSocketOpen(e,a)},onClose:function(e){console.log("onClose:",e),"function"===typeof n.onSocketClose&&n.onSocketClose(e,a)},onError:function(e){console.error("onError:",e),"function"===typeof n.onSocketError&&n.onSocketError(e,a)}});s.socketClient=a}));case 9:o=e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](6),console.log("socket connect error",e.t0);case 15:return e.abrupt("return",o);case 16:case"end":return e.stop()}}),e,this,[[6,12]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"initPage",value:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(t){var n,a,i,r,o,s,l,u,p,d,f,m,g,b,k,w;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("oldUrl",t),n=new ne(t.replace(/#.*/,"").split("?")[1]),this.searchParams=n,a=n.get("needLogin"),i=n.get("allianceid"),r=n.get("sid"),o=n.get("hideShare"),s=n.get("need12306Name"),l=n.get("checkStuQua"),u=n.get("redirectSync"),p=n.get("froce12306Login"),this.userName=n.get("userName"),this.initNavigation(n),i&&r&&v().mkt.setUnion({allianceid:i,sid:r}),this.openId&&this.unionId){e.next=19;break}return e.next=17,(0,x.wr)();case 17:this.openId=e.sent,this.unionId=v().cwx_mkt.unionid;case 19:if(o&&h().hideShareMenu(),d=v().user.auth||"",f=v().user.duid||"",m="",d&&f&&(m=this.getTokenByAuth()),m||"1"!==a){e.next=34;break}return e.prev=25,e.next=28,(0,x.x4)();case 28:m=this.getTokenByAuth(),e.next=34;break;case 31:e.prev=31,e.t0=e["catch"](25),x.ZP.showToast({title:"\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55",icon:"none",duration:2e3});case 34:if(g=h().getStorageSync("USERINFONEW")||{},b=g.nickName,k=g.avatarUrl,this.ctripInfo={url:t,token:m,nickName:b,avatar:k,redirectSync:u},e.t1=this.userName,e.t1){e.next=41;break}return e.next=40,this.get12306UserName();case 40:e.t1=e.sent;case 41:if(this.userName=e.t1,"1"!==p){e.next=44;break}return e.abrupt("return",this.setState({loginPopVisible:!0,checkView:!0}));case 44:if(!s||this.userName){e.next=46;break}return e.abrupt("return",this.setState({loginPopVisible:!0,checkView:!0}));case 46:if("1"!==l){e.next=51;break}return te.fromCheckStuQua=1,this.setState({checkView:!0,isCheckStuQua:!0}),w={Username:this.userName},e.abrupt("return",this.handleCheckStu(w));case 51:this.goUrl({url:t,token:m,nickName:b,avatar:k,redirectSync:u});case 52:case"end":return e.stop()}}),e,this,[[25,31]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"initNavigation",value:function(e){var t=e.get("title"),n=ie(e.get("titleColor")),a=ie(e.get("titleBgColor")),i=ie(e.get("bgColorTop")),r=ie(e.get("bgColorBottom")),c=ie(e.get("bgColor")),o={navigationBarTitleText:"\u9875\u9762\u52a0\u8f7d\u4e2d...",navigationBarFrontColor:"#000000",navigationBarBackgroundColor:"#ffffff",backgroundColorTop:"#ffffff",backgroundColorBottom:"#ffffff",backgroundColor:"#ffffff"},s={navigationBarTitleText:t||o.navigationBarTitleText,navigationBarFrontColor:n||o.navigationBarFrontColor,navigationBarBackgroundColor:a||o.navigationBarBackgroundColor,backgroundColorTop:i||o.backgroundColorTop,backgroundColorBottom:r||o.backgroundColorBottom,backgroundColor:c||o.backgroundColor};v().setNavigationBarTitle({title:s.navigationBarTitleText}),v().setNavigationBarColor({frontColor:s.navigationBarFrontColor,backgroundColor:s.navigationBarBackgroundColor}),v().setBackgroundColor({backgroundColor:s.backgroundColor}),v().setBackgroundColor({backgroundColorTop:s.backgroundColorTop,backgroundColorBottom:s.backgroundColorBottom})}},{key:"showUrlError",value:function(){this.setState({url:"",wsg:"\u76ee\u6807\u5730\u5740\u51fa\u4e86\u70b9\u95ee\u9898\uff0c\u8bf7\u91cd\u65b0\u6253\u5f00\u8be5\u9875\u9762"})}},{key:"webToLoginUrl",value:function(e){return new Promise((function(t){v().syncLogin.webGetTokenByAuth({url:e,loginErrorUrl:e,success:t,fail:function(e){v().showToast({title:"\u767b\u5f55\u5931\u8d25",icon:"none"}),t(e)}})}))}},{key:"goUrl",value:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(t){var n,a,i,o,s,l,u,p,d,f,m,g,b,x,k,N;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.url,a=t.token,i=void 0===a?"":a,o=t.avatar,s=void 0===o?"":o,l=t.nickName,u=void 0===l?"":l,p=t.redirectSync,d=n.split("#")[1]||"",f=n.replace(/#.*/,"").split("?")[0],this.searchParams.set("mp",1),m="1",this.searchParams.set("_sync",m),this.searchParams.set("_token",i),s&&this.searchParams.set("avatar",s),u&&this.searchParams.set("nickName",u),this.cityName&&this.searchParams.set("cityName",this.cityName),this.latitude&&this.searchParams.set("latitude",this.latitude),this.longitude&&this.searchParams.set("longitude",this.longitude),v().clientID&&this.searchParams.set("_cid",v().clientID),this.openId&&this.searchParams.set("openId",this.openId),this.unionId&&this.searchParams.set("unionId",this.unionId),this.openGId&&this.searchParams.set("openGId",this.openGId),this.userName&&this.searchParams.set("userName",this.userName),g=v().mkt.unionObj&&v().mkt.unionObj()||{},b=g._cwxobj,x=function(){return(0,r.Z)((0,r.Z)({},v().getPrSettingSync()),{},{pLen:h().getCurrentPages().length})},k=x(),b)try{b=JSON.parse(v().util.decodeURIComponentSafely(b)),b=encodeURIComponent(JSON.stringify((0,r.Z)((0,r.Z)({},b),k)))}catch(e){}else b=v().syncLogin.getEnv(k);if(this.searchParams.set("_cwxobj",b),this.searchParams.set("miniProgramType",w.Z.miniProgramType),this.searchParams.set("fromminiapp",w.Z.traceChannel),N=f+"?"+this.searchParams.toString()+(d?"#".concat(d):""),!p){e.next=30;break}return e.next=29,this.webToLoginUrl(N);case 29:N=e.sent;case 30:console.log("newUrl",N),this.setState({url:N});case 32:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getTokenByAuth",value:function(){var e=v().aes.enc.Utf8.parse("YnV0dGVycz3MzRkw"),t="".concat(v().user.auth,"|").concat(v().user.duid,"|").concat(Date.now()),n=v().aes.enc.Utf8.parse(JSON.stringify(t)),a=v().aes.AES.encrypt(n,e,{mode:v().aes.mode.ECB,padding:v().aes.pad.Pkcs7});return v().aes.enc.Base64.stringify(a.ciphertext)}},{key:"get12306UserName",value:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(){var t,n;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=N.WG.getAttr("bind12306")||{},e.t0=t.name,e.t0){e.next=6;break}return e.next=5,(0,x._P)();case 5:e.t0=e.sent;case 6:return n=e.t0,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"navigateToShare",value:function(e){var t=this;setTimeout((function(){t.navigateTo({url:"/pages/train/functionalPages/share/index",data:e})}),300)}},{key:"cleanMessage",value:function(e){for(var t=e.length-1;t>=0;t--)e[t].needClean&&e.splice(t,1)}},{key:"onWebMessage",value:function(e){var t=this;console.log("data:"+JSON.stringify(e)),"alipay"===w.Z.miniProgramType&&(e.detail.data=[e.detail.data]);var n,a=(0,i.Z)(e.detail.data);try{var r=function(){var a,i=n.value;if("onShare"===i.type)t.shareData=i.shareData,i.needClean=1;else if("onSaveImage"===i.type)console.log("onSaveImage",i.subscribeTmpIds),t.navigateToShare(i),i.needClean=1;else if(null!==(a=i.cancelRobToZhongZhuanData)&&void 0!==a&&a.trainInfo)setTimeout((function(){t.navigateTo({url:"/pages/train/zhongzhuan/zhongzhuan",data:i.cancelRobToZhongZhuanData})}),500);else if(i.userName&&("orderbreak"===i.from||t.searchParams.get("fromUse12306H5"))){var r={name:i.userName,displayName:i.displayName,passengerList12306:i.passengerList||[]};if(N.WG.setAttr("bind12306",r),t.searchParams.get("fromUse12306H5")){var c=t.searchParams.get("autoBackUrl").replace(/userName12306|displayName/g,"")+"&userName12306="+i.userName+"&displayName="+i.displayName;te.webviewData={needReload:!0,reloadUrl:c}}}else if("schemequery"===i.fromH5)te.transitObj=i,console.log("\u6709\u7968\u67e5\u8be2\u5bf9\u63a5\u53c2\u6570",i);else if("noTicketAssist"===i.from){var o;te.train=i.train,te.selectDate=null===(o=i.train)||void 0===o?void 0:o.selectDate,te.transitObj=i.transitObj,console.log("noTicketAssist",i)}else t.bridgeIns(e)};for(a.s();!(n=a.n()).done;)r()}catch(e){a.e(e)}finally{a.f()}this.cleanMessage(e.detail.data)}},{key:"onSocketMessage",value:function(e){if("checkminiapp"!==e.type&&e){var t=e.data;switch(e.type){case"noTicketAssist":var n;te.train=t.train,te.selectDate=null===(n=t.train)||void 0===n?void 0:n.selectDate,te.transitObj=t.transitObj}}}},{key:"onShareAppMessage",value:function(){return this.shareData.title||(this.shareData.title="\u643a\u7a0b\u706b\u8f66\u7968"),this.shareData.path||(this.shareData.path="pages/train/index/index"),this.shareData}},{key:"goCheckPage",value:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.searchParams.set("checkStuQua","0"),this.setState({checkView:!1,isCheckStuQua:!1}),this.goUrl((0,r.Z)({},this.ctripInfo));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleCheckStu",value:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(t){var n,a,i;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,x.i2)(t);case 2:if(n=e.sent,console.log("1234567doCheckStu",n),a=n.StuQualificationCallBackInfo&&JSON.parse(n.StuQualificationCallBackInfo),0!==(null===a||void 0===a?void 0:a.authFlag)){e.next=9;break}return e.abrupt("return",this.goCheckPage());case 9:if(1!==(null===a||void 0===a?void 0:a.authFlag)){e.next=14;break}return this.setState({isFaceVisible:!0,scanFaceInfo:{realName:(null===(i=a.studentInfoDTO)||void 0===i?void 0:i.name)||t.Username,user12306:t.Username}}),e.abrupt("return");case 14:x.ZP.showModal({m:"\u53d1\u751f\u9519\u8bef",done:re()});case 15:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleFaceVerify",value:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(){var t,n,a,i=this;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=this.state.scanFaceInfo,t.realName,t.pwd,n=t.user12306,a="/pages/train/face/face?userName=".concat(n,"&fromType=8"),this.navigateTo({url:a,callback:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(t){return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:setTimeout((function(){if(1!=t.certificationResultCode)return x.ZP.showModal({m:"\u4eba\u8138\u6838\u9a8c\u5931\u8d25",done:re});i.goCheckPage()}),500);case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()});case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"login12306Cb",value:function(){var e=(0,o.Z)((0,c.Z)().mark((function e(t){var n;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.login12306Name,this.setState({checkView:!1,loginPopVisible:!1}),this.userName=n,"1"===this.searchParams.get("froce12306Login")&&(this.pageUrl=this.pageUrl.replace("froce12306Login","")),e.abrupt("return",this.initPage(this.pageUrl));case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"render",value:function(){var e=this,t=this.state,n=t.url,a=t.wsg,i=t.canWebView,r=t.loginPopVisible,c=t.isCheckStuQua,o=t.isFaceVisible,s=t.scanFaceInfo,l=void 0===s?{}:s,u=t.checkView;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(m.View,{children:i?(0,j.jsx)(m.Block,{children:u?(0,j.jsxs)(m.Block,{children:[(0,j.jsx)(ee,{pageId:this.pageId,visible:r,loginName:"",action:"",isOrdinary:!1,textConfig:{subTitle:"\u5b66\u751f\u4f18\u60e0\u8d44\u8d28\u5ba1\u6838\u7684\u5b66\u751f\u672c\u4eba12306\u8d26\u53f7"},close:function(){e.setState({loginPopVisible:!1}),re()},done:function(t){e.login12306Cb(t)}}),(0,j.jsx)(m.View,{style:"position: fixed;width:100%;height:100%;",children:(0,j.jsx)(m.Image,{style:"width:100%;height:100%;",src:"https://images3.c-ctrip.com/train/2023-3/app-maipiao/6.15/jifenfenxiang2.0/img-bg.png"})}),c&&(0,j.jsx)(m.Block,{children:(0,j.jsx)(A,{visible:o,realName:l.realName,jumpCheckPage:oe,jumpServicePage:ce,faceVerify:function(){return e.handleFaceVerify()},close:function(){e.setState({isFaceVisible:!1})},closeCb:re})})]}):n?(0,j.jsx)(m.WebView,{src:n,onMessage:function(t){return e.onWebMessage(t)},onError:function(t){return e.showUrlError(t)}}):(0,j.jsx)(m.View,{children:a})}):(0,j.jsx)(m.Block,{children:(0,j.jsx)(m.View,{children:"\u4eb2\u7231\u7684\u7528\u6237\uff0c\u60a8\u7684APP\u7248\u672c\u592a\u4f4e\u5566\uff0c\u5feb\u53bb\u5347\u7ea7APP\u5427"})})}),(0,j.jsx)(m.View,{className:"view-check",onAnimationEnd:function(){return e.viewReadyHandle()}})]})}}]),n}(b.Z),le=se,ue={};le.enableShareAppMessage=!0;Page((0,a.createPageConfig)(le,"pages/trainActivity/twebview/index",{root:{cn:[]}},ue||{}))},79181:function(e){e.exports=require("../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../cwx/cwx")},65238:function(e){e.exports=require("../../../cwx/ext/global")}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[6498,2107,1216,8592],(function(){return t(29340)}));e.O()}]);
//# sourceMappingURL=index.js.map