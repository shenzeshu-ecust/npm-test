{"version":3,"file":"pages/orderttd/detail/modules/nps/nps-score.js","mappings":"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","sources":["webpack://tarobaseproject/pages_orderttd_detail_modules_nps_nps-score.js"],"sourcesContent":["\"use strict\";\n(wx[\"tripTaroGlobal30\"] = wx[\"tripTaroGlobal30\"] || []).push([[9952],{\n\n/***/ 94057:\n/***/ (function(__unused_webpack_module, exports) {\n\nvar __webpack_unused_export__;\n\n\n__webpack_unused_export__ = true;\n__webpack_unused_export__ = void 0;\nvar _default = Component({\n  properties: {\n    // 外部传参\n    title: {\n      type: String,\n      value: ''\n    },\n    positiveDesc: {\n      type: String,\n      value: ''\n    },\n    negativeDesc: {\n      type: String,\n      value: ''\n    },\n    env: {\n      type: String,\n      value: 'fat'\n    },\n    bizId: {\n      type: String,\n      value: ''\n    },\n    bizBindType: {\n      type: String,\n      value: ''\n    },\n    bizBindId: {\n      type: String,\n      value: ''\n    },\n    pageId: {\n      type: String,\n      value: ''\n    },\n    auth: {\n      type: String,\n      value: ''\n    }\n  },\n  data: {\n    // 内部State\n    show: false,\n    scores: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],\n    selectedScore: -1,\n    commentPlaceholder: '',\n    comment: ''\n  },\n  lifetimes: {\n    attached: function attached() {\n      var _this = this;\n      var _this$properties = this.properties,\n        env = _this$properties.env,\n        bindId = _this$properties.bizBindId,\n        bindType = _this$properties.bizBindType,\n        bizId = _this$properties.bizId,\n        auth = _this$properties.auth;\n      // wx.showLoading();\n      var data = {\n        bindType: bindType,\n        bindId: bindId,\n        bizId: bizId,\n        head: {\n          auth: auth || ''\n        }\n      };\n      doRequest({\n        url: H5ApiMap[env] + \"/18852/canDoSurvey\",\n        data: data,\n        success: function success(res) {\n          // wx.hideLoading();\n\n          if (res && res.data && res.data.canDoSurvey) {\n            _this.setData({\n              show: true\n            });\n          }\n        },\n        fail: function fail(err) {\n          console.log(err);\n          // wx.hideLoading();\n        }\n      });\n    }\n  },\n\n  methods: {\n    selectScore: function selectScore(event) {\n      var score = event.currentTarget.dataset.score;\n      if (this.data.selectedScore === score) {\n        return;\n      }\n      var _this$properties2 = this.properties,\n        positiveDesc = _this$properties2.positiveDesc,\n        negativeDesc = _this$properties2.negativeDesc;\n      this.setData({\n        selectedScore: event.currentTarget.dataset.score,\n        commentPlaceholder: score > 7 ? positiveDesc : negativeDesc\n      });\n    },\n    updateComment: function updateComment(event) {\n      this.setData({\n        comment: event.detail.value\n      });\n    },\n    submit: function submit() {\n      var _this2 = this;\n      var _this$properties3 = this.properties,\n        env = _this$properties3.env,\n        bindId = _this$properties3.bizBindId,\n        bindType = _this$properties3.bizBindType,\n        bizId = _this$properties3.bizId,\n        pageId = _this$properties3.pageId,\n        auth = _this$properties3.auth;\n      var _this$data = this.data,\n        selectedScore = _this$data.selectedScore,\n        comment = _this$data.comment,\n        commentPlaceholder = _this$data.commentPlaceholder;\n      if (requesting) return;\n      if (selectedScore < 0) return;\n      // wx.showLoading();\n      requesting = true;\n      var data = {\n        surveyInfo: {\n          bizId: bizId,\n          bindType: bindType,\n          bindId: bindId,\n          pageId: pageId,\n          items: [{\n            configId: 1,\n            title: commentPlaceholder,\n            scoreGrade: selectedScore,\n            content: comment\n          }]\n        },\n        head: {\n          auth: auth || ''\n        }\n      };\n      doRequest({\n        url: H5ApiMap[env] + \"/18852/submitSurvey\",\n        data: data,\n        success: function success(res) {\n          // wx.hideLoading();\n          requesting = false;\n          if (res && res.data && res.data.ret && res.data.ret.code === 0) {\n            wx.showToast({\n              icon: 'none',\n              title: '提交成功，感谢您的反馈！',\n              mask: true\n            }); // 调用成功, 隐藏打分组件\n\n            setTimeout(function () {\n              return _this2.setData({\n                show: false\n              });\n            }, 1500);\n          } else {\n            var errMsg = '提交失败，请稍后再试！';\n            if (res && res.data && res.data.ret && res.data.ret.msg) {\n              errMsg = res.data.ret.msg;\n            }\n            wx.showToast({\n              icon: 'none',\n              title: errMsg,\n              mask: true\n            });\n          }\n        },\n        fail: function fail() {\n          // wx.hideLoading();\n          requesting = false;\n          wx.showToast({\n            icon: 'none',\n            title: '提交失败，请稍后再试！',\n            mask: true\n          });\n        }\n      });\n    }\n  }\n});\n__webpack_unused_export__ = _default;\nvar requesting = false;\nvar H5ApiMap = {\n  fat: 'https://gateway.m.fws.qa.nt.ctripcorp.com/restapi/soa2',\n  uat: 'https://gateway.m.uat.qa.nt.ctripcorp.com/restapi/soa2',\n  prod: 'https://m.ctrip.com/restapi/soa2',\n  prd: 'https://m.ctrip.com/restapi/soa2'\n};\nfunction doRequest(_ref) {\n  var url = _ref.url,\n    data = _ref.data,\n    success = _ref.success,\n    fail = _ref.fail;\n  wx.request({\n    url: url,\n    method: 'POST',\n    data: data,\n    success: success,\n    fail: fail\n  });\n}\n\n/***/ })\n\n},\n/******/ function(__webpack_require__) { // webpackRuntimeModules\n/******/ var __webpack_exec__ = function(moduleId) { return __webpack_require__(__webpack_require__.s = moduleId); }\n/******/ var __webpack_exports__ = (__webpack_exec__(94057));\n/******/ }\n]);"],"names":["wx","push","__unused_webpack_module","exports","_default","Component","properties","title","type","String","value","positiveDesc","negativeDesc","env","bizId","bizBindType","bizBindId","pageId","auth","data","show","scores","selectedScore","commentPlaceholder","comment","lifetimes","attached","_this","this","_this$properties","bindId","bindType","head","doRequest","url","H5ApiMap","success","res","canDoSurvey","setData","fail","err","console","log","methods","selectScore","event","score","currentTarget","dataset","_this$properties2","updateComment","detail","submit","_this2","_this$properties3","_this$data","requesting","surveyInfo","items","configId","scoreGrade","content","ret","code","showToast","icon","mask","setTimeout","errMsg","msg","fat","uat","prod","prd","_ref","request","method","__webpack_require__","__webpack_exec__","moduleId","s"],"sourceRoot":""}