/*! For license information please see index.js.LICENSE.txt */
(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[7736],{53723:function(e,t,n){var r=n(32180)["navigator"],a=n(32180)["window"],o=n(32180)["document"],i=n(32180)["requestAnimationFrame"],s=n(66371)["default"];e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==s(e)&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=125)}([function(e,t){e.exports=n(90201)},function(e,t){e.exports=n(71515)},function(e,t,n){"use strict";(function(e){n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l}));var r,a,o=n(7),i=void 0!==e&&"test"===(null===(r=null==e?void 0:e.env)||void 0===r?void 0:r.NODE_ENV),s=void 0!==e&&"development"===(null===(a=null==e?void 0:e.env)||void 0===a?void 0:a.NODE_ENV),c=function(e){return null==e||"object"===Object(o.a)(e)&&0===Object.keys(e).length||"string"==typeof e&&0===e.trim().length},l=function(e){var t;return c(e)?"":(null===(t=null==e?void 0:e.find((function(e){return"RootMessageId"===e.Id})))||void 0===t?void 0:t.Value)||""}}).call(this,n(36))},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(37),t)},function(e,t,n){"use strict";n.d(t,"PlatformContext",(function(){return a})),n.d(t,"TourContext",(function(){return o})),n.d(t,"setupTourContext",(function(){return i}));var r=n(3),a=(n(8),Object(r.createModelContext)({}),Object(r.createModelContext)({})),o=(Object(r.createModelContext)({}),Object(r.createModelContext)(null)),i=function(){return Object(r.setupContext)(o)}},function(e,t,n){"use strict";var r=n(7);t.a={isEmpty:function(e){return null==e||"string"==typeof e&&0===e.trim().length||("[object Array]"===Object.prototype.toString.call(e)?0===e.length:"[object Date]"!==Object.prototype.toString.call(e)&&"[object Function]"!==Object.prototype.toString.call(e)&&"object"===Object(r.a)(e)&&0===Object.keys(e).length)},cloneDeep:function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new WeakMap;if("object"!==Object(r.a)(t)||null===t)return t;if(n.has(t))return n.get(t);n.set(t,t);var a=Array.isArray(t)?[]:{};for(var o in t)t.hasOwnProperty(o)&&(a[o]=e(t[o],n));return a}}},function(e,t){e.exports=n(92954)},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)})(e)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";var r=n(31).default,a=n(32).default,o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||o(t,e,n)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(19),l=s(n(94)),u=s(n(95)),d=s(n(96)),f=s(n(97)),p=function(){function e(t,n){r(this,e),this.config=t,this.sender=f.default(t,n)}return a(e,[{key:"logPageInfo",value:function(e){try{var t=l.default.checkPageInfo(e);if(t)return void d.default.warn("logPageInfo",t);var n=u.default.pageInfo(e);return this.sender.sendDevTrace(n),n}catch(e){if(this.config&&this.config.platform==c.PlatformType.test)return e;d.default.exception("logPageInfo",e)}}},{key:"logMessage",value:function(e){try{var t=l.default.checkMessage(e);if(t)return void d.default.warn("logMessage",t);var n=u.default.message(e);return this.sender.sendDevTrace(n),n}catch(e){if(this.config&&this.config.platform==c.PlatformType.test)return e;d.default.exception("logMessage",e)}}},{key:"logActionInfo",value:function(e){try{var t=l.default.checkActionInfo(e);if(t)return void d.default.warn("logActionInfo",t);var n=u.default.actionInfo(e);return this.sender.sendDevTrace(n),n}catch(e){if(this.config&&this.config.platform==c.PlatformType.test)return e;d.default.exception("logActionInfo",e)}}},{key:"logError",value:function(e){try{var t=l.default.checkError(e);if(t)return void d.default.warn("logError",t);var n=u.default.error(e);return this.sender.sendError(n),this.config.platform!=c.PlatformType.test&&d.default.error("logError",n),n}catch(e){if(this.config&&this.config.platform==c.PlatformType.test)return e;d.default.exception("logError",e)}}}]),e}();t.default=p,i(n(19),t)},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(75),t)},function(e,t){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(20),a=n(24);function o(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Object(a.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var r=n(11),a=function e(){for(var t=[],n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return a.forEach((function(n){if(n)if("string"!=typeof n){if("[object Object]"===Object.prototype.toString.call(n)){var a=Object.keys(n).filter((function(e){return!!n[e]}));t=t.concat(a)}Array.isArray(n)&&t.push(e.apply(void 0,Object(r.a)(n)))}else t.push(n)})),t.join(" ")}}).call(this,n(36))},function(e,t){e.exports=n(33675)},function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.MiniTypeEnum=t.SourceEnum=t.SaleChannel3Enum=t.SaleChannel2Enum=t.CTEnum=t.EnvEnum=t.ClientEnum=t.ComponentTypeEnum=void 0,(r=t.ComponentTypeEnum||(t.ComponentTypeEnum={}))[r.H5=1]="H5",r[r.PC=2]="PC",r[r.RN=3]="RN",r[r.MiniProgram=4]="MiniProgram",r[r.Taro=5]="Taro",function(e){e[e.PC=0]="PC",e[e.NATIVE=1]="NATIVE",e[e.H5=2]="H5",e[e.MiniProgram=3]="MiniProgram"}(t.ClientEnum||(t.ClientEnum={})),function(e){e.Fat="fat",e.Uat="uat",e.Prod="prod"}(t.EnvEnum||(t.EnvEnum={})),function(e){e[e.CTRIP=0]="CTRIP",e[e.TRIP=1]="TRIP"}(t.CTEnum||(t.CTEnum={})),function(e){e[e.Ctrip_Online=2]="Ctrip_Online",e[e.Ctrip_App=5]="Ctrip_App",e[e.Ctrip_H5=7]="Ctrip_H5",e[e.Ctrip_Mina=21]="Ctrip_Mina",e[e.Trip_Online=24]="Trip_Online",e[e.Trip_App=25]="Trip_App",e[e.Trip_H5=26]="Trip_H5",e[e.Offline=3]="Offline",e[e.CompanyShop=110]="CompanyShop",e[e.BestonShop=111]="BestonShop",e[e.QunarShop=112]="QunarShop",e[e.LvJing=113]="LvJing"}(t.SaleChannel2Enum||(t.SaleChannel2Enum={})),function(e){e[e.Ctrip_Online=114]="Ctrip_Online",e[e.Ctrip_App=115]="Ctrip_App",e[e.Ctrip_H5=116]="Ctrip_H5",e[e.Ctrip_Mina=117]="Ctrip_Mina",e[e.Trip_Online=118]="Trip_Online",e[e.Trip_App=119]="Trip_App",e[e.Trip_H5=120]="Trip_H5",e[e.Offline=121]="Offline",e[e.CompanyShop=502]="CompanyShop",e[e.BestonShop=503]="BestonShop",e[e.QunarShop=504]="QunarShop",e[e.LvJing=505]="LvJing"}(t.SaleChannel3Enum||(t.SaleChannel3Enum={})),function(e){e.TICKET="TICKET",e.THINGS_TODO="THINGS_TODO",e.TOUR="TOUR",e.CRUISE="CRUISE",e.CUS="CUS"}(t.SourceEnum||(t.SourceEnum={})),function(e){e.MINI_WECHAT="MINI_WECHAT",e.ALI_PAY="ALI_PAY",e.BYTE_DANCE="BYTE_DANCE",e.BAIDU="BAIDU",e.QQ="QQ"}(t.MiniTypeEnum||(t.MiniTypeEnum={})),o(n(85),t)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(25);function a(e,t,n){return(t=Object(r.a)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupPlatformInfo=t.setupEnvContext=t.EnvContext=t.getPlatform=t.platforms=void 0;var o=n(3);t.platforms=["NodeJS","Browser","CtripApp","TripApp","ReactNative","MicroMessenger","BestonApp"],t.getPlatform=function(e){if(e.platform)return e.platform;if("undefined"!=typeof r&&"ReactNative"===r.product)return"ReactNative";if("undefined"==typeof a||void 0===a.document)return"NodeJS";var t=function(e){return e.req?e.req.headers["user-agent"]?e.req.headers["user-agent"]:"":"undefined"!=typeof a?a.navigator.userAgent:""}(e);return/MicroMessenger/i.test(t)?"MicroMessenger":/Trip.com_CtripWireless/i.test(t)?"TripApp":/ctripwireless/i.test(t)?"CtripApp":/ctripBestonWireless/i.test(t)?"BestonApp":"Browser"},t.EnvContext=o.createModelContext({env:"prod"}),t.setupEnvContext=function(){return o.setupContext(t.EnvContext)},t.setupPlatformInfo=function(){for(var e=o.setupContext(t.EnvContext),n=t.getPlatform(e),r={},a=0;a<t.platforms.length;a++){var i=t.platforms[a];r[i]=i===n}return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorType=t.ActionType=t.RoleType=t.PlatformType=void 0,function(e){e.web="web",e.crn="crn",e.taro="taro",e.test="test"}(t.PlatformType||(t.PlatformType={})),function(e){e.usr="usr",e.sys="sys"}(t.RoleType||(t.RoleType={})),function(e){e.click="click",e.change="change",e.show="show"}(t.ActionType||(t.ActionType={})),function(e){e.Network_Fail="Network_Fail",e.Request_Abort="Request_Abort",e.Ack_Fail="Ack_Fail"}(t.ErrorType||(t.ErrorType={}))},function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",(function(){return r}))},function(e,t,n){var r=n(59),a=n(60),o=n(26),i=n(61);e.exports=function(e,t){return r(e)||a(e,t)||o(e,t)||i()},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)})(e)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"===("undefined"==typeof a?"undefined":n(a))&&(r=a)}e.exports=r},function(e,t,n){(function(r){var o,i,s,c=n(10).default;!function(n,r){"object"==c(t)&&void 0!==e?r(t):(i=[t],void 0===(s="function"==typeof(o=r)?o.apply(t,i):o)||(e.exports=s))}(0,(function(e){"use strict";var t,n,o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},i=(function(e,t){function n(e,t){return void 0===t&&(t={}),o=function(){return o=this,s=function(n){switch(n.label){case 0:return e&&"object"==c(e)?"function"==typeof e.clone?[4,e.clone().json()]:[3,2]:(console.log("[perf_metric ERROR, wrong Response]"),[2]);case 1:e=n.sent(),n.label=2;case 2:if(!(e=e||{}).ResponseStatus)return[2];if("undefined"==typeof a)return[2];try{!function(e,t,n,r){"undefined"!=typeof a&&(r?r(n||"http_request_perf",t||0,e):(a.__bfi=a.__bfi||[],a.__bfi.push(["_trackMetric",{name:"http_request_perf",value:t||0,tag:e}])))}((s=(o=(o=t)||{}).tag||{},d=(u=void 0===(l=(e||{}).ResponseStatus)?{}:l).Extension||[],f=u.Ack||"",p=(r(d,(function(e){return"CLOGGING_TRACE_ID"===e.Id}))||{}).Value,m=(r(d,(function(e){return"RootMessageId"===e.Id}))||{}).Value,h="success"===f.toLowerCase(),v=h?200:-1,g=o.url?o.url:"",i({framework:o.framework||"perf_metric",success:h||!0,statusCode:v||200,RootMessageId:m||"",CLOGGING_TRACE_ID:p||"",info:"",url:g||""},s)),t.value||0,t.name||"http_request_perf",t.logMetric)}catch(n){console.log("[perf-metric error] "+n)}return[2]}var o,s,l,u,d,f,p,m,h,v,g},p={label:0,sent:function(){if(1&d[0])throw d[1];return d[1]},trys:[],ops:[]},f={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function n(e){return function(t){return function(e){if(l)throw new TypeError("Generator is already executing.");for(;p;)try{if(l=1,u&&(d=2&e[0]?u.return:e[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,e[1])).done)return d;switch(u=0,d&&(e=[2&e[0],d.value]),e[0]){case 0:case 1:d=e;break;case 4:return p.label++,{value:e[1],done:!1};case 5:p.label++,u=e[1],e=[0];continue;case 7:e=p.ops.pop(),p.trys.pop();continue;default:if(!(d=0<(d=p.trys).length&&d[d.length-1])&&(6===e[0]||2===e[0])){p=0;continue}if(3===e[0]&&(!d||e[1]>d[0]&&e[1]<d[3])){p.label=e[1];break}if(6===e[0]&&p.label<d[1]){p.label=d[1],d=e;break}if(d&&p.label<d[2]){p.label=d[2],p.ops.push(e);break}d[2]&&p.ops.pop(),p.trys.pop();continue}e=s.call(o,p)}catch(t){e=[6,t],u=0}finally{l=d=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}var o,s,l,u,d,f,p},new(n=(n=void 0)||Promise)((function(e,t){function r(e){try{i(o.next(e))}catch(e){t(e)}}function a(e){try{i(o.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new n((function(e){e(t.value)})).then(r,a)}i((o=o.apply(void 0,[])).next())}));var n,o}function r(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t(r))return r}}var o,i;i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},(o=t).createHttpPerfMetric=function(e){var t=e.key||"http_request_perf",r=e.name||"",a=e.type||"api",o=e.framework||"perf_metric",i=t,s={type:a},c=Date.now();return function(e){var t=e.data,a=e.logMetric,l=Date.now()-c;n(t,{name:i,url:r,value:l,tag:s,framework:o,logMetric:a})}},o.createMetric=function(e){var t=e.key,n=e.apiName,r=e.type,o={name:t=t||"http_request_perf",value:0,tag:{stage:"",errorStack:"",type:r=r||"api",subeventid:n}},i=Date.now();return function(e){var t=(e=e||{}).status,n=void 0===t?"":t,r=e.errorStack,s=void 0===r?"":r;o.value=Date.now()-i,o.tag.stage=n||"succ",o.tag.errorStack=s,"undefined"!=typeof a&&void 0===a.__bfi&&(a.__bfi=[]),"undefined"!=typeof a&&a.__bfi.push(["_trackMetric",o])}},o.default=n,Object.defineProperty(o,"__esModule",{value:!0})}(t={exports:{}},t.exports),t.exports);function s(e){return s=function(){var t,n,i,s,f,m,h,v,g,y;return function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=0<(a=i.trys).length&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(_){switch(_.label){case 0:t=o(o(o({},d),e),{params:o(o({},d.params),e.params),headers:o(o({},d.headers),e.headers)}),n=p(t),i=e.fetch?e.fetch:u?r.fetch:a.fetch,s=t.params,delete t.params,delete t.domains,delete t.env,delete t.fetch,delete t.needVirtualPath,delete t.path,delete t.subEnv,f=o(o({},s),t.extraBody);try{m=t.needStringifyBody?JSON.stringify(f):f}catch(_){console.log(_),m={}}if(h=i(n,o(o({method:"POST",body:m},t),{credentials:u?void 0:t.credentials})),t.needPerfMetric)try{v=l({name:n,framework:"graphql-client"})}catch(_){v=function(){}}return"number"!=typeof t.timeout?[3,2]:(g=e.timeoutErrorFormatter,y="function"==typeof g?g({url:n,options:t}):g,[4,function(e,t,n){void 0===t&&(t=0);var r=new Promise((function(e,r){setTimeout((function(){return r(new Error(n||"Timeout Error:"+t+"ms"))}),t)}));return Promise.race([e,r])}(h,e.timeout,y)]);case 1:return h=_.sent(),[3,4];case 2:return[4,h];case 3:h=_.sent(),_.label=4;case 4:try{if(h instanceof Error||"string"==typeof h)throw new Error;(h.clone?h.clone().json():Promise.resolve(h)).then((function(n){var r=(n||{}).extensions,a=(void 0===r?{}:r).SoaResponseStatus;"object"==c(a)&&t.needPerfMetric&&v&&v({data:a,logMetric:e.logMetric})})).catch((function(e){console.log(e)}))}catch(_){console.log(_)}return[2,h]}}))},new(i=(i=n=t=void 0)||Promise)((function(e,r){function a(e){try{c(s.next(e))}catch(e){r(e)}}function o(e){try{c(s.throw(e))}catch(e){r(e)}}function c(t){t.done?e(t.value):new i((function(e){e(t.value)})).then(a,o)}c((s=s.apply(t,n||[])).next())}));var t,n,i,s}(n=i)&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")&&n.default;var l=i.createHttpPerfMetric,u=(i.createMetric,"undefined"==typeof a),d={path:"",env:"prod",credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json"},needVirtualPath:!0,needStringifyBody:!0,params:{query:""},needPerfMetric:!0},f=/^\s*(?:[Q|q]uery|[M|m]utation)\s+([\w]+)/;function p(e){var t=o(o(o({},d),e),{params:o(o({},d.params),e.params),headers:o(o({},d.headers),e.headers)});return m(t,h(t))}function m(e,t){if(e.needVirtualPath){var n,r=e.params.queryName,a=e.params.query.match(f),o="";if(a&&0<a.length&&(o=a[1]),n=r||o){var i=t.split("?"),s=i[0],c=i.slice(1);t=s+"/"+n+(0<c.length?"?"+c.join("?"):"")}}return t}function h(e){var t="";if(e.path.startsWith("http")||e.path.startsWith("https")||e.path.startsWith("//"))t=e.path;else if(e.domains){var n=u?"server":"client";t=e.domains[n][e.env]+e.path}return t.startsWith("//")&&u&&(t="http:"+t),"fat"===e.env&&e.subEnv&&/fat(\d+)/.test(e.subEnv)&&(t=t.replace("fws.qa",e.subEnv+".qa")),t}function v(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r="",a=0;a<e.length;a++)r+=e[a],r+=t[a]||"";return r}var g={load:s,gql:v};e.load=s,e.getUrl=p,e.appendVirtualPathToUrl=m,e.getUrlWithoutVirtualPath=h,e.gql=v,e.default=g,Object.defineProperty(e,"__esModule",{value:!0})}))}).call(this,n(22))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(20);function a(e,t){if(e){if("string"==typeof e)return Object(r.a)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(e,t):void 0}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(7);function a(e){var t=function(e,t){if("object"!==Object(r.a)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==Object(r.a)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Object(r.a)(t)?t:String(t)}},function(e,t,n){var r=n(38);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(10).default;function a(){"use strict";e.exports=a=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var a=t&&t.prototype instanceof h?t:h,o=Object.create(a.prototype),s=new N(r||[]);return i(o,"_invoke",{value:k(e,n,s)}),o}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var m={};function h(){}function v(){}function g(){}var y={};d(y,c,(function(){return this}));var _=Object.getPrototypeOf,b=_&&_(_(E([])));b&&b!==n&&o.call(b,c)&&(y=b);var I=g.prototype=h.prototype=Object.create(y);function x(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){var n;i(this,"_invoke",{value:function(a,i){function s(){return new t((function(n,s){!function n(a,i,s,c){var l=p(e[a],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==r(d)&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,c)}))}c(l.arg)}(a,i,n,s)}))}return n=n?n.then(s,s):s()}})}function k(e,t,n){var r="suspendedStart";return function(a,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw o;return P()}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var s=S(i,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=p(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function S(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=p(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,m;var o=a.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function E(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:P}}function P(){return{value:void 0,done:!0}}return v.prototype=g,i(I,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:v,configurable:!0}),v.displayName=d(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,d(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},x(T.prototype),d(T.prototype,l,(function(){return this})),t.AsyncIterator=T,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new T(f(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},x(I),d(I,u,"Generator"),d(I,c,(function(){return this})),d(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=E,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;w(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:E(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),m}},t}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(26);e.exports=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var i=e.apply(t,r);function s(e){n(i,a,o,s,c,"next",e)}function c(e){n(i,a,o,s,c,"throw",e)}s(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(39);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(39);function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,r(a.key),a)}}e.exports=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r,a,o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},c=this&&this.__awaiter||function(e,t,n,r){return new(n=n||Promise)((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):((t=e.value)instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){var c=[i,s];if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,(c=a?[2&c[0],a.value]:c)[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=0<(a=o.trys).length&&a[a.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3]))o.label=c[1];else if(6===c[0]&&o.label<a[1])o.label=a[1],a=c;else{if(!(a&&o.label<a[2])){a[2]&&o.ops.pop(),o.trys.pop();continue}o.label=a[2],o.ops.push(c)}}c=t.call(e,o)}catch(s){c=[6,s],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},d=(Object.defineProperty(t,"__esModule",{value:!0}),t.getSystemInfo=t.jumpToUrl=t.__global=t.cwx=t.onLogin=t.getEnvType=t.chunk=t.getAuth=t.mapEnvToMiniType=t.miniRequest=t.BaseStorage=t.ClientUtil=t.COMPONENT_VERSION=void 0,s(n(6))),f=n(14),p=n(35);t.cwx=r,t.__global=a;try{var m=n(13);t.cwx=r=m&&m.cwx,t.__global=a=m&&m.__global}catch(e){console.log("%c "+e,"color:red;")}var h=null;try{h=n(89).compVerison}catch(e){console.error("\u8bfb\u53d6\u7248\u672c\u53f7\u5f02\u5e38!")}t.COMPONENT_VERSION=h,t.getAuth=function(){var e="";try{e=d.default.getStorageSync("auth")}catch(e){}return e},t.mapEnvToMiniType=function(){switch(d.default.getEnv()){case d.ENV_TYPE.WEAPP:return p.MiniTypeEnum.MINI_WECHAT;case d.ENV_TYPE.SWAN:return p.MiniTypeEnum.BAIDU;case d.ENV_TYPE.TT:return p.MiniTypeEnum.BYTE_DANCE;case d.ENV_TYPE.ALIPAY:return p.MiniTypeEnum.ALI_PAY;case d.ENV_TYPE.QQ:return p.MiniTypeEnum.QQ;default:return p.MiniTypeEnum.MINI_WECHAT}},t.chunk=function(e,t){if(e.length<=0||t<=0)return e;for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n},t.getEnvType=function(){var e,t=d.default.getCurrentInstance(),n=f.EnvEnum.Prod;!a||(e=a.env)!==f.EnvEnum.Fat&&e!==f.EnvEnum.Uat||(n=e);try{n=t.page.$taroParams.testenv||n}catch(e){}return n},t.onLogin=function(e,t,n){r&&r.user.login({param:{},callback:function(e){e&&"0"===e.ReturnCode?t&&t():n&&n()}})},t.jumpToUrl=function(e){var t;e&&(function(e){return null!==e.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)}(e)?(t={url:encodeURIComponent(e),needLogin:!1,doRefreshWhileBack:!1,hideShareMenu:!1,isNavigate:!0,loginErrorUrl:e},r&&r.navigateTo({url:"/cwx/component/cwebview/cwebview?data="+JSON.stringify(t)})):d.default.navigateTo({url:e}))},t.getSystemInfo=function(){return c(this,void 0,void 0,(function(){return l(this,(function(e){return[2,d.default.getSystemInfo()]}))}))};var v=u(n(90)),g=(t.ClientUtil=v.default,u(n(91))),y=(t.BaseStorage=g.default,n(92));Object.defineProperty(t,"miniRequest",{enumerable:!0,get:function(){return y.miniRequest}})},function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(14),t)},function(e,t){var n,r,a=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var c,l=[],u=!1,d=-1;function f(){u&&c&&(u=!1,c.length?l=c.concat(l):d=-1,l.length&&p())}function p(){if(!u){var e=s(f);u=!0;for(var t=l.length;t;){for(c=l,l=[];++d<t;)c&&c[d].run();d=-1,t=l.length}c=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function h(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new m(e,t)),1!==l.length||u||s(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=h,a.addListener=h,a.once=h,a.off=h,a.removeListener=h,a.removeAllListeners=h,a.emit=h,a.prependListener=h,a.prependOnceListener=h,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,t,n){"use strict";var o=n(21).default,i=n(27).default,s=n(28).default,c=n(29).default,l=n(62).default,u=n(30).default,d=n(10).default;Object.defineProperty(t,"__esModule",{value:!0});var f=n(126),p=n(64),m=n(65),h=n(74);function v(e){return e&&"object"===d(e)&&"default"in e?e:{default:e}}var g=v(m),y=v(h),_=function(e){if("object"!==d(e)||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},b=function(e,t){if(e===t)return!0;if("object"!==d(e)||null===e||"object"!==d(t)||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var a=0;a<n.length;a++)if(!t.hasOwnProperty(n[a])||e[n[a]]!==t[n[a]])return!1;return!0},I=Symbol("@pure-model/context"),x=function(e,t){var n=e[I];return n&&n.hasOwnProperty(t)?n[t]:null},T=0,k=function(e){var t="@pure-model/context/".concat(T++),n=function(e){return u({},t,{value:e})};return{id:t,initialValue:e,impl:n,create:function(e){return u({},I,n(e))}}},S=function(e){var t=e,n={},r=function(r){n[r]=function(){var n=t[r];return"function"!=typeof n&&(n=e[r]),n.apply(void 0,arguments)}};for(var a in e)r(a);return{run:function(e,n){var r=t;try{return t=null!=n?n:t,e()}finally{t=r}},hooks:n}}({setupStore:function(){throw new Error("setupStore can't not be called after initializing")},setupContext:function(){throw new Error("setupContext can't not be called after initializing")},setupStartCallback:function(){throw new Error("setupStartCallback can't not be called after initializing")},setupFinishCallback:function(){throw new Error("setupFinishCallback can't not be called after initializing")},setupPreloadCallback:function(){throw new Error("setupPreloadCallback can't not be called after initializing")},setupModel:function(){throw new Error("setupModel can't not be called after initializing")}}),C=S.run,w=S.hooks,N=w.setupStore,E=w.setupContext,P=w.setupStartCallback,j=w.setupFinishCallback,O=w.setupPreloadCallback,D=w.setupModel,R=function(e){var t=e.reducers,n=e.initialState,r=e.preloadedState,a=A(e.devtools,e.name,e.logger),o=f.createStore((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,r=arguments.length>1?arguments[1]:void 0,a=r.type;if(!t.hasOwnProperty(a))return e;var o=t[a],i=o(e,r.payload);return i}),r,a);return{store:o,actions:M(t,o.dispatch)}},A=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e&&"object"===("undefined"==typeof a?"undefined":d(a))&&a.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?a.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({name:t}):f.compose,o=n?r(f.applyMiddleware(p.createLogger())):r();return o},M=function(e,t){var n={},r=function(r){e[r],n[r]=function(e){t({type:r,payload:e})}};for(var a in e)r(a);return n},V=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];t.push(r())}return t},L=function(){var e=!1,t=!1,n=!1,r=[],a=[],o=[],i=null;return{preload:function(){if(i)return i;if(e||!o.length)return e=!0,Promise.resolve();var t=o;return o=[],i=Promise.all(V(t)).then((function(){})),e=!0,i},addPreloadCallback:function(t){if(e)throw new Error("Can't add preload callback after preloading");o.includes(t)||o.push(t)},isPreloaded:function(){return e},start:function(){if(!e)throw new Error("Expected calling .preload() before .start()");if(!t){t=!0;var n=r;r=[],V(n)}},addStartCallback:function(t){if(e)throw new Error("Can't add start callback after preloading");r.includes(t)||r.push(t)},isStarted:function(){return t},finish:function(){if(!t)throw new Error("Expected calling .start() before .finish()");if(!n){n=!0;var e=a;a=[],V(e)}},addFinishCallback:function(t){if(e)throw new Error("Can't add finish callback after preloading");a.includes(t)||a.push(t)},isFinished:function(){return n},clearPreloadCallbackList:function(){e=!0,o=[]}}},B=function(){var e=new WeakMap,t=function(e){return"initializer"in e?e.initializer:e},n=function(n){return e.get(t(n))},r={get:n,set:function(n,r){e.set(t(n),r)},getModel:function(a){var o=t(a),i=n(o);if(i){if(i.model)return i.model;var s=U(o,{preloadedState:i.preloadedState,context:i.context,container:r});return i.model=s,s}var c=U(o,{container:r});return e.set(o,{model:c}),c}};return r},U=function(e){var t,n,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=null!==(t=a.container)&&void 0!==t?t:B(),u=o.get(e);if(u){if(u.model)return u.model;a=l(l({},a),{},{context:null!==(n=u.context)&&void 0!==n?n:a.context,preloadedState:null!==(r=u.preloadedState)&&void 0!==r?r:a.preloadedState})}var d=L(),f=new Set,p=function(e){var t=o.getModel(e);return f.add(t),t},m=function(e){if(a.context){var t=x(a.context,e.id);if(t)return t.value}return e.initialValue},h=!1,v=function(t){if(h)throw new Error("Expected calling setupStore only once in initializer: ".concat(e.toString()));return h=!0,R(l(l({devtools:!0},t),{},{preloadedState:a.preloadedState}))},g={setupStore:v,setupContext:m,setupPreloadCallback:d.addPreloadCallback,setupStartCallback:d.addStartCallback,setupFinishCallback:d.addFinishCallback,setupModel:p},y=C((function(){var t=e();if(!t)throw new Error("Expected initializer returning { store, actions }, but got ".concat(t));var n=t.store,r=t.actions;if(!n)throw new Error("Expected initializer returning { store, actions }, but got a invalid store: ".concat(n));if(!r)throw new Error("Expected initializer returning { store, actions }, but got a invalid actions: ".concat(r));return{store:n,actions:r}}),g);void 0!==a.preloadedState&&d.clearPreloadCallbackList();var _=function(){var e=c(i().mark((function e(){var t,n,r,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=s(f);try{for(n.s();!(r=n.n()).done;)a=r.value,t.push(a)}catch(e){n.e(e)}finally{n.f()}return e.next=5,Promise.all(t.map((function(e){return e.preload()})));case 5:return e.abrupt("return",d.preload());case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=l(l({},y),{},{initializer:e,preload:_,start:d.start,finish:d.finish,addPreloadCallback:d.addPreloadCallback,addStartCallback:d.addStartCallback,addFinishCallback:d.addFinishCallback,isPreloaded:d.isPreloaded,isStarted:d.isStarted,isFinished:d.isFinished});return u?u.model=b:o.set(e,{model:b}),b},Z=["NodeJS","Browser","ReactNative"],F=function(e){return e.platform?e.platform:"undefined"!=typeof r&&"ReactNative"===r.product?"ReactNative":"undefined"==typeof a||void 0===a.document?"NodeJS":"Browser"},G=k({}),H=function(){return E(G)},q=function(){var e=E(G);return F(e)},K=function(){for(var e=q(),t={},n=0;n<Z.length;n++){var r=Z[n];t[r]=r===e}return t},z=function(){var e,t=H(),n=K(),r=null!==(e=t.fetch)&&void 0!==e?e:y.default;return function(e,a){return"string"==typeof e&&(e=function(e){return function(e){return e.startsWith("http")||e.startsWith("//")}(e)||e.startsWith("/")||(e="/"+e),e.startsWith("//")&&(e=n.NodeJS?"http:"+e:"undefined"!=typeof location&&"string"==typeof location.protocol?location.protocol+e:"https:"+e),e}(e)),a=function(e){var n=l({method:"GET",credentials:"include"},e);return t.req&&(n.headers=l(l({},n.headers),{},{cookie:t.req.headers.cookie||""})),n}(a),r(e,a)}};t.EnvContext=G,t.MODEL_CONTEXT=I,t.combineStore=function(e){var t={};for(var n in e)t[n]=e[n].getState();var r=N({devtools:!1,initialState:t,reducers:{update:function(e,t){var n=o(t,2),r=n[0],a=n[1];return l(l({},e),{},u({},r,a))}}}),a=r.store,i=r.actions,s=function(t){e[t].subscribe((function(){i.update([t,e[t].getState()])}))};for(var c in e)s(c);return a},t.createModelContext=k,t.createPureModel=U,t.createPureModelContainer=B,t.getModelContextValue=x,t.getPlatform=F,t.identity=function(e){return e},t.isThenable=function(e){return!(!e||"function"!=typeof e.then)},t.mergeModelContext=function(){for(var e=u({},I,{}),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0;a<n.length;a++)Object.assign(e[I],n[a][I]);return e},t.platforms=Z,t.select=function(e){if(!_(e))throw new Error("Expected subscribe(options) received { store, listener, selector?, compare? }, instead of ".concat(e));var t=e.model,n=e.selector,r=e.listener,a=e.compare,o=void 0===a?b:a,i=n(t.store.getState());return t.store.subscribe((function(){if(t.isStarted()){var e=t.store.getState(),a=n(e);o(a,i)?i=a:(i=a,r(a))}}))},t.setupContext=E,t.setupEnv=H,t.setupFetch=z,t.setupFinishCallback=j,t.setupGetJSON=function(){var e=z();return function(){var t=c(i().mark((function t(n,r,a){var o,s,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r&&(o=n.includes("?")?"&":"?",n+=o+g.default.stringify(r)),t.next=3,e(n,l(l({},a),{},{method:"GET"}));case 3:return s=t.sent,t.next=6,s.text();case 6:return c=t.sent,t.abrupt("return",JSON.parse(c));case 8:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},t.setupModel=D,t.setupPlatform=q,t.setupPlatformInfo=K,t.setupPostJSON=function(){var e=z();return function(){var t=c(i().mark((function t(n,r,a){var o,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(n,l(l({},a),{},{method:"POST",body:r?JSON.stringify(r):null,headers:l(l({},a&&a.headers),{},{"Content-Type":"application/json"})}));case 2:return o=t.sent,t.next=5,o.text();case 5:return s=t.sent,t.abrupt("return",JSON.parse(s));case 7:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},t.setupPreloadCallback=O,t.setupStartCallback=P,t.setupStore=N,t.setupUserAgent=function(){return function(e){return e.req?e.req.headers["user-agent"]?e.req.headers["user-agent"]:"":"undefined"!=typeof a?a.navigator.userAgent:""}(H())},t.shallowEqual=b,t.subscribe=function(e,t){return e.store.subscribe((function(){if(e.isStarted()){var n=e.store.getState();t(n)}}))}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(10).default,a=n(63);e.exports=function(e){var t=a(e,"string");return"symbol"===r(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";n.r(t),t.default=function(e,t){return t=t||{},new Promise((function(n,r){var a=new XMLHttpRequest,o=[],i=[],s={};for(var c in a.open(t.method||"get",e,!0),a.onload=function(){a.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(e,t,n){o.push(t=t.toLowerCase()),i.push([t,n]),s[t]=s[t]?s[t]+","+n:n})),n(function e(){return{ok:2==(a.status/100|0),statusText:a.statusText,status:a.status,url:a.responseURL,text:function(){return Promise.resolve(a.responseText)},json:function(){return Promise.resolve(a.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([a.response]))},clone:e,headers:{keys:function(){return o},entries:function(){return i},get:function(e){return s[e.toLowerCase()]},has:function(e){return e.toLowerCase()in s}}}}())},a.onerror=r,a.withCredentials="include"==t.credentials,t.headers)a.setRequestHeader(c,t.headers[c]);a.send(t.body||null)}))}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(78);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(33),a=n(79),o=n(80);e.exports=function(e){var t=a();return function(){var n,a=r(e);if(t){var i=r(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return o(this,n)}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(81),t)},function(e,t,n){"use strict";t.decode=t.parse=n(83),t.encode=t.stringify=n(84)},function(e,t,n){var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},u=(Object.defineProperty(t,"__esModule",{value:!0}),c(n(0))),d=n(14),f=l(n(88)),p=l(n(113)),m=function(e){function t(t){return(t=e.call(this,t)||this).state={hasError:!1},t.instance=u.createRef(),t.handleRefresh=t.handleRefresh.bind(t),t.triggerError=t.triggerError.bind(t),t}return a(t,e),t.getDerivedStateFromError=function(){return console.log("----getDerivedStateFromError"),{hasError:!0}},t.prototype.componentDidCatch=function(e,t){e={name:e.name,message:e.message,errorStack:e.stack,componentStack:t.componentStack,errorCode:d.ERRORCODE.JSERROR},console.warn("componentDidCatch",e),this.props.onError&&this.props.onError(e)},t.prototype.show=function(){},t.prototype.hide=function(){},t.prototype.handleRefresh=function(){this.setState({hasError:!1})},t.prototype.triggerError=function(){this.setState({hasError:!0})},t.prototype.render=function(){return this.state.hasError?u.createElement(p.default,o({},this.props,{handleRetry:this.handleRefresh})):u.createElement(f.default,o({},this.props,{ref:this.instance}))},t}(u.Component);t.default=m},function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},c=(Object.defineProperty(t,"__esModule",{value:!0}),t.convertComptType=t.getNumberSize=t.getUrlParams=t.getTimeZone=t.Inertia=t.ClientUtil=t.SharkUtil=t.BusinessUtil=t.HooksUtil=t.CommonUtil=void 0,n(8));function l(e,t){var n=Math.abs(e);return(e<0?"-":"")+"0".repeat((t-=(n+"").length)<0?0:t)+n}t.getTimeZone=function(){var e=(new Date).getTimezoneOffset(),t=Math.abs(e/60),n=Math.abs(e%60);return{desc:(0<e?"-":"+")+l(Math.floor(t),2)+":"+l(n,2),offset:e}},t.getUrlParams=function(e){return e=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),"undefined"!=typeof a&&null!=(e=a.location.search.substr(1).match(e))?unescape(e[2]):null},t.getNumberSize=function(e){try{var t;return"number"==typeof e?e:(t=Number(e.slice(0,-2)),isNaN(t)?0:t)}catch(e){return console.error("getNumberSize error",e),0}};var u=n(14);t.convertComptType=function(e){var t,n;switch(e){case u.ComponentTypeEnum.H5:t=u.ClientEnum.H5,n=c.PlatformType.web;break;case u.ComponentTypeEnum.PC:t=u.ClientEnum.PC,n=c.PlatformType.web;break;case u.ComponentTypeEnum.RN:t=u.ClientEnum.NATIVE,n=c.PlatformType.crn;break;case u.ComponentTypeEnum.MiniProgram:case u.ComponentTypeEnum.Taro:t=u.ClientEnum.MiniProgram,n=c.PlatformType.taro}return{client:t,platform:n}};var d=i(n(48)),f=(t.CommonUtil=d,i(n(49))),p=(t.HooksUtil=f,i(n(100))),m=(t.BusinessUtil=p,i(n(101))),h=(t.SharkUtil=m,s(n(102))),v=(t.ClientUtil=h.default,s(n(103)));t.Inertia=v.default},function(e,t){var n=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,a=e.length;n<r;n++,a++)e[a]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.filterObject=t.isObject=t.isEmpty=void 0,t.isEmpty=function(e){if(null==e)return!0;if("boolean"!=typeof e){if("number"==typeof e)return!e;if(e instanceof Error)return""===e.message;switch(Object.prototype.toString.call(e)){case"[object String]":case"[object Array]":return!e.length;case"[object File]":case"[object Map]":case"[object Set]":return!e.size;case"[object Object]":return!Object.keys(e).length}}return!1},t.isObject=function(e){return"[Object Object]"===Object.prototype.toString.call(e)},t.filterObject=function(e,t,r,a){try{t=n(n([],[void 0,null,NaN]),t||[]),r&&(t=t.filter((function(e){return!r.includes(e)})));var o,i={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&!t.includes(e[o])&&("function"==typeof a&&"number"==typeof e[o]?i[o]=a(e[o]):i[o]=e[o]);return i}catch(t){return console.error("filterObject error."),e}}},function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},a=(Object.defineProperty(t,"__esModule",{value:!0}),t.useUpdateEffect=t.useDeepEffect=void 0,n(0)),o=r(n(98));t.useDeepEffect=function(e,t){var n=a.useRef(t),r=a.useRef(!0);a.useEffect((function(){var a=n.current.every((function(e,n){return o.default(e,t[n])}));!r.current&&a||(e(),n.current=t),r.current=!1}),t)},t.useUpdateEffect=function(e,t){var n=a.useRef(!1);a.useEffect((function(){if(n.current)return e();n.current=!0}),t)}},function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},s=(Object.defineProperty(t,"__esModule",{value:!0}),t.SHARKKEY=t.CONST=void 0,o(n(51))),c=(t.CONST=s,i(n(105)));t.SHARKKEY=c.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.QUERY_NAME=t.KM_BLOCK_KEY=t.BFF_ERROR_TYPE=t.DEVTRACE_KEY=t.MAX_TRACE_PROPAGATION_COUNT=t.TTD_MKT_SECRET_KEY=t.COUPOON_VALIDATE_CODE=t.BFF_RESPONSECODE=t.ComponentInfo=t.UbtSourceKey=t.TIMEOUT_USECOUPON_ONSELECT=t.TIMEOUT_BFF_REQUEST=t.MAX_RETRY_TIME_VALIDATE_BEST=void 0;var r,a,o=n(14);t.MAX_RETRY_TIME_VALIDATE_BEST=1,t.TIMEOUT_BFF_REQUEST=1e4,t.TIMEOUT_USECOUPON_ONSELECT=5e3,t.UbtSourceKey=((r={})[o.SourceEnum.TICKET]="tkt",r[o.SourceEnum.THINGS_TODO]="act",r[o.SourceEnum.TOUR]="grp",r[o.SourceEnum.CRUISE]="cru",r),t.ComponentInfo={ORDER_USE_COUPON:{id:1,name:"order_usecodelist"},RECEIVEDETAIL:{id:2,name:"detail_claimcoupon"},POPCOUPON:{id:3,name:"popup"},SHOP_COUPON:{id:4,name:"storedetailreceive"},CROSS_COUPON:{id:5,name:"crocsscouponlist"}},t.BFF_RESPONSECODE={AUTH_FAILURE:4001},t.COUPOON_VALIDATE_CODE={NOT_AVAILABLE:5033},t.TTD_MKT_SECRET_KEY="EA2071AAE9211A2WANLEAMP422021",t.MAX_TRACE_PROPAGATION_COUNT=10,t.DEVTRACE_KEY={EXPOSURE:"vac_couponlist_exposure",CLICK:"vac_couponlist_click",POPUP_EXPOSURE:"vac_couponpopup_exposure",POP_CLICK:"vac_couponpopup_click",CROSS_BEFOREBOOKING_EXPOSURE:"vac_crocsscouponlist_beforebooking_exposure",CROSS_BEFOREBOOKING_CLICK:"vac_crocsscouponlist_beforebooking_click",CROSS_AFTERBOOKING_EXPOSURE:"vac_crocsscouponlist_afterbooking_exposure",CROSS_AFTERBOOKING_CLICK:"vac_crocsscouponlist_afterbooking_click",CROSS_ONLOAD:"ttd_marketing_crosscoupon_onload",CLAIMCOUPON_INVOKE_SHOW:"ttd_marketing_claimcoupon_invokeshow",CLAIMCOUPON_INVOKE_HIDE:"ttd_marketing_claimcoupon_invokehide",CLAIMCOUPON_CLOSE:"ttd_marketing_claimcoupon_close",USECOUPON_LOAD:"ttd_marketing_usecoupon_load",USECOUPON_CLOSE:"ttd_marketing_usecoupon_close",USECOUPON_INVOKE_SHOW:"ttd_marketing_usecoupon_invokeshow",USECOUPON_INVOKE_HIDE:"ttd_marketing_usecoupon_invokehide",USECOUPON_ONSELECT:"ttd_marketing_usecoupon_onselect",USECOUPN_BESTSELECT_VALIDATEFAIL:"ttd_marketing_usecoupon_bestselect_validate_fail",POPUP_LOAD:"ttd_marketing_popcoupon_load",JSERROR:"ttd_marketing_jserror",POST_EXCEPTION:"ttdmkt_post_expection",BFF_EXTENSION:"ttd_marketing_bffextensions",DHT_KEY:"o_tour_marketing_coupon"},t.BFF_ERROR_TYPE="Error",(a=t.KM_BLOCK_KEY||(t.KM_BLOCK_KEY={})).ClaimCoupon_ValidateFail="mktcoupoon_10001",a.ClaimCoupon_NeedLogin="mktcoupoon_10002",a.UseCoupon_ValidateFailed="mktcoupoon_10003",t.QUERY_NAME={RECEIVE_PROMOTION:"getReceivePromotionByRelationId",PROMOTION_TAG:"getPromotionTag",SHARK:"getShark",CLAIM:"claimCoupon",CROSS_COUPON:"getCrossCouponList",SCENE_CONFIG:"getSceneConfig",POP_COUPON:"getPopCouponList",SHOP_COUPON:"getShopCouponList",USE_COUPON:"useCouponList",VALIDATE:"validateCoupon",SERVER_TIME:"getServeTime"}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.crossCouponInfoFields=t.claimCouponInfoFields=t.couponInfoFields=void 0,t.couponInfoFields="\n    fragment couponInfoFields on CouponInfoType{\n        promotionId\n        couponName\n        couponCode\n        couponType\n        promotionMethod\n        status\n        shortRemark\n        productLineIcon\n        detailRemarkShown\n        startDateShown\n        endDateShown\n        useDateShown\n        deductionInfoShown {\n            type\n            fullDeduction\n            desc\n            amount\n            discountUnit\n            deductionList\n            deductionAmount\n            deductionAmountTag\n        }\n        deductionAmount\n        matchedQuantity\n        deductionStrategyType\n        deductionList{\n            id\n            deductionType\n            startAmount\n            deductionAmount\n            deductionAmountLimit\n            hit\n        }\n        unavailableReasonShown\n        isTopOne\n        extendInfo{\n            userFilter\n            scheduleFrom\n            scheduleTo\n        }\n        unavailableReasonList{\n            code\n            message\n        }\n        promotionLabel\n        promotionStatus\n        disableButton\n        buttonText\n}\n",t.claimCouponInfoFields="\n    fragment claimCouponInfoFields on ClaimCouponInfoType{\n        promotionId\n        couponName\n        couponCode\n        couponType\n        promotionMethod\n        promotionSecretId\n        leftCount\n        promotionStatus\n        status\n        shortRemark\n        jumpUrl\n        productLineIcon\n        detailRemarkShown\n        startDateShown\n        endDateShown\n        useDateShown\n        deductionInfoShown {\n            type\n            fullDeduction\n            desc\n            amount\n            discountUnit\n            deductionList\n            deductionAmount\n        }\n        deductionAmount\n        deductionStrategyType\n        deductionList{\n            id\n            deductionType\n            startAmount\n            deductionAmount\n            deductionAmountLimit\n            hit\n        }\n        unavailableReasonShown\n        unavailableReasonList{\n            code\n            message\n        }\n        extendInfo{\n            userFilter\n        }\n        promotionLabel\n        activityStatus\n        nextAvailableTime\n        activityStatus\n        disableButton\n        buttonText\n}\n",t.crossCouponInfoFields="\n    fragment crossCouponInfoFields on CrossCouponInfoType{\n        promotionId\n        displayName\n        couponCode\n        couponStartDate\n        couponDisableDate\n        shortRemark\n        detailRemark\n        businessLineName\n        businessLineType\n        customerNewOrOldName\n        deductionAmountLabel\n        promotionLabel\n        useDateShown\n        toUseLink\n        iconImageUrl\n        productLineIcon\n        cardTitle\n        cardSubTitle\n    }\n    \n"},function(e,t,n){"use strict";var r=n(31).default,a=n(32).default,o=n(42).default,i=n(43).default,s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),c=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return c(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=l(n(0)),f=n(1),p=u(n(115)),m=u(n(117)),h=u(n(119)),v=u(n(120)),g=u(n(121)),y=u(n(122));n(123);var _=["\u4ea7\u54c1\u8bf4\u660e","\u884c\u674e\u89c4\u5b9a","\u9000\u6539\u7b7e\u8bf4\u660e"],b=function(e){o(n,e);var t=i(n);function n(e){var a;return r(this,n),(a=t.call(this,e)).setShowCab=function(e){a.setState({isShowCabChange:e})},a.state={currentIndex:0,modulePositionArr:[],isShowCabChange:!1,index:0,ele:"child0"},a}return a(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.fareMaskInfo,r=void 0===n?{}:n,a=t.handleHiddenMask,o=this.state,i=o.isShowCabChange,s=o.ele,c=o.index;if(!Object.keys(r).length)return null;var l=r.confirmInfo,u=r.bookingNotice,b=void 0===u?[]:u,I=r.classInfo,x=r.baggageLimit,T=r.fareRemarkInfo,k=r.priceDetail,S=r.reduceDetail,C=r.isLineFlight,w=[];b.forEach((function(e){var t=e.bookingNotice;(void 0===t?[]:t).forEach((function(e){if("string"==typeof e)w.push(e);else if(e){var t=e.title,n=void 0===t?"":t,r=e.subTxt,a=void 0===r?[]:r;w.push("".concat(n).concat(a.join(" ")))}}))}));var N=["child0","child1","child2"];return d.default.createElement(f.View,null,d.default.createElement(p.default,{height:"tall",title:"\u884c\u674e\u989d\u53ca\u9000\u6539\u7b7e\u8bf4\u660e",listName:N,scrollIntoView:s,setTabIndex:function(t){return function(t){e.setState({index:t})}(t)},topChildren:d.default.createElement(m.default,{dataList:_,curIndex:c,handleClickTab:function(t){e.setState({index:t}),e.setState({ele:"child".concat(t)})}}),handleClose:a,disableScroll:i},d.default.createElement(f.View,{className:"koala-fare-remark-container"},d.default.createElement(h.default,{id:N[0],confirmInfo:l,reduceDetail:S,bookingNoticeTxtArr:w,classInfo:I,priceDetail:k,isLineFlight:C}),d.default.createElement(g.default,{id:N[1],info:x}),d.default.createElement(v.default,{id:N[2],info:T,setShowCab:this.setShowCab}))),i&&d.default.createElement(f.View,{className:"koala-fare-remark-container"},d.default.createElement(p.default,{id:"cabin-pop",needMoreHeight:!0,height:"tall",title:"\u540c\u8231\u6539\u671f\u8d39\u8bf4\u660e",handleClose:function(){return e.setShowCab(!1)}},d.default.createElement(y.default,null))))}}]),n}(d.Component);t.default=b},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r={VPC_PRODUCTINFO:"VPC_PRODUCTINFO",VPC_DATE_INFO:"VPC_DATE_INFO",VPC_SAVED_PASSANGER_INFO:"VPC_SAVED_PASSANGER_INFO",VPC_SHOPPING_HISTORY:"VPC_SHOPPING_HISTORY",NewProcessSelectedDate:"NewProcessSelectedDate",VPC_PRESALE_DATE_INFO:"VPC_PRESALE_DATE_INFO",VPC_PRESALE_PASSENGER_INFO:"VPC_PRESALE_PASSENGER_INFO",VPC_SEGMENT_INFO:"VPC_SEGMENT_INFO",VPC_230331_VAC_CXZ:"VPC_230331_VAC_CXZ",VPC_HAS_AUTO_SHOW:"VPC_HAS_AUTO_SHOW"},a=["A","B","C","D","E","F","G","H","I","J"]},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(7);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(25);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Object(o.a)(r.key),r)}}var s=function(e,t,n,r){return(e=e.toString()).length<t&&(n=new Array(t).join(n||" "),e=r?(n+e).substr(-t):(e+n).substring(0,t)),e},c=["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],l=/^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(\.[0-9]+)?(Z)?((\+|-)?\d{1,2}:00)?$/,u=function(){function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];a(this,e),this.date=new Date("");var o=e.handleZone(Date.now());if(t)if(/^-\d+$/.test(t)){if(n)return this.date=new Date(""),this;t=e.handleZone(t)}else if(/^\+?\d+$/.test(t))t=e.handleZone(t);else if("object"===Object(r.a)(t)&&t instanceof e)return t;if("string"==typeof(t=t||o)){var i=/^(\d{4})\-?(\d{1,2})(?:\-(\d{1,2}))?/i;t.match(i)&&(t=t.replace(i,(function(e,t,n,r){return"".concat(t,"/").concat(n||"01","/").concat(r||"01")})))}this.date=new Date(t)}var t,n,o;return t=e,o=[{key:"parse",value:function(t,n,a){return"object"===Object(r.a)(t)?(t instanceof e&&(t=t.valueOf()),n?new Date(t):new e(t)):((t+="").indexOf("Date")>-1?t=t.match(/((\+|-)?\d+)/)[0]:l.test(t)&&(t=e.transformTimeStampISO8601(t)),isNaN(t)||(t=parseInt(t,10)),n?new e(t,a).valueOf():new e(t,a))}},{key:"minuteDiff",value:function(t,n){var r=Number(e.parse(t,!0));return(Number(e.parse(n,!0))-r)/6e4}},{key:"hourDiff",value:function(t,n){var r=Number(e.parse(t,!0));return(Number(e.parse(n,!0))-r)/36e5}},{key:"dayDiff",value:function(t,n){var r=e.parse(t,!0),a=e.parse(n,!0);r.setHours(0,0,0,0),a.setHours(0,0,0,0);var o=Number(r);return(Number(a)-o)/864e5}},{key:"diffMonth",value:function(t,n){return(t=new e(t)).diffMonth(n)}},{key:"diffYear",value:function(t,n){return(t=new e(t)).diffYear(n)}},{key:"timeRange",value:function(t,n,r){var a=e.dayDiff(t,r),o=e.dayDiff(r,n);return a>=0&&o>=0}},{key:"format",value:function(t,n,r){return new e(t=this.parse(t,!0,r),r).format(n)}},{key:"handleZone",value:function(e){return!e||isNaN(e)?e:+e+6e4*(new Date).getTimezoneOffset()+288e5}},{key:"transformTimeStamp",value:function(t){var n=t.match(/^\/Date\(-?(\d+)(\+|-)\d+\)\/$/);return n?e.handleZone(n[1]):t.match(/^(\d{4})\-?(\d{1,2})(?:\-(\d{1,2}))?/i)?new Date(t).getTime():t}},{key:"transformTimeStampISO8601",value:function(e){var t=e.match(l);if(t&&t.length){var n=t[1],r=null==t[2]?0:t[2]-1,a=t[3],o=t[4],i=t[5],s=t[6];return new Date(n,r,a,o,i,s).getTime()-288e5-6e4*(new Date).getTimezoneOffset()}return null}},{key:"transformServerDate",value:function(t){return"/Date("+(t=e.handleZone(t))+"+0800)/"}},{key:"isCrossYear",value:function(t,n){return t=this.parse(t,!0,n),0!=e.diffYear(t,new e)}}],(n=[{key:"addDay",value:function(e){return e=e||0,this.date.setDate(this.date.getDate()+e),this}},{key:"addMonth",value:function(e){return e=e||0,this.date.setMonth(this.date.getMonth()+e),this}},{key:"addHours",value:function(e){return e=e||0,this.date.setHours(this.date.getHours()+e),this}},{key:"addMinutes",value:function(e){return e=e||0,this.date.setMinutes(this.date.getMinutes()+e),this}},{key:"getMinutes",value:function(){return this.date.getMinutes()}},{key:"addSeconds",value:function(e){return e=e||0,this.date.setSeconds(this.date.getSeconds()+e),this}},{key:"addYear",value:function(e){return e=e||0,this.date.setFullYear(this.date.getFullYear()+e),this}},{key:"toBJZone",value:function(){return new e(e.handleZone(this.date.getTime()))}},{key:"setHours",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.date.setHours.apply(this.date,t),this}},{key:"setMinutes",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.date.setMinutes.apply(this.date,t),this}},{key:"valueOf",value:function(){return this.date}},{key:"getTime",value:function(){return this.date.valueOf()}},{key:"toString",value:function(){return this.date.toString()}},{key:"format",value:function(e){var t=this.date;return(e=e||"YYYY-MM-DD").replace(/Y+|y+|M+|D+|d+|H+|h+|m+|s+|w+/g,(function(e){var n=e.substr(0,1),r=e.length;switch(n){case"Y":case"y":return t.getFullYear().toString().substr(4-r);case"M":return s(t.getMonth()+1,r,"0",!0);case"D":case"d":return s(t.getDate(),r,"0",!0);case"H":case"h":return s(t.getHours(),r,"0",!0);case"m":return s(t.getMinutes(),r,"0",!0);case"s":return s(t.getSeconds(),r,"0",!0);case"w":return c[t.getDay()]}}))}},{key:"diffMonth",value:function(t){var n=parseInt(this.format("YYYY"),10),r=parseInt(this.format("MM"),10),a=new e(t);return 12*(parseInt(a.format("YYYY"),10)-n)+(parseInt(a.format("MM"),10)-r)}},{key:"diffYear",value:function(t){var n=parseInt(this.format("YYYY"),10),r=new e(t);return parseInt(r.format("YYYY"),10)-n}},{key:"isValid",value:function(){return this.date&&!isNaN(this.date.getTime())}}])&&i(t.prototype,n),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},function(e,t){e.exports=n(46346)},,,function(e,t){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(30);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(10).default;e.exports=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){(function(r){var o,i,s,c=n(10).default;!function(n,r){"object"==c(t)&&void 0!==e?r(t):(i=[t],void 0===(s="function"==typeof(o=r)?o.apply(t,i):o)||(e.exports=s))}(0,(function(e){"use strict";function t(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function n(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function o(e,t,n){o.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}function i(e,t){i.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function s(e,t){s.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function l(e,t,n){l.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:n,enumerable:!0})}function u(e,t,n){var r=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,r),e}function d(e){var t=void 0===e?"undefined":S(e);return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":"function"==typeof e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function f(e,t,n,r,a,c,p){p=p||[];var m=(a=a||[]).slice(0);if(void 0!==c){if(r){if("function"==typeof r&&r(m,c))return;if("object"===(void 0===r?"undefined":S(r))){if(r.prefilter&&r.prefilter(m,c))return;if(r.normalize){var h=r.normalize(m,c,e,t);h&&(e=h[0],t=h[1])}}}m.push(c)}"regexp"===d(e)&&"regexp"===d(t)&&(e=e.toString(),t=t.toString());var v=void 0===e?"undefined":S(e),g=void 0===t?"undefined":S(t),y="undefined"!==v||p&&p[p.length-1].lhs&&p[p.length-1].lhs.hasOwnProperty(c),_="undefined"!==g||p&&p[p.length-1].rhs&&p[p.length-1].rhs.hasOwnProperty(c);if(!y&&_)n(new i(m,t));else if(!_&&y)n(new s(m,e));else if(d(e)!==d(t))n(new o(m,e,t));else if("date"===d(e)&&e-t!=0)n(new o(m,e,t));else if("object"===v&&null!==e&&null!==t)if(p.filter((function(t){return t.lhs===e})).length)e!==t&&n(new o(m,e,t));else{if(p.push({lhs:e,rhs:t}),Array.isArray(e)){var b;for(e.length,b=0;b<e.length;b++)b>=t.length?n(new l(m,b,new s(void 0,e[b]))):f(e[b],t[b],n,r,m,b,p);for(;b<t.length;)n(new l(m,b,new i(void 0,t[b++])))}else{var I=Object.keys(e),x=Object.keys(t);I.forEach((function(a,o){var i=x.indexOf(a);i>=0?(f(e[a],t[a],n,r,m,a,p),x=u(x,i)):f(e[a],void 0,n,r,m,a,p)})),x.forEach((function(e){f(void 0,t[e],n,r,m,e,p)}))}p.length=p.length-1}else e!==t&&("number"===v&&isNaN(e)&&isNaN(t)||n(new o(m,e,t)))}function p(e,t,n,r){return r=r||[],f(e,t,(function(e){e&&r.push(e)}),n),r.length?r:void 0}function m(e,t,n){if(e&&t&&n&&n.kind){for(var r=e,a=-1,o=n.path?n.path.length-1:0;++a<o;)void 0===r[n.path[a]]&&(r[n.path[a]]="number"==typeof n.path[a]?[]:{}),r=r[n.path[a]];switch(n.kind){case"A":!function e(t,n,r){if(r.path&&r.path.length){var a,o=t[n],i=r.path.length-1;for(a=0;a<i;a++)o=o[r.path[a]];switch(r.kind){case"A":e(o[r.path[a]],r.index,r.item);break;case"D":delete o[r.path[a]];break;case"E":case"N":o[r.path[a]]=r.rhs}}else switch(r.kind){case"A":e(t[n],r.index,r.item);break;case"D":t=u(t,n);break;case"E":case"N":t[n]=r.rhs}return t}(n.path?r[n.path[a]]:r,n.index,n.item);break;case"D":delete r[n.path[a]];break;case"E":case"N":r[n.path[a]]=n.rhs}}}function h(e){return"color: "+N[e].color+"; font-weight: bold"}function v(e,t,n,r){var a=p(e,t);try{r?n.groupCollapsed("diff"):n.group("diff")}catch(e){n.log("diff")}a?a.forEach((function(e){var t=e.kind,r=function(e){var t=e.kind,n=e.path,r=e.lhs,a=e.rhs,o=e.index,i=e.item;switch(t){case"E":return[n.join("."),r,"\u2192",a];case"N":return[n.join("."),a];case"D":return[n.join(".")];case"A":return[n.join(".")+"["+o+"]",i];default:return[]}}(e);n.log.apply(n,["%c "+N[t].text,h(t)].concat(C(r)))})):n.log("\u2014\u2014 no diff \u2014\u2014");try{n.groupEnd()}catch(e){n.log("\u2014\u2014 diff end \u2014\u2014 ")}}function g(e,t,n,r){switch(void 0===e?"undefined":S(e)){case"object":return"function"==typeof e[r]?e[r].apply(e,C(n)):e[r];case"function":return e(t);default:return e}}function y(e,t){var n=t.logger,r=t.actionTransformer,a=t.titleFormatter,o=void 0===a?function(e){var t=e.timestamp,n=e.duration;return function(e,r,a){var o=["action"];return o.push("%c"+String(e.type)),t&&o.push("%c@ "+r),n&&o.push("%c(in "+a.toFixed(2)+" ms)"),o.join(" ")}}(t):a,i=t.collapsed,s=t.colors,c=t.level,l=t.diff,u=void 0===t.titleFormatter;e.forEach((function(a,d){var f=a.started,p=a.startedTime,m=a.action,h=a.prevState,y=a.error,_=a.took,b=a.nextState,I=e[d+1];I&&(b=I.prevState,_=I.started-f);var x=r(m),k="function"==typeof i?i((function(){return b}),m,a):i,S=T(p),C=s.title?"color: "+s.title(x)+";":"",w=["color: gray; font-weight: lighter;"];w.push(C),t.timestamp&&w.push("color: gray; font-weight: lighter;"),t.duration&&w.push("color: gray; font-weight: lighter;");var N=o(x,S,_);try{k?s.title&&u?n.groupCollapsed.apply(n,["%c "+N].concat(w)):n.groupCollapsed(N):s.title&&u?n.group.apply(n,["%c "+N].concat(w)):n.group(N)}catch(e){n.log(N)}var E=g(c,x,[h],"prevState"),P=g(c,x,[x],"action"),j=g(c,x,[y,h],"error"),O=g(c,x,[b],"nextState");if(E)if(s.prevState){var D="color: "+s.prevState(h)+"; font-weight: bold";n[E]("%c prev state",D,h)}else n[E]("prev state",h);if(P)if(s.action){var R="color: "+s.action(x)+"; font-weight: bold";n[P]("%c action    ",R,x)}else n[P]("action    ",x);if(y&&j)if(s.error){var A="color: "+s.error(y,h)+"; font-weight: bold;";n[j]("%c error     ",A,y)}else n[j]("error     ",y);if(O)if(s.nextState){var M="color: "+s.nextState(b)+"; font-weight: bold";n[O]("%c next state",M,b)}else n[O]("next state",b);l&&v(h,b,n,k);try{n.groupEnd()}catch(e){n.log("\u2014\u2014 log end \u2014\u2014")}}))}function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},E,e),n=t.logger,r=t.stateTransformer,a=t.errorTransformer,o=t.predicate,i=t.logErrors,s=t.diffPredicate;if(void 0===n)return function(){return function(e){return function(t){return e(t)}}};if(e.getState&&e.dispatch)return console.error("[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n// Logger with default options\nimport { logger } from 'redux-logger'\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\nimport createLogger from 'redux-logger'\nconst logger = createLogger({\n  // ...options\n});\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n"),function(){return function(e){return function(t){return e(t)}}};var c=[];return function(e){var n=e.getState;return function(e){return function(l){if("function"==typeof o&&!o(n,l))return e(l);var u={};c.push(u),u.started=k.now(),u.startedTime=new Date,u.prevState=r(n()),u.action=l;var d=void 0;if(i)try{d=e(l)}catch(e){u.error=a(e)}else d=e(l);u.took=k.now()-u.started,u.nextState=r(n());var f=t.diff&&"function"==typeof s?s(n,l):t.diff;if(y(c,Object.assign({},t,{diff:f})),c.length=0,u.error)throw u.error;return d}}}}var b,I,x=function(e,t){return function(e,t){return new Array(t+1).join(e)}("0",t-e.toString().length)+e},T=function(e){return x(e.getHours(),2)+":"+x(e.getMinutes(),2)+":"+x(e.getSeconds(),2)+"."+x(e.getMilliseconds(),3)},k="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date,S="function"==typeof Symbol&&"symbol"==c(Symbol.iterator)?function(e){return c(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":c(e)},C=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},w=[];b="object"===(void 0===r?"undefined":S(r))&&r?r:"undefined"!=typeof a?a:{},(I=b.DeepDiff)&&w.push((function(){void 0!==I&&b.DeepDiff===p&&(b.DeepDiff=I,I=void 0)})),t(o,n),t(i,n),t(s,n),t(l,n),Object.defineProperties(p,{diff:{value:p,enumerable:!0},observableDiff:{value:f,enumerable:!0},applyDiff:{value:function(e,t,n){e&&t&&f(e,t,(function(r){n&&!n(e,t,r)||m(e,t,r)}))},enumerable:!0},applyChange:{value:m,enumerable:!0},revertChange:{value:function(e,t,n){if(e&&t&&n&&n.kind){var r,a,o=e;for(a=n.path.length-1,r=0;r<a;r++)void 0===o[n.path[r]]&&(o[n.path[r]]={}),o=o[n.path[r]];switch(n.kind){case"A":!function e(t,n,r){if(r.path&&r.path.length){var a,o=t[n],i=r.path.length-1;for(a=0;a<i;a++)o=o[r.path[a]];switch(r.kind){case"A":e(o[r.path[a]],r.index,r.item);break;case"D":case"E":o[r.path[a]]=r.lhs;break;case"N":delete o[r.path[a]]}}else switch(r.kind){case"A":e(t[n],r.index,r.item);break;case"D":case"E":t[n]=r.lhs;break;case"N":t=u(t,n)}return t}(o[n.path[r]],n.index,n.item);break;case"D":case"E":o[n.path[r]]=n.lhs;break;case"N":delete o[n.path[r]]}}},enumerable:!0},isConflict:{value:function(){return void 0!==I},enumerable:!0},noConflict:{value:function(){return w&&(w.forEach((function(e){e()})),w=null),p},enumerable:!0}});var N={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},E={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(e){return e},actionTransformer:function(e){return e},errorTransformer:function(e){return e},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dispatch,n=e.getState;return"function"==typeof t||"function"==typeof n?_()({dispatch:t,getState:n}):void console.error("\n[redux-logger v3] BREAKING CHANGE\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\n[redux-logger v3] Change\n[redux-logger v3] import createLogger from 'redux-logger'\n[redux-logger v3] to\n[redux-logger v3] import { createLogger } from 'redux-logger'\n")};e.defaults=E,e.createLogger=_,e.logger=P,e.default=P,Object.defineProperty(e,"__esModule",{value:!0})}))}).call(this,n(22))},function(e,t,n){"use strict";var r=n(30).default,a=n(21).default,o=n(28).default,i=n(10).default,s=n(66).default,c=n(70),l=n(71),u=n(72),d=n(73),f=Symbol("encodeFragmentIdentifier");function p(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function m(e,t){return t.encode?t.strict?c(e):encodeURIComponent(e):e}function h(e,t){return t.decode?l(e):e}function v(e){var t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function g(e){var t=(e=v(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function y(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function _(e,t){p((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);var n=function(e){var t;switch(e.arrayFormat){case"index":return function(e,n,r){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return function(e,n,r){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"colon-list-separator":return function(e,n,r){t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"comma":case"separator":return function(t,n,r){var a="string"==typeof n&&n.includes(e.arrayFormatSeparator),o="string"==typeof n&&!a&&h(n,e).includes(e.arrayFormatSeparator);n=o?h(n,e):n;var i=a||o?n.split(e.arrayFormatSeparator).map((function(t){return h(t,e)})):null===n?n:h(n,e);r[t]=i};case"bracket-separator":return function(t,n,r){var a=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),a){var o=null===n?[]:n.split(e.arrayFormatSeparator).map((function(t){return h(t,e)}));void 0!==r[t]?r[t]=[].concat(r[t],o):r[t]=o}else r[t]=n?h(n,e):n};default:return function(e,t,n){void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),r=Object.create(null);if("string"!=typeof e)return r;if(!(e=e.trim().replace(/^[?#&]/,"")))return r;var s,c=o(e.split("&"));try{for(c.s();!(s=c.n()).done;){var l=s.value;if(""!==l){var d=u(t.decode?l.replace(/\+/g," "):l,"="),f=a(d,2),m=f[0],v=f[1];v=void 0===v?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?v:h(v,t),n(h(m,t),v,r)}}}catch(e){c.e(e)}finally{c.f()}for(var g=0,_=Object.keys(r);g<_.length;g++){var b=_[g],I=r[b];if("object"===i(I)&&null!==I)for(var x=0,T=Object.keys(I);x<T.length;x++){var k=T[x];I[k]=y(I[k],t)}else r[b]=y(I,t)}return!1===t.sort?r:(!0===t.sort?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce((function(e,t){var n=r[t];return Boolean(n)&&"object"===i(n)&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"===i(t)?e(Object.keys(t)).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return t[e]})):t}(n):e[t]=n,e}),Object.create(null))}t.extract=g,t.parse=_,t.stringify=function(e,t){if(!e)return"";p((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);for(var n=function(n){return t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n]},r=function(e){switch(e.arrayFormat){case"index":return function(t){return function(n,r){var a=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:[].concat(s(n),null===r?[[m(t,e),"[",a,"]"].join("")]:[[m(t,e),"[",m(a,e),"]=",m(r,e)].join("")])}};case"bracket":return function(t){return function(n,r){return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:[].concat(s(n),null===r?[[m(t,e),"[]"].join("")]:[[m(t,e),"[]=",m(r,e)].join("")])}};case"colon-list-separator":return function(t){return function(n,r){return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:[].concat(s(n),null===r?[[m(t,e),":list="].join("")]:[[m(t,e),":list=",m(r,e)].join("")])}};case"comma":case"separator":case"bracket-separator":var t="bracket-separator"===e.arrayFormat?"[]=":"=";return function(n){return function(r,a){return void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?r:(a=null===a?"":a,0===r.length?[[m(n,e),t,m(a,e)].join("")]:[[r,m(a,e)].join(e.arrayFormatSeparator)])}};default:return function(t){return function(n,r){return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:[].concat(s(n),null===r?[m(t,e)]:[[m(t,e),"=",m(r,e)].join("")])}}}}(t),a={},o=0,i=Object.keys(e);o<i.length;o++){var c=i[o];n(c)||(a[c]=e[c])}var l=Object.keys(a);return!1!==t.sort&&l.sort(t.sort),l.map((function(n){var a=e[n];return void 0===a?"":null===a?m(n,t):Array.isArray(a)?0===a.length&&"bracket-separator"===t.arrayFormat?m(n,t)+"[]":a.reduce(r(n),[]).join("&"):m(n,t)+"="+m(a,t)})).filter((function(e){return e.length>0})).join("&")},t.parseUrl=function(e,t){t=Object.assign({decode:!0},t);var n=u(e,"#"),r=a(n,2),o=r[0],i=r[1];return Object.assign({url:o.split("?")[0]||"",query:_(g(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:h(i,t)}:{})},t.stringifyUrl=function(e,n){n=Object.assign(r({encode:!0,strict:!0},f,!0),n);var a=v(e.url).split("?")[0]||"",o=t.extract(e.url),i=t.parse(o,{sort:!1}),s=Object.assign(i,e.query),c=t.stringify(s,n);c&&(c="?".concat(c));var l=function(e){var t="",n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(l="#".concat(n[f]?m(e.fragmentIdentifier,n):e.fragmentIdentifier)),"".concat(a).concat(c).concat(l)},t.pick=function(e,n,a){a=Object.assign(r({parseFragmentIdentifier:!0},f,!1),a);var o=t.parseUrl(e,a),i=o.url,s=o.query,c=o.fragmentIdentifier;return t.stringifyUrl({url:i,query:d(s,n),fragmentIdentifier:c},a)},t.exclude=function(e,n,r){var a=Array.isArray(n)?function(e){return!n.includes(e)}:function(e,t){return!n(e,t)};return t.pick(e,a,r)}},function(e,t,n){var r=n(67),a=n(68),o=n(26),i=n(69);e.exports=function(e){return r(e)||a(e)||o(e)||i()},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(38);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}},function(e,t,n){"use strict";var r=n(10).default,a=new RegExp("(%[a-f0-9]{2})|([^%]+?)","gi"),o=new RegExp("(%[a-f0-9]{2})+","gi");function i(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],i(n),i(r))}function s(e){try{return decodeURIComponent(e)}catch(r){for(var t=e.match(a)||[],n=1;n<t.length;n++)t=(e=i(t,n).join("")).match(a)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+r(e)+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"\ufffd\ufffd","%FF%FE":"\ufffd\ufffd"},n=o.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var r=s(n[0]);r!==n[0]&&(t[n[0]]=r)}n=o.exec(e)}t["%C2"]="\ufffd";for(var a=Object.keys(t),i=0;i<a.length;i++){var c=a[i];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},function(e,t,n){"use strict";e.exports=function(e,t){if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];var n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},function(e,t,n){"use strict";e.exports=function(e,t){for(var n={},r=Object.keys(e),a=Array.isArray(t),o=0;o<r.length;o++){var i=r[o],s=e[i];(a?-1!==t.indexOf(i):t(i,s,e))&&(n[i]=s)}return n}},function(e,t,n){var r=n(40).default||n(40);a.fetch||(a.fetch=r),e.exports=r},function(e,t,n){"use strict";var r=n(31).default,o=n(32).default,i=n(41).default,s=n(76).default,c=n(33).default,l=n(42).default,u=n(43).default,d=n(28).default,f=n(27).default,p=n(29).default,m=n(21).default,h=n(10).default;Object.defineProperty(t,"__esModule",{value:!0});var v=n(0),g=n(37);function y(e){return e&&"object"===h(e)&&"default"in e?e:{default:e}}var _=y(v),b="undefined"!=typeof a&&void 0!==a.document&&void 0!==a.document.createElement?v.useLayoutEffect:v.useEffect,I=Symbol("default-value"),x=function(e){var t=e.list,n=e.children,r=e.fallback,a=e.container,o=v.useState(null),i=m(o,2),s=i[0],c=i[1];b((function(){var e=!1;return T(t,a).then((function(t){e||c({Provider:t.Provider})})),function(){e=!0}}),[]);var l=null==s?void 0:s.Provider;return l?_.default.createElement(l,null,n):_.default.createElement(_.default.Fragment,null,null!=r?r:null)},T=function(){var e=p(f().mark((function e(t,n){var r,a,o,i,s,c,l,u;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=null!=n?n:g.createPureModelContainer(),r=d(t);try{for(r.s();!(a=r.n()).done;)o=a.value,n.set(o.Model,{context:o.context,preloadedState:o.preloadedState})}catch(e){r.e(e)}finally{r.f()}return e.next=5,Promise.all(t.map((function(e){var t=e.Model,r=e.context,a=e.preloadedState;return t.preload(r,a,n)})));case 5:return i=e.sent,s=i.map((function(e){return e.Provider})),c=i.map((function(e){return e.state})),l=i.map((function(e){return e.model})),u=function(e){for(var t=e.children,n=s.length-1;n>=0;n--){var r=s[n];t=_.default.createElement(r,null,t)}return _.default.createElement(_.default.Fragment,null,t)},e.abrupt("return",{Provider:u,stateList:c,modelList:l});case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),k=function(e,t){return Object.values(e).map((function(e){return{Model:e,context:t}}))};t.HydrateProvider=function(e){var t,n=e.list,r=e.children,a=e.fallback,o=e.container,i=void 0===o?g.createPureModelContainer():o,s=d(n);try{for(s.s();!(t=s.n()).done;){var c=t.value;i.set(c.Model,{context:c.context,preloadedState:c.preloadedState}),r=_.default.createElement(c.Model.Provider,{context:c.context,preloadedState:c.preloadedState,container:i,fallback:a},r)}}catch(e){s.e(e)}finally{s.f()}return _.default.createElement(_.default.Fragment,null,r)},t.Provider=x,t.createReactModel=function(e){var t=_.default.createContext(null),n=function(n){var r,a=n.children,o=n.context,i=n.preloadedState,s=n.container,c=v.useMemo((function(){if(n.model)return n.model;var t={context:o,preloadedState:i,container:s};return g.createPureModel(e,t)}),[]),l=v.useMemo((function(){return{store:c.store,actions:c.actions}}),[c]),u=v.useState((function(){return c.isPreloaded()})),d=m(u,2),f=d[0],p=d[1];return b((function(){var e=!1;return c.isPreloaded()?c.isStarted()||c.start():c.preload().then((function(){e||(p(!0),c.start())})),function(){e=!0,c.isStarted()&&c.finish()}}),[]),f?_.default.createElement(t.Provider,{value:l},a):_.default.createElement(_.default.Fragment,null,null!==(r=n.fallback)&&void 0!==r?r:null)};return{isReactModel:!0,useState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g.identity,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.shallowEqual,r=v.useContext(t);if(null===r)throw new Error("You may forget to attach Provider to component tree before calling Model.useState()");var a=r.store,o=v.useReducer((function(e){return e+1}),0),i=m(o,2),s=(i[0],i[1]),c=v.useRef(null),l=v.useRef(null),u=v.useRef(I),d=v.useRef(I),f=a.getState(),p=I;try{p=e!==l.current||f!==u.current||c.current?e(f):d.current}catch(e){throw c.current&&(e.message+="\nThe error may be correlated with this previous error:\n".concat(c.current.stack,"\n\n")),e}if(b((function(){l.current=e,u.current=f,d.current=p,c.current=null})),b((function(){var e=!1,t=a.subscribe((function(){if(l.current&&!e){if(d.current===I)throw new Error("latestSelectedState should not be default value");try{var t=a.getState(),r=l.current(t);if(n(r,d.current))return;d.current=r,u.current=t}catch(e){c.current=e}s()}}));return function(){e=!0,t()}}),[a]),p===I)throw new Error("selectedState should not be default value");return p},useActions:function(){var e=v.useContext(t);if(null===e)throw new Error("You may forget to attach Provider to component tree before calling Model.useActions()");return e.actions},Provider:n,preload:function(){var t=p(f().mark((function t(r,a,o){var i,s,c;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=g.createPureModel(e,{context:r,preloadedState:a,container:o}),t.next=3,i.preload();case 3:return s=i.store.getState(),c=function(e){var t=e.children;return _.default.createElement(n,{model:i,context:r},t)},t.abrupt("return",{Provider:c,state:s,model:i});case 6:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),create:e,initializer:e}},t.preload=T,t.provide=function(e){return function(t){return function(t){l(a,t);var n=u(a);function a(){var t;return r(this,a),(t=n.apply(this,arguments)).ReactModelArgs=k(e,i(t)),t}return o(a,[{key:"render",value:function(){return _.default.createElement(x,{list:this.ReactModelArgs},s(c(a.prototype),"render",this).call(this))}}]),a}(t)}},t.useReactModel=function(e,t){var n=v.useMemo((function(){return g.createPureModel(e.create,t)}),[]),r=v.useState((function(){return n.store.getState()})),a=m(r,2),o=a[0],i=a[1];return b((function(){var e=!1,r=n.store.subscribe((function(){i(n.store.getState())}));return n.isPreloaded()?n.isStarted()||n.start():n.preload().then((function(){e||n.start()})).catch(null==t?void 0:t.onError),function(){e=!0,r(),n.isStarted()&&n.finish()}}),[]),[o,n.actions]}},function(e,t,n){var r=n(77);function a(){return"undefined"!=typeof Reflect&&Reflect.get?(e.exports=a=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=a=function(e,t,n){var a=r(e,t);if(a){var o=Object.getOwnPropertyDescriptor(a,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},e.exports.__esModule=!0,e.exports.default=e.exports),a.apply(this,arguments)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(33);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t,r)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(10).default,a=n(41);e.exports=function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(a=i.trys,!((a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i},l=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PureModel=t.fetch=void 0;var d=n(6),f=u(n(82)),p=n(18),m=n(3);t.fetch=function(e,t){return i(void 0,void 0,void 0,(function(){var n,r;return s(this,(function(a){switch(a.label){case 0:return[4,d.request({url:e.toString(),method:null==t?void 0:t.method,header:null==t?void 0:t.headers,data:null==t?void 0:t.body,mode:null==t?void 0:t.mode,credentials:null==t?void 0:t.credentials,dataType:"text"})];case 1:return n=a.sent(),r=n.header,[2,{ok:n.statusCode>=200&&n.statusCode<300,status:n.statusCode,text:function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){return[2,n.data]}))}))},json:function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){return[2,JSON.parse(n.data)]}))}))},headers:{keys:function(){return Object.keys(n.header)},entries:function(){return Object.entries(n.header)},get:function(e){return r[e.toLowerCase()]},has:function(e){return e.toLowerCase()in r}}}]}}))}))},t.PureModel=function(e){return function(n){var r,i;return i=function(e){function n(){var n,a,i=e.apply(this,l(arguments))||this;return i[r]=o(o({},i[m.MODEL_CONTEXT]),p.EnvContext.impl(o(o({},null===(a=null===(n=i[m.MODEL_CONTEXT])||void 0===n?void 0:n[p.EnvContext.id])||void 0===a?void 0:a.value),{fetch:t.fetch}))),i}return a(n,e),n}(f.default(e)(n)),r=m.MODEL_CONTEXT,i}}},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(0)),s=n(9),c=function(e,t){return Object.values(e).map((function(e){return{Model:e,context:t}}))};t.default=function(e){return function(t){return function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.ReactModelArgs=c(e,n),n}return a(n,t),n.prototype.render=function(){return i.default.createElement(s.Provider,{list:this.ReactModelArgs},t.prototype.render.call(this))},n}(t)}}},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var i={};if("string"!=typeof e||0===e.length)return i;var s=/\+/g;e=e.split(t);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var l=e.length;c>0&&l>c&&(l=c);for(var u=0;u<l;++u){var d,f,p,m,h=e[u].replace(s,"%20"),v=h.indexOf(n);v>=0?(d=h.substr(0,v),f=h.substr(v+1)):(d=h,f=""),p=decodeURIComponent(d),m=decodeURIComponent(f),r(i,p)?a(i[p])?i[p].push(m):i[p]=[i[p],m]:i[p]=m}return i};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var r=n(10).default,a=function(e){switch(r(e)){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,c){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"===r(e)?i(s(e),(function(r){var s=encodeURIComponent(a(r))+n;return o(e[r])?i(e[r],(function(e){return s+encodeURIComponent(a(e))})).join(t):s+encodeURIComponent(a(e[r]))})).join(t):c?encodeURIComponent(a(c))+n+encodeURIComponent(a(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var s=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.ERRORCODE=t.CouponRequestSceneEnum=t.ReceivePromotionTypeEnum=void 0,o(n(86),t),(r=t.ReceivePromotionTypeEnum||(t.ReceivePromotionTypeEnum={}))[r.Company=1]="Company",r[r.Vendor=2]="Vendor",function(e){e[e.OrderUse=1]="OrderUse",e[e.DetailClaim=2]="DetailClaim",e[e.PopClaim=3]="PopClaim",e[e.ShopClaim=4]="ShopClaim",e[e.DetailClaim_Useable=5]="DetailClaim_Useable",e[e.Tangram=6]="Tangram",e[e.CrossCoupon=7]="CrossCoupon"}(t.CouponRequestSceneEnum||(t.CouponRequestSceneEnum={})),function(e){e.TIMEOUT="TIMEOUT",e.JSERROR="JSERROR"}(t.ERRORCODE||(t.ERRORCODE={}))},function(e,t,n){var r,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.RelationTypeEnum=t.PromotionStatusEnum=t.SelectedByEnum=t.UseStatusEnum=void 0,o(n(87),t),(r=t.UseStatusEnum||(t.UseStatusEnum={}))[r.Use=1]="Use",r[r.NotUse=2]="NotUse",r[r.NotAvailable=3]="NotAvailable",function(e){e[e.Default=1]="Default",e[e.UserSelect=2]="UserSelect",e[e.UserInput=3]="UserInput"}(t.SelectedByEnum||(t.SelectedByEnum={})),function(e){e.AVAILABlE_CLAIM_LIST="availableClaimList",e.AVAILABLE_USE_LIST="availableUseList",e.RECEIVED_NOUSE_LIST="receivedNouseList",e.ROBBED_LIST="robbedList",e.EXPIRED_LIST="expiredList",e.NOT_STARTED="notStartedList",e.SINGKEK_LIST="singkekList"}(t.PromotionStatusEnum||(t.PromotionStatusEnum={})),function(e){e.PRODUCTID="PRODUCTID",e.VENDORID="VENDORID",e.SCENICSPOTID="SCENICSPOTID",e.POIID="POIID"}(t.RelationTypeEnum||(t.RelationTypeEnum={}))},function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CrossSceneEnum=void 0,(n=t.CrossSceneEnum||(t.CrossSceneEnum={}))[n.BeforeBooking=0]="BeforeBooking",n[n.AfterBooking=1]="AfterBooking"},function(e,t,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return o(t,e),t},s=this&&this.__awaiter||function(e,t,n,r){return new(n=n||Promise)((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):((t=e.value)instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){var c=[i,s];if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,(c=a?[2&c[0],a.value]:c)[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=0<(a=o.trys).length&&a[a.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3]))o.label=c[1];else if(6===c[0]&&o.label<a[1])o.label=a[1],a=c;else{if(!(a&&o.label<a[2])){a[2]&&o.ops.pop(),o.trys.pop();continue}o.label=a[2],o.ops.push(c)}}c=t.call(e,o)}catch(s){c=[6,s],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},u=this,d=(Object.defineProperty(t,"__esModule",{value:!0}),i(n(0))),f=n(1),p=i(n(6)),m=n(14),h=n(34),v=l(n(93)),g=n(110),y=(n(112),d.useEffect),_=d.forwardRef,b=d.useState,I=_((function(e,t){var n=(I=b(""))[0],a=I[1],o=(I=b(!1))[0],i=I[1],l=(I=b(!1))[0],_=I[1],I=void 0===(e.data,I=e.title)?"\u9009\u62e9\u4f18\u60e0\u5238":I,x=(e.style,e.clientEnv),T=void 0===(T=e.needCodeInput)||T,k=void 0===(S=e.needPopover)||S,S=r(r({},e),{clientEnv:r(r({},x),{clientType:m.ClientEnum.MiniProgram}),compVersion:h.COMPONENT_VERSION,componentType:m.ComponentTypeEnum.Taro,miniType:h.mapEnvToMiniType(),showToast:function(e){p.default.showToast({title:e.content,icon:"none",mask:e.needMask,duration:e.duration})},logTrace:function(e){try{h.cwx&&h.cwx.sendUbtByPage.ubtTrace(e.key,e.value)}catch(e){}},logMetric:function(e){try{h.cwx&&h.cwx.sendUbtByPage.ubtMetric(e)}catch(e){}},auth:h.cwx&&h.cwx.user.auth||h.getAuth(),fetch:h.miniRequest,ensureUbtHasAttached:null,ref:t,logger:{ubtDevTrace:function(e,t){return h.cwx&&h.cwx.sendUbtByPage.ubtTrace(e,t)}},onVisibleChange:function(e){},firstDidAmount:function(){return s(u,void 0,void 0,(function(){var e;return c(this,(function(t){switch(t.label){case 0:return console.log("%cexec useCoupon firstDidAmount","color:yellow"),[4,h.getSystemInfo()];case 1:return(e=t.sent())&&e.safeArea&&e.safeArea.top&&20<e.safeArea.top&&(i(!0),console.log("%c\u68c0\u6d4b\u5230\u5f02\u5f62\u5c4f","color:yellow")),[2]}}))}))}}),C=(t=(x=v.default(S)).modelState,S=x.modelAction,x=x.ctrl,t.timezone),w=t.couponList,N=t.selectedCouponCode,E=t.couponCodeText,P=t.expandCode,j=(t.sharkData,t.notUseCoupon),O=t.visible,D=S.setCouponCodeText,R=S.setExpandCode,A=x.handleSelectCoupon,M=x.handleClickUseCoupon,V=(t=x.handleClose,x.handleTraceClick),L=w.filter((function(e){return!!e.status})).length;return y((function(){O?(a(""),p.default.nextTick((function(){_(!0)}))):(_(!1),setTimeout((function(){a("displayNone")}),100))}),[O]),p.useDidShow((function(){})),p.useDidHide((function(){})),p.usePullDownRefresh((function(){})),d.createElement(f.View,{className:"ttd-useCoupon "+(l?"ttd-marketing-show":"ttd-marketing-hidden")},k&&d.createElement(f.View,{className:"ttd-marketing-mask "+n,onClick:t,catchMove:!0}),d.createElement(f.View,{className:"ttd-marketing-half-screen-"+(k?"dialog":"block")+" "+n,catchMove:k},k&&d.createElement(f.View,{className:"ttd-marketing-half-claim-header"},d.createElement(f.View,{className:"ttd-marketing-half-claim-header-close ttd-marketing-icon-close",hoverClass:"ttd-marketing-close-active",onClick:t}),d.createElement(f.View,{className:"ttd-marketing-half-claim-header-title"},I),d.createElement(f.View,{className:"ttd-marketing-half-claim-header-right"})),d.createElement(f.ScrollView,{className:"ttd-marketing-half-claim-body",scrollY:!0,scrollWithAnimation:!0,style:{marginBottom:o?"34rpx":0}},T&&d.createElement(f.View,{className:"ttd-marketing-half-useCoupon-inputCode"},d.createElement(f.Input,{className:"code_text_input",type:"text",placeholder:"\u8bf7\u8f93\u5165\u4f18\u60e0\u5238\u7801",value:E,onClick:function(){V("CodeInput")},onInput:function(e){D(e.detail.value)}}),!!E&&d.createElement(f.Text,{className:"code_clear_icon",onClick:function(){D("")}},"\ue003"),d.createElement(f.View,{className:"code_exchange_btn "+(E?"active":""),onClick:function(){V("CodeUse"),E&&M(E,e.clientEnv.clientType)}},"\u4f7f\u7528")),L<=0?d.createElement(f.View,{className:"ttd-marketing-half-useCoupon-noContent"},d.createElement(f.Image,{className:"noContent-img",src:"https://pic.c-ctrip.com/VacationH5Pic/tangram-pic/coupon_empty.png"}),d.createElement(f.View,{className:"empty_text1"},"\u6682\u65e0\u53ef\u7528\u4f18\u60e0\u5238"),T&&d.createElement(f.View,{className:"empty_text2"},"\u5982\u679c\u60a8\u6709\u4f18\u60e0\u5238\u7801\uff0c\u53ef\u8f93\u5165\u5e76\u4f7f\u7528\u4f18\u60e0")):-480!=C.offset&&d.createElement(f.View,{className:"coupon_timezone"},"\u6709\u6548\u671f\u663e\u793a\u65f6\u533a\uff1aGMT+08:00"),d.createElement(f.View,{className:"ttd-marketing-half-useCoupon-coupon_list"},0<L&&d.createElement(f.View,null,d.createElement(f.View,{className:"list_availablecount_text"},"\u53ef\u7528\u4f18\u60e0\u5238\uff08",d.createElement(f.Text,{className:"list_availablecount_text_number"},L),"\u5f20\uff09"),d.createElement(f.View,{className:"coupon_notuse"},d.createElement(f.View,{className:"coupon_notuse_text"},"\u4e0d\u4f7f\u7528\u4f18\u60e0\u5238"),d.createElement(f.View,{onClick:function(){A(null,!0,k),V("NotUse")}},j?d.createElement(f.View,{className:"coupon_notuse_btn"},"\ued1e"):d.createElement(f.View,{className:"coupon_notuse_btn"},"\uee35")))),(w||[]).map((function(e,t){return d.createElement(g.UseCouponCard,r({key:e.couponCode+"-"+t},r(r({},e),{groupId:e.status?1:2,positionId:e.status?t+1:t-L,selected:!j&&e.couponCode==N,expanded:e.couponCode==P,closeAfterSelect:k,handleSelect:A,handleExpand:R,handleTraceClick:V})))}))))))}));I.displayName="UseCoupon",t.default=d.memo(I)},function(e){e.exports=JSON.parse('{"compVerison":"1.4.23-beta.0"}')},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.getInstance=function(){return null==this.singleInstance?new e:this.singleInstance},e.singleInstance=null,e}();t.default=n},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n=n||Promise)((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):((t=e.value)instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){var c=[i,s];if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,(c=a?[2&c[0],a.value]:c)[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=0<(a=o.trys).length&&a[a.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3]))o.label=c[1];else if(6===c[0]&&o.label<a[1])o.label=a[1],a=c;else{if(!(a&&o.label<a[2])){a[2]&&o.ops.pop(),o.trys.pop();continue}o.label=a[2],o.ops.push(c)}}c=t.call(e,o)}catch(s){c=[6,s],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(t,"__esModule",{value:!0}),o(n(6))),s=function(){function e(e,t){this.key="ttd_rn_popcoupon_"+e+"_"+t,this.domain="ttd_front_marketing"}return e.prototype.get=function(){return r(this,void 0,void 0,(function(){var e;return a(this,(function(t){try{if("string"==typeof(e=i.default.getStorageSync(this.key)))try{e=JSON.parse(e)}catch(t){e={}}return[2,e]}catch(t){return console.log("%c getStorage failed err:",t,"color:red"),[2,{}]}return[2]}))}))},e.prototype.set=function(e){if("string"!=typeof e)try{e=JSON.stringify(e)}catch(e){}i.default.setStorage({key:this.key,data:e})},e.prototype.remove=function(){this.set({})},e}();t.default=s},function(e,t,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return o(t,e),t},s=this&&this.__awaiter||function(e,t,n,r){return new(n=n||Promise)((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):((t=e.value)instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){var c=[i,s];if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,(c=a?[2&c[0],a.value]:c)[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=0<(a=o.trys).length&&a[a.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3]))o.label=c[1];else if(6===c[0]&&o.label<a[1])o.label=a[1],a=c;else{if(!(a&&o.label<a[2])){a[2]&&o.ops.pop(),o.trys.pop();continue}o.label=a[2],o.ops.push(c)}}c=t.call(e,o)}catch(s){c=[6,s],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},l=(Object.defineProperty(t,"__esModule",{value:!0}),t.miniRequest=void 0,i(n(6)));try{var u=n(13),d=u&&u.cwx}catch(e){console.log("%c "+e,"color:red;")}var f=l.request;t.miniRequest=function(e){return s(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:try{e.data.head.auth=d&&d.user.auth||l.getStorageSync("auth")}catch(t){}return d?[3,2]:[4,f(e)];case 1:return[2,t.sent()];case 2:return[2,new Promise((function(t,n){d&&d.request(r(r({},e),{success:function(n){t(n),e.success(n)},fail:function(t){n(t),e.fail(t)}}))}))]}}))}))}},function(e,t,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return o(t,e),t},s=this&&this.__awaiter||function(e,t,n,r){return new(n=n||Promise)((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):((t=e.value)instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){var c=[i,s];if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,(c=a?[2&c[0],a.value]:c)[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=0<(a=o.trys).length&&a[a.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3]))o.label=c[1];else if(6===c[0]&&o.label<a[1])o.label=a[1],a=c;else{if(!(a&&o.label<a[2])){a[2]&&o.ops.pop(),o.trys.pop();continue}o.label=a[2],o.ops.push(c)}}c=t.call(e,o)}catch(s){c=[6,s],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},u=(Object.defineProperty(t,"__esModule",{value:!0}),t.isVoid=void 0,n(0)),d=n(47),f=n(49),p=n(104),m=l(n(106)),h=l(n(107)),v=l(n(108)),g=n(14),y=n(14),_=n(50),b=l(n(109)),I=i(n(8));t.default=function(e){var n,a=this,o=e.compVersion,i=e.componentType,l=e.visible,x=e.notUseCoupon,T=e.initCouponCode,k=e.data,S=e.showToast,C=e.logTrace,w=e.ensureUbtHasAttached,N=e.fetch,E=e.clientEnv,P=e.firstDidAmount,j=e.logMetric,O=e.miniType,D=e.auth,R=e.kmInfo,A=e.logger,M=e.timeout,V=e.onVisibleChange,L=e.onSelect,B=e.onAutoClaim,U=e.onError,Z=(console.log("%c \ud83c\udf48 props: ","font-size:20px;background-color: #465975;color:#fff;",e),u.useMemo((function(){var e;return R?new I.default({test:1,ubtKey:null==R?void 0:R.ubtKey,organizationId:null==R?void 0:R.organizationId,platform:null==(e=d.convertComptType(i))?void 0:e.platform},A):null}),[])),F=u.useMemo((function(){var e;return new I.default({ubtKey:_.CONST.DEVTRACE_KEY.DHT_KEY,organizationId:"51",platform:null==(e=d.convertComptType(i))?void 0:e.platform},A)}),[]),G=(ie=u.useState(l))[0],H=ie[1],q=(ie=u.useState(x))[0],K=ie[1],z=(ie=u.useState())[0],Y=ie[1],W=(ie=u.useState(""))[0],$=ie[1],X=(ie=u.useState({}))[0],J=ie[1],Q=(ie=u.useState([]))[0],ee=ie[1],te=(ie=u.useState(T))[0],ne=ie[1],re=(ie=u.useState(null))[0],ae=ie[1],oe=(ie=u.useState(!1))[0],ie=ie[1],se=(n=u.useState())[0],ce=n[1],le=(n=u.useState(!1))[0],ue=n[1],de=u.useMemo((function(){return d.getTimeZone()}),[]),fe=u.useMemo((function(){return{pageId:k.pageId,componentId:_.CONST.ComponentInfo.ORDER_USE_COUPON.id,componentName:_.CONST.ComponentInfo.ORDER_USE_COUPON.name,componentVersion:o,ubtSourceKey:_.CONST.UbtSourceKey[k.source]}}),[]),pe=[g.SaleChannel2Enum.Offline,g.SaleChannel3Enum.Offline].includes(k.saleChannel);function me(e,t){xe(_.CONST.DEVTRACE_KEY.CLICK,{module:e,strategyid:t})}u.useImperativeHandle(e.ref,(function(){return{show:function(){H(!0),xe(_.CONST.DEVTRACE_KEY.USECOUPON_INVOKE_SHOW)},hide:function(){H(!1),xe(_.CONST.DEVTRACE_KEY.USECOUPON_INVOKE_HIDE)}}})),u.useEffect((function(){return P&&P(),w&&w(k.pageId,E.clientType),function(){V&&V(!1)}}),[]),f.useDeepEffect((function(){!function(){s(this,void 0,void 0,(function(){var t,n;return c(this,(function(a){return t=new Promise((function(e,t){setTimeout((function(){t(new Error(y.ERRORCODE.TIMEOUT))}),M||_.CONST.TIMEOUT_USECOUPON_ONSELECT)})),n=function(){var t;return s(this,void 0,void 0,(function(){var n,a,o,i,s,l;return c(this,(function(c){switch(c.label){case 0:if(e.hasError)return[2];c.label=1;case 1:return c.trys.push([1,13,,14]),n=null==(t=k.extendInfoList)?void 0:t.map((function(e){var t=e.key;return e=e.value,{key:t,value:String(e)}})),a={baseInfo:ge(),bookingInfo:k.bookingInfo,isFirstValidate:!1,extendInfoList:n},a=r(r({},he),{query:m.default,queryName:_.CONST.QUERY_NAME.USE_COUPON,variables:a,componentInfo:fe}),[4,p.post(a)];case 2:return a=(c.sent()||{}).useCouponList,o=null==a?void 0:a.autoClaimResult,"true"===(null==(t=null==n?void 0:n.find((function(e){return e.key="needAutoReceive"})))?void 0:t.value)&&"function"==typeof B&&o&&(i={success:o.success,message:o.message,svcErroCode:o.svcErroCode,svcErrorMessage:o.svcErrorMessage},(s=((null==a?void 0:a.list)||[]).find((function(e){return e.couponCode==o.couponCode})))&&Object.assign(i,{claimedInfo:{promotionSecretId:o.promotionSecretId,couponCode:s.couponCode,promotionId:s.promotionId,couponName:s.couponName,deductionStrategyType:s.deductionStrategyType,deductionList:s.deductionList,deductionAmount:s.deductionAmount,matchedQuantity:s.matchedQuantity,promotionLabel:s.promotionLabel,extendInfo:s.extendInfo}}),B)&&B(i),s=a&&a.list?a.list:[],ee(s||[]),console.log("list2: ",s),x||q?[4,Te(null,s,g.UseStatusEnum.NotUse,z)]:[3,4];case 3:return c.sent()&&!q&&(K(!0),ne(null)),[2];case 4:return T?z!=g.SelectedByEnum.Default?[3,5]:(ve(s.filter((function(e){return e.status}))),[3,10]):[3,11];case 5:return[4,_e(T)];case 6:return(l=c.sent())&&l.available?[3,8]:[4,Te(null,s,g.UseStatusEnum.NotAvailable,z)];case 7:return c.sent()&&ne(null),[3,10];case 8:return[4,Te(l.couponInfo,s,g.UseStatusEnum.Use,z)];case 9:c.sent()&&ne(T),c.label=10;case 10:return[3,12];case 11:ve(s.filter((function(e){return e.status}))),c.label=12;case 12:return xe(_.CONST.DEVTRACE_KEY.USECOUPON_LOAD),[3,14];case 13:return Ie(c.sent()),[3,14];case 14:return[2]}}))}))}(),Promise.race([t,n]).catch((function(e){U&&U({name:e.name,errorCode:e.message,errorStack:(new Error).stack})})),[2]}))}))}()}),[e.data,e.hasError]),u.useEffect((function(){be()}),[k.locale]),u.useEffect((function(){x&&!q&&(K(!0),ne(null))}),[x]),u.useEffect((function(){H(l)}),[l]),u.useEffect((function(){G&&xe(_.CONST.DEVTRACE_KEY.EXPOSURE),V&&V(G)}),[G]);var he=u.useMemo((function(){return{env:E.env,client:E.clientType,fetch:N,logTrace:C,logMetric:j,isOffline:pe,ctType:E.ctType,auth:D,cid:k.clientId}}),[e]);function ve(e,t){void 0===t&&(t=0),s(this,void 0,void 0,(function(){var n,r,a;return c(this,(function(o){switch(o.label){case 0:return t>_.CONST.MAX_RETRY_TIME_VALIDATE_BEST||t+1>e.length?(n=null,[3,3]):[3,1];case 1:return[4,_e((r=e[t]).couponCode)];case 2:if(o.sent().available)n=r;else if(xe(_.CONST.DEVTRACE_KEY.USECOUPN_BESTSELECT_VALIDATEFAIL,{promotionId:r.promotionId,couponCode:r.couponCode}),t<_.CONST.MAX_RETRY_TIME_VALIDATE_BEST)return ve(e,++t),[2];o.label=3;case 3:return[4,Te(n,e,n?g.UseStatusEnum.Use:g.UseStatusEnum.NotUse,g.SelectedByEnum.Default)];case 4:return o.sent()&&(Y(g.SelectedByEnum.Default),ne((n||{}).couponCode),a={attrs:null==R?void 0:R.attrs,action:I.ActionType.change,scene:"\u7528\u5238\u7ec4\u4ef6",module:"\u9ed8\u8ba4\u4f18\u9009",value:""+((n||{}).couponCode||"\u6682\u65e0\u4f18\u9009"),role:I.RoleType.sys},null!=Z&&Z.logActionInfo(a),null!=F)&&F.logActionInfo(a),[2]}}))}))}var ge=u.useCallback((function(){return{channelId:k.saleChannel,allianceId:k.allianceId,siteId:k.siteId,clientId:k.clientId,source:k.source,utcOffset:de.offset,locale:k.locale,currency:k.currency,uid:pe?k.uid:"",rmsToken:k.rmsToken,requestScene:y.CouponRequestSceneEnum.OrderUse,version:o,componentType:i,miniType:O}}),[e.data]);function ye(){ae(null),void 0!==G&&H(!1),e.onClose&&e.onClose(),xe(_.CONST.DEVTRACE_KEY.USECOUPON_CLOSE)}function _e(e){var t;return s(this,void 0,void 0,(function(){var n,a,o,i,s;return c(this,(function(c){switch(c.label){case 0:return n=k.bookingInfo.shoppingId,a=null==(t=k.extendInfoList)?void 0:t.map((function(e){var t=e.key;return e=e.value,{key:t,value:String(e)}})),n={baseInfo:ge(),validateInfo:{couponCode:e,shoppingId:n,bookingInfo:k.bookingInfo,extendInfoList:a}},a=r(r({},he),{query:h.default,queryName:_.CONST.QUERY_NAME.VALIDATE,variables:n,componentInfo:fe}),[4,p.post(a)];case 1:return n=(c.sent()||{validateCoupon:{}}).validateCoupon,a=n.couponInfo,o=n.resultStatus,(i=o&&o.success&&0==o.errorCode)||(s={attrs:null==R?void 0:R.attrs,scene:"\u52fe\u9009\u7528\u5238",module:"\u4e1a\u52a1\u963b\u65ad",action:I.ActionType.change,value:o&&o.customerErrorMessage,key:_.CONST.KM_BLOCK_KEY.UseCoupon_ValidateFailed},null!=Z&&Z.logActionInfo(s),null!=F&&F.logActionInfo(s)),[2,{couponInfo:a,available:i,notAvailableMessage:o&&o.customerErrorMessage}]}}))}))}var be=u.useCallback((function(){return s(a,void 0,void 0,(function(){var t,n;return c(this,(function(a){switch(a.label){case 0:t={sharkLocale:e.data.locale},t=r(r({},he),{query:v.default,queryName:_.CONST.QUERY_NAME.SHARK,variables:t,componentInfo:fe}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,p.post(t)];case 2:return n=(a.sent()||{}).sharkData,J((void 0===n?{data:{}}:n).data),[3,4];case 3:return Ie(a.sent()),[3,4];case 4:return[2]}}))}))}),[e.data.locale,e.clientEnv]);function Ie(e){console.error(e),xe(_.CONST.DEVTRACE_KEY.JSERROR,{error:{name:e.name,message:e.message,stack:JSON.stringify(e.stack)}})}function xe(t,n){var a;if(C)try{var o={comptID:fe.componentName,ttdver:fe.componentVersion,productId:null==(a=k.bookingInfo)?void 0:a.productId,pagebu:k.source,state:{notUseCoupon:q,selectedBy:z,couponCodeText:W,selectedCouponCode:te,expandCode:re},props:r(r({},e.data),{visible:e.visible,clientEnv:e.clientEnv,initCouponCode:e.initCouponCode,notUseCoupon:e.notUseCoupon}),propsComplete:r({},e)},i={key:t,value:n?r(r({},n),o):o};C(i)}catch(t){console.error(t)}}function Te(e,n,r,a){return s(this,void 0,void 0,(function(){var o;return c(this,(function(i){switch(i.label){case 0:return o=((n||[]).filter((function(e){return e.isTopOne}))||[])[0],o={useStatus:r,selectedBy:null!=a?a:g.SelectedByEnum.UserSelect,availableCount:(n||[]).filter((function(e){return e.status})).length,couponInfo:e?{promotionId:e.promotionId,couponCode:e.couponCode,couponName:e.couponName,deductionAmount:e.deductionAmount,deductionList:e.deductionList,deductionStrategyType:e.deductionStrategyType,extendInfo:e.extendInfo,matchedQuantity:e.matchedQuantity,promotionLabel:e.promotionLabel}:null,isTopOne:!(!e||!o||o.couponCode!=e.couponCode)},xe(_.CONST.DEVTRACE_KEY.USECOUPON_ONSELECT,{options:o}),[4,L(o)];case 1:return o=i.sent(),t.isVoid(o)||!1!==o.success?[2,!0]:(S&&G&&S({className:"coupon_toast",content:o.message||X[b.default.errortoast],duration:1500,needMask:!1,type:"failed"}),[2,!1])}}))}))}return{ctrl:{validateCoupon:_e,handleSelectCoupon:function(e,t,n){return void 0===n&&(n=!0),s(this,void 0,void 0,(function(){var r;return c(this,(function(a){switch(a.label){case 0:return a.trys.push([0,6,7,8]),t?q?(n&&ye(),[2]):[4,Te(null,Q,g.UseStatusEnum.NotUse,g.SelectedByEnum.UserSelect)]:[3,2];case 1:return a.sent()&&(K(!0),ne(""),Y(g.SelectedByEnum.UserSelect),setTimeout((function(){n&&ye()}),0)),[3,5];case 2:return e?e==te?[2]:[4,_e(e)]:[3,5];case 3:return r=a.sent(),G&&!r.available?(S&&S({className:"coupon_toast",content:r.notAvailableMessage,duration:1500,needMask:!1,type:"failed"}),[2]):[4,Te(r.couponInfo,Q,g.UseStatusEnum.Use,g.SelectedByEnum.UserSelect)];case 4:a.sent()&&(ne(e),K(!1),Y(g.SelectedByEnum.UserSelect),setTimeout((function(){n&&ye()}),0)),a.label=5;case 5:return[3,8];case 6:return Ie(a.sent()),[3,8];case 7:return r={attrs:null==R?void 0:R.attrs,action:I.ActionType.change,scene:"\u7528\u5238\u7ec4\u4ef6",module:"\u52fe\u9009\u4f18\u60e0\u5238",value:t?"notUse":""+e,before:JSON.stringify({notUseCoupon:q,selectedBy:z,couponCodeText:W,selectedCouponCode:te}),role:I.RoleType.usr},null!=Z&&Z.logActionInfo(r),null!=F&&F.logActionInfo(r),[7];case 8:return[2]}}))}))},handleClickUseCoupon:function(e,t,n){return void 0===n&&(n=!0),s(this,void 0,void 0,(function(){var r;return c(this,(function(a){switch(a.label){case 0:if(null==e||""==e)return[2];a.label=1;case 1:return a.trys.push([1,4,,5]),me("CodeUse"),[4,_e(e)];case 2:return(r=a.sent()).available?[4,Te(r.couponInfo,Q,g.UseStatusEnum.Use,g.SelectedByEnum.UserInput)]:(G&&(t==y.ClientEnum.PC?(ue(!0),ce(r)):S&&S({className:"coupon_toast",content:r.notAvailableMessage,duration:1500,needMask:!1,type:"failed"})),[2]);case 3:return a.sent()&&($(""),K(!1),ne(e),Y(g.SelectedByEnum.UserInput),n)&&ye(),[3,5];case 4:return Ie(a.sent()),[3,5];case 5:return[2]}}))}))},handleClose:ye,handleTraceClick:me},modelState:{notUseCoupon:q,sharkData:X,couponCodeText:W,timezone:de,couponList:Q,selectedCouponCode:te,expandCode:re,componentInfo:fe,inScrolling:oe,validateCodeRst:se,showValidateMsg:le,visible:G},modelAction:{setInScrolling:ie,setNotUseCoupon:K,setCouponCodeText:$,setExpandCode:ae,setSelectedCouponCode:ne,setShowValidateMsg:ue}}},t.isVoid=function(e){return null==e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19);t.default={checkPageInfo:function(e){return e?e.contents&&e.contents.length?"":"contents \u4e0d\u80fd\u4e3a\u7a7a\uff01":"log \u4e0d\u80fd\u4e3a\u7a7a\uff01"},checkMessage:function(e){return e?"":"log \u4e0d\u80fd\u4e3a\u7a7a\uff01"},checkActionInfo:function(e){return e?e.action&&!Object.values(r.ActionType).includes(e.action)?"action \u679a\u4e3e\u7c7b\u578b\u9519\u8bef\uff01":e.action&&!(e.value||e.contents&&e.contents.length)?"action \u8bbe\u7f6e\u540e value \u6216 contents \u4e0d\u80fd\u4e3a\u7a7a\uff01":e.role&&!Object.values(r.RoleType).includes(e.role)?"role \u679a\u4e3e\u7c7b\u578b\u9519\u8bef\uff01":"":"log \u4e0d\u80fd\u4e3a\u7a7a\uff01"},checkError:function(e){return e?e.pageName?e.message?"":"message \u4e0d\u80fd\u4e3a\u7a7a\uff01":"pageName \u4e0d\u80fd\u4e3a\u7a7a\uff01":"log \u4e0d\u80fd\u4e3a\u7a7a\uff01"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19);function a(e){var t={attrs:e.attrs,scene:e.scene,module:e.module,action:"",key:e.key,value:e.value,before:e.before,desc:e.desc,contents:e.contents,jsonData:e.jsonData,rootMessageId:e.rootMessageId};return e.role||(e.role=r.RoleType.sys),e.action?t.action=e.role+"_"+e.action:t.action=e.role,t}t.default={pageInfo:function(e){return{contents:e.contents,action:"sys_pageinfo",attrs:e.attrs,desc:e.desc||"\u57fa\u672c\u4fe1\u606f"}},message:function(e){return a({scene:e})},actionInfo:function(e){return a(e)},error:function(e){var t="Error";return e.errorType&&Object.values(r.ErrorType).includes(e.errorType)&&(t=e.errorType),{category:"km_"+e.pageName+"_"+t,message:e.message,ex:e.ex}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={exception:function(e,t){"undefined"!=typeof console&&"function"==typeof console.error&&console.error("\ud83d\udc80\ud83d\udc80\ud83d\udc80[Devhub-Trace Fatal"+e+"]",t)},warn:function(e,t){t||(t="Unknown Exception"),"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("\u2757\ufe0f\u2757\ufe0f\u2757\ufe0f[Devhub-Trace Warning "+e+"]",t)},error:function(e,t){console&&"function"==typeof console.error&&console.error("\ud83d\udca3\ud83d\udca3\ud83d\udca3[Devhub-Trace Error"+e+"]",t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19);t.default=function(e,t){return{sendDevTrace:function(n){!function(e){if(!e)throw Error("Please new DevhubTrace with valid config");if(!Object.values(r.PlatformType).includes(e.platform))throw Error("Please setup platform in Config");if(!e.ubtKey)throw Error("Please setup ubtKey in Config")}(e),e.platform==r.PlatformType.web?function(e,t){var n=JSON.stringify(e);if("undefined"==typeof a)throw Error("window is not defined, please check platform in Config");a.__bfi=a.__bfi||[],a.__bfi.push(["_devTrace",t.ubtKey,n])}(n,e):e.platform==r.PlatformType.crn?function(e,t,n){if(void 0===n||"function"!=typeof n.logDevTrace)throw Error("Log.logDevTrace is not defined, please new DevhubTrace with @ctrip/crn.Log");var r={data:JSON.stringify(e)};t.targetPageRef&&(r.targetPageRef=t.targetPageRef),n.logDevTrace(t.ubtKey,r)}(n,e,t):e.platform==r.PlatformType.taro&&function(e,t,n){if(void 0===n||"function"!=typeof n.ubtDevTrace)throw Error("this.ubtDevTrace is not defined, please new DevhubTrace with taroBase.ubtDevTrace");var r=JSON.stringify(e);n.ubtDevTrace(t.ubtKey,{data:r})}(n,e,t)},sendError:function(n){!function(e){if(!e)throw Error("Please new DevhubTrace with valid config");if(!Object.values(r.PlatformType).includes(e.platform))throw Error("Please setup platform in Config");if(!e.ubtKey)throw Error("Please setup ubtKey in Config");if(!e.organizationId)throw Error("Please setup organizationId in Config")}(e),e.platform==r.PlatformType.web?function(e,t){if("undefined"==typeof a)throw Error("window is not defined, please check platform in Config");var n="";if(e.ex){var r=e.ex,o=r.stack,i=r.message,s=r.name;n=o||i||s}var c={version:11,organizationId:t,category:e.category,message:e.message,stack:n,appVer:"web"};a.__bfi=a.__bfi||[],a.__bfi.push(["_trackError",c])}(n,e.organizationId||"51"):e.platform==r.PlatformType.crn?function(e,t,n){if(void 0===n||"function"!=typeof n.logError)throw Error("Log.logError is not defined, new DevhubTrace with @ctrip/crn.Log");var r="";if(e.ex){var a=e.ex,o=a.stack,i=a.message,s=a.name;r=o||i||s}n.logError(e.category,e.message,t,{stack:r})}(n,e.organizationId||"51",t):e.platform==r.PlatformType.taro&&function(e,t,n){if(void 0===n||"function"!=typeof n.ubtTrackError)throw Error("this.ubtTrackError is not defined, new DevhubTrace with with taroBase.ubtTrackError");var r="";if(e.ex){var a=e.ex,o=a.stack,i=a.message,s=a.name;r=o||i||s}var c={version:15,organizationId:t,category:e.category,message:e.message,stack:r,appVer:"weixin"};n.ubtTrackError(c)}(n,e.organizationId||"51",t)}}}},function(e,t,n){(function(e,r){var a=n(10).default;Object.defineProperty(t,"__esModule",{value:!0});var o="[object Arguments]",i="[object Map]",s="[object Object]",c="[object Set]",l=/^\[object .+?Constructor\]$/,u=/^(?:0|[1-9]\d*)$/,d={},f=(d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d[o]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object Boolean]"]=d["[object DataView]"]=d["[object Date]"]=d["[object Error]"]=d["[object Function]"]=d[i]=d["[object Number]"]=d[s]=d["[object RegExp]"]=d[c]=d["[object String]"]=d["[object WeakMap]"]=!1,"object"==(void 0===e?"undefined":a(e))&&e&&e.Object===Object&&e),p="object"==("undefined"==typeof self?"undefined":a(self))&&self&&self.Object===Object&&self,m=f||p||Function("return this")(),h="object"==a(t)&&t&&!t.nodeType&&t,v=h&&"object"==a(r)&&r&&!r.nodeType&&r,g=v&&v.exports===h,y=g&&f.process,_=function(){try{return y&&y.binding&&y.binding("util")}catch(e){}}(),b=_&&_.isTypedArray;function I(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function x(e,t){return e.has(t)}function T(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function k(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var S,C,w,N=Array.prototype,E=Function.prototype,P=Object.prototype,j=m["__core-js_shared__"],O=E.toString,D=P.hasOwnProperty,R=(w=/[^.]+$/.exec(j&&j.keys&&j.keys.IE_PROTO||""))?"Symbol(src)_1."+w:"",A=P.toString,M=RegExp("^"+O.call(D).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),V=g?m.Buffer:void 0,L=m.Symbol,B=m.Uint8Array,U=P.propertyIsEnumerable,Z=N.splice,F=L?L.toStringTag:void 0,G=Object.getOwnPropertySymbols,H=V?V.isBuffer:void 0,q=(S=Object.keys,C=Object,function(e){return S(C(e))}),K=be(m,"DataView"),z=be(m,"Map"),Y=be(m,"Promise"),W=be(m,"Set"),$=be(m,"WeakMap"),X=be(Object,"create"),J=Ce(K),Q=Ce(z),ee=Ce(Y),te=Ce(W),ne=Ce($),re=L?L.prototype:void 0,ae=re?re.valueOf:void 0;function oe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ie(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function se(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ce(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new se;++t<n;)this.add(e[t])}function le(e){e=this.__data__=new ie(e),this.size=e.size}function ue(e,t){var n,r=Ee(e),a=!r&&Ne(e),o=!r&&!a&&Pe(e),i=!r&&!a&&!o&&Ae(e),s=r||a||o||i,c=s?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=c.length;for(n in e)!t&&!D.call(e,n)||s&&("length"==n||o&&("offset"==n||"parent"==n)||i&&("buffer"==n||"byteLength"==n||"byteOffset"==n)||ke(n,l))||c.push(n);return c}function de(e,t){for(var n=e.length;n--;)if(we(e[n][0],t))return n;return-1}function fe(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":(F&&F in Object(e)?Ie:Se)(e)}function pe(e){return Re(e)&&fe(e)==o}function me(e,t,n,r,a){return e===t||(null==e||null==t||!Re(e)&&!Re(t)?e!=e&&t!=t:function(e,t,n,r,a,l){var u=Ee(e),d=Ee(t),f=u?"[object Array]":Te(e),p=(d=d?"[object Array]":Te(t),(f=f==o?s:f)==s),m=(d=d==o?s:d)==s;if((d=f==d)&&Pe(e)){if(!Pe(t))return!1;p=!(u=!0)}return d&&!p?(l=l||new le,u||Ae(e)?ge(e,t,n,r,a,l):function(e,t,n,r,a,o,s){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new B(e),new B(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return we(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case i:var l=T;case c:if(l=l||k,e.size!=t.size&&!(1&r))return!1;var u=s.get(e);return u?u==t:(r|=2,s.set(e,t),u=ge(l(e),l(t),r,a,o,s),s.delete(e),u);case"[object Symbol]":if(ae)return ae.call(e)==ae.call(t)}return!1}(e,t,f,n,r,a,l)):1&n||(u=p&&D.call(e,"__wrapped__"),f=m&&D.call(t,"__wrapped__"),!u&&!f)?d&&function(e,t,n,r,a,o){var i=1&n,s=ye(e),c=s.length;if(c!=ye(t).length&&!i)return!1;for(var l=c;l--;){var u=s[l];if(!(i?u in t:D.call(t,u)))return!1}var d=o.get(e);if(d&&o.get(t))return d==t;for(var f,p=!0,m=(o.set(e,t),o.set(t,e),i);++l<c;){var h,v=e[u=s[l]],g=t[u];if(!(void 0===(h=r?i?r(g,v,u,t,e,o):r(v,g,u,e,t,o):h)?v===g||a(v,g,n,r,o):h)){p=!1;break}m=m||"constructor"==u}return p&&!m&&(d=e.constructor)!=(f=t.constructor)&&"constructor"in e&&"constructor"in t&&!("function"==typeof d&&d instanceof d&&"function"==typeof f&&f instanceof f)&&(p=!1),o.delete(e),o.delete(t),p}(e,t,n,r,a,l=l||new le):a(u?e.value():e,f?t.value():t,n,r,l=l||new le)}(e,t,n,r,me,a))}function he(e){return!(!De(e)||function(e){return!!R&&R in e}(e))&&(je(e)?M:l).test(Ce(e))}function ve(e){if(!function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||P)}(e))return q(e);var t,n=[];for(t in Object(e))D.call(e,t)&&"constructor"!=t&&n.push(t);return n}function ge(e,t,n,r,a,o){var i=1&n,s=e.length,c=t.length;if(s!=c&&!(i&&s<c))return!1;if((c=o.get(e))&&o.get(t))return c==t;var l=-1,u=!0,d=2&n?new ce:void 0;for(o.set(e,t),o.set(t,e);++l<s;){var f,p=e[l],m=t[l];if(void 0!==(f=r?i?r(m,p,l,t,e,o):r(p,m,l,e,t,o):f)){if(f)continue;u=!1;break}if(d){if(!I(t,(function(e,t){if(!x(d,t)&&(p===e||a(p,e,n,r,o)))return d.push(t)}))){u=!1;break}}else if(p!==m&&!a(p,m,n,r,o)){u=!1;break}}return o.delete(e),o.delete(t),u}function ye(e){return function(e,t,n){return t=t(e),Ee(e)?t:function(e,t){for(var n=-1,r=t.length,a=e.length;++n<r;)e[a+n]=t[n];return e}(t,n(e))}(e,Me,xe)}function _e(e,t){return e=e.__data__,function(e){var t=a(e);return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?e["string"==typeof t?"string":"hash"]:e.map}function be(e,t){return he(e=function(e,t){return null==e?void 0:e[t]}(e,t))?e:void 0}function Ie(e){var t=D.call(e,F),n=e[F];try{var r=!(e[F]=void 0)}catch(e){}var a=A.call(e);return r&&(t?e[F]=n:delete e[F]),a}oe.prototype.clear=function(){this.__data__=X?X(null):{},this.size=0},oe.prototype.delete=function(e){return e=this.has(e)&&delete this.__data__[e],this.size-=e?1:0,e},oe.prototype.get=function(e){var t,n=this.__data__;return X?"__lodash_hash_undefined__"===(t=n[e])?void 0:t:D.call(n,e)?n[e]:void 0},oe.prototype.has=function(e){var t=this.__data__;return X?void 0!==t[e]:D.call(t,e)},oe.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=X&&void 0===t?"__lodash_hash_undefined__":t,this},ie.prototype.clear=function(){this.__data__=[],this.size=0},ie.prototype.delete=function(e){var t=this.__data__;return!((e=de(t,e))<0||(e==t.length-1?t.pop():Z.call(t,e,1),--this.size,0))},ie.prototype.get=function(e){var t=this.__data__;return(e=de(t,e))<0?void 0:t[e][1]},ie.prototype.has=function(e){return-1<de(this.__data__,e)},ie.prototype.set=function(e,t){var n=this.__data__,r=de(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},se.prototype.clear=function(){this.size=0,this.__data__={hash:new oe,map:new(z||ie),string:new oe}},se.prototype.delete=function(e){return e=_e(this,e).delete(e),this.size-=e?1:0,e},se.prototype.get=function(e){return _e(this,e).get(e)},se.prototype.has=function(e){return _e(this,e).has(e)},se.prototype.set=function(e,t){var n=_e(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},ce.prototype.add=ce.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},ce.prototype.has=function(e){return this.__data__.has(e)},le.prototype.clear=function(){this.__data__=new ie,this.size=0},le.prototype.delete=function(e){var t=this.__data__;return e=t.delete(e),this.size=t.size,e},le.prototype.get=function(e){return this.__data__.get(e)},le.prototype.has=function(e){return this.__data__.has(e)},le.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ie){var r=n.__data__;if(!z||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new se(r)}return n.set(e,t),this.size=n.size,this};var xe=G?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,a=0,o=[];++n<r;){var i=e[n];t(i,n,e)&&(o[a++]=i)}return o}(G(e),(function(t){return U.call(e,t)})))}:function(){return[]},Te=fe;function ke(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||u.test(e))&&-1<e&&e%1==0&&e<t}function Se(e){return A.call(e)}function Ce(e){if(null!=e){try{return O.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function we(e,t){return e===t||e!=e&&t!=t}(K&&"[object DataView]"!=Te(new K(new ArrayBuffer(1)))||z&&Te(new z)!=i||Y&&"[object Promise]"!=Te(Y.resolve())||W&&Te(new W)!=c||$&&"[object WeakMap]"!=Te(new $))&&(Te=function(e){var t=fe(e);if(e=(e=t==s?e.constructor:void 0)?Ce(e):"")switch(e){case J:return"[object DataView]";case Q:return i;case ee:return"[object Promise]";case te:return c;case ne:return"[object WeakMap]"}return t});var Ne=pe(function(){return arguments}())?pe:function(e){return Re(e)&&D.call(e,"callee")&&!U.call(e,"callee")},Ee=Array.isArray,Pe=H||function(){return!1};function je(e){return!!De(e)&&("[object Function]"==(e=fe(e))||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e)}function Oe(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=9007199254740991}function De(e){var t=a(e);return null!=e&&("object"==t||"function"==t)}function Re(e){return null!=e&&"object"==a(e)}var Ae=b?function(e){return function(t){return e(t)}}(b):function(e){return Re(e)&&Oe(e.length)&&!!d[fe(e)]};function Me(e){return(function(e){return null!=e&&Oe(e.length)&&!je(e)}(e)?ue:ve)(e)}t.default=function(e,t){return me(e,t)}}).call(this,n(22),n(99)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getMillisecondsToZero=t.setTimeTask4TimingCoupon=t.getLoadDataChunk=void 0,t.getLoadDataChunk=function(e){var t={availableClaimList:[],availableUseList:[],receivedNouseList:[],robbedList:[],expiredList:[],notStartedList:[],singkekList:[]};function n(e){return{promotionId:e.promotionId,promotionSecretId:e.promotionSecretId,couponCode:e.couponCode,couponName:e.couponName,deductionStrategyType:e.deductionStrategyType,deductionList:e.deductionList,deductionAmount:e.deductionAmount,matchedQuantity:e.matchedQuantity,promotionLabel:e.promotionLabel,extendInfo:e.extendInfo}}function r(e){switch(e.promotionStatus){case 1:t.availableClaimList.push(n(e));break;case 2:t.availableUseList.push(n(e));break;case 3:t.receivedNouseList.push(n(e));break;case 4:t.robbedList.push(n(e));break;case 5:t.expiredList.push(n(e));break;case 6:t.notStartedList.push(n(e));break;case 7:t.singkekList.push(n(e))}}return(e.claimList||[]).forEach((function(e){r(e)})),(e.useableList||[]).forEach((function(e){e.status?e.promotionStatus=2:e.promotionStatus=3,r(e)})),t},t.setTimeTask4TimingCoupon=function(e,t,n,r,a){var o;return(t-=e)<=0?(n(),null):(e=void 0,e=3e3<t?(t-=3e3,o=r,"task2"):(o=n,"task1"),"function"==typeof console.group&&console.group(a||"mainKey"),console.log("%cNext task execution function\uff1a","color:#8000FF",e),console.log("%cNext task execution time\uff08ms\uff09\uff1a","color:#8000FF",t),"function"==typeof console.groupEnd&&console.groupEnd(),setTimeout((function(){o()}),t))},t.getMillisecondsToZero=function(e){return 1e3*(60*(60*(24-(e=new Date(e)).getHours())-e.getMinutes())-e.getSeconds())-e.getMilliseconds()}},function(e,t,n){var r,a,o=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},i=(Object.defineProperty(t,"__esModule",{value:!0}),t.formatShark=void 0,n(48));t.formatShark=function(e,t){if(null==e||""===e)return"";if(!i.isEmpty(t))if(Array.isArray(t))for(var n=0;n<t.length;n++)e=e.replace(new RegExp(String.raw(r=r||o(["$(",")"],["\\$\\(","\\)"]),n),"g"),t[n]);else if(i.isObject(t))for(var s in t)e=e.replace(new RegExp(String.raw(a=a||o(["$(",")"],["\\$\\(","\\)"]),s),"g"),t[s]||"");return e}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.device_Width=null,this.device_Height=null,this.device_Height=e.deviceHeight,this.device_Width=e.deviceWidth,this.inNotchIphone=this.inNotchIphone.bind(this),this.getHeaderHeight=this.getHeaderHeight.bind(this)}return e.prototype.inNotchIphone=function(){var e=this;try{return!!this.inIOSDevice()&&[[375,812],[390,844],[414,896],[428,926]].some((function(t){return t[0]===e.device_Width&&t[1]===e.device_Height}))}catch(e){return!1}},e.prototype.getHeaderHeight=function(){try{var e=22;return this.inNotchIphone()?44:e}catch(e){return console.error("getHeaderHeight error. ",e),0}},e}();t.default=n},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){console.log(" constructor inertia instance. "),this.ele=e;var n,r={edge:!0,isIOSApp:!1},a={};for(n in t=t||{},r)void 0!==t[n]?a[n]=t[n]:a[n]=r[n];this.config=a}return e.prototype.init=function(){var e,t,n,r=this,s={distanceX:0,distanceY:0},c=a.innerWidth,l=a.innerHeight;this.ele&&(e=r.config.isIOSApp?64:44,t=function(e,t){e=Math.round(1e3*e)/1e3,t=Math.round(1e3*t)/1e3,r.ele.style.webkitTransform="translate("+e+"px, "+t+"px)",r.ele.style.transform="translate3d("+e+"px, "+t+"px, 0)",r.ele.distanceX=e,r.ele.distanceY=t},r.ele.style.visibility="visible",((n=r.ele.getBoundingClientRect()).left<-.5*n.width||n.top<-.5*n.height||n.right>c+.5*n.width||n.bottom>l+.5*n.height)&&t(0,0),r.ele.addEventListener("touchstart",(function(e){r.ele.style.webkitTransition="",r.ele.style.transition="",e=e.touches[0]||e,s.posX=e.pageX,s.posY=e.pageY,s.touching=!0,isNaN(r.ele.distanceX)||(s.distanceX=r.ele.distanceX),isNaN(r.ele.distanceY)||(s.distanceY=r.ele.distanceY),s.bound=r.ele.getBoundingClientRect(),s.timerready=!0})),o.addEventListener("touchmove",(function(n){var r,a,o,i,u;!0===s.touching&&(1==s.timerready&&(s.timerstart=+new Date,s.timerready=!1),n.preventDefault(),n=n.touches[0]||n,s.nowX=n.pageX,s.nowY=n.pageY,a=s.bound.left+(n=s.nowX-s.posX),o=s.bound.top+(r=s.nowY-s.posY),i=a+s.bound.width,u=o+s.bound.height,a<0&&(n-=a),o<e&&(r-=o-e),c<i&&(n-=i-c),l<u&&(r-=u-l),t(s.distanceX+n,s.distanceY+r))}),{passive:!1}),o.addEventListener("touchend",(function(){var n,a,o,u,d,f,p,m;!1!==s.touching&&(s.touching=!1,s.timerend=+new Date,s.nowX)&&s.nowY&&(n=s.nowX-s.posX,a=s.nowY-s.posY,Math.abs(n)<5&&Math.abs(a)<5||(o=Math.sqrt(n*n+a*a),u=o/(s.timerend-s.timerstart)*16.666,d=Math.min(10,u),s.inertiaing=!0,p=f=.8,(m=function(){if(1==s.touching)s.inertiaing=!1;else{var h=f*(u-=u/d)*n/o,v=p*u*a/o,g=r.ele.getBoundingClientRect();if(h<0&&g.left+h<0?(h=0-g.left,f=.1):0<h&&g.right+h>c&&(h=c-g.right,f=.1),v<0&&g.top+v<e?(v=-1*(g.top-e),p=.1):0<v&&g.bottom+v>l&&(v=l-g.bottom,p=.1),g=r.ele.distanceX+h,h=r.ele.distanceY+v,t(g,h),u<.1)if((u=0)==r.config.edge)s.inertiaing=!1;else{var y=function(e,t){1!=s.touching?(r.ele.style.webkitTransition="all .5s ease",r.ele.style.transition="all .5s ease",r.ele.style.webkitTransform="translate("+e+"px, "+t+"px)",r.ele.style.transform="translate3d("+e+"px, "+t+"px, 0)",r.ele.distanceX=e,r.ele.distanceY=t,s.inertiaing=!1):s.inertiaing=!1},_=(g=(v=r.ele.getBoundingClientRect()).left+v.width/2,h=c-g-v.width/2,v.top+v.height/2),b=l-_-v.height/2;if((h=Math.min(g,h,_,b))===_){var I=-(c-v.right),x=-(l-137);y(I,x)}else h===b?y(I=-(c-v.right),x=60):y(I=h===g?-(c-61):0,x=-(l-60-v.bottom))}else i(m)}})()))})))},e}();t.default=n},function(e,t,n){(function(e,r){var a,o,i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,r){return new(n=n||Promise)((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):((t=e.value)instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){var c=[i,s];if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,(c=a?[2&c[0],a.value]:c)[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=0<(a=o.trys).length&&a[a.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3]))o.label=c[1];else if(6===c[0]&&o.label<a[1])o.label=a[1],a=c;else{if(!(a&&o.label<a[2])){a[2]&&o.ops.pop(),o.trys.pop();continue}o.label=a[2],o.ops.push(c)}}c=t.call(e,o)}catch(s){c=[6,s],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},l=(Object.defineProperty(t,"__esModule",{value:!0}),t.post=void 0,n(23)),u=n(14),d=n(47),f=n(50);try{var p=n(34).ClientUtil,m=p&&"function"==typeof p.getInstance?p.getInstance():{}}catch(e){console.warn("can't resolve '../../utils/index'")}var h=n(51),v=b()&&(null==(o=r.env)?void 0:o.DEBUG_BFF),g=((a={})[u.CTEnum.CTRIP]={debug:"localhost:8004",dev:"gateway.m.fws.qa.nt.ctripcorp.com/restapi",fat:"gateway.m.fws.qa.nt.ctripcorp.com/restapi",uat:"gateway.m.uat.qa.nt.ctripcorp.com/restapi",prod:"m.ctrip.com/restapi"},a[u.CTEnum.TRIP]={debug:"m.ctrip.fat468.qa.nt.ctripcorp.com",dev:"uk.fat1.qa.nt.tripqate.com/restapi",fat:"uk.fat1.qa.nt.tripqate.com/restapi",uat:"uk.fat1.qa.nt.tripqate.com/restapi",prod:"www.trip.com/restapi"},a),y={debug:"m.ctrip.fat468.qa.nt.ctripcorp.com",dev:{fat6:"marketing.service.ttd.fat6.qa.nt.ctripcorp.com",fat1204:"marketing.service.ttd.fat1204.qa.nt.ctripcorp.com"},fat:{fat6:"marketing.service.ttd.fat6.qa.nt.ctripcorp.com",fat1204:"marketing.service.ttd.fat1204.qa.nt.ctripcorp.com"},uat:"marketing.service.ttd.uat.qa.nt.ctripcorp.com",prod:"offline.fx.ctripcorp.com"};function _(t,n,r,a){var o=((a=void 0!==a&&a)?y:g[r])[t=v?"debug":t],i=null==m?void 0:m.inApp;return"prod"!==t&&(n==u.ClientEnum.NATIVE||"function"==typeof i&&i())&&r==u.CTEnum.TRIP&&(o=g[u.CTEnum.CTRIP][t]),i="",t==u.EnvEnum.Fat&&(i="fat1204",o=a?o[i]:o,n==u.ClientEnum.H5||n==u.ClientEnum.PC?i=d.getUrlParams("subEnv")||i:n==u.ClientEnum.NATIVE&&(i=e.currentApp&&e.currentApp.props.urlQuery.subEnv||i)),""+function(e){return e==u.ClientEnum.NATIVE?"https://":e==u.ClientEnum.MiniProgram?v?"http://":"https://":"//"}(n)+o+function(e,t,n){return e==u.EnvEnum.Prod&&t?"/ttd/middleBff":v||t?"/ttd/marketing-bff":"/ttd/marketing-bff"+(n?"-"+n:"")}(t,a,i)+"/graphql"}function b(){return void 0!==r&&!!r}function I(t){try{var n=null;return t==u.ClientEnum.H5||t==u.ClientEnum.PC?n=d.getUrlParams("mock"):t==u.ClientEnum.NATIVE&&(n=e.currentApp&&e.currentApp.props.urlQuery.mock),!!n}catch(t){return console.error("isMock error.",t),!1}}t.post=function(e){var t,n;return s(this,void 0,void 0,(function(){var a,o,s,d,p,m,v,g,y,x,T,k,S,C,w,N;return c(this,(function(c){switch(c.label){case 0:a=e.query,o=e.env,s=e.client,d=e.queryName,p=e.variables,m=e.fetch,v=e.logTrace,C=e.isOffline,g=e.logMetric,T=void 0===(T=e.ctType)?u.CTEnum.CTRIP:T,y=void 0!==(y=e.apiPost)&&y,x=void 0===(x=e.componentInfo)?{}:x,T=_(o,e.client,T,C),c.label=1;case 1:return c.trys.push([1,6,,7]),k={path:T,env:o,params:{query:a,queryName:d,variables:p,head:{cid:e.cid},mock:I(s)},timeout:f.CONST.TIMEOUT_BFF_REQUEST},s==u.ClientEnum.NATIVE&&(k.fetch=m,k.needStringifyBody=!1,k.logMetric=g),console.log("%c"+d+"%c-BFFRequest","color:#01A9DB","color:#FFFF00",k),S=void 0,s!=u.ClientEnum.MiniProgram?[3,3]:(C=function(e){var t;return{url:e.path+"/"+e.params.queryName,data:i(i({},e.params),{head:i(i({},null==(t=e.params)?void 0:t.head),{miniAuth:"82E962A110D92E1B58E8FB03B15FC60D4720855F333886095B968C3977D945F4"})}),header:{"content-type":"application/json"},dataType:"json",method:"POST",success:function(t){console.log("%c "+e.params.queryName,"color:#0f0;",t.data)},fail:function(t){console.log("%c "+e.params.queryName,"color:red;",t.data)}}}(k),[4,m(C)]);case 2:return w=c.sent(),S=w.data||{},[3,5];case 3:return[4,l.load(k).then((function(e){return"function"==typeof e.json?e.json():e}))];case 4:S=c.sent(),c.label=5;case 5:return console.log("%c"+d+"%c-BFFRespose","color:#01A9DB","color:#00FF00",S),b()&&"development"==(null==(t=r.env)?void 0:"production")&&function(e){if(!e)throw new Error("graphql-bff ,Query Result Empty.");var t=[];Object.keys(e).map((function(n){var r=e[n];"Error"==r.__typename&&t.push(n+"\uff1a\ncode\uff1a"+r.code+",message\uff1a"+r.message)})),0<t.length&&console.error(t.join("\n"))}(S.data),function(e,t,n,r,a){if(void 0===r&&(r=!1),void 0===a&&(a={}),e)try{var o=((t.extensions||{}).SoaResponseStatus||{}).ResponseStatus;e({key:h.DEVTRACE_KEY.BFF_EXTENSION,value:{queryName:n,extensions:(o||{}).Extension,apiPost:r,componentInfo:a}})}catch(t){e({key:h.DEVTRACE_KEY.POST_EXCEPTION,value:{error:t,queryName:n,funName:"logTraceCatMsgId",apiPost:r,errStack:null==t?void 0:t.stack,componentInfo:a}})}}(v,S,d,y,x),w=(null==(n=null==(n=null==(t=null==S?void 0:S.extensions)?void 0:t.SoaResponseStatus)?void 0:n.ResponseStatus)?void 0:n.Extension)||[],N=(null==(n=null==(n=null===w?void 0:w.find)?void 0:n.call(w,(function(e){return"RootMessageId"===e.Id})))?void 0:n.Value)||"",S.data&&(S.data.rootMessageId=N),[2,S.data];case 6:return N=c.sent(),console.log(N.stack),v&&v({key:h.DEVTRACE_KEY.POST_EXCEPTION,value:{error:N,queryName:d,funName:"post",apiPost:y,errStack:null==N?void 0:N.stack,componentInfo:x}}),[3,7];case 7:return[2]}}))}))}}).call(this,n(22),n(36))},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={TITLE:"key.couponcenter.receivedetailspage.title",USECODELIST_TITLE:"key.couponcenter.usecodelist.title",PROMOTIONCODE_PLACEHOLDER:"key.couponcenter.usecodelist.promocode_placeholder",USECODELIST_USE:"key.couponcenter.usecodelist.use",VALIDATY_TIMEZONE:"key.couponcenter.common.validitytimezone",AVAILABLECODES_TITLE:"key.couponcenter.usecodelist.availablecodes_title",DONOTUSECODE:"key.couponcenter.usecodelist.donotusecode",AVAILABLE_CURRENCY_AMOUNT:"key.couponcenter.usecodelist.availablecurrencyamount",UNAVAILABLE_REASON:"key.couponcenter.usecodelist.unavailablereason",USECODELIST_NOCODE:"key.couponcenter.usecodelist.nocode",POPUP_CLAIM:"key.couponcenter.popup.claimall",RECEIVESTATUS_RECEIVED:"key.couponcenter.common.receivestatus_received",POPUP_CLAIMED:"key.couponcenter.popup.claimed",POP_TOUSE:"key.couponcenter.popup.touse",TERMS_CONDITIONS:"key.couponcenter.common.termsandconditions",COMMON_DETAILS:"key.couponcenter.common.details",CURRENCYAMOUNT_TIERS:"key.couponcenter.common.currencyamount_tiers",PERCENTAGE_TIERS:"key.couponcenter.common.percentage_tiers",POPUP_OUTOFSTOCK:"key.couponcenter.popup.outofstock",NEWUSER_ONLY:"key.couponcenter.common.receivestatus_newuseronly",CURRENCYAMOUNT_OFF:"key.couponcenter.common.currencyamount_off",FAILURE_NOTICE:"key.couponcenter.popup.failurenotice",SUCCESS_NOTICE:"key.couponcenter.popup.successnotice",PROMOTIONCODE:"key.couponcenter.common.promocode",VALIDITY:"key.couponcenter.common.validity",RECEIVE:"key.couponcenter.common.receive",USECODES_PROMPT:"key.couponcenter.receivedetailspage.usablecodes_prompt",RECEIVABLECODES_TITLE:"key.couponcenter.receivedetailspage.receivablecodes_title",USEABLECODES_TITLE:"key.couponcenter.receivedetailspage.usablecodes_title",USEABLECODES_SUBTITLES:"key.couponcenter.receivedetailspage.usablecodes_subtitle",CANNOT_RECEIVE:"key.couponcenter.common.receivestatus_cannotreceive",NULL_ERROR:"key.couponcenter.popup.failurenotice.nullerror",CROSS_TITLE:"key.couponcenter.crosscouponlist.title",CROSS_BEFOREBOOKING_SUBTITLE:"key.couponcenter.crosscouponlist.beforebooking.subtitle",CROSS_AFTERBOOKING_SUBTITLE:"key.couponcenter.crosscouponlist.afterbooking.subtitle",CROSS_DETAIL:"key.couponcenter.crosscouponlist.promodetail",CROSS_VALIDPERIOD_TIITLE:"key.couponcenter.crosscouponlist.promovalidperiod.titile",CROSS_USEDETAIL:"key.couponcenter.crosscouponlist.promousedetail",CROSS_BULINE_USER_PROMO:"key.couponcenter.crosscouponlist.businesslineuserpromo",CROSS_BULINE_USER:"key.couponcenter.crosscouponlist.businesslineuser"}},function(e,t,n){var r,a=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},o=(Object.defineProperty(t,"__esModule",{value:!0}),n(23)),i=n(52),s=o.gql(r=r||a(["\n    ","\n    query($baseInfo:BaseInfoType,$bookingInfo:BookingInfoType,$extendInfoList:[ExtendInfoType],$isFirstValidate:Boolean,\n    $limit:Int=0,$queryShark:Boolean=false,$sharkLocale:String){\n        useCouponList:getUseCouponList(baseInfo:$baseInfo,bookingInfo:$bookingInfo,extendInfoList:$extendInfoList, isFirstValidate:$isFirstValidate,limit:$limit) {\n            __typename\n           ...on UseCouponData{\n               list{\n                    ...couponInfoFields\n               }\n               autoClaimResult{\n                    success\n                    message\n                    couponCode\n                    promotionId\n                    promotionSecretId\n                    svcErroCode\n                    svcErrorMessage\n               }\n           }\n           ...on Error{\n               message\n               code\n           }\n        }\n        sharkData:getShark(local:$sharkLocale) @include(if: $queryShark) {\n            __typename\n           ...on SharkData{\n               data\n           }\n           ...on Error{\n               message\n               code\n           }\n        }\n     }  \n"],["\n    ","\n    query($baseInfo:BaseInfoType,$bookingInfo:BookingInfoType,$extendInfoList:[ExtendInfoType],$isFirstValidate:Boolean,\n    $limit:Int=0,$queryShark:Boolean=false,$sharkLocale:String){\n        useCouponList:getUseCouponList(baseInfo:$baseInfo,bookingInfo:$bookingInfo,extendInfoList:$extendInfoList, isFirstValidate:$isFirstValidate,limit:$limit) {\n            __typename\n           ...on UseCouponData{\n               list{\n                    ...couponInfoFields\n               }\n               autoClaimResult{\n                    success\n                    message\n                    couponCode\n                    promotionId\n                    promotionSecretId\n                    svcErroCode\n                    svcErrorMessage\n               }\n           }\n           ...on Error{\n               message\n               code\n           }\n        }\n        sharkData:getShark(local:$sharkLocale) @include(if: $queryShark) {\n            __typename\n           ...on SharkData{\n               data\n           }\n           ...on Error{\n               message\n               code\n           }\n        }\n     }  \n"]),i.couponInfoFields);t.default=s},function(e,t,n){var r,a=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},o=(Object.defineProperty(t,"__esModule",{value:!0}),n(23)),i=n(52),s=o.gql(r=r||a(["\n    ","\n     query($baseInfo:BaseInfoType,$validateInfo:ValidateInfoType){\n        validateCoupon:validateCoupon(baseInfo:$baseInfo,validateInfo:$validateInfo){\n            __typename\n           ...on ValidateCouponData{\n                    couponInfo{\n                            ...couponInfoFields\n                    }\n                    resultStatus{\n                        success\n                        errorCode\n                        customerErrorMessage\n                    }\n           }\n           ...on Error{\n               message\n               code\n           }\n        }\n       \n     }  \n"],["\n    ","\n     query($baseInfo:BaseInfoType,$validateInfo:ValidateInfoType){\n        validateCoupon:validateCoupon(baseInfo:$baseInfo,validateInfo:$validateInfo){\n            __typename\n           ...on ValidateCouponData{\n                    couponInfo{\n                            ...couponInfoFields\n                    }\n                    resultStatus{\n                        success\n                        errorCode\n                        customerErrorMessage\n                    }\n           }\n           ...on Error{\n               message\n               code\n           }\n        }\n       \n     }  \n"]),i.couponInfoFields);t.default=s},function(e,t,n){var r,a=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},o=(Object.defineProperty(t,"__esModule",{value:!0}),n(23)).gql(r=r||a(["\n    query($sharkLocale:String){\n        sharkData:getShark(local:$sharkLocale) {\n            __typename\n           ...on SharkData{\n               data\n           }\n           ...on Error{\n               message\n               code\n           }\n        }\n    }\n"],["\n    query($sharkLocale:String){\n        sharkData:getShark(local:$sharkLocale) {\n            __typename\n           ...on SharkData{\n               data\n           }\n           ...on Error{\n               message\n               code\n           }\n        }\n    }\n"]));t.default=o},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={Title:"key.couponcenter.receivedetailspage.title",Claim:"key.couponcenter.popup.claimall",Received:"key.couponcenter.common.receivestatus_received",Claimed:"key.couponcenter.popup.claimed",ToUse:"key.couponcenter.popup.touse",UseDesc:"key.couponcenter.common.termsandconditions",DetailDesc:"key.couponcenter.common.details",CurrencyAmount:"key.couponcenter.common.currencyamount_tiers",CurrencyAmount_two:"key.couponcenter.common.percentage_tiers",Robbed:"key.couponcenter.popup.outofstock",NowDisdount:"key.couponcenter.common.currencyamount_off",claimFailed:"key.couponcenter.popup.failurenotice",claimSuccess:"key.couponcenter.popup.successnotice",timeZoneDesc:"key.couponcenter.common.validitytimezone",promoCode:"key.couponcenter.common.promocode",validityDate:"key.couponcenter.common.validity",receive:"key.couponcenter.common.receive",noContent:"key.couponcenter.receivedetailspage.usablecodes_prompt",subTitle:"key.couponcenter.receivedetailspage.usablecodes_subtitle",claimTitle:"key.couponcenter.receivedetailspage.receivablecodes_title",useTitle:"key.couponcenter.receivedetailspage.usablecodes_title",nullError:"key.couponcenter.popup.failurenotice.nullerror",newuseronly:"key.couponcenter.common.receivestatus_newuseronly",errortoast:"key.couponcenter.common.errortoast.common"}},function(e,t,n){var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},c=(Object.defineProperty(t,"__esModule",{value:!0}),t.UseCouponCard=void 0,s(n(0))),l=n(1),u=n(34),d=(n(111),function(e){function t(t){var n=e.call(this,t)||this;return n.handleSelect_throttle=function(){n.timer||(n.props.handleSelect(n.props.couponCode,!1,n.props.closeAfterSelect),n.props.handleTraceClick("AvailableCoupon",n.props.promotionId)),n.timer=setTimeout((function(){n.timer=null}),1e3)},n}return a(t,e),t.prototype.render=function(){var e=this,t=this.props,n=(t.groupId,t.positionId,t.couponCode),r=t.couponType,a=t.status,o=t.promotionId,i=t.unavailableReasonShown,s=t.deductionInfoShown,d=(t.deductionAmount,t.detailRemarkShown),f=t.handleExpand,p=t.expanded,m=t.handleTraceClick;return c.createElement(l.View,{className:"coupon_block"},c.createElement(l.View,{className:"coupon_info "+(a?"available":"notAvailable")},c.createElement(l.View,{className:"info_deduction",onClick:function(){f(p?null:n),m("Detail",o)}},s.fullDeduction?c.createElement(l.View,{className:"deduction_fullamount"},s.desc):c.createElement(l.View,null,c.createElement(l.View,{className:"deduction_part1 font10px"},s.desc),c.createElement(l.View,{className:"deduction_part2"},4==s.type?c.createElement("span",{className:""},s.desc):c.createElement(c.Fragment,null,c.createElement(l.View,{className:"deduction_amount"},s.amount),c.createElement(l.View,{className:"deduction_unit"},s.discountUnit))),a&&s.deductionAmountTag&&c.createElement(l.View,{className:"deduction_part3"},s.deductionAmountTag))),c.createElement(l.View,{className:"info_desc",onClick:function(){f(p?null:n),m("Detail",o)}},c.createElement(l.View,{className:"desc_name"},this.props.couponName),c.createElement(l.View,{className:"desc_middle"},c.createElement(l.View,{className:"desc_shortremark"},this.props.shortRemark),!!this.props.useDateShown&&c.createElement(l.View,{className:"desc_usedate"},this.props.useDateShown)),c.createElement(l.View,{className:"desc_detail"},c.createElement(l.View,{className:"font10px"},"\u8be6\u7ec6\u8bf4\u660e"),c.createElement(l.View,{className:"expandicon"},this.props.expanded?c.createElement(l.Text,{className:"expandicon_text"},"\ue946"):c.createElement(l.Text,{className:"expandicon_text"},"\ue945")))),!!a&&c.createElement(l.View,{className:"desc_select",onClick:function(){return e.handleSelect_throttle()}},this.props.selected?c.createElement(l.View,{className:"coupon_select_icon"},"\ued1e"):c.createElement(l.View,{className:"coupon_select_icon"},"\uee35"))),this.props.expanded&&c.createElement(l.View,{className:"coupon_detail_div"},s&&s.deductionList&&u.chunk(s.deductionList,2).map((function(e,t){return c.createElement(l.View,{className:"detail_deduction_list",key:t},e.map((function(e,t){return c.createElement(l.View,{key:t,className:"deduction_info_div"},c.createElement(l.View,{className:"font10px"},e))})))})),c.createElement(l.View,{className:"detail_remark_list"},(d||[]).map((function(e,t){return c.createElement(l.View,{key:t,className:"detail_remark_list_text"},e)}))),1==r&&c.createElement(l.View,{className:"detail_remark_code"},"\u4f18\u60e0\u5238\u7801\uff1a",n)),!a&&c.createElement(l.View,{className:"coupon_reason_div "+(this.props.expanded?"withexpand":"")},c.createElement(l.View,{className:"icon_info font10px"},"\uf4d5"),c.createElement(l.View,{className:"reason_list_div"},(i||[]).map((function(e,t){return c.createElement(l.View,{key:t,className:"font10px"},e)})))))},t}(c.PureComponent));t.UseCouponCard=d},function(e,t,n){"use strict";n.r(t)},function(e,t,n){"use strict";n.r(t)},function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},i=(Object.defineProperty(t,"__esModule",{value:!0}),o(n(0))),s=n(1);n(114),t.default=function(e){function t(){c(!1),e.onClose&&e.onClose()}var n=void 0===(n=e.title)?"\u9009\u62e9\u4f18\u60e0\u5238":n,r=void 0===(r=e.needPopover)||r,a=i.useState(e.visible),o=a[0],c=a[1];return i.useEffect((function(){c(e.visible)}),[e.visible]),i.default.createElement(s.View,{className:"ttd-useCoupon "+(o?"ttd-marketing-show":"ttd-marketing-hidden")},r&&i.default.createElement(s.View,{className:"ttd-marketing-mask "+(o?"":"displayNone"),onClick:t,catchMove:!0}),i.default.createElement(s.View,{className:"ttd-marketing-half-screen-"+(r?"dialog":"block")+" "+(o?"":"displayNone"),catchMove:!0},r&&i.default.createElement(s.View,{className:"ttd-marketing-half-claim-header"},i.default.createElement(s.View,{className:"ttd-marketing-half-claim-header-close ttd-marketing-icon-close",hoverClass:"ttd-marketing-close-active",onClick:t}),i.default.createElement(s.View,{className:"ttd-marketing-half-claim-header-title"},n),i.default.createElement(s.View,{className:"ttd-marketing-half-claim-header-right"})),i.default.createElement(s.View,{className:"ttd-marketing-half-useCoupon-error"},i.default.createElement(s.Image,{className:"error-img",src:"https://pic.c-ctrip.com/VacationH5Pic/tangram-pic/coupon_empty.png"}),i.default.createElement(s.View,{className:"error-text1"},"\u52a0\u8f7d\u672a\u6210\u529f"),i.default.createElement(s.View,{className:"error-text2"},"\u5982\u957f\u65f6\u95f4\u672a\u89e3\u51b3\u8bf7\u8054\u7cfb\u643a\u7a0b\u5ba2\u670d"),i.default.createElement(s.Button,{className:"retry",onClick:e.handleRetry},"\u5728\u8bd5\u4e00\u6b21"))))}},function(e,t,n){"use strict";n.r(t)},function(e,t,n){"use strict";var r=n(27).default,a=n(29).default,o=n(21).default,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=c(n(0)),d=n(1),f=l(n(6));n(116);var p={full:1,taller:.94,tall:.8,middle:.6,short:.4};t.default=function(e){var t=u.useRef(null),n=u.useRef(null),i=u.useState(0),s=o(i,2),c=s[0],l=s[1],m=u.useState(0),h=o(m,2),v=h[0],g=h[1],y=f.default.getSystemInfoSync().windowHeight,_=u.useState(!0),b=o(_,2),I=b[0],x=b[1],T=e.id,k=void 0===T?"JS-popup":T,S=e.disableScroll,C=void 0!==S&&S,w=e.needMoreHeight,N=void 0!==w&&w,E=e.renderTitle,P=e.topChildren,j=e.height,O=void 0===j?"taller":j,D=e.handleClose,R=e.handleScroll,A=e.scrollTop,M=e.scrollIntoView,V=e.setTabIndex,L=void 0===V?function(){}:V,B=e.listName,U=void 0===B?[]:B,Z=e.showTitleHeight,F=e.noUseEffect,G=void 0!==F&&F,H=e.testId,q=void 0===H?"":H,K=e.closeTestId,z=void 0===K?"":K,Y="full"===O,W=u.useState(!!Z),$=o(W,2),X=$[0],J=$[1];u.useEffect((function(){if(!G){var e=f.default.createSelectorQuery();0!==(null==U?void 0:U.length)&&e.select("#JS-popup").boundingClientRect().exec((function(e){Q()})),P&&e.select("#JS-topChildren").boundingClientRect().exec((function(e){var t,n=(null===(t=e[1])||void 0===t?void 0:t.height)||0;n>0&&g(n)}))}}),[]);var Q=function(){var e=a(r().mark((function e(){var n,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],o=0,U.map(function(){var e=a(r().mark((function e(t,a){var i,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee("#".concat(t));case 2:i=e.sent,s=i.top,0===a&&(o=s),n.push(s-o);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),t.current=n;case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=function(e){return new Promise((function(t){f.default.createSelectorQuery().select(e).boundingClientRect().exec((function(e){var n=e[0],r=n.top,a=n.height;t({top:r,height:a})}))}))},te=function(e){for(var n=t.current,r=0;r<=n.length-2;r++){var a=r+1;if(e>=n[r]&&e<n[a]&&c!==r){l(r),null==L||L(r);break}if(r===n.length-2&&e>=n[a]&&c!==a){l(a),null==L||L(a);break}}},ne=function(e){e.stopPropagation(),x(!1),null==D||D()},re=Y?{borderRadius:0}:{},ae=Y?{maxHeight:"100%",minHeight:"100%"}:{};return I?u.default.createElement(d.View,{catchMove:!0,style:{height:y},className:"'koala-booking-popup-wrapper '".concat(e.className?e.className:""),"data-testid":q},u.default.createElement(d.View,{className:"koala-booking-popup-mask","data-testid":z,onClick:function(e){return ne(e)}}),u.default.createElement(d.View,{className:"booking-popup-box koala-fadeInUp",style:Object.assign(Object.assign({},ae),re)},Z?X?u.default.createElement(d.View,{className:"booking-popup-hide-head"},u.default.createElement(d.View,{className:"booking-popup-icon koala-icon koala-close",onClick:function(e){ne(e)}})):u.default.createElement(d.View,{className:"booking-popup-hide-head white"},u.default.createElement(d.View,{className:"booking-popup-icon koala-icon koala-close2",onClick:function(e){ne(e)}}),u.default.createElement(d.View,{className:"booking-popup-title"},e.title)):u.default.createElement(d.View,{className:"booking-popup-head",style:Object.assign({},re)},u.default.createElement(d.View,{className:"booking-popup-icon koala-icon koala-close2",onClick:function(e){ne(e)}}),E?"function"==typeof E?E():E:u.default.createElement(d.View,{className:"booking-popup-title"},e.title)),u.default.createElement(d.View,{id:"JS-topChildren"},P),u.default.createElement(d.ScrollView,{id:k,className:"booking-popup-content",style:{height:y*p[null==e?void 0:e.height]-(N?0:45)-v},scrollY:!C,onScroll:function(e){return function(e){var r=e&&e.detail&&e.detail.scrollTop||0;t.current&&Array.isArray(t.current)&&(n.current||(n.current=setTimeout((function(){n.current=null,te(r),Z&&J(r<Z)}),16))),null==R||R(e)}(e)},scrollTop:A,scrollIntoView:M,scrollWithAnimation:!0,refresherThreshold:16},e.children))):null}},function(e,t,n){"use strict";n.r(t)},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),o=n(1);n(118);var i=a.default.memo((function(e){var t=e.dataList,n=void 0===t?[]:t,r=e.curIndex,i=void 0===r?0:r,s=e.handleClickTab,c=e.style;return n.length<=0?null:a.default.createElement(o.ScrollView,{className:"koala-travelorder-tab-slider",scrollX:!0,style:c},n.map((function(e,t){var n="string"==typeof e?e:null==e?void 0:e.type;return a.default.createElement(o.View,{key:t,onClick:function(){return null==s?void 0:s(t)},className:"'travelorder-tab-item'".concat(t===i?" cur":"")},a.default.createElement(o.Text,null,n),t===i&&a.default.createElement(o.View,{className:"after-line"}))})))}));t.default=i},function(e,t,n){"use strict";n.r(t)},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),o=n(1);t.default=function(e){var t=e.id,n=e.confirmInfo,r=void 0===n?{}:n,i=e.reduceDetail,s=void 0===i?{}:i,c=e.bookingNoticeTxtArr,l=e.classInfo,u=void 0===l?[]:l,d=(e.bindRef,e.priceDetail),f=e.isLineFlight,p=void 0!==f&&f,m=u.filter((function(e){return!!e.desc})).length>0||Array.from(new Set(u.map((function(e){return e.className})))).length>1||u.filter((function(e){return!!e.mealTypeDesc})).length>0;if(!(Object.keys(r).length||c.length||m))return null;var h=r.title,v=r.desc,g=d||{},y=[[g.adult,"\u6210\u4eba"],[g.child,"\u513f\u7ae5"],[g.infant,"\u5a74\u513f"]],_=s.title,b=s.priceDesc,I=s.reduceWithdraw;return a.default.createElement(o.View,{className:"pro_desc_body",id:t},a.default.createElement(o.View,{className:"fare_remark_title"},"\u4ea7\u54c1\u8bf4\u660e"),!!d&&a.default.createElement(o.View,null,a.default.createElement(o.View,{className:"fare_remark_subtitle"},"\u7968\u4ef7\u660e\u7ec6"),a.default.createElement(o.View,{className:"fare_remark_gap"},a.default.createElement(o.View,{className:"fare_remark_border fare_remark_gap"},a.default.createElement(o.View,{className:"fare_remark_table_main_title"},a.default.createElement(o.View,null,(null==d?void 0:d.isIntl)?"\u5355\u4eba\u542b\u7a0e\u603b\u4ef7":"\u5355\u4eba\u4ef7\uff08\u4e0d\u542b\u71c3\u6cb9\u673a\u5efa\uff09")),y.map((function(e){return e[0]?a.default.createElement(o.View,{className:"fare_remark_table_row",key:e[1]},a.default.createElement(o.Text,{className:"fare_remark_table_left"},e[1],"\u513f\u7ae5"===e[1]&&a.default.createElement(a.default.Fragment,null,"\uff082-12\u5c81\uff09")),a.default.createElement(o.View,{className:"common_flex_txt fare_remark_table_right"},e[0])):null})))),!!d.desc&&a.default.createElement(o.View,{className:"fare_remark_txt"},a.default.createElement(o.Text,{className:"fare_remark_dotted"}),a.default.createElement(o.View,{className:"common_flex_txt"},d.desc))),!!v&&a.default.createElement(o.View,null,a.default.createElement(o.View,{className:"fare_remark_subtitle"},h),a.default.createElement(o.View,{className:"fare_remark_txt"},a.default.createElement(o.Text,{className:"fare_remark_dotted"}),a.default.createElement(o.View,{className:"common_flex_txt"},v))),!!_&&a.default.createElement(o.View,null,a.default.createElement(o.View,{className:"fare_remark_subtitle"},_),a.default.createElement(o.View,{className:"fare_remark_txt"},a.default.createElement(o.Text,{className:"fare_remark_dotted"}),a.default.createElement(o.View,{className:"common_flex_txt"},b)),a.default.createElement(o.View,{className:"fare_remark_txt"},a.default.createElement(o.Text,{className:"fare_remark_dotted"}),a.default.createElement(o.View,{className:"common_flex_txt"},I))),c.length>0&&a.default.createElement(o.View,null,a.default.createElement(o.View,{className:"fare_remark_subtitle"},"\u8d2d\u7968\u8bf4\u660e"),c.map((function(e){return a.default.createElement(o.View,{className:"fare_remark_txt",key:e},a.default.createElement(o.Text,{className:"fare_remark_dotted"}),a.default.createElement(o.View,{className:"common_flex_txt"},e))}))),m&&a.default.createElement(o.View,null,a.default.createElement(o.View,{className:"fare_remark_subtitle"},"\u8231\u4f4d\u8bf4\u660e"),u.map((function(e,t){var n=e.title,r=void 0===n?"":n,i=e.className,s=void 0===i?"":i,c=e.desc,l=e.mealTypeDesc;return a.default.createElement(o.View,{className:"fare_remark_txt",key:r+t},a.default.createElement(o.Text,{className:"fare_remark_dotted"}),a.default.createElement(o.View,{className:"common_flex_txt"},a.default.createElement(o.View,null,r,"\uff1a",s," ",l&&"(".concat(l,")")),!!c&&a.default.createElement(o.View,{className:"fare_remark_desc_txt",dangerouslySetInnerHTML:{__html:c}})))}))),p&&a.default.createElement(o.View,null,a.default.createElement(o.View,{className:"fare_remark_subtitle"},"\u8054\u7a0b\u822a\u73ed"),a.default.createElement(o.View,{className:"fare_remark_txt"},a.default.createElement(o.Text,{className:"fare_remark_dotted"}),a.default.createElement(o.View,{className:"common_flex_txt"},"\u8be5\u673a\u7968\u4e3a\u8054\u7a0b\u673a\u7968\uff08\u8054\u7a0b\u822a\u73ed\uff1a\u662f\u6307\u88ab\u5217\u660e\u5728\u5355\u4e00\u8fd0\u8f93\u5408\u540c\u4e2d\u7684\u4e24\u4e2a\u53ca\u4ee5\u4e0a\u7684\u822a\u73ed\uff09"))))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),o=n(13),i=n(1),s=function(e){var t=e.flexColumn,n=e.rfType,r=e.info,o=1===t?c:2===t?l:u;return a.default.createElement(o,{rfType:n,info:r})},c=function(e){var t=e.info,n=void 0===t?[]:t,r=[];return"string"==typeof n?r.push(n):n.forEach((function(e){var t=e.title,n=void 0===t?"":t,a=e.subInfo,o=void 0===a?"":a;r.push(n+o)})),r.length?a.default.createElement(i.View,{className:"fare_remark_table_onlyOne_c"},r.map((function(e){return a.default.createElement(i.View,{key:e,dangerouslySetInnerHTML:{__html:e}})}))):null},l=function(e){var t=e.rfType,n=e.info,r=void 0===n?[]:n,o=[];return"string"==typeof r?o.push(r):r.forEach((function(e){var t=e.title,n=void 0===t?"":t;o.push(n)})),o.length?a.default.createElement(i.View,{className:"fare_remark_table_row"},a.default.createElement(i.Text,{className:"fare_remark_table_left"},t),a.default.createElement(i.View,{className:"common_flex_txt fare_remark_table_right"},o.map((function(e){return a.default.createElement(i.View,{className:"common_flex_txt",key:e+t,dangerouslySetInnerHTML:{__html:e}})})))):null},u=function(e){var t=e.info,n=void 0===t?[]:t,r=e.rfType;return a.default.createElement(a.default.Fragment,null,n.map((function(e,t){var n=e.title,o=e.subInfo,s=void 0===o?[]:o;return a.default.createElement(i.View,{className:"fare_remark_table_row",key:n+t+r},a.default.createElement(i.Text,{className:"fare_remark_table_left"},n),a.default.createElement(i.View,{className:"common_flex_txt fare_remark_table_right"},s.map((function(e,t){var n=e.timeTip,o=void 0===n?"":n,c=e.feeTip,l=void 0===c?"":c,u=e.title,d=e.subTitle,f=void 0===d?"":d,p=e.tinyInfo,m=void 0===p?[]:p,h=s.length>1;return o||l?a.default.createElement(i.View,{className:"fare_remark_txt",key:o+t+r},h&&a.default.createElement(i.Text,{className:"fare_remark_dotted"}),a.default.createElement(i.View,{className:"common_flex_txt"},a.default.createElement(i.View,{dangerouslySetInnerHTML:{__html:o+(o&&l?"\uff1a":"")+l}}))):a.default.createElement(i.View,{className:"fare_remark_table_content",key:r+t+u},m.length?a.default.createElement(a.default.Fragment,null,a.default.createElement(i.View,{className:"fare_remark_subtitle",style:{marginTop:0}},u),f?a.default.createElement(i.View,{className:"fare_remark_subName"},f):null):a.default.createElement(i.View,{dangerouslySetInnerHTML:{__html:u}}),m.map((function(e,t){var n=e.timeTip,o=void 0===n?"":n,s=e.feeTip,c=void 0===s?"":s,l=m.length>1;return a.default.createElement(i.View,{className:"fare_remark_txt",key:o+r+t},l&&a.default.createElement(i.Text,{className:"fare_remark_dotted"}),a.default.createElement(i.View,{className:"common_flex_txt"},a.default.createElement(i.View,{dangerouslySetInnerHTML:{__html:o+(o&&c?"\uff1a":"")+c}})))})))}))))})))};t.default=function(e){var t=e.id,n=e.info,r=void 0===n?{}:n,c=e.setShowCab;if(!Object.keys(r).length)return null;var l=r.fareRemarkList,u=void 0===l?[]:l,d=r.exemptionInfo,f=void 0===d?[]:d;return a.default.createElement(i.View,{id:t,className:"fare-remark-body"},a.default.createElement(i.View,{className:"fare_remark_title"},"\u9000\u6539\u7b7e\u8bf4\u660e"),!o._.isEmpty(f)&&a.default.createElement(i.View,{className:"fare_remark_notice"},f.map((function(e,t){return a.default.createElement(i.View,{key:"exemptionInfo"+t},a.default.createElement(i.View,{className:"fare_remark_common_flex fare_remark_special_color fare_remark_notice_margin_top"},a.default.createElement(i.View,{className:"fare_remark_icon koala-icon icon-info"}),a.default.createElement(i.View,{className:"common_flex_title"},e.Title)),a.default.createElement(i.View,null,e.Description))}))),u.map((function(e,t){var n=e.policyTitleArr,r=void 0===n?[]:n,l=e.resultFareRemark,u=void 0===l?[]:l,d=e.refundCoupon,f=void 0===d?[]:d,p=e.specialChange,m=void 0===p?[]:p,h=e.noSingleRefund,v=void 0===h?[]:h,g=r.join("\uff0c"),y=[];return f.forEach((function(e){y.includes(e.Description)||y.push(e.Description)})),a.default.createElement(i.View,{key:g+t},a.default.createElement(i.View,{className:"fare_remark_subtitle"},g),(!o._.isEmpty(y)||!o._.isEmpty(m))&&a.default.createElement(i.View,{className:"fare_remark_notice",style:{marginBottom:"12px"}},y.length>0&&a.default.createElement(i.View,{className:"fare_remark_common_flex fare_remark_special_color"},a.default.createElement(i.View,{className:"fare_remark_icon koala-icon icon-info"}),a.default.createElement(i.View,{className:"common_flex_title"},"\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u9000\u6b3e\u53ef\u80fd\u4ec5\u9000\u4ee3\u91d1\u5238")),y.length>0&&y.map((function(e,t){return a.default.createElement(i.View,{key:"refundCouponTxt"+t},e)})),m&&m.map((function(e,t){return a.default.createElement(i.View,{key:"specialChange"+t},a.default.createElement(i.View,{className:"fare_remark_common_flex fare_remark_special_color fare_remark_notice_margin_top"},a.default.createElement(i.View,{className:"fare_remark_icon_selected koala-icon icon-selected",onClick:function(){return c(!0)}}),a.default.createElement(i.View,{className:"common_flex_title"},e.Title)),a.default.createElement(i.View,null,e.Description))}))),u.map((function(e,t){var n=e.rfType,r=e.flexColumn,o=e.info,l=void 0===o?[]:o;return l.length?a.default.createElement(i.View,{className:"fare_remark_border fare_remark_gap",key:g+t+n},(1===r||3===r)&&a.default.createElement(i.View,{className:"fare_remark_table_main_title"},a.default.createElement(i.View,null,n,"\u540c\u8231\u6539\u671f\u8d39"===n&&a.default.createElement(i.View,{className:"koala_fare_remark_changeCab_icon koala-icon icon-help",onClick:function(){return c(!0)}}))),a.default.createElement(s,{flexColumn:r,rfType:n,info:l})):null})),!o._.isEmpty(v)&&v.map((function(e,t){var n=e.Desc;return a.default.createElement(i.View,{className:"fare_remark_common_flex noSingleRefund",key:"noSingleRefund_".concat(t)},a.default.createElement(i.View,{className:"fare_remark_icon koala-icon icon-info"}),a.default.createElement(i.View,{className:"common_flex_title"},n))})))})))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),o=n(1);t.default=function(e){var t=e.id,n=e.info,r=void 0===n?[]:n;return r.length?a.default.createElement(o.View,{className:"baggage-rule-body",id:t},a.default.createElement(o.View,{className:"fare_remark_title"},"\u884c\u674e\u89c4\u5b9a"),r.map((function(e,t){var n=e.segmentTitle,r=void 0===n?"":n,i=e.subBaggageLimit,s=void 0===i?[]:i,c=r.split(",").join("-");return a.default.createElement(o.View,{key:"BaggageRequirements"+t},a.default.createElement(o.View,{className:"fare_remark_subtitle"},c),a.default.createElement(o.View,{className:"fare_remark_border"},s.map((function(e,t){var n=e.passengerType,r=e.passengerBaggage,i=void 0===r?[]:r;return a.default.createElement(o.View,{className:"fare_remark_table_row",key:n+t+c},a.default.createElement(o.Text,{className:"fare_remark_table_left"},n),a.default.createElement(o.View,{className:"common_flex_txt"},i.map((function(e,t){var n=e.title,r=e.baggageWeight,i=void 0===r?"":r,s=e.baggageSize,l=void 0===s?"":s;return a.default.createElement(o.View,{className:"fare_remark_table_right fare_remark_table_right_item",key:i+t+c},!!n&&(i||l?a.default.createElement(o.View,{className:"fare_remark_table_title"},n):a.default.createElement(o.View,{dangerouslySetInnerHTML:{__html:n}})),a.default.createElement(o.View,null,i,!(!i||!l)&&"\uff0c",l))}))))}))))}))):null}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),o=n(1);t.default=function(){return a.default.createElement(o.View,{className:"cabin_change_dialog"},a.default.createElement(o.View,{className:"content"},a.default.createElement(o.View,{className:"que"},"Q\uff1a\u4ec0\u4e48\u662f\u540c\u8231\u6539\u671f\uff1f"),a.default.createElement(o.View,{className:"ans"},"A\uff1a\u6539\u671f\u5206\u4e3a\u4e24\u79cd\uff1a\u540c\u8231\u4f4d\u66f4\u6539\u548c\u5347\u8231\u3002"),a.default.createElement(o.View,{className:"ans-n"},"\u540c\u8231\u6539\u671f\u5c31\u662f\u76f8\u540c\u8231\u4f4d\u6539\u671f\uff0c\u5982\u60a8\u539f\u5148\u9884\u8ba2\u7684\u662f\u7ecf\u6d4e\u8231 5 \u6298\u7968\uff0c\u540c\u8231\u6539\u671f\u6307\u7684\u662f\u66f4\u6539\u5230\u5176\u4ed6\u822a\u73ed\u7684\u540c\u7b49\u6298\u6263\u7ecf\u6d4e\u8231\uff0c\u6b64\u65f6\u6309\u7167\u540c\u8231\u6539\u671f\u6536\u8d39\u89c4\u5219\u8ba1\u7b97\u6539\u671f\u8d39\u3002")),a.default.createElement(o.View,{className:"content"},a.default.createElement(o.View,{className:"que"},"Q\uff1a\u5982\u679c\u6539\u671f\u65f6\uff0c\u53ea\u5269\u4e0b\u66f4\u9ad8\u6298\u6263\u8231\u4f4d\uff0c\u600e\u4e48\u6536\u8d39\u5462\uff1f"),a.default.createElement(o.View,{className:"ans"},"A\uff1a\u5982\u679c\u60a8\u6240\u6539\u822a\u73ed\u7684\u8231\u4f4d\u6298\u6263\u9ad8\u4e8e\u539f\u6765\u9884\u8ba2\u7684\u8231\u4f4d\u6298\u6263\uff0c\u5c5e\u4e8e\u5347\u8231\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u822a\u7a7a\u516c\u53f8\u90fd\u4f1a\u8981\u6c42\u8865\u4ea4\u673a\u7968\u5dee\u4ef7\u3002"),a.default.createElement(o.View,{className:"ans-n"},"\u6b64\u65f6\u6539\u7b7e\u9700\u6536\u53d6\uff1a\u540c\u8231\u6539\u671f\u8d39+\u673a\u7968\u5dee\u4ef7\u3002")),a.default.createElement(o.View,{className:"content"},a.default.createElement(o.View,{className:"que"},"Q\uff1a\u5982\u679c\u6539\u671f\u65f6\uff0c\u6709\u66f4\u4f4e\u4ef7\u683c\u822a\u73ed\uff0c\u80fd\u9000\u6211\u94b1\u4e48\uff1f"),a.default.createElement(o.View,{className:"ans"},"A\uff1a\u822a\u7a7a\u516c\u53f8\u53ea\u5141\u8bb8\u540c\u8231\u6216\u5347\u8231\u6539\u671f\uff0c\u6539\u671f\u662f\u65e0\u6cd5\u6539\u5230\u66f4\u4f4e\u4ef7\u683c\u822a\u73ed\u7684\u3002"),a.default.createElement(o.View,{className:"ans-n"},"\u5982\u679c\u6539\u671f\u65f6\uff0c\u60a8\u53d1\u73b0\u6709\u66f4\u4f4e\u4ef7\u683c\u822a\u73ed\uff0c\u53ef\u8ba1\u7b97\u4e00\u4e0b\uff0c\u9000\u7968\u91cd\u8ba2\u4e00\u5f20\u662f\u5426\u6bd4\u6539\u671f\u66f4\u5212\u7b97\u3002")))}},function(e,t,n){"use strict";n.r(t)},function(e,t,n){"use strict";n.r(t)},function(e,t,n){"use strict";n.r(t),n.d(t,"MODEL_CONTEXT",(function(){return r.MODEL_CONTEXT})),n.d(t,"EnvContext",(function(){return o.EnvContext})),n.d(t,"PureModel",(function(){return i.PureModel})),n.d(t,"setupStore",(function(){return r.setupStore})),n.d(t,"setupContext",(function(){return r.setupContext})),n.d(t,"setupPreloadCallback",(function(){return r.setupPreloadCallback})),n.d(t,"createReactModel",(function(){return a.createReactModel})),n.d(t,"createModelContext",(function(){return r.createModelContext})),n.d(t,"setupEnvContext",(function(){return o.setupEnvContext})),n.d(t,"EnvContextType",(function(){return o.EnvContextType})),n.d(t,"querystring",(function(){return s})),n.d(t,"UseCoupon",(function(){return l.a})),n.d(t,"CouponEnum",(function(){return u})),n.d(t,"FlightFareRemarkMask",(function(){return m.a})),n.d(t,"DevHubTraceLog",(function(){return f.a})),n.d(t,"PageInfo",(function(){return d.PageInfo})),n.d(t,"ActionInfo",(function(){return d.ActionInfo})),n.d(t,"RoleType",(function(){return d.RoleType})),n.d(t,"ActionType",(function(){return d.ActionType})),n.d(t,"ErrorInfo",(function(){return d.ErrorInfo})),n.d(t,"ErrorType",(function(){return d.ErrorType})),n.d(t,"PlatformType",(function(){return d.PlatformType})),n.d(t,"SelectDate",(function(){return Pt})),n.d(t,"SelectPassenger",(function(){return $n})),n.d(t,"ExtendInfo",(function(){return yr})),n.d(t,"PresaleNotice",(function(){return Rr})),n.d(t,"PriceDetail",(function(){return Za})),n.d(t,"TrainChildNotice",(function(){return io})),n.d(t,"CustomerService",(function(){return ko}));var r=n(3),a=n(9),o=n(18),i=n(44),s=n(45),c=n(46),l=n.n(c),u=n(35),d=n(8),f=n.n(d),p=n(53),m=n.n(p),h=n(0),v=n.n(h),g=n(7);function y(){y=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,a){var o=t&&t.prototype instanceof f?t:f,i=Object.create(o.prototype),s=new w(a||[]);return r(i,"_invoke",{value:T(e,n,s)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var d={};function f(){}function p(){}function m(){}var h={};c(h,o,(function(){return this}));var v=Object.getPrototypeOf,_=v&&v(v(N([])));_&&_!==t&&n.call(_,o)&&(h=_);var b=m.prototype=f.prototype=Object.create(h);function I(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){var a;r(this,"_invoke",{value:function(r,o){function i(){return new t((function(a,i){!function r(a,o,i,s){var c=u(e[a],e,o);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==Object(g.a)(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):t.resolve(d).then((function(e){l.value=e,i(l)}),(function(e){return r("throw",e,i,s)}))}s(c.arg)}(r,o,a,i)}))}return a=a?a.then(i,i):i()}})}function T(e,t,n){var r="suspendedStart";return function(a,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw o;return E()}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var s=k(i,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function k(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var a=u(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,d;var o=a.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function N(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:E}}function E(){return{value:void 0,done:!0}}return p.prototype=m,r(b,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:p,configurable:!0}),p.displayName=c(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},I(x.prototype),c(x.prototype,i,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new x(l(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},I(b),c(b,s,"Generator"),c(b,o,(function(){return this})),c(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=N,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;C(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:N(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function _(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){_(o,r,a,i,s,"next",e)}function s(e){_(o,r,a,i,s,"throw",e)}i(void 0)}))}}var I=n(4),x=n(5),T=n(24);function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}(e,t)||Object(T.a)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var S=n(55),C=n(54),w=function(e){var t=e.BasicInfo,n=e.aliasInfo,r=e.PreSaleNotice,a=e.TagGroupInfo,o=e.tPalClientInfo,i=t||{},s=i.IsOverSea,c=i.isPrivateGroup,l=i.ProductId,u=i.DepartureId,d=i.ProductCategoryId,f="multiLine"===(null==n?void 0:n.type),p="multiTravel"===(null==n?void 0:n.type),m=null==n?void 0:n.alias,h=a||{},v=h.MoreTagList,g=void 0===v?[]:v,y=h.SpecialTagList,_=(void 0===y?[]:y).some((function(e){return 2173===(null==e?void 0:e.TagId)})),b={isMultiLine:f,isMultiTravel:p,activeProductId:l,activeAlias:m,departCityId:u,IsOverSea:s,hasGroupTag:(null==g?void 0:g.some((function(e){return 1807===e.TagId})))||!1,isPrivateGroup:c,isTpal:_,isOverSeaDeparture:26===d},I=(r||{}).PreSaleRule||{},x=I.PreSaleTravelEndDay,T=I.PreSaleTravelStartDay,k=T?"".concat(S.a.parse(T,!1).format("YYYY-MM-DD")):"",C=x?"".concat(S.a.parse(x,!1).format("YYYY-MM-DD")):"",w=(o||{}).tPalScheduleList,N=void 0===w?[]:w,E={};return null==N||N.forEach((function(e){var t=e.departureDate,n=e.clientIds,r=void 0===n?[]:n,a=(null==r?void 0:r.length)||0;E[t]=a})),{productInfo:e,pageStatus:b,presaleStartDay:k,presaleEndDay:C,tpalScheduleMap:E}},N=function(e,t,n){var r=e.productInfo,a=e.pageStatus,o=(e.initParams,e.presaleStartDay,e.presaleEndDay,e.priceCalendarParams),i=void 0===o?{}:o,s=r||{},c=s.priceCalendar,l=(s.TagGroupInfo,s.tPalClientInfo,(n||{}).disableDates),u=c||{},d=u.dailyMinPrices,f=u.festivals,p=void 0===f?[]:f;if(x.a.isEmpty(d))return"detail"!==t.pageName||x.a.isEmpty(l)||x.a.isEmpty(i)||(i=E(l,i)),{dailyMinPrices:[],priceCalendarParams:i||{}};var m=["presale_detail","presale_order"].includes(t.pageName),h=["presale_order_complete"].includes(t.pageName),v=L(d,p,a,n),g=v.flatDailyMinPrice,y=v.monthMinPrice,_=v.curMinPrice,b=v.scheduleDates,I={},T=[];return m?I=j({state:e,flatDailyMinPrice:g,monthMinPrice:y}):h?(I=O({state:e,flatDailyMinPrice:g,monthMinPrice:y}),T=d.filter((function(e){return"\u5df2\u7ea6\u6ee1"!==I.dayConfig[U(e.date)].title}))):I=P({state:e,flatDailyMinPrice:g,monthMinPrice:y,curMinPrice:_,props:t}),"detail"!==t.pageName||x.a.isEmpty(l)||x.a.isEmpty(I)||(I=E(l,I)),{dailyMinPrices:d,flatDailyMinPrice:g,monthMinPrice:y,curMinPrice:_,priceCalendarParams:I,presaleOrderShowSchedules:T,detailScheduleDates:b}},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=Object.assign({},t);return null==e||e.forEach((function(e){var n,r=U(e),a=null===(n=null==t?void 0:t.dayConfig)||void 0===n?void 0:n[r];r&&a&&!a.disable&&!a.dayDefaultColorType&&(t.dayConfig[r]={disable:!0})})),n},P=function(e){var t=e.state,n=e.flatDailyMinPrice,r=e.monthMinPrice,a=e.curMinPrice,o=e.props,i=t.productInfo,s=t.pageStatus,c=(t.initParams,t.presaleStartDay,t.presaleEndDay,i.priceCalendar),l=i.BasicExtendInfo,u=c.dailyMinPrices,d=s.activeAlias,f=!0;if(l&&l.PriceStandardList){var p=l.PriceStandardList;if(p&&p.length){var m=p.find((function(e){return 1===e.PassengerType}));f=m&&m.IsCanBook}}var h={};h=s.isMultiTravel?D({state:t,flatDailyMinPrice:n,monthMinPrice:r,curMinPrice:a,props:o}):R({state:t,flatDailyMinPrice:n,monthMinPrice:r,curMinPrice:a,props:o});var v=U(u[0].date),g=U(u.slice(-1)[0].date),y=s.activeAlias?"\u9009\u62e9".concat(d,"\u7ebf\u51fa\u53d1\u65e5\u671f"):"\u9009\u62e9\u51fa\u53d1\u65e5\u671f",_="cruise_detail"===o.pageName,b=s.IsOverSea&&(s.hasGroupTag||s.isPrivateGroup),I="";return I=f?_?"\u4ee5\u4e0b\u4ef7\u683c\u4e3a1\u6210\u4eba\u8d77\u4ef7":b?"\xb7\u4ee5\u4e0b\u4ef7\u683c\u4e3a1\u6210\u4eba\u8d77\u4ef7 \xb7\u8ba1\u4ef7\u53ef\u80fd\u6709\u5ef6\u8fdf\uff0c\u8bf7\u4ee5\u4e0b\u5355\u65f6\u4e3a\u51c6\n\xb7\u4ee5\u4e0b\u73ed\u671f\u5747\u4fdd\u8bc1\u6210\u884c":"\xb7\u4ee5\u4e0b\u4ef7\u683c\u4e3a1\u6210\u4eba\u8d77\u4ef7 \xb7\u8ba1\u4ef7\u53ef\u80fd\u6709\u5ef6\u8fdf\uff0c\u8bf7\u4ee5\u4e0b\u5355\u65f6\u4e3a\u51c6":_?"\u4ee5\u4e0b\u4ef7\u683c\u4e3a1\u513f\u7ae5\u8d77\u4ef7":b?"\xb7\u4ee5\u4e0b\u4ef7\u683c\u4e3a1\u513f\u7ae5\u8d77\u4ef7 \xb7\u8ba1\u4ef7\u53ef\u80fd\u6709\u5ef6\u8fdf\uff0c\u8bf7\u4ee5\u4e0b\u5355\u65f6\u4e3a\u51c6\n\xb7\u4ee5\u4e0b\u73ed\u671f\u5747\u4fdd\u8bc1\u6210\u884c":"\xb7\u4ee5\u4e0b\u4ef7\u683c\u4e3a1\u513f\u7ae5\u8d77\u4ef7 \xb7\u8ba1\u4ef7\u53ef\u80fd\u6709\u5ef6\u8fdf\uff0c\u8bf7\u4ee5\u4e0b\u5355\u65f6\u4e3a\u51c6",s.isOverSeaDeparture&&(I+="\n\xb7\u65e5\u671f\u4e3a\u5f53\u5730\u65f6\u95f4"),{isOpenView:!0,startDate:v,currentDate:(new S.a).format("YYYYMMDD"),endDate:g,dayConfig:h,selectedDate:"",configuration:{businessCode:"group-tour",isUnChangeSelectedState:!1,isUnSelectedClose:!1,title:y,tipsMessage:I,tipsColorType:"orange",tipsAlignmentType:1,showToday:!s.isOverSeaDeparture,showHolidayInfo:!0,showFestival:!0,selectType:"single",showDaysSubTitle:!0,isGMT08:!0}}},j=function(e){var t,n=e.state,r=e.flatDailyMinPrice,a=e.monthMinPrice,o=A({state:n,flatDailyMinPrice:r,monthMinPrice:a}),i=n.productInfo,s=n.presaleStartDay,c=n.pageStatus,l=i.priceCalendar.dailyMinPrices,u=U(s),d=U(l.slice(-1)[0].date),f="\xb7\u5982\u9884\u7ea6\u65e5\u671f\u9700\u8865\u5dee\u4ef7\uff0c\u60a8\u9700\u5728\u9884\u7ea6\u65f6\u652f\u4ed8\u5dee\u4ef7\n\xb7 \u8be5\u65e5\u5386\u4ec5\u4f9b\u67e5\u770b\u4e0d\u652f\u6301\u9009\u62e9\uff0c\u8d2d\u4e70\u540e\u53ef\u9884\u7ea6\u65e5\u671f\n\xb7\u65e5\u671f\u4e3a\u5f53\u5730\u65f6\u95f4";c.isOverSeaDeparture&&(f+="\n\xb7\u65e5\u671f\u4e3a\u5f53\u5730\u65f6\u95f4");var p=Object.keys(o).find((function(e){var t=o[e];return!t.disable&&t.inventory>0}));return p&&(t=p),{isOpenView:!0,startDate:u,currentDate:(new S.a).format("YYYYMMDD"),endDate:d,dayConfig:o,selectedDate:"",configuration:{businessCode:"group-tour",anchorDate:t,isUnChangeSelectedState:!0,isUnSelectedClose:!0,toastMessage:"\u8be5\u65e5\u5386\u4ec5\u4f9b\u67e5\u770b\u4e0d\u80fd\u9009\u62e9\u54e6",title:"\u5f53\u524d\u53ef\u7ea6\u65e5\u671f",tipsMessage:f,tipsColorType:"orange",tipsAlignmentType:1,showToday:!c.isOverSeaDeparture,showHolidayInfo:!0,showFestival:!0,selectType:"single",showDaysSubTitle:!0,isGMT08:!0}}},O=function(e){var t=e.state,n=e.flatDailyMinPrice,r=e.monthMinPrice,a=M({state:t,flatDailyMinPrice:n,monthMinPrice:r}),o=t.productInfo,i=t.pageStatus,s=o.priceCalendar.dailyMinPrices,c=U(s[0].date),l=U(s.slice(-1)[0].date),u="\xb7\u90e8\u5206\u70ed\u95e8\u65e5\u671f\u9700\u8865\u5dee\u4ef7\uff0c\u5dee\u4ef7\u91d1\u989d\u9009\u62e9\u65e5\u671f\u540e\u53ef\u67e5\u770b";return i.isOverSeaDeparture&&(u+="\n\xb7\u65e5\u671f\u4e3a\u5f53\u5730\u65f6\u95f4"),{isOpenView:!0,startDate:c,currentDate:(new S.a).format("YYYYMMDD"),endDate:l,dayConfig:a,selectedDate:"",configuration:{businessCode:"group-tour",isUnChangeSelectedState:!1,isUnSelectedClose:!1,title:"\u9009\u62e9\u51fa\u884c\u65e5\u671f",tipsMessage:u,tipsColorType:"orange",tipsAlignmentType:1,showToday:!i.isOverSeaDeparture,showHolidayInfo:!0,showFestival:!0,selectType:"single",showDaysSubTitle:!0,isGMT08:!0}}},D=function(e){var t=e.state,n=e.flatDailyMinPrice,r=(e.monthMinPrice,e.curMinPrice),a=e.props,o=(t.pageStatus,((t.productInfo||{}).priceCalendar||{}).minPrice,{});return Object.keys(n).forEach((function(e,i,s){var c=n[e],l=(Z(e),U(e));V(s[i-1],e).forEach((function(e){o[e]={disable:!0}}));var u=F(e,c,t,a),d=u.disable,f=u.displayPrice,p=u.subTitle,m=u.dayDefaultColorType,h=f>0?"\xa5".concat(f):"\u5b9e\u65f6\u8ba1\u4ef7",v=0;f>0?f===r&&(v=2):v=0,o[l]={title:h,titleColorType:v,subTitle:p,disable:!!d,subTitleColorType:3,displayPrice:f,dayDefaultColorType:m}})),o},R=function(e){var t=e.state,n=e.flatDailyMinPrice,r=e.monthMinPrice,a=e.curMinPrice,o=e.props,i=t.pageStatus,s={};return Object.keys(n).forEach((function(e,c,l){var u,d=n[e],f=Z(e),p=(null===(u=null==r?void 0:r[i.activeProductId])||void 0===u||u[f],U(e));V(l[c-1],e).forEach((function(e){s[e]={disable:!0}}));var m=G(e,d,t,o),h=m.displayPrice,v=m.subTitle,g=m.disable,y=m.dayDefaultColorType,_=h>0?"\xa5".concat(h):"\u5b9e\u65f6\u8ba1\u4ef7",b=0;h>0?h===a&&(b=2):b=0,s[p]={title:_,titleColorType:b,subTitle:v,disable:!!g,subTitleColorType:3,displayPrice:h,dayDefaultColorType:y}})),s},A=function(e){var t=e.state,n=e.flatDailyMinPrice,r=(e.monthMinPrice,t.pageStatus),a={},o=t.presaleStartDay,i=t.presaleEndDay,s=t.productInfo.TourGroupInfo,c=x.a.cloneDeep(n),l=Object.keys(c)[0],u=Object.keys(c).slice(-1)[0];new S.a(o).getTime()<new S.a(l).getTime()&&(c[o]=[Object.assign(Object.assign({},c[l][0]),{inventory:-1})]),new S.a(i).getTime()>new S.a(u).getTime()&&(c[i]=[Object.assign(Object.assign({},c[u][0]),{inventory:-1})]);var d=Object.keys(c).sort(),f={};return d.forEach((function(e){f[e]=c[e]})),Object.keys(f).forEach((function(e,t,n){var o=f[e],i=(Z(e),U(e));V(n[t-1],e).forEach((function(e){a[e]={title:"",disable:!0}}));var c=H(o,r.activeProductId,s),l=c.inventory,u=c.displayPrice,d="",p="",m=!1;-1===l?(d="",m=!0):0===l?(d="\u5df2\u7ea6\u6ee1",m=!0):l<=9?(d=u>0?"\xa5".concat(u):"\u5b9e\u65f6\u8ba1\u4ef7",p="\u4f59".concat(l),m=!1):l>=10&&(d=u>0?"\xa5".concat(u):"\u5b9e\u65f6\u8ba1\u4ef7",m=!1),a[i]={title:d,titleColorType:0,subTitle:p,subTitleColorType:3,disable:m,inventory:l}})),a},M=function(e){var t=e.state,n=e.flatDailyMinPrice,r=(e.monthMinPrice,t.pageStatus),a=t.productInfo,o=(t.initParams||{}).presaleOrderPassengerInfo,i={},s=0;o&&!x.a.isEmpty(o)&&Object.keys(o).forEach((function(e){o[e]&&(s+=o[e])}));var c=a||{},l=c.TourGroupInfo;return c.PreSaleNotice,Object.keys(n).forEach((function(e,t,a){var o=n[e],c=U(e);V(a[t-1],e).forEach((function(e){i[e]={disable:!0}}));var u=H(o,r.activeProductId,l),d=u.inventory,f=(u.displayPrice,""),p=!1;s>d?(f="\u5df2\u7ea6\u6ee1",p=!0):d<=9&&(f="\u4f59".concat(d),p=!1),i[c]={title:f,titleColorType:2,disable:p,inventory:d}})),i},V=function(e,t){var n=[],r=1;return e&&t&&(r=Math.ceil(S.a.dayDiff(e,t))),r>1&&Array(r-1).fill(0).forEach((function(t,r){var a=S.a.parse(e,!1,!1).addDay(r+1).format("YYYYMMDD");a&&n.push(a)})),n},L=function(e){for(var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i={},s={},c=[],l=function(){var t=e[u],n=t.date,r=t.productPrices,l=void 0===r?[]:r,d=t.showGroup,f=Z(n),p=[];l.forEach((function(e){var t=e=Object.assign(Object.assign({},e),{displayPrice:(null==o?void 0:o.needTradePrice)?e.tradePrice:e.displayPrice,showGroup:d,date:n}),r=t.productId,i=t.alias,l=t.displayPrice;r&&(p.push(e),r&&(s[r]=s[r]||{},s[r][f]=s[r][f]||new Set,"number"!=typeof l||Number.isNaN(l)||s[r][f].add(l)),i&&(s[i]=s[i]||{},s[i][f]=s[i][f]||new Set,"number"!=typeof l||Number.isNaN(l)||s[i][f].add(l)),a.isMultiTravel?i===a.activeAlias&&c.push(n):r===a.activeProductId&&c.push(n))})),p.sort((function(e,t){return e.displayPrice-t.displayPrice})),i[n]=p},u=0;u<e.length;u++)l();Object.entries(s).forEach((function(e){var t=k(e,2),n=t[0],r=t[1];Object.entries(r).forEach((function(e){var t=k(e,2),r=t[0],a=t[1],o=Array.from(a).sort((function(e,t){return e-t}));1===o.length?s[n][r]=o[0]:s[n][r]=0===o[0]?o[1]:o[0]}))}));var d=0;if(a.isMultiTravel){var f=(null==s?void 0:s[a.activeAlias])||{};d=(null===(t=Object.values(f).filter((function(e){return e>0})).sort((function(e,t){return e-t})))||void 0===t?void 0:t[0])||0}else{var p=(null==s?void 0:s[a.activeProductId])||{};d=(null===(n=Object.values(p).filter((function(e){return e>0})).sort((function(e,t){return e-t})))||void 0===n?void 0:n[0])||0}for(var m=[],h=(null==r?void 0:r.filter((function(e){return e.isMainFestival})))||[],v=0;v<h.length&&!(m.length>=2);v++){var g=h[v],y=g.festivalDate,_=g.festivalName,b=B(y,i,a);x.a.isEmpty(b)||m.push(Object.assign(Object.assign({},b),{festivalName:_}))}for(var I=function(){if(m.length>=10)return"break";var e=c[T];if(m.some((function(t){return t.date===e})))return"continue";var t=B(e,i,a);x.a.isEmpty(t)||m.push(t)},T=0;T<c.length;T++){var S=I();if("break"===S)break}return{flatDailyMinPrice:i,monthMinPrice:s,curMinPrice:d,scheduleDates:m}},B=function(e,t,n){var r=(null==t?void 0:t[e])||[];return n.isMultiTravel?null==r?void 0:r.find((function(e){return e.alias===n.activeAlias})):null==r?void 0:r.find((function(e){return e.productId===n.activeProductId}))},U=function(e){return e?e.split("-").join(""):""},Z=function(e){var t=k(e.split("-"),2),n=t[0],r=t[1];return"".concat(n,"-").concat(r)},F=function(e,t,n,r){var a,o,i,s,c,l,u=n.pageStatus,d=n.tpalScheduleMap,f=void 0===d?{}:d,p=u.activeAlias,m=null==t?void 0:t.find((function(e){return e.alias===p})),h="";if(p){var v=m&&m.inventory<10&&m.inventory>0?m.inventory:"",g=f[e]||0;"detail"===r.pageName&&u.isTpal?m&&g>0&&(0===m.inventory?h="\u5df2\u62a5\u6ee1":(m.inventory>0||-99999===m.inventory)&&(h="\u5df2\u62a5".concat(g))):h="detail"===r.pageName&&m&&m.showGroup&&!u.isPrivateGroup&&!u.hasGroupTag?v?"\u6210\u56e2\xb7\u4f59".concat(v):"\u6210\u56e2":v?"\u4f59".concat(v):""}else{var y=(null===(a=null==t?void 0:t[0])||void 0===a?void 0:a.inventory)<10&&(null===(o=null==t?void 0:t[0])||void 0===o?void 0:o.inventory)>0?null===(i=null==t?void 0:t[0])||void 0===i?void 0:i.inventory:"";h=y?"\u4f59".concat(y):""}if(-1===(l=p?m?m.displayPrice:-1:t[0].displayPrice)){var _=null===(s=null==t?void 0:t[0])||void 0===s?void 0:s.displayPrice,b=!!(null==t?void 0:t.length)&&(null===(c=t[0])||void 0===c?void 0:c.alias);return"detail"===r.pageName?{displayPrice:_,subTitle:b?"\u53ef\u9009".concat(b,"\u7ebf"):"",disable:!b,dayDefaultColorType:b?1:0}:{displayPrice:_,subTitle:b?"".concat(b,"\u7ebf"):"",disable:!0,dayDefaultColorType:0}}return l?{displayPrice:l,subTitle:h}:{displayPrice:"- -",subTitle:h}},G=function(e,t,n,r){var a,o,i,s,c,l=n.pageStatus,u=n.tpalScheduleMap,d=void 0===u?{}:u,f=n.productInfo.TourGroupInfo,p=l.activeProductId,m=f.TourGroupProductInfo,h={};null==m||m.forEach((function(e){h[e.ProductId]=C.a[e.SortNumber-1]}));var v,g=t.find((function(e){return e.productId===p})),y="";if(p){var _=g&&g.inventory<10&&g.inventory>0?g.inventory:"",b=d[e]||0;"detail"===r.pageName&&l.isTpal?g&&b>0&&(0===g.inventory?y="\u5df2\u62a5\u6ee1":(g.inventory>0||-99999===g.inventory)&&(y="\u5df2\u62a5".concat(b))):y="detail"===r.pageName&&g&&g.showGroup&&!l.isPrivateGroup&&!l.hasGroupTag?_?"\u6210\u56e2\xb7\u4f59".concat(_):"\u6210\u56e2":_?"\u4f59".concat(_):""}else{var I=(null===(a=null==t?void 0:t[0])||void 0===a?void 0:a.inventory)<10&&(null===(o=null==t?void 0:t[0])||void 0===o?void 0:o.inventory)>0?null===(i=null==t?void 0:t[0])||void 0===i?void 0:i.inventory:"";y=I?"\u4f59".concat(I):""}if(-1===(v=p?g?g.displayPrice:-1:t[0].displayPrice)){var x=null===(s=null==t?void 0:t[0])||void 0===s?void 0:s.productId,T=null===(c=null==t?void 0:t[0])||void 0===c?void 0:c.displayPrice;if("detail"===r.pageName)return{displayPrice:T,subTitle:x?"\u53ef\u9009".concat(h[x],"\u7ebf"):"",disable:!x,dayDefaultColorType:x?1:0};var k=x?"".concat(h[x],"\u7ebf"):"";return t.length>1&&k&&(k+="\u7b49"),{displayPrice:t[0].displayPrice,subTitle:k,disable:!0,dayDefaultColorType:0}}return v?{displayPrice:v,subTitle:y}:{displayPrice:"- -",subTitle:y}},H=function(e,t,n){var r,a=n.TourGroupProductInfo,o={};null==a||a.forEach((function(e){o[e.ProductId]=C.a[e.SortNumber-1]}));var i=e.find((function(e){return e.productId===t}));return{inventory:t?i.inventory:null===(r=null==e?void 0:e[0])||void 0===r?void 0:r.inventory,displayPrice:t?i?i.displayPrice:-1:e[0].displayPrice}},q={UPDATE_DATA:function(e,t){return Object.assign(Object.assign({},e),t)},UPDATE_CALANDAR_DATA:function(e,t){return Object.assign(Object.assign(Object.assign({},e),t),{isInitReady:!0})},UPDATE_CALANDAR_SELECTED_DATE:function(e,t){var n=e.priceCalendarParams,r=Object.assign({},n);return r.selectedDate=U(t),Object.assign(Object.assign({},e),{priceCalendarParams:r})},UPDATE_CALANDAR_DISABLE_DATE:function(e,t){var n=e.priceCalendarParams,r=Object.assign({},n),a=U(t);return a&&(r.dayConfig[a].disable=!0),Object.assign(Object.assign({},e),{priceCalendarParams:r})},UPDATE_CALANDAR_DISABLE_DATES:function(e,t){var n=e.priceCalendarParams,r=e.initParams.disableDates,a=void 0===r?[]:r,o=Object.assign({},n);return!x.a.isEmpty(t)&&n&&n.dayConfig&&(o=E(a,o)),Object.assign(Object.assign({},e),{priceCalendarParams:o})},UPDATE_PRODUCT_INFO:function(e,t){return Object.assign(Object.assign({},e),t)},UPDATE_PROPS:function(e,t){return Object.assign(Object.assign({},e),t)},UPDATE_INIT_PARAMS:function(e,t){return Object.assign(Object.assign({},e),{initParams:t})}},K=n(2),z="\nquery getProductInfo($productParams: ProductArgs!, $priceCalendarParams: PriceCalendarArgs!){\n    productInfo(params: $productParams) {\n        BasicInfo {\n            json\n        }\n        BasicExtendInfo {\n            json\n        }\n        TagGroupInfo {\n            json\n        }\n        FeeInfoList {\n            json\n        }\n        BookInfo {\n            json\n        }\n        aliasInfo {\n            type\n            name\n            alias\n        }\n        CostInfoList{\n            json\n        }\n        SegmentInfo {\n            json\n        }\n        VendorInfo {\n            json\n        }\n        PreSaleNotice{\n            json\n        }\n        TourGroupInfo {\n            json\n        }\n        TravelList {\n            json\n        }\n        priceCalendar(params: $priceCalendarParams) {\n            json\n        }\n        tPalClientInfo {\n            tPalScheduleList\n        }\n        ResponseStatus\n    }\n}\n",Y="\nquery getProductInfo($productParams: ProductArgs!, $priceCalendarParams: PriceCalendarArgs!){\n    productInfo(params: $productParams) {\n        BasicInfo {\n            json\n        }\n        BasicExtendInfo {\n            json\n        }\n        TagGroupInfo {\n            json\n        }\n        FeeInfoList {\n            json\n        }\n        BookInfo {\n            json\n        }\n        aliasInfo {\n            type\n            name\n            alias\n        }\n        CostInfoList{\n            json\n        }\n        SegmentInfo {\n            json\n        }\n        VendorInfo {\n            json\n        }\n        TourGroupInfo {\n            json\n        }\n        TravelList {\n            json\n        }\n        priceCalendar(params: $priceCalendarParams) {\n            json\n        }\n        ResponseStatus\n    }\n}\n",W=n(15),$="\n  query getProductInfo($productParams: ProductArgs!){\n    productInfo(params: $productParams) {\n      BasicInfo {\n        json\n      }\n      BasicExtendInfo {\n        json\n      }\n      FeeInfoList {\n        json\n      }\n      CostInfoList{\n        json\n      }\n      BookInfo {\n        json\n      }\n      aliasInfo {\n        type\n        name\n        alias\n      }\n      SegmentInfo {\n        json\n      }\n      ResponseStatus\n  }\n}\n",X=function(e){function t(){return(t=b(y().mark((function t(n){var r,a,o,i,s,c,l,u,f,p,m,h,v,g,_,b,I,x;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.productId,i=n.alias,s=n.departCityId,c=n.pageName,l=$,u=Object.assign({ProductId:Number(o),DepartureCityId:2},e.attachShardParams()),i&&(u.Alias=[i]),s&&(u.DepartureCityId=Number(s)),f={productParams:u},p={},t.prev=8,m=(new Date).getTime(),h=e.createGqlRequest(l,f,"VPC_ProductInfo",p),t.next=13,h.fetch();case 13:if((v=t.sent)&&v.data&&v.extensions){t.next=16;break}throw new Error("\u8282\u70b9\u4e0d\u5b8c\u6574");case 16:if(g=(new Date).getTime(),_=v.data,b=v.extensions,e.traceKMLogAction({attrs:[{key:"productId",value:String(o)}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"fetchProductInfo",role:d.RoleType.sys,action:d.ActionType.show,value:"".concat(g-m,"ms"),rootMessageId:Object(K.a)(null===(a=null===(r=null==b?void 0:b.SoaResponseStatus)||void 0===r?void 0:r.ResponseStatus)||void 0===a?void 0:a.Extension)}),_&&_.productInfo){t.next=21;break}throw new Error("\u8282\u70b9\u4e0d\u5b8c\u6574");case 21:if(I=_.productInfo,"Success"===(null==(x=null==I?void 0:I.ResponseStatus)?void 0:x.Ack)){t.next=25;break}throw new Error("ResponseStatus Ack Failed");case 25:return t.abrupt("return",I);case 28:throw t.prev=28,t.t0=t.catch(8),t.t0.isNetError||e.traceKMLogError({pageName:e.pageName||c,message:"fetchProductInfo->".concat(null===t.t0||void 0===t.t0?void 0:t.t0.message),errorType:d.ErrorType.Ack_Fail,ex:t.t0}),new Error("fetchProductInfo Fail: ".concat(t.t0.message));case 32:case"end":return t.stop()}}),t,null,[[8,28]])})))).apply(this,arguments)}return{fetchProductInfo:function(e){return t.apply(this,arguments)},getProductInfo:function(){var t=b(y().mark((function t(n){var r,a,o,i,s,c,l,u,d;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.traceKMLogMessage("\u8bfb\u53d6productInfo\u7f13\u5b58: ".concat(n)),i=J(n),s=i.productId,c=i.alias,l=i.departCityId,t.next=5,e.get(C.b.VPC_PRODUCTINFO);case 5:if(u=t.sent,d=null==u?void 0:u[s]){t.next=9;break}return t.abrupt("return",null);case 9:if((null===(r=null==d?void 0:d.BasicInfo)||void 0===r?void 0:r.ProductId)===s){t.next=11;break}return t.abrupt("return",null);case 11:if((null===(a=null==d?void 0:d.BasicInfo)||void 0===a?void 0:a.DepartureId)===l){t.next=13;break}return t.abrupt("return",null);case 13:if("multiTravel"!==(null===(o=null==d?void 0:d.aliasInfo)||void 0===o?void 0:o.type)||(null==d?void 0:d.aliasInfo.alias)===c){t.next=15;break}return t.abrupt("return",null);case 15:return t.abrupt("return",d);case 18:return t.prev=18,t.t0=t.catch(0),console.error("VPC_PRODUCTINFO: \u8bf7\u68c0\u67e5 cacheKey: ".concat(JSON.stringify(n))),t.abrupt("return",null);case 22:case"end":return t.stop()}}),t,null,[[0,18]])})));return function(e){return t.apply(this,arguments)}}(),setProductInfo:function(t){if(t&&t.BasicInfo&&t.BasicInfo.ProductId){var n=t.BasicInfo.ProductId,r=t.BasicInfo,a=t.BasicExtendInfo,o=t.FeeInfoList,i=t.BookInfo,s=t.aliasInfo,c=t.SegmentInfo,l=t.CostInfoList;e.set(C.b.VPC_PRODUCTINFO,Object(W.a)({},n,{BasicInfo:r,BasicExtendInfo:a,FeeInfoList:o,BookInfo:i,aliasInfo:s,SegmentInfo:c,CostInfoList:l}))}else console.error("\u7f13\u5b58\u7684 productInfo \u4e0d\u6b63\u786e")},removeProductInfo:function(){var t=b(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.remove(C.b.VPC_PRODUCTINFO);case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},J=function(e){var t=JSON.parse(e),n=t.productId,r=t.alias,a=t.departCityId;return{productId:Number(n),alias:r,departCityId:Number(a)}},Q="\n  mutation getShoppingResource(\n    $params: ExtraResourceArgs!,\n    $ShoppingDetailParams: ShoppingDetailArgs!\n  ) {\n    extraResource(params: $params) {\n      settings\n      Option\n      Insurances\n      train\n      Tags\n      single\n      cruiseTour\n      room\n      discount\n      combinedTrans\n      transportation\n      visa\n      free\n      required\n      optional\n      trainUpdateResult\n      optionUpdateResult\n      ResponseStatus\n    }\n    shoppingDetail(params: $ShoppingDetailParams) {\n      prefetchSetting\n    }\n  }\n",ee="\n  query CabinFareRemark(\n    $params: CabinFareRemarkReq\n  ){\n    CabinInfo(params: $params){\n      FareRemarkForShopping{\n        RemarkList,\n        BriefFareRemark,\n        BriefTag,\n        BriefBaggageLimit,\n        TransferInfo,\n        BriefTransferInfo,\n        TransferInfoViewData \n      }\n    }\n  }\n";function te(e,t){var n=e.BasicInfo,r=e.BasicExtendInfo.PriceStandardList,a=e.FeeInfoList,o=e.BookInfo,i=e.aliasInfo,s=e.SegmentInfo,c=n.isPureDiyfhxsdp?"sdp":"grp",l=s.IsFixSegment?"fixSegment":"extendedStay",u=i.type,d=i.name,f=i.alias,p=n.ProductId,m=n.DepartureId,h=String((null==n?void 0:n.DepartureCityName)||""),v=n.isStudy,g=n.IsOverSea,y=2===(null==n?void 0:n.PreSaleStatus),_=null==n?void 0:n.isCruise,b=s.Segments||[],I=b.some((function(e){return!0===e.IsIncludeSystemFlight})),x=b.some((function(e){return!0===e.IsIncludeHotel})),T=b.some((function(e){return!0===e.IsIncludeSystemTrain})),k=o.MinBookPerson,S=o.MaxBookPerson,C=S;"grp"===c&&S>99?C=99:"sdp"===c&&S>9&&(C=9);var w=!1,N=!1,E=!1,P=2,j=18;r.forEach((function(e){1===e.PassengerType&&(w=e.IsCanBook),2===e.PassengerType&&(N=e.IsCanBook,"grp"===c&&(P=N?e.MinAge:2,j=N?e.MaxAge:12)),3===e.PassengerType&&"sdp"===c&&(E=e.IsCanBook)})),N||(E=!1);var O=N&&("sdp"===c||x),D=a&&a.some((function(e){return"15"===e.SubTitleCode})),R="grp"===c&&D,A=t||{},M=A.date,V=A.displayPrice,L=A.price,B=A.inventory;return{productType:c,segmentType:l,routeType:u,routeName:d,alias:f,line:p,departcityid:m,departcityname:h,isStudy:v,isOverSea:g,isCruise:_,isPresale:y,isIncludeSystemFlight:I,isIncludeSystemHotel:x,isIncludeSystemTrain:T,adultCanBook:w,childCanBook:N,infantCanBook:E,childMinAge:P,childMaxAge:j,childAgeRequired:O,MinBookPerson:k,MaxBookPerson:C,hasFeeIncludeTip:R,date:M,displayPrice:V,price:L,inventory:B}}function ne(e){var t=e.adultCanBook,n=e.childCanBook,r=e.isStudy,a=e.MinBookPerson,o=e.MaxBookPerson,i=2,s=0;return t&&n?r?(i=1,s=Math.max(a-1,1)):(i=Math.max(a,Math.min(2,o)),s=0):t&&!n?r?(i=Math.max(a,1),s=0):(i=Math.max(a,Math.min(2,o)),s=0):!t&&n&&(i=0,s=Math.max(a,1)),{adultCount:i,childCount:s,infantCount:0,childAges:[]}}var re=function(e,t){var n=e.productType,r=e.isOverSea,a=null;return(a=ae(e,t))?a:a="sdp"===n?r?se(e,t):ie(e,t):oe(e,t)},ae=function(e,t){var n=e.isStudy,r=e.MinBookPerson,a=e.MaxBookPerson,o=e.adultCanBook,i=e.childCanBook,s=e.infantCanBook,c=e.childMinAge,l=e.childMaxAge,u=e.childAgeRequired,d=e.isIncludeSystemFlight,f=e.isIncludeSystemTrain;if(!t)return{scene:1,reason:"\u6ca1\u6709\u4eba\u6570\u7f13\u5b58\u6216\u7f13\u5b58\u8fc7\u671f",show:!1,vac_code:"",vac_desc:""};var p=t.adultCount,m=t.childCount,h=t.childAges,v=t.infantCount;if(!(p>=0&&m>=0&&v>=0))return{scene:1,reason:"\u6ca1\u6709\u4eba\u6570\u7f13\u5b58\u6216\u7f13\u5b58\u8fc7\u671f",show:!1,vac_code:"",vac_desc:""};var g=p+m+v;return!o&&p>0?{scene:3,reason:"\u6b64\u4ea7\u54c1\u4e0d\u652f\u6301\u6210\u4eba\u9884\u8ba2\uff0c\u5982\u6709\u9700\u6c42\u8bf7\u8054\u7cfb\u5ba2\u670d\u54a8\u8be2",show:!0,vac_code:"vac_30121",vac_desc:"\u6b64\u4ea7\u54c1\u4e0d\u652f\u6301{x}\u9884\u8ba2"}:!i&&m>0&&!s&&v>0?{scene:3,reason:"\u6b64\u4ea7\u54c1\u4e0d\u652f\u6301\u513f\u7ae5\u3001\u5a74\u513f\u9884\u8ba2\uff0c\u5982\u6709\u9700\u6c42\u8bf7\u8054\u7cfb\u5ba2\u670d\u54a8\u8be2",show:!0,vac_code:"vac_30121",vac_desc:"\u6b64\u4ea7\u54c1\u4e0d\u652f\u6301{x}\u9884\u8ba2"}:!i&&m>0?{scene:3,reason:"\u6b64\u4ea7\u54c1\u4e0d\u652f\u6301\u513f\u7ae5\u9884\u8ba2\uff0c\u5982\u6709\u9700\u6c42\u8bf7\u8054\u7cfb\u5ba2\u670d\u54a8\u8be2",show:!0,vac_code:"vac_30121",vac_desc:"\u6b64\u4ea7\u54c1\u4e0d\u652f\u6301{x}\u9884\u8ba2"}:!s&&v>0?{scene:3,reason:"\u6b64\u4ea7\u54c1\u4e0d\u652f\u6301\u5a74\u513f\u9884\u8ba2\uff0c\u5982\u6709\u9700\u6c42\u8bf7\u8054\u7cfb\u5ba2\u670d\u54a8\u8be2",show:!0,vac_code:"vac_30121",vac_desc:"\u6b64\u4ea7\u54c1\u4e0d\u652f\u6301{x}\u9884\u8ba2"}:g<r?{scene:3,reason:"\u8ba2\u5355\u603b\u4eba\u6570\u4e0d\u53ef\u5c0f\u4e8e".concat(r,"\u4eba"),show:!0,vac_code:"vac_30037",vac_desc:"\u8ba2\u5355\u603b\u4eba\u6570\u4e0d\u53ef\u5c0f\u4e8e{x}\u4eba"}:n||0!==p?h.every((function(e){return e>=c&&e<l}))?u&&h.length!==m?{scene:3,reason:"\u8bf7\u9009\u62e9\u513f\u7ae5\u5e74\u9f84",show:!0,vac_code:"vac_30110",vac_desc:"\u513f\u7ae5\u5e74\u9f84\u4e0d\u5728\u8303\u56f4"}:g>a?{scene:3,reason:"\u8ba2\u5355\u603b\u4eba\u6570\u4e0d\u53ef\u8d85\u8fc7".concat(a,"\u4eba\u3002")+"\u5982\u679c\u60a8\u662f".concat(a,"\u4eba\u4ee5\u4e0a\u51fa\u884c\uff0c\u8bf7\u5206\u591a\u4e2a\u8ba2\u5355\u8fdb\u884c\u9884\u8ba2\u3002"),show:!0,vac_code:"vac_30038",vac_desc:"\u8ba2\u5355\u603b\u4eba\u6570\u4e0d\u53ef\u8d85\u8fc7{x}\u4eba"}:d&&g>9?{scene:3,reason:"\u7531\u4e8e\u673a\u7968\u9884\u8ba2\u9650\u5236\uff0c\u8ba2\u5355\u603b\u4eba\u6570\u4e0d\u53ef\u8d85\u8fc79\u4eba\u3002\u5982\u679c\u60a8\u662f9\u4eba\u4ee5\u4e0a\u51fa\u884c\uff0c\u8bf7\u5206\u591a\u4e2a\u8ba2\u5355\u8fdb\u884c\u9884\u8ba2\u3002",show:!0,vac_code:"vac_30038",vac_desc:"\u8ba2\u5355\u603b\u4eba\u6570\u4e0d\u53ef\u8d85\u8fc7{x}\u4eba"}:f&&p+m>9?{scene:3,reason:"\u7531\u4e8e\u706b\u8f66\u7968\u9884\u8ba2\u9650\u5236\uff0c\u6210\u4eba+\u513f\u7ae5\u4eba\u6570\u4e0d\u53ef\u8d85\u8fc79\u4eba\u3002\u5982\u679c\u60a8\u662f9\u4eba\u4ee5\u4e0a\u51fa\u884c\uff0c\u8bf7\u5206\u591a\u4e2a\u8ba2\u5355\u8fdb\u884c\u9884\u8ba2\u3002",show:!0,vac_code:"vac_30038",vac_desc:"\u8ba2\u5355\u603b\u4eba\u6570\u4e0d\u53ef\u8d85\u8fc7{x}\u4eba"}:null:{scene:3,reason:"\u8bf7\u9009\u62e9\u513f\u7ae5\u5e74\u9f84",show:!0,vac_code:"vac_30110",vac_desc:"\u513f\u7ae5\u5e74\u9f84\u4e0d\u5728\u8303\u56f4"}:{scene:3,reason:"\u8bf7\u81f3\u5c11\u9009\u62e91\u540d\u6210\u4eba",show:!0,vac_code:"vac_30039",vac_desc:"\u8bf7\u81f3\u5c11\u9009\u62e91\u540d\u6210\u4eba"}},oe=function(e,t){return null},ie=function(e,t){var n=t.adultCount,r=(t.childCount,t.childAges),a=n,o=t.infantCount,i=r.filter((function(e){return e>=12})).length,s=r.filter((function(e){return e<12&&e>0})).length;return 2*(a+i)>=s?2*(a+i)>=s+o&&a+i>=o?null:{scene:3,reason:"\u6bcf\u540d12\u5c81\u53ca\u4ee5\u4e0a\u7684\u51fa\u884c\u4eba\u6700\u591a\u53ef\u643a\u5e262\u540d12\u5c81\u4ee5\u4e0b\u7684\u513f\u7ae5\u62161\u540d12\u5c81\u4ee5\u4e0b\u7684\u513f\u7ae5+1\u540d\u5a74\u513f\u54e6~",show:!0,vac_code:"vac_30113",vac_desc:"SDP\u6210\u4eba\u513f\u7ae5\u6bd4"}:{scene:3,reason:"\u6bcf\u540d12\u5c81\u53ca\u4ee5\u4e0a\u7684\u51fa\u884c\u4eba\u6700\u591a\u53ef\u643a\u5e262\u540d12\u5c81\u4ee5\u4e0b\u7684\u513f\u7ae5\u54e6~",show:!0,vac_code:"vac_30112",vac_desc:"SDP\u6210\u4eba\u513f\u7ae5\u6bd4"}},se=function(e,t){e.MaxBookPerson;var n=t.adultCount,r=(t.childCount,t.childAges),a=t.infantCount;if(a>4)return{scene:3,reason:"\u6bcf\u5f20\u8ba2\u5355\u4ec5\u652f\u6301\u643a\u5e264\u540d\u5a74\u513f\u3002\u5982\u60a8\u9700\u8981\u643a\u5e264\u540d\u4ee5\u4e0a\u5a74\u513f\uff0c\u4e14\u5206\u591a\u4e2a\u8ba2\u5355\u8fdb\u884c\u9884\u8ba2\u3002",show:!0,vac_code:"vac_30118",vac_desc:"SDP\u56fd\u9645\u5a74\u513f\u6570"};var o=n,i=a,s=r.filter((function(e){return e>=12})).length,c=r.filter((function(e){return e<12&&e>0})).length;return 2*(o+s)>=c&&o+s>=i&&3*(o+s)>=c+i?null:{scene:3,reason:"\u6bcf\u540d12\u5c81\u53ca\u4ee5\u4e0a\u7684\u51fa\u884c\u4eba\u6700\u591a\u53ef\u643a\u5e262\u540d12\u5c81\u4ee5\u4e0b\u7684\u513f\u7ae5+1\u540d\u5a74\u513f\u54e6~",show:!0,vac_code:"vac_30111",vac_desc:"SDP\u56fd\u9645\u6210\u4eba\u513f\u7ae5\u6bd4"}},ce=function(e,t){var n=e.inventory;return t.adultCount+t.childCount>n&&n>0&&n<10?{scene:2,reason:"\u60a8\u9009\u62e9\u7684\u65e5\u671f\u4ec5\u5269".concat(n,"\u4e2a\u4f59\u4f4d"),show:!0,vac_code:"vac_30119",vac_desc:"\u60a8\u9009\u62e9\u7684\u65e5\u671f\u4ec5\u5269{x}\u4e2a\u4f59\u4f4d"}:null},le=function(e){var t="",n=e.adultCount,r=e.childCount,a=e.childAges,o=e.infantCount;return n>0&&(t+="".concat(n,"\u6210\u4eba")),r>0&&(t+="".concat(r,"\u513f\u7ae5")),a.length>0&&(t+="".concat(a,"\u5c81")),o>0&&(t+="\uff0c".concat(r,"\u5a74\u513f")),t},ue=function(e,t){var n=re(e,t),r=ne(e),a=n?r:Object.assign({},t),o=function(e,t){var n=e.childMinAge,r=e.childMaxAge,a=t.childAgeRange;return!a||n===a[0]&&r===a[1]?null:{scene:5,reason:"",show:!0,vac_code:"vac_30114",vac_desc:"\u5e74\u9f84\u8303\u56f4\u4e0d\u7b26"}}(e,a),i=function(e,t){var n=e.childAgeRequired,r=t.childCount,a=t.childAges;return n&&r>a.length?{scene:1,reason:"\u8bf7\u9009\u62e9\u513f\u7ae5\u5e74\u9f84",show:!0,vac_code:"vac_30120",vac_desc:"\u81ea\u52a8\u586b\u5145\u6700\u4f4e\u513f\u7ae5\u5e74\u9f84"}:null}(e,a),s=ce(e,a);return function(e,t){for(var n=e.MinBookPerson,r=e.inventory;r>0&&r<t.adultCount+t.childCount;)t.childCount>0?t.childCount--:t.adultCount>0&&t.adultCount--;if(r>0&&r<n){var a=ne(e);t.adultCount=a.adultCount,t.childCount=a.childCount}}(e,a),function(e,t){var n=e.childAgeRequired,r=e.childMinAge,a=t.childCount,o=t.childAges;n||(t.childAges=[]),n&&a>o.length&&(t.childAges=Array(t.childCount).fill(r)),o.length>a&&(t.childAges=t.childAges.slice(0,a))}(e,a),{result:s||i||o||n,initCount:a}},de=function(e,t){var n=ue(e,t),r=n.result,a=n.initCount;return r&&2===r.scene?(r.reason+="\uff0c\u5df2\u4e3a\u60a8\u8c03\u6574\u4eba\u6570",{initCount:a,errorInfo:r}):r&&1===r.scene?("vac_30120"!==r.vac_code&&(r.reason=""),{initCount:a,errorInfo:r}):r&&3===r.scene?(r.reason="",{initCount:a,errorInfo:r}):r&&5===r.scene?{initCount:t,errorInfo:null}:{initCount:a,errorInfo:r}},fe=function(e){var t=e.adultCanBook,n=e.childCanBook,r=e.infantCanBook,a=[];return t&&a.push("\u6210\u4eba"),n&&a.push("\u513f\u7ae5"),r&&a.push("\u5a74\u513f"),a.join("+")},pe=function(e){return{getPassengerInfo:function(){var t=e.getSync(C.b.VPC_SAVED_PASSANGER_INFO);if(!t)return null;if("RN"!==e.Platform)return t;var n=t.elderCount,r=void 0===n?0:n,a=t.adultCount,o=t.childCount,i=t.infantCount,s=void 0===i?0:i,c=t.childAges,l=void 0===c?[]:c,u=t.childAgeRange,d=void 0===u?[]:u,f={adultCount:r+a,childCount:o,infantCount:s,childAges:[]};return l.length>o&&(l=l.slice(0,o)),l.forEach((function(e){e>=0&&e<2?(f.infantCount++,f.childCount--):e>=0&&f.childAges.push(e)})),2===d.length&&d[0]<d[1]&&(f.childAgeRange=d),f},setPassengerInfo:function(t,n){if("RN"===e.Platform){var r=t.adultCount,a=t.childCount,o=t.infantCount,i=t.childAges,s=(e.getSync(C.b.VPC_SAVED_PASSANGER_INFO)||{}).elderCount,c=void 0===s?0:s,l={elderCount:c,adultCount:r-c,childCount:a,infantCount:o,childAges:i};r<c&&(l.adultCount=0,l.elderCount=r),n&&(l.childAgeRange=n),e.set(C.b.VPC_SAVED_PASSANGER_INFO,l,86400)}else e.set(C.b.VPC_SAVED_PASSANGER_INFO,t,86400)}}},me=function(e){var t={},n=function(){var n=b(y().mark((function n(o){var i;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.__pending&&e.traceKMInterruption("FetchTransaction has already been executed","vac_11001"),t={__pending:!0},n.prev=2,"UT"===(null==e?void 0:e.Platform)&&(t.__request_params={}),e.pageName||o.pageName){n.next=8;break}throw new Error("\u5fc5\u987b\u4f20\u5165 pageName");case 8:t.pageName=e.pageName||o.pageName;case 9:if(!o||o.productId){n.next=11;break}throw new Error("\u5fc5\u987b\u4f20\u5165 productId");case 11:return n.next=13,he(e,t)(o);case 13:return n.next=15,r();case 15:return i=n.sent,xe(e,t),n.abrupt("return",{result:!0,payload:i,request:t.__request_params});case 20:return n.prev=20,n.t0=n.catch(2),!(null==e?void 0:e.ignoreWarning)&&console.warn("fetchTransaction Failed:",n.t0.message),n.abrupt("return",{result:!1,payload:a(),request:t.__request_params});case 24:return n.prev=24,t={},n.finish(24);case 27:case"end":return n.stop()}}),n,null,[[2,20,24,27]])})));return function(e){return n.apply(this,arguments)}}(),r=function(){var n=b(y().mark((function n(){var r,a,o,i,s,c,l,u,d,f,p,m;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=ve(e,t),s=ye(e,t),c=ge(e,t),l=be(e,t),u=_e(e,t),d={},f=function(){var e=b(y().mark((function e(){var t,n,r=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<r.length)){e.next=12;break}return n=t<0||r.length<=t?void 0:r[t],e.t0=Object,e.t1=Object.assign({},d),e.next=7,n();case 7:e.t2=e.sent,d=e.t0.assign.call(e.t0,e.t1,e.t2);case 9:t++,e.next=1;break;case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),"cruise_detail"!==t.pageName){n.next=12;break}return n.next=10,f(i,l,c);case 10:n.next=14;break;case 12:return n.next=14,f(i,c);case 14:if(!(p=null===(a=null===(r=null==d?void 0:d.extraResource)||void 0===r?void 0:r.settings)||void 0===a?void 0:a.isQuickBookingV2)){n.next=18;break}return n.next=18,f(s);case 18:if(p){n.next=24;break}if(m=Te(null===(o=null==d?void 0:d.recommendSearch)||void 0===o?void 0:o.Flight),n.t0=m,!n.t0){n.next=24;break}return n.next=24,f(u);case 24:return d=Object.assign(Object.assign({},d),{shoppingId:t.shoppingid}),n.abrupt("return",d);case 26:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),a=function(){if("detail"===t.pageName){if(t.isUnavailable)return{toastMessage:"\u8be5\u4ea7\u54c1\u4e3a\u9884\u552e\u4ea7\u54c1\uff0c\u8bf7\u5230\u6700\u65b0\u7248APP\u4e0b\u5355"};if(t.isScheduleFail){var e=S.a.parse(t.date).format("M\u6708D\u65e5");return{toastMessage:"".concat(e,"\u73ed\u671f\u5df2\u552e\u7f44\uff0c\u8bf7\u66f4\u6362\u81f3\u5176\u4ed6\u73ed\u671f")}}if(t.isLimited)return{toastMessage:t.errorMessage||"\u5f53\u524d\u62a2\u8d2d\u4eba\u6570\u8fc7\u591a\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002",errorCode:"429"}}if("presale_detail"===t.pageName){var n="";if(t.isUnavailable)n="\u8be5\u4ea7\u54c1\u4e3a\u9884\u552e\u4ea7\u54c1\uff0c\u8bf7\u5230\u6700\u65b0\u7248APP\u4e0b\u5355";else if(t.isScheduleFail){if("multiLine"===t.routeType){var r=t.alias;n="".concat(r,"\u7ebf\u9884\u552e\u6b3e\u5df2\u552e\u7f44\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9")}"normal"===t.routeType&&(n="\u8be5\u4ea7\u54c1\u9884\u552e\u6b3e\u5df2\u552e\u7f44\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9")}return{shoppingId:t.shoppingid||"",toastMessage:n}}return"cruise_detail"===t.pageName&&t.__resourceStatuses?{ResourceStatuses:t.__resourceStatuses}:null};return n},he=function(e,t){var n=X(e),r=n.fetchProductInfo,a=n.getProductInfo,o=n.setProductInfo,i=pe(e);function s(){return(s=b(y().mark((function n(s){var c,l,u,d,f,p,m,h,v;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.get(C.b.VPC_DATE_INFO);case 2:if(c=n.sent){n.next=5;break}throw new Error("\u7f3a\u5c11\u9009\u4e2d\u65e5\u671f\u7f13\u5b58");case 5:return l=JSON.stringify(s),n.next=8,a(l);case 8:if(u=n.sent){n.next=14;break}return n.next=12,r(s);case 12:u=n.sent,o(u);case 14:if(d=te(u),f={date:c.date,price:c.price,displayPrice:c.displayPrice,inventory:c.inventory},p=i.getPassengerInfo(),m=ue(Object.assign(Object.assign({},d),f),p),m.result,h=m.initCount,Object.assign(t,Object.assign(Object.assign(Object.assign(Object.assign({},d),f),h),{shoppingid:""})),"extendedStay"!==t.segmentType||!["detail","resource"].includes(t.pageName)){n.next=26;break}return n.next=22,e.get(C.b.VPC_SEGMENT_INFO);case 22:if(v=n.sent,!Object(K.c)(s.segments)||!Object(K.c)(v)){n.next=25;break}throw new Error("\u5fc5\u987b\u4f20\u5165 segments");case 25:t.segments=s.segments||v;case 26:return n.next=28,e.get(C.b.VPC_230331_VAC_CXZ);case 28:t.__230331_VAC_CXZ=n.sent,e.traceKMLogMessage("\u63a8\u8350\u67e5\u8be2\u7684\u65e5\u671f\u4fe1\u606f\uff1a".concat(JSON.stringify(c))),e.set(C.b.VPC_HAS_AUTO_SHOW,!1);case 31:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function c(){return(c=b(y().mark((function e(n){var i,s,c,l;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.selectedResources){e.next=2;break}throw new Error("\u5fc5\u987b\u4f20\u5165 selectedResources");case 2:if(n.departureDate){e.next=4;break}throw new Error("\u5fc5\u987b\u4f20\u5165 departureDate");case 4:return i=JSON.stringify(n),e.next=7,a(i);case 7:if(s=e.sent){e.next=13;break}return e.next=11,r(n);case 11:s=e.sent,o(s);case 13:c=te(s),l={date:n.departureDate},Object.assign(t,Object.assign(Object.assign(Object.assign({},c),l),{adultCount:n.adultCount,childCount:n.childCount,selectedResources:n.selectedResources,shoppingid:""}));case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(){return(l=b(y().mark((function e(n){var s,c,l,u,d,f,p;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=JSON.stringify(n),e.next=3,a(s);case 3:if(c=e.sent){e.next=9;break}return e.next=7,r(n);case 7:c=e.sent,o(c);case 9:l=te(c),u={date:"2099-01-01",inventory:n.inventory},d=i.getPassengerInfo(),f=ue(Object.assign(Object.assign({},l),u),d),f.result,p=f.initCount,Object.assign(t,Object.assign(Object.assign(Object.assign(Object.assign({},l),u),p),{shoppingid:""})),l.isPresale&&(t.alias=n.alias,t.routeType=n.alias?"multiLine":"normal");case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(){return(u=b(y().mark((function n(a){var o,i,s,c;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.get(C.b.VPC_PRESALE_DATE_INFO);case 2:if(o=n.sent){n.next=5;break}throw new Error("\u7f3a\u5c11\u9009\u4e2d\u65e5\u671f\u7f13\u5b58");case 5:return n.next=7,e.get(C.b.VPC_PRESALE_PASSENGER_INFO);case 7:if(n.t0=n.sent,n.t0){n.next=10;break}n.t0={adultCount:2,childCount:0};case 10:if(i=n.t0){n.next=13;break}throw new Error("\u7f3a\u5c11\u4eba\u6570\u7f13\u5b58");case 13:return n.next=15,r(a);case 15:s=n.sent,c=te(s,o),Object.assign(t,Object.assign(Object.assign(Object.assign({},c),i),{shoppingid:"",alias:a.alias,routeType:a.alias?"multiLine":"normal",preSaleShoppingId:a.preSaleShoppingId}));case 18:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return function(e){switch(e.pageName){case"presale_order_complete":return function(e){return u.apply(this,arguments)}(e);case"presale_detail":case"presale_order":return function(e){return l.apply(this,arguments)}(e);case"cruise_detail":return function(e){return c.apply(this,arguments)}(e);default:return function(e){return s.apply(this,arguments)}(e)}}},ve=function(e,t){var n=function(){var n=b(y().mark((function n(){var r,a,o;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],"fixSegment"===t.segmentType&&(r=[{Key:"ab_flight_new",Value:"B"},{Key:"ab_flight_merge",Value:"B"},{Key:"ab_hotel_merge",Value:"B"},{Key:"isActualLoss",Value:"true"}],"multiLine"===t.routeType?r.push({Key:"productlinetype",Value:t.alias}):"multiTravel"===t.routeType&&(r.push({Key:"productlinetype",Value:t.alias}),r.push({Key:"productlinename",Value:t.routeName}))),e.H5Util&&e.H5Util.isBstHomeWxMini&&e.H5Util.isBstHomeWxMini()&&(r.push({Key:"bst_miniProgram",Value:"bstHomeWxmini"}),r.push({Key:"bst_pricechange",Value:"C"})),n.next=5,Ie(e,t);case 5:if((a=n.sent)&&r.push({Key:"UserTraceId",Value:a}),t.isCruise||(r.push({Key:"isCalculateVipDiscount",Value:"true"}),r.push({Key:"isCalculateFlightDiscount",Value:"true"})),"presale_order_complete"===t.pageName&&t.preSaleShoppingId&&r.push({Key:"PreSaleShoppingId",Value:t.preSaleShoppingId}),t.__230331_VAC_CXZ&&r.push({Key:"230331_VAC_CXZ",Value:t.__230331_VAC_CXZ}),t.departcityid&&r.push({Key:"departcityid",Value:String(t.departcityid)}),t.departcityname&&r.push({Key:"departcityname",Value:t.departcityname}),t.displayPrice&&r.push({Key:"recommendsearch_calendar_price",Value:String(t.displayPrice)}),"H5"!=e.Platform||!e.antiSpider){n.next=19;break}return n.next=16,e.antiSpider.getToken({Extras:[{Key:"product.id",Value:String(t.line)},{Key:"product.city",Value:String(t.departcityid)},{Key:"user.checkin",Value:t.date},{Key:"user.checkout",Value:t.date}]});case 16:(o=n.sent)&&o.token&&r.push({Key:"ValidateToken",Value:o.token}),o&&o.hoteluuidkeys&&r.push({Key:"fingerprintkeys",Value:o.hoteluuidkeys});case 19:return n.abrupt("return",r);case 20:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),r=function(){var e=[{Type:"Adult",Count:t.adultCount,Ages:null},{Type:"Child",Count:t.childCount,Ages:null}];return"sdp"===t.productType&&e.push({Type:"Infant",Count:t.infantCount,Ages:null}),t.childAgeRequired&&(e[1].Ages=t.childAges),e},a=function(){var t=b(y().mark((function t(n){var r,a,o,i,s,c;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getCachedLocationData();case 2:return s=t.sent,(null===(r=null==s?void 0:s.cachedGeo)||void 0===r?void 0:r.lng)&&(null===(a=null==s?void 0:s.cachedGeo)||void 0===a?void 0:a.lat)&&n.Tags.push({Key:"latitude",Value:s.cachedGeo.lat},{Key:"longitude",Value:s.cachedGeo.lng}),(null===(i=null===(o=null==s?void 0:s.cachedCtripCity)||void 0===o?void 0:o.RecommendList)||void 0===i?void 0:i.length)>0&&(c=s.cachedCtripCity.RecommendList[0]||{}).GeoID&&(n.PositionCityId=c.GeoID),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),o=function(e){return"extendedStay"===t.segmentType&&(e.Segments=t.segments),e};function i(){return(i=b(y().mark((function i(){var s,c,l,u,f,p,m,h,v,g,_,b,I,x,T,k,S,C,w,N,E,P,j;return y().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return h=e.attachShardParams(),v=Number(h.Version),i.next=4,n();case 4:if(g=i.sent,_=r(),b={ProductId:t.line,departCityId:t.departcityid,DepartDate:t.date,Passengers:_,Tags:g,Version:v,ClientInfo:{Locale:"zh-CN",Currency:"CNY"}},b=o(b),"RN"!=e.Platform){i.next=12;break}return i.next=11,a(b);case 11:b=i.sent;case 12:return t.__request_params&&(t.__request_params.recommendSearch=b),i.prev=13,I=(new Date).getTime(),x=e.createRequest("/20168/RecommendSearch",b,{allowAnyAck:!0}),i.next=18,x.fetch();case 18:if(T=i.sent,k=(new Date).getTime(),T&&T.ResponseStatus&&T.ShoppingId){i.next=23;break}throw e.traceKMInterruption("\u8282\u70b9\u4e0d\u5b8c\u6574","vac_10004"),new Error("vac_10004");case 23:if(e.traceKMLogAction({attrs:[{key:"productId",value:String(t.line)}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"/20168/RecommendSearch",role:d.RoleType.sys,action:d.ActionType.show,value:"".concat(k-I,"ms"),rootMessageId:Object(K.a)(null===(s=null==T?void 0:T.ResponseStatus)||void 0===s?void 0:s.Extension)}),!((null===(l=null===(c=null==T?void 0:T.ResponseStatus)||void 0===c?void 0:c.Errors)||void 0===l?void 0:l.length)>0)){i.next=29;break}throw S=(null===(f=null===(u=null==T?void 0:T.ResponseStatus)||void 0===u?void 0:u.Errors)||void 0===f?void 0:f[0])||{},C=S.ErrorCode,w=S.Message,e.traceKMInterruption(w,C),"vac_20000"===C||"vac_20046"===C?t.isScheduleFail=!0:"vac_20050"===C?t.isUnavailable=!0:"429"!==C||"RN"!==e.Platform&&"UT"!==e.Platform||(t.isLimited=!0,t.errorMessage=w),new Error(C);case 29:if("Success"===(null===(p=null==T?void 0:T.ResponseStatus)||void 0===p?void 0:p.Ack)){i.next=32;break}throw e.traceKMInterruption("Ack Fail","vac_10004"),new Error("vac_10004");case 32:if(!((null===(m=null==T?void 0:T.ResourceStatuses)||void 0===m?void 0:m.length)>0)){i.next=35;break}throw N=T.ResourceStatuses[0].Desc,new Error("\u63a5\u53e3\u62a5\u9519\uff1a".concat(N||""));case 35:return t.shoppingid=T.ShoppingId,i.abrupt("return",{recommendSearch:T});case 39:throw i.prev=39,i.t0=i.catch(13),E=i.t0.isNetError,P=i.t0.message,j=void 0===P?"":P,E||j.startsWith("vac_")||"429"===j||e.traceKMLogError({pageName:t.pageName,message:"/20168/RecommendSearch->".concat(j),ex:i.t0}),new Error("fetchRecommendSearch Fail: ".concat(j));case 44:case"end":return i.stop()}}),i,null,[[13,39]])})))).apply(this,arguments)}return function(){return i.apply(this,arguments)}},ge=function(e,t){function n(){return(n=b(y().mark((function n(){var r,a,o,i,s,c,l,u,f,p,m,h,v,g,_,b,I,x,T,k,S,C,w,N,E,P,j,O,D,R,A,M;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.shoppingid){n.next=2;break}throw new Error("no shoppingid");case 2:if(u="VPC_ExtraResource",f=Q,p=e.attachShardParams(),m=Number(p.Version),h={extension:[]},!(t.price>=0)){n.next=13;break}return h.extension.push({name:"calendar_price_v2",value:t.price}),n.next=11,Ie(e,t);case 11:n.sent||h.extension.push({name:"calendar_price",value:t.price});case 13:return v={params:Object.assign(Object.assign({ShoppingId:t.shoppingid,RecommendType:1,Options:[],Channel:4},p),{Version:m}),ShoppingDetailParams:Object.assign(Object.assign({},p),{Version:m})},t.__request_params&&(t.__request_params.extraResource={variables:v,options:h}),n.prev=15,g=(new Date).getTime(),_=e.createGqlRequest(f,v,u,h),n.next=20,_.fetch();case 20:if(b=n.sent,I=(new Date).getTime(),b&&b.data&&b.extensions){n.next=25;break}throw e.traceKMInterruption("\u8282\u70b9\u4e0d\u5b8c\u6574","vac_10081"),new Error("vac_10081");case 25:if(x=b.data,T=b.extensions,e.traceKMLogAction({attrs:[{key:"productId",value:String(t.line)},{key:"shoppingId",value:t.shoppingid}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"fetchExtraResource",role:d.RoleType.sys,action:d.ActionType.show,value:"".concat(I-g,"ms"),rootMessageId:Object(K.a)(null===(a=null===(r=null==T?void 0:T.SoaResponseStatus)||void 0===r?void 0:r.ResponseStatus)||void 0===a?void 0:a.Extension)}),x&&x.extraResource&&x.shoppingDetail){n.next=30;break}throw e.traceKMInterruption("\u8282\u70b9\u4e0d\u5b8c\u6574","vac_10081"),new Error("vac_10081");case 30:if(k=x.extraResource,S=x.shoppingDetail,C=null==k?void 0:k.ResponseStatus,w=null===(o=null==k?void 0:k.optionUpdateResult)||void 0===o?void 0:o.ResponseStatus,!((null===(i=null==C?void 0:C.Errors)||void 0===i?void 0:i.length)>0)){n.next=38;break}throw N=(null===(s=null==C?void 0:C.Errors)||void 0===s?void 0:s.find((function(e){var t;return null===(t=String(null==e?void 0:e.ErrorCode))||void 0===t?void 0:t.startsWith("vac_")})))||{},E=N.ErrorCode,P=N.Message,e.traceKMInterruption(P,E),"vac_20000"!==E&&"vac_20046"!==E||(t.isScheduleFail=!0),new Error(E);case 38:if("Success"===(null==C?void 0:C.Ack)){n.next=40;break}throw new Error("vac_10081");case 40:if(!((null===(c=null==w?void 0:w.Errors)||void 0===c?void 0:c.length)>0)){n.next=46;break}if(!(j=(null===(l=null==w?void 0:w.Errors)||void 0===l?void 0:l[0])||{})||!j.ErrorCode){n.next=46;break}throw O=j.ErrorCode,D=j.Message,e.traceKMInterruption(D,O),new Error(O);case 46:if("Success"===(null==w?void 0:w.Ack)){n.next=49;break}throw e.traceKMInterruption("\u73ed\u671f\u4e0d\u53ef\u8ba2\uff0c\u8bf7\u91cd\u9009\u73ed\u671f","vac_20039"),new Error("vac_20039");case 49:return n.abrupt("return",{extraResource:k,shoppingDetail:S});case 52:throw n.prev=52,n.t0=n.catch(15),R=n.t0.isNetError,A=n.t0.message,M=void 0===A?"":A,R||M.startsWith("vac_")||e.traceKMLogError({pageName:t.pageName,message:"fetchExtraResource->".concat(M),ex:n.t0}),new Error("fetchExtraResource Fail: ".concat(M));case 57:case"end":return n.stop()}}),n,null,[[15,52]])})))).apply(this,arguments)}return function(){return n.apply(this,arguments)}},ye=function(e,t){function n(){return(n=b(y().mark((function n(){var r,a,o,i,s,c,l,u,f,p,m,h,v,g,_,b,I,x,T,k,S,C;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,t.shoppingid){n.next=3;break}throw new Error("no shoppingid");case 3:return f=e.attachShardParams&&e.attachShardParams(),p={platform:(null==f?void 0:f.PlatformId)||0,channel:(null==f?void 0:f.ChannelCode)||0,isAsync:!0,isCallBack:!1,orderType:0,shoppingid:t.shoppingid,commonType:{version:null==f?void 0:f.Version,channelId:(null===(r=null==f?void 0:f.PlatformChannelInfo)||void 0===r?void 0:r.ChannelId)||117}},t.__request_params&&(t.__request_params.canBooking=p),m=(new Date).getTime(),h=e.createRequest("/13826/CanBooking",p),n.next=10,h.fetch();case 10:if(v=n.sent,g=(new Date).getTime(),v&&v.ResponseStatus){n.next=15;break}throw e.traceKMInterruption("\u8282\u70b9\u4e0d\u5b8c\u6574","vac_10084"),new Error("vac_10084");case 15:if(e.traceKMLogAction({attrs:[{key:"productId",value:String(t.line)},{key:"shoppingId",value:t.shoppingid}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"/13826/CanBooking",role:d.RoleType.sys,action:d.ActionType.show,value:"".concat(g-m,"ms"),rootMessageId:Object(K.a)(null===(a=null==v?void 0:v.ResponseStatus)||void 0===a?void 0:a.Extension)}),!((null===(i=null===(o=null==v?void 0:v.ResponseStatus)||void 0===o?void 0:o.Errors)||void 0===i?void 0:i.length)>0)){n.next=20;break}throw _=(null===(c=null===(s=null==v?void 0:v.ResponseStatus)||void 0===s?void 0:s.Errors)||void 0===c?void 0:c[0])||{},b=_.ErrorCode,I=_.Message,e.traceKMInterruption(I,b),new Error(b);case 20:if("Success"===(null===(l=null==v?void 0:v.ResponseStatus)||void 0===l?void 0:l.Ack)){n.next=23;break}throw e.traceKMInterruption("Ack Fail","vac_10084"),new Error("vac_10084");case 23:if(v.isSuccess){n.next=26;break}throw x=(null===(u=null==v?void 0:v.canBookingResults)||void 0===u?void 0:u[0])||{},x.code,T=x.message,new Error("\u63a5\u53e3\u62a5\u9519\uff1a".concat(T||""));case 26:return n.abrupt("return",{canBooking:v});case 29:throw n.prev=29,n.t0=n.catch(0),k=n.t0.isNetError,S=n.t0.message,C=void 0===S?"":S,k||C.startsWith("vac_")||e.traceKMLogError({pageName:t.pageName,message:"/13826/CanBooking->".concat(C),ex:n.t0}),new Error("fetchCanBooking Fail: ".concat(C));case 34:case"end":return n.stop()}}),n,null,[[0,29]])})))).apply(this,arguments)}return function(){return n.apply(this,arguments)}},_e=function(e,t){function n(){return(n=b(y().mark((function n(){var r,a,o,i,s,c,l,u,f,p,m,h,v,g,_,b,I;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.shoppingid){n.next=2;break}throw new Error("no shoppingid");case 2:return s=ee,c={params:{clientParams:{appType:"app",appVersion:e.appVersion,sourcefrom:"tour_channel"},ShoppingId:t.shoppingid,Headers:[{Name:"SearchPKGRefer",value:"T"}],PageType:"DetailInfo"}},l={isDiy:!0},t.__request_params&&(t.__request_params.cabinInfo=c),n.prev=7,u=(new Date).getTime(),f=e.createGqlRequest(s,c,"CabinInfo",l),n.next=12,f.fetch();case 12:if(p=n.sent,m=(new Date).getTime(),p&&p.data&&p.extensions){n.next=16;break}throw new Error("\u8282\u70b9\u4e0d\u5b8c\u6574");case 16:if(h=p.data,v=p.extensions,e.traceKMLogAction({attrs:[{key:"productId",value:String(t.line)},{key:"shoppingId",value:t.shoppingid}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"fetchCabinInfo",role:d.RoleType.sys,action:d.ActionType.show,value:"".concat(m-u,"ms"),rootMessageId:Object(K.a)(null===(a=null===(r=null==v?void 0:v.SoaResponseStatus)||void 0===r?void 0:r.ResponseStatus)||void 0===a?void 0:a.Extension)}),"Success"===(null===(i=null===(o=null==v?void 0:v.SoaResponseStatus)||void 0===o?void 0:o.ResponseStatus)||void 0===i?void 0:i.Ack)){n.next=20;break}throw new Error("ResponseStatus Ack Fail");case 20:return g=(null==h?void 0:h.CabinInfo)||null,n.abrupt("return",{cabinInfo:g});case 24:return n.prev=24,n.t0=n.catch(7),_=n.t0.isNetError,b=n.t0.message,I=void 0===b?"":b,_||e.traceKMLogError({pageName:t.pageName,message:"fetchCabinInfo->".concat(I),ex:n.t0}),n.abrupt("return",{});case 29:case"end":return n.stop()}}),n,null,[[7,24]])})))).apply(this,arguments)}return function(){return n.apply(this,arguments)}},be=function(e,t){function n(){return(n=b(y().mark((function n(){var r,a,o,i,s,c,l,u,f,p,m,h,v,g,_,b,I,x,T,k;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.shoppingid){n.next=2;break}throw new Error("no shoppingid");case 2:return f={ShoppingId:t.shoppingid,SelectedResources:t.selectedResources,Tags:[{Key:"resourceType",Value:64}]},t.__request_params&&(t.__request_params.updateShoppingDetail=f),n.prev=4,p=(new Date).getTime(),m=e.createRequest("/20168/UpdateShoppingDetail",f,{allowAnyAck:!0}),n.next=9,m.fetch();case 9:if(h=n.sent,v=(new Date).getTime(),h&&h.ResponseStatus){n.next=14;break}throw e.traceKMInterruption("\u8282\u70b9\u4e0d\u5b8c\u6574","vac_10076"),new Error("vac_10076");case 14:if(e.traceKMLogAction({attrs:[{key:"productId",value:String(t.line)},{key:"shoppingId",value:t.shoppingid}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"/20168/UpdateShoppingDetail",role:d.RoleType.sys,action:d.ActionType.show,value:"".concat(v-p,"ms"),rootMessageId:Object(K.a)(null===(r=null==h?void 0:h.ResponseStatus)||void 0===r?void 0:r.Extension)}),(null===(a=null==h?void 0:h.ResourceStatuses)||void 0===a?void 0:a.length)>0&&(t.__resourceStatuses=null==h?void 0:h.ResourceStatuses),!((null===(i=null===(o=null==h?void 0:h.ResponseStatus)||void 0===o?void 0:o.Errors)||void 0===i?void 0:i.length)>0)){n.next=20;break}throw g=(null===(c=null===(s=null==h?void 0:h.ResponseStatus)||void 0===s?void 0:s.Errors)||void 0===c?void 0:c[0])||{},_=g.ErrorCode,b=g.Message,e.traceKMInterruption(b,_),new Error(_);case 20:if("Success"===(null===(l=null==h?void 0:h.ResponseStatus)||void 0===l?void 0:l.Ack)){n.next=23;break}throw e.traceKMInterruption("Ack Fail","vac_10076"),new Error("vac_10076");case 23:if(!((null===(u=null==h?void 0:h.ResourceStatuses)||void 0===u?void 0:u.length)>0)){n.next=26;break}throw I=h.ResourceStatuses[0].Desc,new Error("\u63a5\u53e3\u62a5\u9519\uff1a".concat(I||""));case 26:return n.abrupt("return",{updateShoppingDetail:h});case 29:throw n.prev=29,n.t0=n.catch(4),x=n.t0.isNetError,T=n.t0.message,k=void 0===T?"":T,x||k.startsWith("vac_")||e.traceKMLogError({pageName:t.pageName,message:"/20168/UpdateShoppingDetail->".concat(k),ex:n.t0}),new Error("fetchUpdateShoppingDetail Fail: ".concat(k));case 34:case"end":return n.stop()}}),n,null,[[4,29]])})))).apply(this,arguments)}return function(){return n.apply(this,arguments)}},Ie=function(){var e=b(y().mark((function e(t,n){var r,a,o,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.line,a=n.alias,o=n.segmentType,e.next=3,t.get(C.b.VPC_SHOPPING_HISTORY);case 3:if(!(i=e.sent)||"extendedStay"===o){e.next=6;break}return e.abrupt("return",i["".concat(r,"_").concat(a)]||"");case 6:return e.abrupt("return","");case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),xe=function(e,t){var n=t.line,r=t.alias,a=t.shoppingid;"extendedStay"!==t.segmentType&&e.set(C.b.VPC_SHOPPING_HISTORY,Object(W.a)({},"".concat(n,"_").concat(r),a),86400)},Te=function(e){if(Object(K.c)(e)||Object(K.c)(e.Segments)||Object(K.c)(e.FlightSeats))return!1;var t=(null==e?void 0:e.FlightSeats)||[];return!(null==t?void 0:t.some((function(e){return ke(e)})))},ke=function(e){return e&&e.VacationSeat&&e.VacationSeat.Tags&&e.VacationSeat.Tags.some((function(e){return"Hide"==e.Type&&"T"==e.Name}))},Se={selectedDate:"",isShowSelectDate:!1,isInitReady:!1,selectedDateFromProps:""},Ce=Object(a.createReactModel)((function(){var e=Object(I.setupTourContext)(),t=e.props,n=Object(r.setupStore)({name:"isomorphic_select_date_components",initialState:Se,reducers:q,logger:K.b&&!K.d&&!!t.logger}),a=n.store,o=n.actions,i=function(e,t){return{fetchProductInfo:function(){var n=b(y().mark((function n(r){var a,o,i,s,c,l,u,f,p,m,h,v,g,_,b,I,x,T,k,S,C;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=r.productId,l=r.alias,u=r.departCityId,f=r.needTradePrice,c){n.next=3;break}throw new Error("\u7f3a\u5c11 productId");case 3:return p=t.seckill?Y:z,m=Object.assign({ProductId:Number(c),DepartureCityId:2},e.attachShardParams()),l&&(m.Alias=[l]),u&&(m.DepartureCityId=Number(u)),h={queryTourGroup:!0,needAlias:!0,needInventory:!0,needFlightDiscountPrice:!0},"presale_detail"!==t.pageName&&"presale_order"!==t.pageName||(h.needPreSale=!0,h.queryTourGroup=!1),"presale_order_complete"===t.pageName&&(h.needPreSale=!0,h.queryTourGroup=!1),f&&(h.needTradePrice=!0),console.log("\ud83e\udd21priceCalendarParams",{priceCalendarParams:h,props:t}),v={productParams:m,priceCalendarParams:h},g={},n.prev=15,_=(new Date).getTime(),b=e.createGqlRequest(p,v,"VPC_SelectDateProductInfo",g),n.next=20,b.fetch();case 20:if((I=n.sent)&&I.data&&I.extensions){n.next=23;break}throw new Error("\u8282\u70b9\u4e0d\u5b8c\u6574");case 23:if(x=(new Date).getTime(),T=I.data,k=I.extensions,e.traceKMLogAction({attrs:[{key:"productId",value:String(c)}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"fetchSelectDateProductInfo",role:d.RoleType.sys,action:d.ActionType.show,value:"".concat(x-_,"ms"),rootMessageId:Object(K.a)(null===(o=null===(a=null==k?void 0:k.SoaResponseStatus)||void 0===a?void 0:a.ResponseStatus)||void 0===o?void 0:o.Extension)}),T&&T.productInfo&&!Object(K.c)(T.productInfo.priceCalendar)){n.next=28;break}throw new Error("\u8282\u70b9\u4e0d\u5b8c\u6574");case 28:if("Success"===(null===(s=null===(i=T.productInfo.priceCalendar)||void 0===i?void 0:i.ResponseStatus)||void 0===s?void 0:s.Ack)){n.next=30;break}throw new Error("\u8282\u70b9\u4e0d\u5b8c\u6574");case 30:if(S=T.productInfo,"Success"===(null==(C=null==S?void 0:S.ResponseStatus)?void 0:C.Ack)){n.next=34;break}throw new Error("ResponseStatus Ack Failed");case 34:return n.abrupt("return",S);case 37:throw n.prev=37,n.t0=n.catch(15),n.t0.isNetError||e.traceKMLogError({pageName:e.pageName,message:"fetchSelectDateProductInfo->".concat((null===n.t0||void 0===n.t0?void 0:n.t0.message)||JSON.stringify(n.t0)),errorType:d.ErrorType.Ack_Fail,ex:n.t0}),new Error("fetchSelectDateProductInfo Fail: ".concat(n.t0.message));case 41:case"end":return n.stop()}}),n,null,[[15,37]])})));return function(e){return n.apply(this,arguments)}}()}}(e,t),s=me(e),c=X(e).setProductInfo,l=!1,u=!1;Object(r.setupPreloadCallback)(b(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));var f=function(){var n=b(y().mark((function n(r){var i,s,c,d,f,m,h;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=r.isShow,s=o.UPDATE_PROPS,i){n.next=6;break}return s({isShowSelectDate:!1}),u&&e.traceKMLogMessage("\u5173\u95ed\u9009\u62e9\u65e5\u671f\u7ec4\u4ef6"),n.abrupt("return");case 6:if(c=a.getState(),c.isInitReady){n.next=10;break}return l=!0,n.abrupt("return");case 10:if(u=!0,"resource"!==t.pageName&&"order"!==t.pageName){n.next=24;break}if(d="","RN"!==e.Platform){n.next=19;break}return n.next=16,g.getNewProcessSelectedDate();case 16:d=n.sent,n.next=23;break;case 19:return n.next=21,e.get(C.b.VPC_DATE_INFO);case 21:f=n.sent,d=(null==f?void 0:f.date)||"";case 23:p(d);case 24:"detail"!==t.pageName&&"presale_order_complete"!==t.pageName&&"cruise_detail"!==t.pageName||(m=a.getState(),h=m.selectedDateFromProps,p((void 0===h?"":h)||"")),s({isShowSelectDate:!0}),e.traceKMLogMessage("\u6253\u5f00\u9009\u62e9\u65e5\u671f\u7ec4\u4ef6");case 27:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),p=function(){var e=b(y().mark((function e(t){var n,r,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.getState(),r=n.priceCalendarParams,i=o.UPDATE_CALANDAR_SELECTED_DATE,t){e.next=5;break}return i(""),e.abrupt("return");case 5:if(!_.isDisabledDate(t)){e.next=8;break}return i(""),e.abrupt("return");case 8:t&&r.selectedDate!==U(t)&&i(t);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=b(y().mark((function e(t){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!_.isDisabledDate(t)){e.next=2;break}return e.abrupt("return");case 2:(0,o.UPDATE_CALANDAR_DISABLE_DATE)(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=b(y().mark((function e(n){var r,s,u,d,p,m,h,v,_;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.disableDates,s=o.UPDATE_PRODUCT_INFO,u=o.UPDATE_CALANDAR_DATA,d=o.UPDATE_INIT_PARAMS,o.UPDATE_CALANDAR_DISABLE_DATES,p=o.UPDATE_DATA,d(n),"presale_order_complete"===t.pageName&&(m=n.presaleOrderPassengerInfo,g.setPresalePassengerInfo(m)),e.next=7,i.fetchProductInfo(n);case 7:if(h=e.sent,c(h),v=w(h),s(v),_=N(a.getState(),t,n),!x.a.isEmpty(null==_?void 0:_.dailyMinPrices)){e.next=17;break}return p(_),e.abrupt("return",{});case 17:return u(_),l&&f({isShow:!0}),e.abrupt("return",_);case 20:e.next=27;break;case 22:return e.prev=22,e.t0=e.catch(0),null===(r=null==t?void 0:t.onError)||void 0===r||r.call(t,e.t0),console.error("\u9009\u62e9\u65e5\u671f\u7ec4\u4ef6\u521d\u59cb\u5316\u5931\u8d25",e.t0),e.abrupt("return",{});case 27:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(t){return e.apply(this,arguments)}}(),v={handleSelectDate:function(e){return b(y().mark((function n(){var r;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("order"!==(r=t.pageName)&&"resource"!==r){n.next=6;break}return n.next=4,v.handleTourSelectDate(e);case 4:n.next=19;break;case 6:if("detail"!==r){n.next=11;break}return n.next=9,v.handleDetailSelectDate(e);case 9:n.next=19;break;case 11:if("presale_order_complete"!==r){n.next=16;break}return n.next=14,v.handlePresaleOrderSelectDate(e);case 14:n.next=19;break;case 16:if("cruise_detail"!==r){n.next=19;break}return n.next=19,v.handleCruiseDetailSelectDate(e);case 19:case"end":return n.stop()}}),n)})))()},handleTourSelectDate:function(t){return b(y().mark((function n(){var r,o,i,c,l,u,f,p,h,v,b;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.props,o=a.getState(),o.isInitReady){n.next=4;break}return n.abrupt("return");case 4:return i=t.selectDate,c=a.getState(),l=c.pageStatus,u=_.getProductPrice(i),n.next=9,g.getNewProcessSelectedDate();case 9:if(f=n.sent,!x.a.isEmpty(u)){n.next=12;break}return n.abrupt("return");case 12:return p=(u||{}).price,e.traceKMLogAction({attrs:[{key:"productId",value:String(l.activeProductId)},{key:"page",value:r.pageName}],scene:"\u51fa\u53d1\u65e5\u671f",module:"\u4ef7\u683c\u65e5\u5386\u5f39\u5c42",value:"".concat(i," / ").concat(p),before:f,action:d.ActionType.change,role:d.RoleType.usr}),g.set_VPC_DATE_INFO(u),g.setNewProcessSelectedDate(i),r.onClose(),e.showLoading(),n.next=20,s({pageName:r.pageName,productId:l.activeProductId,alias:l.activeAlias,departCityId:l.departCityId});case 20:h=n.sent,v=h.result,b=h.payload,v||"429"===(null==b?void 0:b.errorCode)||m(i),r.onSelect({result:v,payload:b}),e.hideLoading();case 25:case"end":return n.stop()}}),n)})))()},handleDetailSelectDate:function(t){return b(y().mark((function n(){var r,o,i,s,c,l,u,f;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.props,o=a.getState(),o.isInitReady){n.next=4;break}return n.abrupt("return");case 4:return i=t.selectDate,s=a.getState(),c=s.pageStatus,l=_.getDetailDateInfo(i),n.next=9,g.getNewProcessSelectedDate();case 9:if(u=n.sent,!x.a.isEmpty(l)){n.next=12;break}return n.abrupt("return");case 12:f=(l||{}).price,e.traceKMLogAction({attrs:[{key:"productId",value:String(c.activeProductId)},{key:"page",value:r.pageName}],scene:"\u51fa\u53d1\u65e5\u671f",module:"\u4ef7\u683c\u65e5\u5386\u5f39\u5c42",value:"".concat(i," / ").concat(f),before:u,action:d.ActionType.change,role:d.RoleType.usr}),g.set_VPC_DATE_INFO(l),g.setNewProcessSelectedDate(i),r.onClose(),r.onSelect(l);case 18:case"end":return n.stop()}}),n)})))()},handlePresaleOrderSelectDate:function(t){return b(y().mark((function n(){var r,o,i,c,l,u,f,p,h,v,b,I,T;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.props,o=a.getState(),o.isInitReady){n.next=4;break}return n.abrupt("return");case 4:return i=t.selectDate,c=a.getState(),l=c.pageStatus,u=_.getProductPrice(i),n.next=9,g.getNewProcessSelectedDate();case 9:if(f=n.sent,!x.a.isEmpty(u)){n.next=12;break}return n.abrupt("return");case 12:return p=(u||{}).price,e.traceKMLogAction({attrs:[{key:"productId",value:String(l.activeProductId)},{key:"page",value:r.pageName}],scene:"\u51fa\u53d1\u65e5\u671f",module:"\u4ef7\u683c\u65e5\u5386\u5f39\u5c42",value:"".concat(i," / ").concat(p),before:f,action:d.ActionType.change,role:d.RoleType.usr}),g.set_VPC_DATE_INFO(u),g.setNewProcessSelectedDate(i),r.onClose(),e.showLoading(),h=a.getState(),v=h.initParams,n.next=21,s({pageName:r.pageName,productId:l.activeProductId,alias:l.activeAlias,departCityId:l.departCityId,preSaleShoppingId:(null==v?void 0:v.preSaleShoppingId)||""});case 21:if(b=n.sent,I=b.result,T=b.payload,!I){n.next=29;break}return n.next=27,r.onSelect({result:I,payload:Object.assign(Object.assign({},T),{selectDate:i})});case 27:n.next=31;break;case 29:m(i),r.onSelect({result:I,payload:Object.assign(Object.assign({},T),{selectDate:i})});case 31:e.hideLoading();case 32:case"end":return n.stop()}}),n)})))()},handleCruiseDetailSelectDate:function(t){return b(y().mark((function n(){var r,o,i,s,c,l,u;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.props,o=a.getState(),o.isInitReady){n.next=4;break}return n.abrupt("return");case 4:if(i=t.selectDate,s=a.getState(),c=s.pageStatus,l=_.getProductPrice(i),!x.a.isEmpty(l)){n.next=9;break}return n.abrupt("return");case 9:u=(l||{}).price,e.traceKMLogAction({attrs:[{key:"productId",value:String(c.activeProductId)},{key:"page",value:r.pageName}],scene:"\u51fa\u53d1\u65e5\u671f",module:"\u4ef7\u683c\u65e5\u5386\u5f39\u5c42",value:"".concat(i," / ").concat(u),action:d.ActionType.change,role:d.RoleType.usr}),r.onClose(),r.onSelect(l);case 13:case"end":return n.stop()}}),n)})))()},handleSyncDetailStorage:function(e){if(e){var t=_.getDetailDateInfo(e);x.a.isEmpty(t)||g.set_VPC_DATE_INFO(t)}}},g={getNewProcessSelectedDate:function(){return b(y().mark((function t(){var n;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.get(C.b.NewProcessSelectedDate);case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0="";case 5:return n=t.t0,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})))()},getPresalePassengerInfo:function(){return b(y().mark((function t(){var n;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.get(C.b.VPC_PRESALE_PASSENGER_INFO);case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:return n=t.t0,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})))()},setNewProcessSelectedDate:function(n){"resource"!==t.pageName&&"order"!==t.pageName||e.set(C.b.NewProcessSelectedDate,n,86400)},setPresalePassengerInfo:function(t){e.set(C.b.VPC_PRESALE_PASSENGER_INFO,t,86400)},set_VPC_DATE_INFO:function(n){"presale_order_complete"===t.pageName?e.set(C.b.VPC_PRESALE_DATE_INFO,n,86400):e.set(C.b.VPC_DATE_INFO,n,86400)}},_={isDisabledDate:function(e){var t;if(!e)return!0;var n=(a.getState().priceCalendarParams||{}).dayConfig,r=U(e);return!(null==n?void 0:n[r])||!!(null===(t=null==n?void 0:n[r])||void 0===t?void 0:t.disable)},getProductPrice:function(e){var n=a.getState(),r=n.flatDailyMinPrice,o=n.pageStatus,i=(null==r?void 0:r[e])||[],s={};return s=o.isMultiTravel?i.find((function(e){return e.alias===o.activeAlias})):i.find((function(e){return e.productId===o.activeProductId})),x.a.isEmpty(s)?(console.warn("".concat(t.pageName,"\u5f53\u524d\u9009\u62e9\u65e5\u671f\u4e0b\u65e0\u73ed\u671f\u4fe1\u606f")),{}):Object.assign({date:e},s)},getDetailDateInfo:function(n){var r=a.getState(),o=r.flatDailyMinPrice,i=r.pageStatus;if(!x.a.isEmpty(i)){var s=(null==o?void 0:o[n])||[],c={};return i.isMultiTravel?(c=s.find((function(e){return e.alias===i.activeAlias})),x.a.isEmpty(c)&&(c=s[0])):(c=s.find((function(e){return e.productId===i.activeProductId})),x.a.isEmpty(c)&&(c=s[0])),x.a.isEmpty(c)?(console.warn("".concat(t.pageName,"\u5f53\u524d\u9009\u62e9\u65e5\u671f").concat(n,"\u4e0b\u65e0\u73ed\u671f\u4fe1\u606f")),{}):Object.assign({date:n},c)}e.traceKMLogMessage("VPC_ProductInfo \u672a\u8bf7\u6c42\u6210\u529f\u65f6\u5c1d\u8bd5\u540c\u6b65 ".concat(t.pageName," \u9875\u73ed\u671f\u7f13\u5b58"))}},T=e;return{store:a,actions:Object.assign(Object.assign({},o),{handlers:v,refreshComponent:h,updateProps:f,updateSelectedDateParams:p,updateDisabledDate:m,updateSelectedDateProps:function(e){var n=e.selectedDate;"detail"===t.pageName&&(v.handleSyncDetailStorage(n||""),(0,o.UPDATE_DATA)({selectedDateFromProps:n||""})),"cruise_detail"===t.pageName&&(0,o.UPDATE_DATA)({selectedDateFromProps:n||""}),"presale_order_complete"===t.pageName&&(0,o.UPDATE_DATA)({selectedDateFromProps:n||""})},ctrl:T})}})),we=n(6),Ne=n.n(we),Ee=n(56),Pe=n.n(Ee),je="8.55.6".replace(/(\d+)\.(\d+)\.?(\d+)?/,(function(e,t,n,r){var a=function(e,t){return(e=e.toString()).length<t&&(e=(new Array(t).join("0")+e).substr(-t)),e};return t+(n=a(n,2))+(r?a(r,3):"000")}));function Oe(e){return"/restapi/soa2"+function(e){if("fat"!==Pe.a.env)return e;var t=e.includes("?")?"&":"?";return e+t+"subEnv=fat29"}(e)}var De=n(13),Re=n.n(De),Ae=Re.a.sendUbtByPage,Me=new f.a({platform:d.PlatformType.taro,ubtKey:"km_tour_trace_log",organizationId:"51"},Ae),Ve=function(e,t){try{Ae.ubtTrace(e,JSON.stringify(t))}catch(e){console.log("\ud83d\udc38 logTrace",e)}},Le=function(e,t){try{Ae.ubtDevTrace(e,JSON.stringify(t))}catch(e){console.log("\ud83d\udc38 logDevTrace",e)}},Be=function(e,t){try{Ae.ubtExposure(e,t,{})}catch(e){console.log("\ud83d\udc38 createExposure",e)}},Ue=function(e){try{Me.logPageInfo(e)}catch(e){console.log("\ud83d\udc38 traceKMPageLogError",e)}},Ze=function(e){try{Me.logActionInfo(e)}catch(e){console.log("\ud83d\udc38 traceKMLogAction",e)}},Fe=function(e){try{Me.logError(e)}catch(e){console.log("\ud83d\udc38 traceKMLogError",e)}},Ge=function(e){try{Me.logMessage(e)}catch(e){console.log("\ud83d\udc38 traceKMLogMessage",e)}},He=function(e,t){try{var n="";if(t.startsWith("vac_1")?n="\u7cfb\u7edf\u5f02\u5e38":t.startsWith("vac_2")?n="\u8d44\u6e90\u4e0d\u53ef\u8ba2":t.startsWith("vac_3")?n="\u7528\u6237\u8f93\u5165\u9a8c\u8bc1":t.startsWith("vac_4")&&(n="\u641c\u7d22\u65e0\u7ed3\u679c"),""===n)return;Me.logActionInfo({module:"\u963b\u65ad",scene:n,role:d.RoleType.sys,action:d.ActionType.show,value:e||"-",key:t})}catch(e){console.log("\ud83d\udc38 traceKMLogAction",e)}};function qe(e){var t;return{fetch:function(){return new Promise((function(n,r){t=Re.a.request(Object.assign(Object.assign({},e),{success:function(t){var a=t.data,o=void 0===a?{}:a,i=t.statusCode;e.url,i&&String(i).startsWith("5")&&r("\u7f51\u7edc\u5f02\u5e38: ".concat(i)),n(o)},fail:function(e){e&&"request:fail abort"===e.errMsg?r(Object.assign({name:"AbortError"},e)):r(e)}}))}))},cancel:function(){Re.a.cancel(t)}}}function Ke(e,t,n){var r,a,o={url:Oe(e),data:Object.assign(Object.assign({},t),(r=e,a=r.split("/")[1],"13826"===a?{ChannelId:117,PlatformChannelInfo:{ChannelId:117},DistributionChannelId:117,Version:je}:"20168"===a?{ChannelId:117,PlatformChannelInfo:{ChannelId:117},DistributionChannelId:117,Version:je,Channel:4}:{}))};return n&&n.headers&&(o=Object.assign(Object.assign({},o),{header:n.headers})),qe(o)}function ze(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(null==r?void 0:r.isDiy)?"27611":"18055",o=Oe("/".concat(a,"/graphql?queryName=").concat(n)),i={};r&&r.extension&&(i.extension=r.extension);var s={url:o,data:{query:e,queryName:n,variables:t,fixVariables:1,head:i},header:Object.assign({locale:"ZH-CN","x-ctx-Locale":"ZH-CN"},r.headers)};return qe(s)}function Ye(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split("/")&&e.split("/")[1];switch(t){case"10124":case"12446":case"12448":case"13592":return{ChannelCode:0,ChannelId:117,DistributionChannelId:117,PlatformId:2,Version:je,Locale:"zh-CN"};case"13966":case"13250":return{Channel:4,ChannelId:117,DistributionChannelId:117,Version:je};default:return{Channel:4,ChannelId:117,PlatformChannelInfo:{ChannelId:117},DistributionChannelId:117,ChannelCode:0,PlatformId:0,Version:je,Locale:"zh-CN"}}}function We(){var e;function t(e){try{var t=Ne.a.getStorageSync(e),n=t.value,r=t.domain,a=t.expires,o=t.timeStamp;if("tour"!==r)return null;var i=(new Date).getTime();if(a>0&&i-o>1e3*a)return null;var s=JSON.parse(n);return Le("o_vacation_get_storage_log",{storeName:e,data:s}),s}catch(t){Le("o_vacation_get_storage_error_log",e)}}return{tourContext:{Platform:"Taro",appVersion:je,set:function(e,t,n){try{if(!e.startsWith("VPC_"))return Ne.a.setStorage({key:e,data:t}),void Le("o_vacation_set_storage_log",{storeName:e,value:t});var r={value:JSON.stringify(t),domain:"tour"};n&&(r.expires=n,r.timeStamp=(new Date).getTime()),Ne.a.setStorageSync(e,r),Le("o_vacation_set_storage_log",{storeName:e,value:t})}catch(t){Le("o_vacation_set_storage_error_log",e)}},get:(e=b(y().mark((function e(){var n=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.apply(void 0,n));case 1:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)}),getSync:t,remove:function(e){try{var t={key:e,domain:"tour"};Ne.a.removeStorageSync(e),Le("o_vacation_remove_storage_log",t)}catch(t){Le("o_vacation_remove_storage_error_log",{storeName:e})}},showLoading:function(e){var t=e&&e.title?e.title:"\u52a0\u8f7d\u4e2d";Ne.a.showLoading({title:t,mask:!0})},hideLoading:function(){Ne.a.hideLoading()},showToast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;Ne.a.showToast({title:e,duration:1e3*t,icon:"none"})},attachShardParams:Ye,createRequest:Ke,createGqlRequest:ze,logTrace:Ve,logDevTrace:Le,createExposure:Be,traceKMPageLog:Ue,traceKMLogAction:Ze,traceKMLogError:Fe,traceKMLogMessage:Ge,traceKMInterruption:He}}}var $e=n(1);function Xe(e){var t=e.style,n=void 0===t?{}:t,r=e.className,a=void 0===r?"":r,o=e.disabled,i=void 0!==o&&o,s=e.onPress,c=void 0===s?function(){}:s,l=e.onPressIn,u=void 0===l?function(){}:l,d=e.onPressOut,f=void 0===d?function(){}:d,p=e.children,m=void 0===p?null:p,g=k(Object(h.useState)(!1),2),y=g[0],_=g[1],b=n instanceof Function?n({pressed:y}):n;return v.a.createElement($e.View,{className:a,style:b,onTouchStart:function(e){_(!0),!i&&u(e)},onTouchEnd:function(e){_(!1),!i&&f(e)},onClick:function(e){!i&&c(e)}},m)}var Je,Qe=n(11);function et(e){var t=e.content,n=e.copyLink,r=void 0!==n&&n;return v.a.createElement("mp-html",{content:t,copyLink:r})}!function(e){e.e92f="&#xe92f;",e.ef39="&#xef39;",e.e931="&#xe931;",e.ef89="&#xef89;",e.e016="&#xe016;",e.ed0a="&#xed0a;",e.e93e="&#xe93e;",e.e940="&#xe940;",e.ed1f="&#xed1f;",e.e944="&#xe944;"}(Je||(Je={}));var tt={FontIcon:"_1gll3kh1j",color_000:"_1gll3kh1",color_111:"_1gll3kh2",color_222:"_1gll3kh3",color_333:"_1gll3kh4",color_555:"_1gll3kh5",color_666:"_1gll3kh6",color_999:"_1gll3kh7",color_aaa:"_1gll3kh8",color_ccc:"_1gll3kh9",color_eee:"_1gll3kha",color_fff:"_1gll3khb",color_ccd6e5:"_1gll3khc",color_f70:"_1gll3khd",color_0066f6:"_1gll3khe",color_0086f6:"_1gll3khf",color_287dfa:"_1gll3khg",color_5678a8:"_1gll3khh",color_89a0c2:"_1gll3khi",color_f5190a:"_1gll3khj",fs_20:"_1gll3khk",fs_22:"_1gll3khl",fs_24:"_1gll3khm",fs_26:"_1gll3khn",fs_28:"_1gll3kho",fs_30:"_1gll3khp",fs_32:"_1gll3khq",fs_34:"_1gll3khr",fs_36:"_1gll3khs",fs_38:"_1gll3kht",fs_40:"_1gll3khu",fs_42:"_1gll3khv",fs_44:"_1gll3khw",fs_46:"_1gll3khx",fs_48:"_1gll3khy",fw_400:"_1gll3khz",fw_500:"_1gll3kh10",fw_600:"_1gll3kh11",fw_700:"_1gll3kh12",fw_800:"_1gll3kh13",lh_20:"_1gll3kh14",lh_22:"_1gll3kh15",lh_24:"_1gll3kh16",lh_26:"_1gll3kh17",lh_28:"_1gll3kh18",lh_30:"_1gll3kh19",lh_32:"_1gll3kh1a",lh_34:"_1gll3kh1b",lh_36:"_1gll3kh1c",lh_38:"_1gll3kh1d",lh_40:"_1gll3kh1e",lh_42:"_1gll3kh1f",lh_44:"_1gll3kh1g",lh_46:"_1gll3kh1h",lh_48:"_1gll3kh1i"};function nt(){var e=Ne.a.getSystemInfoSync(),t=e.screenHeight,n=e.windowHeight,r=e.windowWidth,a=e.safeArea,o=e.platform,i=a.top,s=a.bottom;return a.height,{safeAreaTop:i,safeAreaBottom:t-s,windowHeight:n,windowWidth:r,isCustomHeader:t>n,isAndroid:"android"===o}}var rt=nt().isAndroid;function at(e){var t=e.children,n=e.weight,r=void 0===n?"400":n,a=e.style,o=void 0===a?{}:a,i=e.classNames,s=void 0===i?[]:i,c=function(e,t){var n=e.color,r=void 0===n?"#333":n,a=e.size,o=void 0===a?"28":a,i=e.weight,s=void 0===i?"400":i,c=e.lineHeight,l=void 0===c?"36":c,u=e.isIcon,d=void 0!==u&&u,f=e.block,p=void 0!==f&&f,m=e.icon,h=void 0===m?"":m,v="color_".concat(r.substring(1)),g="fw_".concat(s),y="fs_".concat(o),_=Number(o)>Number(l)?"lh_".concat(o):"lh_".concat(l),b={};p&&(b=Object.assign(Object.assign({},b),{display:"block"}));var I="";return h&&t?(b=Object.assign(Object.assign({},b),{fontFamily:t}),I=Je[h]||""):d&&t&&(b=Object.assign(Object.assign({},b),{fontFamily:t})),{font_color:v,font_weight:g,font_size:y,line_height:_,text_style:b,icon_code:I}}(e,'"_1gll3kh0"'),l=c.font_color,u=c.font_size,d=c.font_weight,f=c.line_height,p=c.text_style,m=c.icon_code,h=[tt[l],tt[u],tt[f]];500===Number(r)&&rt?h.push(tt.fw_600):h.push(tt[d]),h=[].concat(Object(Qe.a)(h),Object(Qe.a)(s));var g=Object.assign(Object.assign({},o),p);return m?v.a.createElement($e.View,{className:h.join(" "),style:g},v.a.createElement(et,{content:m})):v.a.createElement($e.Text,{className:h.join(" "),style:g},t)}var ot={dot_container:"_1xzohsq1",dot:"_1xzohsq2",dot1:"_1xzohsq3",dot2:"_1xzohsq4",dot3:"_1xzohsq5"};function it(){return v.a.createElement($e.View,{className:ot.dot_container},v.a.createElement($e.View,{className:[ot.dot,ot.dot1].join(" ")}),v.a.createElement($e.View,{className:[ot.dot,ot.dot2].join(" ")}),v.a.createElement($e.View,{className:[ot.dot,ot.dot3].join(" ")}))}var st={popModFull:"_9u3jdo4",popMaskClose:"_9u3jdo5",popContentFull:"_9u3jdo6",popContent:"_9u3jdo7",modalHeaderWrapper:"_9u3jdo8",modalHeader:"_9u3jdo9",modalIcon:"_9u3jdoa",modalHeaderClose:"_9u3jdob",modalHeaderConfirm:"_9u3jdoc",modalView:"_9u3jdod",modalContent:"_9u3jdoe",modalFooter:"_9u3jdof",modalFooterBtn:"_9u3jdog",modalFooterShadow:"_9u3jdoh",modalBgAnim1:"_9u3jdoi",modalBgAnim2:"_9u3jdoj",modalSlideAnim1:"_9u3jdok",modalSlideAnim2:"_9u3jdol"},ct=function(e,t,n){var r=e.show,a=e.handleClose,o=e.handleConfirm,i=k(Object(h.useState)(!1),2),s=i[0],c=i[1],l=k(Object(h.useState)(!1),2),u=l[0],d=l[1],f=function(){u||(a?a():console.warn("\u26a0\ufe0f You may forget to send handleClose as props."))},p=function(){var e=b(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=2;break}return e.abrupt("return");case 2:if(o){e.next=5;break}return f(),e.abrupt("return");case 5:return d(!0),e.next=8,o();case 8:e.sent?(d(!1),f()):setTimeout((function(){d(!1)}),1e3);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=b(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=s&&n,!e.t0){e.next=4;break}return e.next=4,n();case 4:c(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(h.useEffect)((function(){r?(c(!0),t&&t()):m()}),[r]),{visible:s,loading:u,handleCloseMask:f,handlePressConfirm:p}},lt=function(){var e=nt(),t=e.windowHeight,n=e.safeAreaBottom,r=e.isCustomHeader?50:100;return{windowHeight:t,safeAreaBottom:n,modalPaddingTop:r,modalBoxMaxHeight:t-r-44}},ut=function(e){var t=e.top,n=void 0===t?0:t,r=e.footer,a=void 0!==r&&r,o=e.safeArea,i=void 0!==o&&o,s=lt(),c=s.windowHeight,l=s.safeAreaBottom,u=s.modalBoxMaxHeight;return a?u-=l+68:i&&(u-=l),{maxHeight:u-n,minHeight:0,windowHeight:c}},dt=function(e){var t=e.title,n=e.animatedDuration,r=void 0===n?350:n,a=e.confirmText,o=void 0===a?"\u786e\u8ba4":a,i=e.confirmLocation,s=void 0===i?"none":i,c=e.closeText,l=void 0===c?"":c,u=e.backgroundColor,d=void 0===u?"#fff":u,f=e.safeArea,p=void 0===f||f,m=e.footerShadow,g=void 0!==m&&m,y=e.zIndex,_=e.children,b=k(Object(h.useState)(""),2),I=b[0],x=b[1],T=k(Object(h.useState)(""),2),S=T[0],C=T[1],w=ct(e,(function(){x(st.modalBgAnim1),C(st.modalSlideAnim1)}),(function(){return new Promise((function(e){x(st.modalBgAnim2),C(st.modalSlideAnim2),setTimeout((function(){e(!0)}),r)}))})),N=w.visible,E=w.loading,P=w.handleCloseMask,j=w.handlePressConfirm,O="footer"===s,D=lt(),R=D.modalPaddingTop,A=D.safeAreaBottom,M={maxHeight:D.modalBoxMaxHeight};return N?v.a.createElement($e.View,{className:st.popModFull,style:y?{zIndex:y}:{},catchMove:!0},v.a.createElement(Xe,{className:[st.popMaskClose,I].join(" "),style:{animationDuration:"".concat(r/1.5,"ms")},onPress:P}),v.a.createElement($e.View,{className:[st.popContentFull,S].join(" "),style:{top:R,animationDuration:"".concat(r,"ms")}},v.a.createElement($e.View,{className:st.popContent,style:{backgroundColor:d}},v.a.createElement($e.View,{className:st.modalHeaderWrapper},l?v.a.createElement(Xe,{className:st.modalHeaderClose,style:function(e){return{opacity:e.pressed?.2:1}},onPress:P},v.a.createElement(at,{size:"30",lineHeight:"42",color:"#666"},l)):v.a.createElement(Xe,{className:st.modalIcon,style:function(e){return{opacity:e.pressed?.2:1}},onPress:P},v.a.createElement(at,{size:"34",lineHeight:"34",color:"#666",isIcon:!0},"\ue940")),v.a.createElement($e.View,{className:st.modalHeader},v.a.createElement(at,{size:"34",lineHeight:"42",weight:"500"},t)),"header"===s&&v.a.createElement(Xe,{className:st.modalHeaderConfirm,style:function(e){return{opacity:e.pressed?.2:1}},onPress:j},v.a.createElement(at,{size:"30",lineHeight:"42",color:"#0086f6"},o))),v.a.createElement($e.View,{className:st.modalView,style:M},v.a.createElement($e.View,{className:st.modalContent},_),O&&v.a.createElement($e.View,{className:st.modalFooter,style:{backgroundColor:d}},g&&O&&v.a.createElement($e.View,{className:st.modalFooterShadow}),E?v.a.createElement($e.View,{className:st.modalFooterBtn},v.a.createElement(it,null)):v.a.createElement(Xe,{className:st.modalFooterBtn,style:function(e){return{opacity:e.pressed?.2:1}},onPress:j},v.a.createElement(at,{size:"34",lineHeight:"42",weight:"500",color:"#fff"},o))),(p||O)&&v.a.createElement($e.View,{style:{position:"relative",backgroundColor:d,height:A,pointerEvents:"auto"}}))))):null},ft=v.a.memo(dt),pt={container:"qyi2yk0",scroll_container:"qyi2yk1",tip_container:"qyi2yk2",tip_text:"qyi2yk3",week_container:"qyi2yk4",week_text_black:"qyi2yk5",week_text_red:"qyi2yk6",calendar_content:"qyi2yk7",month_container:"qyi2yk8",month_text:"qyi2yk9",day_container:"qyi2yka",day_item:"qyi2ykb",day_item_selected:"qyi2ykc",day_sub_text:"qyi2ykd",day_main_text:"qyi2yke",day_tip_text_3:"qyi2ykf",day_tip_text_4:"qyi2ykg"},mt=nt(),ht=mt.windowWidth,vt=mt.safeAreaBottom,gt={"01-01":"\u5143\u65e6","02-14":"\u60c5\u4eba\u8282","05-01":"\u52b3\u52a8\u8282","06-01":"\u513f\u7ae5\u8282","09-10":"\u6559\u5e08\u8282","10-01":"\u56fd\u5e86\u8282","12-25":"\u5723\u8bde\u8282"},yt=function(e,t){var n=Math.abs(new S.a(t).diffMonth(e)),r=new S.a(e).valueOf(),a=new Date(r.getFullYear(),r.getMonth(),1),o=new Date(r.setMonth(r.getMonth()+n));console.log(n,a,o);for(var i=[];o.getTime()-a.getTime()>=0;)i.push({year:a.getFullYear(),month:a.getMonth()+1}),a.setMonth(a.getMonth()+1);return i},_t=function(e){var t={workDay:{},restDay:{},holiday:{}};return JSON.parse(e.configContent).Holiday.forEach((function(e){var n=e.Year;e.HolidayList.forEach((function(e){var r=e.HolidayDay,a=e.HolidayCount,o=e.StartDay,i=e.EndDay,s=e.HolidayName,c=e.WorkDay;r&&(t.holiday["".concat(n,"-").concat(r.slice(0,2),"-").concat(r.slice(-2))]=s),c&&c.split(",").forEach((function(e){t.workDay["".concat(n,"-").concat(e.slice(0,2),"-").concat(e.slice(-2))]="\u73ed"}));for(var l=new Date("".concat(n,"/").concat(o.slice(0,2),"/").concat(o.slice(-2))),u=new Date("".concat(n,"/").concat(i.slice(0,2),"/").concat(i.slice(-2)));l.valueOf()<=u.valueOf()&&a;){var d=("0"+(l.getMonth()+1)).slice(-2),f=("0"+l.getDate()).slice(-2);t.restDay["".concat(n,"-").concat(d,"-").concat(f)]="\u4f11",l=new Date(l.setDate(l.getDate()+1))}}))})),t},bt=function(){var e=b(y().mark((function e(){var t,n,r,a;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(we.request)({url:"https://m.ctrip.com/restapi/soa2/12378/json/getGeneralConfigData?key=Holiday",method:"GET"});case 3:return t=e.sent,n=t.data,r=n.rspJsonStr,a=JSON.parse(r),e.abrupt("return",_t(a.configList[0]));case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),It=function(e){var t=e.selectedDate,n=void 0===t?"":t,r=e.configuration,a=r.isUnChangeSelectedState,o=r.isUnSelectedClose,i=r.anchorDate;(a||o)&&i&&(n=i),console.log("getScrollViewID",n);var s=new S.a(n).valueOf();return"calendar-"+s.getFullYear()+"-"+(s.getMonth()+1)},xt=function(e){var t=e.startDate,n=void 0===t?"2023-01-21":t,r=e.endDate,a=void 0===r?"2023-05-15":r,o=(e.currentDate,e.selectedDate),i=void 0===o?"":o,s=e.dayConfig,c=void 0===s?{}:s,l=e.configuration,u=e.onSelectDate,d=e.safeArea,f=void 0!==d&&d,p=e.handleClose,m=e.ctrl,g=(l.title,l.tipsMessage),_=l.showToday,I=l.showTomorrow,x=l.showFestival,T=void 0===x||x,C=l.isUnChangeSelectedState,w=l.isUnSelectedClose,N=l.toastMessage,E=k(Object(h.useState)({}),2),P=E[0],j=E[1];Object(h.useEffect)((function(){function e(){return(e=b(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,bt();case 2:t=e.sent,j(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var O=function(e,t){for(var r=e.year,o=e.month,s=new Date(n.replace(/-/g,"/")).getTime(),l=new Date(a.replace(/-/g,"/")).getTime(),u=new Date(r,o-1,1).getDay(),d=[],f=0;f<u;f++)d.push({day:""});for(var p=new Date(r,o,0).getDate(),m=("00"+o).substr(-2),h=1;h<=p;h++){var v="".concat(r,"-").concat(m,"-").concat(("00"+h).substr(-2)),g=new Date(v.replace(/-/g,"/")),y=t[v]||h,_=c[v]||{},b="",I="#111",x="";T&&(P&&Object.keys(P).length>1?P.holiday[v]&&P.restDay[v]?(b=P.holiday[v],I="#f5190a"):P.holiday[v]?b=P.holiday[v]:P.workDay[v]?(b="\u73ed",I="#111"):P.restDay[v]&&(b="\u4f11",I="#f5190a"):(b=gt["".concat(m,"-").concat(("00"+h).substr(-2))],I="#111")),v===i&&(x+=" anchorDate");var k=!1;(_.disable||g<s||g>l)&&(k=!0);var S={date:v,day:y,supStr:b,supStrColor:I,disable:k,option:_,className:x};d.push(S)}return d},D=(ht-6-6)/7,R={width:D,minHeight:D},A=function(){var e=yt(n,a),t={};if(_){var r=(new S.a).format("YYYY-MM-DD");t[r]="\u4eca\u5929"}if(I){var o=(new S.a).addDay(1).format("YYYY-MM-DD");t[o]="\u660e\u5929"}return e.map((function(e){var n=e.year,r=e.month,a=O({year:n,month:r},t);return{year:n,month:r,showMonth:"".concat(n,"\u5e74").concat(r,"\u6708"),dayLists:a}}))}(),M=function(e){u&&u({selectDate:e})},V=ut({top:59,footer:!1,safeArea:!1});return v.a.createElement($e.View,{className:pt.container},!!g&&v.a.createElement($e.View,{className:pt.tip_container},v.a.createElement($e.Text,{className:pt.tip_text},g)),v.a.createElement($e.View,{className:pt.week_container},v.a.createElement($e.Text,{className:pt.week_text_red},"\u65e5"),v.a.createElement($e.Text,{className:pt.week_text_black},"\u4e00"),v.a.createElement($e.Text,{className:pt.week_text_black},"\u4e8c"),v.a.createElement($e.Text,{className:pt.week_text_black},"\u4e09"),v.a.createElement($e.Text,{className:pt.week_text_black},"\u56db"),v.a.createElement($e.Text,{className:pt.week_text_black},"\u4e94"),v.a.createElement($e.Text,{className:pt.week_text_red},"\u516d")),v.a.createElement($e.ScrollView,{scrollY:!0,scrollWithAnimation:!0,scrollIntoView:It(e),className:pt.scroll_container,style:V},v.a.createElement($e.View,{className:pt.calendar_content},A.map((function(e){var t=e.year,n=e.month,r=e.showMonth,a=e.dayLists;return v.a.createElement(v.a.Fragment,null,v.a.createElement($e.View,{className:pt.month_container,id:"calendar-"+t+"-"+n},v.a.createElement($e.Text,{className:pt.month_text},r)),v.a.createElement($e.View,{className:pt.day_container},a.map((function(e,t){var n=e.date,r=e.day,a=e.disable,o=e.supStr,s=e.supStrColor,c=e.option,l=void 0===c?{}:c,u="#111",d="#f5190a";return a?(s="#ccc",u="#ccc",d="#ccc"):(1===(null==l?void 0:l.titleColorType)?u="#ff7700":2===(null==l?void 0:l.titleColorType)?u="#f5190a":3===(null==l?void 0:l.titleColorType)&&(u="#00b87a"),1===(null==l?void 0:l.subTitleColorType)?d="#00b87a":(2===(null==l?void 0:l.subTitleColorType)||3===(null==l?void 0:l.subTitleColorType))&&(d="#0086f6"),1===l.dayDefaultColorType&&(s="#ccc",u="#ccc")),n===i?v.a.createElement($e.View,{key:t,className:[pt.day_item,pt.day_item_selected].join(" "),style:R,onClick:function(){C||w?N&&m.showToast(N,1):!a&&n&&(null==p||p(),M(n))}},v.a.createElement($e.Text,{className:pt.day_sub_text,style:{color:"#fff"}},o||""),v.a.createElement($e.Text,{className:pt.day_main_text,style:{color:"#fff"}},r),v.a.createElement($e.Text,{className:pt.day_tip_text_3,style:{color:"#fff"}},l.title),v.a.createElement($e.Text,{className:pt.day_tip_text_4,style:{color:"#fff"}},l.subTitle)):v.a.createElement($e.View,{key:t,className:pt.day_item,style:R,onClick:function(){C||w?N&&m.showToast(N,1):!a&&n&&(null==p||p(),M(n))}},v.a.createElement($e.Text,{className:pt.day_sub_text,style:{color:s}},o||""),v.a.createElement($e.Text,{className:pt.day_main_text,style:{color:s}},r),v.a.createElement($e.Text,{className:pt.day_tip_text_3,style:{color:u}},l.title),v.a.createElement($e.Text,{className:pt.day_tip_text_4,style:{color:d}},l.subTitle))}))))})),f&&v.a.createElement($e.View,{style:{height:vt,flexShrink:0}}))))},Tt=function(e){var t,n=Ce.useState((function(e){return{isInitReady:e.isInitReady,isShowSelectDate:e.isShowSelectDate}})),r=n.isInitReady,a=n.isShowSelectDate,o=Ce.useActions(),i=o.refreshComponent,s=o.handlers,c=o.ctrl,l=o.updateSelectedDateProps,u=o.updateProps,d=s.handleSelectDate,f=e.isShow,p=e.onRef,m=e.onClose,g=e.selectedDate,_=wt(),I=(null===(t=null==_?void 0:_.configuration)||void 0===t?void 0:t.title)||"";return Object(h.useMemo)((function(){u({isShow:f})}),[f]),Object(h.useMemo)((function(){r&&l({selectedDate:g})}),[g,r]),Object(h.useMemo)((function(){p&&p({initCalendar:function(e){return b(y().mark((function t(){var n;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i(e);case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})))()},handleSyncSelectDateStorage:function(e){return b(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l({selectedDate:e});case 1:case"end":return t.stop()}}),t)})))()}})}),[]),v.a.createElement(ft,{title:I,show:a&&r,handleClose:m,safeArea:!1},v.a.createElement(xt,Object.assign({},_,{ctrl:c,onSelectDate:d,safeArea:!0})))},kt=function(e){var t,n=Ce.useState((function(e){return{isInitReady:e.isInitReady,isShowSelectDate:e.isShowSelectDate}})),r=n.isInitReady,a=n.isShowSelectDate,o=Ce.useActions(),i=o.refreshComponent,s=o.updateProps,c=o.ctrl,l=e.isShow,u=e.onRef,d=e.onClose,f=wt(),p=(null===(t=null==f?void 0:f.configuration)||void 0===t?void 0:t.title)||"";return Object(h.useMemo)((function(){s({isShow:l})}),[l]),Object(h.useMemo)((function(){u&&u({initCalendar:function(e){return b(y().mark((function t(){var n;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i(e);case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})))()}})}),[]),v.a.createElement(ft,{title:p,show:a&&r,handleClose:d,safeArea:!1},v.a.createElement(xt,Object.assign({},f,{ctrl:c,safeArea:!0})))},St=function(e){var t,n=Ce.useState((function(e){return{isInitReady:e.isInitReady,isShowSelectDate:e.isShowSelectDate}})),r=n.isInitReady,a=n.isShowSelectDate,o=Ce.useActions(),i=o.refreshComponent,s=o.updateProps,c=o.handlers,l=o.ctrl,u=c.handleSelectDate,d=e.isShow,f=e.onRef,p=e.onClose,m=wt(),g=(null===(t=null==m?void 0:m.configuration)||void 0===t?void 0:t.title)||"";return Object(h.useMemo)((function(){s({isShow:d})}),[d]),Object(h.useMemo)((function(){f&&f({initCalendar:function(e){return b(y().mark((function t(){var n;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i(e);case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})))()},handleSelectDate:function(e){return b(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:u(e);case 1:case"end":return t.stop()}}),t)})))()}})}),[]),v.a.createElement(ft,{title:g,show:a&&r,handleClose:p,safeArea:!1},v.a.createElement(xt,Object.assign({},m,{ctrl:l,onSelectDate:u,handleClose:p,safeArea:!0})))},Ct=function(e){var t,n=Ce.useState((function(e){return{isInitReady:e.isInitReady,isShowSelectDate:e.isShowSelectDate}})),r=n.isInitReady,a=n.isShowSelectDate,o=Ce.useActions(),i=o.refreshComponent,s=o.updateProps,c=o.updateSelectedDateProps,l=o.handlers,u=o.ctrl,d=l.handleSelectDate,f=e.isShow,p=e.onRef,m=e.onClose,g=e.selectedDate,_=wt(),I=(null===(t=null==_?void 0:_.configuration)||void 0===t?void 0:t.title)||"";return Object(h.useMemo)((function(){s({isShow:f})}),[f]),Object(h.useMemo)((function(){r&&c({selectedDate:g})}),[r,g]),Object(h.useMemo)((function(){p&&p({initCalendar:function(e){return b(y().mark((function t(){var n;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i(e);case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})))()},handleSelectDate:function(e){return b(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:d(e);case 1:case"end":return t.stop()}}),t)})))()}})}),[]),v.a.createElement(ft,{title:I,show:a&&r,handleClose:m,safeArea:!1},v.a.createElement(xt,Object.assign({},_,{ctrl:u,onSelectDate:d,handleClose:m,safeArea:!0})))},wt=function(){var e=Ce.useState((function(e){return{priceCalendarParams:e.priceCalendarParams}})).priceCalendarParams;if(x.a.isEmpty(e))return null;var t=x.a.cloneDeep(e),n=e.startDate,r=e.endDate,a=e.selectedDate,o=e.configuration,i=o.isUnChangeSelectedState,s=o.isUnSelectedClose,c=o.anchorDate;t.startDate=Nt(n),t.endDate=Nt(r),t.selectedDate=Nt(a),t.currentDate=Nt(a),(i||s)&&c&&(t.configuration.anchorDate=Nt(c));var l={};return Object.keys(e.dayConfig).map((function(t){l[Nt(t)]=e.dayConfig[t]})),t.dayConfig=l,t},Nt=function(e){return e?e.substr(0,4)+"-"+e.substr(4,2)+"-"+e.substr(6,2):""},Et=function(e){return"detail"===e.pageName?v.a.createElement(Tt,Object.assign({},e)):"presale_detail"===e.pageName||"presale_order"===e.pageName?v.a.createElement(kt,Object.assign({},e)):"presale_order_complete"===e.pageName?v.a.createElement(Ct,Object.assign({},e)):"resource"===e.pageName||"order"===e.pageName?v.a.createElement(St,Object.assign({},e)):void 0},Pt=v.a.memo(jt);function jt(e){return v.a.createElement(Ot,Object.assign({},e),v.a.createElement(Et,Object.assign({},e)))}function Ot(e){var t=v.a.useMemo((function(){var t=[I.PlatformContext.create({}),I.TourContext.create(Object.assign(Object.assign({},We().tourContext),{props:e,pageName:e.pageName,Platform:"Taro"}))];return r.mergeModelContext.apply(void 0,t)}),[]);return v.a.createElement(Ce.Provider,{context:t},e.children)}var Dt={INIT_DRAFT:function(e,t){return Object.assign({internalInited:!0},t)},UPDATE_DRAFT:function(e,t){var n=e.tempCount;return Object.assign(Object.assign({},e),{tempCount:Object.assign(Object.assign({},n),t),errorInfo:null})},DISCARD_DRAFT:function(e){var t=e.initCount;return Object.assign(Object.assign({},e),{tempCount:t,errorInfo:null})},SAVE_DRAFT:function(e){var t=e.tempCount;return Object.assign(Object.assign({},e),{initCount:t,errorInfo:null,internalDiasbleMaskClose:!1})},UPDATE_ERRORINFO:function(e,t){return Object.assign(Object.assign({},e),{errorInfo:t})},INTERNAL_SHOW:function(e,t){return Object.assign(Object.assign({},e),{internalShow:t})},DISABLE_ACTION:function(e,t){return Object.assign(Object.assign({},e),{internalDisableAction:t})},DISABLE_SCROLL:function(e,t){return Object.assign(Object.assign({},e),{internalDisableScroll:t})},UPDATE_FEEINCLUDE_TYPE:function(e,t){return Object.assign(Object.assign({},e),{feeIncludeType:t})}},Rt={internalShow:!1,internalInited:!1,internalDisableAction:!1,internalDisableScroll:!1},At=Object(a.createReactModel)((function(){var e=Object(I.setupTourContext)(),t=e.props,n=Object(r.setupStore)({name:"isomorphic_select_passenger_components",initialState:Rt,reducers:Dt,logger:K.b&&!K.d&&!!t.logger}),a=n.store,o=n.actions,i=me(e),s=X(e),c=s.getProductInfo,l=s.fetchProductInfo,u=pe(e),f=null,p=null,m=function(){var n=b(y().mark((function n(){var r,o;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,h();case 2:if(f=n.sent){n.next=6;break}throw console.error("\u9009\u62e9\u4eba\u6570\u7ec4\u4ef6: \u7f3a\u5c11productInfo"),new Error("\u7f3a\u5c11productInfo");case 6:if("presale_order"!==t.pageName){n.next=11;break}p={date:"2099-01-01",displayPrice:-1,inventory:t.inventory},T(t.passengerInfo),n.next=19;break;case 11:return n.next=13,e.get(C.b.VPC_DATE_INFO);case 13:if(p=n.sent){n.next=17;break}throw console.error("\u9009\u62e9\u4eba\u6570\u7ec4\u4ef6: \u7f3a\u5c11\u73ed\u671f"),new Error("\u7f3a\u5c11\u73ed\u671f");case 17:v(),"function"==typeof t.onInit&&(r=a.getState(),o=r.tempCount,t.onInit(o));case 19:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();Object(r.setupPreloadCallback)(m);var h=function(){var e=b(y().mark((function e(){var n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.next=3,c(t.cacheKey);case 3:if(!(n=e.sent)){e.next=6;break}return e.abrupt("return",n);case 6:return e.prev=6,r=J(t.cacheKey),e.next=10,l(r);case 10:return n=e.sent,e.abrupt("return",n);case 14:return e.prev=14,e.t0=e.catch(6),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(){return e.apply(this,arguments)}}(),v=function(){if(!a.getState().internalInited){var t=o.INIT_DRAFT,n=te(f,p),r=u.getPassengerInfo(),i=null,s=null,c=!1;if("RN"===e.Platform){var l=function(e,t){var n=e.adultCanBook,r=e.childCanBook,a=e.infantCanBook,o=e.childAgeRequired,i=e.childMinAge,s=e.childMaxAge,c=ue(e,t),l=c.result,u=c.initCount;if(l&&2===l.scene)return l.reason+="\uff0c\u5df2\u4e3a\u60a8\u8c03\u6574\u4eba\u6570",{initCount:u,errorInfo:l};if(l&&1===l.scene)return"vac_30120"!==l.vac_code&&(l.reason=""),{initCount:u,errorInfo:l};if(l&&3===l.scene){var d={adultCount:0,childCount:0,infantCount:0,childAges:[]};return n&&(d.adultCount=(null==t?void 0:t.adultCount)||0),r&&(d.childCount=(null==t?void 0:t.childCount)||0),a&&(d.infantCount=(null==t?void 0:t.infantCount)||0),o&&(null==t?void 0:t.childAges)&&t.childAges.forEach((function(e){e>=i&&e<s&&d.childAges.push(e)})),"vac_30121"!==l.vac_code&&(l.reason=""),{initCount:d,errorInfo:l}}return l&&5===l.scene?{autoShow:!0,initCount:t,errorInfo:l}:{initCount:u,errorInfo:l}}(n,r);i=l.errorInfo,s=l.initCount,c=i&&3===i.scene}else{var m=de(n,r);i=m.errorInfo,s=m.initCount}var h=!1;e.getSync(C.b.VPC_HAS_AUTO_SHOW)?(h=!1,i=null):i&&(h=!0,e.set(C.b.VPC_HAS_AUTO_SHOW,!0)),i&&i.scene&&e.logTrace("grp_resource_psgnum_show",{scene:i.scene}),e.traceKMLogAction({attrs:[{key:"productId",value:String(n.line)}],module:"\u9009\u62e9\u4eba\u6570\u7ec4\u4ef6",scene:"\u521d\u59cb\u5316\u5b8c\u6210",role:d.RoleType.sys,action:d.ActionType.show,contents:[{key:"\u72b6\u6001",value:h?"\u6253\u5f00":"\u5173\u95ed"},{key:"\u521d\u59cb\u4eba\u6570",value:le(s)},{key:"\u539f\u56e0",value:h?i.reason:""}]}),t({internalShow:h,initCount:c?{adultCount:0,childCount:0,infantCount:0,childAges:[]}:s,tempCount:s,errorInfo:i,productProperty:n,internalDiasbleMaskClose:c})}},g=function(){var t=a.getState(),n=t.tempCount,r=t.productProperty,i=o.UPDATE_ERRORINFO,s=re(r,n),c=ce(r,n);return c&&(s=c),s&&e.traceKMLogAction({attrs:[{key:"productId",value:String(r.line)}],module:"\u9009\u62e9\u4eba\u6570\u7ec4\u4ef6",scene:"\u68c0\u67e5\u4eba\u6570\u4e0d\u901a\u8fc7",role:d.RoleType.sys,action:d.ActionType.show,value:s.reason+s.show}),s&&s.vac_code&&e.traceKMInterruption(s.vac_desc,s.vac_code),i(s),null===s},_=function(){var n=b(y().mark((function n(){var r,s,c,l,d,f,p,m,h,v;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=a.getState(),s=r.tempCount,c=r.initCount,l=r.productProperty,d=l.childMinAge,f=l.childMaxAge,p=o.SAVE_DRAFT,m=o.DISABLE_ACTION,g()){n.next=6;break}return n.abrupt("return",!1);case 6:if(s.adultCount===c.adultCount&&s.childCount===c.childCount&&s.infantCount===c.infantCount&&s.childAges.toString()===c.childAges.toString()){n.next=25;break}if(e.logTrace("grp_resource_psgnum_edit"),p(),u.setPassengerInfo(s,[d,f]),h=J(t.cacheKey),m(!0),"presale_order"!==t.pageName){n.next=18;break}return n.next=15,i(Object.assign(Object.assign({pageName:t.pageName},h),{inventory:t.inventory}));case 15:v=n.sent,n.next=21;break;case 18:return n.next=20,i(Object.assign({pageName:t.pageName},h));case 20:v=n.sent;case 21:return m(!1),t.onSubmit(v),x(),n.abrupt("return",!0);case 25:return p(),u.setPassengerInfo(s,[d,f]),n.abrupt("return",!0);case 28:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),x=function(){if("presale_order"!==t.pageName){var n=a.getState(),r=n.productProperty,o=n.initCount,i=r.productType,s=r.adultCanBook,c=r.childCanBook,l=r.infantCanBook,u=s?o.adultCount:null,d=c?o.childCount:null,f=l&&"sdp"===i?o.infantCount:null;"RN"===e.Platform&&e.logTrace("grp_resource_psgnumselect_confirm_click",{psgtype:fe({adultCanBook:s,childCanBook:c,infantCanBook:l}),adultcount:u,childCount:d,infantCount:f}),t.onUpdate&&t.onUpdate({adultCount:u,childCount:d,infantCount:f})}},T=function(t){if(!a.getState().internalInited){var n=o.INIT_DRAFT,r=te(f,p||{}),i=t||u.getPassengerInfo(),s=de(r,i),c=(s.errorInfo,s.initCount);e.traceKMLogAction({attrs:[{key:"productId",value:String(r.line)}],module:"\u9009\u62e9\u4eba\u6570\u7ec4\u4ef6",scene:"\u521d\u59cb\u5316\u5b8c\u6210",role:d.RoleType.sys,action:d.ActionType.show,contents:[{key:"\u521d\u59cb\u4eba\u6570",value:le(c)}]}),n({initCount:c,tempCount:c,errorInfo:null,productProperty:r}),x()}};return{store:a,actions:Object.assign(Object.assign({},o),{handleInitDraft:v,handleUpdateAdultCount:function(t){var n=a.getState(),r=n.productProperty,i=n.tempCount,s=o.UPDATE_DRAFT;e.traceKMLogAction({attrs:[{key:"productId",value:String(r.line)}],module:"\u9009\u62e9\u4eba\u6570\u7ec4\u4ef6",scene:"\u66f4\u65b0\u6210\u4eba\u6570",role:d.RoleType.usr,action:d.ActionType.change,value:String(t),before:String(i.adultCount)}),s({adultCount:t}),"RN"===e.Platform&&e.logTrace("grp_resource_psgnumselect_modify_click",{type:"\u6210\u4eba"})},handleUpdateChildCount:function(t){var n=a.getState(),r=n.tempCount,i=n.productProperty,s=i.childAgeRequired,c=r.childCount,l=r.childAges,u=o.UPDATE_DRAFT;e.traceKMLogAction({attrs:[{key:"productId",value:String(i.line)}],module:"\u9009\u62e9\u4eba\u6570\u7ec4\u4ef6",scene:"\u66f4\u65b0\u513f\u7ae5\u6570",role:d.RoleType.usr,action:d.ActionType.change,value:String(t),before:String(r.childCount)}),u(s?c>t?{childCount:t,childAges:l.slice(0,-1)}:{childCount:t,childAges:[].concat(Object(Qe.a)(l),[0])}:{childCount:t}),"RN"===e.Platform&&e.logTrace("grp_resource_psgnumselect_modify_click",{type:"\u513f\u7ae5"})},handleUpdateChildAge:function(t){var n=a.getState(),r=n.productProperty,i=n.tempCount,s=o.UPDATE_DRAFT;e.traceKMLogAction({attrs:[{key:"productId",value:String(r.line)}],module:"\u9009\u62e9\u4eba\u6570\u7ec4\u4ef6",scene:"\u66f4\u65b0\u513f\u7ae5\u5e74\u9f84",role:d.RoleType.usr,action:d.ActionType.change,value:String(t),before:String(i.childAges)}),s({childAges:t})},handleUpdateInfantCount:function(t){var n=a.getState(),r=n.productProperty,i=n.tempCount,s=o.UPDATE_DRAFT;e.traceKMLogAction({attrs:[{key:"productId",value:String(r.line)}],module:"\u9009\u62e9\u4eba\u6570\u7ec4\u4ef6",scene:"\u66f4\u65b0\u5a74\u513f\u6570",role:d.RoleType.usr,action:d.ActionType.change,value:String(t),before:String(i.infantCount)}),s({infantCount:t}),"RN"===e.Platform&&e.logTrace("grp_resource_psgnumselect_modify_click",{type:"\u5a74\u513f"})},handleDiscardDraft:function(){(0,o.DISCARD_DRAFT)()},handleSubmitDraft:_,handleSyncExternalShow:function(e){var t=a.getState().internalShow,n=o.INTERNAL_SHOW;t!==e&&n(e)},handleEnableScroll:function(e){(0,o.DISABLE_SCROLL)(!e)},handleClickTip:function(t){(0,o.UPDATE_FEEINCLUDE_TYPE)(t),e.traceKMLogMessage("\u6253\u5f00\u8d39\u7528\u5305\u542b\u7ec4\u4ef6")},handleClearTip:function(){(0,o.UPDATE_FEEINCLUDE_TYPE)(""),e.traceKMLogMessage("\u5173\u95ed\u8d39\u7528\u5305\u542b\u7ec4\u4ef6")},handleInitDraft_PreSale:T})}})),Mt={countContainer:"_1li4j60",countBtnPressable:"_1li4j61",pr35:"_1li4j62",pl35:"_1li4j63",countText:"_1li4j64"},Vt=function(e){var t=function(e){var t=e.min,n=e.max,r=e.value,a=e.step,o=e.throttleWait,i=void 0===o?200:o,s=e.onChange,c=e.disabled,l=void 0!==c&&c,u=r+a<=n,d=r-a>=t,f=Object(h.useRef)();return{isDecreaseActive:!l&&d,isIncreaseActive:!l&&u,handleDecrease:function(){if(d&&!f.current){var e=r-a;s(e),i>0&&(f.current=setTimeout((function(){return f.current=void 0}),i)),e===t&&(f.current=void 0)}},handleIncrease:function(){if(u&&!f.current){var e=r+a;s(e),i>0&&(f.current=setTimeout((function(){return f.current=void 0}),i)),e===n&&(f.current=void 0)}}}}(e),n=t.isDecreaseActive,r=t.isIncreaseActive,a=t.handleDecrease,o=t.handleIncrease,i=n?"#0086f6":"#ddd",s=r?"#0086f6":"#ddd";return v.a.createElement($e.View,{className:Mt.countContainer},v.a.createElement(Xe,{className:[Mt.countBtnPressable,Mt.pl35].join(" "),style:function(e){return{opacity:e.pressed?.2:1}},disabled:!n,onPress:a},v.a.createElement(at,{size:"44",lineHeight:"44",isIcon:!0,style:{color:i}},"\ued0a")),v.a.createElement($e.Text,{className:Mt.countText},e.value),v.a.createElement(Xe,{className:[Mt.countBtnPressable,Mt.pr35].join(" "),style:function(e){return{opacity:e.pressed?.2:1}},disabled:!r,onPress:o},v.a.createElement(at,{size:"44",lineHeight:"44",isIcon:!0,style:{color:s}},"\ue93e")))},Lt=v.a.memo(Vt),Bt="_1e8qlgh0",Ut="_1e8qlgh1",Zt="_1e8qlgh2",Ft="_1e8qlgh3",Gt="_1e8qlgh4",Ht="_1e8qlgh5",qt="_1e8qlgh6",Kt=function(e){var t=e.value,n=e.valueFormatter;return v.a.createElement($e.View,{className:Ft},!Number.isNaN(t)&&v.a.createElement($e.View,{className:Ht},v.a.createElement(at,{size:"24",lineHeight:"32",color:"#fff"},n(t)),v.a.createElement($e.View,{className:qt})),v.a.createElement(Xe,{className:Gt,style:function(e){return{opacity:e.pressed?.8:1}}}))},zt=function(e){var t=e.id,n=e.min,r=e.max,a=e.value,o=e.width,i=e.startX,s=void 0===i?0:i,c=e.valueFormatter,l=void 0===c?function(e){return e+""}:c,u=e.onChangeStart,d=e.onChangeEnd,f=e.disabled,p=void 0!==f&&f,m=k(Object(h.useState)(0),2),g=m[0],y=m[1],_=Object(h.useRef)(g),b=Object(h.useRef)(o),I=Object(h.useRef)(NaN);Object(h.useMemo)((function(){a>=n&&a<=r&&o>0?(b.current=o,I.current=a,_.current=(a-n)/(r-n)*o,y((a-n)/(r-n)*o)):(b.current=o,I.current=NaN,_.current=0,y(0))}),[a,n,r,o]);var x=g;return Number.isNaN(I.current)||I.current===n?x=0:I.current===r?x-=24:x-=12,v.a.createElement($e.View,{style:{position:"relative"}},v.a.createElement(Xe,{className:Bt,onPressIn:function(e){if(e.touches&&0!==e.touches.length){var a=e.touches[0].pageX-s-_.current,i=(_.current+a)/o*(r-n)+n;i>=n&&i<=r&&d(Math.round(i),t)}}},v.a.createElement($e.View,{className:Ut}),v.a.createElement($e.View,{className:Zt,style:{width:g}})),p?v.a.createElement($e.View,{style:{position:"relative",left:x}},v.a.createElement(Kt,{value:I.current,valueFormatter:l})):v.a.createElement($e.View,{style:{position:"relative",left:x},onTouchStart:function(e){u()},onTouchMove:function(e){if(e.touches&&0!==e.touches.length){var t=e.touches[0].pageX-s-_.current,a=_.current+t;if(a>0&&a<b.current){y(a);var o=a/b.current*(r-n)+n;I.current=Math.round(o)}}},onTouchEnd:function(){I.current>=n&&I.current<=r&&d(I.current,t)}},v.a.createElement(Kt,{value:I.current,valueFormatter:l})))},Yt=v.a.memo(zt),Wt={UPDATE_FEEINFO:function(e,t){return Object.assign(Object.assign({},t),{internalInited:!0})}},$t=function(e){return e?e.replace(/<[\/]?[^<>]+>/g,(function(e){var t=(null==e?void 0:e.toLowerCase())||"";return 0===t.indexOf("<a>")||0===t.indexOf("<a ")||0===t.indexOf("</a>")?e:""})):""},Xt={internalInited:!1},Jt=Object(a.createReactModel)((function(){var e=Object(I.setupTourContext)(),t=e.props,n=Object(r.setupStore)({name:"isomorphic_fee_include_components",initialState:Xt,reducers:Wt,logger:K.b&&!K.d&&!!t.logger}),a=n.store,o=n.actions,i=X(e),s=i.getProductInfo,c=i.fetchProductInfo;Object(r.setupPreloadCallback)(b(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:if(t=e.sent){e.next=6;break}return console.error("\u8d39\u7528\u5305\u542b\u7ec4\u4ef6: \u7f3a\u5c11productInfo"),e.abrupt("return");case 6:u(t);case 7:case"end":return e.stop()}}),e)}))));var l=function(){var e=b(y().mark((function e(){var n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.next=3,s(t.cacheKey);case 3:if(!(n=e.sent)){e.next=6;break}return e.abrupt("return",n);case 6:return e.prev=6,r=J(t.cacheKey),e.next=10,c(r);case 10:return n=e.sent,e.abrupt("return",n);case 14:return e.prev=14,e.t0=e.catch(6),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(){return e.apply(this,arguments)}}(),u=function(e){(0,o.UPDATE_FEEINFO)(function(e){var t=e.BasicInfo,n=e.BasicExtendInfo.PriceStandardList,r=e.FeeInfoList,a=r&&r.find((function(e){return"15"===e.SubTitleCode})),o=a&&a.ProductClauseList,i=[],s=!1,c="",l="";n.forEach((function(e){var t=e.PassengerType,n=e.IsCanBook,r=e.MinHeight,a=e.MaxHeight,o=e.MinAge,u=e.MaxAge,d=e.Title;s=Boolean(2===t&&n&&(r||a)&&(o||u)),i.push({Type:t,IsCanBook:n}),1===t&&(c="\u6210\u4eba\u3010".concat(d,"\u3011")),2===t&&(l="\u513f\u7ae5\u3010".concat(d,"\u3011"))})),i=i.sort((function(e,n){return t.isStudy?n.Type-e.Type:e.Type-n.Type}));var u=t.isStudy?"\u4e3a\u6210\u4eba\u4e0e\u513f\u7ae5\u6709\u5dee\u5f02\u7684\u9879\u76ee\uff0c\u8bf7\u7279\u522b\u7559\u610f":"\u4e3a\u513f\u7ae5\u4e0e\u6210\u4eba\u6709\u5dee\u5f02\u7684\u9879\u76ee\uff0c\u8bf7\u7279\u522b\u7559\u610f";return{feeInclude:o,isShowChildHeightTip:s,displayPriceStandardList:i,childDiffTip:u,childHeightTip:s?"\u6ee1\u8db3\u5e74\u9f84\u6761\u4ef6\u7684\u513f\u7ae5\u8eab\u9ad8\u4e0d\u7b26\u65f6\uff0c\u8bf7\u6309\u513f\u7ae5\u4e0b\u5355\uff0c\u53ef\u80fd\u4f1a\u6d89\u53ca\u73b0\u573a\u8865\u5dee\u4ef7\uff0c\u7531\u670d\u52a1\u4eba\u5458\u73b0\u573a\u534f\u52a9\u5904\u7406\uff0c\u5177\u4f53\u5dee\u4ef7\u91d1\u989d\u4ee5\u73b0\u573a\u62a5\u4ef7\u4e3a\u51c6\u3002":"",adultTitle:c,childTitle:l}}(e))};return{store:a,actions:Object.assign(Object.assign({},o),{handleJumpH5:function(t){try{e.jumpH5(t)}catch(e){console.warn(e)}}})}})),Qt="_13i19r30",en="_13i19r31",tn="_13i19r32",nn="_13i19r33",rn="_13i19r34",an="uuqg5z0",on="uuqg5z1",sn="uuqg5z2",cn="uuqg5z3",ln="uuqg5z4",un="uuqg5z5",dn="uuqg5z6",fn="uuqg5z7",pn=nt().safeAreaBottom,mn={1:"\u6210\u4eba",2:"\u513f\u7ae5",adult:1,child:2},hn=function(e){var t=e.isShow,n=e.type,r=void 0===n?"adult":n,a=e.onClose,o=e.zIndex,i=k(Object(h.useState)(mn[r]),2),s=i[0],c=i[1];Object(h.useMemo)((function(){"adult"!==r&&"child"!==r||c(mn[r])}),[r]);var l=Jt.useState(),u=l.internalInited,d=l.feeInclude,f=l.displayPriceStandardList,p=l.childDiffTip,m=l.childHeightTip,g=l.adultTitle,y=l.childTitle;if(!u||Object(K.c)(d))return null;var _=2===s,b="";1===s?b=g:2===s&&(b=y);var I=ut({top:32,footer:!1,safeArea:!1});return v.a.createElement(ft,{title:"\u8d39\u7528\u5305\u542b",show:t,handleClose:a,safeArea:!1,zIndex:o},v.a.createElement($e.View,{className:en},f.map((function(e,t){var n=e.Type,r=e.IsCanBook;if(!mn[n])return null;if(!r)return v.a.createElement($e.View,{className:tn},v.a.createElement(at,{lineHeight:"40",weight:"500",color:"#ccc"},mn[n]+"\u4e0d\u53ef\u8ba2"));var a=n===s;return v.a.createElement(Xe,{key:t,className:tn,onPress:function(){return c(n)}},v.a.createElement(at,{lineHeight:"40",weight:"500",color:a?"#0086f6":"#333"},mn[n]),a&&v.a.createElement($e.View,{className:nn}))}))),v.a.createElement($e.ScrollView,{scrollY:!0,scrollWithAnimation:!0,style:I},v.a.createElement($e.View,{className:Qt},_&&v.a.createElement($e.View,{className:rn},v.a.createElement(at,{size:"26",lineHeight:"38",color:"#f70",isIcon:!0,style:{paddingRight:4}},"\ue92f"),v.a.createElement(at,{lineHeight:"40",color:"#666",style:{flex:1}},p)),!!_&&!!m&&v.a.createElement($e.View,{className:rn},v.a.createElement(at,{size:"26",lineHeight:"38",color:"#f70",isIcon:!0,style:{paddingRight:4}},"\ue92f"),v.a.createElement(at,{lineHeight:"40",color:"#666",style:{flex:1}},m)),v.a.createElement($e.View,{className:an},v.a.createElement($e.View,{className:on,style:{padding:12}},v.a.createElement(at,{lineHeight:"40",weight:"500"},b)),d.map((function(e){var t=e.ClauseTypeName,n=e.ClauseSubItemList,r=_&&n.some((function(e){return 0!==e.DifferenceType}));return v.a.createElement($e.View,{key:t,className:sn},v.a.createElement($e.View,{className:cn},r&&v.a.createElement(at,{size:"26",lineHeight:"38",color:"#f70",isIcon:!0,style:{paddingRight:4}},"\ue92f"),v.a.createElement(at,{lineHeight:"40",weight:"500"},t)),v.a.createElement($e.View,{className:ln},n.map((function(e,t){var n=e.SubTitle,r=e.TargetPopulationItemList,a=[];if(null==r||r.forEach((function(e){var t=e.Description,n=e.TargetPopulation,r=e.IsHighlight;[1,s+1].includes(n)&&a.push({description:$t(t),isHighLight:r})})),a.length>1)return v.a.createElement($e.View,{key:t,className:un},!!n&&v.a.createElement(at,{lineHeight:"40",color:"#666"},n+"\uff1a"),a.map((function(e,t){var n=e.description,r=e.isHighLight?fn:dn;return v.a.createElement($e.View,{key:t,className:r},v.a.createElement(et,{content:n,copyLink:!1}))})));var o=null==a?void 0:a[0].description,i=e.isHighLight?fn:dn;return v.a.createElement($e.View,{key:t,className:"".concat(un," ").concat(i)},v.a.createElement(et,{content:o,copyLink:!1}))}))))}))),v.a.createElement($e.View,{style:{height:pn}}))))},vn=v.a.memo(hn),gn=v.a.memo(yn);function yn(e){return v.a.createElement(_n,Object.assign({},e),v.a.createElement(vn,Object.assign({},e)))}function _n(e){var t=Object(h.useMemo)((function(){var t=[I.PlatformContext.create({}),I.TourContext.create(Object.assign(Object.assign({},We().tourContext),{props:e}))];return r.mergeModelContext.apply(void 0,t)}),[]);return v.a.createElement(Jt.Provider,{context:t},e.children)}var bn="https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/resource/private_service_assistant.png",In="https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/resource/private_service_pattern.png",xn={privateServiceBox:"_1cdkd0v0",privateServiceBoxB:"_1cdkd0v1",privateServiceImgBox:"_1cdkd0v2",privateServiceImg:"_1cdkd0v3",privateServiceText:"_1cdkd0v4",privateServiceBackgroundBox:"_1cdkd0v5",privateServiceBackground:"_1cdkd0v6",privateServiceBtnBox:"_1cdkd0v7",privateServiceBtn:"_1cdkd0v8",privateServiceBtnText:"_1cdkd0v9"},Tn=v.a.memo((function(e){var t=e.pageName,n=void 0===t?"resource":t,r=e.count,a=void 0===r?0:r,o=e.onClickIM;return a>5?v.a.createElement($e.View,{className:[xn.privateServiceBox,xn.privateServiceBoxB].join(" ")},v.a.createElement($e.View,{className:xn.privateServiceImgBox},v.a.createElement($e.Image,{className:xn.privateServiceImg,src:bn})),v.a.createElement($e.View,{className:xn.privateServiceBackgroundBox},v.a.createElement($e.Image,{className:xn.privateServiceBackground,src:In})),v.a.createElement($e.View,{className:xn.privateServiceText},v.a.createElement(at,{size:"28",lineHeight:"38",weight:"500",color:"#5678a8",style:{marginBottom:4}},"\u591a\u4eba\u51fa\u884c\uff0c\u8054\u7cfb\u5ba2\u670d\u9884\u8ba2\u66f4\u7701\u5fc3"),v.a.createElement(at,{size:"24",lineHeight:"30",color:"#89a0c2"},"\u4e13\u4eba\u670d\u52a1\uff0c\u8c03\u6574\u4f4f\u5bbf\u3001\u7528\u8f66\u7b49")),v.a.createElement($e.View,{className:xn.privateServiceBtnBox},v.a.createElement(Xe,{className:xn.privateServiceBtn,style:function(e){return{opacity:e.pressed?.2:1}},onPress:o},v.a.createElement(at,{size:"26",lineHeight:"34",weight:"500",color:"#0086f6",style:{whiteSpace:"nowrap"}},"\u7acb\u5373\u8054\u7cfb")))):v.a.createElement($e.View,{className:xn.privateServiceBox},v.a.createElement($e.View,{className:xn.privateServiceImgBox},v.a.createElement($e.Image,{className:xn.privateServiceImg,src:bn})),v.a.createElement($e.View,{className:xn.privateServiceBackgroundBox},v.a.createElement($e.Image,{className:xn.privateServiceBackground,src:In})),"detail"===n?v.a.createElement($e.View,{className:xn.privateServiceText},v.a.createElement(at,{size:"26",lineHeight:"38",weight:"500",color:"#5678a8"},"\u9700\u8981\u8c03\u6574\u884c\u7a0b\u6216\u9152\u5e97\uff0c\u8bf7\u8054\u7cfb\u5ba2\u670d")):v.a.createElement($e.View,{className:xn.privateServiceText},v.a.createElement(at,{size:"26",lineHeight:"38",weight:"500",color:"#5678a8"},"\u6ca1\u627e\u5230\u5408\u9002\u7684\u4ea4\u901a\u3001\u9152\u5e97\uff1f"),v.a.createElement(at,{size:"26",lineHeight:"38",weight:"500",color:"#5678a8"},"\u8054\u7cfb\u5ba2\u670d\u5e2e\u60a8\u8c03\u6574")),v.a.createElement($e.View,{className:xn.privateServiceBtnBox},v.a.createElement(Xe,{className:xn.privateServiceBtn,style:function(e){return{opacity:e.pressed?.2:1}},onPress:o},v.a.createElement(at,{size:"26",lineHeight:"34",weight:"500",color:"#0086f6",style:{whiteSpace:"nowrap"}},"\u7acb\u5373\u8054\u7cfb"))))})),kn="tmzlbl0",Sn="tmzlbl1",Cn="tmzlbl2",wn="tmzlbl3",Nn="tmzlbl4",En="tmzlbl5",Pn="tmzlbl6",jn="tmzlbl7",On="tmzlbl8",Dn="tmzlbl9",Rn="tmzlbla",An="tmzlblb",Mn="tmzlblc";function Vn(){var e=At.useState((function(e){return{internalShow:e.internalShow,internalInited:e.internalInited,tempCount:e.tempCount,errorInfo:e.errorInfo,productProperty:e.productProperty,internalDisableAction:e.internalDisableAction,internalDisableScroll:e.internalDisableScroll,internalDiasbleMaskClose:e.internalDiasbleMaskClose,feeIncludeType:e.feeIncludeType}})),t=e.internalShow,n=e.internalInited,r=e.tempCount,a=e.errorInfo,o=e.productProperty,i=e.internalDisableAction,s=e.internalDisableScroll,c=e.internalDiasbleMaskClose,l=e.feeIncludeType;if(!n)return null;var u=o.productType,d=o.adultCanBook,f=o.childCanBook,p=o.infantCanBook,m=o.hasFeeIncludeTip,h=o.childAgeRequired,v=o.childMinAge,g=o.childMaxAge,y="grp"===u?function(e){var t=e.adultCanBook,n=e.childCanBook,r=(e.MinBookPerson,e.MaxBookPerson),a=e.childMinAge,o=e.childMaxAge,i=e.isStudy,s=i?0:1,c={adultAgeRange:"".concat(o,"\u5468\u5c81\u53ca\u4ee5\u4e0a"),adultMin:t?s:0,adultMax:t?r:0},l={childAgeRange:"".concat(a,"-").concat(o,"\u5468\u5c81(\u4e0d\u542b)"),childMin:0,childMax:n?r:0};return i&&n&&!t&&(l.childMin=1),Object.assign(Object.assign(Object.assign({},c),l),{})}(o):function(e){var t=e.adultCanBook,n=e.childCanBook,r=e.infantCanBook,a=e.MinBookPerson,o=e.MaxBookPerson,i=e.childMinAge,s=e.childMaxAge,c=a;n&&(c=1);var l={adultAgeRange:"".concat(s,"\u5468\u5c81\u53ca\u4ee5\u4e0a"),adultMin:t?c:0,adultMax:t?o:0},u={childAgeRange:"".concat(i,"-").concat(s,"\u5468\u5c81(\u4e0d\u542b)"),childMin:0,childMax:n?o:0},d={infantAgeRange:"14\u5929-".concat(i,"\u5468\u5c81(\u4e0d\u542b)"),infantMin:0,infantMax:r?o:0};return Object.assign(Object.assign(Object.assign({},l),u),d)}(o),_="";a&&a.show&&(_=a.reason||"");var b=r.childAges,I=h&&(null==b?void 0:b.length)>0&&!p?"#f7f9fb":"#ffffff",x="adult"===l||"child"===l;return Object.assign(Object.assign(Object.assign({internalShow:t,internalDisableAction:i,disableMaskClose:!!c,scrollEnabled:!s,adultCanBook:d,childCanBook:f,infantCanBook:p,hasFeeIncludeTip:m,childAgeRequired:h,childMinAge:v,childMaxAge:g},r),y),{reasonTips:_,backgroundColor:I,feeIncludeType:l,isShowFeeIncludeMask:x})}var Ln,Bn=nt().windowWidth,Un=function(e){return"presale_order"===e.pageName?v.a.createElement(Fn,Object.assign({},e)):v.a.createElement(Zn,Object.assign({},e))},Zn=function(e){var t=e.isShow,n=e.onOpen,r=e.onClose,a=e.isShowPrivateIM,o=void 0!==a&&a,i=e.onClickIM,s=e.cacheKey,c=e.zIndex,l=At.useActions(),u=l.handleDiscardDraft,d=l.handleSubmitDraft,f=l.handleSyncExternalShow,p=l.handleClearTip,m=Object(h.useRef)(!1);Object(h.useMemo)((function(){m.current?(f(t),!t&&u()):m.current=!0}),[t]);var g=Vn(),y=g.internalShow,_=g.scrollEnabled,b=g.adultCount,I=g.childCount,x=g.backgroundColor,T=g.hasFeeIncludeTip,k=g.feeIncludeType,S=g.isShowFeeIncludeMask,C=b+I,w=o&&C>5,N=Object.assign(Object.assign({},g),{reasonTipPosition:w?"top":"bottom"});Object(h.useEffect)((function(){y!==t&&(f(t),y&&n())}),[y,t]);var E=ut({footer:!0,safeArea:!0});return v.a.createElement(v.a.Fragment,null,v.a.createElement(ft,{title:"\u9009\u62e9\u4eba\u6570",confirmText:"\u786e\u8ba4\u4eba\u6570",confirmLocation:"footer",show:y,backgroundColor:x,handleClose:r,handleConfirm:d,zIndex:c},v.a.createElement($e.ScrollView,{scrollY:_,scrollWithAnimation:!0,bounces:!1,style:E},v.a.createElement(Gn,Object.assign({},N)),!!w&&v.a.createElement($e.View,{className:Mn},v.a.createElement(Tn,{count:C,onClickIM:i})))),T&&v.a.createElement(gn,{isShow:S,type:k,onClose:p,cacheKey:s,zIndex:"number"==typeof c?c+1:void 0}))},Fn=function(e){var t=e.isShow,n=e.onClose,r=e.cacheKey,a=At.useActions(),o=a.handleSyncExternalShow,i=a.handleSubmitDraft,s=a.handleDiscardDraft,c=a.handleClearTip;Object(h.useMemo)((function(){!t&&s()}),[t]);var l=Vn();if(!l)return null;var u=l.internalShow,d=l.backgroundColor,f=l.scrollEnabled,p=l.hasFeeIncludeTip,m=l.feeIncludeType,g=l.isShowFeeIncludeMask,y=Object.assign(Object.assign({},l),{reasonTipPosition:"bottom"}),_=ut({footer:!0,safeArea:!0});return Object(h.useEffect)((function(){u!==t&&o(t)}),[u,t]),v.a.createElement(v.a.Fragment,null,v.a.createElement(ft,{title:"\u9009\u62e9\u4eba\u6570",confirmText:"\u786e\u8ba4\u4eba\u6570",confirmLocation:"footer",show:t,backgroundColor:d,handleClose:n,handleConfirm:i},v.a.createElement($e.ScrollView,{scrollY:f,scrollWithAnimation:!0,bounces:!1,style:_},v.a.createElement(Gn,Object.assign({},y)))),p&&v.a.createElement(gn,{isShow:g,type:m,onClose:c,cacheKey:r}))},Gn=function(e){var t=e.internalDisableAction,n=e.adultCanBook,r=e.childCanBook,a=e.infantCanBook,o=e.adultAgeRange,i=e.adultMin,s=e.adultMax,c=e.adultCount,l=e.childAgeRange,u=e.childMin,d=e.childMax,f=e.childCount,p=e.childAgeRequired,m=e.childMinAge,h=e.childMaxAge,g=e.childAges,y=e.infantAgeRange,_=e.infantMin,b=e.infantMax,I=e.infantCount,x=e.hasFeeIncludeTip,T=e.reasonTips,k=e.reasonTipPosition,S=At.useActions(),C=S.handleUpdateAdultCount,w=S.handleUpdateChildCount,N=S.handleUpdateChildAge,E=S.handleUpdateInfantCount,P=S.handleEnableScroll,j=S.handleClickTip;return v.a.createElement(v.a.Fragment,null,"top"===k&&v.a.createElement(Yn,{reason:T}),v.a.createElement(qn,{type:"adult",canBook:n,rangeText:o,hasTips:x,min:i,max:s,count:c,setCount:C,onTipClick:j,disabled:t}),v.a.createElement($e.View,{className:Sn}),v.a.createElement(qn,{type:"child",canBook:r,rangeText:l,hasTips:x,min:u,max:d,count:f,setCount:w,onTipClick:j,disabled:t}),p&&v.a.createElement(zn,{minAge:m,maxAge:h-1,childAges:g,setChildAges:N,setScrollEnabled:P,disabled:t,inlineTip:!!T}),a&&v.a.createElement($e.View,{className:Sn}),a&&v.a.createElement(qn,{type:"infant",canBook:a,rangeText:y,hasTips:!1,min:_,max:b,count:I,setCount:E,disabled:t}),"bottom"===k&&v.a.createElement(Yn,{reason:T}))},Hn={infant:"\u5a74\u513f",child:"\u513f\u7ae5",adult:"\u6210\u4eba"},qn=v.a.memo((function(e){var t=e.type,n=e.rangeText,r=e.canBook,a=void 0!==r&&r,o=e.hasTips,i=void 0!==o&&o,s=e.count,c=e.setCount,l=e.min,u=e.max,d=e.onTipClick,f=e.disabled,p=void 0!==f&&f,m=Hn[t];if(!a)return v.a.createElement($e.View,{className:kn},v.a.createElement($e.View,{className:Cn},v.a.createElement(at,{color:"#999"},m+"\u4e0d\u53ef\u8ba2")),v.a.createElement(Lt,{min:s,max:s,step:1,value:s,onChange:c}));var h=i&&("adult"===t||"child"===t);return v.a.createElement($e.View,{className:kn},v.a.createElement($e.View,{className:Cn},v.a.createElement(at,{weight:"500",style:{marginRight:20}},m),v.a.createElement(at,{color:"#999"},n),h&&d&&v.a.createElement(Xe,{className:wn,style:function(e){return{opacity:e.pressed?.2:1}},onPress:function(){return d(t)}},v.a.createElement(at,{size:"28",color:"#aaa",isIcon:!0},"\uef89"))),v.a.createElement(Lt,{min:l,max:u,step:1,value:s,onChange:c,disabled:p}))})),Kn=function(e){return e+"\u5468\u5c81"},zn=function(e){var t=e.minAge,n=e.maxAge,r=e.childAges,a=e.disabled,o=void 0!==a&&a,i=e.setChildAges,s=e.setScrollEnabled,c=e.inlineTip,l=void 0!==c&&c,u=k(Object(h.useState)(Bn-60-32),2),d=u[0],f=(u[1],Object(h.useRef)(r));Object(h.useEffect)((function(){f.current=r}),[r]);var p=Object(h.useCallback)((function(){return s(!1)}),[]),m=Object(h.useCallback)((function(e,t){s(!0);var n=Object(Qe.a)(f.current);n[t]=e,i(n)}),[]);return v.a.createElement($e.View,{className:Nn},r.map((function(e,r){var a=e>=t&&e<=n;return v.a.createElement($e.View,{key:r},v.a.createElement($e.View,{className:En},v.a.createElement(at,{lineHeight:"48",style:{width:60}},"\u513f\u7ae5",r+1),v.a.createElement($e.View,{className:jn},v.a.createElement($e.View,{className:On},v.a.createElement(at,{size:"26",lineHeight:"34",color:"#ccc"},t),v.a.createElement(at,{size:"26",lineHeight:"34",color:"#ccc"},n)),v.a.createElement(Yt,{id:r,width:d,startX:72,min:t,max:n,value:e,valueFormatter:Kn,onChangeStart:p,onChangeEnd:m,disabled:o}))),l&&!a&&v.a.createElement($e.View,{className:Dn},v.a.createElement(at,{size:"24",lineHeight:"24",color:"#f5190a",isIcon:!0},"\uef39"),v.a.createElement(at,{size:"24",lineHeight:"36",color:"#f5190a",style:{paddingLeft:4}},"\u8bf7\u9009\u62e9\u513f\u7ae5\u5e74\u9f84")))})),r.length>0&&v.a.createElement($e.View,{className:Pn}),r.length>0&&v.a.createElement($e.View,{className:Rn}))},Yn=function(e){var t=e.reason;return t?v.a.createElement($e.View,{className:An},v.a.createElement(at,{size:"26",lineHeight:"38",color:"#f70",isIcon:!0,style:{paddingRight:4}},"\uef89"),v.a.createElement(at,{size:"24",lineHeight:"36",color:"#f70",style:{flex:1}},t)):null},Wn=v.a.memo(Un),$n=v.a.memo(Xn);function Xn(e){return v.a.createElement(Jn,Object.assign({},e),v.a.createElement(Wn,Object.assign({},e)))}function Jn(e){var t=Object(h.useMemo)((function(){var t=[I.PlatformContext.create({}),I.TourContext.create(Object.assign(Object.assign({},We().tourContext),{props:e,pageName:e.pageName}))];return r.mergeModelContext.apply(void 0,t)}),[]);return v.a.createElement(At.Provider,{context:t},e.children)}!function(e){e.default="inpop",e.inpage="inpage"}(Ln||(Ln={}));var Qn={INIT_DRAFT:function(e,t){return Object.assign(Object.assign(Object.assign({},e),t),{internalInited:!0})},UPDATE_DRAFT:function(e,t){return Object.assign(Object.assign({},e),t)},DISCARD_DRAFT:function(e){var t=e.initForm;return Object.assign(Object.assign({},e),{tempForm:t})},SAVE_DRAFT:function(e){var t=e.tempForm;return Object.assign(Object.assign({},e),{initForm:t})},CLEAN_ALL:function(e){return{internalInited:!1}}},er=Object(a.createReactModel)((function(){var e=Object(I.setupTourContext)(),t=e.props,n=Object(r.setupStore)({name:"isomorphic_extend_info_components",initialState:{internalInited:!1},reducers:Qn,logger:K.b&&!K.d&&!!t.logger}),a=n.store,o=n.actions,i=function(n,r){var i=a.getState(),s=i.tempForm,c=i.formLabel,l=i.errorMessages,f=o.UPDATE_DRAFT;if(s[n]!==r){var p=Object.assign({},l);t.showType&&t.showType===Ln.inpage&&(p[n]=u(n,r)),f({tempForm:Object.assign(Object.assign({},s),Object(W.a)({},n,r)),errorMessages:p}),e.traceKMLogAction({attrs:[{key:"shoppingId",value:String(t.shoppingId)||""}],module:"\u9644\u52a0\u4fe1\u606f\u7ec4\u4ef6",scene:"\u66f4\u65b0\u9644\u52a0\u4fe1\u606f",role:d.RoleType.usr,action:d.ActionType.change,value:"".concat(c[n],": ").concat(r)}),t.showType&&t.showType===Ln.inpage&&t.onCallBack&&t.onCallBack({tempForm:Object.assign(Object.assign({},s),Object(W.a)({},n,r)),errorMessages:p})}},s=function(){(0,o.DISCARD_DRAFT)()},c=function(){var e=b(y().mark((function e(){var n,r,i,s,c,l,u,d,f,p,m,h;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(u in n=o.SAVE_DRAFT,r=a.getState(),i=r.tempForm,s=r.formToken,c=r.SelectedResource,l=[],i)d=i[u],(f=s[u])&&l.push({TokenInfo:f,ExtendMaps:[{Key:"Content",Value:d}]});return p=Object.assign(Object.assign({},c),{ExtendInfos:l}),m=t.extendInfo.SelectedInfo.OrderExtendInfos,h=[],m.forEach((function(e){h.push(Object.assign(Object.assign({},e),{Content:i[e.Id]}))})),e.next=10,t.onSubmit({selectedResource:p,submitForm:h});case 10:return e.sent&&n(),e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(e,t){var n={};return Object.keys(e).map((function(e){var r=t[e]&&t[e].trim();if(r){var a=u(+e,r);a&&(n[e]=a)}})),n},u=function(e,n){try{if(!(n=n&&n.trim()))return"";var r="";if(4546===e){var a=t.startDate,o=void 0===a?"":a,i=t.endDate,s=void 0===i?"":i,c=n.match(/^(\d{4}-\d{2}-\d{2}).*(\d{2}:\d{2})/);if(c&&c[1]&&o&&s){var l=c[1];(l<o||l>s)&&(r="\u8bf7\u9009\u62e9\u6b63\u786e\u7528\u8f66\u65f6\u95f4")}}else n.length>50&&(r="\u6700\u5927\u8f93\u516550\u5b57\u7b26");return r}catch(e){return""}};return{store:a,actions:Object.assign(Object.assign({},o),{handleInitDraft:function(e){var n;if((0,o.CLEAN_ALL)(),!e||!e.OrderExtendInfos)throw new Error("\u9644\u52a0\u4fe1\u606f\u7ec4\u4ef6\uff1a\u7f3a\u5c11 extendInfo");var r=e.SelectedInfo,i=e.Token,s=e.SegmentNo,c=r.UseDate,u=r.EndUseDate,d=r.SelectedCount,f={},p={},m={},h=(null===(n=e.SelectedInfo)||void 0===n?void 0:n.OrderExtendInfos)||e.OrderExtendInfos;h.map((function(e){e.Id||(e.Id=e.ID)})),h.forEach((function(e){var t=e.Id,n=e.Content,r=e.Name,a=e.Token;p[t]=r,f[t]=n||"",m[t]=a}));var v={Token:i,SegmentNo:s,Count:d,UseDateRange:{UseDate:c,EndUseDate:u},ExtendInfos:[]},g={};t.showType&&t.showType===Ln.inpage&&(g=l(p,f));var y=t.startDate,_=void 0===y?"":y,b=t.endDate,I=void 0===b?"":b;return(0,o.INIT_DRAFT)({formLabel:p,formToken:m,initForm:f,tempForm:f,useDate:c,SelectedResource:v,errorMessages:g,startDate:_,endDate:I}),t.showType&&t.showType===Ln.inpage&&t.onCallBack&&t.onCallBack({tempForm:f,errorMessages:g}),a.getState()},handleUpdateDraft:i,handleDiscardDraft:s,handleSubmitDraft:c,handleSyncExternalShow:function(e){a.getState().internalInited&&!e&&s()},handleSelectDate:function(e){console.log("===handleSelectDate====",e);var t=new S.a(e).format("yyyy-MM-dd \u5468w hh:mm");i(4546,t)}})}})),tr="_1igzpzl0",nr="_1igzpzl1",rr=Object(h.forwardRef)(ar);function ar(e,t){var n=e.title,r=void 0===n?"\u9009\u62e9\u65e5\u671f":n,a=e.startDate,o=e.endDate,i=e.currentDate,s=(e.minuteInterval,e.onConfirm),c=k(Object(h.useState)(!1),2),l=c[0],u=c[1];Object(h.useImperativeHandle)(t,(function(){return{toggle:function(){u(!l)}}}));for(var d=[],f=[],p=[],m=S.a.parse(a).addMonth(-6).valueOf(),g=S.a.parse(o).addMonth(6).valueOf(),_=S.a.parse(i).valueOf(),I=S.a.dayDiff(m,g),x=0,T=0;T<I;T++)T>0&&(m=S.a.parse(m).addDay(1).valueOf()),_.getTime()===m.getTime()&&(x=T),d.push({time:m.getTime(),label:S.a.parse(m).format("YYYY\u5e74MM\u6708DD\u65e5 \u5468w")});for(var C=0;C<=23;C++)f.push("00".concat(C).slice(-2));for(var w=0;w<=59;w++)p.push("00".concat(w).slice(-2));var N=function(e){var t=k(e,3),n=t[0],r=t[1],a=t[2],o=d[n].time,i=r,s=a;return new S.a(o||Date.now()).setHours(i,s,0,0).valueOf()},E=k(Object(h.useState)([x,_.getHours(),_.getMinutes()]),2),P=E[0],j=E[1],O=k(Object(h.useState)(x),2),D=O[0],R=O[1],A=k(Object(h.useState)(0),2),M=A[0],V=A[1],L=k(Object(h.useState)(0),2),B=L[0],U=L[1],Z=function(){var e=b(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=N(P),s(t),e.abrupt("return",!0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return v.a.createElement(ft,{title:r,show:l,confirmLocation:"header",confirmText:"\u786e\u5b9a",handleClose:function(){return u(!1)},handleConfirm:Z,safeArea:!1},v.a.createElement($e.View,{className:tr},v.a.createElement($e.PickerView,{indicatorClass:nr,indicatorStyle:"height: 50px;",style:"width: 100%; height: 300px;",value:P,onChange:function(e){var t=k(e.detail.value,3),n=t[0],r=t[1],a=t[2];return n!==D?(R(n),void j([n,0,0])):r!==M?(V(r),void j([n,r,0])):a!==B?(U(a),void j([n,r,a])):void 0}},v.a.createElement($e.PickerViewColumn,{style:{flex:2}},d.map((function(e){return v.a.createElement($e.View,{className:nr},e.label)}))),v.a.createElement($e.PickerViewColumn,null,f.map((function(e){return v.a.createElement($e.View,{className:nr},e,"\u65f6")}))),v.a.createElement($e.PickerViewColumn,null,p.map((function(e){return v.a.createElement($e.View,{className:nr},e,"\u5206")}))))))}var or="nux8480",ir="nux8481",sr="nux8482",cr="nux8483",lr="nux8484",ur="nux8485",dr="nux8486",fr="nux8487",pr=v.a.memo(mr);function mr(e){var t,n=e.isShow,r=e.onClose,a=e.shoppingId,o=e.extendInfo,i={internalInited:(t=er.useState((function(e){return{internalInited:e.internalInited,formLabel:e.formLabel}}))).internalInited,formLabel:t.formLabel},s=i.internalInited,c=i.formLabel,l=er.useActions(),u=l.handleInitDraft,d=l.handleSyncExternalShow,f=l.handleSubmitDraft,p=Object(h.useRef)();return Object(h.useEffect)((function(){a&&u(o)}),[a,o]),Object(h.useEffect)((function(){d(n)}),[n]),s?v.a.createElement(v.a.Fragment,null,v.a.createElement(ft,{title:"\u586b\u5199\u63a5\u9001\u5907\u6ce8",show:n,handleClose:r,confirmText:"\u786e\u5b9a",confirmLocation:"footer",handleConfirm:f,footerShadow:!0},v.a.createElement($e.View,{className:or},v.a.createElement($e.View,{className:ir},v.a.createElement(at,{size:"24",lineHeight:"30",color:"#666"},"\u82e5\u6709\u63a5\u9001\u9700\u6c42\uff0c\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u586b\u5199\u63a5\u9001\u5907\u6ce8\uff0c\u5177\u4f53\u63a5\u9001\u8303\u56f4\u8bf7\u53c2\u8003\u884c\u7a0b\u4e2d\u76f8\u5173\u63cf\u8ff0\u3002")),v.a.createElement($e.View,{className:sr},Object.keys(c).map((function(e,t){var n=c[e],r=Number(e);return 4546!==r?v.a.createElement(hr,{key:t,Id:r,Label:n}):4546===r?v.a.createElement(vr,{key:t,Label:n,pickerRef:p}):void 0}))))),v.a.createElement(gr,{ref:p})):null}var hr=v.a.memo((function(e){var t=e.Id,n=e.Label,r=function(e){return{Content:er.useState((function(e){return{initForm:e.initForm}})).initForm[e]||""}}(t).Content,a=k(Object(h.useState)(r),2),o=a[0],i=a[1],s=er.useActions().handleUpdateDraft,c=Object(h.useCallback)((function(e){var t=e.detail.value;i(t)}),[]);return v.a.createElement($e.View,{className:cr},v.a.createElement($e.Text,{className:ur},n),v.a.createElement($e.Input,{className:dr,placeholder:"\u8bf7\u586b\u5199".concat(n,"\uff0c\u975e\u5fc5\u586b"),placeholderClass:fr,value:o,onInput:c,onBlur:function(){s(t,o)}}))})),vr=v.a.memo((function(e){var t=e.Label,n=e.pickerRef,r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4546,t=er.useState((function(e){return{initForm:e.initForm,tempForm:e.tempForm,useDate:e.useDate,startDate:e.startDate,endDate:e.endDate,errorMessages:e.errorMessages}})),n=t.initForm,r=t.tempForm,a=t.useDate,o=t.startDate,i=t.endDate,s=t.errorMessages,c=s&&s[e]||"",l=n[e]||"",u=r[e]||"",d=new S.a(a).valueOf(),f=S.a.parse(d).addMonth(4).valueOf(),p=S.a.parse(d).addHours(8).valueOf(),m=S.a.parse(d).valueOf();if(o&&i&&(f=S.a.parse(i).addHours(23).addMinutes(59).valueOf(),p=m=S.a.parse(o,!0),u&&!c))try{var h=u.match(/^(\d{4}-\d{2}-\d{2}).*(\d{2}:\d{2})/);p=S.a.parse("".concat(h[1]," ").concat(h[2]),!0)}catch(e){}return{Content:l,TempContent:u,maxDate:f,date:p,minDate:m}}().TempContent;return v.a.createElement(v.a.Fragment,null,v.a.createElement($e.View,{className:cr},v.a.createElement($e.Text,{className:ur},t),v.a.createElement(Xe,{onPress:function(){n.current&&n.current.toggle()},className:lr,style:function(e){return{opacity:e.pressed?.2:1}}},!r&&v.a.createElement($e.Text,{className:fr},"\u8bf7\u586b\u5199".concat(t,"\uff0c\u975e\u5fc5\u586b")),!!r&&v.a.createElement($e.Text,{className:dr},r),v.a.createElement(at,{isIcon:!0,color:"#999"},"\ue944"))))})),gr=v.a.forwardRef((function(e,t){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4546,t=er.useState((function(e){return{formLabel:e.formLabel,useDate:e.useDate}})),n=t.formLabel,r=t.useDate,a=n[e]||"",o=new S.a(r).valueOf(),i=S.a.parse(o).addMonth(24).valueOf(),s=S.a.parse(o).addHours(8).valueOf(),c=S.a.parse(o).addMonth(-12).valueOf();return{maxDate:i,date:s,minDate:c,Label:a}}(),r=n.maxDate,a=n.date,o=n.minDate,i=n.Label,s=er.useActions().handleSelectDate;return v.a.createElement(rr,{ref:t,title:"\u9009\u62e9".concat(i),minuteInterval:10,currentDate:a,startDate:o,endDate:r,onConfirm:s})})),yr=v.a.memo(_r);function _r(e){return v.a.createElement(br,Object.assign({},e),v.a.createElement(pr,Object.assign({},e)))}function br(e){var t=Object(h.useMemo)((function(){var t=[I.PlatformContext.create({}),I.TourContext.create(Object.assign(Object.assign({},We().tourContext),{props:e}))];return r.mergeModelContext.apply(void 0,t)}),[]);return v.a.createElement(er.Provider,{context:t},e.children)}var Ir="_1g2sdn00",xr="_1g2sdn01",Tr="_1g2sdn02",kr="_1g2sdn03",Sr="_1g2sdn04",Cr="_1g2sdn05",wr="_1g2sdn06",Nr="_1g2sdn07",Er="_1g2sdn08",Pr="_1g2sdn09",jr="_1g2sdn0a",Or="_1g2sdn0b",Dr=nt().windowWidth,Rr=v.a.memo((function(e){var t=e.isShow,n=e.onClose,r=e.notice,a=e.type,o=e.zIndex,i=Object(h.useRef)(!1),s=Object(h.useRef)(!0),c=Object(h.useRef)([]),l=Object(h.useRef)(0),u=k(Object(h.useState)(0),2),d=u[0],f=u[1],p=k(Object(h.useState)(!1),2),m=p[0],g=p[1],y=k(Object(h.useState)("PreSaleRule"),2),_=y[0],b=y[1],I=function(e,t){var n,r=[];return(null==e?void 0:e.PreSaleRule)&&r.push({type:"PreSaleRule",tabLabel:"\u9884\u7ea6\u89c4\u5219\u6d41\u7a0b",tabTitle:"\u9884\u7ea6\u89c4\u5219",mergeSection:"\u9884\u7ea6\u6d41\u7a0b",PreSaleRule:null==e?void 0:e.PreSaleRule,BookFlow:null==e?void 0:e.BookFlow}),(null==e?void 0:e.PreSaleUnbooking)&&r.push({type:"PreSaleUnbooking",tabLabel:"\u9000\u6539\u653f\u7b56",tabTitle:"\u9000\u6539\u653f\u7b56",PreSaleUnbooking:e.PreSaleUnbooking}),(null==e?void 0:e.InvoiceNotice)&&r.push({type:"InvoiceNotice",tabLabel:"\u53d1\u7968\u4fe1\u606f",tabTitle:"\u53d1\u7968\u4fe1\u606f",InvoiceNotice:e.InvoiceNotice}),(null==e?void 0:e.SpecialDescription)&&r.push({type:"SpecialDescription",tabLabel:"\u7279\u522b\u8bf4\u660e",tabTitle:"\u7279\u522b\u8bf4\u660e",SpecialDescription:e.SpecialDescription}),"BookFlow"===t&&(t="PreSaleRule"),n=r.findIndex((function(e){return(null==e?void 0:e.type)===t})),{noticeItems:r,currentIndex:n}}(r,_),x=I.noticeItems,T=I.currentIndex,C=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];g(n),b(e),i.current=!0,f(c.current[t]),setTimeout((function(){i.current=!1}),500)},w=Object(h.useCallback)((function(e){if(N(),!i.current&&!Object(K.c)(c.current)){var t=e.detail,n=t.scrollTop,r=t.deltaY;r<0&&n+180>=c.current[l.current+1]&&(l.current+=1,x[l.current]&&b(x[l.current].type)),r>0&&n+180<c.current[l.current]&&(l.current-=1,x[l.current]&&b(x[l.current].type))}}),[]),N=function(){if(!(c.current.length>0)){var e=Ne.a.createSelectorQuery();e.select("#presaleNotice_PreSaleRule").boundingClientRect(),e.select("#presaleNotice_PreSaleUnbooking").boundingClientRect(),e.select("#presaleNotice_InvoiceNotice").boundingClientRect(),e.select("#presaleNotice_SpecialDescription").boundingClientRect(),e.exec((function(e){var t=[];e.forEach((function(n){n&&t.push(n.top-e[0].top)})),c.current=t}))}};Object(h.useEffect)((function(){t?s.current&&setTimeout((function(){N(),C(a,T,!1),s.current=!1}),100):setTimeout((function(){s.current=!0,b("PreSaleRule"),f(0)}),500)}),[a,t,T]);var E=ut({top:45,footer:!1,safeArea:!1});return v.a.createElement(ft,{title:"\u9884\u552e\u8bf4\u660e",show:t,handleClose:n,safeArea:!1,zIndex:o},v.a.createElement($e.View,{className:Sr},x.map((function(e,t){var n=e.type,r=e.tabLabel,a=n===_;return v.a.createElement(Xe,{key:t,className:a?wr:Cr,onPress:function(){return C(n,t)}},v.a.createElement(at,{size:a?"34":"28",lineHeight:"40",weight:a?"500":"400",color:a?"#0066f6":"#111"},r),a&&v.a.createElement($e.View,{className:Nr}))}))),v.a.createElement($e.ScrollView,{id:"presaleNotice_Scroll",enhanced:!0,scrollY:!0,scrollWithAnimation:m,scrollTop:d,onScroll:w,onTouchStart:function(){i.current=!1},onDragStart:function(){i.current=!1},style:Object.assign({backgroundColor:"#ededf5"},E)},x.map((function(e){var t,n,r,a,o,i,s,c,l,u,d,f,p,m,h,g,y,_,b,I,x,T,k,C,w,N,E,P,j,O,D,R,A,M,V=e.tabTitle,L=e.type;return"PreSaleRule"!==L||Object(K.c)(e.PreSaleRule)?"PreSaleUnbooking"!==L||Object(K.c)(e.PreSaleUnbooking)?"InvoiceNotice"!==L||Object(K.c)(e.InvoiceNotice)?"SpecialDescription"!==L||Object(K.c)(e.SpecialDescription)?null:v.a.createElement($e.View,{className:Ir,key:L,id:"presaleNotice_".concat(L)},Vr(V),(M=e.SpecialDescription,v.a.createElement(v.a.Fragment,null,M.map((function(e,t){return v.a.createElement(Br,{key:t,line:[e],mb:12})}))))):v.a.createElement($e.View,{className:Ir,key:L,id:"presaleNotice_".concat(L)},Vr(V),(A=e.InvoiceNotice,v.a.createElement($e.View,null,A.map((function(e,t){return v.a.createElement(at,{key:t,size:"26",color:"#555",lineHeight:"38"},e.Description)}))))):v.a.createElement($e.View,{className:Ir,key:L,id:"presaleNotice_".concat(L)},Vr(V),(p=e.PreSaleUnbooking,h=(m=p||{}).UnBookingTagList,g=m.UnBookingAddInfo,y=m.ChangeLimit,b=(_=g||{}).TravelerTitle,I=_.TravellerDefaultList,x=_.DataRangeTableHead,T=_.TravellerHolidayDescDetail,k=_.TouristDescFooter,C=_.TouristRenegeHead,w=_.AgencyTitle,N=_.LossValueTableHead,E=_.TravelAgencyDefaultList,P=_.TravelAgencyHolidayDescDetail,j=_.TravelAgencyDescFooter,O=_.TravelAgencyRenegeHead,D=!Object(K.c)(h),R=!Object(K.c)(g),v.a.createElement(v.a.Fragment,null,D&&v.a.createElement($e.View,{style:{marginBottom:12}},v.a.createElement(at,{size:"34",lineHeight:"42",color:"#111",weight:"500"},"\u672a\u9884\u7ea6\u51fa\u884c\u65e5\u671f")),D&&(null==h?void 0:h.map((function(e,t){var n=e.TagName,r=e.Description;return v.a.createElement($e.View,{style:{paddingBottom:20},key:t},v.a.createElement(Ar,{key:t,title:n,desc:r}))}))),D&&v.a.createElement($e.View,{style:{width:Dr,height:1,marginLeft:-12,backgroundColor:"#efefef",marginBottom:20}}),v.a.createElement($e.View,{style:{marginBottom:12}},v.a.createElement(at,{size:"34",lineHeight:"42",color:"#111",weight:"500"},"\u5df2\u6210\u529f\u9884\u7ea6\u9884\u8ba2\u8fdd\u7ea6\u6761\u6b3e")),!!y&&!R&&v.a.createElement(at,{size:"26",color:"#555",lineHeight:"38"},y),R&&v.a.createElement(v.a.Fragment,null,v.a.createElement(Mr,{key:"TravelAgency",type:"TravelAgency",RefundPolicyList:E,title:O,desc:w,DataRangeTableHead:x,LossValueTableHead:N,HolidayDescDetail:P,DescFooter:j}),v.a.createElement($e.View,{style:{height:20}}),v.a.createElement(Mr,{key:"Tourist",type:"Tourist",RefundPolicyList:I,title:C,desc:b,DataRangeTableHead:x,LossValueTableHead:N,HolidayDescDetail:T,DescFooter:k}))))):v.a.createElement(v.a.Fragment,null,v.a.createElement($e.View,{className:Ir,key:L,id:"presaleNotice_".concat(L)},Vr(V),(r=e.PreSaleRule,a=r.AdvanceBookingDays,o=r.AdvanceBookingTime,i=r.PreSaleDeadLine,s=r.PreSaleTravelStartDay,c=r.PreSaleTravelEndDay,l="".concat(a,"\u5929").concat(o,"\u524d"),u=S.a.parse(i,!1).format("YYYY\u5e74MM\u6708DD\u65e5")+"\u622a\u6b62\u3002",d=S.a.parse(s,!1).format("YYYY\u5e74MM\u6708DD\u65e5")+"-"+S.a.parse(c,!1).format("YYYY\u5e74MM\u6708DD\u65e5"),f=[[{Description:"\u9700\u81f3\u5c11\u63d0\u524d",isBold:!1},{Description:l,isBold:!0},{Description:"\u9884\u7ea6\uff0c",isBold:!1},{Description:u,isBold:!0}],[{Description:"\u6bcf\u4e2a\u8ba2\u5355\u4ec5\u53ef\u9884\u7ea61\u6b21\u3002",isBold:!1},{Description:"\u91cd\u8981\u63d0\u793a\uff1a\u9884\u7ea6\u6210\u529f\u540e\u4e0d\u53ef\u4fee\u6539\u8ba2\u5355\u3002",isBold:!0}],[{Description:d,isBold:!0},{Description:"\u671f\u95f4\u53ef\u51fa\u884c(\u4ee5\u5404\u9884\u552e\u4ea7\u54c1\u5b9e\u9645\u73ed\u671f\u4e3a\u51c6)\u3002",isBold:!1}]],v.a.createElement(v.a.Fragment,null,f.map((function(e,t){return v.a.createElement(Br,{key:t,line:e})}))))),!Object(K.c)(e.BookFlow)&&v.a.createElement($e.View,{className:Ir,key:"BookFlow",id:"presaleNotice_BookFlow"},Vr(e.mergeSection),(t=e.BookFlow,n=[615.5,377,367],v.a.createElement($e.View,{className:Er},t.map((function(e,t){var r=e.Description,a=e.Title;return v.a.createElement($e.View,{className:Pr,key:t},v.a.createElement($e.View,{className:jr},v.a.createElement($e.Image,{className:Or,src:e.Icon.ImageUrl}),v.a.createElement($e.View,null,v.a.createElement(at,{size:"34",lineHeight:"42",weight:"500",color:"#111"},a),v.a.createElement(at,{size:"26",lineHeight:"38",color:"#666",block:!0,style:{marginTop:4}},r))),v.a.createElement($e.Image,{src:e.Image.ImageUrl,style:{width:"".concat(.8*e.Image.Width||620,"rpx"),height:"".concat(.8*e.Image.Height||n[t],"rpx")}}))}))))))}))))}));function Ar(e){var t=e.title,n=e.desc,r=e.type,a="Tourist"===r?"#f70":"#333",o="Tourist"===r?"#f70":"#111",i="Tourist"===r?"#f70":"#555";return t?v.a.createElement($e.View,null,v.a.createElement($e.View,{className:xr,style:{marginBottom:8}},v.a.createElement(Lr,{height:21,mr:4,color:a}),v.a.createElement(at,{size:"30",lineHeight:"42",color:o,weight:"500"},t)),v.a.createElement(at,{size:"26",lineHeight:"38",color:i},n)):null}function Mr(e){var t=e.RefundPolicyList,n=e.title,r=e.desc,a=e.HolidayDescDetail,o=e.DescFooter,i=e.DataRangeTableHead,s=e.LossValueTableHead,c=e.type,l="Tourist"===c?"#f70":"#555",u="Tourist"===c?"#f70":"#111",d={fontSize:"13px",lineHeight:"20px",color:l};return v.a.createElement(v.a.Fragment,null,v.a.createElement(Ar,{title:n,desc:r,type:c}),!Object(K.c)(t)&&v.a.createElement($e.View,{className:an,style:{marginBottom:9}},v.a.createElement($e.View,{className:"".concat(sn," ").concat(on)},v.a.createElement($e.View,{className:cn,style:{borderTop:"none"}},v.a.createElement(at,{size:"26",lineHeight:"38",weight:"500",color:u},i||"\u884c\u7a0b\u524d")),v.a.createElement($e.View,{className:ln,style:{textAlign:"center"}},v.a.createElement($e.View,{className:un,style:{borderTop:"none"}},v.a.createElement(at,{size:"26",lineHeight:"38",weight:"500",color:u},s||"\u8fdd\u7ea6\u91d1")))),t.map((function(e,t){var n=e.DateRange,r=e.LossVale;return v.a.createElement($e.View,{className:sn,key:t},v.a.createElement($e.View,{className:cn},v.a.createElement(at,{size:"26",lineHeight:"38",weight:"500",color:l},n||"")),v.a.createElement($e.View,{className:ln,style:{textAlign:"center"}},v.a.createElement($e.View,{className:un},v.a.createElement(at,{size:"26",lineHeight:"38",color:l},r||""))))}))),!!a&&v.a.createElement($e.View,{style:d},v.a.createElement(et,{content:a,copyLink:!1})),!!o&&v.a.createElement($e.View,{style:d},v.a.createElement(et,{content:o,copyLink:!1})))}function Vr(e){return v.a.createElement($e.View,{style:{marginBottom:16}},v.a.createElement(at,{size:"38",lineHeight:"42",color:"#111",weight:"500"},e))}function Lr(e){var t=e.height,n=void 0===t?19:t,r=e.mr,a=void 0===r?6:r,o=e.color,i=void 0===o?"#888":o;return v.a.createElement($e.View,{className:Tr,style:{marginRight:a,height:n}},v.a.createElement($e.View,{className:kr,style:{backgroundColor:i}}))}function Br(e){var t=e.line,n=e.mb,r=void 0===n?8:n;return v.a.createElement($e.View,{className:xr,style:{marginBottom:r}},v.a.createElement(Lr,null),v.a.createElement($e.View,null,t.map((function(e,t){var n=e.Description,r=e.isBold;return v.a.createElement(at,{size:"26",lineHeight:"38",color:r?"#111":"#555",weight:r?"500":"400",key:t},n)}))))}var Ur={UPDATE_PRODUCT_PROPERTY_INFO:function(e,t){return Object.assign(Object.assign({},e),t)},TOGGLE_FEE_INCLUDE_MASK:function(e,t){return Object.assign(Object.assign({},e),{isShowFeeIncludeMask:t})},TOGGLE_COST_INFO_MASK:function(e,t){return Object.assign(Object.assign({},e),{isShowCostInfoMask:t})},UPDATE_INIT_INFO:function(e,t){return Object.assign(Object.assign({},e),t)},UPDATE_DISCOUNT_INFO:function(e,t){return Object.assign(Object.assign({},e),t)}},Zr={20:"\u94c2\u91d1\u8d35\u5bbe",30:"\u94bb\u77f3\u8d35\u5bbe",35:"\u91d1\u94bb\u8d35\u5bbe",40:"\u9ed1\u94bb\u8d35\u5bbe",102:"\u673a\u7968\u7528\u6237"},Fr=0,Gr=1,Hr=2,qr=3,Kr=4,zr=5;function Yr(e){var t=(e||{}).BasicInfo||{},n=t.isPureDiyfhxsdp,r=t.isCruise,a=t.isDiyfhxsdp;return{productInfo:e||{},pageStatus:{isCruise:r,isSDP:n,isDiyfhxsdp:a,isGRP:!r&&!n&&!a}}}var Wr=function(e){var t=e.priceDetail,n=e.props;if(x.a.isEmpty(t))return null;var r=t.priceDetailList,a=void 0===r?[]:r,o=t.tradePriceDetailList,i=void 0===o?[]:o,s=(t.totalPrice,n.isBestone?i:a),c=null==s?void 0:s.find((function(e){return e.priceType===qr})),l=c||{},u=l.priceName,d=l.resourcePriceDetailList,f=void 0===d?[]:d,p=l.totalPrice;if(x.a.isEmpty(c)||x.a.isEmpty(f))return null;var m=u,h="- \xa5 ".concat(Math.abs(p.totalPrice)),v=[];return null==f||f.forEach((function(e){var t=e.tag,n=void 0===t?[]:t,r=e.resourceName,a=e.token,o=null==n?void 0:n.find((function(e){return["ctrip_group_discount","ctrip_vip_discount"].includes(e.key)})),i={groupDiscount:{},vipDiscount:{},notDiscount:!o,resourceName:r,price:"- \xa5 ".concat(Math.abs(e.adultPrice)),countText:"x ".concat(e.count).concat(e.chargeUnit),tag:"\u60e0",token:a};o&&"ctrip_group_discount"===o.key&&(i.groupDiscount.code=o.value,i.groupDiscount.text=r),o&&"ctrip_vip_discount"===o.key&&(i.vipDiscount.code=o.value,i.vipDiscount.text=Zr[null==o?void 0:o.value]||"",i.vipDiscount.resourceName=r),v.push(i)})),{title:m,titlePrice:h,renderList:v}},$r={priceDetail:{},isShowFeeIncludeMask:!1,isShowCostInfoMask:!1},Xr=Object(a.createReactModel)((function(){var e=Object(I.setupTourContext)(),t=e.props,n=Object(r.setupStore)({name:"isomorphic_price_detail_components",initialState:Object.assign({},$r),reducers:Ur,logger:K.b&&!K.d&&!!t.logger}),a=n.store,o=n.actions,i=X(e),s=i.getProductInfo,c=i.fetchProductInfo,l=i.setProductInfo;Object(r.setupPreloadCallback)(b(y().mark((function e(){var n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.priceDetail,!x.a.isEmpty(n)){e.next=4;break}return console.warn("\u91d1\u989d\u660e\u7ec6\u7ec4\u4ef6: \u7f3a\u5c11priceDetail"),e.abrupt("return");case 4:return e.next=6,u();case 6:if(r=e.sent){e.next=10;break}return console.warn("\u91d1\u989d\u660e\u7ec6\u7ec4\u4ef6: \u7f3a\u5c11productInfo"),e.abrupt("return");case 10:d(r);case 11:case"end":return e.stop()}}),e)}))));var u=function(){var e=b(y().mark((function e(){var n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.next=3,s(t.cacheKey);case 3:if(!(n=e.sent)){e.next=6;break}return e.abrupt("return",n);case 6:return e.prev=6,r=J(t.cacheKey),e.next=10,c(r);case 10:return n=e.sent,l(n),e.abrupt("return",n);case 15:return e.prev=15,e.t0=e.catch(6),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[6,15]])})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=b(y().mark((function e(t){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Yr(t),(0,o.UPDATE_INIT_INFO)(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{store:a,actions:Object.assign(Object.assign({},o),{toggleFeeIncludeMask:function(t){(0,o.TOGGLE_FEE_INCLUDE_MASK)(t),e.traceKMLogMessage("".concat(t?"\u6253\u5f00":"\u5173\u95ed","\u8d39\u7528\u5305\u542b\u7ec4\u4ef6"))},toggleCostInfoMask:function(t){(0,o.TOGGLE_COST_INFO_MASK)(t),e.traceKMLogMessage("".concat(t?"\u6253\u5f00":"\u5173\u95ed","\u90ae\u8f6e\u8d39\u7528\u8bf4\u660e\u7ec4\u4ef6"))},handleWriteDiscountLog:function(t){var n=t.priceDetail;if(!x.a.isEmpty(n)){var r=Wr({priceDetail:n,props:t})||{},i=r.renderList,s=r.title,c=r.titlePrice;if(!x.a.isEmpty(i)){var l=i.map((function(e){var t=e.countText,n=e.price,r=e.resourceName,a=e.token;return{key:"".concat(r," (").concat(a,")"),value:"".concat(n," ").concat(t)}})),u=a.getState().discountLogSnap;if(JSON.stringify(u)===JSON.stringify(l))return;e.traceKMPageLog({contents:l,desc:"\u4ef7\u683c\u660e\u7ec6".concat(s," ").concat(c)}),(0,o.UPDATE_DISCOUNT_INFO)({discountLogSnap:l})}}}})}})),Jr=function(e){var t=Xr.useState((function(e){return{productInfo:e.productInfo,pageStatus:e.pageStatus}})),n=t.productInfo,r=t.pageStatus;return function(e){var t=e.priceDetail,n=e.productInfo,r=e.pageStatus,a=e.props;if(x.a.isEmpty(t)||x.a.isEmpty(n))return null;var o=t.priceDetailList,i=t.tradePriceDetailList,s=t.countInfo,c=t.feeInfoList,l=a.isBestone?i:o,u=n||{},d=u.BasicInfo,f=void 0===d?{}:d,p=u.FeeInfoList,m=void 0===p?[]:p,h=u.CostInfoList,v=void 0===h?[]:h,g=null==l?void 0:l.find((function(e){return e.priceType===Fr}));if(x.a.isEmpty(g))return null;var y=g.priceName,_=g.totalPrice,b=s.adultCount,I=s.childCount,T=y,k="\xa5 ".concat(_.totalPrice),S=[];"order"===a.pageName&&a.basePriceProps.isShowFreeTicket&&S.push("\u5df2\u51cf\u514d\u513f\u7ae5\u706b\u8f66\u7968"),r.isSDP&&![9,26].includes(+f.ProductCategoryId)&&a.basePriceProps.isContainFlight&&S.push("\u5982\u60a8\u9884\u8ba2\u4e86\u673a\u7968\uff0c\u4ef7\u683c\u4e2d\u5df2\u542b\u6c11\u822a\u53d1\u5c55\u57fa\u91d1\u3001\u71c3\u6cb9\u8d39\u53ca\u7a0e\u8d39");var C=[],w=[];x.a.isEmpty(c)||c.forEach((function(e){"hotel_tax_fee_included"===e.key?C.push(e.value):"hotel_tax_fee_not_included"===e.key&&w.push(e.value)})),x.a.isEmpty(c)||"resource"!==a.pageName||C.length||w.length||c.forEach((function(e){"hotel_tax_fee"===e.key&&C.push(e.value)})),(C.length||w.length)&&(S=[].concat(Object(Qe.a)(S),C,w));var N=[];if(r.isGRP){var E=null==m?void 0:m.find((function(e){return"15"===e.SubTitleCode}));N=null==E?void 0:E.ProductClauseList}var P=r.isCruise&&!x.a.isEmpty(v),j=!x.a.isEmpty(N),O=[];return r.isGRP&&(_&&_.adultPrice>0&&b&&O.push({resourceName:"\u6210\u4eba",price:"\xa5 ".concat(_.adultPrice),countText:"x ".concat(b,"\u4eba")}),_&&_.childPrice>0&&I&&O.push({resourceName:"\u513f\u7ae5",price:"\xa5 ".concat(_.childPrice),countText:"x ".concat(I,"\u4eba")})),{title:T,titlePrice:k,tips:S,isShowClauseList:j,isCruiseShowCostInfo:P,renderList:O}}({priceDetail:e.priceDetail,productInfo:n,pageStatus:r,props:e})},Qr=function(e){var t=Xr.useState((function(e){return{productInfo:e.productInfo,pageStatus:e.pageStatus}})),n=t.productInfo,r=t.pageStatus;return function(e){var t=e.priceDetail,n=e.props;if(x.a.isEmpty(t))return null;var r=t.tradePriceDetailList,a=void 0===r?[]:r,o=t.priceDetailList,i=void 0===o?[]:o,s=(t.totalPrice,n.isBestone?a:i),c=null==s?void 0:s.find((function(e){return e.priceType===Hr})),l=c||{},u=l.priceName,d=l.resourcePriceDetailList,f=void 0===d?[]:d,p=l.totalPrice;if(x.a.isEmpty(c)||x.a.isEmpty(f))return null;var m=(p||{}).shopPayPrice||{},h=m.price,v=m.currencyCode,g=void 0===v?"":v,y=u,_="\xa5 ".concat(p.totalPrice);h&&(_+="\uff0c\u8239\u4e0a\u53e6\u4ed8".concat(h||0).concat(g));var b=[];return null==f||f.forEach((function(e){var t=e.tag,n=void 0===t?[]:t,r=e.count,a=void 0===r?0:r,o=e.shopPayPrice,i=e.resourceType,s=e.resourceName,c=o||{},l=c.price,u=c.currencyCode,d=12===i&&!!l,f=(null==n?void 0:n.find((function(e){return"firstFree"===e.key})))||"",p="";f&&(p+="\u514d\u8d39 x 1 + "),p+=d?"\u8239\u4e0a\u53e6\u4ed8 ".concat(l||0).concat(u):"\xa5 ".concat(e.adultPrice);var m="x ".concat(f?a-1:a).concat(e.chargeUnit);b.push({resourceName:s,price:p,countText:m})})),{title:y,titlePrice:_,renderList:b}}({priceDetail:e.priceDetail,productInfo:n,pageStatus:r,props:e})},ea=function(e){var t=Xr.useState((function(e){return{productInfo:e.productInfo,pageStatus:e.pageStatus}})),n=t.productInfo,r=t.pageStatus;return function(e){var t=e.priceDetail,n=e.props;if(x.a.isEmpty(t))return null;var r=t.priceDetailList,a=void 0===r?[]:r,o=t.tradePriceDetailList,i=void 0===o?[]:o,s=(t.totalPrice,n.isBestone?i:a),c=null==s?void 0:s.find((function(e){return e.priceType===Gr})),l=c||{},u=l.priceName,d=l.resourcePriceDetailList,f=void 0===d?[]:d,p=l.totalPrice;if(x.a.isEmpty(c)||x.a.isEmpty(f))return null;var m=u;"resource"===n.pageName&&(m+="(\u53ef\u81f3\u8ba2\u5355\u586b\u5199\u9875\u67e5\u770b/\u4fee\u6539)"),"order"===n.pageName&&n.insuranceProps.hasAgeRules&&p.totalPrice&&(m+="(\u4ee5\u5b9e\u9645\u9884\u8ba2\u4eba\u5e74\u9f84\u8ba1\u7b97\u4ef7\u683c)");var h="\xa5 ".concat(p.totalPrice?p.totalPrice:"0"),v=[];"resource"===n.pageName&&v.push("\u4fdd\u9669\u4e3a\u529e\u7b7e\u5fc5\u9700\u6750\u6599\uff0c\u53ef\u81f3\u8ba2\u5355\u586b\u5199\u9875\u67e5\u770b\uff0c\u6709\u7591\u95ee\u53ef\u8054\u7cfb\u5ba2\u670d");var g={};null==f||f.forEach((function(e){var t=e.tag,n=void 0===t?[]:t,r=e.token,a=null==n?void 0:n.filter((function(e){return["vip_cancel","level_cancel"].includes(e.key)}));x.a.isEmpty(a)&&(g[r]=g[r]||[],g[r].push(e))}));var y=[];return Object.values(g).forEach((function(e,t){var n=e[0],r=(n.tag,n.resourceName);if(n.count,e.length>1||e[0].groupType){var a=e.map((function(e){return{tag:e.adultPrice?"":"\u8d60",name:e.groupName,price:"".concat(e.adultPrice?"\xa5 "+e.adultPrice:"\xa5 0"),countText:" x ".concat(e.count).concat(e.chargeUnit)}}));y.push({resourceName:r,list:a})}else y.push({resourceName:r,price:"".concat(e[0].adultPrice?"\xa5 "+e[0].adultPrice:"\xa5 0"),countText:" x ".concat(e[0].count).concat(e[0].chargeUnit),tag:e[0].adultPrice?"":"\u8d60"})})),y.length?{title:m,titlePrice:h,tips:v,renderList:y}:null}({priceDetail:e.priceDetail,productInfo:n,pageStatus:r,props:e})},ta=function(e){var t=Xr.useState((function(e){return{productInfo:e.productInfo,pageStatus:e.pageStatus}})),n=t.productInfo,r=t.pageStatus;return function(e){var t=e.priceDetail,n=e.props;if(x.a.isEmpty(t))return null;var r=t.priceDetailList,a=void 0===r?[]:r,o=t.tradePriceDetailList,i=void 0===o?[]:o,s=(t.totalPrice,n.isBestone?i:a),c=null==s?void 0:s.find((function(e){return e.priceType===Kr})),l=c||{},u=l.priceName,d=l.resourcePriceDetailList,f=void 0===d?[]:d;if(l.totalPrice,x.a.isEmpty(c)||x.a.isEmpty(f))return null;var p=u,m=[];return null==f||f.forEach((function(e){var t=e.resourceName,n="\xa5 ".concat(Math.abs(e.adultPrice)),r=" x ".concat(e.count).concat(e.chargeUnit);m.push({tag:"\u8d60",resourceName:t,price:n,countText:r})})),{title:p,titlePrice:"\xa5 0",renderList:m}}({priceDetail:e.priceDetail,productInfo:n,pageStatus:r,props:e})},na=function(e){var t=Xr.useState((function(e){return{productInfo:e.productInfo,pageStatus:e.pageStatus}})),n=t.productInfo,r=t.pageStatus;return function(e){var t=e.priceDetail,n=e.props;if(x.a.isEmpty(t))return null;var r=t.priceDetailList,a=void 0===r?[]:r,o=t.tradePriceDetailList,i=void 0===o?[]:o,s=(t.totalPrice,n.isBestone?i:a),c=null==s?void 0:s.find((function(e){return e.priceType===zr})),l=c||{},u=l.priceName,d=l.resourcePriceDetailList,f=void 0===d?[]:d,p=l.totalPrice;if(!c||x.a.isEmpty(f))return null;var m=u,h="- \xa5 ".concat(Math.abs(p.totalPrice)),v=[];return null==f||f.forEach((function(e){var t=e.resourceName,n="- \xa5 ".concat(Math.abs(e.adultPrice)),r=" x ".concat(e.count).concat(e.chargeUnit);v.push({tag:"\u51cf",resourceName:t,price:n,countText:r})})),{title:m,titlePrice:h,renderList:v}}({priceDetail:e.priceDetail,productInfo:n,pageStatus:r,props:e})},ra=function(e){var t=e.color,n=void 0===t?"#E6E6E6":t,r=e.width,a=void 0===r?1:r;return v.a.createElement($e.View,{style:{borderBottomColor:n,borderBottomWidth:a,borderBottomStyle:"dashed"}})},aa=v.a.memo(ra),oa={levelWrapper:"_1pz6lxn0",levelText:"_1pz6lxn1",defaultText:"_1pz6lxn2",glodDiamondView:"_1pz6lxn3",commonView:"_1pz6lxn4",levelView40:"_1pz6lxn5",levelView30:"_1pz6lxn6",levelView20:"_1pz6lxn7",levelView999:"_1pz6lxn8"},ia=n(12),sa=["0","1","2","3","10","35","-1","10008"],ca=["0","1","2","3","10","35","-1","10008","40","30","20","999"],la=v.a.memo(ua);function ua(e){var t=e.code,n=e.text,r=e.type;if(!ca.includes(t))return v.a.createElement($e.Text,{className:oa.defaultText},n);var a=[];return sa.includes(t)?"vip"===r?a.push(oa.glodDiamondView):a.push(oa.commonView):a.push(oa["levelView".concat(t)]),v.a.createElement($e.View,{className:Object(ia.a)(oa.levelWrapper,a)},v.a.createElement($e.Text,{className:Object(ia.a)(oa.levelText)},n))}var da="_614b1b0",fa="_614b1b1",pa="_614b1b2",ma=v.a.memo((function(e){var t=e.isShow,n=e.costInfoList,r=e.onClose,a=e.zIndex;if(Object(K.c)(n))return null;var o=Object.values(n||{}),i=ut({footer:!1,safeArea:!0});return v.a.createElement(ft,{show:t,title:"\u8d39\u7528\u8bf4\u660e",handleClose:r,safeArea:!1,zIndex:a},v.a.createElement($e.ScrollView,{className:da,style:Object.assign({},i)},o.map((function(e){return v.a.createElement($e.View,{key:e.TitleCode},v.a.createElement($e.View,{className:fa},v.a.createElement($e.Text,{className:pa},e.Category)),v.a.createElement($e.View,null,!!e.DescriptionList&&e.DescriptionList.map((function(e,t){return e=e&&e.replace(/\n/g,"")||"",v.a.createElement(et,{key:t,content:"".concat(t+1,". ").concat(e)})}))))}))))})),ha=v.a.memo(ma),va="_1tczcnw0",ga="_1tczcnw2",ya="_1tczcnw3",_a="_1tczcnw4",ba="_1tczcnw5",Ia="_1tczcnw6",xa="_1tczcnw8",Ta="_1tczcnw9",ka="_1tczcnwa",Sa="_1tczcnwb",Ca="_1tczcnwc",wa="_1tczcnwd",Na="_1tczcnwf",Ea="_1tczcnwh",Pa="_1tczcnwi",ja=function(e){var t=e.priceDetail,n=e.pageName,r=e.isShow,a=e.cacheKey,o=e.onClose,i=e.zIndex,s=e.bottomDistance,c=Xr.useState((function(e){return{isShowFeeIncludeMask:e.isShowFeeIncludeMask,isShowCostInfoMask:e.isShowCostInfoMask,productInfo:e.productInfo}})),l=c.isShowFeeIncludeMask,u=c.isShowCostInfoMask,d=c.productInfo,f=Xr.useActions(),p=f.toggleFeeIncludeMask,m=f.toggleCostInfoMask,g=f.handleWriteDiscountLog;if(Object(h.useEffect)((function(){g(e)}),[e.priceDetail]),!t)return null;var y=s||60,_=d||{},b=_.CostInfoList,I=(_.BasicInfo||{}).isStudy,x=ut({footer:!1,safeArea:!0}),T=null;return T="resource"===n?v.a.createElement(v.a.Fragment,null,v.a.createElement(Oa,Object.assign({},e)),v.a.createElement(Da,Object.assign({},e)),v.a.createElement(Aa,Object.assign({},e)),v.a.createElement(Ra,Object.assign({},e)),v.a.createElement(La,Object.assign({},e)),v.a.createElement(Ma,Object.assign({},e))):v.a.createElement(v.a.Fragment,null,v.a.createElement(Oa,Object.assign({},e)),v.a.createElement(Da,Object.assign({},e)),v.a.createElement(Va,Object.assign({},e)),v.a.createElement(Aa,Object.assign({},e)),v.a.createElement(Ra,Object.assign({},e)),v.a.createElement(La,Object.assign({},e)),v.a.createElement(Ma,Object.assign({},e)),"function"==typeof e.customContent?e.customContent():e.customContent),v.a.createElement(v.a.Fragment,null,v.a.createElement(ft,{show:r,title:"\u91d1\u989d\u660e\u7ec6",handleClose:o,zIndex:i},v.a.createElement($e.ScrollView,{scrollY:!0,className:ga,style:Object.assign({marginBottom:y},x)},T)),v.a.createElement(gn,{isShow:l,type:I?"child":"adult",onClose:function(){return p(!1)},cacheKey:a,zIndex:i+1}),v.a.createElement(ha,{isShow:u,costInfoList:b,onClose:function(){return m(!1)},zIndex:i+1}))},Oa=Object(h.memo)((function(e){var t=Jr(e),n=Xr.useState((function(e){return{isShowFeeIncludeMask:e.isShowFeeIncludeMask,isShowCostInfoMask:e.isShowCostInfoMask,productInfo:e.productInfo}})),r=(n.isShowFeeIncludeMask,n.isShowCostInfoMask,n.productInfo),a=Xr.useActions(),o=a.toggleFeeIncludeMask,i=a.toggleCostInfoMask;if(e.isShow,e.cacheKey,x.a.isEmpty(t))return null;r.CostInfoList;var s=t.title,c=t.titlePrice,l=t.isShowClauseList,u=t.isCruiseShowCostInfo,d=t.tips,f=t.renderList;return v.a.createElement($e.View,{className:ya},v.a.createElement($e.View,{className:_a},l||u?v.a.createElement(Xe,{onPress:function(){l?o(!0):u&&i(!0)},className:va},v.a.createElement($e.Text,{className:Ia},s),v.a.createElement(at,{size:"30",lineHeight:"38",isIcon:!0,style:{marginLeft:5}},"\ue931")):v.a.createElement($e.View,{className:va},v.a.createElement($e.Text,{className:Ia},s)),v.a.createElement($e.View,{className:ba},v.a.createElement(aa,null)),v.a.createElement($e.Text,{className:Ia},c)),d.map((function(e,t){return v.a.createElement($e.View,{key:t,className:xa},v.a.createElement($e.Text,{className:Ta},e))})),f.map((function(e,t){return v.a.createElement($e.View,{key:t,className:ka},v.a.createElement($e.View,{className:Na},v.a.createElement($e.Text,{className:Ca},e.resourceName)),v.a.createElement($e.View,{className:va},v.a.createElement($e.View,{className:wa},v.a.createElement($e.Text,{className:Object(ia.a)([Ca])},e.price)),v.a.createElement($e.Text,{className:Ca},e.countText)))})))})),Da=Object(h.memo)((function(e){var t=Qr(e);if(x.a.isEmpty(t))return null;var n=t.title,r=t.titlePrice,a=t.renderList;return v.a.createElement($e.View,{className:ya},v.a.createElement($e.View,{className:_a},v.a.createElement($e.Text,{className:Ia},n),v.a.createElement($e.View,{className:ba},v.a.createElement(aa,null)),v.a.createElement($e.Text,{className:Ia},r)),v.a.createElement($e.View,null,a.map((function(e,t){var n=e.resourceName,r=e.price,a=e.countText;return v.a.createElement($e.View,{key:t,className:ka},v.a.createElement($e.View,{className:Na},v.a.createElement($e.Text,{className:Ca},n)),v.a.createElement($e.View,{className:va},v.a.createElement($e.View,{className:wa},v.a.createElement($e.Text,{className:Object(ia.a)([Ca])},r)),v.a.createElement($e.Text,{className:Ca},a)))}))))})),Ra=Object(h.memo)((function(e){var t=function(e){var t=Xr.useState((function(e){return{productInfo:e.productInfo,pageStatus:e.pageStatus}})),n=t.productInfo,r=t.pageStatus,a=e.priceDetail;return Wr({priceDetail:a,productInfo:n,pageStatus:r,props:e})}(e);if(x.a.isEmpty(t))return null;var n=t.title,r=t.titlePrice,a=t.renderList;return v.a.createElement($e.View,{className:ya},v.a.createElement($e.View,{className:_a},v.a.createElement($e.Text,{className:Ia},n),v.a.createElement($e.View,{className:ba},v.a.createElement(aa,null)),v.a.createElement(at,{size:"30",lineHeight:"38",weight:"500",color:"#f70"},r)),v.a.createElement($e.View,null,a.map((function(e,t){var n=e.groupDiscount,r=e.vipDiscount,a=e.notDiscount,o=e.resourceName,i=e.price,s=e.countText,c=null;return x.a.isEmpty(n)||(c=v.a.createElement(la,{code:n.code,text:o})),x.a.isEmpty(r)||(c=v.a.createElement(v.a.Fragment,null,v.a.createElement(la,{code:r.code,text:r.text,type:"vip"}),v.a.createElement($e.Text,{className:Ca,style:{paddingLeft:4}},o))),a&&(c=v.a.createElement($e.Text,{className:Ca},o)),v.a.createElement($e.View,{key:t,className:ka},v.a.createElement(Ba,null,"\u60e0"),v.a.createElement($e.View,{className:Na},c),v.a.createElement($e.View,{className:va},v.a.createElement($e.View,{className:wa},v.a.createElement($e.Text,{className:Object(ia.a)([Ca])},i)),v.a.createElement($e.Text,{className:Ca},s)))}))))})),Aa=Object(h.memo)((function(e){var t=ea(e);if(x.a.isEmpty(t))return null;var n=t.title,r=t.titlePrice,a=t.renderList;return v.a.createElement($e.View,{className:ya},v.a.createElement($e.View,{className:_a},v.a.createElement($e.Text,{className:Ia},n),v.a.createElement($e.View,{className:ba},v.a.createElement(aa,null)),v.a.createElement($e.Text,{className:Ia},r)),v.a.createElement($e.View,null,a.map((function(e,t){var n;if(null===(n=null==e?void 0:e.list)||void 0===n?void 0:n.length){var r=e.resourceName,a=e.list;return v.a.createElement($e.View,{key:t},v.a.createElement($e.View,{className:ka},v.a.createElement($e.Text,{className:Ca},r)),a.map((function(e,t){e.tag;var n=e.name,r=e.price,a=e.countText;return v.a.createElement($e.View,{key:t,className:Sa},v.a.createElement($e.View,{className:Na},v.a.createElement($e.Text,{className:Ca},n)),v.a.createElement($e.View,{className:va},v.a.createElement($e.View,{className:wa},v.a.createElement($e.Text,{className:Object(ia.a)([Ca])},r)),v.a.createElement($e.Text,{className:Ca},a)))})))}var o=e.resourceName,i=e.price,s=e.countText,c=e.tag;return v.a.createElement($e.View,{key:t,className:ka},!!c&&v.a.createElement(Ba,null,c),v.a.createElement($e.View,{className:Na},v.a.createElement($e.Text,null,v.a.createElement($e.Text,{className:Ca},o))),v.a.createElement($e.View,{className:va},v.a.createElement($e.View,{className:wa},v.a.createElement($e.Text,{className:Object(ia.a)([Ca])},i)),v.a.createElement($e.Text,{className:Ca},s)))}))))})),Ma=Object(h.memo)((function(e){var t=ta(e);if(x.a.isEmpty(t))return null;var n=t.title,r=t.titlePrice,a=t.renderList;return v.a.createElement($e.View,{className:ya},v.a.createElement($e.View,{className:_a},v.a.createElement($e.Text,{className:Ia},n),v.a.createElement($e.View,{className:ba},v.a.createElement(aa,null)),v.a.createElement($e.Text,{className:Ia},r)),v.a.createElement($e.View,null,a.map((function(e,t){var n=e.resourceName,r=e.price,a=e.countText;return v.a.createElement($e.View,{key:t,className:ka},v.a.createElement($e.View,{className:Na},v.a.createElement($e.Text,{className:Ca},n)),v.a.createElement($e.View,{className:va},v.a.createElement($e.View,{className:wa},v.a.createElement($e.Text,{className:Object(ia.a)([Ca])},r)),v.a.createElement($e.Text,{className:Ca},a)))}))))})),Va=Object(h.memo)((function(e){var t=(e.freightProps||{}).freightPrice;return t?v.a.createElement($e.View,{className:ya},v.a.createElement($e.View,{className:_a},v.a.createElement($e.Text,{className:Ia},"\u914d\u9001\u8d39"),v.a.createElement($e.View,{className:ba},v.a.createElement(aa,null)),v.a.createElement($e.Text,{className:Ia},"\xa5 ".concat(t)))):null})),La=Object(h.memo)((function(e){var t=na(e);if(x.a.isEmpty(t))return null;var n=t.title,r=t.titlePrice,a=t.renderList;return v.a.createElement($e.View,{className:ya},v.a.createElement($e.View,{className:_a},v.a.createElement($e.Text,{className:Ia},n),v.a.createElement($e.View,{className:ba},v.a.createElement(aa,null)),v.a.createElement(at,{size:"30",lineHeight:"38",weight:"500",color:"#f70"},r)),v.a.createElement($e.View,null,a.map((function(e,t){var n=e.resourceName,r=e.price,a=e.countText,o=e.tag;return v.a.createElement($e.View,{key:t,className:ka},v.a.createElement(Ba,null,o),v.a.createElement($e.View,{className:Na},v.a.createElement($e.Text,{className:Ca},n)),v.a.createElement($e.View,{className:va},v.a.createElement($e.View,{className:wa},v.a.createElement($e.Text,{className:Object(ia.a)([Ca])},r)),v.a.createElement($e.Text,{className:Ca},a)))}))))})),Ba=function(e){return v.a.createElement($e.View,{className:Ea},v.a.createElement($e.Text,{className:Pa},e.children))},Ua=Object(h.memo)(ja),Za=v.a.memo(Fa);function Fa(e){return v.a.createElement(Ga,Object.assign({},e),v.a.createElement(Ua,Object.assign({},e)))}function Ga(e){var t=Object(h.useMemo)((function(){var t=[I.PlatformContext.create({}),I.TourContext.create(Object.assign(Object.assign({},We().tourContext),{props:e,pageName:e.pageName}))];return r.mergeModelContext.apply(void 0,t)}),[]);return v.a.createElement(Xr.Provider,{context:t},e.children)}var Ha={UPDATE_TARIN_BOOK_NOTE:function(e,t){return Object.assign(Object.assign({},e),t)}},qa="\nquery TrainBooknote($params: BookParams) {\n    BookList(params: $params) {\n        bookList\n\n    }\n}\n",Ka=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=(null==t?void 0:t.find((function(e){return"\u513f\u7ae5\u7968"===e.type})))||{},r=[];return n&&n.content&&(null===(e=n.content)||void 0===e||e.forEach((function(e){var t=(e||{}).detailList,n=void 0===t?[]:t,a=(null==n?void 0:n.some((function(e){return 2===e.detailType})))||!1;r.push(Object.assign(Object.assign({},e),{type:a?"table":"text"}))}))),{trainChildNoticeList:r}},za={trainChildNoticeList:[]},Ya=Object(a.createReactModel)((function(){var e=Object(I.setupTourContext)(),t=e.props,n=Object(r.setupStore)({name:"isomorphic_train_child_notice_components",initialState:za,reducers:Ha,logger:K.b&&!K.d}),a=n.store,o=n.actions,i=function(e,t){return{fetchTrainHeightInfo:function(){var n=b(y().mark((function n(){var r,a,o,i,s,c,l,u,f,p,m,h,v,g,_,b,I;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,s=t.shoppingId){n.next=4;break}throw new Error("\u7f3a\u5c11 shoppingId");case 4:return c=qa,l=e.attachShardParams(),u=String(l.Version),f={params:{shoppingId:s,clientParams:{appType:"app",appVersion:u}}},p={isDiy:!0},m=Date.now(),n.next=13,e.createGqlRequest(c,f,"fetchTrainHeightInfo",p).fetch();case 13:if(h=n.sent,v=h.data,g=h.extensions,"Success"===(null===(a=null===(r=null==g?void 0:g.SoaResponseStatus)||void 0===r?void 0:r.ResponseStatus)||void 0===a?void 0:a.Ack)){n.next=18;break}throw new Error("fetchTrainHeightInfo");case 18:if(_=Date.now(),e.traceKMLogAction({attrs:[{key:"shoppingId",value:String(s)}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"fetchTrainHeightInfo",role:d.RoleType.sys,action:d.ActionType.show,value:"".concat(_-m,"ms"),rootMessageId:Object(K.a)(null===(i=null===(o=null==g?void 0:g.SoaResponseStatus)||void 0===o?void 0:o.ResponseStatus)||void 0===i?void 0:i.Extension)}),b=v.BookList,I=void 0===b?{}:b,!Object(K.c)(I)){n.next=23;break}throw new Error("\u8282\u70b9\u4e0d\u5b8c\u6574");case 23:return n.abrupt("return",(null==I?void 0:I.bookList)||[]);case 26:return n.prev=26,n.t0=n.catch(0),n.t0.isNetError||e.traceKMLogError({pageName:"order",message:"fetchTrainHeightInfo->".concat(null===n.t0||void 0===n.t0?void 0:n.t0.message),errorType:d.ErrorType.Ack_Fail,ex:n.t0}),console.error("fetchTrainHeightInfo->".concat(null===n.t0||void 0===n.t0?void 0:n.t0.message)),n.abrupt("return",!1);case 31:case"end":return n.stop()}}),n,null,[[0,26]])})));return function(){return n.apply(this,arguments)}}()}}(e,t);Object(r.setupPreloadCallback)(b(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));var s=function(){var e=b(y().mark((function e(){var t,n,r,s;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.getState(),n=t.trainChildNoticeList,Object(K.c)(n)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,i.fetchTrainHeightInfo();case 5:if(r=e.sent){e.next=8;break}return e.abrupt("return");case 8:s=Ka(r),(0,o.UPDATE_TARIN_BOOK_NOTE)(s);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{store:a,actions:Object.assign(Object.assign({},o),{handleInitTrainChildNotice:s})}})),Wa="h9id8d1",$a="h9id8d2",Xa="h9id8d3",Ja="h9id8d4",Qa="h9id8d5",eo="h9id8d6",to="h9id8d0 h9id8d7",no="h9id8d0 h9id8d9",ro="h9id8d0 h9id8db",ao="h9id8d0 h9id8dd";function oo(e){var t=Ya.useState((function(e){return{trainChildNoticeList:e.trainChildNoticeList}})).trainChildNoticeList,n=e.isShow,r=e.onClose,a=e.zIndex,o=void 0===a?0:a,i=Ya.useActions().handleInitTrainChildNotice;if(Object(h.useEffect)((function(){n&&i()}),[n]),x.a.isEmpty(t))return null;var s=ut({top:45,footer:!1,safeArea:!1});return v.a.createElement(ft,{title:"\u513f\u7ae5\u7968\u987b\u77e5",show:n,handleClose:r,zIndex:o},v.a.createElement($e.ScrollView,{scrollY:!0,className:Wa,style:s},t.map((function(e,t){var n;return v.a.createElement($e.View,{className:$a,key:t},v.a.createElement($e.View,{className:Xa},e.title),"text"===e.type&&e.detailList.map((function(e,t){var n=e.detail;return n?v.a.createElement($e.View,{className:Ja,key:t},n):null})),"table"===e.type&&!!(null===(n=e.detailList)||void 0===n?void 0:n.length)&&v.a.createElement($e.View,{key:t,className:Qa},e.detailList.map((function(e,t){var n,r;if(e.isHead&&e.detail.length)return v.a.createElement($e.View,{className:eo,style:{background:"#f6f8fa"},key:t},null===(n=e.detail)||void 0===n?void 0:n.map((function(e,t){var n=0===t;return v.a.createElement($e.View,{className:n?no:to,key:t},e)})));if(!e.isHead&&(null===(r=e.detail)||void 0===r?void 0:r.length)){var a=1===t,o=2===t;return v.a.createElement($e.View,{className:eo,key:t},e.detail.map((function(e,t){var n=$t(e),r=0===t,i=1===t,s="#333333";return a&&i&&(s="rgb(0, 184, 122)"),o&&i&&(s="rgb(255, 119, 0)"),v.a.createElement($e.View,{className:r?ao:ro,key:t,style:{color:s}},n)})))}return null}))))}))))}var io=v.a.memo(so);function so(e){return Object(h.useEffect)((function(){n(124)}),[]),v.a.createElement(co,Object.assign({},e),v.a.createElement(oo,Object.assign({},e)))}function co(e){var t=Object(h.useMemo)((function(){var t=[I.PlatformContext.create({}),I.TourContext.create(Object.assign(Object.assign({},We().tourContext),{props:e}))];return r.mergeModelContext.apply(void 0,t)}),[]);return v.a.createElement(Ya.Provider,{context:t},e.children)}var lo=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=e.imInfo,o=a.imServiceTime,i=a.imSwitch,s=t.BasicInfo;if(!i)return null;var c="";if("\u5546\u5bb6"===(null===(n=null==e?void 0:e.serviceInfo)||void 0===n?void 0:n.shortServiceToast)){var l="\u5546\u5bb6\u5ba2\u670d";c="".concat(l,"\u4e13\u5458\u63d0\u4f9b\u5728\u7ebf\u670d\u52a1\uff0c\u89e3\u7b54\u5ea6\u5047\u76f8\u5173\u95ee\u9898")}else{var u="\u643a\u7a0b\u5ba2\u670d";c="R"===s.SaleMode?"\u5ba2\u670d\u4e13\u5458\u63d0\u4f9b\u5728\u7ebf\u670d\u52a1\uff0c\u89e3\u7b54\u5ea6\u5047\u76f8\u5173\u95ee\u9898":s.isCruise?"".concat(u,"\u4e13\u5458\u63d0\u4f9b\u5728\u7ebf\u670d\u52a1\uff0c\u975e\u5de5\u4f5c\u65f6\u95f4\u53ef\u62e8\u6253\u7535\u8bdd\u8054\u7cfb\u6211\u4eec"):"".concat(u,"\u4e13\u5458\u63d0\u4f9b\u5728\u7ebf\u670d\u52a1\uff0c\u89e3\u7b54\u5ea6\u5047\u76f8\u5173\u95ee\u9898")}return o&&(c="\u670d\u52a1\u65f6\u95f4\uff1a".concat(o,"\n").concat(c)),{itemDescription:c,itemType:"IM",jumpUrl:r}},uo=function(e,t){var n=e.imInfo,r=n.mobileServiceTime,a=n.mobile,o=n.mobileCode,i=n.inquiry,s=t.BasicInfo;if(!i)return null;var c=a;if(o&&(c="".concat(a,",").concat(o)),!c)return null;c=String(c).split("-").join("");var l="";return s.isCruise?l="\u670d\u52a1\u65f6\u95f4 9:00-18:00\n\u7535\u8bdd\u63a5\u901a\u540e\uff0c\u8bf7\u544a\u77e5\u5ba2\u670d\u4ea7\u54c1\u7f16\u53f7: ".concat(s.ProductId):(l="\u7535\u8bdd\u63a5\u901a\u540e\uff0c\u8bf7\u544a\u77e5\u5ba2\u670d\u4ea7\u54c1\u7f16\u53f7: ".concat(s.ProductId),r&&(l="\u670d\u52a1\u65f6\u95f4\uff1a".concat(r,"\n").concat(l))),{itemTitle:"\u552e\u524d\u54a8\u8be2",itemDescription:l,itemLightDescriptionList:["".concat(s.ProductId)],destinationNumber:a,channelNumber:o||"",destinationNumberDisplay:c,itemType:"PSTN",locationGlobalId:"1",locationName:"\u4e2d\u56fd"}},fo=function(e,t){var n=e.imInfo,r=n.afterSaleServiceTime,a=n.afterSaleTel,o=n.afterSaleExtTel,i=n.mobileCode;if(!n.inquiry)return null;var s=a;if(i&&(s="".concat(a,",").concat(o)),!s)return null;s=String(s).split("-").join("");var c="\u5982\u60a8\u8ba2\u5355\u5df2\u63d0\u4ea4\uff0c\u53ef\u8054\u7cfb\u552e\u540e\u5ba2\u670d\u67e5\u8be2\u53ca\u4fee\u6539";return r&&(c="\u670d\u52a1\u65f6\u95f4\uff1a".concat(r,"\n").concat(c)),{itemTitle:"\u552e\u540e\u54a8\u8be2",itemDescription:c,itemLightDescriptionList:[],destinationNumber:a,channelNumber:o||"",destinationNumberDisplay:s,itemType:"PSTN",locationGlobalId:"1",locationName:"\u4e2d\u56fd"}},po={UPDATE_PRODUCT_INFO:function(e,t){var n=t.BasicInfo,r=t.aliasInfo;return Object.assign(Object.assign({},e),{productInfo:{BasicInfo:n,aliasInfo:r}})},UPDATE_CUSTOMER_SERVICE:function(e,t){return Object.assign(Object.assign({},e),{customerService:t})}},mo=Object(a.createReactModel)((function(){var e=Object(I.setupTourContext)(),t=e.props,n=Object(r.setupStore)({name:"isomorphic_fee_include_components",initialState:{customerService:[]},reducers:po,logger:K.b&&!K.d&&!!t.logger}),a=n.store,o=n.actions,i=X(e),s=i.getProductInfo,c=i.fetchProductInfo;Object(r.setupPreloadCallback)(b(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:if(t=e.sent){e.next=6;break}return console.error("\u5ba2\u670d\u7ec4\u4ef6: \u7f3a\u5c11productInfo"),e.abrupt("return");case 6:o.UPDATE_PRODUCT_INFO(t);case 7:case"end":return e.stop()}}),e)}))));var l=function(){var e=b(y().mark((function e(){var n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.next=3,s(t.cacheKey);case 3:if(!(n=e.sent)){e.next=6;break}return e.abrupt("return",n);case 6:return e.prev=6,r=J(t.cacheKey),e.next=10,c(r);case 10:return n=e.sent,e.abrupt("return",n);case 14:return e.prev=14,e.t0=e.catch(6),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(){return e.apply(this,arguments)}}();return{store:a,actions:Object.assign(Object.assign({},o),{initCustomerService:function(e){var t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(Object(K.c)(e)||Object(K.c)(null==t?void 0:t.BasicInfo))return[];var r=[],a=lo(e,t,n);a&&r.push({consultItemDataList:[a],moduleTitle:"\u8054\u7cfb\u5728\u7ebf\u5ba2\u670d"});var o=uo(e,t),i=fo(e,t);if(o||i){var s=[];o&&s.push(o),i&&s.push(i),r.push({consultItemDataList:s,moduleTitle:"\u62e8\u6253\u5ba2\u670d\u7535\u8bdd"})}return r}(e,a.getState().productInfo);o.UPDATE_CUSTOMER_SERVICE(t)}})}})),ho="_4w00g0",vo="_4w00g1",go="_4w00g2",yo="_4w00g3",_o="_4w00g4",bo="_4w00g5";function Io(e){var t=e.isShow,n=e.onClose,r=e.imEntryInfo,a=e.onJumpIM,o={customerService:mo.useState((function(e){return{customerService:e.customerService}})).customerService}.customerService,i=mo.useActions().initCustomerService;if(Object(h.useEffect)((function(){t&&i(r)}),[r,t]),Object(K.c)(o))return null;var s=ut({top:0,footer:!1,safeArea:!0});return v.a.createElement(ft,{title:"\u8054\u7cfb\u5ba2\u670d",handleClose:n,show:t,zIndex:999},v.a.createElement($e.ScrollView,{scrollY:!0,scrollWithAnimation:!0,style:s},v.a.createElement($e.View,{className:ho},o.map((function(e,t){return v.a.createElement(v.a.Fragment,{key:t},t>0&&v.a.createElement($e.View,{className:go}),v.a.createElement($e.View,{className:vo},v.a.createElement(at,{size:"32",lineHeight:"36",color:"#333",weight:"500"},e.moduleTitle),e.consultItemDataList.map((function(e,t){var n=e.itemType;return"IM"===n?v.a.createElement(xo,{key:t,item:e,onJumpIM:a}):"PSTN"===n?v.a.createElement(To,{key:t,item:e}):null}))))})))))}function xo(e){var t=e.item,n=e.onJumpIM,r=t.itemDescription.split("\n");return v.a.createElement(Xe,{className:yo,onPress:function(){n&&n()}},v.a.createElement($e.View,null,r.map((function(e,t){return v.a.createElement(at,{key:t,size:"26",lineHeight:"38",color:"#aaa",block:!0,style:{marginTop:6}},e)}))),v.a.createElement($e.View,{className:bo}))}function To(e){var t=e.item,n=t.itemTitle,r=t.itemDescription,a=t.itemLightDescriptionList,o=(t.channelNumber,t.destinationNumber),i=(t.destinationNumberDisplay,t.locationGlobalId,t.locationName,r.split("\n")),s=[];return i.forEach((function(e){var t=null==a?void 0:a.find((function(t){return e.includes(t)}));if(t){var n=e.indexOf(t),r=e.substring(0,n),o=e.substring(n,n+t.length),i=e.substring(n+t.length),c=[];r&&c.push({text:r,color:"#aaa"}),o&&c.push({text:o,color:"#333"}),i&&c.push({text:i,color:"#aaa"}),s.push(c)}else s.push([{text:e,color:"#aaa"}])})),v.a.createElement(Xe,{onPress:function(){Ne.a.makePhoneCall({phoneNumber:o})}},v.a.createElement(at,{size:"28",lineHeight:"38",color:"#333",block:!0,style:{marginTop:12}},n),v.a.createElement($e.View,{className:yo},v.a.createElement($e.View,null,s.map((function(e,t){return v.a.createElement(at,{key:t,size:"26",lineHeight:"38",color:"#aaa",block:!0,style:{marginTop:6}},e.map((function(e,t){return v.a.createElement(at,{key:t,size:"26",lineHeight:"38",color:e.color},e.text)})))}))),v.a.createElement($e.View,{className:_o})))}var ko=v.a.memo(So);function So(e){return v.a.createElement(Co,Object.assign({},e),v.a.createElement(Io,Object.assign({},e)))}function Co(e){var t=Object(h.useMemo)((function(){var t=[I.PlatformContext.create({}),I.TourContext.create(Object.assign(Object.assign({},We().tourContext),{props:e}))];return r.mergeModelContext.apply(void 0,t)}),[]);return v.a.createElement(mo.Provider,{context:t},e.children)}},function(e,t,n){"use strict";n.r(t),n.d(t,"__DO_NOT_USE__ActionTypes",(function(){return u})),n.d(t,"applyMiddleware",(function(){return y})),n.d(t,"bindActionCreators",(function(){return v})),n.d(t,"combineReducers",(function(){return m})),n.d(t,"compose",(function(){return g})),n.d(t,"createStore",(function(){return f})),n.d(t,"legacy_createStore",(function(){return p}));var r=n(7),a=n(15);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var c="function"==typeof Symbol&&Symbol.observable||"@@observable",l=function(){return Math.random().toString(36).substring(7).split("").join(".")},u={INIT:"@@redux/INIT"+l(),REPLACE:"@@redux/REPLACE"+l(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+l()}};function d(e){if("object"!==Object(r.a)(e)||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function f(e,t,n){var a;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(s(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(s(1));return n(f)(e,t)}if("function"!=typeof e)throw new Error(s(2));var o=e,i=t,l=[],p=l,m=!1;function h(){p===l&&(p=l.slice())}function v(){if(m)throw new Error(s(3));return i}function g(e){if("function"!=typeof e)throw new Error(s(4));if(m)throw new Error(s(5));var t=!0;return h(),p.push(e),function(){if(t){if(m)throw new Error(s(6));t=!1,h();var n=p.indexOf(e);p.splice(n,1),l=null}}}function y(e){if(!d(e))throw new Error(s(7));if(void 0===e.type)throw new Error(s(8));if(m)throw new Error(s(9));try{m=!0,i=o(i,e)}finally{m=!1}for(var t=l=p,n=0;n<t.length;n++)(0,t[n])();return e}function _(e){if("function"!=typeof e)throw new Error(s(10));o=e,y({type:u.REPLACE})}function b(){var e,t=g;return(e={subscribe:function(e){if("object"!==Object(r.a)(e)||null===e)throw new Error(s(11));function n(){e.next&&e.next(v())}return n(),{unsubscribe:t(n)}}})[c]=function(){return this},e}return y({type:u.INIT}),(a={dispatch:y,subscribe:g,getState:v,replaceReducer:_})[c]=b,a}var p=f;function m(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var a=t[r];"function"==typeof e[a]&&(n[a]=e[a])}var o,i=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:u.INIT}))throw new Error(s(12));if(void 0===n(void 0,{type:u.PROBE_UNKNOWN_ACTION()}))throw new Error(s(13))}))}(n)}catch(e){o=e}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var r=!1,a={},c=0;c<i.length;c++){var l=i[c],u=n[l],d=e[l],f=u(d,t);if(void 0===f)throw t&&t.type,new Error(s(14));a[l]=f,r=r||f!==d}return(r=r||i.length!==Object.keys(e).length)?a:e}}function h(e,t){return function(){return t(e.apply(this,arguments))}}function v(e,t){if("function"==typeof e)return h(e,t);if("object"!==Object(r.a)(e)||null===e)throw new Error(s(16));var n={};for(var a in e){var o=e[a];"function"==typeof o&&(n[a]=h(o,t))}return n}function g(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function y(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error(s(15))},a={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},o=t.map((function(e){return e(a)}));return r=g.apply(void 0,o)(n.dispatch),i(i({},n),{},{dispatch:r})}}}}])},82422:function(e,t,n){"use strict";var r=n(32180),a=n(79301),o=n(95308),i=n(298),s=n(57042),c=n(24460),l=n(81876),u=n(21867),d=n(86066),f=n(45023),p=n(53723),m=n(92954),h=n.n(m),v=n(65542),g=n(33675),y=n.n(g),_=n(93212),b=n(46346),I=n.n(b),x={getEnv:function(){return I().env},isIphoneX:function(){var e=h().getSystemInfoSync()||{},t=e.screenHeight,n=void 0===t?"":t,r=e.safeArea,a=void 0===r?{}:r,o=a||{},i=o.bottom;return n!==i},isEmpty:function(e){return void 0===e||null===e||"object"===(0,_.Z)(e)&&0===Object.keys(e).length||"string"===typeof e&&0===e.trim().length},_parseUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isEmpty(t)){var n=e.indexOf("?")>=0?"&":"?";e=e+n+p.querystring.stringify(t)}return e}},T={QConfig:"/12446/QConfig.json",Getabpreinfo:"/12446/getabpreinfo",ProductDetailV5:"/12447/ProductDetailV5",ProductDetailExtend:"/12447/ProductDetailExtend",SearchProductPromotion:"/16255/searchProductPromotion",CompositeCouponDisplay:"/12447/compositeCouponDisplay",QueryPromotionDisplayInfo:"/12447/QueryPromotionDisplayInfo",convertPinyinWords:"/10653/ConvertPinyinWords",GetResourceSlot:"/16035/getResourceSlot",GetSceneV2:"/20516/getSceneV2",TakeCouponCode:"/16255/takeCouponCode",GetProductRankingInfo:"/17023/getProduct",GetWindowRecommendProductInfo:"/12447/getWindowRecommendProductInfo",GetEmotionalCues:"/12447/getProductDetailEmotionalCues",GetNearbyStore:"/13642/crmStoreGetNearbyStore",GetUrgentInfo:"/12448/GetBookFormEmotionalCuesV2",GetIMEntryInfo:"/12446/GetIMEntryInfo",GetIMEntryInfoNew:"/15529/GetIMEntryInfo",Pricecalendar:"/12433/pricecalendarv2",IsMyFavorites:"/10108/IsMyFavorites",CreateFavorite:"/10108/MyFavoritesAdd",CancelFavorite:"/10108/MyFavoritesDelete",SearchBrandPromotion:"/16255/searchBrandPromotion",SearchScenesPromotion:"/16255/searchScenesPromotion",GetServiceEntry:"/15529/GetServiceEntry",GetCityNameByCityId:"/11198/getCityByCityIds",DepartureCityMetric:"/12447/DepartureCityMetric",CreateTrack:"/17582/createTrack",GetProductBookingRuleInfo:"/12447/GetProductBookingRuleInfo",GetUserCommonInfo:"/12448/GetUserCommonInfo",GetCommentSummary:"/15656/getCommentSummary",GetSuggestInternalProductInfo:"/12447/GetSuggestInternalProductInfo",TrainPassengerCheck:"/12448/TrainPassengerCheck",SendMessage:"/12448/SendMessage",ProductDetail:"/12447/ProductDetailV5",ProductDetailTiming:"/12447/ProductDetailTimingV5",ScenicTrip:"/12447/ScenicTrip",GetHotelBasicInfo:"/13078/getHotelBasicInfo",GetHotelBasicInfoList:"/13078/getHotelBasicInfoList",GetCalendarDataInfo:"/12447/GetCalendarDataInfo",ShoppingDetailGet:"/13966/ShoppingDetailGet",XSearch:"/13966/XSearch",GetCommonInfo:"/15486/getCommonInfo",GetCustomerTemplate:"/13966/customerInfoTemplateSearch",GetBookingLimit:"/13966/bookingLimit",MutateUserCommonInfo:"/12448/MutateUserCommonInfo",ClientValidation:"/12448/ClientValidation",ConvertPinyinWords:"/10653/ConvertPinyinWords",BookingLimitCheck:"/13966/bookingLimitCheck",ForceConfirm:"/13966/forceConfirm",ContactTemplate:"/13966/contactTemplate",CheckOrderDuplicated:"/12448/CheckOrderDuplicated",SearchBookingPromotion:"/16255/searchBookingPromotion",PromotionValidation:"/16255/promotionValidation",InsuranceUpdate:"/13966/InsuranceUpdate",QteRemarkSearch:"/13966/QteRemarkSearch",ShoppingDetailUpdate:"/13966/ShoppingDetailUpdate",Getshoppinginfo:"/13966/getshoppinginfo",SaveOrder:"/12448/SaveOrderV4",GetBookForm:"/12448/GetBookFormV4",SaveOrderCallback:"/12448/SaveOrderCallback",SaveTourCustomerType:"/12448/SaveTourCustomerType",GetOrderEmotionalCues:"/12448/GetBookFormEmotionalCuesV2",PaymentWayInfo:"/13826/paymentWayInfo",SendJourneyEmail:"/12447/SendJourneyEmail",ProductScheduleTourInfo:"/12447/ProductScheduleTourInfo",CreateProposalOrder:"/12448/CreateProposalOrder",compositeCouponDisplay:"/12447/compositeCouponDisplay",TourAssistGetNoticeTimeList:"/10644/TourAssistGetNoticeTimeList",CouponVerify:"/12448/PromotionValidationV4",ProductGroupInfo:"/12447/ProductGroupInfo",ProductComment:"/16238/listComments",ListCommentProductLines:"/16238/listCommentProductLines",TransmitVisaMaterials:"/13250/TransmitVisaMaterials",VisaStuffSearch:"/13762/VisaStuffSearch",TrainSearch:"/13966/TrainSearch",TrainBookingNote:"/13966/TrainBookingNote",RecommendSearch:"/13966/RecommendSearch",FlightSearch:"/13966/FlightSearch",HotelListSearch:"/13966/HotelListSearch",CarSearch:"/13966/CarSearch",GetHotelFilterInfo:"/13078/getHotelFilterInfo",GetCityEvents:"/13078/getCityEvents",GetCityLandmarks:"/13078/getCityLandmarks",HotelDetail:"/13966/HotelDetail",RoomListSearch:"/13966/RoomListSearch",RoomPriceCalulate:"/13966/RoomPriceCalulate",RoomAcceptableGuaranteeSearch:"/13966/RoomAcceptableGuaranteeSearch",FareRemarkSearch:"/13966/FareRemarkSearch",DomesticRemarkSearch:"/13966/DomesticRemarkSearch",FlightPlanePicture:"/13966/FlightPlanePicture",BookFormCallback:"/12448/BookFormCallback",CanBooking:"/13826/CanBooking",ComfirmTourStatus:"/17322/comfirmTourStatus",FlightRecommendSearch:"/13966/FlightRecommendSearch",FlightInfoSearch:"/13966/FlightInfoSearch",FlightSeatSearch:"/13966/FlightSeatSearch",DomesticRemarkSearchV2:"/13966/DomesticRemarkSearch",InternationalRemarkSearchV2:"/13966/InternationalRemarkSearch",InternationalExtendSearch:"/13966/InternationalExtendSearch",getUserInfo:"/11838/getUserInfo",GetOrderSuccessInfo:"/12448/GetOrderSuccessInfo",getPreposeInstallment:"/13826/preposeInstallment",GetPromotionInfo:"/16255/GetPromotionInfo",GetCategoryMaps:"/20168/GetCategoryMaps",GetFillPageWeChatAppShareUrl:"/12943/json/getFillPageWeChatAppShareUrl",GetAddressInfo:"/13592/GetAddressInfo",getuserinfo:"/12446/getuserinfo",ResourceCountUpdate:"/13966/ResourceCountUpdate",GetOrderStatusByShoppingId:"/14556/GetOrderStatusByShoppingId",BuildInsurance:"/12448/BuildInsurance",UpdateInsurance:"/12448/UpdateInsurance",UpdateShoppingDetail:"/20168/UpdateShoppingDetail",SetPromotionBasicInfo:"/13966/SetPromotionBasicInfo",DelPromotionBasicInfo:"/13966/DelPromotionBasicInfo",SearchX:"/20168/SearchX",GetShoppingDetail:"/20168/GetShoppingDetail",GetInsuranceDetail:"/20168/GetInsuranceDetail",UpdateResource:"/20168/UpdateResource",GetShoppingInfo:"/20168/GetShoppingInfo",GetCruiseRoomInfo:"/20168/GetCruiseRoomInfo",OvaryRoomPriceCalculate:"/20168/OvaryRoomPriceCalculate",CruisePackageJourneyInfo:"/19658/CruisePackageJourneyInfo",GetDisplayItem:"/20168/GetDisplayItem",GetValidatePassenger:"/20168/GetValidatePassenger",paymentByInstalment:"/13826/paymentByInstalment",GetResourceCertificate:"/20168/GetResourceCertificate",GetBaseInfoForBook:"/14206/getBaseInfoForBook",ValidateInvoiceInputInfo:"/14206/validateInvoiceInputInfo",GetCountryCode:"/12687/GetCountryCode",GetPassenger:"/18848/getPassenger",CustomerValidCheck:"/20168/CustomerValidCheck",GetScripting:"/20168/GetScripting",registerGroupMember:"/20168/registerGroupMember",bookingXResource:"/20168/BookingXResource",getMainGuestCount:"/20168/GetMainGuestCount",getTrainOperationViewInfo:"/21646/getTrainOperationViewInfo",queryPassengerOnly:"/13380/queryPassengerOnly",GetOrderDetail:"/14556/getOrderDetailV3",SaveSubOrder:"/12448/SaveSubOrder",OrderCommit:"/12448/OrderCommit"},k={fat:{client:"http://m.fws.qa.nt.ctripcorp.com/tour/bff",server:"//m.fws.qa.nt.ctripcorp.com/tour/bff"},uat:{client:"//m.ctrip.uat.qa.nt.ctripcorp.com/tour/bff",server:"//m.ctrip.uat.qa.nt.ctripcorp.com/tour/bff"},prd:{client:"https://m.ctrip.com/restapi/tour/bff",server:"//apigateway.ctripcorp.com/restapi/tour/bff"}};function S(e){if("fat"!==x.getEnv())return e;var t=e.includes("?")?"&":"?";return e+t+"subEnv=fat29"}var C=function(){function e(){(0,s.Z)(this,e)}return(0,c.Z)(e,null,[{key:"checkServiceCode",value:function(e){if(!e)return e;var t=e.split("/");return"12448"===t[1]&&["saveorderv4","savesuborder","updateinsurance","buildinsurance","saveordercallback","getordersuccessinfo","checkorderduplicated","ordercommit"].includes(t[2].toLocaleLowerCase())?(t[1]="27392",t.join("/")):e}},{key:"resolveFetchArgs",value:function(t,n){var r=t;return n&&n.isBffService?r=k[x.getEnv()]["client"]+t:(e.api.hasOwnProperty(t)&&(r=e.api[t]||t),n&&n.isUseNewCode_44014&&(r=e.checkServiceCode(r)),r="/restapi/soa2"+S(r)),r}},{key:"request",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){y().request((0,i.Z)((0,i.Z)({},t),{},{success:function(t){e(t)},fail:function(e){n(e)}}))})));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"requestWithCancel",value:function(e){var t;return{fetch:function(){return new Promise((function(n,r){t=y().request((0,i.Z)((0,i.Z)({},e),{},{success:function(e){var t=e.data,r=void 0===t?{}:t;n(r)},fail:function(e){r(e)}}))}))},cancel:function(){y().cancel(t)}}}},{key:"postWithCancel",value:function(t,n,r){var a=e.resolveFetchArgs(t,r);try{var o=e.requestWithCancel({url:a,data:n});return o}catch(e){throw e}}},{key:"post",value:function(){var t=(0,o.Z)((0,a.Z)().mark((function t(n,r,o){var i,s,c;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,i=e.resolveFetchArgs(n,o),t.next=4,e.request({url:i,data:r});case 4:return s=t.sent,c=s.data,t.abrupt("return",c);case 9:throw t.prev=9,t.t0=t["catch"](0),t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));function n(e,n,r){return t.apply(this,arguments)}return n}()},{key:"gqlpost",value:function(){var t=(0,o.Z)((0,a.Z)().mark((function t(n,r){var o,i,s,c,l,u,d,f=arguments;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=f.length>2&&void 0!==f[2]?f[2]:"",i=f.length>3&&void 0!==f[3]?f[3]:{},o+="_weapp",s=null!==i&&void 0!==i&&i.isDiy?"27611":"18055",c=e.resolveFetchArgs("/".concat(s,"/graphql?queryName=").concat(o)),l={fixVariables:1,query:n,queryName:o,variables:r},t.prev=6,t.next=9,e.request({url:c,data:l});case 9:return u=t.sent,d=u.data,t.abrupt("return",d);case 14:throw t.prev=14,t.t0=t["catch"](6),t.t0;case 17:case"end":return t.stop()}}),t,null,[[6,14]])})));function n(e,n){return t.apply(this,arguments)}return n}()}]),e}();(0,f.Z)(C,"api",T);var w={fat:"https://m.ctrip.fat67.qa.nt.ctripcorp.com",uat:"https://m.ctrip.uat.qa.nt.ctripcorp.com",prd:"https://m.ctrip.com"}[I().env],N="8.55.6",E=/(\d+)\.(\d+)\.?(\d+)?/,P=N.replace(E,(function(e,t,n,r){var a=function(e,t){if(e=e.toString(),e.length<t){var n=new Array(t).join("0");e=(n+e).substr(-t)}return e};return n=a(n,2),r=r?a(r,3):"000",t+n+r})),j=function(e){(0,u.Z)(n,e);var t=(0,d.Z)(n);function n(){var e;(0,s.Z)(this,n);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return e=t.call.apply(t,[this].concat(i)),(0,f.Z)((0,l.Z)(e),"dhtLogger",void 0),(0,f.Z)((0,l.Z)(e),"get21767Switch",(0,o.Z)((0,a.Z)().mark((function t(){var n,r;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.gqlpost("query switchs{pageSetting}",{},"GetSwitch");case 3:if(t.t0=t.sent,t.t0){t.next=6;break}t.t0={};case 6:return r=t.t0,t.abrupt("return",(null===r||void 0===r||null===(n=r.data)||void 0===n||null===(n=n.pageSetting)||void 0===n||null===(n=n.switch)||void 0===n?void 0:n.weapp)||{});case 10:return t.prev=10,t.t1=t["catch"](0),t.abrupt("return",{});case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))),(0,f.Z)((0,l.Z)(e),"isPlatformStandalone","taro_vacation"===e.getMiniProgramPlatform()),(0,f.Z)((0,l.Z)(e),"tourContext",{Platform:"Taro",post:function(t,n,r){return e.post(t,n,r)},gqlpost:function(t,n,r,a){return e.gqlpost(t,n,r,a)},createGqldiyRequest:function(t,n,r,i){return i||(i={}),i.isDiy=!0,i.sequenceId=(new Date).getTime(),{fetch:function(){var s=(0,o.Z)((0,a.Z)().mark((function o(){return(0,a.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.gqlpost(t,n,r,i);case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),o)})));function c(){return s.apply(this,arguments)}return c}()}},jumpH5:function(t){var n=t.url,r=t.params,a=t.options;return e.jumpH5({url:n,params:r,options:a})},showToast:function(t,n){return e.showToast(t,n)},navigateTo:function(t){var n=t.url,r=t.params;return e._navigateTo({url:n,params:r})},redirectTo:function(t){var n=t.url,r=t.params;return e.redirectTo({url:n,params:r})},navigateBack:function(t){return e._navigateBack(t)},tracelog:function(t,n){return e.tracelog(t,n)},traceDevLog:function(t,n){return e.traceDevLog(t,n)},sendKMLog:function(t){e.sendKMLog(t)},sendPV:function(t){var n=t.pageId,r=t.url;return e.sendPV({pageId:n,url:r})},attachShardParams:function(t){return e.attachShardParams(t)},attachGqlCommonParams:function(){return e.attachShardParams()},showLoadingDialog:function(t){return e.showLoadingDialog(t)},hideLoadingDialog:function(){return e.hideLoadingDialog()},showModal:function(t){return e.showModal(t)},login:function(t){return e.login(t)},logPageError:function(e){console.log(e)},getDHTLogger:function(){return e.dhtLogger},set:function(t,n,r){return e.set(t,n,r)},get:function(t){return e.get(t)},remove:function(t){return e.remove(t)},createRequest:function(t,n,r){return e.createRequest(t,n,r)},createAntiSpiderRequest:function(t){var n=t.url,r=t.requestFn,a=t.fixedParams,o=t.callback,i=t.getScriptFromRsp;return e.createAntiSpiderRequest(n,r,a,o,i)},createRequestWithCancel:function(t,n,r){return e.createRequestWithCancel(t,n,r)},eventCenter:h().eventCenter,cwx:y(),isPlatformStandalone:e.isPlatformStandalone}),(0,f.Z)((0,l.Z)(e),"get",(function(t){try{var n=h().getStorageSync(t);return e.traceDevLog("o_vacation_get_storage_log",{key:t,value:n}),n}catch(e){console.log(e)}})),(0,f.Z)((0,l.Z)(e),"set",(function(t,n,r){try{h().setStorage({key:t,data:n}),e.traceDevLog("o_vacation_set_storage_log",{key:t,value:n})}catch(e){console.log(e)}})),(0,f.Z)((0,l.Z)(e),"remove",(function(t){try{h().removeStorageSync(t),e.traceDevLog("o_vacation_remove_storage_log",{key:t})}catch(e){console.log(e)}})),(0,f.Z)((0,l.Z)(e),"getLocationInfo",(0,o.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",new Promise((function(e,t){y().locate.getCtripCity((function(t){e(t.data)}),"vacations-lbs")})));case 4:e.prev=4,e.t0=e["catch"](0),console.log("getLocationInfo",e.t0);case 7:case"end":return e.stop()}}),e,null,[[0,4]])})))),e}return(0,c.Z)(n,[{key:"onLoad",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.dhtLogger=new p.DevHubTraceLog({platform:p.PlatformType.taro,ubtKey:"km_tour_trace_log",organizationId:"51"},this),this.isUseNewCode_44014){e.next=6;break}return e.next=4,this.get21767Switch();case 4:n=e.sent,this.isUseNewCode_44014=null===n||void 0===n?void 0:n.isUseNewCode_44014;case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getMiniProgramPlatform",value:function(){var e,t={wxffcb7f77b0b8b8e1:"taro_vacation",wx0e6ed4f51db9d078:"taro_vacation_main"},n=h().getAccountInfoSync(),r=(null===n||void 0===n||null===(e=n.miniProgram)||void 0===e?void 0:e.appId)||"";return t[r]||"taro_vacation"}},{key:"post",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n){var r,o,s=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]?s[2]:{},o=(0,i.Z)((0,i.Z)({},n),this.attachShardParams(t)),console.log("isUseNewCode_44014=======",this.isUseNewCode_44014),this.isUseNewCode_44014&&(r.isUseNewCode_44014=this.isUseNewCode_44014),e.abrupt("return",C.post(t,o,r));case 5:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"gqlpost",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n,r,o){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",C.gqlpost(t,n,r,o));case 1:case"end":return e.stop()}}),e)})));function t(t,n,r,a){return e.apply(this,arguments)}return t}()},{key:"createRequest",value:function(e,t,n){var r=this;return{fetch:function(){return r.post(e,t,n)},cancel:function(){}}}},{key:"createRequestWithCancel",value:function(e,t,n){var r=(0,i.Z)((0,i.Z)({},t),this.attachShardParams(e));return C.postWithCancel(e,r,n)}},{key:"createAntiSpiderRequest",value:function(e,t,n,r,a){var o=(0,i.Z)((0,i.Z)({},n),this.attachShardParams(e)),s=C.resolveFetchArgs(e,{});return y().createAntiSpiderRequest({url:s,requestFn:t,fixedParams:o,callback:r,getScriptFromRsp:a})}},{key:"jumpH5",value:function(e){var t=e.url,n=e.params,r=e.options;t=x._parseUrl(t,n),(0===t.indexOf("/webapp/")||r&&r.needHost)&&(t=w+t);var a={url:encodeURIComponent(t),pageTitle:{color:{backgroundColor:"#ffffff",frontColor:"#000000"}}};r&&r.needLogin&&(a=(0,i.Z)((0,i.Z)({},a),{},{needLogin:!0})),r&&r.observerKey&&(a=(0,i.Z)((0,i.Z)({},a),{},{observerKey:r.observerKey})),r&&r.isRedirect?y().redirectTo({url:"/cwx/component/cwebview/cwebview?data="+JSON.stringify(a)}):y().navigateTo({url:"/cwx/component/cwebview/cwebview?data="+JSON.stringify(a)})}},{key:"_navigateTo",value:function(e){var t=e.url,n=e.params;t=x._parseUrl(t,n),console.log("url=======",t),y().navigateTo({url:t})}},{key:"_navigateBack",value:function(e){e&&e.delta?y().navigateBack({delta:e.delta}):y().navigateBack()}},{key:"redirectTo",value:function(e){var t=e.url,n=e.params;t=x._parseUrl(t,n),y().redirectTo({url:t})}},{key:"showToast",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;h().showToast({title:e,duration:1e3*t,icon:"none"})}},{key:"showLoadingDialog",value:function(e){var t=e&&e.title?e.title:"\u52a0\u8f7d\u4e2d";h().showLoading({title:t,mask:!0})}},{key:"hideLoadingDialog",value:function(){h().hideLoading()}},{key:"showModal",value:function(e){h().showModal(e)}},{key:"login",value:function(e){var t={param:e.param,callback:function(t){e.callback&&e.callback()}};y().user.login(t)}},{key:"sendPV",value:function(e){var t=e.pageId,n=e.url;this.ubtSendPV({pageId:t,url:n})}},{key:"tracelog",value:function(e,t){this.ubtTrace(e,t)}},{key:"traceDevLog",value:function(e,t){this.ubtDevTrace(e,t)}},{key:"sendKMLog",value:function(e){try{this.ubtDevTrace("km_tour_trace_log",{data:JSON.stringify(e)})}catch(e){console.log(e)}}},{key:"getUrlQuery",value:function(){var e=h().getCurrentPages(),t=e.pop(),n=t.options;return n}},{key:"getPageUrl",value:function(){var e=h().getCurrentPages(),t=e.pop(),n=t.route,r=t.options,a=n+"?"+p.querystring.stringify(r);return a}},{key:"attachShardParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e&&!e.includes("/")&&(e=T[e]);var t=e.split("/")&&e.split("/")[1];switch(t){case"10124":case"12446":case"12448":case"13592":case"27392":return{ChannelCode:0,ChannelId:117,DistributionChannelId:117,PlatformId:3,Version:P,Locale:"zh-CN"};case"13966":case"20168":case"18848":return{Channel:3,ChannelId:117,DistributionChannelId:117,Version:P};case"13250":return{Channel:3,ChannelId:117,DistributionChannelId:117,Version:P};default:return{Channel:3,ChannelId:117,PlatformChannelInfo:{ChannelId:117},DistributionChannelId:117,ChannelCode:0,PlatformId:3,Version:P,Locale:"zh-CN"}}}}]),n}(v.Z),O=n(90201),D=n(71515),R=n(22276),A=n(68277),M=n(90129),V=function(e){return void 0===e||null===e||"string"===typeof e&&0===e.trim().length||("[object Array]"===Object.prototype.toString.call(e)?0===e.length:"[object Date]"!==Object.prototype.toString.call(e)&&("[object Function]"!==Object.prototype.toString.call(e)&&("object"===(0,_.Z)(e)&&0===Object.keys(e).length)))},L=function(e){if(V(e))return[];var t=[];return e.forEach((function(e){t.includes(e)||t.push(e)})),t},B=function(e,t){if(V(e))return e;if(Array.isArray(e)){var n=-1,r=null==e?0:e.length;while(++n<r)if(!1===t(e[n],n,e))break;return e}n=-1;var a=Object(e),o=Object.keys(e);r=o.length;while(r--){var i=o[++n];if(!1===t(a[i],i,a))break}return e},U=function(e,t){var n=new Set(t);return e.filter((function(e){return n.has(e)}))},Z=function(e,t){var n=new Set(t);return e.filter((function(e){return!n.has(e)}))},F=function(e,t){return!(V(e)||!Array.isArray(e))&&e.includes(t)},G=function(e){return!(V(e)||!Array.isArray(e))&&e[0]},H=function(e){if(V(e))return[];var t=[];for(var n in e)t.push(e[n]);return t},q=function(e){return V(e)?[]:Object.keys(e)},K=function(e,t){return V(e)||!Array.isArray(e)&&"string"!==typeof e?-1:e.indexOf(t)},z=function(e,t){return e.findIndex(t)},Y=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new WeakMap;if(!W(t))return t;var r=Array.isArray(t)?[]:{};if("function"===typeof t)return t;if(n.has(t))return n.get(t);for(var a in n.set(t,r),t)r[a]=e(t[a],n);return r};function W(e){var t=(0,_.Z)(e);return null!=e&&("object"===t||"function"===t)}function $(e,t){return e.concat(t)}function X(e,t){var n=[];if(null==e||!e.length)return n;var r=-1,a=[],o=e.length;while(++r<o){var i=e[r];t(i,r,e)&&(n.push(i),a.push(r))}var s,c=e?a.length:0;while(c--){var l=a[c];l!==s&&(s=l,e.splice(l,1))}return n}function J(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Array.isArray(e)&&0!==e.length?e.slice(t<0?0:t):[]}function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Array.isArray(e)&&0!==e.length?e.slice(0,t<0?0:t):[]}function ee(e,t){return Array.isArray(e)&&0!==e.length?e.join(t):[]}function te(e,t){var n=-1,r=0,a=null==e?0:e.length,o=[];while(++n<a){var i=e[n];t(i,n,e)&&(o[r++]=i)}return o}function ne(e){function t(e,t,n,r){var a=-1,o=Math.max(Math.ceil((t-e)/(n||1)),0),i=new Array(o);while(o--)i[r?o:++a]=e,e+=n;return i}return function(n,r,a){return void 0===r&&(r=n,n=0),a=void 0===a?n<r?1:-1:a,t(n,r,a,e)}}var re=ne(),ae=function(e){return e&&"string"===typeof e?e.replace(/<[\/]?[^<>]+>/g,(function(e){var t=(null===e||void 0===e?void 0:e.toLowerCase())||"";return 0===t.indexOf("<a>")||0===t.indexOf("<a ")||0===t.indexOf("</a>")?e:""})):""},oe={isEmpty:V,uniq:L,forEach:B,intersection:U,difference:Z,includes:F,first:G,values:H,keys:q,indexOf:K,cloneDeep:Y,findIndex:z,concat:$,remove:X,drop:J,take:Q,join:ee,filter:te,range:re,getRemoveHTMLTagExcludeA:ae},ie=function(){},se=function(){},ce={UPDATE_ORDER_INFO:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},UPDATE_PASSENGER_INFO:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},DELETE_PASSENGER:function(e,t){var n=t.selectIds;return(0,i.Z)((0,i.Z)({},e),{},{selectIds:(0,R.Z)(n)})},SELECT_PASSENGER:function(e,t){var n=t.selectIds,r=t.passengerObj;return(0,i.Z)((0,i.Z)({},e),{},{selectIds:(0,R.Z)(n),passengerObj:(0,i.Z)({},r)})},UPDATA_TRAIN_CHECK_STATUS:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},UPDATA_CONTACT_INFO:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},REST_SHAREROOM_INFO:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{sharedRoomInfo:(0,i.Z)((0,i.Z)({},e.sharedRoomInfo),t)})},UPDATE_CHILD_TYPE:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_TRAVELER_RULE_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowTravelerRuleMask:t})},TOGGLE_BOOKLIMIT_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowBookLimitMask:t})},TOGGLE_TRAINDETAIL_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowTrainDetailMask:t})},TOGGLE_TRAINSELECTSEAT_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowTrainSelectSeatMask:t})},TOGGLE_DELIVERYINFO_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowDeliveryInfoMask:t})},TOGGLE_DELIVERYTYPE_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_DELIVERYADDRESS_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_RESOURCESELECTPERSON_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_INSURANCESELECTPERSON_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_CRUISESELECTPERSON_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_COUPON_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowCouponMask:t})},TOGGLE_ALERT_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_DUPLICATION_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_SAVEORDER_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_PASSENGERTYPE_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_PRICEDETAIL_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowPriceDetailMask:t})},TOGGLE_RESOURCEERROR_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_BUYTRAINTICKET_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_INSURANCETIP_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowInsuranceTipMask:t})},TOGGLE_SHAREROOM_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_WECHATSHARE_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isWeChatShareMask:t})},TOGGLE_URGENTNOTICE_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowUrgentNoticeMask:t})},TOGGLE_VENDOR_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowVendorMask:t})},TOGGLE_CHILDSTANDAR_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowChildStandarMask:t})},TOGGLE_INSINTRODUC_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_MEMBERCARDS_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_RETAILINVOICE_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowRetailInvoiceMask:t})},TOGGLE_FAREREMARK_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowFareRemarkMask:t})},TOGGLE_INSCONFIRM_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowInsConfirmMask:t})},TOGGLE_FULLBG_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowFullBgMask:t})},TOGGLE_IMENTRY_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowIMEntryInfo:t})},TOGGLE_PERSONLIST_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_COUNTRY_CODE_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowCountryCodeMask:t})},TOGGLE_TRAIN12306_CONTACT_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_HOTELSELECTCONTACT_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowHotelSelectContactMask:t})},TOGGLE_AIRLINECLAUSE_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowAirlineClauseMask:t})},TOGLGLE_CREATE_SHOPPING_ERROR_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowCreateShoppingErrorMask:t})},TOGLGLE_SELECT_DATE_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowSelectDate:t})},TOGGLE_SELECT_PASSENGER:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowSelectPassenger:t})},TOGGLE_TRAINSELECTPERSON_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_TRAIN_HEIHGT_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowTrainHeightMask:t})},TOGGLE_ROOMINTRODUCTION_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowRoomIntroductionMask:t})},TOGGLE_BOOKREAD_MASK:function(e,t){return(0,i.Z)((0,i.Z)({},e),t)},TOGGLE_INSTALLMENT_BAR:function(e,t){return(0,i.Z)((0,i.Z)({},e),{},{isShowInstalmentBar:t})}},le=(0,p.createModelContext)({}),ue=function(){var e=(0,p.setupContext)(le);return e},de=(0,p.createModelContext)({}),fe=function(){var e=(0,p.setupContext)(de);return e},pe=((0,p.createModelContext)({}),(0,p.createModelContext)({getInitialData:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",{});case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()})),me=function(){return(0,p.setupContext)(pe)},he=function(e,t,n,r){return e=e.toString(),e.length<t&&(n=new Array(t).join(n||" "),e=r?(n+e).substr(-t):(e+n).substring(0,t)),e},ve=["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],ge=/^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(\.[0-9]+)?(Z)?((\+|-)?\d{1,2}:00)?$/,ye=function(){function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,s.Z)(this,e),(0,f.Z)(this,"date",new Date(""));var r=e.handleZone(Date.now());if(t)if(/^-\d+$/.test(t)){if(n)return this.date=new Date(""),this;t=e.handleZone(t)}else if(/^\+?\d+$/.test(t))t=e.handleZone(t);else if("object"===(0,_.Z)(t)&&t instanceof e)return t;if(t=t||r,"string"===typeof t){var a=/^(\d{4})\-?(\d{1,2})(?:\-(\d{1,2}))?/i;t.match(a)&&(t=t.replace(a,(function(e,t,n,r){return"".concat(t,"/").concat(n||"01","/").concat(r||"01")})))}this.date=new Date(t)}return(0,c.Z)(e,[{key:"addDay",value:function(e){return e=e||0,this.date.setDate(this.date.getDate()+e),this}},{key:"addMonth",value:function(e){return e=e||0,this.date.setMonth(this.date.getMonth()+e),this}},{key:"addHours",value:function(e){return e=e||0,this.date.setHours(this.date.getHours()+e),this}},{key:"addMinutes",value:function(e){return e=e||0,this.date.setMinutes(this.date.getMinutes()+e),this}},{key:"getMinutes",value:function(){return this.date.getMinutes()}},{key:"addSeconds",value:function(e){return e=e||0,this.date.setSeconds(this.date.getSeconds()+e),this}},{key:"addYear",value:function(e){return e=e||0,this.date.setFullYear(this.date.getFullYear()+e),this}},{key:"toBJZone",value:function(){return new e(e.handleZone(this.date.getTime()))}},{key:"setHours",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.date.setHours.apply(this.date,t),this}},{key:"setMinutes",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.date.setMinutes.apply(this.date,t),this}},{key:"valueOf",value:function(){return this.date}},{key:"getTime",value:function(){return this.date.valueOf()}},{key:"toString",value:function(){return this.date.toString()}},{key:"format",value:function(e){var t=this.date;return e=e||"YYYY-MM-DD",e.replace(/Y+|y+|M+|D+|d+|H+|h+|m+|s+|w+/g,(function(e){var n=e.substr(0,1),r=e.length;switch(n){case"Y":return t.getFullYear().toString().substr(4-r);case"y":return t.getFullYear().toString().substr(4-r);case"M":return he(t.getMonth()+1,r,"0",!0);case"D":return he(t.getDate(),r,"0",!0);case"d":return he(t.getDate(),r,"0",!0);case"H":return he(t.getHours(),r,"0",!0);case"h":return he(t.getHours(),r,"0",!0);case"m":return he(t.getMinutes(),r,"0",!0);case"s":return he(t.getSeconds(),r,"0",!0);case"w":return ve[t.getDay()]}}))}},{key:"diffMonth",value:function(t){var n=parseInt(this.format("YYYY"),10),r=parseInt(this.format("MM"),10),a=new e(t),o=parseInt(a.format("YYYY"),10),i=parseInt(a.format("MM"),10);return 12*(o-n)+(i-r)}},{key:"diffYear",value:function(t){var n=parseInt(this.format("YYYY"),10),r=new e(t),a=parseInt(r.format("YYYY"),10);return a-n}},{key:"isValid",value:function(){return this.date&&!isNaN(this.date.getTime())}}],[{key:"parse",value:function(t,n,r){return"object"===(0,_.Z)(t)?(t instanceof e&&(t=t.valueOf()),n?new Date(t):new e(t)):(t+="",t.indexOf("Date")>-1?t=t.match(/((\+|-)?\d+)/)[0]:ge.test(t)&&(t=e.transformTimeStampISO8601(t)),isNaN(t)||(t=parseInt(t,10)),n?new e(t,r).valueOf():new e(t,r))}},{key:"minuteDiff",value:function(t,n){var r=Number(e.parse(t,!0)),a=Number(e.parse(n,!0));return(a-r)/6e4}},{key:"hourDiff",value:function(t,n){var r=Number(e.parse(t,!0)),a=Number(e.parse(n,!0));return(a-r)/36e5}},{key:"dayDiff",value:function(t,n){var r=e.parse(t,!0),a=e.parse(n,!0);r.setHours(0,0,0,0),a.setHours(0,0,0,0);var o=Number(r),i=Number(a);return(i-o)/864e5}},{key:"diffMonth",value:function(t,n){return t=new e(t),t.diffMonth(n)}},{key:"diffYear",value:function(t,n){return t=new e(t),t.diffYear(n)}},{key:"timeRange",value:function(t,n,r){var a=e.dayDiff(t,r),o=e.dayDiff(r,n);return a>=0&&o>=0}},{key:"format",value:function(t,n,r){return t=this.parse(t,!0,r),new e(t,r).format(n)}},{key:"handleZone",value:function(e){if(!e||isNaN(e))return e;var t=288e5,n=(new Date).getTimezoneOffset();return+e+6e4*n+t}},{key:"transformTimeStamp",value:function(t){var n=t.match(/^\/Date\(-?(\d+)(\+|-)\d+\)\/$/);return n?e.handleZone(n[1]):t.match(/^(\d{4})\-?(\d{1,2})(?:\-(\d{1,2}))?/i)?new Date(t).getTime():t}},{key:"transformTimeStampISO8601",value:function(e){var t=e.match(ge);if(t&&t.length){var n=t[1],r=void 0==t[2]?0:t[2]-1,a=t[3],o=t[4],i=t[5],s=t[6],c=new Date(n,r,a,o,i,s);return c.getTime()-288e5-6e4*(new Date).getTimezoneOffset()}return null}},{key:"transformServerDate",value:function(t){return t=e.handleZone(t),"/Date("+t+"+0800)/"}},{key:"isCrossYear",value:function(t,n){t=this.parse(t,!0,n);var r=e.diffYear(t,new e);return 0!=r}}]),e}(),_e={CTRIPRN:2,CTRIPH5:4,TRIPRN:8,TRIPH5:16,CTRIPWX:32},be=function(e){return e[e["red"]=0]="red",e[e["orange"]=1]="orange",e[e["grey"]=2]="grey",e}({}),Ie={SND:{deliveryType:1,deliveryTypeName:"\u5e02\u5185\u914d\u9001"},GET:{deliveryType:2,deliveryTypeName:"\u5e02\u5185\u81ea\u53d6"},EMS:{deliveryType:3,deliveryTypeName:"\u5feb\u9012"},PJS:{deliveryType:4,deliveryTypeName:"\u5e73\u90ae"},SFE:{deliveryType:5,deliveryTypeName:"\u987a\u4e30\u5feb\u9012"}},xe={CN:"\u4e2d\u56fd\u5883\u5185",HK:"\u4e2d\u56fd\u9999\u6e2f",MO:"\u4e2d\u56fd\u6fb3\u95e8",TW:"\u4e2d\u56fd\u53f0\u6e7e"},Te={0:{imgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/gold.png",smallImgUrl:"",bgImgUrl:"",titleColor:"#333"},10:{imgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/gold.png",smallImgUrl:"",bgImgUrl:"",titleColor:"#333"},20:{imgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/platinum.png",smallImgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/platinum_small.png",bgImgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/platinum_bg.png",titleColor:"#218db1"},30:{imgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/diamond.png",smallImgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/diamond_small.png",bgImgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/diamond_bg.png",titleColor:"#595cb3"},35:{imgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/glod_diamond.png",smallImgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/glod_diamond_small.png",bgImgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/glod_diamond_bg.png",titleColor:"#f8e4c3"},40:{imgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/black_diamond.png",smallImgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/black_diamond_small.png",bgImgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/black_diamond_bg.png",titleColor:"#f8e4c3"}},ke=90001,Se=90001,Ce=90001,we={1:"IdentityCard",2:"Passport",8:"MTP",22:"TaiwanPass",32:"HKMacPass",7:"HomePermit"},Ne={1:"\u8eab\u4efd\u8bc1",2:"\u62a4\u7167",3:"\u5b66\u751f\u8bc1",4:"\u519b\u5b98\u8bc1",6:"\u9a7e\u9a76\u8bc1",7:"\u56de\u4e61\u8bc1",8:"\u53f0\u80de\u8bc1",10:"\u6e2f\u6fb3\u901a\u884c\u8bc1",11:"\u56fd\u9645\u6d77\u5458\u8bc1",20:"\u5916\u56fd\u4eba\u6c38\u4e45\u5c45\u7559\u8bc1",21:"\u65c5\u884c\u8bc1",22:"\u53f0\u6e7e\u901a\u884c\u8bc1",23:"\u58eb\u5175\u8bc1",24:"\u4e34\u65f6\u8eab\u4efd\u8bc1",25:"\u6237\u53e3\u7c3f",26:"\u8b66\u5b98\u8bc1",27:"\u51fa\u751f\u8bc1\u660e",32:"\u6e2f\u6fb3\u53f0\u5c45\u6c11\u5c45\u4f4f\u8bc1",99:"\u5176\u5b83",100:"\u7a0d\u540e\u63d0\u4f9b"},Ee={below_120:"\u514d\u7968",between_120_150:"\u513f\u7ae5\u7968",above_150:"\u6210\u4eba\u7968"},Pe={adult:"above_150",child:"between_120_150",free:"below_120"},je={traveler:"",travelerMobile:"",totalNumber:"",agencyName:"",travelAgencyLicenseNumber:"",travelAgencyplace:"",starDate:"",EndDate:"",days:"",nights:"",adultCost:"",childCost:"",payGuide:"",totalCost:"",leastCustomerNumber:"",agreeToTransfer:"",delayAgree:"",agreeToChangeLine:"",agreeToTerminate:"",agreeToMerge:"",teminateDealType:"",supplementaryClause:"",copys1:"",copys2:"",agencyComplaintsMobile:"",lawComplaintsMobile:"",deptAddr:"",payType:""},Oe={traveller:"",travellerTel:"",totalNumber:"",agencyName:"",travelAgencyLicenseNumber:"",travelAgencyplace:"",starDate:"",endDate:"",days:"",totalCost:"",choice1:"",insuranceName:"",choice2:"",leastCustomerNumber:"",traSign:"",supplementaryClause:"",payType1:"",payType2:""},De={PlatformEnum:_e,DeliveryTypeEnum:Ie,CommonNationality:xe,UserLevelEnum:Te,Alert_Ins_Cancel_Repel:ke,Alert_Ins_Main_UnSelect:Se,Alert_Ins_Addition_Select:Ce,HotelRegCard:we,IdCardType:Ne,HeightType:Ee},Re=100,Ae=function(e){if(!e)return null;var t=e.customerInfoItems,n=void 0===t?[]:t,r=e.relationRule,a=void 0===r?{}:r,o=e.cityStatus,i=e.isNeedEmail,s=void 0!==i&&i,c=e.tipList,l=void 0===c?[]:c,u=a||{},d=u.cardRelationRules,f=void 0===d?[]:d,p=u.countryRelationRules,m=void 0===p?[]:p,h=u.notRelationItem,v=void 0===h?[]:h,g=[],y=[],_=[],b=[],I=[],x={};null===n||void 0===n||n.map((function(e){1===e.customerInfoItemModel||5===e.customerInfoItemModel?x[e.customerInfoItemType]=e:2===e.customerInfoItemModel?(g.push(e),b.push(e.customerInfoItemType)):3===e.customerInfoItemModel?y.push(e):4===e.customerInfoItemModel?_.push(e):6===e.customerInfoItemModel&&I.push(e)}));var T={};y&&y.length&&y.map((function(e){T[e.customerInfoItemType]=e}));var k={};g&&g.length&&g.map((function(e){k[e.customerInfoItemType]=e}));var S={};I&&I.length&&I.map((function(e){S[e.customerInfoItemType]=e}));var C={};return l&&l.length&&l.map((function(e){"USAAddress"===e.tipType&&e.tipItems&&e.tipItems.length&&e.tipItems.map((function(e){C[e.key]=e.value}))})),{items:x,idTypes:b,idOptions:g,customerOptions:y,heightOptions:_,cardRelationRules:f,countryRelationRules:m,notRelationItem:v,customerObj:T,idObj:k,visaOptions:I,visaObj:S,destType:o||0,isNeedEmail:s,usaTitle:C}},Me="11@22@35@44@53@12@23@36@45@54@13@31@37@46@61@14@32@41@50@62@15@33@42@51@63@21@34@43@52@64@65@71@81@82@91";function Ve(e,t,n){var r,a;null==n&&(n=0),a=e.length,n<0&&(n+=a),r=Math.max(n,0);while(r<a){if(e[r]===t)return r;++r}return-1}var Le=function(e){var t,n,r,a,o,i,s,c=e.split(""),l=!0;switch(-1===Ve(Me.split("@"),e.substr(0,2),null)&&(l=!1),e.length){case 15:t=(parseInt(e.substr(6,2))+1900)%4==0||(parseInt(e.substr(6,2))+1900)%100==0&&(parseInt(e.substr(6,2))+1900)%400==0?/^[1-9][0-9]{5}[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}$/:/^[1-9][0-9]{5}[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}$/,t.test(e)||(l=!1);break;case 18:t=parseInt(e.substr(6,4))%4==0||parseInt(e.substr(6,4))%100==0&&parseInt(e.substr(6,4))%4==0?/^[1-9][0-9]{5}(19|20)[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}[0-9Xx]$/:/^[1-9][0-9]{5}(19|20)[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}[0-9Xx]$/,t.test(e)?(o=7*(parseInt(c[0])+parseInt(c[10]))+9*(parseInt(c[1])+parseInt(c[11]))+10*(parseInt(c[2])+parseInt(c[12]))+5*(parseInt(c[3])+parseInt(c[13]))+8*(parseInt(c[4])+parseInt(c[14]))+4*(parseInt(c[5])+parseInt(c[15]))+2*(parseInt(c[6])+parseInt(c[16]))+1*parseInt(c[7])+6*parseInt(c[8])+3*parseInt(c[9]),n=o%11,i="F",r="10x98765432",a="10X98765432",i=r.substr(n,1),s=a.substr(n,1),i!=c[17]&&s!=c[17]&&(l=!1)):l=!1;break;default:l=!1;break}return l},Be=function(e){var t,n;try{return Le(e)?(15==e.length?(t=parseInt(e.charAt(14),10)%2?"M":"F",n=e.replace(/^\d{6}(\d{2})(\d{2})(\d{2}).+$/,"19$1-$2-$3")):(t=parseInt(e.charAt(16),10)%2?"M":"F",n=e.replace(/^\d{6}(\d{4})(\d{2})(\d{2}).+$/,"$1-$2-$3")),{sex:t,age:n}):{}}catch(e){return{}}},Ue=function(e,t){t=t&&ye.parse(t,!0)||new Date,e=ye.parse(e,!0),t.setHours(0,0,0,0),e.setHours(0,0,0,0);var n=e.getFullYear(),r=t.getFullYear(),a=e.getMonth()+1,o=t.getMonth()+1,i=e.getDate(),s=t.getDate();if(n===r){var c=o-a-1;return i<=s&&c++,c}var l=r-n-1,u=12*l;return u+=12-a,u+=o-1,i<=s&&u++,u},Ze=function(e,t){return t=t&&ye.parse(t,!0)||new Date,e=ye.parse(e,!0),t.setHours(0,0,0,0),e.setHours(0,0,0,0),parseInt(String((t-e)/864e5))},Fe=function(e,t){t=t&&ye.parse(t,!0)||new Date,e=ye.parse(e,!0);var n=t.getMonth(),r=t.getDate(),a=t.getFullYear()-e.getFullYear()-1;return(e.getMonth()<n||e.getMonth()==n&&e.getDate()<=r)&&a++,isNaN(a)?-1:a},Ge=function(e){var t=e.birthday,n=e.trainChildStandard,r=e.dateline,a=(e.isRestrictChild,e.productBasicInfo),o=void 0===a?{}:a,i=e.tagInfo,s=void 0===i?{}:i,c=e.orderBasicInfo,l=void 0===c?{}:c;if(!t)return{type:"U"};var u=o.childStandard,d=void 0===u?{}:u,f=o.ProductType,p=s.isContainFlight,m=void 0!==p&&p,h=d.ages,v=void 0===h?[]:h,g=d.infantInfo,y=void 0===g?{}:g,_=d.childInfo,b=void 0===_?{}:_,I=d.adultInfo,x=void 0===I?{}:I,T=d.isIndistinguishablePopulation,k=void 0!==T&&T,S=(l.InfantCount,Fe(t,r)),C=0,w=0;if(n)return S>=n.MaxAge?{type:Pe.adult}:S<n.MaxAge&&S>=n.MinAge?{type:Pe.child}:{type:Pe.free};if(4===f&&k){var N="",E="U";if(y){var P=y||{},j=P.MinDays,O=P.MinMonths,D=P.MaxAge;D&&S<D&&(y.IsCanBook?(j?C=Ze(t,r):O&&(w=Ue(t,r)),m&&C&&C<j?(E="X",N="\u51fa\u884c\u5f53\u65e5\u672a\u6ee1".concat(j,"\u5929\u7684\u5a74\u513f\uff0c\u8bf7\u81f3\u822a\u7a7a\u516c\u53f8\u552e\u7968\u5904\u7533\u8bf7\u8d2d\u4e70\u673a\u7968")):w&&w<O?(E="X",N="\u6b64\u4ea7\u54c1\u4e0d\u652f\u6301".concat(O,"\u6708\u7684\u4eba\u9884\u8ba2")):E="B"):(E="X",N="\u6b64\u4ea7\u54c1\u4e0d\u652f\u6301\u5c0f\u4e8e".concat(D,"\u5c81\u7684\u4eba\u9884\u8ba2")))}if("U"===E&&b){var R=b||{},A=R.MinAge,M=R.MaxAge;S>=A&&S<M&&(b.IsCanBook?E="C":(E="X",N="\u6b64\u4ea7\u54c1\u4e0d\u652f\u6301".concat(M,"\u5c81\u4ee5\u4e0b\u9884\u8ba2")))}if("U"===E&&x){var V=x||{},L=V.MinAge;V.MaxAge;S>=L&&(x.IsCanBook?E="A":(E="X",N="\u6b64\u4ea7\u54c1\u4e0d\u652f\u6301\u5927\u4e8e".concat(L,"\u5c81\u7684\u4eba\u9884\u8ba2")))}return{type:E,errorMsg:N,age:S}}var B="U",U="",Z=0,F=0,G=y||{},H=G.MinDays,q=void 0===H?0:H,K=G.MinMonths,z=void 0===K?0:K,Y=oe.includes([2,4],f);return q?C=Ze(t,r):z&&(w=Ue(t,r)),S<1&&!Y?(B="X",U="\u672c\u4ea7\u54c1\u4e0d\u63a5\u53d7\u5c0f\u4e8e1\u5c81\u7684\u513f\u7ae5\u5728\u7ebf\u9884\u8ba2\u3002\u5982\u9700\u9884\u8ba2\uff0c\u8bf7\u81f4\u7535\u643a\u7a0b\u3002"):(Z=v[0],F=v[1],S<Z?Y?m&&C&&C<q?(B="X",U="\u51fa\u884c\u5f53\u65e5\u672a\u6ee1".concat(q,"\u5929\u7684\u5a74\u513f\uff0c\u8bf7\u81f3\u822a\u7a7a\u516c\u53f8\u552e\u7968\u5904\u7533\u8bf7\u8d2d\u4e70\u673a\u7968")):w&&w<z?(B="X",U="\u51fa\u884c\u4eba\u5e74\u9f84\u5747\u5927\u4e8e\u7b49\u4e8e".concat(z,"\u4e2a\u6708")):B="B":(B="X",U="\u672c\u4ea7\u54c1\u4e0d\u63a5\u53d7\u5c0f\u4e8e"+Z+"\u5c81\u7684\u513f\u7ae5\u5728\u7ebf\u9884\u8ba2\u3002\u5982\u9700\u9884\u8ba2\uff0c\u8bf7\u81f4\u7535\u643a\u7a0b\u3002"):S>=Z&&S<F?B="C":S>=F&&(B="A")),{type:B,errorMsg:U,minAge:Z,maxAge:F,age:S}};function He(e){return e?e.replace(/\s/g,"").replace(/(^\d{3})(?=\d)/g,"$1 ").replace(/(\d{4})(?=\d)/g,"$1 "):e}function qe(e){if(!e)return"";try{var t=(0,R.Z)(e),n=t.map((function(e,n){return n<3||n>t.length-5?e:"*"}));return n.join("")}catch(t){return e}}var Ke=function(e){var t=e.split(""),n=t.length,r=t.map((function(e,t){return n<5?e:n>=11?t<=n-5&&t>=n-8?"*":e:t<=n-3&&t>=n-5?"*":e}));return r.join("")};function ze(e){var t=e.IdCardType&&+e.IdCardType,n=e.IdCardNo&&String(e.IdCardNo);if(!n)return"";try{var r=(0,R.Z)(n);if(1===t){var a=r.map((function(e,t){return t<4||t>r.length-4?e:"*"}));return a.join("")}var o=Math.floor(r.length/3)+1,i=Math.floor(r.length/2),s=Math.floor(o/2),c=r.map((function(e,t){return t>i-s&&o>0?(o--,"*"):e}));return c.join("")}catch(e){return n}}function Ye(e){if(oe.isEmpty(e))return 0;var t=0,n=0;oe.forEach(e,(function(e){t+=e.price*e.count,n+=e.count}));var r=t/n,a=oe.indexOf(String(r),".");return a>-1&&(a=String(r).length-1-a),a>2&&(r=+r.toFixed(2)),r}var We={INSURANCE:"INSURANCE",SINGLE_ROOM_CHARGE:"SINGLE_ROOM_CHARGE"},$e=[1,12,2,14],Xe={MAJOR:"MAJOR",ADDITION:"ADDITION",NONE:"NONE"},Je={1:"\u65c5\u6e38\u9669",2:"\u53d6\u6d88\u9669",3:"\u81ea\u9a7e\u9669",4:"\u62d2\u7b7e\u9669",5:"\u95e8\u7968\u9669",6:"\u822a\u73ed\u5ef6\u8bef\u9669",7:"\u822a\u7a7a\u610f\u5916\u9669",8:"\u8d26\u6237\u5b89\u5168\u9669",9:"\u623f\u5c4b\u9669",10:"\u8f66\u8f86\u9669",11:"\u56fd\u5185\u7528\u8f66",12:"\u822a\u7a7a\u9669",14:"\u6574\u5355\u53d6\u6d88\u9669"},Qe=function(e,t){var n={},r={},a=e||{},o=a.Insurances,s=void 0===o?[]:o,c=a.room,l=void 0===c?[]:c,u=et(s,t)||{},d=u.insResourceInfo,f=u.insShoppingInfo;n["INSURANCE"]=d,r["INSURANCE"]=f;var p=l&&l.filter((function(e){return"virtualRoom"===e.resourceType}))[0];if(p){var m=p.groups,h=void 0===m?[]:m,v=h&&h.filter((function(e){return"virtualRoom"===e.type}))[0];if(v){var g=v.virtualRooms,y=g[0],_=y.VirtualRoom,b=y.SelectedInfo,I=_||{},x=I.Shoppings,T=void 0===x?[]:x;n["SINGLE_ROOM_CHARGE"]=T.map((function(e){var t=e.Token,n=e.Count,r=e.Relations,a=void 0===r?[]:r,o=0,i=0,s=0,c=0,l=0,u=0,d=0,f=0;return a&&a.map((function(e){var t=e.totalPrice,n=void 0===t?0:t,r=e.totalTradePrice,a=void 0===r?0:r,p=e.CategoryId,m=e.Count;o+=n,u+=a,30===p&&(i+=n,d+=a,c+=m),54===p&&(s+=n,f+=a,l+=m)})),{Token:t,Count:n,totalPrice:o&&parseInt(o+"")||0,singleRoomTotalPrice:i,childBedTotalPrice:s,totalTradePrice:u&&parseInt(u+"")||0,singleRoomTradeTotalPrice:d,childBedTradeTotalPrice:f,singleRoomCount:c,childBedCount:l}})),b&&(r["SINGLE_ROOM_CHARGE"]=(0,i.Z)((0,i.Z)({},b),{},{Count:b.SelectedCount}))}}var k=nt(d,f);return{shoppingDic:r,resourceDic:n,showResourceDic:k}},et=function(e,t){if(!e||!e.length)return{insResourceInfo:null,insShoppingInfo:null};var n={},r={},a=[],o={},i={},s={},c={},l=!1,u=!1,d={svipCancellation:[],commonCancleTokens:[],floatCancellation:[],levleCancleTokens:[]},f={},p=!1;return e&&e.forEach((function(e){var n=(null===e||void 0===e?void 0:e.MainInsurance)||{},m=n.CategoryId,h=void 0===m?0:m,v=n.Tags,g=void 0===v?[]:v,y=n.Basic,_=void 0===y?{}:y,b=n.SelectedInfo,I=void 0===b?{}:b;if(!oe.includes($e,h))return!1;var x=_||"",T=x.Token,k=void 0===T?"":T,S=g.filter((function(e){return"saleTag"===e.Code}))[0],C=S&&S.Values&&S.Values[0]&&+S.Values[0]||0;if(2===h||14===h){if(p)return;1===C?d.svipCancellation.push(k):2===C?d.levleCancleTokens.push(k):3===C&&(c[2]&&(c[2].forEach((function(e){delete r[e]})),a=oe.difference(a,c[2])),o[2]=[],c[2]=[],p=!0),oe.includes([1,2],C)||(a.push(k),d.commonCancleTokens.push(k)),14===h&&d.floatCancellation.push(k)}else a.push(k);var w=!oe.isEmpty(e.AdditionalInsurances),N=w?Xe.MAJOR:Xe.NONE,E=tt(e.MainInsurance,N,t);r[E.token]=E,!l&&1===E.category&&E.resourceShoppingInfo&&E.resourceShoppingInfo.insurancePriceList&&E.resourceShoppingInfo.insurancePriceList.length&&(l=!0),!u&&E.resourceShoppingInfo&&(E.resourceShoppingInfo.price||E.resourceShoppingInfo.childPrice)&&(u=!0),14===E.category?oe.includes([1,2],C)||(o[2]?o[2].unshift(E.token):o[2]=[E.token]):(2===E.category&&!oe.includes([1,2],C)||2!==E.category)&&(o[E.category]?o[E.category].push(E.token):o[E.category]=[E.token]),(oe.includes([2,14],E.category)&&!oe.includes([1,2],C)||!oe.includes([2,14],E.category))&&(c[E.category]?c[E.category].push(E.token):c[E.category]=[E.token]),I&&I.SelectedCount&&(f[k]={token:k,category:h,count:null===I||void 0===I?void 0:I.SelectedCount,useDate:null===I||void 0===I?void 0:I.UseDate,useEndDate:null===I||void 0===I?void 0:I.EndUseDate}),oe.isEmpty(e.AdditionalInsurances)||oe.forEach(e.AdditionalInsurances,(function(e){var t=e.SelectedInfo,n=tt(e,Xe.ADDITION);s[n.token]?s[n.token].push(E.token):s[n.token]=[E.token],i[E.token]?i[E.token].push(n.token):i[E.token]=[n.token],(oe.includes([2,14],E.category)&&!oe.includes([1,2],C)||!oe.includes([2,14],E.category))&&a.push(n.token),r[n.token]=n,c[n.category]?c[n.category].push(n.token):c[n.category]=[n.token],t&&t.SelectedCount&&(f[n.token]={token:n.token,category:n.category,count:null===t||void 0===t?void 0:t.SelectedCount,useDate:null===t||void 0===t?void 0:t.UseDate,useEndDate:null===t||void 0===t?void 0:t.EndUseDate})}))})),n.insuranceDic=r,n.insuranceSortList=a,n.insuranceCategoryTokenMap=o,n.majorAndAdditionTokenMap=i,n.additionAndMajorTokenMap=s,n.hasAgeRules=l,n.specialTokens=d,n.allInsuranceCategoryTokenMap=c,n.hasNeedPayIns=u,{insResourceInfo:n,insShoppingInfo:f}},tt=function(e,t,n){var r,a={};t=t||Xe.NONE;var o=e||{},i=o.Basic,s=void 0===i?{}:i,c=o.BMStatus,l=void 0===c?0:c,u=o.CategoryId,d=void 0===u?0:u,f=o.Shopping,p=void 0===f?{}:f,m=o.Tags,h=void 0===m?[]:m,v=o.Flags,g=void 0===v?[]:v,y=o.ExtendInfos,_=void 0===y?[]:y,b=o.InsuranceDay,I=void 0===b?{}:b,x=o.TravelDay,T=void 0===x?{}:x,k=o.TokenInfo,S=void 0===k?"":k,C=[],w=0;h&&oe.forEach(h,(function(e){"mainSpecialTag"===e.Code?C=e.Values:"profitRate"===e.Code&&(w=e.Values&&e.Values[0]&&+e.Values[0]||0)}));var N={};if(N.name=(null===s||void 0===s?void 0:s.Name)||"",N.token=(null===s||void 0===s?void 0:s.Token)||"",N.productId=(null===s||void 0===s?void 0:s.Id)||0,N.tagList=C,N.BMStatus=l,N.ProfitRate=w,N.dayTo=(null===I||void 0===I?void 0:I.Max)||0,N.dayFrom=(null===I||void 0===I?void 0:I.Min)||0,N.maxTravelDays=(null===T||void 0===T?void 0:T.Max)||0,N.minTravelDays=(null===T||void 0===T?void 0:T.Min)||0,N.svipCancellation=oe.includes(g,"svipCancellation"),a.baseInfo=N,a.token=null===s||void 0===s?void 0:s.Token,a.category=d,a.categoryText=Je[d],a.customInsuranceType=t,a.Shoppings=[p],null!==p&&void 0!==p&&null!==(r=p.SectionPrices)&&void 0!==r&&r.length){var E=[];oe.forEach(p.SectionPrices,(function(e){var t=e.MinAge,n=void 0===t?0:t,r=e.MaxAge,a=void 0===r?0:r;E.length?(n<E[0]&&(E[0]=n),a>E[1]&&(E[1]=a)):(E[0]=n,E[1]=a)})),E[1]>E[0]&&(a.baseInfo.tipMessage="\u8be5\u4fdd\u9669\u53ea\u652f\u6301".concat(E[0],"-").concat(E[1],"\u5c81\u65c5\u5ba2\u9884\u8ba2"),a.baseInfo.ageRule=E)}var P={};P.defaultCount=null===p||void 0===p?void 0:p.DefaultCount;var j=p.UnitPriceInfos,O=void 0===j?[]:j,D=O.filter((function(e){return 26===e.Age}))[0]||{},R=O.filter((function(e){return 4===e.Age}))[0]||{};P.price=(null===D||void 0===D?void 0:D.Price)||0,P.tradePrice=(null===D||void 0===D?void 0:D.TradePrice)||0,P.childPrice=(null===R||void 0===R?void 0:R.Price)||0,P.childTradePrice=(null===R||void 0===R?void 0:R.TradePrice)||0,P.unit="\u4efd",P.stepCount=null===p||void 0===p?void 0:p.StepCount,P.minCount=null===p||void 0===p?void 0:p.MinCount,P.maxCount=null===p||void 0===p?void 0:p.MaxCount,P.insurancePriceList=null===p||void 0===p?void 0:p.SectionPrices,P.useDateTimestamp=(null===p||void 0===p?void 0:p.StartDate)&&ye.transformTimeStamp(null===p||void 0===p?void 0:p.StartDate)||0,P.momentUseDate=new ye(P.useDateTimestamp).format()||"",P.useDate=null===p||void 0===p?void 0:p.StartDate,P.useEndDate=null===p||void 0===p?void 0:p.EndDate,P.isRequired=1===l,P.category=d,P.tokenInfo=S;var A=n||{},M=A.orderBasicInfo,V=M||{},L=V.AdultCount,B=void 0===L?0:L,U=V.ChildCount,Z=void 0===U?0:U;P.averagePrice=Ye([{price:P.price,count:B},{price:P.childPrice,count:Z}]),P.averagePriceDes="".concat(P.averagePrice?"\xa5"+P.averagePrice:"\u8d60\u9001","x").concat(P.stepCount?P.stepCount:"/").concat(P.unit),a.resourceShoppingInfo=P;var F={};return _&&oe.forEach(_,(function(e){"DetailUrl"===e.Key&&(F.detailUrl=e.Value)})),F.name=null===s||void 0===s?void 0:s.Name,a.addInfo=F,a},nt=function(e,t,n){if(!e)return{};var r={insuranceCategoryTokenMap:{},majorAndAdditionTokenMap:{},insuranceList:[]},a=(e.allInsuranceCategoryTokenMap,e.insuranceCategoryTokenMap),o=void 0===a?{}:a,i=e.majorAndAdditionTokenMap,s=void 0===i?{}:i,c=e.specialTokens,l=void 0===c?{}:c,u=l||{};u.svipCancellation,u.commonCancleTokens;return oe.forEach($e,(function(e){var a=o[e];a&&(oe.forEach(a,(function(a){(t[a]&&t[a].count||n&&n.isShow&&n.lowPriceToken===a)&&(r.insuranceCategoryTokenMap[e]?r.insuranceCategoryTokenMap[e].push(a):r.insuranceCategoryTokenMap[e]=[a],r.insuranceList.push(a),s[a]&&(oe.forEach(s[a],(function(e){t[e]&&t[e].count&&(r.majorAndAdditionTokenMap[a]?r.majorAndAdditionTokenMap[a].push(e):r.majorAndAdditionTokenMap[a]=[e],r.insuranceList.push(e))})),r.majorAndAdditionTokenMap[a]||(r.majorAndAdditionTokenMap[a]=[s[a][0]],r.insuranceList.push(s[a][0]))))})),r.insuranceCategoryTokenMap[e]||(r.insuranceCategoryTokenMap[e]=[a[0]],r.insuranceList.push(a[0]),s[a[0]]&&(r.majorAndAdditionTokenMap[a[0]]=[s[a[0]][0]],r.insuranceList.push(s[a[0]][0]))))})),r},rt={REQUIRED:1,HIDE:2,NEED_DATE:4,RELEATED:8,DEFAULT:16,RECOMMEND:32,WHITE_LIST:64},at=function(e){return(e&rt.REQUIRED)===rt.REQUIRED},ot=function(e){return(e&rt.DEFAULT)===rt.DEFAULT},it=function(e,t){var n=t||{},r=n.cardRelationRules,a=void 0===r?[]:r,o=n.items,i=void 0===o?{}:o,s=n.notRelationItem,c=void 0===s?[]:s,l=(n.destType,e&&a.filter((function(t){return+t.customerInfoItemType===+e}))[0]||null);if(l){l=oe.cloneDeep(l);var u=l,d=u.cardRelationItem,f=void 0===d?[]:d;i.UserName&&(f.push("UserName"),oe.remove(f,(function(e){return"ChineseName"===e||"EnglishName"===e})));var p=f.concat(c),m={};return p.map((function(e){return m[e]=!0})),m}var h={};for(var v in i)h[v]=!0;return h},st=function(e,t){var n=t.orderBasicInfo,r=void 0===n?{}:n,a=t.productBasicInfo,o=void 0===a?{}:a,i=t.ageBaseLine,s=void 0===i?"":i,c=t.tagInfo,l=void 0===c?{}:c,u=(null===e||void 0===e?void 0:e.Birthday)||"",d={type:"U"};return u&&(d=Ge({birthday:u,isRestrictChild:!0,dateline:s,trainChildStandard:null,orderBasicInfo:r,tagInfo:l,productBasicInfo:o})),d},ct=function(e,t){var n=t.tagInfo,r=void 0===n?{}:n,a=t.orderBasicInfo,o=void 0===a?{}:a,i=r.trainChildPriceStandard,s=o.ReturnDate,c=e.Birthday||"",l={type:"U"};return c?l=Ge({birthday:c,isRestrictChild:!0,dateline:s,trainChildStandard:i}):1===e.AgeRang?l.type=Pe.adult:0===e.AgeRang?l.type=Pe.child:2===e.AgeRang&&(l.type=Pe.free),l},lt=function(e,t){var n=e.DeliveryInfoList,r=(e.SelfPickupAddress,e.UserProfile),a=void 0===r?{}:r,o=(e.CityName,a||{}),i=o.IsDiamond,s=void 0!==i&&i,c=o.IsIntegralDelivery,l=void 0!==c&&c;if(n&&n.length){var u=[],d={},f={};if(oe.forEach(n,(function(e,n){t?null==t.Title?0==e.IsHasInvoice&&(f=e):t.IsSelectedEinvoice||1!=e.IsHasInvoice?t.IsSelectedEinvoice&&0==e.IsHasInvoice&&(f=e):f=e:0==e.IsHasInvoice&&(f=e)})),!f.DeliveryTypeList||!f.DeliveryTypeList.length)return;return oe.forEach(f.DeliveryTypeList,(function(e){d[e.Dtype]={amount:e.DeliveryAmount,name:e.DeliveryTypeName};var t={};1===e.Dtype?(t.sort=2,t.type=e.Dtype,t.name=e.DeliveryTypeName,t.list=[],s?t.list.push({remark:"\u4ee5\u5ba2\u670d\u786e\u8ba4\u4e3a\u51c6",amount:e.IntegralDeliverAmount,detail:"(\u94bb\u77f3\u4f1a\u5458\u53ef\u51cf10\u5143)"}):l&&e.IntegralDeduction?(t.list.push({remark:"\u914d\u9001\u8d39"+e.DeliveryAmount+"\u5143",amount:e.DeliveryAmount}),t.list.push({remark:e.IntegralDeduction+"\u79ef\u5206\u62b5"+Math.floor(e.DeliveryAmount-e.IntegralDeliverAmount)+"\u5143",amount:e.IntegralDeliverAmount,IntegralDeduction:e.IntegralDeduction})):t.list.push({remark:e.DeliveryAmount+"\u5143",amount:e.DeliveryAmount})):2===e.Dtype?(t.sort=3,t.type=e.Dtype,t.name=e.DeliveryTypeName,t.list=[],t.list.push({remark:"\u9700\u5230\u95e8\u5e97\u81ea\u53d6",amount:e.DeliveryAmount})):3===e.Dtype?(t.sort=1,t.type=e.Dtype,t.name=e.DeliveryTypeName,t.list=[],s?t.list.push({remark:"\u514d\u8d39(\u94bb\u77f3\u4f1a\u5458\u4e13\u4eab)",amount:0}):l&&e.IntegralDeduction?(t.list.push({remark:"\u914d\u9001\u8d39"+e.DeliveryAmount+"\u5143",amount:e.DeliveryAmount}),t.list.push({remark:e.IntegralDeduction+"\u79ef\u5206\u62b5"+Math.floor(e.DeliveryAmount-e.IntegralDeliverAmount)+"\u5143",amount:e.IntegralDeliverAmount,IntegralDeduction:e.IntegralDeduction})):t.list.push({remark:e.DeliveryAmount+"\u5143",amount:e.DeliveryAmount})):5===e.Dtype&&(t.sort=0,t.type=e.Dtype,t.name=e.DeliveryTypeName,t.list=[],s?t.list.push({remark:"\u4ee5\u5ba2\u670d\u786e\u8ba4\u4e3a\u51c6",amount:e.IntegralDeliverAmount,detail:"(\u94bb\u77f3\u4f1a\u5458\u53ef\u51cf10\u5143)"}):l?(t.list.push({remark:"\u914d\u9001\u8d39"+e.DeliveryAmount+"\u5143",amount:e.DeliveryAmount}),t.list.push({remark:e.IntegralDeduction+"\u79ef\u5206\u62b5"+Math.floor(e.DeliveryAmount-e.IntegralDeliverAmount)+"\u5143",amount:e.IntegralDeliverAmount,IntegralDeduction:e.IntegralDeduction})):t.list.push({remark:e.DeliveryAmount?e.DeliveryAmount+"\u5143":"\u514d\u8d39",amount:e.DeliveryAmount})),u.push(t)})),{isHasInvoice:f.IsHasInvoice,cityName:e.CityName,deliveryInfo:f.DeliveryTypeList,materialsInfo:f.DeliveryGoodsDescriptionList,selfPickupAddress:e.SelfPickupAddress,scrollUiData:u,valueOfType:d,isDlyShow:0===f.IsHasInvoice||1===f.IsHasInvoice&&t&&t.Title&&!t.IsSelectedEinvoice}}},ut=function(e,t,n){var r={},a=n&&n.DeliveryType;if(a)r=n;else{var o=t.scrollUiData&&t.scrollUiData.length&&t.scrollUiData[0]||{};if(a=o.type,2===a?r.AddressInfo={Address:t.selfPickupAddress[0]}:r=n||{},n)r.IsUseIntegral=n.IsUseIntegral;else if(e&&e.UserProfile){var i=e.UserProfile;!i.IsDiamond&&i.IsIntegralDelivery&&2!==a&&5!==a&&o.list&&o.list.length>1?r.IsUseIntegral=!0:r.IsUseIntegral=!1}}return a&&(r.DeliveryType=a),r};function dt(e){var t=e.DeliveryInfo,n=e.formatDlyData;if(!n)return null;var r,a,o,i=t.DeliveryType,s=n.scrollUiData.filter((function(e){return e.type===i}));return s=s[0],s&&(2===i?(r="",a=s.list[0].amount||0,o=t.AddressInfo):t.IsUseIntegral&&s.list[1]?(r=s.list[1].remark,a=s.list[1].amount):(r=s.list[0].remark,a=s.list[0].amount)),a=parseInt(a),t.IsUseIntegral||0!=a||(r="\u514d\u8d39"),{curDelivery:s,remark:r,amount:a,address:o}}function ft(e,t){try{var n=[];return e.map((function(e){var r=t[e];r.age&&r.age>0?n.push(r.age):1===r.AgeRang?n.push(26):0===r.AgeRang?n.push(4):2===r.AgeRang&&n.push(1)})),n.length?n:null}catch(e){return null}}function pt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=[],o=n.map((function(e){return r[e]}));return null===t||void 0===t||t.map((function(t){var n=t.ResourceInfo||{},r=n.Token,i=n.ResourceType,s=n.CategoryId,c=n.MinAge,l=void 0===c?0:c,u=n.MaxAge,d=void 0===u?0:u;if(5!==i){var f=3===i&&15===s,p="03TL"===r.substr(0,4),m=r&&"04TO"===t.ResourceInfo.Token.substr(0,4),h=0,v=[];o.map((function(e){(!e.age||-1===e.age||0===l&&0===d||0!==l&&0===d&&e.age>=l||0===l&&0!==d&&e.age<=d||0!==l&&0!==d&&e.age>=l&&e.age<=d)&&((f||p||m)&&e.age>=0||2!==e.AgeRang&&e.age)&&(v.push(String(e.PassengerID)),h++)})),a.push(r);for(var g,y,_=t.PassengerInfo.AdultCount+t.PassengerInfo.ChildCount,b=(t.PassengerInfo&&t.PassengerInfo.OrderType,0),I=e.length;b<I;b++)e[b].ResourceToken===r&&(g=e[b],y=b);var x=v,T=h;if(g){for(var k=g.PassengerTokenList||[],S=!0,C=0,w=k.length;C<w;C++)if(x.indexOf(k[C])<0){S=!1;break}S&&k.length===_||(e.splice(y,1),T===_&&e.push({ResourceToken:r,PassengerTokenList:x.slice(0,_)}))}else T===_&&e.push({ResourceToken:r,PassengerTokenList:x.slice(0,_)})}})),e=e.filter((function(e){return a.indexOf(e.ResourceToken)>-1})),e}function mt(e,t,n){var r={},a=e||{},o=a.InfantCount,i=void 0===o?0:o;if(t&&t.OrderPassenger&&t.OrderPassenger.PassengerRules&&t.OrderPassenger.PassengerRules.length){var s=n&&n.FlightInfos&&n.FlightInfos.length,c=t.OrderPassenger.PassengerRules||[];if(c.length){var l=[],u=[];c.map((function(e){"child"===e.PassengerType?l.push(e):"infant"===e.PassengerType&&u.push(e)})),l.length&&s&&(r.isSupportChild=!0,r.child=l),i&&u.length&&(r.isSupportInfant=!0,r.infant=u[0])}}return{passengerRules:r}}function ht(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t||{},r=n.insuranceCategoryTokenMap,a=void 0===r?{}:r,o=n.insuranceDic,i=void 0===o?{}:o,s=!1,c=Object.keys(a),l=0;l<c.length;l++){if(s)break;for(var u=a[c[l]]||[],d=0;d<u.length;d++){if(s)break;var f=i[u[d]];(ot(f.baseInfo.BMStatus)||at(f.baseInfo.BMStatus))&&(s=!0)}}if(s)return!1;var p=!!e&&!!Object.keys(e).length&&Object.keys(e).filter((function(t){var n=e[t];return n.count>0})).length>0;return!p}function vt(e,t){var n=[],r=[],a=[];return t.map((function(e){0===e.AgeRang&&e.age&&n.push(e.age)})),e.map((function(e){var t=e.MinAge,o=e.MaxAge,i=e.Count,s=(r.filter((function(e){return t<=e&&e<o})),n.filter((function(e){return t<=e&&e<o})));i!==s.length&&a.push("\u8bf7\u9009"+i+"\u4f4d"+t+"-"+o+"\u5468\u5c81(\u4e0d\u542b)\u7684\u513f\u7ae5")})),a.length?[!1,a]:[!0]}function gt(e,t,n){var r=e.majorAndAdditionTokenMap,a=void 0===r?{}:r,o=t.insuranceList,i=void 0===o?[]:o;return oe.includes(i,n)||(t.insuranceList.push(n),t.insuranceCategoryTokenMap[1]?t.insuranceCategoryTokenMap[1].push(n):t.insuranceCategoryTokenMap[1]=[n],a&&a[n]&&(t.majorAndAdditionTokenMap[n]?t.majorAndAdditionTokenMap[n].push(a[n][0]):t.majorAndAdditionTokenMap[1]=[a[n][0]])),t}function yt(e){var t=e.ResourcePassengerMapList,n=void 0===t?[]:t,r=e.cruise,a=void 0===r?[]:r;if(!a||!a.length)return!1;var o=!0;return oe.forEach(a,(function(e){if(o){var t=e||{},r=t.cabinIds,a=void 0===r?[]:r,i=t.totalCount,s=void 0===i?0:i,c=t.Basic,l=void 0===c?{}:c,u=l||{},d=u.MinNum,f=u.MaxNum,p=0,m=!0;oe.forEach(a,(function(e){var t,r=n.filter((function(t){return t.ResourceToken===e}))[0],a=(null===r||void 0===r||null===(t=r.PassengerTokenList)||void 0===t?void 0:t.length)||0;(!a||a<d||a>f)&&(m=!1),m&&(p+=a)})),m&&p===s||(o=!1)}})),o}function _t(e,t){var n=e||{},r=n.isShowOldMan,a=n.isShowUnderAge,o=n.airlineClause,i=void 0===o?[]:o,s=n.highMessage,c=void 0===s?[]:s,l=t||{},u=l.ContractContent,d=[],f=[];if(oe.isEmpty(t)||f.push("\u9884\u8ba2\u987b\u77e5"),r&&f.push("\u8001\u5e74\u4eba\u51fa\u884c\u63d0\u793a"),c&&c.length&&f.push("\u9ad8\u6d77\u62d4\u63d0\u793a"),a&&f.push("\u672a\u6210\u5e74\u4eba\u4fe1\u606f\u6536\u96c6\u63d0\u793a"),f.length){var p="";1===f.length?p=f[0]:2===f.length?p=f[0]+"\u4e0e"+f[1]:f.length>2&&(p=f[0],f.forEach((function(e,t){t>0&&t<f.length-1&&(p+="\u3001".concat(e))})),p+="\u4e0e".concat(f[f.length-1])),d.push({key:"basic",name:p,tabName:"\u9884\u8ba2\u987b\u77e5"})}return u&&d.push({key:"contract",name:"\u5408\u540c\u6761\u6b3e",tabName:"\u5408\u540c\u6761\u6b3e"}),null!==i&&void 0!==i&&i.length&&i.forEach((function(e,t){d.push({key:"fly_"+t,name:e.Name,tabName:e.Name,desc:e.Desc})})),d}var bt={"\u6b27\u9633":"ouyang","\u592a\u53f2":"taishi","\u7aef\u6728":"duanmu","\u4e0a\u5b98":"shangguan","\u53f8\u9a6c":"sima","\u4e1c\u65b9":"dongfang","\u72ec\u5b64":"dugu","\u5357\u5bab":"nangong","\u4e07\u4fdf":"moqi","\u95fb\u4eba":"wenren","\u590f\u4faf":"xiahou","\u8bf8\u845b":"zhuge","\u5c09\u8fdf":"yuchi","\u516c\u7f8a":"gongyang","\u8d6b\u8fde":"helian","\u6fb9\u53f0":"tantai","\u7687\u752b":"huangfu","\u5b97\u653f":"zongzheng","\u6fee\u9633":"puyang","\u516c\u51b6":"gongye","\u592a\u53d4":"taishu","\u7533\u5c60":"shentu","\u516c\u5b59":"gongsun","\u6155\u5bb9":"murong","\u4ef2\u5b59":"zhongsun","\u949f\u79bb":"zhongli","\u957f\u5b59":"zhangsun","\u5b87\u6587":"yuwen","\u53f8\u5f92":"situ","\u9c9c\u4e8e":"xianyu","\u53f8\u7a7a":"sikong","\u95fe\u4e18":"lvqiu","\u5b50\u8f66":"ziju","\u4e93\u5b98":"qiguan","\u53f8\u5bc7":"sikou","\u5deb\u9a6c":"wuma","\u516c\u897f":"gongxi","\u989b\u5b59":"zhuansun","\u58e4\u9a77":"rangsi","\u516c\u826f":"gongliang","\u6f06\u96d5":"qidiao","\u4e50\u6b63":"yuezheng","\u8c37\u6881":"guliang","\u62d3\u8dcb":"tuoba","\u5939\u8c37":"jiagu","\u8f69\u8f95":"xuanyuan","\u4ee4\u72d0":"linghu","\u6bb5\u5e72":"duangan","\u767e\u91cc":"baili","\u547c\u5ef6":"huyan","\u4e1c\u90ed":"dongguo","\u5357\u95e8":"nanmen","\u7f8a\u820c":"yangshe","\u5fae\u751f":"weisheng","\u516c\u6237":"gonghu","\u516c\u7389":"gongyu","\u516c\u4eea":"gongyi","\u6881\u4e18":"liangqiu","\u516c\u4ef2":"gongzhong","\u516c\u4e0a":"gongshang","\u516c\u95e8":"gongmen","\u516c\u5c71":"gongshan","\u516c\u575a":"gongjian","\u5de6\u4e18":"zuoqiu","\u516c\u4f2f":"gongbo","\u897f\u95e8":"ximen","\u516c\u7956":"gongzu","\u7b2c\u4e94":"diwu","\u516c\u4e58":"gongsheng","\u8d2f\u4e18":"guanqiu","\u516c\u7699":"gongxi","\u5357\u8363":"nanrong","\u4e1c\u91cc":"dongli","\u4e1c\u5bab":"donggong","\u4ef2\u957f":"zhongchang","\u5b50\u4e66":"zishu","\u5b50\u6851":"zisang","\u5373\u58a8":"jimo","\u8fbe\u595a":"daxi","\u891a\u5e08":"chushi","\u5bb0\u7236":"zaifu"},It=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/((\w+)|(\W+?))/g,"$1#").split("#").filter(Boolean)},xt=function(e,t,n,r){if(!e)return{};var a=It(t),o=It(n),i=Tt(a,r[0]),s=Tt(o,r[1]),c=kt(i),l=kt(s),u={};return c||oe.isEmpty(i)||(u.eNLastName=a.map((function(e){return i[e][0]})).join("")),l||oe.isEmpty(s)||(u.eNFirstName=o.map((function(e){return s[e][0]})).join("")),{nameList:(0,f.Z)({},e,{isNeedSplit:!0,lastNameList:i,firstNameList:s}),popLastNameIndex:c&&!oe.isEmpty(i)?1:-1,popFirstNameIndex:l&&!oe.isEmpty(s)?1:-1,enName:u}},Tt=function(e,t){if(!t)return{};for(var n={},r=0;r<e.length;r++){var a=e[r],o=t[r].split(",");n[a]=o.map((function(e){return e.toLocaleUpperCase()}))}return n},kt=function(e){return!oe.isEmpty(Object.values(e).filter((function(e){return(null===e||void 0===e?void 0:e.length)>1})))},St=function(e){var t=e.map((function(e){return e.split(",")})),n=[],r=0;return oe.isEmpty(t)||(r=1,oe.forEach(t,(function(e){return r*=e.length||1})),n=Array(r).fill(""),oe.forEach(t,(function(e,t){var a=e.length;oe.forEach(e,(function(e,t){var o=oe.range(t,r,a);oe.forEach(o,(function(t){n[t]+=e}))}))}))),console.log("getAllPinYin\ud83e\udd21",n),n},Ct=["requireInfo"],wt=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n,r){var o,i,s,c,l;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t.getDHTLogger&&t.getDHTLogger(),s=new Set,c=[],r&&r.length&&r.map((function(e){var t=e.commonPassenger&&e.commonPassenger.nationality||"";t&&!s.has(t)&&(s.add(t),c.push({Key:"nationality",Value:t}))})),c.push({Key:"passengerCoreVersion",Value:"2"}),e.next=6,t.post("GetDisplayItem",{bizType:"PKG",productToken:n,parameterList:c});case 6:return l=e.sent,i&&i.logActionInfo({attrs:[{key:"shoppingid",value:n}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"passenger template 20168/GetDisplayItem",rootMessageId:null===l||void 0===l||null===(o=l.ResponseStatus)||void 0===o||null===(o=o.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===o?void 0:o.Value}),e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Nt=function(e,t,n){var r={},a=e.map((function(e){var a=e||{},o=a.commonPassenger,s=void 0===o?{}:o,c=a.validatePassenger,l=void 0===c?{}:c,u=s.nationality,d=void 0===u?"":u,f=s.passengerID,p=l||{},m=p.canUse,h=p.validatePassengerCards,v=void 0===h?[]:h,g=e.chosenInfo||t&&t[f]||{},y=(null===g||void 0===g?void 0:g.chosenCards)||[],_=n.AvailableCardInfo,b=_.find((function(e){return e.Nationality===d})),I=y.length&&y.join("@")+"@".concat(d)||"";if(I&&!r[I]){r[I]={};var x=Et(y,b);oe.isEmpty(x)||(r[I]=x)}var T="T"===m;return y.length&&T&&y.forEach((function(e){if(T){var t,n=v&&v.find((function(t){return t.cardType===e}));if(n)"T"!==n.canUse&&(T=!1);else r[I]&&!0!==(null===(t=r[I][e])||void 0===t?void 0:t.giveLater)&&(T=!1)}})),(0,i.Z)({isComplete:T,passengerID:+f,chosenInfo:g},e)}));return a},Et=function(e,t){var n=(null===t||void 0===t?void 0:t.CardInfo)||[],r={};return n.map((function(t){var n=t.AvailableCardInfoList,a=void 0===n?[]:n,o={},i=a.map((function(e){return o[e.CardType]={},o[e.CardType].giveLater=e.giveLater,e.CardType}));i.length===e.length&&e.every((function(e){return i.includes(e)}))&&(r=o)})),r},Pt=function(e,t,n){var r=!0,a=Et(e,t);return e.length&&e.forEach((function(e){var t,o=n&&n.find((function(t){return t.cardType===e}));o?"T"!==o.canUse&&(r=!1):a&&!0!==(null===(t=a[e])||void 0===t?void 0:t.giveLater)&&(r=!1)})),{checkResult:r,cardStatus:a}},jt=function(e,t){t.shoppingId;var n=t.CommonPassengers,r=t.passengerObj,a=void 0===r?{}:r,o=t.isCheck,s=void 0!==o&&o,c=t.chosenInfoMap,l=void 0===c?{}:c,u=t.tagInfo,d=void 0===u?{}:u,f=t.template,p=(0,i.Z)({},a),m=n.filter((function(t){return oe.includes(e,t.passengerID)})),h=f||{},v=h.FormInfos,g=h.AvailableCardInfo;return oe.forEach(m,(function(e){var n=e.commonPassenger,r=void 0===n?{}:n,a=e.passengerID,o=e.chosenInfo,i=void 0===o?{}:o,c=e.validatePassenger,u=void 0===c?{}:c,f=e.isComplete,m=void 0!==f&&f,h=r||{},y=h.nationality,_=void 0===y?"":y,b=(h.availableCards,h.child),I=void 0!==b&&b,x=u||{},T=x.validatePassengerCards,k=void 0===T?[]:T,S=x.prompts,C=void 0===S?[]:S,w=(null===i||void 0===i?void 0:i.chosenCards)||[],N=(null===i||void 0===i||i.unEffect,p[a]),E=g.find((function(e){return e.Nationality===_})),P={};if(l&&l[a]){var j=l[a]||{},O=j.chosenCards;if(O&&O.length){var D=Pt(O,E,k),R=D.checkResult,A=D.cardStatus;R&&(w=O,P=A)}}else if(s&&N&&N.chosenInfo){var M=N.chosenInfo.chosenCards;if(M&&M.length){var V=Pt(M,E,k),L=V.checkResult,B=V.cardStatus;L&&(w=M,P=B)}}oe.isEmpty(P)&&(P=Et(w,E));var U=[],Z=[],F=[],G=[],H={},q=v.filter((function(e){return e.Key===_}))[0]||{};if(oe.forEach(q.FormFields,(function(e){if(e.Key===_&&oe.forEach(e.FieldGroup,(function(e){var t=e.Type,n=e.Fields;oe.forEach(n,(function(e){if("nametype"===e.Name&&e.Data&&e.Data.length){var n=e.Data.filter((function(e){return"type"===e.Key}))[0],r=(null===n||void 0===n?void 0:n.Value)&&+n.Value;r&&!oe.includes(Z,r)&&Z.push(r),"effect"===t&&(1==r?H["cname"]=!0:2===r?H["ename"]=!0:3===r&&(H["cname"]=!0,H["ename"]=!0))}if("mobiletype"===e.Name&&e.Data&&e.Data.length){var a=e.Data.filter((function(e){return"type"===e.Key}))[0],o=(null===a||void 0===a?void 0:a.Value)&&+a.Value;1===o?(U.push("mobilePhone"),U.push("countryCode")):2===o&&U.push("mobilePhone")}else U.push(e.Name),"effect"===t&&(H[e.Name]=!0)}))})),oe.includes(w,e.Key)){var t,n=e.FieldGroup.find((function(e){return"effect"===e.Type})),r=n.Fields,a=void 0===r?[]:r,o=[],i={},s=null===(t=P[e.Key])||void 0===t?void 0:t.giveLater;oe.forEach(a,(function(e){if("passenger"===e.Type&&"nametype"===e.Name&&e.Data&&e.Data.length){var t=e.Data.filter((function(e){return"type"===e.Key}))[0],n=(null===t||void 0===t?void 0:t.Value)&&+t.Value;n&&!oe.includes(Z,n)&&Z.push(n),1==n?H["cname"]=!0:2===n?H["ename"]=!0:3===n&&(H["cname"]=!0,H["ename"]=!0)}else"card"===e.Type&&(o.push(e.Name),s||(i[e.Name]=!0))})),F.push({key:e.Key,value:o,giveLater:s}),H[e.Key]=i}})),1===Z.length){var K=Z[0];switch(K){case 1:U.push("cnname");break;case 2:U.push("enfirstname"),U.push("enlastname");break;case 3:U.push("cnname"),U.push("enfirstname"),U.push("enlastname");break;default:break}}else U.push("cnname"),U.push("enfirstname"),U.push("enlastname");U=oe.uniq(U);var z=Ot(U,G,F,r);if(z.isComplete=m,i.chosenCards=w,z.chosenInfo=i,z.requireInfo=H,z.child=I,w&&w.length&&(C||(C=[]),oe.forEach(k,(function(e){oe.includes(w,e.cardType)&&e.prompts&&e.prompts.length&&(C=C.concat(e.prompts))}))),z.prompts=C,d&&d.isTrain){var Y=ct(z,t);"A"===Y.type?(z.Height="above_150",z.TrainType="A"):null!==N&&void 0!==N&&N.Height&&(z.Height=N.Height)}p[a]=z})),p},Ot=function(e,t,n,r){var a=r.passengerCards,o=void 0===a?[]:a,i=r.birthday,s=r.gender,c=r.nationality,l=r.countryCode,u=r.mobilePhone,d=r.passengerID,f=r.cNName,p=r.eNLastName,m=r.eNFirstName,h=r.birthPlace,v=r.data,g=void 0===v?{}:v,y={PassengerID:+d,defaultPhoneInfo:{countryCode:"86"},idInfo:{},idInfos:[],isProvideLater:!1},_=p&&m?"".concat(p,"/").concat(m):"";return y.userNameObj={cNName:f,eName:_},oe.forEach(e,(function(e){switch(e){case"birthday":y.Birthday=i;break;case"gender":y.Gender=s;break;case"nationality":y.Nationality=c;break;case"countryCode":y.defaultPhoneInfo.countryCode=l;case"mobilePhone":y.defaultPhoneInfo.mobilePhone=u;break;case"cnname":y.CNName=f;break;case"enlastname":y.ENLastName=p;break;case"enfirstname":y.ENFirstName=m;break;case"birthPlace":y.BirthPlace=h;break;case"customertype":y.CustomerType=(null===g||void 0===g?void 0:g.customertype)||"";break;case"taiwancustomertype":y.CustomerType=(null===g||void 0===g?void 0:g.taiwancustomertype)||"";break}})),oe.forEach(n,(function(e){var t=e.key,n=e.value,r=e.giveLater,a={IdCardType:t},i=o.filter((function(e){return t===e.cardType}))[0]||{};a.cardName=i.cardName||"",oe.forEach(n,(function(e){var t,n,o,s,c,l;switch(e){case"cardNumber":a.IdCardNo=i.cardNumber||"",r&&!i.cardNumber&&(y.isProvideLater=!0);break;case"cardTimelimit":a.IdCardValidDate=i.cardTimelimit||"",r&&!i.cardTimelimit&&(y.isProvideLater=!0);break;case"endorsementtype":a.VisaType=(null===i||void 0===i||null===(t=i.data)||void 0===t?void 0:t.endorsementtype)||"",!r||null!==i&&void 0!==i&&null!==(n=i.data)&&void 0!==n&&n.endorsementtype||(y.isProvideLater=!0);break;case"issueplace":a.IssuePlace=(null===i||void 0===i||null===(o=i.data)||void 0===o?void 0:o.issueplace)||"",!r||null!==i&&void 0!==i&&null!==(s=i.data)&&void 0!==s&&s.issueplace||(y.isProvideLater=!0);break;case"issuedate":a.IssueDate=(null===i||void 0===i||null===(c=i.data)||void 0===c?void 0:c.issuedate)||"",!r||null!==i&&void 0!==i&&null!==(l=i.data)&&void 0!==l&&l.issuedate||(y.isProvideLater=!0);break}})),y.idInfos.push(a)})),y.idInfo=y.idInfos[0]||{},y},Dt=function(e){var t={},n=e.requireInfo,r=void 0===n?{}:n,a=(0,A.Z)(e,Ct),o=a.PassengerID,i=a.Nationality,s=a.CNName,c=a.ENFirstName,l=a.ENLastName,u=a.ENMiddleName,d=a.Gender,f=a.Birthday,p=a.BirthPlace,m=a.CustomerType,h=a.defaultPhoneInfo,v=void 0===h?{}:h,g=a.idInfos,y=void 0===g?[]:g,b=(a.chosenInfo,a.isProvideLater),I=void 0!==b&&b;s&&(s=s.trim()),c&&(c=c.trim()),l&&(l=l.trim()),u&&(u=u.trim());var x=[];for(var T in a)switch(T){case"CNName":t["CnName"]=s,r.cname&&!s&&x.push(T);break;case"ENLastName":case"ENFirstName":t["EnName"]={First:c||"",Mid:u||"",Last:l||""},!r.ename||l&&c||x.push(T);break;case"Nationality":t["Nationality"]=i;break;case"Gender":t["Gender"]="F"===d?1:"M"===d?0:-1,r.gender&&!d&&x.push(T);break;case"Birthday":var k=f||"";t["Birthday"]=k,r.birthday&&!k&&x.push(T);break;case"BirthPlace":t["HomePlace"]=p,r.birthPlace&&!p&&x.push(T);break;case"CustomerType":t["CustomerType"]=m,r.customertype&&!m&&x.push(T),r.taiwancustomertype&&!m&&x.push("taiwancustomertype");break;default:break}var S=v||{},C=S.countryCode,w=S.mobilePhone;return t["MobilePhone"]=w||"",t["CountryCode"]=C||"",r.mobiletype&&!t["MobilePhone"]&&x.push("mobiletype"),t["IdCardInfo"]=[],oe.forEach(y,(function(e){var n=e.IdCardType,a=e.IdCardNo,o=e.IdCardValidDate,i=e.IssuePlace,s=e.IssueDate,c=e.VisaType;if(t["IdCardInfo"].push({IdCardType:n&&+n||0,IdCardNo:a||"",IdCardValidDate:o||"",IssuePlace:i||"",IssueDate:s||"",VisaType:c||""}),r[n]&&(r[n].cardNumber&&!a&&x.push("".concat(n,"-cardNumber")),r[n].cardTimelimit&&!o&&x.push("".concat(n,"-cardTimelimit")),r[n].issueplace&&!i&&x.push("".concat(n,"-issueplace")),r[n].issuedate&&!s&&x.push("".concat(n,"-issuedate")),r[n].endorsementtype&&!c&&x.push("".concat(n,"-endorsementtype"))),n&&1===+n&&a){var l=Be(a);if(l){var u=l.sex,d=l.age;t["Birthday"]=d,t["Gender"]="F"===u?1:"M"===u?0:-1}t["Nationality"]="CN"}})),t["EnName"]||(t["EnName"]={First:"",Mid:"",Last:""}),"number"!==typeof t["Gender"]&&(t["Gender"]=-1),t["Incomplete"]=0,e.Height&&(t["Height"]=e.Height),(0,_.Z)(e.AgeRang)&&(t["AgeRang"]=e.AgeRang),t.PassengerId=o&&String(o)||0,I&&(t["IdCardInfo"]=[],t["IdCardInfo"].push({IdCardType:100,IdCardNo:"",IdCardValidDate:"",IssuePlace:"",IssueDate:"",VisaType:""})),{passenger:t,missItems:x}},Rt=["idInfos","defaultPhoneInfo","CustomerType"],At=function(e,t,n){if(!e||!e.length)return[];var r=null;return"2"===(null===n||void 0===n?void 0:n.version)?(r=Nt(e,t,n),r):(r=e.map((function(e){var n,r=(null===e||void 0===e||null===(n=e.commonPassenger)||void 0===n?void 0:n.passengerID)||"",a=e.chosenInfo||t&&t[r]||{},o=Mt(e,a)||{};return(0,i.Z)((0,i.Z)({},e),o)})),r)},Mt=function(e,t){var n=e||{},r=n.commonPassenger,a=void 0===r?{}:r,o=n.validatePassenger,i=void 0===o?{}:o,s=a||{},c=s.availableCards,l=void 0===c?[]:c,u=i||{},d=u.canUse,f=void 0===d?"F":d,p=u.passengerID,m=void 0===p?"":p,h=u.validatePassengerCards,v=void 0===h?[]:h,g=!0;if(l&&l.length){var y=t.chosenCards,_=void 0===y?[]:y,b=t.unEffect,I=void 0===b?"T":b,x=Ut({ids:_,chosenType:I},l,v),T=x.result;g=T}return{isComplete:"T"===f&&g,passengerID:+m,chosenInfo:t}},Vt=function(e,t){var n=(0,R.Z)(e);return t&&oe.forEach(t,(function(e){if(n.length>=5)return!1;e.isComplete&&!oe.includes(n,e.passengerID)&&n.push(e.passengerID)})),n},Lt=function(e,t){var n=(0,R.Z)(e);return t&&oe.forEach(t,(function(e){if(n.length>=5)return!1;oe.includes(n,e.passengerID)||n.push(e.passengerID)})),n},Bt=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n,r){var o,s,c,l,u,d,f,p,m,h,v,g,y,_,b,I,x,T,k,S,C,w;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=r.shoppingId,s=r.CommonPassengers,c=r.passengerObj,l=void 0===c?{}:c,u=r.isCheck,d=void 0!==u&&u,f=r.chosenInfoMap,p=void 0===f?{}:f,m=r.tagInfo,h=void 0===m?{}:m,v=r.template,g=(0,i.Z)({},l),n&&n.length){e.next=4;break}return e.abrupt("return",g||{});case 4:if("2"!==(null===v||void 0===v?void 0:v.version)){e.next=6;break}return e.abrupt("return",jt(n,r));case 6:if(y=s.filter((function(e){return oe.includes(n,e.passengerID)})),e.prev=7,_=v,_){e.next=16;break}return b=[],oe.forEach(y,(function(e){var t,n=(null===e||void 0===e||null===(t=e.commonPassenger)||void 0===t?void 0:t.nationality)||"";n&&!oe.includes(b,n)&&b.push(n)})),I=b.map((function(e){return{Key:"nationality",Value:e}})),e.next=15,t.post("GetDisplayItem",{bizType:"PKG",productToken:o,parameterList:I});case 15:_=e.sent;case 16:return x=_||{},T=x.FormInfos,k=void 0===T?[]:T,S=x.AvailableCardInfo,C=void 0===S?[]:S,w=!(null===C||void 0===C||!C.length),oe.forEach(y,(function(e){var t,n,a,o,s=e.commonPassenger,c=void 0===s?{}:s,l=e.passengerID,u=e.chosenInfo,f=void 0===u?{}:u,m=e.validatePassenger,v=void 0===m?{}:m,y=e.isComplete,_=void 0!==y&&y,b=c||{},I=b.nationality,x=void 0===I?"":I,T=b.availableCards,S=void 0===T?[]:T,N=b.child,E=void 0!==N&&N,P=v||{},j=P.validatePassengerCards,O=void 0===j?[]:j,D=P.prompts,R=void 0===D?[]:D,A=null===C||void 0===C?void 0:C.filter((function(e){return"nationality"===e.Nationality&&"uneffect"===e.Type})).length,M=(null===k||void 0===k?void 0:k.filter((function(e){return e.Key===x}))[0])||{};f=(0,i.Z)({},f)||{};var V=(null===(t=f)||void 0===t?void 0:t.chosenCards)||[],L="T"===(null===(n=f)||void 0===n?void 0:n.unEffect)?"T":"F",B=g[l];if(w)if(p&&p[l]){var U=p[l]||{},Z=U.chosenCards,F=U.unEffect,G=Ut({ids:Z,chosenType:F},S,O),H=G.result,q=G.chooseCards,K=G.chosenType;H&&(V=q,L=K)}else if(d&&B&&B.chosenInfo){var z=B.chosenInfo,Y=z.chosenCards,W=void 0===Y?[]:Y,$=z.unEffect,X=void 0===$?"T":$;if("T"!==X||A){var J=Ut({ids:W,chosenType:X},S,O),Q=J.result,ee=J.chooseCards,te=J.chosenType;Q&&(V=ee,L=te)}else;}var ne="F"===L?"effect":"uneffect",re=[],ae=[],ie=[],se={};if(oe.forEach(M.FormFields,(function(e){if(e.Key===x||oe.includes(V,e.Key)){var t=(null===e||void 0===e?void 0:e.FieldGroup.filter((function(e){return e.Type===ne}))[0])||{},n=(null===t||void 0===t?void 0:t.Fields)||[],r=[],a={};oe.forEach(n,(function(e){if("passenger"===e.Type){if("nametype"===e.Name&&e.Data&&e.Data.length){var t=e.Data.filter((function(e){return"type"===e.Key}))[0],n=(null===t||void 0===t?void 0:t.Value)&&+t.Value;n&&!oe.includes(ae,n)&&ae.push(n)}if("mobiletype"===e.Name&&e.Data&&e.Data.length){var o=e.Data.filter((function(e){return"type"===e.Key}))[0],i=(null===o||void 0===o?void 0:o.Value)&&+o.Value;1===i?(re.push("mobilePhone"),re.push("countryCode")):2===i&&re.push("mobilePhone"),se[e.Name]=!e.Present}else re.push(e.Name),se[e.Name]=!e.Present}else"card"===e.Type&&(r.push(e.Name),a[e.Name]=!e.Present)})),oe.includes(V,e.Key)&&(ie.push({key:e.Key,value:r}),se[e.Key]=a)}})),1===ae.length){var ce=ae[0];switch(ce){case 1:re.push("cnname");break;case 2:re.push("enfirstname"),re.push("enlastname");break;case 3:re.push("cnname"),re.push("enfirstname"),re.push("enlastname");break;case 4:"en"===(null===(a=f)||void 0===a?void 0:a.nameType)?(re.push("enfirstname"),re.push("enlastname")):"cn"===(null===(o=f)||void 0===o?void 0:o.nameType)||"CN"===x?re.push("cnname"):(re.push("enfirstname"),re.push("enlastname"));break;default:break}}else re.push("cnname"),re.push("enfirstname"),re.push("enlastname");re=oe.uniq(re);var le=Gt(re,ie,c);if(le.isComplete=_,f.chosenCards=V,f.unEffect=L,le.chosenInfo=f,le.requireInfo=se,le.child=E,V&&V.length&&(R||(R=[]),oe.forEach(O,(function(e){oe.includes(V,e.cardType)&&e.prompts&&e.prompts.length&&(R=R.concat(e.prompts))}))),le.prompts=R,h&&h.isTrain){var ue=ct(le,r);"A"===ue.type?(le.Height="above_150",le.TrainType="A"):null!==B&&void 0!==B&&B.Height&&(le.Height=B.Height)}g[l]=le})),e.abrupt("return",g);case 22:throw e.prev=22,e.t0=e["catch"](7),console.log(e.t0),e.t0;case 26:case"end":return e.stop()}}),e,null,[[7,22]])})));return function(t,n,r){return e.apply(this,arguments)}}(),Ut=function(e,t,n){var r=e.ids,a=e.chosenType,o=[],i=[];oe.forEach(t,(function(e){var t=e.cardInfo,n=e.type,r=void 0===n?"":n,a=t.map((function(e){return e.cardType}));"effect"===r&&a&&a.length?o.push(a):"uneffect"===r&&a&&a.length&&i.push(a)}));var s=!0,c=[];return a&&"T"!==a||(oe.forEach(i,(function(e){if(s){var t=oe.intersection(e,r)||[],a=n.filter((function(e){return oe.includes(t,e.cardType)&&"T"===e.canUse}))[0];a?c.push(a.cardType):s=!1}})),!a&&s&&(a="T")),(a||s)&&"F"!==a||(oe.forEach(o,(function(e){if(s){var t=oe.intersection(e,r)||[],a=n.filter((function(e){return oe.includes(t,e.cardType)&&"T"===e.canUse}))[0];a?c.push(a.cardType):s=!1}})),!a&&s&&(a="F")),{result:s,chooseCards:c,chosenType:a}},Zt=function(e,t,n,r){var a="";if(t&&t[e]){var o=t[e],i=o.CNName,s=o.ENFirstName,c=o.ENLastName,l=o.ENMiddleName,u=c&&s?"".concat(c,"/").concat(s," ").concat(l||""):"";a=r&&i&&u?"".concat(i," ").concat(u):i||u}else if(n){var d=n.filter((function(t){return t.passengerID===e}))[0];if(d){var f=d.commonPassenger,p=void 0===f?{}:f,m=p||{},h=m.cNName,v=m.eNFirstName,g=m.eNLastName,y=m.eNMiddleName,_=g&&v?"".concat(g,"/").concat(v," ").concat(y||""):"";a=r&&h&&_?"".concat(h," ").concat(_):h||_}}if(""===a.trim()&&t[e]){var b=t[e]||{},I=b.userNameObj;a=(null===I||void 0===I?void 0:I.cNName)||(null===I||void 0===I?void 0:I.eName)}return a},Ft=function(e,t,n){e.sort((function(e,n){return t[n].age-t[e].age}));var r=n.orderBasicInfo,a=r||{},o=a.AdultCount,i=void 0===o?0:o,s=a.ChildCount,c=void 0===s?0:s,l=a.InfantCount,u=void 0===l?0:l,d=(a.numErrorTip,a.totalPersonCount,0),f=0,p=0;return oe.forEach(e,(function(e){var n=t[e],r=n.type,a=1,o=!1;"A"===r?(d++,a=1):"C"===r?(f++,a=0):"B"===r?(p++,a=2):"U"===r?(d<i?(d++,a=1):f<c?(f++,a=0):(p++,a=2),o=!0):"Y"===r?(f<c?(f++,a=0):(d++,a=1),o=!0):"W"===r&&(p<u?(p++,a=2):(d++,a=1),o=!0),n.AgeRang=a,n.MayChange=o})),{selectIds:e,passengers:t}},Gt=function(e,t,n){var r=n.passengerCards,a=void 0===r?[]:r,o=n.birthday,i=n.gender,s=n.nationality,c=n.countryCode,l=n.mobilePhone,u=n.passengerID,d=n.cNName,f=n.eNLastName,p=n.eNFirstName,m=n.birthPlace,h=n.data,v=void 0===h?{}:h,g={PassengerID:+u,defaultPhoneInfo:{countryCode:"86"},idInfo:{},idInfos:[]},y=f&&p?"".concat(f,"/").concat(p):"";return g.userNameObj={cNName:d,eName:y},oe.forEach(e,(function(e){switch(e){case"birthday":g.Birthday=o;break;case"gender":g.Gender=i;break;case"nationality":g.Nationality=s;break;case"countryCode":g.defaultPhoneInfo.countryCode=c;case"mobilePhone":g.defaultPhoneInfo.mobilePhone=l;break;case"cnname":g.CNName=d;break;case"enlastname":g.ENLastName=f;break;case"enfirstname":g.ENFirstName=p;break;case"birthplace":g.BirthPlace=m;break;case"customertype":g.CustomerType=(null===v||void 0===v?void 0:v.customertype)||"";break;case"taiwancustomertype":g.CustomerType=(null===v||void 0===v?void 0:v.taiwancustomertype)||"";break}})),oe.forEach(t,(function(e){var t=e.key,n=e.value,r={IdCardType:t},o=a.filter((function(e){return t===e.cardType}))[0]||{};if(r.cardName=o.cardName,oe.forEach(n,(function(e){var t,n,a;switch(e){case"cardNumber":r.IdCardNo=o.cardNumber;break;case"cardTimelimit":r.IdCardValidDate=o.cardTimelimit;break;case"endorsementtype":r.VisaType=null===o||void 0===o||null===(t=o.data)||void 0===t?void 0:t.endorsementtype;break;case"issueplace":r.IssuePlace=null===o||void 0===o||null===(n=o.data)||void 0===n?void 0:n.issueplace;break;case"issuedate":r.IssueDate=null===o||void 0===o||null===(a=o.data)||void 0===a?void 0:a.issuedate;break}})),g.idInfos.push(r),1===+t&&r.IdCardNo&&!g.Birthday){var i=Be(r.IdCardNo);i&&i.sex&&i.age&&(g.Birthday=i.age,g.Gender=i.sex)}})),g.idInfo=g.idInfos[0]||{},g},Ht=function(e){var t={ExtendInfo:[]},n=e.idInfos,r=void 0===n?[]:n,a=e.defaultPhoneInfo,o=void 0===a?{}:a,i=e.CustomerType,s=(0,A.Z)(e,Rt);for(var c in s)switch(c){case"Birthday":t.Birthday=s[c];break;case"Gender":t.Gender=s[c];break;case"Nationality":t.Nationality=s[c];break;case"CNName":t.CNName=s[c];break;case"ENLastName":t.ENLastName=s[c];break;case"ENFirstName":t.ENFirstName=s[c];break;case"PassengerID":t.PassengerId=s["PassengerID"]+"";break}i&&t.ExtendInfo.push({Key:"customertype",Value:i});var l=o||{},u=l.countryCode,d=l.mobilePhone;u&&(t.CountryCode=u),d&&(t.MobilePhone=d);var f=r.map((function(e){var t=e||{},n=t.IssuePlace,r=void 0===n?"":n,a=t.IssueDate,o=void 0===a?"":a,i=t.VisaType,s=void 0===i?"":i,c={CardType:null===e||void 0===e?void 0:e.IdCardType,CardNumber:null===e||void 0===e?void 0:e.IdCardNo,CardTimelimit:null===e||void 0===e?void 0:e.IdCardValidDate,ExtendInfo:[]};return r&&c.ExtendInfo.push({Key:"issueplace",Value:null===e||void 0===e?void 0:e.IssuePlace}),o&&c.ExtendInfo.push({Key:"issuedate",Value:null===e||void 0===e?void 0:e.IssueDate}),s&&c.ExtendInfo.push({Key:"endorsementtype",Value:null===e||void 0===e?void 0:e.VisaType}),c}));return t.CardInfos=f,t},qt=function(e,t){try{var n=e||{},r=n.Birthday,a=void 0===r?"":r;if(a){t=ye.parse(t).format("YYYY-MM-DD")||"";var o=Fe(a,t);return o}return-1}catch(e){return-1}},Kt=function(e){var t=[];return null===e||void 0===e||e.forEach((function(e){if(!oe.isEmpty(e)){var n=oe.cloneDeep(e),r=n||{},a=r.defaultPhoneInfo,o=void 0===a?{}:a,i=r.idInfos,s=void 0===i?[]:i,c=r.idInfo,l=void 0===c?{}:c,u=o||{},d=u.mobilePhone;d&&(o.mobilePhone=qe(d)),null!==l&&void 0!==l&&l.IdCardNo&&(l.IdCardNo=ze(l)),oe.forEach(s,(function(e){null!==e&&void 0!==e&&e.IdCardNo&&(e.IdCardNo=ze(e))})),t.push(n)}})),t},zt=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n,r){var o,i,s,c,l,u,d,f;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=[],!(n.length>=2)){e.next=17;break}s=[],c=[],l=[],0,u=(0,a.Z)().mark((function e(){var t,u,f,p,m,h,v,g,y,_,b,I,x,T;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=n[d],u=t.CNName,f=t.ENLastName,p=t.ENFirstName,m=t.idInfo,void 0===m?{}:m,h=t.idInfos,v=void 0===h?[]:h,g="",y="",u&&(g=u),f&&p&&(y=f.toLowerCase()+"/"+p.toLowerCase()),!r||!(g&&s.indexOf(g)>-1||y&&c.indexOf(y)>-1)){e.next=10;break}return _=g&&s.indexOf(g)>-1?g:y,o=[1,["\u60a8\u9009\u62e9\u7684\u51fa\u884c\u4eba\u59d3\u540d\u76f8\u540c\uff1a",_,"\u8bf7\u5206\u4e24\u5f20\u8ba2\u5355\u63d0\u4ea4"]],e.abrupt("return",1);case 10:g&&s.push(g),y&&c.push(y),g&&!y&&i.push(g);case 13:!o&&v&&v.length&&(b=[],v.map((function(e){e.IdCardType&&e.IdCardNo&&b.push(e.IdCardType+"@"+e.IdCardNo+"@"+e.cardName)})),l.length?(I="",x="",oe.forEach(l,(function(e){if(!I){var t=e||{},n=t._cardArr,r=void 0===n?[]:n,a=t._name;I=oe.intersection(r,b)[0],x=a}})),I?(T=I.split("@"),o=[2,["".concat(g||y,"\u3001").concat(x,"\u8bc1\u4ef6\u53f7\u76f8\u540c"),"".concat(T[2]).concat(T[1]),"\u8bf7\u68c0\u67e5\u51fa\u884c\u4eba\u4fe1\u606f"]]):l.push({_cardArr:b,_name:g||y})):l.push({_cardArr:b,_name:g||y}));case 14:case"end":return e.stop()}}),e)})),d=0;case 5:if(!(d<n.length)){e.next=12;break}return e.delegateYield(u(),"t0",7);case 7:if(!e.t0){e.next=9;break}return e.abrupt("break",12);case 9:d++,e.next=5;break;case 12:if(f=i.filter((function(e){return/[\u0100-\uffff]/.test(e)})),o||!r||!f.length){e.next=17;break}return e.next=16,Promise.all(f.map((function(e){return t.post("ConvertPinyinWords",{Words:e.trim(),timeout:1e3})}))).then((function(e){var t;if(e.length){var n=e.map((function(e,t){if(e&&e.Body&&e.Body.length){var n=e.Body.join("");return n.indexOf(",")>-1||f[t].match(/[a-zA-Z]+/g)?St(e.Body):[n]}return""}));c.length&&c.map((function(e){var t=e.replace("/","").trim();n.push([t])}));for(var r=[],a=0,o=function(e){if(a=oe.findIndex(r,(function(t){return oe.intersection(t,n[e]).length>0})),console.log(n[e],a),n[e]&&a>-1)return t=[1,["\u60a8\u9009\u62e9\u7684\u51fa\u884c\u4eba\u59d3\u540d\u62fc\u97f3\u76f8\u540c\uff1a","".concat(f[a],",").concat(f[e]||n[e]&&n[e][0]),"\u8bf7\u5206\u4e24\u5f20\u8ba2\u5355\u63d0\u4ea4"]],1;r.push(n[e])},i=0;i<n.length;i++)if(o(i))break}return t})).catch((function(e){return t.logPageError("sanmename-ConvertPinyinWords",e),null}));case 16:o=e.sent;case 17:return e.abrupt("return",o);case 18:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Yt=function(e,t,n){var r=n[e],a=r||{},o=a.idInfos,i=void 0===o?[]:o;if(oe.isEmpty(r)||oe.isEmpty(i))return null;var s=[],c=[];return i.map((function(e){e.IdCardType&&e.IdCardNo&&c.push(e.IdCardType+"@"+e.IdCardNo+"@"+e.cardName)})),oe.forEach(t,(function(t){if(!s.length){var r=n[t],a=r||{},o=a.idInfos,i=void 0===o?[]:o;if(t!==e&&i&&i.length){var l=[];i.map((function(e){e.IdCardType&&e.IdCardNo&&l.push(e.IdCardType+"@"+e.IdCardNo+"@"+e.cardName)}));var u=oe.intersection(c,l);u.length&&s.push(t)}}})),s.length&&s.unshift(e),s.length?s:null},Wt=function(e,t){var n=e.TrainPassengerMapList,r=e.tagInfo,a=e.selectIds,o=e.passengerObj;if(null===r||void 0===r||!r.isTrain||!a||!a.length)return{};var s=oe.cloneDeep(o),c=0,l=[],u=[];if(a.map((function(t){var n=(0,i.Z)({},s[t]),r=ct(n,e),a=r.type;a===Pe.free?u.push(String(n.PassengerID)):(n.Height=a,n.Height!==Pe.adult&&n.Height!==Pe.child||c++,n.Height===Pe.adult&&l.push(String(n.PassengerID))),s[t]=n})),"usr"===t){var d=u.slice(l.length)||[];u.map((function(e){var t=s[e]||{};t.Height||(d.includes(e)?(s[e].Height=Pe.child,c++):s[e].Height=Pe.free)}))}var f=[];return n&&n.length&&n.forEach((function(e){var t;l.indexOf(e.AdultPassengerToken)>-1&&u.indexOf(e.ChildPassengerToken)>-1&&(null===(t=s[e.ChildPassengerToken])||void 0===t?void 0:t.Height)===Pe.free&&f.push(e)})),{TrainPassengerMapList:f,passengerObj:s,trainChildPassengerIds:u,trainSeatNum:c}},$t=function(e){var t=e.selectIds,n=void 0===t?[]:t,r=e.passengerObj,a=e.orderBasicInfo,o=void 0===a?{}:a,i=e.ResourcePassengerMapList,s=void 0===i?[]:i,c=e.ResourcePassengers,l=e.shoppinginfo,u=void 0===l?{}:l,d=e.resourceinfo,f=void 0===d?{}:d,p=e.cruise,m=void 0===p?[]:p,h=e.productBasicInfo,v=void 0===h?{}:h,g=o||{},y=g.totalPersonCount,_=void 0===y?0:y,b=g.cabinNum,I=void 0===b?0:b,x=n.map((function(e){return String(e)}));if(_!==x.length)return{};var T=!0;oe.forEach(x,(function(e){T&&!r[e].isComplete&&(T=!1)}));var k=[],S=f["INSURANCE"],C=S||{},w=C.insuranceDic,N=void 0===w?{}:w;oe.forEach(u,(function(e,t){"INSURANCE"===t&&oe.forEach(e,(function(e,t){var n=N[t]||{};14===(null===n||void 0===n?void 0:n.category)&&r[x[0]].isComplete?k.push({ResourceToken:t,PassengerTokenList:x.slice(0,1)}):T&&k.push({ResourceToken:t,PassengerTokenList:x})}))}));var E=pt((0,R.Z)(s),c,n,r);if(E&&(k=oe.concat(k,(0,R.Z)(E))),m&&m.length)if(1===I){var P=m[0].cabinIds[0];k.push({ResourceToken:P,PassengerTokenList:x})}else{var j=v||{},O=j.childStandard,D=void 0===O?{}:O,A=D||{},M=A.cruiseAge,V=void 0===M?18:M;oe.forEach(m,(function(e){var t=e||{},n=t.cabinIds,a=void 0===n?[]:n,o=(t.totalCount,t.Basic),i=void 0===o?{}:o,c=i||{},l=c.MinNum,u=c.MaxNum;c.OvaryRoomId;oe.forEach(a,(function(e){var t=s.filter((function(t){return t.ResourceToken===e}))[0],n=t&&t.PassengerTokenList&&t.PassengerTokenList.length||0;if(n&&n>=l&&n<=u){var a=!1;t.PassengerTokenList.map((function(e){var t=r[e];t.age&&t.age>=V&&(a=!0)})),a&&oe.intersection(x,t.PassengerTokenList).length===n&&k.push(t)}}))}))}return{ResourcePassengerMapList:k}},Xt=function(e){var t=e.sharedRoomInfo,n=e.selectIds,r=e.orderBasicInfo,a=e.passengerObj;if(oe.isEmpty(t))return{};var o={},s=(t.status,t.passengerId);if(s>0)if(oe.includes(n,s)){var c=Zt(s,a);o={name:c,passengerId:s}}else o={name:"",passengerId:0};if(1===(null===r||void 0===r?void 0:r.totalPersonCount)&&n&&n.length&&-1!==s){var l=Zt(n[0],a);o={name:l,passengerId:n[0]}}return{sharedRoomInfo:(0,i.Z)((0,i.Z)({},t),o)}},Jt=function(e){e.shark;var t=e.selectIds,n=e.passengerObj,r=e.noPhoneError,a=void 0===r?"":r,o=e.userNotice,s=void 0===o?{}:o,c=e.OrderNoticeInfo,l=!1,u=!1,d=0;null===t||void 0===t||t.forEach((function(e){var t,r=n[e];(null===r||void 0===r?void 0:r.age)>=70&&(l=!0),null!==r&&void 0!==r&&r.child&&(u=!0),null!==r&&void 0!==r&&null!==(t=r.defaultPhoneInfo)&&void 0!==t&&t.mobilePhone&&d++}));var f="";d?a&&(f=""):f="\u8bf7\u81f3\u5c11\u586b\u5199\u4e00\u4f4d\u51fa\u884c\u4eba\u65c5\u5ba2\u7684\u624b\u673a\u53f7\u7801";var p=(0,i.Z)({},s),m=l||u||!!p.highMessage.length||!!p.airlineClause.length;return p.isShowOldMan=l,p.isShowUnderAge=u,p.isShow=m,p.tipMessages=_t(p,c),p.isShow=p.tipMessages&&!!p.tipMessages.length||!1,{userNotice:p,noPhoneError:f}},Qt=function(e){var t=e.memberinfo,n=e.selectIds,r=void 0===n?[]:n,a=e.passengerObj,o=t||{},s=o.rooms,c=void 0===s?[]:s,l=o.mgrGroup,u=void 0===l?{}:l;if(null===c||void 0===c||!c.length)return{};var d=!1,f=c.map((function(e){var t=e||{},n=t.mgrGroupId,o=u[n]||{},s=o.cNName,c=o.cNSurname,l=o.eNLastName,f=o.eNFirstName,p=o.isRestrictMyCheckIn;if(p&&(c||l)){d=!0;var m=null===r||void 0===r?void 0:r.some((function(e){var t=a[e],n=t.CNName,r=t.ENFirstName,o=t.ENLastName;return n===c+s||o===l&&r===f}));return m?(delete e.isNotInChoosePsg,e):(0,i.Z)((0,i.Z)({},e),{},{isNotInChoosePsg:!0})}return e}));return d?{memberinfo:(0,i.Z)((0,i.Z)({},t),{},{rooms:f})}:{}},en=function(e){var t=e.ContactInfo,n=void 0===t?{}:t,r=e.selectIds,a=void 0===r?[]:r,o=e.passengerObj,i=e.memberinfo,s=void 0===i?{}:i,c=e.contactShowItems;if(!s)return null;var l=s.isNeedRegiHotel,u=void 0!==l&&l,d=s.rooms,f=void 0===d?[]:d,p=s.mgrGroup,m=void 0===p?{}:p;s.isSelectedPrivacyTerms;if(!u||!f||!f.length)return null;var h={},v=n.SurenameCN,g=n.GivenNameCN,y=n.Surname,_=n.GivenName,b=null===f||void 0===f?void 0:f.some((function(e){var t=e||{},n=t.mgrGroupId,r=m[n]||{},a=r.cNSurname,o=r.eNLastName,i=r.isRestrictMyCheckIn;return i&&!a&&!o}));if(b){var I=null===a||void 0===a?void 0:a.some((function(e){var t=o[e],n=t||{},r=n.CNName,a=n.ENFirstName,i=n.ENLastName;return r===v+g||i===y&&a===_}));I||(c.SurenameCN?h.SurenameCN="\u9700\u8981\u5165\u4f4f\u672c\u4eba\u6ce8\u518c":c.Surname&&(h.Surname="\u9700\u8981\u5165\u4f4f\u672c\u4eba\u6ce8\u518c"))}return h},tn=function(e){var t=e.ContactInfo,n=e.contactDealInfo,r=e.selectIds,a=void 0===r?[]:r,o=e.passengerObj,s=t||{},c=s.Moblie,l=void 0===c?"":c,u=n||{},d=u.initMobile,f=void 0===d?"":d,p=u.replaceInfo;if(!f||f!==l||null!==p&&void 0!==p&&p.isReplaceOver)return{};var m=(0,i.Z)({},n),h=[],v=!1;return a.map((function(e){var t,n,r;o&&o[e]&&null!==(t=o[e])&&void 0!==t&&null!==(t=t.defaultPhoneInfo)&&void 0!==t&&t.mobilePhone&&(v||f!==o[e].defaultPhoneInfo.mobilePhone||(v=!0),h.push({mobile:o[e].defaultPhoneInfo.mobilePhone,name:(null===(n=o[e])||void 0===n||null===(n=n.userNameObj)||void 0===n?void 0:n.cNName)||(null===(r=o[e])||void 0===r||null===(r=r.userNameObj)||void 0===r?void 0:r.eName),countrycode:o[e].defaultPhoneInfo.countryCode}))})),v?{}:(m.replaceInfo=h[0],a.length>1&&m.replaceInfo&&(m.replaceInfo.mulRepalceTipMessage="\u8bf7\u6ce8\u610f\u662f\u5426\u7528\u6b64\u53f7\u7801\u63a5\u6536\u8ba2\u5355\u4fe1\u606f"),{contactDealInfo:m})};function nn(e,t){if(oe.isEmpty(e)||oe.isEmpty(t))return"";if(e&&e.length){var n=t&&t.length&&t.filter((function(e){return e.ExtendInfos&&e.ExtendInfos[0]&&e.ExtendInfos[0].Value&&"flight_tips_multiple"===e.ExtendInfos[0].Value}))[0];return n&&n.Content?(console.log("Content========================",n.Content),n.Content):""}return""}function rn(e){if(oe.isEmpty(e))return"";var t;if(e&&e.length){var n=[],r=0;oe.forEach(e,(function(e){var t=e.SegmentNo,a=e.Flights,o=void 0===a?[]:a;t>r&&(n=o,r=t)})),n&&n.length&&(t=n[n.length-1])}return t&&t.DepartInfo&&t.DepartInfo.DateTime?(console.log("flightDate========================",t.DepartInfo.DateTime),t.DepartInfo.DateTime):""}function an(e){var t=e.nowAduit,n=void 0===t?0:t,r=e.nowChild,a=void 0===r?0:r,o=e.nowInfant,i=void 0===o?0:o,s=e.AdultCount,c=void 0===s?0:s,l=e.ChildCount,u=void 0===l?0:l,d=e.InfantCount,f=void 0===d?0:d,p=[],m=[];return c&&(c===n?p.push("\u6210\u4eba"):m.push("\u6210\u4eba")),u&&(u===a?p.push("\u513f\u7ae5"):m.push("\u513f\u7ae5")),f&&(f===i?p.push("\u5a74\u513f"):m.push("\u5a74\u513f")),p.length?"".concat(p.join("\u3001"),"\u6570\u5df2\u6ee1\uff0c\u8bf7\u9009\u62e9").concat(m.join("\u6216")):"\u8bf7\u9009\u62e9".concat(m.join("\u6216"))}function on(e,t,n){if(oe.isEmpty(e)||oe.isEmpty(t))return{};var r=e.insuranceCategoryTokenMap,a=void 0===r?{}:r,o=e.insuranceDic,i=void 0===o?{}:o,s=a["1"]||[];if(!s.length)return{};var c=[];for(var l in t){var u=i[l]||{},d=u.baseInfo,f=void 0===d?{}:d;oe.includes(s,l)&&ot(f.BMStatus)&&c.push(l)}if(c.length){var p=999999,m="",h=n.AdultCount,v=n.ChildCount;return oe.forEach(s,(function(e){if(!oe.includes(c,e)){var t=i[e]||{},n=t||{},r=n.resourceShoppingInfo,a=void 0===r?{}:r,o=a.price,s=a.childPrice,l=o*h+s*v,u=Math.ceil(l/(h+v));u<p&&u&&(p=u,m=e)}})),{lowPriceToken:m,defaultToken:c,isShow:!1}}return{}}function sn(e,t,n,r){if(!t||!t.length)return null;var a=n.Birthday,o=n.defaultPhoneInfo,i=void 0===o?{}:o,s=n.PassengerID,c=n.age,l=i||{},u=l.countryCode,d=void 0===u?"":u,f=l.mobilePhone,p=void 0===f?"":f;if("86"!==d)return null;if(c||(c=Fe(a,r)),c&&-1!=c&&c>=18&&c<=70){var m=t.map((function(t){return e[t]})),h=!1,v={};return oe.forEach(m,(function(t){var n=t.age,r=void 0===n?-1:n,a=t.defaultPhoneInfo,o=void 0===a?{}:a,i=o||{},c=i.countryCode,l=void 0===c?"":c,u=i.mobilePhone,d=void 0===u?"":u;if(-1!=r&&r>=18&&r<=70&&"86"===l&&d===p)return v.name=Zt(t.PassengerID,e),v.currentName=Zt(s,e),h=!0,!1})),h?v:null}return null}function cn(e,t){if(e&&t&&e.DeliveryType){var n,r=0;if(t.scrollUiData)oe.forEach(t.scrollUiData,(function(t,r){t.type===e.DeliveryType&&(n=t)})),n&&(r=2===e.DeliveryType?n.list[0].amount||0:e.IsUseIntegral?n.list[1].amount||0:n.list[0].amount||0);return r}return 0}function ln(e,t){var n;if(!e)return!1;var r=!1,a=t||{},o=a.priceDetailList,i=void 0===o?[]:o,s=i&&i.filter((function(e){return 1===e.priceType}))[0];return(null===s||void 0===s||null===(n=s.totalPrice)||void 0===n?void 0:n.totalPrice)>0&&(r=!0),r}function un(e,t){var n=[],r=t||{},a=r.priceDetailList,o=void 0===a?[]:a,i=o&&o.filter((function(e){return 1===e.priceType}))[0],s=i||{},c=s.resourcePriceDetailList,l=void 0===c?[]:c,u=e.insuranceDic,d=void 0===u?{}:u,f={};oe.forEach(l,(function(e){f[e.token]||(f[e.token]=[]),f[e.token].push(e)}));var p=oe.keys(f);return p.map((function(e){var t=f[e],r=d[e]||{},a=r.baseInfo,o=void 0===a?{}:a,i=r.category,s=r.Shoppings,c=void 0===s?[]:s,l=t.filter((function(e){return!!e.adultPrice}));if(l&&l.length){var u={InsuranceId:(null===o||void 0===o?void 0:o.productId)+"",Title:null===o||void 0===o?void 0:o.name,ExtendInfo:e};if(1===i&&c&&c.length){var p=c[0].StartDate,m=c[0].EndDate;p&&m&&(p=new ye(ye.transformTimeStamp(p)).format(),m=new ye(ye.transformTimeStamp(m)).format(),u.Desc="\u4fdd\u969c\u6709\u6548\u671f\uff1a".concat(p,"\u81f3").concat(m))}u.PriceNoteList=[],t.length>1||t[0].groupType?t.map((function(e){u.PriceNoteList.push({PriceText:"\xa5".concat(e.adultPrice,"/").concat(e.chargeUnit),Note:"".concat(e.groupName)})})):u.PriceNoteList.push({PriceText:"\xa5".concat(t[0].adultPrice,"/").concat(t[0].chargeUnit)}),n.push(u)}})),n}function dn(e,t){var n=e||{},r=n.insuranceDic,a=void 0===r?{}:r,o=[];return t.map((function(e){var t=e.PassengerTokenList,n=void 0===t?[]:t,r=e.ResourceToken,i=a[r]||{},s=i.baseInfo,c=void 0===s?{}:s,l=i.resourceShoppingInfo,u=void 0===l?{}:l;(null!==u&&void 0!==u&&u.price||null!==u&&void 0!==u&&u.childPrice)&&n.map((function(e){o.push({InsuranceId:(null===c||void 0===c?void 0:c.productId)+"",InsuredId:e+"",InsuranceExtendInfo:r,InsuredExtendInfo:""})}))})),o}function fn(e,t,n){var r=oe.cloneDeep(e)||{},a=[],o=[];t&&t.length&&oe.forEach(t,(function(e){oe.includes(a,e.InsuranceExtendInfo)||a.push(e.InsuranceExtendInfo)})),n&&n.length&&oe.forEach(n,(function(e){oe.includes(o,e.InsuranceExtendInfo)||o.push(e.InsuranceExtendInfo)}));var i=oe.difference(a,o);return oe.forEach(i,(function(e){r&&r[e]&&delete r[e]})),{newshoppinginfo:r,deletetoken:i}}var pn={hasCnChar:function(e){return/[\u0100-\uffff]/.test(e)},isCnChar:function(e){return/^[\u4e00-\u9fa5]+$/.test(e)},isEnChar:function(e){return!/^[\s]+$/.test(e)&&/^[A-Za-z\s]+$/.test(e)},isEnName:function(e){return/^[^\/]+\/[^\/]+$/.test(e)},hasEnChar:function(e){return/[A-Za-z]/.test(e)},checkCnName:function(e){return""===e||"\u8bc1\u4ef6\u7684\u4e2d\u6587\u59d3\u540d"===e?[!1,"\u8bf7\u586b\u5199\u4e2d\u6587\u540d"]:pn.isCnChar(e)&&1===e.length?[!1,"\u4e2d\u6587\u59d3\u540d\u4e0d\u53ef\u5c11\u4e8e2\u4e2a\u6c49\u5b57"]:pn.isEnChar(e)||pn.isEnName(e)?[!1,"\u8bf7\u4fdd\u6301\u59d3\u540d\u4e0e\u8bc1\u4ef6\u4e0a\u7684\u59d3\u540d\u4e00\u81f4"]:/^[\u4e00-\u9fa5a-zA-Z]+$/.test(e)?pn.hasEnChar(e)?[!0,"\u8bf7\u786e\u8ba4\u59d3\u540d\u4e0e\u8bc1\u4ef6\u4e00\u81f4\uff0c\u751f\u50fb\u5b57\u53ef\u7528\u62fc\u97f3\u4ee3\u66ff"]:/\u5c0f\u59d0|\u5148\u751f|\u592a\u592a|\u592b\u4eba/.test(e)?[!0,"\u8be5\u59d3\u540d\u542b\u6709\u79f0\u8c13\uff0c\u8bf7\u786e\u8ba4\u59d3\u540d\u4e0e\u8bc1\u4ef6\u4e00\u81f4"]:[!0]:[!1,"\u4e2d\u6587\u59d3\u540d\u9700\u5305\u542b\u6c49\u5b57\uff0c\u751f\u50fb\u5b57\u53ef\u7528\u62fc\u97f3\u4ee3\u66ff"]},checkEnName:function(e){if(!e)return[!1,"\u8bf7\u586b\u5199\u82f1\u6587\u59d3\u540d\uff0c\u59d3\u540d\u683c\u5f0f\u4e3a\u59d3/\u540d\uff0c\u59d3\u4e0e\u540d\u4e4b\u95f4\u7528 / \u5206\u9694\uff0c\u5982Green/Jim King"];if(e.length<2)return[!1,"\u82f1\u6587\u59d3\u540d\u4e0d\u53ef\u5c11\u4e8e2\u4e2a\u82f1\u6587\u5355\u8bcd"];if(!pn.isEnName(e))return[!1,"\u8bf7\u586b\u5199\u82f1\u6587\u59d3\u540d\uff0c\u59d3\u540d\u683c\u5f0f\u4e3a\u59d3/\u540d\uff0c\u59d3\u4e0e\u540d\u4e4b\u95f4\u7528 / \u5206\u9694\uff0c\u5982Green/Jim King"];if(/[^a-zA-Z. \/'-]/.test(e))return[!1,"\u82f1\u6587\u59d3\u540d\u4e2d\u5305\u542b\u975e\u6cd5\u5b57\u7b26\uff0c\u8bf7\u68c0\u67e5"];var t=e.split("/");return/[^a-zA-Z]/.test(t[0])?[!1,"\u82f1\u6587\u7684\u59d3\u4e2d\u53ea\u80fd\u5305\u542b\u5b57\u6bcd"]:/^[a-zA-Z]/.test(t[1])?[!0]:[!1,"\u82f1\u6587\u7684\u540d\u5fc5\u987b\u4ee5\u5b57\u6bcd\u5f00\u5934"]},checkMobile:function(e,t){if(!e)return[!0];if(t&&(t=+t),86===t){if(/^1\d{10}$/.test(e))return[!0]}else if(/^\d{1,11}$/.test(e))return[!0];return[!1,"\u8bf7\u586b\u5199\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801"]},checkContactName:function(e){return e?/^[\u4e00-\u9fffa-zA-Z.\u00B7\d ]{1,50}$/.test(e)?[!0]:[!1,"\u59d3\u540d\u53ea\u80fd\u5305\u542b\u4e2d\u6587\u3001\u82f1\u6587\u548c\u6570\u5b57\uff0c\u8bf7\u68c0\u67e5\u540e\u518d\u8bd5"]:[!1,"\u8bf7\u586b\u5199\u8054\u7cfb\u4eba\u59d3\u540d"]},checkContactEName:function(e){return e?pn.checkEnName(e)[0]?[!0]:[!1,"\u8bf7\u586b\u5199\u6b63\u786e\u7684\u8054\u7cfb\u4eba\u59d3\u540d"]:[!1,"\u8bf7\u586b\u5199\u8054\u7cfb\u4eba\u59d3\u540d"]},checkCSurname:function(e){return e?pn.isEnChar(e)||pn.isEnName(e)?[!1,"\u8bf7\u4fdd\u6301\u59d3\u540d\u4e0e\u8bc1\u4ef6\u4e0a\u7684\u59d3\u540d\u4e00\u81f4"]:/^[\u4e00-\u9fa5a-zA-Z]+$/.test(e)?[!0]:[!1,"\u8bf7\u586b\u5199\u6b63\u786e\u4e2d\u6587\u59d3"]:[!1,"\u8bf7\u586b\u5199\u4e2d\u6587\u59d3"]},checkCGivename:function(e){return e?pn.isEnChar(e)||pn.isEnName(e)?[!1,"\u8bf7\u4fdd\u6301\u59d3\u540d\u4e0e\u8bc1\u4ef6\u4e0a\u7684\u59d3\u540d\u4e00\u81f4"]:/^[\u4e00-\u9fa5a-zA-Z]+$/.test(e)?[!0]:[!1,"\u8bf7\u586b\u5199\u6b63\u786e\u4e2d\u6587\u540d"]:[!1,"\u8bf7\u586b\u5199\u4e2d\u6587\u540d"]},checkESurname:function(e){return e?pn.isEnChar(e)?/\s/g.test(e)?[!1,"\u82f1\u6587\u59d3\u4e0d\u80fd\u6709\u7a7a\u683c"]:[!0]:[!1,"\u8bf7\u586b\u5199\u6b63\u786e\u82f1\u6587\u59d3"]:[!1,"\u8bf7\u586b\u5199\u82f1\u6587\u59d3"]},checkEGivename:function(e){return e?pn.isEnChar(e)?[!0]:[!1,"\u8bf7\u586b\u5199\u6b63\u786e\u82f1\u6587\u540d"]:[!1,"\u8bf7\u586b\u5199\u82f1\u6587\u540d"]},checkEmail:function(e){return""===e?[!1,"\u8bf7\u586b\u5199\u7535\u5b50\u90ae\u7bb1"]:hn(e)?[!0]:[!1,"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7535\u5b50\u90ae\u7bb1"]},checkIdCard:function(e,t,n,r){t=t&&+t||0;var a="1@\u8eab\u4efd\u8bc1|2@\u62a4\u7167|3@\u5b66\u751f\u8bc1|4@\u519b\u5b98\u8bc1|6@\u9a7e\u9a76\u8bc1|7@\u56de\u4e61\u8bc1|8@\u53f0\u80de\u8bc1|10@\u6e2f\u6fb3\u901a\u884c\u8bc1|11@\u56fd\u9645\u6d77\u5458\u8bc1|20@\u5916\u56fd\u4eba\u6c38\u4e45\u5c45\u7559\u8bc1|21@\u65c5\u884c\u8bc1|22@\u53f0\u6e7e\u901a\u884c\u8bc1|23@\u58eb\u5175\u8bc1|24@\u4e34\u65f6\u8eab\u4efd\u8bc1|25@\u6237\u53e3\u7c3f|26@\u8b66\u5b98\u8bc1|99@\u5176\u5b83|27@\u51fa\u751f\u8bc1\u660e",o={};a.split("|").map((function(e){var t=e.split("@");o[+t[0]]=t[1]}));var i=n||{},s=i.idObj,c=void 0===s?{}:s;c[t]&&c[t].name;if(r&&""===e||!e)return[!1,"\u8bf7\u586b\u5199"+o[t]+"\u53f7\u7801"];if(""!==e){if(1===t||25===t){if(!Le(e))return[!1,"\u8bf7\u8f93\u5165\u6b63\u786e\u7684"+o[t]+"\u53f7\u7801"];for(var l=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],u=["1","0","X","9","8","7","6","5","4","3","2"],d=0,f=0;f<17;f++)d+=e.substr(f,1)*l[f];if(u[d%11]!=e.toLocaleUpperCase().substr(17,1))return[!1,"\u8bf7\u8f93\u5165\u6b63\u786e\u7684"+o[t]+"\u53f7\u7801"]}if(7===t){if(!/^[mhMH]{1}(\d{8}|\d{10})$/.test(e))return[!1,"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u56de\u4e61\u8bc1\u53f7\u7801"]}else if(8===t){if(!/^\d{8}$/.test(e))return[!1,"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u53f0\u80de\u8bc1\u53f7\u7801"]}else if(2===t||10===t||22===t){if(!/^[A-Za-z0-9]{5,15}$/.test(e))return[!1,"\u8bf7\u586b\u5199\u6b63\u786e\u7684"+o[t]+"\u53f7\u7801\uff0c\u53f7\u7801\u4e2d\u53ea\u80fd\u5305\u542b5~15\u4f4d\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u5b57\u6bcd+\u6570\u5b57\u7ec4\u5408"]}else if(27===t){if(!/^[A-Za-z0-9]{1,15}$/.test(e))return[!1,"\u8bf7\u586b\u5199\u6b63\u786e\u7684"+o[t]+"\u53f7\u7801\uff0c\u53f7\u7801\u4e2d\u53ea\u80fd\u5305\u542b1~15\u4f4d\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u5b57\u6bcd+\u6570\u5b57\u7ec4\u5408"]}else if(4===t){if(!/^[0-9]*$/.test(e))return[!1,"\u8bf7\u586b\u5199\u6b63\u786e\u7684\u519b\u5b98\u8bc1\u53f7\u7801"];if(!/^[0-9]{1,15}$/.test(e))return[!1,"\u519b\u5b98\u8bc1\u4ec5\u9700\u586b\u5199\u6570\u5b57\u90e8\u5206"]}else if(32===t){if(!/^[A-Za-z0-9]{1,20}$/.test(e))return[!1,"\u8bf7\u586b\u5199\u6b63\u786e\u7684"+o[t]+"\u53f7\u7801\uff0c\u53f7\u7801\u4e2d\u53ea\u80fd\u5305\u542b1~20\u4f4d\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u5b57\u6bcd+\u6570\u5b57\u7ec4\u5408"]}else if(/[^A-Za-z0-9]/.test(e))return[!1,"\u8bf7\u586b\u5199\u6b63\u786e\u7684"+o[t]+"\u53f7\u7801\uff0c\u53f7\u7801\u4e2d\u53ea\u80fd\u5305\u542b\u6570\u5b57\u6216\u5b57\u6bcd"];if(e.length>20)return[!1,o[t]+"\u53f7\u7801\u4e0d\u53ef\u591a\u4e8e20\u4f4d"]}return[!0]},checkUSAAddress:function(e){return e?/^[A-Za-z0-9\s]{1,35}$/.test(e)?[!0]:[!1,"\u8bf7\u586b\u5199\u6b63\u786e\u7684\u8be6\u7ec6\u5730\u5740\uff0c\u4ec5\u652f\u6301\u7a7a\u683c\u3001\u6570\u5b57\u53ca\u82f1\u6587\uff0c\u6700\u591a35\u4e2a\u5b57\u7b26"]:[!1,"\u8bf7\u586b\u5199\u5728\u7f8e\u5c45\u4f4f\u5730\u8be6\u7ec6\u5730\u5740"]},checkUSAZipCode:function(e){return e?/^[0-9]{1,35}$/.test(e)?[!0]:[!1,"\u8bf7\u586b\u5199\u6b63\u786e\u7684\u90ae\u653f\u7f16\u7801\uff0c\u4ec5\u652f\u6301\u6570\u5b57"]:[!1,"\u8bf7\u586b\u5199\u5728\u7f8e\u5c45\u4f4f\u5730\u90ae\u653f\u7f16\u7801"]}},mn=pn;function hn(e){var t,n=e.split("@");if(2!==(null===n||void 0===n?void 0:n.length))return!1;var r=n[0],a=n[1];if(!r||!a)return!1;if(!/^([a-zA-Z0-9\!\#\$\%\&\'\*\+\-\/\=\?\^\_\`\{\|\}\~]+[\.]?)*[a-zA-Z0-9\!\#\$\%\&\'\*\+\-\/\=\?\^\_\`\{\|\}\~]+$/.test(r))return!1;if(e.length>60)return!1;if(r.length>64)return!1;if((null===(t=a.split("."))||void 0===t?void 0:t.length)<2)return!1;if(!/^([a-zA-Z0-9]+[a-zA-Z0-9\-]*[\.]?)*([a-zA-Z0-9]+[a-zA-Z0-9\-]*)+$/.test(a))return!1;if(a.length>255)return!1;var o=a.split(".").find((function(e){return e.length>63}));return!o&&!/\.\d+$/.test(a)}var vn=function(e){var t=e.data,n=e.checkKey,r=e.isCheckAll,a=e.onlyCheckEmpty,o=void 0!==a&&a,s=t.ErrorContactMsg,c=void 0===s?{}:s,l=t.ContactInfo,u=t.contactShowItems,d=t.contactTemplate,f=void 0===d?{}:d,p={};!r&&c&&(p=(0,i.Z)({},c));var m=l.Name,h=l.IdCardType,v=l.ContactIDCardNumber,g=l.Gender,y=void 0===g?-1:g,_=l.Email,b=l.Moblie,I=l.CountryCode,x=l.BirthDate,T=l.SurenameCN,k=l.GivenNameCN,S=l.Surname,C=l.GivenName;if(r||"Name"===n){if(p["Name"]="",u.UserName)if(m){if(!o){var w=mn.checkContactName(m);w[0]||(p["Name"]=w[1])}}else p["Name"]="\u8bf7\u586b\u5199\u8054\u7cfb\u4eba\u59d3\u540d";if(u["ChineseName"]&&h)if(m){if(!o){var N=mn.checkCnName(m);N[0]||(p["Name"]="\u8bf7\u586b\u5199\u6b63\u786e\u7684\u8054\u7cfb\u4eba\u59d3\u540d")}}else p["Name"]="\u8bf7\u586b\u5199\u8054\u7cfb\u4eba\u59d3\u540d";if(u["EnglishName"])if(m){if(!o){var E=mn.checkContactEName(m);E[0]||(p["Name"]=E[1])}}else p["Name"]="\u8bf7\u586b\u5199\u8054\u7cfb\u4eba\u59d3\u540d"}if((r||"ContactIDCardNumber"===n)&&(p["ContactIDCardNumber"]="",u["IDNumber"]&&h)){var P=f.idOptions,j=void 0===P?[]:P,O=j.filter((function(e){return+e.customerInfoItemType===h}))[0];if(v){if(!o){var D=mn.checkIdCard(v,h,f);D[0]||(p["ContactIDCardNumber"]="\u8bf7\u586b\u5199\u6b63\u786e\u7684\u8054\u7cfb\u4eba".concat(O.name,"\u53f7\u7801"))}}else p["ContactIDCardNumber"]="\u8bf7\u586b\u5199\u8054\u7cfb\u4eba".concat(O.name,"\u53f7\u7801")}if((r||"Sex"===n)&&(p["Sex"]="",u["Sex"]&&y<0&&(p["Sex"]="\u8bf7\u9009\u62e9\u8054\u7cfb\u4eba\u6027\u522b")),(r||"Email"===n)&&(p["Email"]="",_||f.isNeedEmail))if(_){var R=mn.checkEmail(_);R[0]||(p["Email"]=R[1])}else p["Email"]="\u8bf7\u586b\u5199\u7535\u5b50\u90ae\u7bb1";if((r||"Moblie"===n)&&(p["Moblie"]="",u.ContactPhone))if(b){var A=mn.checkMobile(b,I);A[0]||(p["Moblie"]=A[1])}else p["Moblie"]="\u8bf7\u586b\u5199\u8054\u7cfb\u4eba\u7535\u8bdd";if(r&&(p["IdCardType"]="",u["IDType"]&&(h||(p["IdCardType"]="\u8bf7\u9009\u62e9\u8bc1\u4ef6\u7c7b\u578b")),u.ContactPhone&&(I||p["Moblie"]||(p["Moblie"]="\u8bf7\u9009\u62e9\u56fd\u5bb6\u7801"))),(r||"SurenameCN"===n)&&(p["SurenameCN"]="",u.SurenameCN))if(T){var M=mn.checkCSurname(T);M[0]||(p["SurenameCN"]=M[1])}else p["SurenameCN"]="\u8bf7\u586b\u5199\u4e2d\u6587\u59d3";if((r||"GivenNameCN"===n)&&(p["GivenNameCN"]="",u.GivenNameCN))if(k){var V=mn.checkCGivename(k);V[0]||(p["GivenNameCN"]=V[1])}else p["GivenNameCN"]="\u8bf7\u586b\u5199\u4e2d\u6587\u540d";if((r||"Surname"===n)&&(p["Surname"]="",u.Surname))if(S){var L=mn.checkESurname(S);L[0]||(p["Surname"]=L[1])}else p["Surname"]="\u8bf7\u586b\u5199\u82f1\u6587\u59d3";if((r||"GivenName"===n)&&(p["GivenName"]="",u.GivenName))if(C){var B=mn.checkEGivename(C);B[0]||(p["GivenName"]=B[1])}else p["GivenName"]="\u8bf7\u586b\u5199\u82f1\u6587\u540d";return(r||"BirthDate"===n)&&(p["Birthday"]="",u.Birthday&&(x||(p["Birthday"]="\u8bf7\u9009\u62e9\u51fa\u751f\u65e5\u671f"))),p},gn=function(e,t,n){var r=e.ErrorUSAAddress,a=void 0===r?{}:r,o=(e.contactShowItems,e.contactTemplate),s=void 0===o?{}:o,c=e.DestinationAddress,l=void 0===c?{}:c,u={};!t&&a&&(u=(0,i.Z)({},a));var d,f,p,m=l.CityName,h=l.Address,v=l.ZipCode,g=s.items,y=void 0===g?{}:g;(t||"CityName"===n)&&(u["CityName"]="",null!==(d=y["State_City"])&&void 0!==d&&d.isRequired&&!m&&(u["CityName"]="\u8bf7\u9009\u62e9\u5728\u7f8e\u5c45\u4f4f\u5730\u6240\u5728\u5dde/\u57ce\u5e02"));if(t||"Address"===n)if(u["Address"]="",h){var _=mn.checkUSAAddress(h);_[0]||(u["Address"]=_[1])}else null!==(f=y["DetailedAddress"])&&void 0!==f&&f.isRequired&&(u["Address"]="\u8bf7\u586b\u5199\u5728\u7f8e\u5c45\u4f4f\u5730\u8be6\u7ec6\u5730\u5740");if(t||"ZipCode"===n)if(u["ZipCode"]="",v){var b=mn.checkUSAZipCode(v);b[0]||(u["ZipCode"]=b[1])}else null!==(p=y["PostCode"])&&void 0!==p&&p.isRequired&&(u["ZipCode"]="\u8bf7\u586b\u5199\u5728\u7f8e\u5c45\u4f4f\u5730\u90ae\u653f\u7f16\u7801");return u},yn=function(e){var t=e||{},n=t.shoppinginfo,r=void 0===n?{}:n,a=t.ResourcePassengerMapList,o=void 0===a?[]:a,i=t.passengerObj,s=void 0===i?{}:i,c=t.ResourcePassengers,l=void 0===c?[]:c,u=t.cruise,d=void 0===u?[]:u,f=[];d&&d.length&&oe.forEach(d,(function(e){var t=e||{},n=t.cabinIds,r=void 0===n?[]:n,a=t.totalCount,i=void 0===a?0:a,c=t.Basic,l=void 0===c?{}:c,u=l||{},d=u.MinNum,p=u.MaxNum,m=u.OvaryRoomId,h=0;oe.forEach(r,(function(e){var t=o.filter((function(t){return t.ResourceToken===e}))[0],n=t&&t.PassengerTokenList&&t.PassengerTokenList.length||0;if(n&&n>=d&&n<=p){h+=n;for(var r=!0,a=0;a<t.PassengerTokenList.length;a++){var i=s[t.PassengerTokenList[a]];if(!i.isComplete){r=!1;break}}r||f.push(e)}else f.push(e)})),i!==h&&f.push(m)}));var p=r[We.INSURANCE];return oe.isEmpty(p)||oe.forEach(p,(function(e,t){var n=o.filter((function(e){return e.ResourceToken===t}))[0];if(n&&n.PassengerTokenList&&n.PassengerTokenList.length){for(var r=!0,a=0;a<n.PassengerTokenList.length;a++){var i=s[n.PassengerTokenList[a]];if(!i.isComplete){r=!1;break}}r||f.push(t)}else f.push(t)})),l&&l.length&&oe.forEach(l,(function(e){var t=e||{},n=t.ResourceInfo,r=void 0===n?{}:n,a=r||{},i=a.Token,c=void 0===i?"":i,l=o.filter((function(e){return e.ResourceToken===c}))[0];if(l&&l.PassengerTokenList&&l.PassengerTokenList.length){for(var u=!0,d=0;d<l.PassengerTokenList.length;d++){var p=s[l.PassengerTokenList[d]];if(!p.isComplete){u=!1;break}}u||f.push(c)}else f.push(c)})),f};function _n(e){if(oe.isEmpty(e))return[];var t=[];return e&&e.map((function(e){var n=e||{},r=n.BasicInfo,a=n.Rooms,o=r||{},s=o.Name,c=o.StaticInfo,l=o.Token,u=void 0===l?"":l,d=c||{},f=d.Location,p=d.EnName;a&&a.length&&a.map((function(e){var n,r,a,o=e||{},c=o.PriceInfo,l=void 0===c?{}:c,d=o.PaymentInfo,m=void 0===d?{}:d,h=o.BasicInfo,v=void 0===h?{}:h,g=m||{},y=g.CheckinDate,_=g.CheckoutDate,b=l||{},I=b.Daily,x=(null===v||void 0===v?void 0:v.RoomSpecialRemarks)||{};t.push((0,i.Z)({hotelRoomInfo:{checkinDate:y&&ye.parse(y,!1).format("M\u6708DD\u65e5"),checkoutDate:_&&ye.parse(_,!1).format("M\u6708DD\u65e5"),checkInDateTimestamp:y&&(null===(n=y.match(/^\d{4}-\d{1,2}-\d{1,2}/))||void 0===n?void 0:n[0]),checkOutDateTimestamp:_&&(null===(r=_.match(/^\d{4}-\d{1,2}-\d{1,2}/))||void 0===r?void 0:r[0]),daily:I&&I.length,city:f&&f.CityName,hotelName:s,hotelEngName:p,roomName:null===v||void 0===v?void 0:v.Name,selectedCount:null===v||void 0===v||null===(a=v.RoomCountInfo)||void 0===a?void 0:a.SelectedCount,hotelToken:u,token:(null===v||void 0===v?void 0:v.Token)||""}},x))}))})),t}function bn(e){var t=[];return oe.forEach(e,(function(e){var n=e.Remark,r=e.RemarkTokens,a=void 0===r?[]:r,o="";if(a&&a.length){var i=a.map((function(e){try{var t=JSON.parse(e);return t.Desc}catch(e){return""}}));o=i.join("\uff0c")}n&&(o+="".concat(o?"\uff0c":"").concat(n)),o&&(e.commentRemark=o,t.push(e))})),t}var In="\nquery CabinFareRemark($params: CabinFareRemarkReq){\n                CabinInfo(params: $params){\n                    QTEFareRemarkForShopping{\n                        RemarkList,\n                        NeedRetry\n                    }\n                }\n            }",xn="\nquery getshoppingDetail($shoppingParams: ShoppingDetailArgs!) {\n    shoppingDetail(params: $shoppingParams) {\n        priceDetail {\n            json\n        }\n    }\n  }\n",Tn="\n    query orderInfo($productParams: ProductArgs!,$shoppingParams: ShoppingDetailArgs!,$qconfigParams: QConfigArgs!){\n        productInfo(params: $productParams) {\n            BasicInfo{\n                json\n            }\n            BasicExtendInfo{\n                json\n            }\n            CostInfoList{\n                json\n            }\n            VendorInfo {\n                json\n            }\n            ExtInfo {\n                json\n            }\n            resourceSlot {\n                specialBrandInfo\n            }\n            TagGroupInfo{\n                json\n            }\n            easeOrderInfo{\n                isShow\n                tags\n            }\n            TourGroupInfo {\n                json\n            }\n            ResponseStatus\n        }\n        shoppingDetail(params: $shoppingParams) {\n            ShoppingId\n            ResponseStatus\n            bookingLimit {\n                json\n            }\n            tagInfo\n            bookFormCallback{\n                json\n            }\n            contactTemplate{\n                json\n            }\n            shoppingOrderStatus{\n                json\n            }\n            addressInfo{\n                defaultAddressInfo\n            }\n            shoppingEmotionalCues {\n                shoppingTips\n                packageTips\n                emergencyTips\n            }\n            Cruise\n            Flight\n            Hotel\n            Shopping\n            Train\n            tmpOrderInfo {\n                json\n            }\n            mrgMemberUserInfo{\n                memberinfo\n                ResponseStatus\n            }\n            prefetchSetting \n        }\n        userContactInfo{\n            contacts{\n                json\n            }\n        }\n        qConfig(params: $qconfigParams){\n            AppSettingList\n        }\n    }",kn="\n    query orderInfo($shoppingParams: ShoppingDetailArgs!,$searchXParams: ExtraResourceArgs!,$imArgs: IMEntryInfoArgs!,$productParams:ProductArgs!, $userDestinationParams:UserDestinationOrderArg!){\n        shoppingDetail(params: $shoppingParams) {\n            ResponseStatus\n            airlineClause{\n                json\n            }\n            orderConfirmTime{\n                json\n            }\n            imEntryInfo(params: $imArgs){\n                imInfo\n                serviceInfo\n            }\n            bookForm {\n                json\n            }\n            paymentWayInfo{\n                json\n            }\n            orderNoticeInfo{\n                json\n            }\n        }\n        productInfo(params: $productParams) {\n            FeeInfoList{\n                json\n            }\n            userDestinationOrder (params: $userDestinationParams) {\n                tags\n                productDestinationOrderList\n                productReturnOrderList\n            }\n            OrderKnow {\n                json\n            }\n            ResponseStatus\n        }\n        extraResource(params: $searchXParams){\n            Insurances\n            room\n            single\n            ResourceStatuses\n        }\n    }",Sn="\n    query orderInfo($shoppingParams: ShoppingDetailArgs!){\n        shoppingDetail(params: $shoppingParams) {\n            ResponseStatus\n            mrgMemberUserInfo{\n                memberinfo\n                ResponseStatus\n            }\n        }\n    }",Cn="\n    query getProduct($productParams: ProductArgs!){\n        productInfo(params: $productParams) {\n            TagGroupInfo{\n                json\n            }\n            FeeInfoList{\n                json\n            }\n            easeOrderInfo{\n                isShow\n                tags\n            }\n            OrderKnow {\n                json\n            }\n            ResponseStatus\n        }\n    }",wn=function(e){var t=e.ctx,n=e.store,r=t.getDHTLogger&&t.getDHTLogger(),s=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.post("getuserinfo",{RequestType:[1,4,10]});case 3:if(n=e.sent,!n||!n.ResponseStatus||"Success"!==n.ResponseStatus.Ack){e.next=8;break}return e.abrupt("return",(null===n||void 0===n?void 0:n.Data)||{});case 8:return e.abrupt("return",!1);case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e["catch"](0),e.t0.isNetError||r&&r.logError({pageName:"OrderV3",message:"/12446/getuserinfo",ex:e.t0}),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),c=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var o,i,s,c;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=n.getState(),i=o.shoppingId,e.prev=1,e.next=4,t.post("GetPassenger",{productToken:i,queryConditions:[{key:"pageIndex",value:"1"},{key:"pageSize",value:"200"}],parameterList:[{key:"BizType",value:"PKG"},{key:"ResultType",value:"0"},{key:"channel",value:"CRN"},{key:"version",value:"835.002"},{key:"unEffectPassengerIds",value:""},{key:"passengerCoreVersion",value:"2"}],sourceType:"0"});case 4:if(c=e.sent,"success"!==(null===c||void 0===c||null===(s=c.ResponseStatus)||void 0===s||null===(s=s.Ack)||void 0===s?void 0:s.toLowerCase())){e.next=9;break}return e.abrupt("return",c);case 9:return e.abrupt("return",!1);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e["catch"](1),e.t0.isNetError||r&&r.logError({pageName:"OrderV3",message:"/18848/GetPassenger",ex:e.t0}),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var o,s,c,l,u,d,f,m,h,v,g,y,_,b,I,x,T,k,S,C;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=n.getState(),s=o.shoppingId,c=o.shardParams,l=o.isUnitTest,u=o.UnitTest_Price,e.prev=1,m="getShoppingPriceDetail",h=xn,v=Number(c.Version),g={shoppingParams:(0,i.Z)((0,i.Z)({ShoppingId:s},c),{},{Version:v})},l&&(g.shoppingParams.testCaseId="40298378",u&&(g.shoppingParams.UnitTest_Price=u)),e.next=9,t.gqlpost(h,g,m);case 9:if(y=e.sent,_=y||{},b=_.data,I=_.extensions,"Success"===(null===I||void 0===I||null===(d=I.SoaResponseStatus)||void 0===d||null===(d=d.ResponseStatus)||void 0===d?void 0:d.Ack)){e.next=13;break}throw new Error("getPriceDetail");case 13:if(x=b.shoppingDetail,T=void 0===x?{}:x,k=T||{},S=k.priceDetail,C=void 0===S?{}:S,"Success"===(null===C||void 0===C||null===(f=C.ResponseStatus)||void 0===f?void 0:f.Ack)){e.next=17;break}throw new Error("12448/getShoppingPriceDetailV2");case 17:return e.abrupt("return",y||{});case 20:return e.prev=20,e.t0=e["catch"](1),e.t0.isNetError||r&&r.logError({pageName:"OrderV3",message:"bff/graphql/getShoppingPriceDetail->".concat(null===e.t0||void 0===e.t0?void 0:e.t0.message),errorType:p.ErrorType.Ack_Fail,ex:e.t0}),e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e,null,[[1,20]])})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var o,i,s,c,l,u,d,f,m,h,v,g;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=n.getState(),i=o.tagInfo,s=void 0===i?{}:i,c=o.shoppingId,l=void 0===c?"":c,u=s||{},d=u.isIntl,f=void 0!==d&&d,!f){e.next=17;break}return m={params:{clientParams:{appType:"app",appVersion:t.appVersion},ShoppingId:l}},e.prev=4,h=t.createGqldiyRequest(In,m,"CabinInfo",{}),e.next=8,h.fetch();case 8:return v=e.sent,g=v.data,e.abrupt("return",g);case 13:return e.prev=13,e.t0=e["catch"](4),e.t0.isNetError||r&&r.logError({pageName:"OrderV3",message:"bff/graphql/CabinInfo",errorType:p.ErrorType.Ack_Fail,ex:e.t0}),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var o,i,s,c,l,u,d,f,p,m,h,v,g,y,_,b,I,x,T,k;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=n.getState(),i=o.shoppingId,s=o.productBasicInfo,c=void 0===s?{}:s,l=o.priceDetail,u=void 0===l?{}:l,o.selectedPromotion,o.Installment,d=o.query,f=o.Platform,p=u||{},m=p.totalPrice,h=void 0===m?{}:m,v=h||{},g=v.totalPrice,y=void 0===g?0:g,_=c||{},b=_.ProductId,I=void 0===b?0:b,x=[{key:"actCode",value:d&&d.activitycode||""}],f===_e.CTRIPRN&&x.push({key:"serviceVersion",value:"1"}),T={platform:f===_e.CTRIPH5?1:2,channel:0,shoppingId:i,amount:y,businessProductId:I,businessSystemId:3,extTags:x},e.prev=7,e.next=10,t.post("paymentByInstalment",T);case 10:return k=e.sent,e.abrupt("return",k);case 14:return e.prev=14,e.t0=e["catch"](7),e.t0.isNetError||r&&r.logError({pageName:"OrderV3",message:"/13826/paymentByInstalment",ex:e.t0}),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[7,14]])})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n){var o;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.post("GetInsuranceDetail",n);case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0={};case 6:if(o=e.t0,!o.ResponseStatus||"Success"!==o.ResponseStatus.Ack){e.next=11;break}return e.abrupt("return",o);case 11:return e.abrupt("return",null);case 12:e.next=18;break;case 14:return e.prev=14,e.t1=e["catch"](0),e.t1.isNetError||r&&r.logError({pageName:"OrderV3",message:"/20168/GetInsuranceDetail",ex:e.t1}),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var o,i,s,c,l,u,d,f;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=n.getState(),i=o.shoppingId,s=o.passengerObj,c=void 0===s?{}:s,l=o.selectIds,u=void 0===l?[]:l,o.Platform,o.template,d=[],oe.forEach(u,(function(e){var t=c[e]||{},n=t.CNName,r=t.ENFirstName,a=t.ENLastName,o=t.idInfo,i=t.idInfos,s=i;s&&s.length||!o||!o.IdCardType||(s=[o]);var l={ChineseName:n||"",EnglishName:a?"".concat(a," ").concat(r):""};s&&s.length&&(l.CertInfos=s.map((function(e){return{CertType:+e.IdCardType,CertNo:e.IdCardNo}}))),d.push(l)})),e.prev=3,e.next=6,t.post("CustomerValidCheck",{ShoppingId:i,PassengerBasicInfos:d});case 6:if(e.t0=e.sent,e.t0){e.next=9;break}e.t0={};case 9:if(f=e.t0,!f.ResponseStatus||"Success"!==f.ResponseStatus.Ack){e.next=14;break}return e.abrupt("return",f.ContainSelf?1:0);case 14:return e.abrupt("return",1);case 15:e.next=21;break;case 17:return e.prev=17,e.t1=e["catch"](3),e.t1.isNetError||r&&r.logError({pageName:"OrderV3",message:"/20168/CustomerValidCheck",ex:e.t1}),e.abrupt("return",1);case 21:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(o){var s,c,l,u,d,f,m,h,v,g,y,_,b,I,x,T,k,S,C,w,N,E,P,j,O,D,R,A,M,V,L,B,U,Z;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=n.getState(),c=s.shoppingId,l=void 0===c?"":c,u=s.productid,d=s.departcityid,s.query,f=s.shardParams,m=s.isUnitTest,h="OrderShoppingInfo_App_1st_V1",v=Tn,g=Number(f.Version),y={productParams:(0,i.Z)({ProductId:Number(u),DepartureCityId:Number(d||0)},f),shoppingParams:(0,i.Z)((0,i.Z)({ShoppingId:l},f),{},{Version:g}),qconfigParams:{KeyList:["height_type","order_train_check","order_insurance_agent","order_train_seat","publictraininfo.train_saleStartTime","publictraininfo.train_saleEndTime","order_clauses"]}},_={needRetry:!0},m&&(y.shoppingParams.testCaseId="40298378",y.productParams.testCaseId="44954748"),b=["rn_tour","order",u,d,l].join("_"),!o&&b&&(_={needRetry:!0,cachePolicy:{enableCache:!0,cacheExpireTime:5,cacheLocation:"MEM",cacheKey:b,removeCacheWhenUsedOnce:!0}}),e.prev=9,S=Date.now(),e.next=13,t.gqlpost(v,y,h,_);case 13:if(C=e.sent,w=C.data,N=C.extensions,E=C.__isFromCache,P=void 0!==E&&E,j=Date.now(),"Success"===(null===N||void 0===N||null===(I=N.SoaResponseStatus)||void 0===I||null===(I=I.ResponseStatus)||void 0===I?void 0:I.Ack)){e.next=21;break}throw new Error("getOrderInitInfo");case 21:if(O=w.shoppingDetail,D=void 0===O?{}:O,R=D||{},A=R.contactTemplate,M=void 0===A?{}:A,V=R.mrgMemberUserInfo,L=void 0===V?{}:V,B=R.ResponseStatus,U=void 0===B?{}:B,Z="","Success"!==(null===U||void 0===U?void 0:U.Ack)&&(Z="20168/GetShoppingDetail"),"Success"!==(null===M||void 0===M||null===(x=M.ResponseStatus)||void 0===x?void 0:x.Ack)&&(Z="13966/contactTemplate"),"Success"!==(null===L||void 0===L||null===(T=L.ResponseStatus)||void 0===T?void 0:T.Ack)&&(Z="20168/queryMrgMemberUserInfo"),r&&r.logActionInfo({attrs:[{key:"shoppingid",value:l}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u9996\u5c4f /tour/bff/graphql/OrderShoppingInfo_App_1st_V1",rootMessageId:null===N||void 0===N||null===(k=N.SoaResponseStatus)||void 0===k||null===(k=k.ResponseStatus)||void 0===k||null===(k=k.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===k?void 0:k.Value,value:"".concat(j-S,"ms")}),!Z){e.next=31;break}return r&&r.logActionInfo({attrs:[{key:"shoppingid",value:l}],module:"\u63a5\u53e3\u62a5\u9519",scene:"\u9996\u5c4f /tour/bff/graphql/OrderShoppingInfo_App_1st_V1 ack_fail",value:Z,key:"vac_11004"}),e.abrupt("return",!1);case 31:return w.__isFromCache=P,e.abrupt("return",w);case 35:return e.prev=35,e.t0=e["catch"](9),e.t0.isNetError||r&&r.logError({pageName:"OrderV3",message:"bff/graphql/OrderShoppingInfo_App_1st_V1->".concat(null===e.t0||void 0===e.t0?void 0:e.t0.message),errorType:p.ErrorType.Ack_Fail,ex:e.t0}),e.abrupt("return",!1);case 39:case"end":return e.stop()}}),e,null,[[9,35]])})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var o,s,c,l,u,d,f,m,h,v,g,y,_,b,I,x,T,k,S,C,w,N,E,P,j,O,D,R,A,M,V,L,B,U,Z,F,G,H,q,K;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=n.getState(),s=o.shoppingId,c=void 0===s?"":s,l=o.productid,u=o.departcityid,d=o.query,f=o.shardParams,m=o.isUnitTest,h=o.Channels,v=o.productBasicInfo,g=o.orderBasicInfo,y=d.fromhhtravel,_="OrderShoppingInfo_App_2nd_V1",b=kn,I=Number(f.Version),x="","1"===y?x="hhtravel":h&&h.isInZTApp&&(x="zhixing"),T={shoppingParams:(0,i.Z)((0,i.Z)({ShoppingId:c},f),{},{Version:I}),imArgs:{sourceFrom:x},searchXParams:(0,i.Z)((0,i.Z)({ShoppingId:c,RecommendType:3},f),{},{Version:I}),productParams:(0,i.Z)({ProductId:Number(l),DepartureCityId:Number(u||0)},f),userDestinationParams:{transportation:!0,beginDate:g.DepartureDate,endDate:"".concat(g.ReturnDate," 23:59:59")}},v&&v.ProductLineName&&v.ProductAlias&&(T.productParams.Alias=[v.ProductAlias]),m&&(T.shoppingParams.testCaseId="40298378",T.searchXParams.testCaseId="40088449"),e.prev=10,e.next=13,t.gqlpost(b,T,_);case 13:if(E=e.sent,P=E.data,j=E.extensions,"Success"===(null===j||void 0===j||null===(k=j.SoaResponseStatus)||void 0===k||null===(k=k.ResponseStatus)||void 0===k?void 0:k.Ack)){e.next=18;break}throw new Error("getOrderSecInfo");case 18:if(O=P.shoppingDetail,D=void 0===O?{}:O,R=P.productInfo,A=P.extraResource,M=void 0===A?{}:A,V=D||{},L=V.bookForm,B=void 0===L?{}:L,U=V.paymentWayInfo,Z=void 0===U?{}:U,F=V.ResponseStatus,G=void 0===F?{}:F,H=M||{},q=H.ResourceStatuses,K="","Success"!==(null===G||void 0===G?void 0:G.Ack)&&(K="20168/GetShoppingDetail"),"Success"!==(null===B||void 0===B||null===(S=B.ResponseStatus)||void 0===S?void 0:S.Ack)&&(K="12448/getBookFormV4"),"Success"!==(null===Z||void 0===Z||null===(C=Z.ResponseStatus)||void 0===C?void 0:C.Ack)&&(K="13826/paymentWayInfo"),m||"Success"===(null===R||void 0===R||null===(w=R.ResponseStatus)||void 0===w?void 0:w.Ack)||(K="getOrderSecInfo/productInfo"),oe.isEmpty(q)||(K="ResourceStatuses?.[0]?.Desc"),r&&r.logActionInfo({attrs:[{key:"shoppingid",value:c}],module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u6b21\u5c4f /tour/bff/graphql/OrderShoppingInfo_App_2nd_V1",rootMessageId:null===j||void 0===j||null===(N=j.SoaResponseStatus)||void 0===N||null===(N=N.ResponseStatus)||void 0===N||null===(N=N.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===N?void 0:N.Value}),!K){e.next=31;break}return r&&r.logActionInfo({attrs:[{key:"shoppingid",value:c}],module:"\u63a5\u53e3\u62a5\u9519",scene:"\u6b21\u5c4f /tour/bff/graphql/OrderShoppingInfo_App_2nd_V1 ack_fail",value:K,key:"vac_11005"}),e.abrupt("return",!1);case 31:return e.abrupt("return",P);case 34:return e.prev=34,e.t0=e["catch"](10),e.t0.isNetError||r&&r.logError({pageName:"OrderV3",message:"bff/graphql/OrderShoppingInfo_App_2nd_V1->".concat(null===e.t0||void 0===e.t0?void 0:e.t0.message),errorType:p.ErrorType.Ack_Fail,ex:e.t0}),e.abrupt("return",!1);case 38:case"end":return e.stop()}}),e,null,[[10,34]])})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n){var o;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.post("UpdateResource",n);case 3:return o=e.sent,e.abrupt("return",o);case 7:return e.prev=7,e.t0=e["catch"](0),e.t0.isNetError||r&&r.logError({pageName:"OrderV3",message:"/20168/UpdateResource",ex:e.t0}),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n){var o,i,s;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",{});case 2:return e.prev=2,e.next=5,t.post("convertPinyinWords",{Words:n});case 5:return o=e.sent,i=null===o||void 0===o?void 0:o.Body,s={},Array.isArray(i)&&oe.forEach(n,(function(e,t){s[e]=i[t]})),e.abrupt("return",s);case 12:return e.prev=12,e.t0=e["catch"](2),e.t0.isNetError||r&&r.logError({pageName:"OrderV3",message:"/10653/ConvertPinyinWords",ex:e.t0}),e.abrupt("return",{});case 16:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var o,s,c,l,u,d,f,m,h,v,g,y,_,b,I,x,T,k,S,C,w;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=n.getState(),s=o.shoppingId,c=void 0===s?"":s,l=o.shardParams,u=o.isUnitTest,d="OrderShoppingInfo_App_Memberinfo",f=Sn,m=Number(l.Version),h={shoppingParams:(0,i.Z)((0,i.Z)({ShoppingId:c},l),{},{Version:m})},u&&(h.shoppingParams.testCaseId="40298378"),console.log("\ud83e\udd2cvariables",JSON.stringify(h)),e.prev=7,e.next=10,t.gqlpost(f,h,d);case 10:if(y=e.sent,_=y.data,b=y.extensions,"Success"===(null===b||void 0===b||null===(v=b.SoaResponseStatus)||void 0===v||null===(v=v.ResponseStatus)||void 0===v?void 0:v.Ack)){e.next=15;break}throw new Error("getMemberinfo");case 15:if(I=_.shoppingDetail,x=void 0===I?{}:I,T=x||{},k=T.mrgMemberUserInfo,S=void 0===k?{}:k,C=T.ResponseStatus,w=void 0===C?{}:C,"Success"===(null===w||void 0===w?void 0:w.Ack)){e.next=19;break}throw new Error("20168/GetShoppingDetail");case 19:if("Success"===(null===S||void 0===S||null===(g=S.ResponseStatus)||void 0===g?void 0:g.Ack)){e.next=21;break}throw new Error("20168/queryMrgMemberUserInfo");case 21:return e.abrupt("return",S&&S.memberinfo);case 24:return e.prev=24,e.t0=e["catch"](7),e.t0.isNetError||r&&r.logError({pageName:"OrderV3",message:"bff/graphql/OrderShoppingInfo_App_Memberinfo->".concat(null===e.t0||void 0===e.t0?void 0:e.t0.message),errorType:p.ErrorType.Ack_Fail,ex:e.t0}),e.abrupt("return",!1);case 28:case"end":return e.stop()}}),e,null,[[7,24]])})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(r,o){var i,s,c;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=n.getState(),s=i.shardParams,e.prev=1,o.Version=+s.Version,e.next=5,t.post("bookingXResource",o);case 5:return c=e.sent,e.abrupt("return",c);case 9:throw e.prev=9,e.t0=e["catch"](1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}(),I=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var o,i,s,c;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=n.getState(),i=o.shoppingId,s=void 0===i?"":i,e.prev=1,e.next=4,t.post("getMainGuestCount",{ShoppingId:s});case 4:if(c=e.sent,!c||!c.ResponseStatus||"Success"!==c.ResponseStatus.Ack){e.next=9;break}return e.abrupt("return",(null===c||void 0===c?void 0:c.MainGuestCountInfo)||[]);case 9:return e.abrupt("return",null);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e["catch"](1),e.t0.isNetError||r&&r.logError({pageName:"OrderV3",message:"/20168/GetMainGuestCount",ex:e.t0}),e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var o,s,c,l,u,d,f,m,h,v,g,y;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=n.getState(),s=o.productid,c=o.departcityid,l=o.shardParams,u=o.productBasicInfo,d="OrderGetProductInfo",f=Cn,m={productParams:(0,i.Z)({ProductId:Number(s),DepartureCityId:Number(c||0)},l)},u&&u.ProductLineName&&u.ProductAlias&&(m.productParams.Alias=[u.ProductAlias]),e.prev=5,e.next=8,t.gqlpost(f,m,d,{});case 8:if(v=e.sent,g=v.data,y=v.extensions,"Success"===(null===y||void 0===y||null===(h=y.SoaResponseStatus)||void 0===h||null===(h=h.ResponseStatus)||void 0===h?void 0:h.Ack)){e.next=13;break}throw new Error("getProductInfo");case 13:return e.abrupt("return",g);case 16:return e.prev=16,e.t0=e["catch"](5),e.t0.isNetError||r&&r.logError({pageName:"OrderV3",message:"bff/graphql/Graphql_GetProductinfo->".concat(null===e.t0||void 0===e.t0?void 0:e.t0.message),errorType:p.ErrorType.Ack_Fail,ex:e.t0}),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,null,[[5,16]])})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(o){var i,s,c,l,u,d,f,p,m,h,v,g,y,_,b,I,x,T,k,S,C,w,N,E;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=o.scene,s=n.getState(),c=s.shoppingId,l=void 0===c?"":c,u=s.tagInfo,d=s.train12306LoginData,f=s.selectIds,p=void 0===f?[]:f,m=s.passengerObj,h=void 0===m?{}:m,v=s.Platform,g=u||{},y=g.isTrain,_=void 0!==y&&y,b=d||{},I=b.token,x=void 0===I?"":I,e.prev=4,v!==_e.CTRIPRN||!_||!x){e.next=19;break}return T={shoppingId:l,platform:0,requestScenario:0,channel:3,token:x,scene:i},4===i&&(k=[],null===p||void 0===p||p.forEach((function(e){var t=null===h||void 0===h?void 0:h[e];if(!oe.isEmpty(t)){var n=t.CNName,r=void 0===n?"":n,a=t.ENFirstName,o=void 0===a?"":a,i=t.ENLastName,s=void 0===i?"":i,c=t.idInfo,l=void 0===c?{}:c;k.push({passengerNameCN:r||"",passengerNameEN:s+o||"",idNo:(null===l||void 0===l?void 0:l.IdCardNo)||""})}})),T.contactList=k),e.next=10,t.post("/21646/bookingLimitCheck",T);case 10:if(S=e.sent,C=S||{},w=C.success,N=C.ResponseStatus,E=C.bookingLimitInfoList,!w||"Success"!==(null===N||void 0===N?void 0:N.Ack)){e.next=16;break}return e.abrupt("return",E||[]);case 16:return e.abrupt("return",null);case 17:e.next=20;break;case 19:return e.abrupt("return",null);case 20:e.next=26;break;case 22:return e.prev=22,e.t0=e["catch"](4),e.t0.isNetError||r&&r.logError({pageName:"OrderV3",message:"/21646/bookingLimitCheck",ex:e.t0}),e.abrupt("return",null);case 26:case"end":return e.stop()}}),e,null,[[4,22]])})));return function(t){return e.apply(this,arguments)}}();return{getUserInfo:s,getFareRemark:u,getPrePose:d,getInsuranceDetail:f,customerValidCheck:m,getPriceDetail:l,getOrderInitInfo:h,getOrderSecInfo:v,updateResource:g,GetPassenger:c,fetchPinyin:y,getMemberinfo:_,bookingXResource:b,getMainGuestCount:I,getProductInfo:x,bookLimitCheck:T}};function Nn(e){var t,n=[],r={},a=e||{},o=a.commonPassengers,i=void 0===o?[]:o,s=a.validatePassengers,c=void 0===s?[]:s,l=a.availableCards,u=a.listOption,d=void 0===u?{}:u,f=d||{},p=f.version,m=void 0===p?"":p;if("0"===(null===e||void 0===e||null===(t=e.result)||void 0===t?void 0:t.result)){var h=new Map,v=new Map;if(i.length>0&&i.forEach((function(e){e.passengerID&&""!==e.passengerID&&(En(e,l),h.set(e.passengerID,e))})),c.length>0&&c.forEach((function(e){e.passengerID&&""!==e.passengerID&&v.set(e.passengerID,e)})),i.length>0){var g={},y={};i.forEach((function(e){var t={},a=e.passengerID;if(a&&""!==a){var o=h.get(a),i=v.get(a);g=jn(o),t.commonPassenger=g,y=On(i,"PKG","0"),t.validatePassenger=y,r[a]=Dn(m,g,y)}n.push(t)}))}}return{commonPassengers:{passengers:n},chosenInfo:r}}var En=function(e,t){var n=[];if(Array.isArray(t)){var r=t.filter((function(t){return t.nation===e.nationality}));0===r.length&&(r=t.filter((function(e){return"*"===e.nation}))),r.forEach((function(e){var t=e.type,r=e.availableCards;if(r.length>0){var a=r.map((function(e){return{type:t,cardInfo:e.cardInfo}}));n.push.apply(n,(0,R.Z)(a))}else n.push({type:t,cardInfo:[]})}))}e.availableCards=n};function Pn(e){return e&&""!==e?parseInt(e,10):null}function jn(e){var t={};return null!==e&&void 0!==e&&e.passengerID&&Object.assign(t,e),t}function On(e,t,n){var r={},a={};if(e&&e.passengerID&&""!==e.passengerID&&e.bizType&&e.bizType===t){var o=Object.assign(a,e);delete o.bizType,r=o,r.passengerType=Pn(e.passengerType),r.source=n||null;var i=[],s=e.validatePassengerCards;s&&s.length>0&&s.forEach((function(e){var n={},r={};if(e.bizType===t){var a=Object.assign(r,e);delete a.bizType,n=a,i.push(n)}})),r.validatePassengerCards=i}return r}function Dn(e,t,n){var r={unEffect:"F",chosenCards:[]},a=t||{},o=a.availableCards,i=void 0===o?[]:o,s=n||{},c=s.validatePassengerCards,l=void 0===c?[]:c;if(i&&0!==i.length)if("2"===e)if(l&&l.length){var u={};l.map((function(e){u[e.cardType]={canUse:e.canUse}})),i.some((function(e,t){var n=e||{},a=n.cardInfo,o=void 0===a?[]:a,i=!0,s=[];if(o.map((function(e){var t=e.cardType;l[t]&&"T"===l[t].canUse||(i=!1),s.push(t)})),0===t){if(r.chosenCards=s,i)return!0}else if(i)return r.chosenCards=s,!0}))}else i[0].cardInfo.map((function(e){r.chosenCards.push(e.cardType)}));else i.forEach((function(e){if(l)for(var t=0;t<l.length;t+=1){var n=l[t];if(n.cardType&&Rn(n.cardType,e))return void r.chosenCards.push(n.cardType)}var a=e.cardInfo;a&&a.length>0&&a[0].cardType&&r.chosenCards.push(a[0].cardType)}));else r.chosenCards=[];return r}function Rn(e,t){if(!t)return!1;if(t){var n=t.cardInfo;if(n&&n.length>0){var r=n.find((function(t){return String(t.cardType)===String(e)}));if(r)return!0}}return!1}function An(e,t){if(oe.isEmpty(e)||oe.isEmpty(e.Segments))return null;var n={data:[],isSupportSelectSeat:!1},r=[],a=[],o=e||{},s=o.Segments,c=void 0===s?[]:s;!oe.isEmpty(c)&&c.sort((function(e,t){return e.SegmentNo-t.SegmentNo}));var l=t||{},u=l.trainSaleStartTime,d=void 0===u?"":u,f=l.trainSaleEndTime,p=void 0===f?"":f;return oe.forEach(c,(function(e,t){var o=e||{},s=o.SegmentNo,c=void 0===s?0:s,l=o.TrainInfos,u=void 0===l?[]:l,f=o.ScrambleInfo,m=void 0===f?{}:f,h=o.SelectedInfo,v=void 0===h?{}:h,g=o.SegmentBookingType,y=u[0];if(y){var _=y.TrainNo,b=y.TrainType,I=y.DepartDate,x=y.DepartInfo,T=y.ArriveInfo,k=y.DayDiff,S=y.DurationMinute,C=y.Seats,w=void 0===C?[]:C,N=y.Flags,E=void 0===N?[]:N,P=w[0]||{},j=P.SeatName,O=P.ConfirmDuration,D=P.BookingType,R=P.Token,A=(P.UnitPriceInfos,P.SeatCount,b&&oe.includes([1,2],b)&&1===g&&oe.includes(["\u4e8c\u7b49\u5ea7","\u4e00\u7b49\u5ea7","\u5546\u52a1\u5ea7"],j));null!==v&&void 0!==v&&v.Seat?r.push((0,i.Z)({},v.Seat)):r.push({SegmentNo:c,TrainNo:_,SeatNumbers:[]});var M=new Set,V=new Set;if(m&&!oe.isEmpty(m)){M.add(_),V.add(j);var L=m||{},B=L.Seats,U=void 0===B?[]:B,Z=L.Trains,F=void 0===Z?[]:Z;F&&!oe.isEmpty(F)&&F.map((function(e){var t=e||{},n=t.TrainNo;M.add(n)})),U&&!oe.isEmpty(U)&&U.map((function(e){var t=e||{},n=t.SeatName;V.add(n)}))}var G=b&&oe.includes([2,3,4],D)||d&&p&&Ln(d,p);n.data.push({segmentNo:c,trainNo:_,isSupportSelectSeat:A,confirmDuration:Vn(O.DurationMinute)||"",isShowTicketSoldOut:G,isSupportIDCard:E&&oe.includes(E,"supportCard")||!1,isCR:E&&oe.includes(E,"isCR")||!1,departDate:Un(I,"MM-DD(\u5468w)"),departCityName:null===x||void 0===x?void 0:x.CityName,departStationName:null===x||void 0===x?void 0:x.StationName,arriveDate:new ye(ye.transformTimeStamp(I)).addDay(k).format("MM-DD"),arriveCityName:null===T||void 0===T?void 0:T.CityName,arriveStationName:null===T||void 0===T?void 0:T.StationName,durationMinutes:Zn(S||0),isOverNight:k&&k>0||!1,seatName:j,departTime:null===x||void 0===x?void 0:x.Time,arriveTime:null===T||void 0===T?void 0:T.Time,trainNoGrabList:G&&Array.from(M).join("\u3001")||"",trainSeatGrabList:G&&Array.from(V).join("\u3001")||"",trainIndex:+t+1}),R&&a.push(R),A&&!n.isSupportSelectSeat&&(n.isSupportSelectSeat=!0)}})),null!==t&&void 0!==t&&t.isOpenTrainSeat||(n.isSupportSelectSeat=!1),{trainInfo:n,selectedTrainSeats:r,trainTokens:a}}function Mn(e){var t={};return null!==e&&void 0!==e&&e.length&&e.map((function(e){var n=e||{},r=n.SeatNumbers,a=void 0===r?[]:r,o=n.SegmentNo,i=[],s=[],c="";oe.isEmpty(a)||a.map((function(e){var t=e.split("")||[],n=(0,M.Z)(t,2),r=n[0],a=n[1];"1"===r&&a&&i.push(a),"2"===r&&a&&s.push(a)})),a&&1===a.length?t[o]=i.join(""):(oe.isEmpty(i)||(c+="\u524d\u6392"+i.join("\u3001")),oe.isEmpty(s)||(c+=(c?"\uff0c":"")+"\u540e\u6392"+s.join("\u3001")),c&&(t[o]=c))})),t}var Vn=function(e){return 0===e?"\u7acb\u5373\u786e\u8ba4":e>0&&e<60?"".concat(e,"\u5206\u949f\u5185\u786e\u8ba4"):e>=60&&e<=2880?"".concat(e%60===0?Math.floor(e/60):Math.floor(e/60)+(e%60>30?1:.5),"\u5c0f\u65f6\u5185\u786e\u8ba4"):e>2880?"\u5927\u4e8e48\u5c0f\u65f6\u786e\u8ba4":""},Ln=function(e,t){return!Bn(e,t)},Bn=function(e,t){var n=function(e){var t=new Date;return t.setHours(e.split(":")[0]),t.setMinutes(e.split(":")[1]),t.getTime()},r=(new ye).format("HH:mm"),a=n(r);e=n(e),t=n(t);var o=e<a&&a<t;return o},Un=function(e,t){return ye.parse(e).format(t)},Zn=function(e){var t=Math.floor(e/60),n=e-60*t;return n?"".concat(t,"h").concat(n,"m"):"".concat(t,"h")},Fn=["cardRelationItem"];function Gn(e){var t,n=e.pageinfo,r=e.pageState,a=e.platFormInfo,o=e.isBSTOfSSR,s=void 0!==o&&o,c=r||{},l=(c.ABTestResult,c.PageIds),u=void 0===l?{}:l,d=n||{},f=d.productInfo,p=d.shoppingDetail,m=d.userContactInfo,h=(d.extraResource,d.qConfig),v=f||{},g=v.BasicInfo,y=void 0===g?{}:g,_=v.BasicExtendInfo,b=void 0===_?{}:_,I=v.FeeInfoList,x=v.CostInfoList,T=v.VendorInfo,k=v.ExtInfo,S=v.resourceSlot,C=v.TagGroupInfo,w=v.easeOrderInfo,N=v.TourGroupInfo,E=y||{},P=E.ProductId,j=E.ProductCategoryId,O=E.DepartureId,D=E.DepartureCityName,R=E.DestCityId,A=E.DestCityName,M=E.IsThemeProduct,V=E.SaleMode,L=E.SaleCityId,B=E.ProductPatternId,U=E.PiCategoryId,Z=E.isCruise,F=p.ShoppingId,G=p.Shopping,H=p.tagInfo,q=void 0===H?{}:H,K=p.tmpOrderInfo,z=void 0===K?{}:K,Y=p.bookingLimit,W=void 0===Y?{}:Y,$=(p.orderConfirmTime,p.orderNoticeInfo),X=void 0===$?{}:$,J=p.contactTemplate,Q=void 0===J?{}:J,ee=p.shoppingEmotionalCues,te=p.addressInfo,ne=(p.paymentWayInfo,p.Flight),re=(p.Hotel,p.Train,p.Cruise),ae=(p.imEntryInfo,p.resourceCertificate),ie=(p.bookForm,p.bookFormCallback),se=p.mrgMemberUserInfo,ce=p.prefetchSetting,le=null;se&&se.memberinfo&&(le=rr(se.memberinfo));var ue=m||{},de=ue.contacts,fe=void 0===de?{}:de,pe=Kn(fe,z,Q,le,a);if(s)return pe;var me=ie||{},he=me.CommonInfo,ve=void 0===he?{}:he,ge=G||{},_e=ge.Basic,be=ge.Tags,Ie=_e||{},xe=Ie.ArriveDate,Te=Ie.DepartDate,ke=Ie.Passengers,Se=0,Ce=0,we=0;ke&&ke.map((function(e){"Adult"===e.Type&&(Se=e.Count),"Child"===e.Type&&(Ce=e.Count),"Infant"===e.Type&&(we=e.Count)}));var Ne={};Ne.AdultCount=Se,Ne.ChildCount=Ce,Ne.InfantCount=we,Ne.DepartureDate=Te&&ye.parse(Te,!1).format(),Ne.ReturnDate=xe&&ye.parse(xe,!1).format(),Ne.totalPersonCount=Se+Ce+we,Ne.ageBaseLine=Ne.DepartureDate,Ne.travelDays=Te&&xe&&ye.dayDiff(Te,xe)+1||0;var Ee="",Pe="";Ee="\u8bf7\u9009\u62e9".concat(Se?Se+"\u6210\u4eba":"").concat(Ce?Ce+"\u513f\u7ae5":"").concat(we?we+"\u5a74\u513f":""),Ne.numErrorTip=Ee,Ne.numShowTip=Pe;var je=3,Oe="grp",De=(null===u||void 0===u?void 0:u.grp)||"220170",Re=null===y||void 0===y?void 0:y.isPureDiyfhxsdp,Ae=null===y||void 0===y?void 0:y.isDiyfhxsdp;Z?(je=4,Oe="cruise",De=(null===u||void 0===u?void 0:u.cruise)||"10650053820"):Re&&(je=2,Oe="sdp1.0",De=(null===u||void 0===u?void 0:u.sdp)||"414040");var Me,Ve=b||{},Le=Ve.PriceStandardList,Be=void 0===Le?[]:Le,Ue=Ve.IsIndistinguishablePopulation,Ze=void 0!==Ue&&Ue,Ge={sType:2,isIndistinguishablePopulation:Ze};Be.forEach((function(e){2===e.PassengerType&&(Me=e,Ge.childInfo=e),3===e.PassengerType&&(Ge.infantInfo=e),1===e.PassengerType&&(Ge.adultInfo=e)})),Ge.ages=Me?[Me.MinAge,Me.MaxAge]:Re?[2,18]:[2,12];var He=!!Z&&!!Ze&&!1===(null===Ge||void 0===Ge||null===(t=Ge.childInfo)||void 0===t?void 0:t.IsCanBook),qe=(null===S||void 0===S?void 0:S.specialBrandInfo)||{},Ke="",ze="",Ye="",We=0;Ke=null!==y&&void 0!==y&&y.IsThemeProduct||[33,34,41,42].indexOf(j)>-1?null===y||void 0===y?void 0:y.Title:null===y||void 0===y?void 0:y.MainName,be&&be.map((function(e){"productlinename"===e.Key&&(Ye=e.Value),"productlinetype"===e.Key&&(ze=e.Value),"recommendsearch_calendar_price"===e.Key&&(We=+e.Value)}));var $e=P,Xe=null===N||void 0===N?void 0:N.TourGroupProductInfo;Xe&&Xe.length&&($e=Xe[0].ProductId);var Je={ProductId:P,ProductCategoryId:j,ProductPatternId:B,PiCategoryId:U,DepartureId:O,DepartureCityName:D,DestCityId:R,DestCityName:A,childStandard:Ge,ProductName:Ke,ProductAlias:ze,ProductLineName:Ye,shoppingId:F,IsThemeProduct:M,SaleMode:V,SaleCityId:L,ProductType:je,isPureDiyfhxsdp:Re,isDiyfhxsdp:Ae,mainProductId:$e,recommendDisplayPrice:We,isCruise:Z};if(C&&C.MoreTagList){var Qe=$n(C.MoreTagList);Qe&&null!==q&&void 0!==q&&q.returnDate&&(Je.returnTip="".concat(q.returnDate,"23:59\u524d\u514d\u8d39\u9000"))}Je.hasQueryTag=!!C;var et=ee||{},tt=et.shoppingTips,nt=et.emergencyTips,rt=void 0===nt?[]:nt,at=et.packageTips,ot=zn(tt);w&&w.isShow&&(ot.newProductEmotiona=null);var it=Yn(h)||{};it.isTrainCheckStatus=it.isTrainCheckStatus&&(null===q||void 0===q?void 0:q.isTrain);var st=q||{},ct=(st.isTrain,ne||{}),lt=ct.Segments,ut=void 0===lt?[]:lt,dt=ct.ComboLimit;if(ut&&ut.length){var ft,pt,mt=(null===(ft=ut[0])||void 0===ft?void 0:ft.Flights)||[],ht=mt&&mt[0];null!==ht&&void 0!==ht&&null!==(pt=ht.DepartInfo)&&void 0!==pt&&pt.DateTime&&(Ne.ageBaseLine=ye.parse(ht.DepartInfo.DateTime,!1).format())}var vt=[];if(re&&re.OvaryRooms){var gt=0;oe.forEach(re.OvaryRooms,(function(e){var t=e.CabinInfos,n=void 0===t?[]:t,r=e.SelectedPassengers,a=void 0===r?[]:r,o=n.map((function(e){return e.CabinId+""})),s=0;oe.forEach(a,(function(e){e.Count&&(s+=e.Count)})),vt.push((0,i.Z)((0,i.Z)({},e),{},{cabinIds:o,totalCount:s})),gt+=n.length})),re.BirthLimit&&re.BirthLimit.MaxBirthday&&Ne.DepartureDate&&(Je.childStandard.cruiseAge=Fe(re.BirthLimit.MaxBirthday,Ne.DepartureDate)),Ne.cabinNum=gt}return(0,i.Z)((0,i.Z)((0,i.Z)({BasicExtendInfo:b,FeeInfoList:I,CostInfoList:x,ExtInfo:k,easeOrderInfo:w,orderBasicInfo:(0,i.Z)({},Ne),productBasicInfo:(0,i.Z)({},Je),VendorInfo:{SalerInfo:{VendorId:null===T||void 0===T?void 0:T.VenderId,BrandId:null===T||void 0===T?void 0:T.BrandId,FullName:null===T||void 0===T?void 0:T.VendorName,ContractPhoneInfo:null===T||void 0===T?void 0:T.VendorPhone,ExtNumber:null===T||void 0===T?void 0:T.VendorPhone,WorkTimeDescription:null===T||void 0===T?void 0:T.PhoneServiceTime,ContractName:null===T||void 0===T?void 0:T.VendorUser}},ageBaseLine:Ne.ageBaseLine,bookingLimit:W&&W.bookingLimits,orderNoticeInfo:X,tmpOrderInfo:z,pageid:De,logInfo:{shoppingid:F,productId:P,lineid:ze,bu:Oe,pageid:De},shoppingId:F,staticEmotional:at,tagInfo:(0,i.Z)((0,i.Z)({},q),{},{isHidePassengerType:He,isOverSea:null===y||void 0===y?void 0:y.IsOverSea})},pe),{},{pageEmotionalObj:ot},it),{},{urgentInfo:rt,CommonInfo:ve,Segments:ut,firstScreenStatus:1,cruise:vt,ComboLimit:dt,defaultUsaAdd:te&&te.defaultAddressInfo||null,ResourceCards:ae&&ae.ResourceCards,specialBrandInfo:qe,memberinfo:le,prefetchSetting:ce,isPrivateGroup:4===B})}function Hn(e){var t=e.pageinfo,n=e.platFormInfo,r=n||{},a=r.bstMinContact,o=r.bstContact,s={};if(o||a){var c=Gn({pageinfo:t,platFormInfo:n,isBSTOfSSR:!0});s=(0,i.Z)({},c)}return s}function qn(e,t,n){var r,a=n.trainSaleStartTime,o=void 0===a?"":a,s=n.trainSaleEndTime,c=void 0===s?"":s,l=n.isOpenTrainSeat,u=n.orderBasicInfo,d=n.QConfigInfo,f=n.tagInfo,p=n.cruise,m=n.selectIds,h=void 0===m?[]:m,v=n.passengerObj,g=n.ResourcePassengerMapList,y=(n.productBasicInfo,t[0]||{}),_=y||{},b=_.shoppingDetail,I=(0,M.Z)(e,4),x=(I[0],I[1]),T=I[2],k=I[3],S=T||{},C=S.shoppingDetail,w=S.extraResource,N=S.productInfo,E=void 0===N?{}:N,P=C||{},j=P.airlineClause,O=P.orderConfirmTime,D=P.imEntryInfo,R=P.bookForm,A=P.paymentWayInfo,V=P.orderNoticeInfo,L={};null!==E&&void 0!==E&&E.FeeInfoList&&(L.FeeInfoList=E.FeeInfoList),null!==E&&void 0!==E&&E.OrderKnow&&(L.OrderKnow=E.OrderKnow);b.Shopping,b.Flight;var B=b.Hotel,U=b.Train,Z=b.tmpOrderInfo,F=b.bookFormCallback,G=F||{},H=G.RemindInfo,q=void 0===H?{}:H,K=B||{},z=K.Hotels,Y=void 0===z?[]:z,W=_n(Y),$=An(U,{trainSaleStartTime:o,trainSaleEndTime:c,isOpenTrainSeat:l})||{},X=$.trainInfo,J=void 0===X?{}:X,Q=$.selectedTrainSeats,ee=void 0===Q?[]:Q,te=$.trainTokens,ne=void 0===te?[]:te,re=Qe(w,{orderBasicInfo:u}),ae=re.shoppingDic,ie=re.resourceDic,se=re.showResourceDic,ce={},le=0;if(ae&&ae["SINGLE_ROOM_CHARGE"]){var ue=ae["SINGLE_ROOM_CHARGE"].Count;if(ue){if(ue%1!==0){ce.status=!0;var de=ie["SINGLE_ROOM_CHARGE"]||{},fe=de.filter((function(e){return e.Count===Math.ceil(ue)}));ce.noShareInfo=fe[0]||{}}le=ue;var pe=ie&&ie["SINGLE_ROOM_CHARGE"];ce.minCount=pe[0].Count,ce.maxCount=pe[pe.length-1].Count,ce.currentCount=ue,ce.countRange=pe.map((function(e){return e.Count}))}}var me=on(ie&&ie["INSURANCE"],ae&&ae["INSURANCE"],u),he=Wn(R,u),ve=he||{},ge=ve.DeliveryTemplate,_e=ve.ResourcePassengers,be=ve.OrderNoticeInfo,xe=void 0===be?{}:be,Te=(null===xe||void 0===xe||null===(r=xe.ProductNotice)||void 0===r?void 0:r.find((function(e){return"\u8fdd\u7ea6\u6761\u6b3e"===(null===e||void 0===e?void 0:e.AddInfoSubTitleName)})))||{},ke=null;oe.isEmpty(null===Te||void 0===Te?void 0:Te.BreachClause)||(ke=Te.BreachClause);var Se=A||{},Ce=Se.isPaidFirst,we=void 0!==Ce&&Ce,Ne="";if(null!==O&&void 0!==O&&O.confirmDateTime&&null!==O&&void 0!==O&&O.clientConfirmTime){var Ee=O.confirmDateTime.match(/^\/Date\(-?(\d+)(\+|-)\d+\)\/$/);if(Ee){var Pe=+Ee[1];Ne=new ye(new Date(Pe)).format("MM\u6708DD\u65e5 HH:mm")}}var je=Z||{},Oe=je.orderBasicInfo,De=void 0===Oe?{}:Oe,Re=je.invoiceInfo,Ae=void 0===Re?{}:Re,Me=je.deliveryInfo,Ve=void 0===Me?{}:Me,Le=je.customerAddOptionInfo,Be=void 0===Le?{}:Le,Ue=je.clientInfoList,Ze=void 0===Ue?[]:Ue,Fe=Be||{},Ge=Fe.hotelRooms,He=void 0===Ge?[]:Ge;ce&&ce.status&&Ze&&Ze.length&&oe.forEach(Ze,(function(e){e.isRoomAssign&&oe.includes(h,e.infoID)&&(ce.passengerId=e.infoID,ce.name=e.clientName||e.clientNameE)}));var qe=null;null!==Ae&&void 0!==Ae&&Ae.invoiceTitle&&(qe={Address:null===Ae||void 0===Ae?void 0:Ae.address,BankCardNumber:null===Ae||void 0===Ae?void 0:Ae.bankCardNumber,Content:null===Ae||void 0===Ae?void 0:Ae.invoiceDetail,DepositBank:null===Ae||void 0===Ae?void 0:Ae.depositBank,Email:null===Ae||void 0===Ae?void 0:Ae.emailAddress,InvoiceId:0,InvoiceType:null===Ae||void 0===Ae?void 0:Ae.invoiceType,IsNeedInvoice:null===Ae||void 0===Ae?void 0:Ae.isNeedInvoice,IsSelectedEinvoice:null===Ae||void 0===Ae?void 0:Ae.isEInvoice,Mobile:null===Ae||void 0===Ae?void 0:Ae.mobliePhone,RatepayerCode:null===Ae||void 0===Ae?void 0:Ae.ratepayerCode,Telphone:null===Ae||void 0===Ae?void 0:Ae.telPhone,Title:null===Ae||void 0===Ae?void 0:Ae.invoiceTitle});var Ke=null;if(null!==Ve&&void 0!==Ve&&Ve.deliveryType){var ze=Ie[Ve.deliveryType];Ke={DeliveryType:null===ze||void 0===ze?void 0:ze.deliveryType,IsUseIntegral:null===Ve||void 0===Ve?void 0:Ve.isIntegralArrival,AddressInfo:{Address:null===Ve||void 0===Ve?void 0:Ve.address,CantonID:null===Ve||void 0===Ve?void 0:Ve.districtId,CantonName:null===Ve||void 0===Ve?void 0:Ve.districtName,CityId:null===Ve||void 0===Ve?void 0:Ve.cityId,CityName:null===Ve||void 0===Ve?void 0:Ve.cityName,InfoId:null===Ve||void 0===Ve?void 0:Ve.infoID,Post:null===Ve||void 0===Ve?void 0:Ve.postCode,ProvinceId:null===Ve||void 0===Ve?void 0:Ve.provinceId,ProvinceName:null===Ve||void 0===Ve?void 0:Ve.provinceName,Recipient:null===Ve||void 0===Ve?void 0:Ve.receiverName,Tel:null===Ve||void 0===Ve?void 0:Ve.contactTel}}}var Ye=ge&&lt(ge,qe);Ye&&(Ke=ut(ge,Ye,Ke));var We=E||{},$e=We.userDestinationOrder,Xe=cr(n,$e),Je=Xe||{},et=Je.remark,tt=void 0===et?[]:et,nt=(null===De||void 0===De?void 0:De.remark)||"";tt&&tt.length&&tt.forEach((function(e){nt=nt.replace(new RegExp("\\|?".concat(e)),"")})),console.log("\ud83e\udd21orderRemark",nt);var rt={HotelRemark:[],Remark:nt};He&&He.length&&(rt.HotelRemark=He.map((function(e){return{HotelToken:null===e||void 0===e?void 0:e.hotelToken,Token:null===e||void 0===e?void 0:e.token,Remark:null===e||void 0===e?void 0:e.remark,RemarkTokens:null===e||void 0===e?void 0:e.remarkTokens}})),rt.HotelRemark=bn(rt.HotelRemark));var at=w||{},ot=at.single,it=void 0===ot?[]:ot,st=[];it&&it.length&&it.forEach((function(e){var t=e||{},n=t.groups,r=void 0===n?[]:n;null===r||void 0===r||r.forEach((function(e){var t=e||{},n=t.datas,r=void 0===n?[]:n,a={};null===r||void 0===r||r.forEach((function(e){var t;2!==(2&e.Basic.BMStatus)&&null!==e&&void 0!==e&&null!==(t=e.SelectedInfo)&&void 0!==t&&t.SelectedCount&&(a=e)}));var o=a,i=o.Basic,s=o.SelectedInfo,c=s||{},l=c.OrderExtendInfos,u=void 0===l?[]:l,d=[];u&&u.length&&u.map((function(e){null!==e&&void 0!==e&&e.Content&&d.push("".concat(null===e||void 0===e?void 0:e.Name,"\uff1a").concat(null===e||void 0===e?void 0:e.Content))})),d.length&&st.push({pickName:null===i||void 0===i?void 0:i.ResourceName,extendArr:d})}))}));var ct={highMessage:[],airlineClause:[],commonMessages:[],isShowTip:!1,isSelect:!1,isShowAuthorize:!1,isSelectAuthorize:!1},dt=V||{},ft=dt.productNotice,pt=void 0===ft?[]:ft,mt=d.find((function(e){return"order_clauses"===e.Key})),ht=mt.Value&&JSON.parse(mt.Value),vt=(null===ht||void 0===ht?void 0:ht.highRisk)||[];if(vt.length&&pt.length){var gt,yt=pt.find((function(e){return e.addInfoSubTitleCode&&73===+e.addInfoSubTitleCode}));null!==yt&&void 0!==yt&&null!==(gt=yt.productAddInfoDetails)&&void 0!==gt&&gt.length&&oe.forEach(yt.productAddInfoDetails,(function(e){oe.includes(vt,+e.clauseItemId)&&ct.highMessage.push(e.descDetail)}))}null!==j&&void 0!==j&&j.ClauseList&&(ct.airlineClause=j.ClauseList||[]);var bt=0,It=!1,xt=!1,Tt="";null===h||void 0===h||h.forEach((function(e){var t,n=v[e];(null===n||void 0===n?void 0:n.age)>=70&&(It=!0),null!==n&&void 0!==n&&n.child&&(xt=!0),null!==n&&void 0!==n&&null!==(t=n.defaultPhoneInfo)&&void 0!==t&&t.mobilePhone&&bt++})),ct.isShowOldMan=It,ct.isShowUnderAge=xt,ct.isShow=It||xt||!!ct.airlineClause.length||!!ct.highMessage.length,ct.tipMessages=_t(ct,xe),null!==f&&void 0!==f&&f.isOverSea&&(ct.commonMessages.push({key:"authorize",name:"\u4e2a\u4eba\u4fe1\u606f\u51fa\u5883\u6388\u6743\u58f0\u660e",tabName:"\u4e2a\u4eba\u4fe1\u606f\u51fa\u5883\u6388\u6743\u58f0\u660e"}),ct.isShowAuthorize=!0),ct.isShow=ct.tipMessages&&!!ct.tipMessages.length||!1,bt||(Tt="\u8bf7\u81f3\u5c11\u586b\u5199\u4e00\u4f4d\u51fa\u884c\u4eba\u65c5\u5ba2\u7684\u624b\u673a\u53f7\u7801");var kt=$t({selectIds:h,passengerObj:v,orderBasicInfo:u,ResourcePassengerMapList:g,ResourcePassengers:_e,shoppinginfo:ae||{},resourceinfo:ie||{},cruise:p}),St={};if(k&&k.length){var Ct=[];k.map((function(e){e.MainGuestCount&&"number"===typeof e.MainGuestCount&&Ct.push(e.MainGuestCount)})),Ct.length&&(St.count=Math.max.apply(Math,Ct),St.mainGuestInfo=k)}return(0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)({},x),L),{},{airlineClause:j,confirmDateTime:Ne,IMEntryInfo:D&&D.imInfo,IMServiceInfo:D&&D.serviceInfo,orderNoticeInfo:V,travelerRule:ke},he),{},{lowPriceInsInfo:me,hotelInfo:W,trainInfo:J,selectedTrainSeats:ee,trainTokens:ne,roomcount:le,tagInfo:(0,i.Z)((0,i.Z)({},f),{},{isPaidFirst:we,isContainInsurance:ie&&!!ie["INSURANCE"]}),shoppinginfo:ae||{},resourceinfo:ie||{},showresourceinfo:se||{},sharedRoomInfo:ce,OrderInvoice:qe,OrderDelivery:Ke,formatDlyData:Ye,customerRequirement:rt,pickUpRemark:st,RemindInfo:q,userNotice:ct,noPhoneMsg:Tt},kt),{},{hotelMainGuest:St,transferInfo:Xe,firstScreenStatus:2})}function Kn(e,t,n,r,a){var o={},s={},c=t||{},l=c.contactInfo,u=void 0===l?{}:l;if(oe.isEmpty(u))if(e&&e.Data&&e.Data.length){var d=e.Data[0]||{};o.Name=d.cNName,o.Email=d.contactEmail,d.countryCodeForeign&&d.mobilePhoneForeign?(o.Moblie=d.mobilePhoneForeign,o.CountryCode=d.countryCodeForeign):d.countryCode&&d.mobilePhone?(o.Moblie=d.mobilePhone,o.CountryCode=d.countryCode):o.CountryCode="86",o.ContactId=d.contactID}else o.CountryCode="86";else{var f=u.destinationAddress;o.Name=u.contactName,o.Email=u.contactEmail,o.Moblie=u.contactMobile,o.CountryCode=u.countryCode,u.contactIDCardNumber&&(o.ContactIDCardNumber=u.contactIDCardNumber),u.Gender&&u.Gender>-1&&(o.Gender=u.Gender),u.IdCardType&&(o.IdCardType=u.IdCardType),f&&(s.CountryCode=f.countryCode,s.StateCode=f.stateCode,s.ProvinceName=f.provinceName,s.CityName=f.cityName,s.Address=f.address,s.ZipCode=f.zipCode,s.DestinationEmail=f.destinationEmail,s.RestrictionAreaType=f.restrictionAreaType,s.RelatedResourceId=f.relatedResourceId)}n=Ae(n)||{};var p=a||{},m=p.bstMinContact,h=p.bstContact;h&&(o=h);var v=n,g=v.idTypes,y=void 0===g?[]:g,_=(0,i.Z)({},o),b=r||{},I=b.isNeedRegiHotel,x=void 0!==I&&I;(x||y&&y.length)&&(_={Gender:-1,CountryCode:"86"}),!_.IdCardType&&y&&y.length&&(y.includes("1")?_.IdCardType=1:_.IdCardType=+y[0]),!_.IdCardType&&_.ContactIDCardNumber&&delete _.ContactIDCardNumber;var T=it(_.IdCardType,n);if(m)return _.IdCardType&&(m.IdCardType=_.IdCardType),{contactTemplate:n,contactShowItems:T,ContactInfo:m,errorMemberInfo:{},DestinationAddress:s};if(x){var k,S,C=n||{},w=C.cardRelationRules,N=void 0===w?[]:w;if(T.ChineseName)delete T.ChineseName,T.SurenameCN=!0,T.GivenNameCN=!0,(null===(k=n)||void 0===k||null===(k=k.items)||void 0===k?void 0:k.ChineseName)&&delete n.items.ChineseName,n.items.SurenameCN={customerInfoItemType:"SurenameCN",name:"\u4e2d\u6587\u59d3"},n.items.GivenNameCN={customerInfoItemType:"GivenNameCN",name:"\u4e2d\u6587\u540d"};if(T.EnglishName)delete T.EnglishName,T.Surname=!0,T.GivenName=!0,(null===(S=n)||void 0===S||null===(S=S.items)||void 0===S?void 0:S.EnglishName)&&delete n.items.EnglishName,n.items.Surname={customerInfoItemType:"Surname",name:"\u82f1\u6587\u59d3"},n.items.GivenName={customerInfoItemType:"GivenName",name:"\u82f1\u6587\u540d"};n.cardRelationRules=N.map((function(e){var t=e.cardRelationItem,n=void 0===t?[]:t,r=(0,A.Z)(e,Fn),a=[];return n.forEach((function(e){"ChineseName"===e?a=a.concat(["SurenameCN","GivenNameCN"]):"EnglishName"===e?a=a.concat(["Surname","GivenName"]):a.push(e)})),(0,i.Z)({cardRelationItem:a},r)}))}return{contactTemplate:n,contactShowItems:T,ContactInfo:_,errorMemberInfo:{},DestinationAddress:s,contactDealInfo:{initMobile:o.Moblie}}}function zn(e){var t={backEmotional:[],newProductEmotiona:[]};return null===e||void 0===e||e.forEach((function(e){if("BOOKING_DYNAMIC"===e.PromptType&&(t.bottomEmotional={title:e.Title,content:e.Content}),"PRODUCT_SELLING"===e.PromptType){t.productEmotional={title:e.Title,content:e.Content};var n=e.ExtendInfos,r=void 0===n?[]:n,a=r&&r.find((function(e){return"promo_type"===e.Key&&"SECURE_TRAVEL"===e.Value}));t.newProductEmotiona.push({title:e.Title,content:e.Content,securetravel:!!a})}"REENTRY_MOTIVATE"===e.PromptType&&e.Content&&t.backEmotional.push(e.Content)})),t}function Yn(e){var t=!1,n=!1,r=!1,a="",o="",i=e||{},s=i.AppSettingList,c=void 0===s?[]:s;return c&&c.length>0&&c.map((function(e){if("order_train_check"===e.Key){var i=JSON.parse(e.Value);t=i&&i.train_passenger_check}if("order_insurance_agent"===e.Key){var s=JSON.parse(e.Value);n=s&&s.close_insurance_agent_app}if("publictraininfo.train_saleStartTime"===e.Key&&(a=e.Value),"publictraininfo.train_saleEndTime"===e.Key&&(o=e.Value),"order_train_seat"===e.Key){var c=JSON.parse(e.Value);r=c&&c.train_seat_open}})),{QConfigInfo:c,isTrainCheckStatus:t,isCloseInsAgent:n,trainSaleStartTime:a,trainSaleEndTime:o,isOpenTrainSeat:r}}function Wn(e,t){var n=e.CommonInfoV4,r=e.ProductBasicInfo,a=e.DeliveryTemplate,o=e.InvoiceTemplate,s=e.ResourceInfo,c=e.OrderNoticeInfo,l=s||{},u=l.ResourcePassengers,d=void 0===u?[]:u,f=l.TrainList,p=void 0===f?[]:f;d&&d.length&&(d=d.filter((function(e){return e.ResourceInfo&&5!==e.ResourceInfo.ResourceType})));var m=mt(t,s,n);return(0,i.Z)({CommonInfoV4:n,ProductBasicInfo:r,DeliveryTemplate:a,InvoiceTemplate:o,OrderNoticeInfo:c,ResourcePassengers:d||[],TrainList:p},m)}function $n(e){return e.find((function(e){return oe.includes([2147],e.TagId)}))}var Xn=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n,r){var o,s,c,l,u,d,f,p,m,h,v,g,y,_,b,I,x,T,k,S,C,w,N,E,P,j,O,D,R,A,M,V,L,B,U,Z,F;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=n.pageinfo,s=n.passengerinfo,c=Nn(s),l=c.commonPassengers,u=c.chosenInfo,console.log("\ud83e\udd21passengerinfo",s),d=o.shoppingDetail,f=void 0===d?{}:d,p=f||{},m=p.tmpOrderInfo,h=void 0===m?{}:m,v=p.tagInfo,g=void 0===v?{}:v,y=g||{},_=y.isTrain,b=void 0!==_&&_,I=f.ShoppingId,x=void 0===I?"":I,T=h||{},k=T.clientInfoList,S=void 0===k?[]:k,C={},w=!1,N=[],S&&S.length&&oe.forEach(S,(function(e){var t=e.idCardInfoList,n=void 0===t?[]:t,r=e.clientToken;console.log("=========clientToken=============",r);var a=[],o="F";oe.forEach(n,(function(e){100===e.idCardType?(w=!0,o="T"):a.push(e.idCardType+"")})),C[r]={chosenCards:a,unEffect:o},N.push(+r)})),E=null,P={},j=[],O=[],D=(new Date).getTime(),R=(new Date).getTime(),e.next=17,wt(t,x,(null===l||void 0===l?void 0:l.passengers)||[]);case 17:return A=e.sent,E=At((null===l||void 0===l?void 0:l.passengers)||[],u,A)||[],console.log("commonPassengers\ud83e\udd21",l),j=Vt(N,E),console.log("============\u62c9\u53d6\u5e38\u65c5==============",D,R,R-D,E),M=(new Date).getTime(),e.next=25,Bt(t,j,{shoppingId:x,CommonPassengers:E,chosenInfoMap:w?{}:C,tagInfo:g,template:A});case 25:if(P=e.sent,V=(new Date).getTime(),console.log("============\u524d\u7aef\u5904\u7406\u5916\u9732\u51fa\u884c\u4eba==============",D,M,V-M,j),!S||!S.length){e.next=35;break}if(oe.forEach(S,(function(e){var t=e.clientToken,n=e.ageType,a=void 0===n?"":n,o=e.heightType;if(P[t]){var i=st(P[t],r)||{},s=i.type,c=i.age,l=void 0===c?-1:c;if(O.push(+t),"C"===s?P[t].AgeRang=0:"A"===s?P[t].AgeRang=1:"B"===s?P[t].AgeRang=2:"CHI"===a?P[t].AgeRang=0:"ADU"===a?P[t].AgeRang=1:"BAB"===a&&(P[t].AgeRang=2),P[t].age=l,b){var u=ct(P[t],r);"A"===u.type?P[t].Height="above_150":1===o?P[t].Height="below_120":2===o?P[t].Height="between_120_150":3===o&&(P[t].Height="above_150")}}})),O.length===S.length){e.next=35;break}return j=Vt(O,E),e.next=34,Bt(t,j,{shoppingId:x,CommonPassengers:E,chosenInfoMap:w?{}:C,tagInfo:g});case 34:P=e.sent;case 35:return L=[],B=h||{},U=B.resourceClientMapInfoList,Z=void 0===U?[]:U,Z&&Z.length&&Z.map((function(e){var t=e.resourceToken,n=e.assignedClients,r=[],a=!0;n.map((function(e){r.push(e),oe.includes(O,+e)||(a=!1)})),a&&L.push({ResourceToken:t,PassengerTokenList:r})})),F=Wt({tagInfo:g,selectIds:O,passengerObj:P}),e.abrupt("return",(0,i.Z)((0,i.Z)({CommonPassengers:E,ShowPassenger:j,passengerObj:P,selectIds:O},F),{},{ResourcePassengerMapList:L||[]}));case 40:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function Jn(e,t,n){return Qn.apply(this,arguments)}function Qn(){return Qn=(0,o.Z)((0,a.Z)().mark((function e(t,n,r){var o,i,s,c,l,u,d,f;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=(0,M.Z)(t,4),c=s[0],l=s[1],u=s[2],d=s[3],f={FareRemark:(null===c||void 0===c||null===(o=c.CabinInfo)||void 0===o||null===(o=o.QTEFareRemarkForShopping)||void 0===o?void 0:o.RemarkList)||{},FareRemark_NeedRetry:(null===c||void 0===c||null===(i=c.CabinInfo)||void 0===i||null===(i=i.QTEFareRemarkForShopping)||void 0===i?void 0:i.NeedRetry)||!1,IsContrainSelf:!!d,firstScreenStatus:3},l&&(f.resourceinfo=l),e.next=5,er(u,n,r);case 5:return f.Installment=e.sent,e.abrupt("return",f);case 7:case"end":return e.stop()}}),e)}))),Qn.apply(this,arguments)}function er(e,t,n){return tr.apply(this,arguments)}function tr(){return tr=(0,o.Z)((0,a.Z)().mark((function e(t,n,r){var o,s,c,l,u,d,f,p,m,h,v,g,y,_,b,I,x,T,k,S,C,w,N,E,P,j,O,D,R;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(o=t||{},s=o.usable,c=o.feeType,l=void 0===c?"":c,u=o.details,d=void 0===u?[]:u,f=o.paymentType,p="CC"===f,m=n.Installment,h=n.Platform,v=n.productBasicInfo,g=!1,!s||"A"===l||oe.isEmpty(d)){e.next=30;break}if(!p){e.next=25;break}if(y=v||{},_=y.SaleMode,h!==_e.CTRIPRN||!p){e.next=18;break}if("R"!==_){e.next=12;break}return e.abrupt("return",null);case 12:return e.next=14,r.getABTest("230703_VAC_xykfq");case 14:if(b=e.sent,g="B"===(null===b||void 0===b?void 0:b.ExpVersion),g){e.next=18;break}return e.abrupt("return",{cardInstallmentShow:!1,paymentType:f});case 18:return I=0,x=-1,T=m||{},k=T.details,S=void 0===k?[]:k,C=T.selectedIndex,w=(null===S||void 0===S?void 0:S[C])||{},null===d||void 0===d||d.forEach((function(e,t){(null===e||void 0===e?void 0:e.brandId)===(null===w||void 0===w?void 0:w.brandId)&&(x=t)})),e.abrupt("return",(0,i.Z)((0,i.Z)({},t),{},{recommendIndex:I,selectedIndex:x,cardInstallmentShow:g}));case 25:return N=m||{},E=N.details,P=void 0===E?[]:E,j=N.selectedIndex,O=(null===P||void 0===P?void 0:P[j])||{},D=0,R=-1,null===d||void 0===d||d.forEach((function(e,t){0===(null===e||void 0===e?void 0:e.termInstallmentFee)&&(D=t),+(null===e||void 0===e?void 0:e.installmentNum)===+(null===O||void 0===O?void 0:O.installmentNum)&&(R=t)})),e.abrupt("return",(0,i.Z)((0,i.Z)({},t),{},{recommendIndex:D,selectedIndex:R}));case 30:return e.abrupt("return",null);case 31:case"end":return e.stop()}}),e)}))),tr.apply(this,arguments)}function nr(e){var t=e.UserInterestList,n=e.ExtendInfo,r={},a=n||{},o=a.LevelName,s=void 0===o?"":o,c=a.VipGrade,l=void 0===c?0:c;r.levelInfo=n,r.superInterest={LevelName:"\u8d85\u7ea7\u4f1a\u5458",InterestName:"\u8d85\u7ea7\u4f1a\u5458\u4e13\u4eab",imageUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/super_small.png",bgImgUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/super_bg.png",titleColor:"#5f3006"};var u=l&&Te[l]||{};return l&&(r.levelInterest={LevelName:s||"",InterestName:"".concat(s,"\u4e13\u4eab\uff08\u9700\u672c\u4eba\u51fa\u884c\uff09"),imageUrl:u.smallImgUrl,bgImgUrl:u.bgImgUrl,titleColor:u.titleColor}),t&&t.map((function(e){23===e.InterestType&&(61===e.CreateProductLineId?(r.superInterest=(0,i.Z)({},e),r.superInterest.LevelName="\u8d85\u7ea7\u4f1a\u5458",r.superInterest.InterestName="\u8d85\u7ea7\u4f1a\u5458\u4e13\u4eab",r.superInterest.InterestExpireDate=e.InterestExpireDate&&ye.parse(e.InterestExpireDate,!1).format()||"",r.superInterest.imageUrl="https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/super_small.png",r.superInterest.bgImgUrl="https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/userlevel/super_bg.png",r.superInterest.titleColor="#5f3006"):66===e.CreateProductLineId&&(r.levelInterest=(0,i.Z)({},e),r.levelInterest.LevelName=s,r.levelInterest.InterestName="".concat(s,"\u4e13\u4eab\uff08\u9700\u672c\u4eba\u51fa\u884c\uff09"),r.levelInterest.InterestExpireDate=e.InterestExpireDate&&ye.parse(e.InterestExpireDate,!1).format()||"",r.levelInterest.imageUrl=u.smallImgUrl,r.levelInterest.bgImgUrl=u.bgImgUrl,r.levelInterest.titleColor=u.titleColor))})),r}function rr(e){if(oe.isEmpty(e))return e;var t=e.mgrGroup,n=void 0===t?{}:t,r=e.mgrGroupIds,a=void 0===r?[]:r,o=[];a&&a.length&&e.mgrGroupIds.forEach((function(e){var t=n[e]||{},r=t.privacyTerms;r&&(o=o.concat(r))}));var s={};return o.length&&(s.privacyTerms=o,s.isCheckPrivacyTerms=!1),(0,i.Z)((0,i.Z)({},e),s)}function ar(e,t,n){var r=t||{},a=r.sharedRoomInfo,o=r.DeliveryTemplate,s=n||{},c=s.selectIds,l=void 0===c?[]:c,u=s.query,d={},f=e||{},p=f.sharedRoomInfo,m=f.OrderDelivery,h=f.OrderInvoice,v=f.customerRequirement;a&&a.status&&p&&oe.includes(l,p.passengerId)&&(d.sharedRoomInfo=(0,i.Z)((0,i.Z)({},a),{},{passengerId:p.passengerId,name:p.name})),h&&h.Title&&(d.OrderInvoice=h),m&&m.DeliveryType&&(d.OrderDelivery=m,d.formatDlyData=o&&lt(o,h),d.formatDlyData&&(d.OrderDelivery=ut(o,d.formatDlyData,m))),v&&(v.Remark||v.HotelRemark&&v.HotelRemark.length)&&(d.customerRequirement=v);var g=u||{},y=g.token,_=g.status,b=g.orderid;return y&&_&&b&&(d.selectedPromotion=e.selectedPromotion),d}function or(e,t,n){var r=n||{},a=r.query,o=a||{},i=o.token,s=o.status,c=o.orderid;return i&&s&&c&&"number"===typeof e.installmentSelectIndex&&t.Installment&&(t.Installment.selectedIndex=e.installmentSelectIndex),t}var ir,sr,cr=function(e,t){var n=e.Platform;if(n!==_e.CTRIPRN)return{};var r=t||{},a=r.productDestinationOrderList,o=r.productReturnOrderList;r.tags;if(oe.isEmpty(a)&&oe.isEmpty(o))return{};var s=[],c=[];return null===a||void 0===a||a.forEach((function(e){var t=e.bizType,n=e.station,r=e.arrivalDateTime,a=e.destinationCityName,o=e.productNumber;n=n||("Flight"===t?"\u673a\u573a":"\u706b\u8f66\u7ad9");var l="".concat("Flight"===t?"\u673a":"\u7ad9"),u=ye.parse(r,!1);s.push("\u63a5".concat(l,"\uff1a").concat(n,"\uff0c").concat(u.format("YYYY-MM-DD hh:mm"),"\uff0c").concat(o)),c.push((0,i.Z)((0,i.Z)({},e),{},{name:"".concat(a,"\u63a5").concat(l),desc:"\u53bb".concat(n,"\u63a5\u60a8"),date:u.format("MM-DD")}))})),null===o||void 0===o||o.forEach((function(e){var t=e.bizType,n=e.station,r=e.departureDateTime,a=e.departureCityName,o=e.productNumber;n=n||("Flight"===t?"\u673a\u573a":"\u706b\u8f66\u7ad9");var l="".concat("Flight"===t?"\u673a":"\u7ad9"),u=ye.parse(r,!1);s.push("\u9001".concat(l,"\uff1a").concat(n,"\uff0c").concat(u.format("YYYY-MM-DD hh:mm"),"\uff0c").concat(o)),c.push((0,i.Z)((0,i.Z)({},e),{},{name:"".concat(a,"\u9001").concat(l),desc:"\u9001\u60a8\u53bb".concat(n),date:u.format("MM-DD")}))})),{remark:s,list:c}},lr=n(32180)["window"],ur=["hasPreload"],dr=["idInfos"],fr=["status"],pr=["status"],mr={isShowBookLimitMask:!1,isShowCouponMask:!1,isShowAlertMask:!1,isShowDeliveryInfoMask:!1,isShowDeliveryTypeMask:!1,isShowDeliveryAddressMask:!1,isShowResourceSelectPersonMask:!1,isShowDuplicationMask:!1,isShowSaveOrderMask:!1,isShowPassengerTypeMask:!1,isShowInsuranceSelectPersonMask:!1,isShowPriceDetailMask:!1,isShowResourceErrorMask:!1,isShowBuyTrainTicketMask:!1,isShowInsuranceTipMask:!1,isShowShareRoomMask:!1,isWeChatShareMask:!1,isShowUrgentNoticeMask:!1,isShowVendorMask:!1,isShowChildStandarMask:!1,isShowInsuranceIntroductionMask:!1,isShowMemberCardsMask:!1,isShowRetailInvoiceMask:!1,isShowFareRemarkMask:!1,isShowInsConfirmMask:!1,isShowFullBgMask:!1,isShowCruiseSelectPersonMask:!1,isShowIMEntryInfo:!1,isShowTrainSelectSeatMask:!1,isShowTrainDetailMask:!1,isShowPersonListMask:!1,isShowCountryCodeMask:!1,isShowTrain12306ContactMask:!1,isShowHotelSelectContactMask:!1,isShowAirlineClauseMask:!1,isShowTravelerRuleMask:!1,isShowCreateShoppingErrorMask:!1,isShowSelectDate:!1,isShowSelectPassenger:!1,isShowRoomIntroductionMask:!1,isShowBookReadMask:!1,isShowTrainHeightMask:!1},hr="undefined"!==typeof process&&"development"===(null===(ir=process)||void 0===ir||null===(ir=ir.env)||void 0===ir?void 0:"production"),vr="undefined"!==typeof process&&"test"===(null===(sr=process)||void 0===sr||null===(sr=sr.env)||void 0===sr?void 0:"production"),gr=(0,i.Z)((0,i.Z)({},mr),{},{isShowInstalmentBar:!0});console.log("\ud83e\udd21111",111);var yr=(0,p.createReactModel)((function(){var e,t,r=me(),s=(null===r||void 0===r?void 0:r.ctrl)||{},c=ue(),l={};Object.keys(c).forEach((function(e){l[e.toLocaleLowerCase()]=c[e]})),console.log("============setupStore===========");var u=(0,p.setupStore)({initialState:(0,i.Z)((0,i.Z)((0,i.Z)({},gr),{},{query:l,shoppingId:(null===l||void 0===l?void 0:l.shoppingid)||"6e9108cc4fca429d825cb6fd4ac99644",productid:(null===l||void 0===l?void 0:l.productid)||3027328,departcityid:(null===l||void 0===l?void 0:l.departcityid)||2,isQuickBooking:(null===l||void 0===l?void 0:l.isquickbooking)||!1,preSaleShoppingId:(null===l||void 0===l?void 0:l.shoppingid)||"6b4cd38c12334d21a0745089b90a4265",snapShotId:(null===l||void 0===l?void 0:l.snapshotid)||"3d11aaa71f2f3d965c95b38e9b015a03",orderId:(null===l||void 0===l?void 0:l.orderid)||0,pageid:"grp_orger",currency:"CNY",locale:"zh_CN",isNext:!0,isSubmit:!1,footPriceStatus:0,payStatus:0,selectedPromotion:l&&"2"===l.usecouponstatus?{useStatus:2,couponInfo:null}:{},shardParams:r.attachGqlCommonParams()},fe()),{},{isUnitTest:vr}),reducers:ce,logger:hr}),d=u.store,m=u.actions;vr&&(n.g.actions=m),console.log("initstore",null===r||void 0===r?void 0:r.isServer);var h=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,s,u,d,f,p;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=null===r||void 0===r?void 0:r.getPlatform(),t!==_e.CTRIPH5){e.next=36;break}if(console.log("setupPreloadCallback\ud83e\udd21",c),null===r||void 0===r||!r.isServer){e.next=29;break}return e.prev=4,n=m.UPDATE_ORDER_INFO,console.log("\ud83d\udc7dssr ========= getOrderInitInfo"),e.next=9,x.getOrderInitInfo();case 9:if(o=e.sent,!1!==o){e.next=13;break}return n({hasPreload:!1}),e.abrupt("return");case 13:if(s=(null===o||void 0===o?void 0:o.shoppingDetail)||{},u=s.shoppingOrderStatus,!u||!u.code){e.next=18;break}if(!([202,204,205].indexOf(u.code)>-1)){e.next=18;break}return n({hasPreload:!1}),e.abrupt("return");case 18:d=Gn({pageinfo:o}),n((0,i.Z)({hasPreload:!0,preloadFirstInfo:o},d)),e.next=27;break;case 22:e.prev=22,e.t0=e["catch"](4),console.log("\ud83d\udc7dssr ========== error"),f=m.UPDATE_ORDER_INFO,f({hasPreload:!1});case 27:e.next=34;break;case 29:return console.log("is In Client"),/resourcenew/i.test(null===l||void 0===l?void 0:l.from)&&(p=r.get("FIRST_DATA_OF_BOOKING")||{},r.set("FIRST_DATA_OF_BOOKING",{}),console.log("\ud83d\ude0d\ud83d\ude0d\ud83d\ude0d",p),oe.isEmpty(p)||(I.firstScreenDataOfH5=p)),e.next=33,g();case 33:T(!0);case 34:e.next=45;break;case 36:if(t!==_e.CTRIPRN){e.next=42;break}return e.next=39,g();case 39:T(!0),e.next=45;break;case 42:return e.next=44,g();case 44:T();case 45:case"end":return e.stop()}}),e,null,[[4,22]])})));return function(){return e.apply(this,arguments)}}();(0,p.setupPreloadCallback)(h);var v=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=d.getState(),n=t.hasPreload,console.log("setupStartCallback",null===r||void 0===r?void 0:r.isServer),void 0===n){e.next=6;break}return e.next=5,g();case 5:T(!0);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(null===r||void 0===r?void 0:r.getPlatform())===_e.CTRIPH5&&(0,p.setupStartCallback)(v);var g=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("==============preloadCallBackAction=============="),r.preSetPageId(l),t={},!r.getInitialData){e.next=8;break}return e.next=6,r.getInitialData(gr);case 6:n=e.sent,t=(0,i.Z)({},n);case 8:console.log(t),o=m.UPDATE_ORDER_INFO,o((0,i.Z)({},t));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=null===r||void 0===r||null===(e=r.Stores)||void 0===e||null===(e=e.OrderCouponUseStatusStore)||void 0===e?void 0:e.getInstance(),_=[],b={},I={},x=wn({ctx:r,store:d}),T=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,r,o,i,s=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]&&s[0],n=d.getState(),r=n.Platform,o=void 0===r?0:r,i=n.pageStatus,"presale"!==i){e.next=5;break}return ga.initAppPage(),e.abrupt("return");case 5:if("preorder"!==i){e.next=9;break}return e.next=8,_a.initPreOrderPage();case 8:return e.abrupt("return");case 9:o===_e.CTRIPWX?(S(!1),k()):(S(!0),w(),!t&&N());case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[x.getOrderInitInfo(),r.getMarketingInfo(),x.GetPassenger()],r.platFormInfo&&t.push(r.platFormInfo(d.getState())),e.next=4,Promise.all(t);case 4:I.basicInfo=e.sent,C();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,i,s,c,l,u,f,m,h;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=d.getState(),i=n.Platform,s=void 0===i?0:i,e.next=3,x.getUserInfo();case 3:if(c=e.sent,!1!==c&&!1!==(null===c||void 0===c?void 0:c.IsLogin)){e.next=10;break}sa({module:"\u767b\u5f55\u6001",scene:"\u83b7\u53d6\u767b\u5f55\u6001",action:p.ActionType.show,value:"\u83b7\u53d6\u767b\u5f55\u6001\u5931\u8d25",jsonData:c}),I.userinfo=!1,s===_e.CTRIPWX&&r.login&&r.login({callback:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,T();case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}),e.next=20;break;case 10:return l=c.SuperMemberInfo||{},u=l&&l.InterestCounts||0,f=nr(c),e.next=15,r.get("storage_svip");case 15:return m=e.sent,e.next=18,r.get("order_tips_status");case 18:h=e.sent,I.userinfo={pageData:{interestCounts:u,userInterests:f},SvipStorage:m,order_tips_status:h||{}};case 20:t?E():C();case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,s,c,l,u,f,p,h,v,g,y,b,x,T;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!1!==I.userinfo){e.next=4;break}return I.userinfo=null,I.basicInfo=null,e.abrupt("return");case 4:if(e.prev=4,!(I.userinfo&&I.basicInfo&&I.basicInfo.length)){e.next=39;break}if(t=(new Date).getTime(),n=(0,M.Z)(I.basicInfo,3),o=n[0],s=n[1],c=n[2],!1!==c){e.next=10;break}throw new Error("init-initPassengerInfo");case 10:if(!1!==o){e.next=13;break}return Qr({typeName:"NetWorkError"}),e.abrupt("return");case 13:if(l=(null===o||void 0===o?void 0:o.shoppingDetail)||{},u=l.shoppingOrderStatus,!u||!u.code){e.next=20;break}if(!([202,204,205].indexOf(u.code)>-1)){e.next=20;break}return p=u.ResponseStatus&&u.ResponseStatus.Errors&&u.ResponseStatus.Errors[0]||{},sa({module:"\u63a5\u53e3\u8bf7\u6c42",scene:"shopping\u5173\u8054\u8ba2\u5355\u72b6\u6001\u5f02\u5e38 14556/getOrderStatusByShoppingId",rootMessageId:null===u||void 0===u||null===(f=u.ResponseStatus)||void 0===f||null===(f=f.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===f?void 0:f.Value,key:p.ErrorCode}),Tr({isShowAlertMask:!0,options:(0,i.Z)((0,i.Z)({},u),{},{typeName:"OrderStatus"})}),e.abrupt("return");case 20:if(h=d.getState(),v=h.Platform,g=void 0===v?0:v,y=Gn({pageinfo:o,pageState:h}),b={},g!==_e.CTRIPRN){e.next=30;break}return e.next=27,U(c,y);case 27:b=e.sent,e.next=33;break;case 30:return e.next=32,Xn(r,{passengerinfo:c,pageinfo:o},y);case 32:b=e.sent;case 33:return x=m.UPDATE_ORDER_INFO,x((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)({},y),I.userinfo),b),{},{marketingInfo:s})),T=(new Date).getTime(),_.push({timeStamp:T,content:[{key:"\u9996\u5c4f\u63a5\u53e3",value:String(T-t)}]}),e.next=39,P();case 39:e.next=45;break;case 41:e.prev=41,e.t0=e["catch"](4),Qr({typeName:"NetWorkError"}),ca("initPageCallback",e.t0);case 45:case"end":return e.stop()}}),e,null,[[4,41]])})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,i,s,c,l,u,f,p,m;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=d.getState(),n=t.hasPreload,o=t.preloadFirstInfo,i=Date.now(),!n){e.next=12;break}return e.next=5,Promise.all([r.getClientInfo(),r.platFormInfo&&r.platFormInfo()||null]);case 5:s=e.sent,c=(0,M.Z)(s,2),l=c[0],u=c[1],I.basicInfo=[o,l,u],e.next=24;break;case 12:if(oe.isEmpty(I.firstScreenDataOfH5)){e.next=20;break}return e.next=15,Promise.all([I.firstScreenDataOfH5,r.getClientInfo(),r.platFormInfo&&r.platFormInfo()||null]);case 15:f=e.sent,I.basicInfo=f,I.firstScreenDataOfH5=null,e.next=24;break;case 20:return e.next=22,Promise.all([x.getOrderInitInfo(I.isNeedNewFetch),r.getClientInfo(),r.platFormInfo&&r.platFormInfo()||null]);case 22:p=e.sent,I.basicInfo=p;case 24:m=Date.now(),I.startTime=i,I.fetchTime=m,E();case 28:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,i,s;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=d.getState(),n=t.shoppingId,o=void 0===n?"":n,i=Date.now(),e.next=4,r.initPassengerInfo(o);case 4:I.initPassenger=e.sent,s=Date.now(),I.startPassengerTime=i,I.fetchPassengerTime=s,E();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,s,c,l,u,f,p,h,v,g,y,b,x,T,k,S,C,w,N,E,j,O,D,R,V,L,B,Z,F,G,H,q,K,z,Y,W;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!1!==I.userinfo){e.next=3;break}return Qr({typeName:"NetWorkError"}),e.abrupt("return");case 3:if(console.log("\ud83e\udd21firstScreenRet.basicInfo",I.basicInfo),e.prev=4,I.prefetchStatus){e.next=45;break}if(!I.userinfo||null===(t=I.basicInfo)||void 0===t||!t.length){e.next=43;break}if(n=d.getState(),o=(0,M.Z)(I.basicInfo,3),s=o[0],c=o[1],l=o[2],!1!==I.initPassenger){e.next=11;break}throw new Error("init-initPassengerInfo");case 11:if(!1!==s){e.next=14;break}return Qr({typeName:"NetWorkError"}),e.abrupt("return");case 14:if(u=s||{},f=u.__isFromCache,p=void 0!==f&&f,h=(null===s||void 0===s?void 0:s.shoppingDetail)||{},v=h.shoppingOrderStatus,n.Platform!==_e.CTRIPRN||I.isNeedNewFetch||(na("tour_orderv3_preload2_denominator",{}),p&&na("tour_orderv3_preload2_fromCache",{__isFromCache:p})),!v||!v.code){e.next=23;break}if(!([202,204,205].indexOf(v.code)>-1)){e.next=23;break}return y=v.ResponseStatus&&v.ResponseStatus.Errors&&v.ResponseStatus.Errors[0]||{},sa({module:"\u63a5\u53e3\u8bf7\u6c42",scene:"shopping\u5173\u8054\u8ba2\u5355\u72b6\u6001\u5f02\u5e38 14556/getOrderStatusByShoppingId",rootMessageId:null===v||void 0===v||null===(g=v.ResponseStatus)||void 0===g||null===(g=g.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===g?void 0:g.Value,key:y.ErrorCode}),Tr({isShowAlertMask:!0,options:(0,i.Z)((0,i.Z)({},v),{},{typeName:"OrderStatus"})}),e.abrupt("return");case 23:if(b=n.hasPreload,x=(0,A.Z)(n,ur),T={},k={},b?k=Hn({pageinfo:s,platFormInfo:l}):T=Gn({pageinfo:s,pageState:n,platFormInfo:l}),I.prefetchStatus=1,S=(0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)({},T),k),I.userinfo),{},{marketingInfo:c}),C={},!I.initPassenger){e.next=35;break}return e.next=33,U(I.initPassenger,b?x:T);case 33:C=e.sent,I.prefetchStatus=2;case 35:w={},r.getFirModelFromStoreg&&(N=r.getFirModelFromStoreg(),w=N&&N.mergeObj||{}),E=m.UPDATE_ORDER_INFO,E((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)({},S),C),{},{prefetchStatus:I.prefetchStatus},w),{},{hasPreload:!1})),j=Date.now(),I.renderTime1=j,I.renderTime2=j,I.__isFromCache=p;case 43:e.next=59;break;case 45:if(1!==I.prefetchStatus){e.next=59;break}if(!1!==I.initPassenger){e.next=48;break}throw new Error("init-initPassengerInfo");case 48:if(O=d.getState(),D={},!I.initPassenger){e.next=55;break}return e.next=53,U(I.initPassenger,O);case 53:D=e.sent,I.prefetchStatus=3;case 55:R=m.UPDATE_PASSENGER_INFO,R((0,i.Z)((0,i.Z)({},D),{},{prefetchStatus:I.prefetchStatus,hasPreload:!1})),V=Date.now(),I.renderTime2=V;case 59:if(![2,3].includes(I.prefetchStatus)){e.next=70;break}if(L=I,B=L.startTime,Z=L.fetchTime,F=L.renderTime1,G=L.__isFromCache,_.push({timeStamp:F,content:[{key:"\u547d\u4e2d\u7f13\u5b58",value:String(G)},{key:"\u9996\u5c4f\u63a5\u53e3",value:String(Z-B)},{key:"\u9996\u5c4f\u6e32\u67d3",value:String(F-Z)}]}),H=d.getState(),q=H.Platform,q!==_e.CTRIPRN||!r.isIOS){e.next=68;break}return e.next=66,P(!0);case 66:e.next=70;break;case 68:return e.next=70,P();case 70:e.next=84;break;case 72:e.prev=72,e.t0=e["catch"](4),console.log("error======",e.t0),I={},I.isNeedNewFetch=!0,K="initPageCallback_App",null!==e.t0&&void 0!==e.t0&&e.t0.toString().includes("init-")&&(K=e.t0.toString().replace("Error: ","")),z=m.UPDATE_ORDER_INFO,Y=d.getState(),W=Y.Platform,W===_e.CTRIPH5&&z({hasPreload:!1}),Qr({typeName:"NetWorkError"}),e.t0.isNetError||"init-initPassengerInfo"===K||ca(K,e.t0);case 84:case"end":return e.stop()}}),e,null,[[4,72]])})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,s,c,l,u,f,p,h,v,g,y=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=y.length>0&&void 0!==y[0]&&y[0],console.log("getSecondData"),!t&&r.showMaskLoading({text:"\u8bf7\u6c42\u4e2d...",cancelable:!1},(function(){})),n=_[_.length-1],o=(new Date).getTime(),n&&n.timeStamp&&(o=n.timeStamp),e.prev=6,e.next=9,Promise.all([q(),Z(),x.getOrderSecInfo(),B(I.basicInfo&&I.basicInfo[0])]);case 9:if(s=e.sent,r.hideMaskLoading(),!oe.includes(s,!1)){e.next=14;break}return Qr({typeName:"SecondInterfaceError"}),e.abrupt("return");case 14:c=(new Date).getTime(),l=d.getState(),u=m.UPDATE_ORDER_INFO,f=qn(s,I.basicInfo,l),p=r.getSecModelFromStoreg&&ar(r.getSecModelFromStoreg(),f,l)||{},u((0,i.Z)((0,i.Z)({},f),{},{forceReloadTimestamp:1e3},p)),h=(new Date).getTime(),_.push({timeStamp:h,content:[{key:"\u6b21\u5c4f\u63a5\u53e3",value:String(c-o)},{key:"\u6b21\u5c4f\u6e32\u67d3",value:String(h-c)}]}),v=l.productBasicInfo,g=l.tagInfo,v&&3===v.ProductType&&g&&g.isNeedUsAddress&&pt(),e.next=31;break;case 26:e.prev=26,e.t0=e["catch"](6),console.log("error================",e.t0),ca("getSecondData",e.t0),Qr({typeName:"SecondInterfaceError"});case 31:case"end":return e.stop()}}),e,null,[[6,26]])})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,i,s,c,l,u,f,p,h,v,g,y;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=d.getState(),n=t.firstScreenStatus,o=void 0===n?0:n,e.prev=2,!(o<3)){e.next=27;break}return i=_[_.length-1],s=(new Date).getTime(),i&&i.timeStamp&&(s=i.timeStamp),e.next=9,Promise.all([x.getFareRemark(),V(),D(),z(t),x.bookLimitCheck({scene:3})]);case 9:if(c=e.sent,!oe.includes(c,!1)){e.next=13;break}return Qr({typeName:"ThirdInterfaceError"}),e.abrupt("return");case 13:return l=(new Date).getTime(),e.next=16,Jn(c,t,r);case 16:u=e.sent,r.getThirdModelFromStoreg&&(u=or(r.getThirdModelFromStoreg(),u,t)),f=m.UPDATE_ORDER_INFO,f(u),p=(new Date).getTime(),h=I,v=h.renderTime2,g=h.startPassengerTime,y=h.fetchPassengerTime,_.push({timeStamp:p,content:[{key:"\u5c3e\u5c4f\u63a5\u53e3",value:String(l-s)},{key:"\u5c3e\u5c4f\u6e32\u67d3",value:String(p-l)},{key:"\u51fa\u884c\u4eba\u63a5\u53e3",value:String(y-g)},{key:"\u6e32\u67d3\u65b9\u5f0f",value:2===I.prefetchStatus?"\u4e0e\u9996\u5c4f\u540c\u6b65\u6e32\u67d3":"\u4e0e\u9996\u5c4f\u5f02\u6b65\u6e32\u67d3"},{key:"\u51fa\u884c\u4eba\u6e32\u67d3",value:String(v-y)}]}),ra(),O(_),e.next=28;break;case 27:L();case 28:e.next=33;break;case 30:e.prev=30,e.t0=e["catch"](2),ca("getLastInfo",e.t0);case 33:case"end":return e.stop()}}),e,null,[[2,30]])})));return function(){return e.apply(this,arguments)}}(),O=function(e){var t=d.getState(),n=t.shoppingId,r=t.orderBasicInfo,a=t.productBasicInfo,o=t.ABTestResult,i=t.train12306LoginData,s=t.ContactInfo,c=t.Platform,l=r||{},u=l.AdultCount,f=l.ChildCount,m=l.InfantCount,h=l.DepartureDate,v=l.ReturnDate,g=a||{},y=g.DepartureId,_=g.DepartureCityName,b=g.ProductName,x=g.ProductId,T=[{key:"\u8d2d\u7269\u8f66id",value:n},{key:"\u4ea7\u54c1id",value:"".concat(b,"(").concat(x,")")},{key:"\u51fa\u53d1\u57ce\u5e02",value:"".concat(_,"(").concat(y,")")},{key:"\u6210\u4eba\u6570",value:String(u)},{key:"\u513f\u7ae5\u6570",value:String(f)},{key:"\u5a74\u513f\u6570",value:String(m)},{key:"\u51fa\u53d1\u65e5\u671f",value:String(h)},{key:"\u8fd4\u56de\u65e5\u671f",value:String(v)}];c===_e.CTRIPH5&&T.push({key:"H5\u5e73\u53f0\u662f\u5426\u4f7f\u7528\u9996\u5c4f\u63a5\u53e3\u7f13\u5b58",value:String(null===I.firstScreenDataOfH5)}),ia({contents:T,desc:"\u57fa\u672c\u4fe1\u606f"});var k=[];e.forEach((function(e){e.content&&e.content.length&&(k=k.concat(e.content))})),ia({desc:"\u9875\u9762\u8017\u65f6",contents:k}),!oe.isEmpty(o)&&ia({contents:Object.entries(o).map((function(e){var t=(0,M.Z)(e,2),n=t[0],r=t[1];return{key:n,value:r}})),desc:"AB\u5b9e\u9a8c"}),sa({module:"\u8054\u7cfb\u4eba",scene:"\u8054\u7cfb\u4eba\u521d\u59cb\u4fe1\u606f",role:p.RoleType.sys,action:p.ActionType.change,contents:[{key:"id",value:null===s||void 0===s?void 0:s.ContactId},{key:"\u59d3\u540d",value:null===s||void 0===s?void 0:s.Name},{key:"\u90ae\u7bb1",value:null===s||void 0===s?void 0:s.Email},{key:"\u56fd\u5bb6\u7801",value:null===s||void 0===s?void 0:s.CountryCode},{key:"\u7535\u8bdd",value:null===s||void 0===s?void 0:s.Moblie}]}),i&&i.userName&&sa({module:"12306\u767b\u5f55",scene:"\u521d\u59cb\u767b\u5f55\u4fe1\u606f",role:p.RoleType.sys,action:p.ActionType.change,value:i.userName,jsonData:i});var S=t.selectIds,C=void 0===S?[]:S,w=t.passengerObj,N=void 0===w?{}:w,E=t.tagInfo,P=void 0===E?{}:E,j=t.query,O=void 0===j?{}:j,D=t.selectedTrainSeats,R=void 0===D?[]:D,A=t.sharedRoomInfo,V=void 0===A?{}:A;if(C&&C.length){var L=[],B=[],U="";C.forEach((function(e){var t=N[e];if(t){var n=Zt(e,N);B.push(n),P.isTrain&&L.push("".concat(n,"-").concat(t.Height?Ee[t.Height]:"")),V&&V.passengerId&&+V.passengerId===+e&&(U=n)}})),L.length&&sa({module:"\u706b\u8f66\u7968",scene:"\u521d\u59cb\u9ed8\u8ba4\u7968\u79cd",role:p.RoleType.sys,action:p.ActionType.change,value:L.join(",")}),R&&R.length&&sa({module:"\u706b\u8f66\u7968",scene:"\u521d\u59cb\u9ed8\u8ba4\u9009\u5ea7",role:p.RoleType.sys,action:p.ActionType.change,value:JSON.stringify(R)}),U&&sa({module:"\u62fc\u623f",scene:"\u521d\u59cb\u9ed8\u8ba4\u62fc\u623f\u4eba",role:p.RoleType.sys,action:p.ActionType.change,value:U}),sa({module:"\u51fa\u884c\u4eba",scene:"\u521d\u59cb\u9009\u62e9\u51fa\u884c\u4eba",role:p.RoleType.sys,action:p.ActionType.change,value:B.join(",")})}var Z,F,G=t.selectedPromotion,H=void 0===G?{}:G,q="";(H&&(H.couponInfo&&H.couponInfo.couponName?q=H.couponInfo.couponName:O&&"2"===O.usecouponstatus&&(q="\u4e0d\u4f7f\u7528\u4f18\u60e0\u5238")),q)&&sa({module:"\u4f18\u60e0\u5238",scene:"\u521d\u59cb\u9ed8\u8ba4\u4f18\u60e0\u5238",role:p.RoleType.sys,action:p.ActionType.change,value:q,contents:[{key:"id",value:null===H||void 0===H||null===(Z=H.couponInfo)||void 0===Z?void 0:Z.couponCode},{key:"\u4f18\u60e0\u5238\u540d\u79f0",value:q},{key:"\u4f18\u60e0\u5238\u4ef7\u683c",value:(null===H||void 0===H||null===(F=H.couponInfo)||void 0===F?void 0:F.deductionAmount)+""}]})},D=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,r,o;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=d.getState(),n=t.Platform,r=void 0===n?0:n,o=t.Channels,r!==_e.CTRIPWX){e.next=4;break}return e.abrupt("return",null);case 4:if(r!==_e.CTRIPH5||!o||!o.isInZTApp&&!o.isInMiniProgramLikeEnv){e.next=6;break}return e.abrupt("return",null);case 6:return e.abrupt("return",x.getPrePose());case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,r,o,i,s,c,l,u,f,p,m,h,v,g,y,_,b,I,T,k,S,C,w;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=d.getState(),o=r.shoppingId,i=r.resourceinfo,s=r.pageData,c=r.QConfigInfo,!oe.isEmpty(i)){e.next=3;break}return e.abrupt("return",null);case 3:if(l=oe.cloneDeep(i),u=l&&l[We.INSURANCE]||{},f=u.insuranceDic,p=u.specialTokens,m=void 0===p?{}:p,!oe.isEmpty(f)){e.next=8;break}return e.abrupt("return",null);case 8:if(h=Object.keys(f),!oe.isEmpty(h)){e.next=11;break}return e.abrupt("return",null);case 11:return v=m||{},g=v.levleCancleTokens,y=void 0===g?[]:g,_=v.svipCancellation,b=void 0===_?[]:_,I=c.filter((function(e){return"order_clauses"===e.Key}))[0],T=I&&I.Value&&JSON.parse(I.Value),k=f&&f[h[0]],e.next=17,x.getInsuranceDetail({ShoppingId:o,Tokens:h,NeedProductDesc:!0,InsuranceSearch:{StartDate:null===k||void 0===k||null===(t=k.resourceShoppingInfo)||void 0===t?void 0:t.useDate,EndDate:null===k||void 0===k||null===(n=k.resourceShoppingInfo)||void 0===n?void 0:n.useEndDate}});case 17:return S=e.sent,C=S||{},w=C.InsuranceDetails,w&&w.map((function(e){var t=e.Basic,n=e.ProductDesc,r=t.Token,a=t.Name;if(f[r]){if(f[r].addInfo={coverageGroupList:null===n||void 0===n?void 0:n.CoverageGroups,description:null===n||void 0===n?void 0:n.Desc,detailUrl:null===n||void 0===n?void 0:n.DetailUrl,clauseUrl:null===n||void 0===n?void 0:n.ClauseUrl,name:a},f[r].hasDetailInfo=!oe.isEmpty(null===n||void 0===n?void 0:n.CoverageGroups),y&&oe.includes(y,r)){var o,i=s||{},c=i.userInterests,l=void 0===c?{}:c;f[r].addInfo.name="".concat(null===l||void 0===l||null===(o=l.levelInfo)||void 0===o?void 0:o.LevelName,"\u4e13\u4eab\u65e0\u5fe7\u9000\u8ba2\u7279\u6743"),f[r].addInfo.diyRules=(null===T||void 0===T?void 0:T.levelInstranceRule)||[]}b&&oe.includes(b,r)&&(f[r].addInfo.name="\u8d85\u7ea7\u4f1a\u5458\u4e13\u4eab\u65e0\u5fe7\u9000\u8ba2\u7279\u6743",f[r].addInfo.diyRules=(null===T||void 0===T?void 0:T.superInstranceRule)||[])}})),e.abrupt("return",l);case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:return t=e.sent,e.next=5,er(t,d.getState(),r);case 5:t=e.sent,t&&(n=m.UPDATE_ORDER_INFO,n({Installment:t}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=null===t||void 0===t||null===(n=t.shoppingDetail)||void 0===n||null===(n=n.Hotel)||void 0===n?void 0:n.Hotels,!r||!r.length){e.next=5;break}return e.abrupt("return",x.getMainGuestCount());case 5:return e.abrupt("return",null);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n){var s,c,l,u,f,p,m,h,v,g,y,_,b,I,x,T,k,S,C,w,N,E,P,j,O,D,R,A,M,V,L,B,U,Z,F,G,H,q,K,z,Y,W,$,X,J,Q,ee,te,ne,re,ae,ie,se,ce;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(l=d.getState(),u=l.Platform,f=t||{},p=f.commonPassengers,m=f.chosenInfo,h=n||{},v=h.shoppingId,g=void 0===v?"":v,y=h.tmpOrderInfo,_=void 0===y?{}:y,b=h.tagInfo,I=h.orderBasicInfo,x=b||{},T=x.isTrain,k=void 0!==T&&T,S=_||{},C=S.clientInfoList,w=void 0===C?[]:C,N=r.getFirModelFromStoreg&&r.getFirModelFromStoreg(),E={},P=!1,j=[],N&&N.selectIds&&N.selectIds.length?(O=N||{},D=O.passengerObj,R=void 0===D?{}:D,oe.forEach(N.selectIds,(function(e){var t=R[e];if(t){var n=t.idInfos,r=void 0===n?[]:n,a=t.PassengerID,o=[],i="F";oe.forEach(r,(function(e){100===+e.IdCardType?(P=!0,i="T"):o.push(e.IdCardType+"")})),E[a]={unEffect:i},o.length&&(E[a].chosenCards=o),j.push(+a)}}))):w&&w.length&&oe.forEach(w,(function(e){var t=e.idCardInfoList,n=void 0===t?[]:t,r=e.clientToken,a=[],o="F";oe.forEach(n,(function(e){100===e.idCardType?(P=!0,o="T"):a.push(e.idCardType+"")})),E[r]={unEffect:o},a.length&&(E[r].chosenCards=a),j.push(+r)})),na("o_vac_order_bbz_passenger_list",{desc:"\u521d\u59cb\u62c9\u53bb\u51fa\u884c\u4eba\u6570\u636e",chosenInfo:m,chosenInfoMap:E}),A=null,M={},V=[],L=[],B=(new Date).getTime(),!P){e.next=20;break}return e.next=15,r.initPassengerInfo(g,E);case 15:U=e.sent,p=null===U||void 0===U?void 0:U.commonPassengers,m=null===U||void 0===U?void 0:U.chosenInfo,e.next=21;break;case 20:j.map((function(e){E[e]&&m&&m[e]&&(m[e]=(0,i.Z)((0,i.Z)({},m[e]),E[e]))}));case 21:return Z=(new Date).getTime(),e.next=24,wt(r,g,(null===(s=p)||void 0===s?void 0:s.passengers)||[]);case 24:return F=e.sent,A=At((null===(c=p)||void 0===c?void 0:c.passengers)||[],m,F)||[],j&&j.length&&(G=[],A&&A.length&&(H=A.map((function(e){return e.passengerID})),j.map((function(e){oe.includes(H,e)&&G.push(e)}))),j=G),V=u===_e.CTRIPRN?Lt(j,A):Vt(j,A),console.log("============\u62c9\u53d6\u5e38\u65c5==============",B,Z,Z-B),q=(new Date).getTime(),e.next=32,Bt(r,V,(0,i.Z)((0,i.Z)({shoppingId:g,CommonPassengers:A,chosenInfoMap:P?{}:E},n),{},{template:F}));case 32:return M=e.sent,K=(new Date).getTime(),console.log("============\u524d\u7aef\u5904\u7406\u5916\u9732\u51fa\u884c\u4eba==============",B,q,K-q),N&&N.selectIds&&N.selectIds.length?(z=N||{},Y=z.passengerObj,W=void 0===Y?{}:Y,oe.forEach(N.selectIds,(function(e){W[e]&&(M[e].AgeRang=W[e].AgeRang,M[e].age=W[e].age,L.push(+e),k&&(M[e].Height=W[e].Height))}))):w&&w.length&&oe.forEach(w,function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var r,o,i,s,c,l,u,d,f;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=t.clientToken,o=t.ageType,i=void 0===o?"":o,s=t.heightType,M[r]&&(c=st(M[r],n)||{},l=c.type,u=c.age,d=void 0===u?-1:u,L.push(+r),"C"===l?M[r].AgeRang=0:"A"===l?M[r].AgeRang=1:"B"===l?M[r].AgeRang=2:"CHI"===i?M[r].AgeRang=0:"ADU"===i?M[r].AgeRang=1:"BAB"===i&&(M[r].AgeRang=2),M[r].age=d,k&&(f=ct(M[r],n),"A"===f.type?M[r].Height=Pe.adult:1===s?M[r].Height=Pe.free:2===s?M[r].Height=Pe.child:3===s&&(M[r].Height=Pe.adult)));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),$=[],X=[],N&&N.selectIds&&N.selectIds.length?(J=N||{},Q=J.TrainPassengerMapList,ee=J.ResourcePassengerMapList,$=Q||[],ee&&ee.length&&ee.map((function(e){var t=e.PassengerTokenList,n=!0;t.map((function(e){oe.includes(L,+e)||(n=!1)})),n&&X.push(e)}))):(te=_||{},ne=te.resourceClientMapInfoList,re=void 0===ne?[]:ne,ae=te.childrenTrainTicketMapInfoList,ie=void 0===ae?[]:ae,ie&&ie.length&&ie.map((function(e){$.push({AdultPassengerToken:e.adultToken,ChildPassengerToken:e.childrenToken})})),re&&re.length&&re.map((function(e){var t=e.resourceToken,n=e.assignedClients,r=[],a=!0;n.map((function(e){r.push(e),oe.includes(L,+e)||(a=!1)})),a&&X.push({ResourceToken:t,PassengerTokenList:r})}))),se=Wt({TrainPassengerMapList:$,tagInfo:b,selectIds:L,passengerObj:M,orderBasicInfo:I},"sys"),ce={},L&&null!==I&&void 0!==I&&I.totalPersonCount&&L.length===I.totalPersonCount&&(ce=tn({selectIds:L,passengerObj:M,ContactInfo:(null===n||void 0===n?void 0:n.ContactInfo)||{},contactDealInfo:(null===n||void 0===n?void 0:n.contactDealInfo)||{}})),e.abrupt("return",(0,i.Z)((0,i.Z)({CommonPassengers:A,ShowPassenger:V,passengerObj:M,selectIds:L},se),{},{ResourcePassengerMapList:X||[]},ce));case 43:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Z=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=d.getState(),t.Platform,e.next=4,F();case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0={};case 7:return n=e.t0,r=n.train12306LoginData,void 0===r?{}:r,e.abrupt("return",(0,i.Z)({},n));case 12:return e.prev=12,e.t1=e["catch"](0),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,i,s,c;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=d.getState(),n=t.tagInfo,o={},i=n||{},s=i.isTrain,c=void 0!==s&&s,!c){e.next=10;break}if(console.log("\ud83e\udd76get12306UserInfo"),"function"!==typeof r.get12306UserInfo){e.next=10;break}return e.next=9,r.get12306UserInfo();case 9:o.train12306LoginData=e.sent;case 10:return e.abrupt("return",o);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=null,H=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,s,c,l,u,f,h,v,g,y,_,b,I,x,T,k,S,C,w,N,E,P,j,O,D,A,M,V,L,B,U,Z,F,H,q,z,Y,W,$,X,J,Q,ee,te,ne,re,ae,ie,se,ce,le,ue,de,fe,pe;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=m.SELECT_PASSENGER,s=m.UPDATE_ORDER_INFO,c=d.getState(),l=c.shoppingId,u=c.orderBasicInfo,f=c.selectIds,h=void 0===f?[]:f,v=c.passengerObj,g=void 0===v?{}:v,y=c.noPhoneError,_=c.ageBaseLine,b=c.isTrainCheckStatus,I=c.Platform,x=void 0===I?0:I,T=c.taroInfo,k=c.sharedRoomInfo,c.selectDate,c.pageStatus,S=c.contactDealInfo,C=u||{},w=C.AdultCount,N=void 0===w?0:w,E=C.ChildCount,P=void 0===E?0:E,j=C.InfantCount,O=void 0===j?0:j,D=C.totalPersonCount,void 0===D?0:D,A=C.numErrorTip,M=(0,R.Z)(h),V=(0,i.Z)({},g),L=M.indexOf(t),B=V[t],U=Zt(t,V),!(L<0)){e.next=55;break}if(M.length!==N+P+O){e.next=15;break}return Z="",Z="\u6700\u591a\u9009\u62e9".concat(N?N+"\u6210\u4eba":"").concat(P?P+"\u513f\u7ae5":"").concat(O?O+"\u5a74\u513f":""),r.showToast(Z),sa({module:"\u4e1a\u52a1\u963b\u65ad",scene:"\u52fe\u9009\u51fa\u884c\u4eba-".concat(U),action:p.ActionType.show,value:Z,key:"vac_30064"}),e.abrupt("return");case 15:if(F=0,H=0,q=0,z=[],Y=[],W=[],M.map((function(e){var t=V[e];1===t.AgeRang?(F++,z.push(t.PassengerID)):0===t.AgeRang?(H++,Y.push(t.PassengerID)):2===t.AgeRang&&(q++,W.push(t.PassengerID))})),B){e.next=23;break}return e.next=21,Bt(r,[t],d.getState());case 21:B=e.sent,B=B[t];case 23:if($=Kt([B]),na("o_vac_order_passenger",{desc:"\u52fe\u9009\u5916\u9732\u51fa\u884c\u4eba",passenger:$}),X=Yt(t,M,V),!X){e.next=29;break}return Gr({status:!0,options:{type:"samecard",ids:X}}),e.abrupt("return");case 29:if(!b){e.next=36;break}if(J=sn(V,M,B,_),!J){e.next=36;break}return Q=J.name,ee=J.currentName,x===_e.CTRIPRN?s({PassengerModalData:{content:["".concat(ee,"\u4e0e").concat(Q,"\u624b\u673a\u53f7\u7801\u91cd\u590d\uff0c\u94c1\u8def\u5c40\u89c4\u5b9a18\uff5e70\u5468\u5c81\u4e58\u5ba2\u8054\u7cfb\u65b9\u5f0f\u4e0d\u53ef\u91cd\u590d\uff0c\u8bf7\u4fee\u6539").concat(ee,"\u624b\u673a\u53f7")],buttons:[{type:"action",code:51001,text:"\u53d6\u6d88\u52fe\u9009",style:"white",status:1001},{type:"action",code:51003,text:"\u53bb\u4fee\u6539",style:"blue",status:1003}],passenger:B}}):Tr({isShowAlertMask:!0,options:{typeName:"BbzPassengerValid",passengerModalData:{content:["".concat(ee,"\u4e0e").concat(Q,"\u624b\u673a\u53f7\u7801\u91cd\u590d\uff0c\u94c1\u8def\u5c40\u89c4\u5b9a18\uff5e70\u5468\u5c81\u4e58\u5ba2\u8054\u7cfb\u65b9\u5f0f\u4e0d\u53ef\u91cd\u590d\uff0c\u8bf7\u4fee\u6539").concat(ee,"\u624b\u673a\u53f7")],buttons:[{type:"action",code:1001,text:"\u53d6\u6d88\u52fe\u9009",style:"white"},{type:"action",code:1003,text:"\u53bb\u4fee\u6539",style:"blue"}],passenger:B}}}),r.showPassengerModal&&r.showPassengerModal(),e.abrupt("return");case 36:if(te=st(B,d.getState())||{},vr&&[190856379,187340627,205978705,202596043,211403487].includes(t)&&(te={type:"U"}),ne={nowAduit:F,nowChild:H,nowInfant:q,AdultCount:N,ChildCount:P,InfantCount:O},re="","X"===te.type?re=te.errorMsg:"A"===te.type?N>F?B.AgeRang=1:re=an(ne):"C"===te.type?P>H?B.AgeRang=0:re=an(ne):"B"===te.type?O>q?B.AgeRang=2:re=an(ne):"U"===te.type&&(N>F?(B.AgeRang=1,B.MayChange=!0):P>H?(B.AgeRang=0,B.MayChange=!0):O>q?(B.AgeRang=2,B.MayChange=!0):re=A),!re){e.next=45;break}return r.showToast(re),sa({module:"\u4e1a\u52a1\u963b\u65ad",scene:"\u52fe\u9009\u51fa\u884c\u4eba-".concat(U),action:p.ActionType.show,value:re,key:"vac_30065"}),e.abrupt("return");case 45:B.type=te.type,B.age="number"===typeof te.age?te.age:-1,ae=B,ie=ae.prompts,se=void 0===ie?[]:ie,ce=[],le=0,se&&se.length&&oe.forEach(se,(function(e){var t=e||{},n=t.popupInfo,r=void 0===n?[]:n;ce=ce.concat(r)})),G=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(o){var c,u,d,f,m,h,v,g;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(c=o||{},u=c.status,d=void 0===u?0:u,1001!==d){e.next=3;break}return e.abrupt("return");case 3:if(1003!==d){e.next=6;break}return x===_e.CTRIPRN||x===_e.CTRIPH5?r.openEditPage&&r.openEditPage(l,B,(function(e){Et(e)})):r.goToPassengerEdit({shoppingId:l,passengerId:t,chosenInfo:null===(f=B)||void 0===f?void 0:f.chosenInfo,taroInfo:T}),e.abrupt("return");case 6:if(m=ce[le],!m||d&&1010!==d){e.next=11;break}return m=(0,i.Z)({},m),x===_e.CTRIPRN?(h=m,v=h.buttons,g=v.map((function(e){var t=(0,i.Z)({},e);return t.status=e.code,t.code+=5e4,t.type="action",t.callType="choosePassenger",t})),m.buttons=g,s({PassengerModalData:m}),le++,r.showPassengerModal&&r.showPassengerModal()):(le++,Tr({isShowAlertMask:!0,options:{typeName:"QuickSelectPassenger",passengerModalData:m}})),e.abrupt("return");case 11:return V[t]=B,1===B.AgeRang?z.push(t):0===B.AgeRang?Y.push(t):2===B.AgeRang&&W.push(t),M=[].concat(z,Y,W),n({selectIds:M,passengerObj:V}),sa({module:"\u51fa\u884c\u4eba",scene:"\u52fe\u9009",role:p.RoleType.usr,action:p.ActionType.click,value:U}),e.next=18,K();case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G(),r.hideMaskLoading(),e.next=65;break;case 55:sa({module:"\u51fa\u884c\u4eba",scene:"\u5220\u9664",role:p.RoleType.usr,action:p.ActionType.click,value:U}),M.splice(L,1),ue=m.DELETE_PASSENGER,ue({selectIds:M}),de={},k&&k.status&&k.passengerId===t&&(de.sharedRoomInfo=(0,i.Z)((0,i.Z)({},k),{},{name:"",passengerId:0})),M&&M.length||y&&(de.noPhoneError=""),fe=S||{},pe=fe.replaceInfo,pe&&pe.name&&pe.mobile&&!pe.isReplaceOver&&(de.contactDealInfo=(0,i.Z)((0,i.Z)({},S),{},{replaceInfo:{}})),oe.isEmpty(de)||s(de);case 65:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,r,o,i,s,c,l,u,f,p,m,h,v,g,y,_,b,I,T,k,S,C,w,N,E,P;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=d.getState(),n=t.shoppingId,r=t.orderBasicInfo,o=void 0===r?{}:r,i=t.selectIds,s=void 0===i?[]:i,c=t.passengerObj,l=void 0===c?{}:c,u=t.tagInfo,f=void 0===u?{}:u,p=t.cruise,m=void 0===p?[]:p,h=t.ResourcePassengerMapList,v=void 0===h?[]:h,g=t.ContactInfo,void 0===g?{}:g,y=o||{},_=y.totalPersonCount,b=void 0===_?0:_,I=f||{},T=I.isTrain,k=void 0!==T&&T,S={},s&&s.length===b&&(S.ShoppingId=n,C=ft(s,l),C&&C.length&&(S.Insurance={AgeInfos:C}),k&&(w=s.map((function(e){return l[e]})),N=[],s&&s.length&&oe.forEach(w,(function(e){e.Height===Pe.free?N.push(3):e.Height===Pe.adult?N.push(1):e.Height===Pe.child&&N.push(2)})),N.length===b&&(S.Train={TicketTypes:N})),m&&m.length&&(E=yt({cruise:m,ResourcePassengerMapList:v}),E&&(P=ot(),P&&(S.Cruise=P)))),!oe.isEmpty(S)){e.next=9;break}return e.abrupt("return",null);case 9:return e.abrupt("return",x.updateResource(S));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,r,o,s,c,l,u,f,h,v;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=m.UPDATE_ORDER_INFO,n=d.getState(),r=n.selectIds,o=n.orderBasicInfo,!r||null===o||void 0===o||!o.totalPersonCount||r.length!==o.totalPersonCount){e.next=17;break}return e.next=6,z(n);case 6:return s=e.sent,c=Wt(n,"usr"),l=$t(n),u=Xt(n),f=Jt(n),h=Qt(n),v=tn(n),t((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)({IsContrainSelf:!!s},c),l),u),f),h),v)),sa({module:"\u51fa\u884c\u4eba\u8d44\u6e90\u5173\u8054\u5173\u7cfb",scene:"\u7528\u6237\u64cd\u4f5c\u9009\u6ee1\u4eba\u6570\u540e",role:p.RoleType.usr,action:p.ActionType.click,value:"\u4fe1\u606f\u89c1jsonData",jsonData:(0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)({IsContrainSelf:!!s},c),l),u),f),h)}),e.next=17,Ue(4);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,r,o,i,s,c,l,u;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.resourceinfo,r=t.selectIds,o=t.orderBasicInfo,i=n&&n[We.INSURANCE]||{},s=i.specialTokens,c=void 0===s?{}:s,l=c||{},u=l.levleCancleTokens,!(u&&u.length&&r&&null!==o&&void 0!==o&&o.totalPersonCount&&r.length===o.totalPersonCount)){e.next=6;break}return e.abrupt("return",x.customerValidCheck());case 6:return e.abrupt("return",1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=d.getState(),n=t.userNotice,r=void 0===n?{}:n,a=t.Channels,o=void 0===a?{}:a,s=o||{},c=s.isBestone,l=void 0!==c&&c,u=r||{},f=u.isSelect,h=u.isSelectAuthorize,v=u.isReadAirClause,g=void 0===v?0:v,y=!1;if(1===e?y=!f:2===e&&(y=!h),y){var _=r.airlineClause,b=void 0===_?[]:_,I=r.highMessage,x=void 0===I?[]:I,T=r.isShowOldMan,k=r.isShowUnderAge,S=r.tipMessages,C=void 0===S?[]:S;if(l&&!g&&b&&b.length){var w=C.findIndex((function(e){return 0===e.key.indexOf("fly_")}));return void Wr({status:!0,options:{curTabIndex:w||0}})}var N=[];null!==b&&void 0!==b&&b.length&&N.push("1"),null!==x&&void 0!==x&&x.length&&N.push("2"),T&&N.push("3"),k&&N.push("4"),ta("grp_ordwrite_knwcontnt_click",{type:N})}var E=m.UPDATE_ORDER_INFO;1===e?E({userNotice:(0,i.Z)((0,i.Z)({},r),{},{isSelect:y,isReadAirClause:g})}):2===e&&E({userNotice:(0,i.Z)((0,i.Z)({},r),{},{isSelectAuthorize:y,isReadAirClause:g})}),sa({module:"\u5e95\u90e8\u8bdd\u672f",scene:"".concat(y?"\u52fe\u9009":"\u53d6\u6d88\u52fe\u9009","\u5e95\u90e8\u8bdd\u672f-").concat(1===e?"\u9884\u5b9a\u987b\u77e5":"\u4e2a\u4eba\u4fe1\u606f\u6388\u6743\u58f0\u660e"),role:p.RoleType.usr})},W=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=d.getState(),n=t.userNotice,r=void 0===n?{}:n,a=t.Channels,o=void 0===a?{}:a,s=o||{},c=s.isBestone,l=void 0!==c&&c,u=r||{},f=u.isReadAirClause,h=void 0===f?0:f;l&&!h&&e&&(h=1);var v=m.UPDATE_ORDER_INFO;v({userNotice:(0,i.Z)((0,i.Z)({},r),{},{isSelect:e,isSelectAuthorize:e,isReadAirClause:h})}),sa({module:"\u5e95\u90e8\u8bdd\u672f",scene:"\u5f39\u5c42\u70b9\u51fb\u6309\u94ae".concat(e?"\u540c\u610f":"\u4e0d\u540c\u610f\u534f\u8bae"),role:p.RoleType.usr})},$=function(e){var t=d.getState(),n=t.shoppingId,a=t.PassengerModalData,o=e.callType,i=void 0===o?"":o,s=e.status,c=void 0===s?0:s,l=e.tokens,u=void 0===l?[]:l,f=a.passenger;if("choosePassenger"===i)G(e);else switch(c){case 1003:r.openEditPage&&r.openEditPage(n,f,(function(e){Et(e)}));break;case De.Alert_Ins_Cancel_Repel:Ce(!0,u);break;default:break}},X=function(e){G(e)},J=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=m.UPDATA_CONTACT_INFO,o=d.getState(),s=o.contactTemplate,c=o.ContactInfo,l=o.contactShowItems,u=(0,i.Z)({},c);if("IdCardType"===t){+e!==u.IdCardType&&(u.ContactIDCardNumber=""),u[t]=+e;var f=l.ChineseName?"ChineseName":"EnglishName",p=it(e,s);return p[f]||(u.Name=""),Q(t,e),a({ContactInfo:u,contactShowItems:p}),ee(t),void(r.doWithContactInfo&&r.doWithContactInfo(u))}if("Sex"===t)return u["Gender"]=e,Q(t,e),a({ContactInfo:u}),void ee(t);u[t]=null!==e&&void 0!==e?e:"",n.noLog||Q(t,e),a({ContactInfo:u}),r.doWithContactInfo&&r.doWithContactInfo(u)},Q=function(e,t){var n=d.getState(),r=n.contactTemplate,a=n.ContactInfo,o=n.Platform,i=r.items,s=void 0===i?{}:i,c="";c="Sex"===e?a["Gender"]:a[e],o!==_e.CTRIPH5?t!==c&&sa({module:"\u8054\u7cfb\u4eba",scene:"\u4fee\u6539 ".concat(s[e]&&s[e].name||e),role:p.RoleType.usr,action:p.ActionType.change,value:t||"\u65e0",before:c?c+"":"\u65e0"}):sa({module:"\u8054\u7cfb\u4eba",scene:"\u4fee\u6539 ".concat(s[e]&&s[e].name||e),role:p.RoleType.usr,action:p.ActionType.change,value:t||"\u65e0"})},ee=function(e){var t=m.UPDATA_CONTACT_INFO,n=d.getState(),r=n.isSubmit,a=void 0!==r&&r,o=n.ContactInfo;if("ContactIDCardNumber"===e){var s=(0,i.Z)({},o);if(1===s.IdCardType)try{var c=Be(s.ContactIDCardNumber);s.Gender="M"===c.sex?0:1,t({ContactInfo:s})}catch(e){}}if(a)if(vr){var l=Ie();t({ErrorContactMsg:l})}else setTimeout((function(){var e=Ie();t({ErrorContactMsg:e})}),100)},te=function(e){var t=m.UPDATA_CONTACT_INFO,n=d.getState(),r=n.ContactInfo;t({ContactInfo:(0,i.Z)((0,i.Z)({},r),{},{Name:e.name,Moblie:e.mobile,CountryCode:e.countrycode})}),ne()},ne=function(){var e=m.UPDATE_ORDER_INFO,t=d.getState(),n=t.contactDealInfo,r=n||{},a=r.replaceInfo;if(!oe.isEmpty(a)){var o=(0,i.Z)((0,i.Z)({},a),{},{isReplaceOver:!0});e({contactDealInfo:(0,i.Z)((0,i.Z)({},n),{},{replaceInfo:o})})}},re=function(e,t){var n=m.UPDATE_ORDER_INFO,a=d.getState(),o=a.DestinationAddress,s=void 0===o?{}:o,c=(0,i.Z)({},s);"IdCardType"!==t&&(e!==c[t]&&(c.RelatedResourceId=""),c[t]=e,n({DestinationAddress:c}),r.doWithUSAddressInfo&&r.doWithUSAddressInfo(c))},ae=function(e){var t=m.UPDATE_ORDER_INFO,n=d.getState(),r=n.isSubmit,a=void 0!==r&&r,o=n.DestinationAddress,i=n.ErrorUSAAddress,s=n.contactTemplate;a&&setTimeout((function(){var n=gn({ErrorUSAAddress:i,DestinationAddress:o,contactTemplate:s},!1,e);t({ErrorUSAAddress:n})}),100)},le=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,r,o,i;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=It(t),r=n.filter((function(e){return mn.isCnChar(e)})).join(""),e.prev=2,e.next=5,x.fetchPinyin(r);case 5:if(o=e.sent,oe.isEmpty(o)){e.next=11;break}return i=n.map((function(e){return mn.isCnChar(e)?o[e]:e})),e.abrupt("return",i);case 11:return e.abrupt("return",null);case 12:e.next=18;break;case 14:return e.prev=14,e.t0=e["catch"](2),console.log(e.t0),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t){return e.apply(this,arguments)}}(),de=function(e){var t=m.UPDATE_ORDER_INFO,n=m.UPDATA_CONTACT_INFO,r=d.getState(),a=r.passengerObj,o=void 0===a?{}:a,s=r.contactTemplate,c=void 0===s?{}:s,l=r.ContactInfo,u=void 0===l?{}:l,f=r.contactShowItems,p=void 0===f?{}:f,h=r.isSubmit,v=c||{},g=v.idTypes,y=void 0===g?[]:g,_=u&&u.IdCardType||y&&y[0]||0,b=o[e];if(b){var I={},x=b.CNName,T=void 0===x?"":x,k=b.ENFirstName,S=b.ENLastName,C=b.Birthday,w=void 0===C?"":C,N=b.defaultPhoneInfo,E=void 0===N?{}:N,P=b.idInfos,j=void 0===P?[]:P,O=b.Gender,D=void 0===O?"":O;if(p.SurenameCN&&T){var R=It(T),A=R.slice(0,2).join("");bt.hasOwnProperty(A)?(I.SurenameCN=A,I.GivenNameCN=T.replace(A,"")):(I.SurenameCN=R[0],I.GivenNameCN=T.replace(R[0],""))}if(p.Surname&&!p.SurenameCN&&S&&(I.Surname=S,I.GivenName=k),p.ChineseName?I.Name=T:p.EnglishName?I.Name=S+"/"+k:p.UserName&&(I.Name=T||S+"/"+k),_)if(j&&j.length){var M=j.find((function(e){return+e.IdCardType===+_}));M?(I.ContactIDCardNumber=M.IdCardNo,I.IdCardType=+M.IdCardType):I.IdCardType=+_}else I.IdCardType=+_;var V=E||{},L=V.countryCode,B=V.mobilePhone;if(I.Moblie=B,I.CountryCode=L,p.Birthday&&(I.BirthDate=w),p.Sex&&("M"===D?I.Gender=0:"F"===D&&(I.Gender=1)),t({ContactInfo:(0,i.Z)({},I)}),h){var U=vn({data:d.getState(),isCheckAll:!0});n({ErrorContactMsg:U})}}},pe=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n){var r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=[],!t){e.next=5;break}return e.next=4,le(t);case 4:r[0]=e.sent;case 5:if(!n){e.next=9;break}return e.next=8,le(n);case 8:r[1]=e.sent;case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),he=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,r,o,s,c,l,u,f,p,h;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=d.getState(),o=r.ContactInfo,s=o||{},c=s.SurenameCN,l=s.GivenNameCN,c||l){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,pe(c,l);case 6:u=e.sent,f=m.UPDATE_ORDER_INFO,p=c+l,h=xt(p,c,l,u),f((0,i.Z)({selectedCnName:p},h)),J(null===(t=h.enName)||void 0===t?void 0:t.eNLastName,"Surname"),J(null===(n=h.enName)||void 0===n?void 0:n.eNFirstName,"GivenName");case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ve=function(e){var t=m.UPDATE_ORDER_INFO,n=d.getState(),r=n.ContactInfo,a=r||{},o=a.GivenNameCN;J(e,"Surname"),o||J("","GivenName"),t({popLastNameIndex:-1})},ge=function(e){var t=d.getState(),n=t.ContactInfo,r=n||{},a=r.SurenameCN;J(e,"GivenName"),a||J("","Surname");var o=m.UPDATE_ORDER_INFO;o({popFirstNameIndex:-1})},be=function(){var e=m.UPDATE_ORDER_INFO;e({popLastNameIndex:-1,popFirstNameIndex:-1})},Ie=function(){var e=d.getState(),t=e.isSubmit,n=void 0!==t&&t,r=e.Channels,a={};if(n){var o=(null===r||void 0===r?void 0:r.isBestoneMiniProgram)||!1;a=vn({data:e,isCheckAll:!0,onlyCheckEmpty:o});var i=en(e);i&&(i.SurenameCN&&!a.SurenameCN&&(a.SurenameCN=i.SurenameCN),i.Surname&&!a.Surname&&(a.Surname=i.Surname))}return a},xe=function(e){var t=d.getState(),n=t.memberinfo,r=m.UPDATE_ORDER_INFO;r({memberinfo:(0,i.Z)((0,i.Z)({},n),{},{isCheckPrivacyTerms:e,acceptTime:(new ye).format("YYYY-MM-DDTHH:mm:ss")})})},Te=function(e){var t=d.getState(),n=t.resourceinfo,r=void 0===n?{}:n,a=r[We.INSURANCE]||{},o=a||{},i=o.additionAndMajorTokenMap,s=void 0===i?{}:i,c=o.majorAndAdditionTokenMap,l=void 0===c?{}:c;if(l[e]){var u=oe.concat([e],l[e]);Se(!1,u)}else if(s[e]){var f=oe.concat(s[e],[e]);Se(!0,f)}},ke=function(e,t){var n=d.getState(),a=n.resourceinfo,o=void 0===a?{}:a,i=n.shoppinginfo,s=void 0===i?{}:i,c=n.selectIds,l=void 0===c?[]:c,u=n.orderBasicInfo,f=void 0===u?{}:u,p=f||{},m=p.totalPersonCount,h=void 0===m?0:m,v=p.numErrorTip,g=void 0===v?"":v;if(l.length&&l.length!==h)return r.showToast(g),!1;var y=o[We.INSURANCE]||{},_=y||{},b=_.additionAndMajorTokenMap,I=void 0===b?{}:b,x=_.majorAndAdditionTokenMap,T=void 0===x?{}:x,k=s[We.INSURANCE]||{};if(T[t]&&!e){var S=T[t].filter((function(e){return k[e]&&k[e].count}))||[];S.length?Tr({isShowAlertMask:!0,options:{typeName:"InsuranceMajor",message:"\u60a8\u53d6\u6d88\u4e3b\u9669\u540e\uff0c\u9644\u52a0\u9669\u4e5f\u5c06\u88ab\u53d6\u6d88",token:t}}):Se(e,[t])}else if(I[t]&&e){var C=k[I[t][0]]&&k[I[t][0]].count;C?Se(e,[t]):Tr({isShowAlertMask:!0,options:{typeName:"InsuranceAddition",message:"\u52fe\u9009\u4e3b\u9669\u540e\u624d\u80fd\u8fdb\u884c\u9644\u52a0\u9669\u52fe\u9009",token:t}})}else Se(e,[t])},Se=function(e,t){var n=d.getState(),r=n.resourceinfo,a=void 0===r?{}:r,o=n.shoppinginfo,i=void 0===o?{}:o,s=a[We.INSURANCE]||{},c=i[We.INSURANCE]||{},l=s.specialTokens,u=void 0===l?{}:l,f=u||{},p=f.commonCancleTokens,m=void 0===p?[]:p,h=f.levleCancleTokens,v=void 0===h?[]:h,g=f.svipCancellation,y=void 0===g?[]:g;if(e&&!oe.isEmpty(m)&&(!oe.isEmpty(v)||!oe.isEmpty(y))){var _=t[0],b=!1,I=!1,x=!1;if(b=!!m.filter((function(e){return c&&c[e]&&c[e].count>0})).length,I=v&&!!v.filter((function(e){return c&&c[e]&&c[e].count>0})).length,x=y&&!!y.filter((function(e){return c&&c[e]&&c[e].count>0})).length,oe.includes(m,_)&&(I||x))return void Ln({message:["\u53d6\u6d88\u9669\u4e0d\u53ef\u4e0e\u65e0\u5fe7\u9000\u8ba2\u7279\u6743\u540c\u65f6\u4f7f\u7528\uff0c\u662f\u5426\u66ff\u6362\uff1f"],typeName:"Membership_privilege",status:De.Alert_Ins_Cancel_Repel,tokens:t});if((v&&oe.includes(v,_)||y&&oe.includes(y,_))&&b)return void Ln({message:["\u65e0\u5fe7\u9000\u8ba2\u7279\u6743\u4e0d\u53ef\u4e0e\u53d6\u6d88\u9669\u540c\u65f6\u4f7f\u7528\uff0c\u662f\u5426\u66ff\u6362\uff1f"],typeName:"Membership_privilege",status:De.Alert_Ins_Cancel_Repel,tokens:t})}Ce(e,t)},Ce=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,o){var s,c,l,u,f,h,v,g,y,_,I,x,T,k,S,C,w,N,E,P,j,O,D,A,M,V,L,B,U,Z,F,G,H,q,K,z,Y,W,$,X,J,Q,ee,te,ne,re,ae,ie,se,ce,le,ue,de,fe,pe,me;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r.showMaskLoading({text:"\u8bf7\u6c42\u4e2d...",cancelable:!1},(function(){})),s=d.getState(),c=s.shoppinginfo,l=void 0===c?{}:c,u=s.resourceinfo,f=void 0===u?{}:u,h=s.showresourceinfo,v=void 0===h?{}:h,g=s.ErrorCanBookingToken,y=void 0===g?[]:g,_=s.ResourcePassengerMapList,I=void 0===_?[]:_,x=s.selectIds,T=void 0===x?[]:x,k=s.passengerObj,S=void 0===k?{}:k,C=s.SvipStorage,w=void 0===C?{}:C,N=s.lowPriceInsInfo,E=void 0===N?{}:N,P=oe.cloneDeep(I),j=(0,i.Z)({},E),O=w&&(0,i.Z)({},w)||{},D=f[We.INSURANCE],!oe.isEmpty(D)){e.next=8;break}return e.abrupt("return");case 8:if(A=D.insuranceDic,M=void 0===A?{}:A,V=D.specialTokens,L=void 0===V?{}:V,B=D.allInsuranceCategoryTokenMap,U=D.additionAndMajorTokenMap,Z=void 0===U?{}:U,F=D.majorAndAdditionTokenMap,G=void 0===F?{}:F,H=L.svipCancellation,q=void 0===H?[]:H,K=L.levleCancleTokens,z=void 0===K?[]:K,Y=L.commonCancleTokens,W=void 0===Y?[]:Y,r.traceDevLog("o_vac_order_select_insurance",{selected:t,tokens:o}),$=o[0],!t){e.next=25;break}if(X=M[$],J=X.baseInfo,Q=void 0===J?{}:J,ee=Q.tipMessage,te=Q.ageRule,!te){e.next=25;break}if(ne=ft(T,S),!ne){e.next=25;break}if(re=ne.filter((function(e){return e<te[0]||e>te[1]})),console.log("\ud83e\udd21passengerAges",ne,te,$),!re||!re.length){e.next=25;break}return Tr({isShowAlertMask:!0,options:{typeName:"InsuranceAgeRule",message:ee}}),r.hideMaskLoading(),e.abrupt("return");case 25:return ae=oe.cloneDeep(v),ie=oe.cloneDeep(l),se=ie[We.INSURANCE]||{},ce=0,le=[],ue=[],t?(W&&oe.includes(W,$)&&(de=[].concat((0,R.Z)(q),(0,R.Z)(z)),oe.forEach(de,(function(e){se[e]&&(ce=1,delete se[e],le.push(e))}))),z&&oe.includes(z,$)&&(W&&oe.forEach(W,(function(e){se[e]&&(ce=2,delete se[e],le.push(e))})),q&&oe.forEach(q,(function(e){se[e]&&(delete se[e],le.push(e))}))),q&&oe.includes(q,$)&&(W&&oe.forEach(W,(function(e){se[e]&&(ce=2,delete se[e],le.push(e))})),z&&oe.forEach(z,(function(e){se[e]&&(delete se[e],le.push(e))}))),oe.forEach(o,(function(e){var t=M[e],n=t.resourceShoppingInfo,r=void 0===n?{}:n,a=t.category,i=Object.keys(se),s=B[a]||[],c=oe.intersection(s,i);if(oe.forEach(c,(function(t){var n,r;if(null!==G&&void 0!==G&&null!==(n=G[t])&&void 0!==n&&n.length&&t===(null===Z||void 0===Z||null===(r=Z[e])||void 0===r?void 0:r[0]))console.log("\ud83e\udd76\ud83e\udd76\ud83e\udd76\ud83e\udd76\ud83e\udd76\ud83e\udd76\ud83e\udd76\ud83e\udd76\ud83e\udd76\ud83e\udd76\ud83e\udd76\ud83e\udd76",o);else{le.push(t),delete se[t];var a=oe.findIndex(P,(function(e){return e.ResourceToken===t}));a>-1&&P.splice(a,1)}})),se[e]={token:e,category:a,count:r.stepCount,useDate:r.useDate,useEndDate:r.useEndDate},ue.push({Token:e,Count:r.stepCount,UseDateRange:{UseDate:r.useDate,EndUseDate:r.useEndDate},ExtendInfos:[{TokenInfo:r.tokenInfo}]}),Z&&Z[e]&&Z[e][0]){var l=Z[e][0];if(!oe.includes(o,l)){var u=M[l],d=u.resourceShoppingInfo,f=void 0===d?{}:d;ue.push({Token:l,Count:f.stepCount,UseDateRange:{UseDate:f.useDate,EndUseDate:f.useEndDate}})}}}))):oe.forEach(o,(function(e){delete se[e],le.push(e)})),ie[We.INSURANCE]=se,e.prev=32,me="\u4fdd\u9669",(z&&oe.includes(z,$)||q&&oe.includes(q,$))&&(me="\u7279\u6743\u4f18\u60e0"),b.updateResource={module:me,scene:"".concat(t?"\u6dfb\u52a0":"\u5220\u9664","\u8d44\u6e90"),role:p.RoleType.usr,action:p.ActionType.click,contents:[{key:"id",value:$},{key:"\u4fdd\u9669\u540d\u79f0",value:M&&(null===(fe=M[$])||void 0===fe||null===(fe=fe.baseInfo)||void 0===fe?void 0:fe.name)},{key:"\u4fdd\u9669\u4ef7\u683c",value:null===(pe=M[$])||void 0===pe||null===(pe=pe.resourceShoppingInfo)||void 0===pe?void 0:pe.averagePriceDes}]},b.updatePrice={module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u66f4\u65b0\u4fdd\u9669\u5bfc\u81f4\u4ef7\u683c\u53d8\u5316 ",action:p.ActionType.change},e.next=39,Ue(1,{deletedTokens:le,selectedResources:ue,callback:function(){(1===ce||2===ce)&&r.showToast("\u66ff\u6362\u6210\u529f");var e=(0,R.Z)(y),a=oe.indexOf(e,$);if(a>-1&&e.splice(a,1),j&&!1===j.isShow&&j.defaultToken){var s=j.defaultToken.filter((function(e){return se[e]&&se[e].count}))||[];s.length||(j.isShow=!0,ae=gt(D,ae,j.lowPriceToken))}o&&T&&T.length&&oe.forEach(o,(function(e){if(t){var n;M&&M[e]&&14===(null===(n=M[e])||void 0===n?void 0:n.category)?P.push({ResourceToken:e,PassengerTokenList:T.slice(0,1)}):P.push({ResourceToken:e,PassengerTokenList:(0,R.Z)(T)}),le&&le.length&&oe.forEach(le,(function(e){var t=oe.findIndex(P,(function(t){return t.ResourceToken===e}));t>-1&&P.splice(t,1)}))}else{var r=oe.findIndex(P,(function(t){return t.ResourceToken===e}));r>-1&&P.splice(r,1)}})),sa({module:"\u51fa\u884c\u4eba\u8d44\u6e90\u5173\u8054\u5173\u7cfb",scene:"\u64cd\u4f5c\u4fdd\u9669\u540e\u7684\u5173\u8054\u51fa\u884c\u4eba\u4fe1\u606f",role:p.RoleType.usr,action:p.ActionType.click,value:"\u4fe1\u606f\u89c1jsonData",jsonData:{ResourcePassengerMapList:P}});var c=m.UPDATE_ORDER_INFO;c({shoppinginfo:ie,showresourceinfo:ae,lowPriceInsInfo:(0,i.Z)({},j),SvipStorage:O,ErrorCanBookingToken:e,ResourcePassengerMapList:P,footPriceStatus:0}),vr&&(n.g.__insuranceMapList=P)}});case 39:Ve(!0),r.hideMaskLoading(),e.next=46;break;case 43:e.prev=43,e.t0=e["catch"](32),r.hideMaskLoading();case 46:case"end":return e.stop()}}),e,null,[[32,43]])})));return function(t,n){return e.apply(this,arguments)}}(),Ae=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,o,s,c,l,u,f,p,m,h,v,g,y,_,I,x;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t||{},o=n.deletedTokens,s=void 0===o?[]:o,c=n.selectedResources,l=void 0===c?[]:c,u=d.getState(),f=u.shoppingId,p=null,e.prev=3,e.next=6,r.post("UpdateShoppingDetail",{Tags:[{Key:"GroupOrSdpPartialUpdate",Value:"true"}],ResourceType:4,ShoppingId:f,SelectedResources:l,DeletedTokens:s});case 6:if(p=e.sent,!p||!p.ResponseStatus||"Success"!==p.ResponseStatus.Ack){e.next=20;break}if(p.ResourceStatuses&&p.ResourceStatuses.length){e.next=13;break}return null!==b&&void 0!==b&&b.updateResource&&(sa((0,i.Z)({rootMessageId:null===(m=p)||void 0===m||null===(m=m.ResponseStatus)||void 0===m||null===(m=m.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===m?void 0:m.Value},b.updateResource)),b.updateResource=null),e.abrupt("return",!0);case 13:return r.showToast("\u4f60\u9009\u62e9\u7684\u8d44\u6e90\u4e0d\u53ef\u8ba2\u54e6\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u54c8\uff01"),h=p.ResponseStatus||{},v=h.Errors,g=void 0===v?[]:v,y=g&&g[0]||{},_=y.ErrorCode,I=void 0===_?"":_,null!==b&&void 0!==b&&b.updateResource&&(sa((0,i.Z)({rootMessageId:null===(x=p)||void 0===x||null===(x=x.ResponseStatus)||void 0===x||null===(x=x.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===x?void 0:x.Value,key:I},b.updateResource)),b.updateResource=null),e.abrupt("return",0);case 18:e.next=22;break;case 20:return r.showToast("\u4f60\u9009\u62e9\u7684\u8d44\u6e90\u4e0d\u53ef\u8ba2\u54e6\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u54c8\uff01"),e.abrupt("return",!1);case 22:e.next=28;break;case 24:return e.prev=24,e.t0=e["catch"](3),ca("updateShopping",e.t0),e.abrupt("return",!1);case 28:case"end":return e.stop()}}),e,null,[[3,24]])})));return function(t){return e.apply(this,arguments)}}(),Me=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,r,o,s,c,l,u,f,p,h,v,g,y,_,I,x,T,k,S,C,w;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=d.getState(),r=n.shoppinginfo,o=void 0===r?{}:r,s=n.resourceinfo,c=void 0===s?{}:s,l=oe.cloneDeep(c),u=l[We.INSURANCE],f=o[We.INSURANCE],!oe.isEmpty(u)){e.next=6;break}return e.abrupt("return");case 6:if(p=u||{},h=p.specialTokens,v=void 0===h?{}:h,g=p.insuranceDic,y=void 0===g?{}:g,_=v.floatCancellation||[],!oe.isEmpty(_)){e.next=10;break}return e.abrupt("return");case 10:if(I=[],x=!1,_.map((function(e){var n=y&&y[e],r=f&&f[e]||{},a=!oe.isEmpty(t)&&t.find((function(t){var n=t||{},r=n.MainInsurance,a=r||{},o=a.Basic,i=o||{},s=i.Token;return s&&s===e}));if(a){var o=a||{},s=o.MainInsurance,c=s||{},l=c.Shopping,u=c.TokenInfo,d=l||{},p=d.UnitPriceInfos,m=void 0===p?[]:p,h=m.filter((function(e){return 26===e.Age}))[0]||{},v=m.filter((function(e){return 4===e.Age}))[0]||{},g=n||{},_=g.resourceShoppingInfo,b=void 0===_?{}:_;(b&&h&&b.price!==(null===h||void 0===h?void 0:h.Price)||v&&b.childPrice!==(null===v||void 0===v?void 0:v.Price))&&(x=!0),b.price=(null===h||void 0===h?void 0:h.Price)||0,b.tradePrice=(null===h||void 0===h?void 0:h.TradePrice)||0,b.childPrice=(null===v||void 0===v?void 0:v.Price)||0,b.childTradePrice=(null===v||void 0===v?void 0:v.TradePrice)||0,b.tokenInfo=u,y[e]=(0,i.Z)({},n)}oe.isEmpty(r)||I.push(e)})),T=m.UPDATE_ORDER_INFO,oe.isEmpty(I)||!x){e.next=21;break}return S=[],C=[],oe.forEach(I,(function(e){var t=y[e],n=t.resourceShoppingInfo,r=void 0===n?{}:n;f[e]={token:e,count:r.stepCount,useDate:r.useDate,useEndDate:r.useEndDate},S.push({Token:e,Count:r.stepCount,UseDateRange:{UseDate:r.useDate,EndUseDate:r.useEndDate},ExtendInfos:[{TokenInfo:r.tokenInfo}]})})),b.updateResource={module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u66f4\u65b0\u8d2d\u7269\u8f66-\u91cd\u67e5\u540e\u66f4\u65b0\u4fdd\u9669 ".concat(y&&(null===(k=y[I[0]])||void 0===k||null===(k=k.baseInfo)||void 0===k?void 0:k.name)||I[0])},e.next=19,Ae({deletedTokens:C,selectedResources:S});case 19:w=e.sent,w&&Tr({isShowAlertMask:!0,options:{typeName:"floatInsurancePriceChange",title:"\u7531\u4e8e\u8ba2\u5355\u91d1\u989d\u53d8\u5316\uff0c\u60a8\u9009\u62e9\u7684\u53d6\u6d88\u9669\u4ef7\u683c\u4e5f\u5df2\u53d1\u751f\u53d8\u5316"}});case 21:x&&T({resourceinfo:l});case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ve=function(e){var t=d.getState(),n=t.shoppinginfo,r=void 0===n?{}:n,a=t.resourceinfo,o=void 0===a?{}:a,i=t.lowPriceInsInfo,s=void 0===i?{}:i,c=t.showresourceinfo,l=void 0===c?{}:c,u=o[We.INSURANCE],f=r[We.INSURANCE]||{},p=nt(u,f,s),h=m.UPDATE_ORDER_INFO;if(e){var v=oe.cloneDeep(l);v.insuranceList=p&&p.insuranceList,h({showresourceinfo:v})}else h({showresourceinfo:p})},Le=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var r,o,s,c,l,u,f,h,v,g,y,_;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=m.UPDATE_ORDER_INFO,o=d.getState(),s=o.resourceinfo,c=o.shoppinginfo,l=o.sharedRoomInfo,u=l.currentCount,f=l.countRange,h=f.indexOf(u),t?h++:h--,v=s&&s["SINGLE_ROOM_CHARGE"],g=f[h],y=v.find((function(e){return e.Count===g})),_=oe.cloneDeep(c),!y){e.next=14;break}return _[We.SINGLE_ROOM_CHARGE]=y,b.updatePrice={module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u66f4\u65b0\u623f\u95f4\u6570\u5bfc\u81f4\u4ef7\u683c\u53d8\u5316 ",action:p.ActionType.change},e.next=14,Ue(2,{selectedResources:[{Token:y.Token,Count:y.Count}],callback:function(e){if(e){var t=(0,i.Z)({},l);t.currentCount=g,t.status=g%1!==0,vr&&(n.g.__sharedRoomInfo=t),r({shoppinginfo:_,roomcount:g,sharedRoomInfo:(0,i.Z)({},t)})}}});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ue=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n){var o,s,c,l,u,f,p,h,v,g,y,_,b,I,T,k,S,C,w,N,E,P,j,O,D,R,A,M,V,L,B,U,Z,F,G,H,q,K,z,Y,W,$,X,J,Q,ee,te,ne,re,ae,ie,se,ce,le,ue,de,fe,pe,me,he,ve,ge,ye,be,Ie,xe,Te,ke,Se,Ce,we,Ne,Ee,Pe,je,Oe,De,Re,Ae,Ve,Le,Be,Ue;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r.showMaskLoading(),o=d.getState()||{},s=o.Platform,c=o.shoppingId,l=void 0===c?"":c,u=o.shardParams,o.selectIds,o.passengerObj,f={ShoppingId:l,PageId:123},p={},e.prev=5,1!==t){e.next=39;break}return h=n||{},v=h.deletedTokens,g=void 0===v?[]:v,y=h.selectedResources,_=void 0===y?[]:y,b=h.callback,(_&&_.length||g&&g.length)&&(f.UpdateShoppingDetail={Order:1,UpdateShoppingDetailRequest:(0,i.Z)({Tags:[{Key:"GroupOrSdpPartialUpdate",Value:"true"}],ResourceType:4,ShoppingId:l,SelectedResources:_,DeletedTokens:g},u)}),I=Ke(!!(_&&_.length>0)),I&&(f.UpdateResource={Order:2,UpdateResourceRequest:(0,i.Z)({ShoppingId:l,Insurance:{AgeInfos:I}},u)}),T=ze(),T.length&&(T.push({Key:"passengerCoreVersion",Value:"2"}),f.GetDisplayItem={Order:3,PageDisplayRequest:(0,i.Z)({BizType:"PKG",ProductToken:l,ParameterList:T},u)}),e.next=15,x.bookingXResource(t,f);case 15:if(k=e.sent,S=k||{},C=S.ResponseStatus,w=S.UpdateShoppingDetailRes,N=S.UpdateResourceRes,E=S.GetDisplayItemRes,Ge("\u9009\u62e9\u4fdd\u9669\u4e00\u7cfb\u5217\u64cd\u4f5c",C),!f.UpdateShoppingDetail){e.next=25;break}if(He(w),!("Success"!==(null===w||void 0===w||null===(P=w.ResponseStatus)||void 0===P?void 0:P.Ack)||null!==w&&void 0!==w&&null!==(j=w.ResourceStatuses)&&void 0!==j&&j.length)){e.next=24;break}return r.showToast("\u4f60\u9009\u62e9\u7684\u8d44\u6e90\u4e0d\u53ef\u8ba2\u54e6\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u54c8\uff01"),Dn(1),e.abrupt("return");case 24:b&&b();case 25:if(!f.UpdateResource){e.next=32;break}if(O=N||{},D=O.Insurance,!D){e.next=32;break}if(R=Ye(D),R){e.next=32;break}return qe({type:t}),e.abrupt("return");case 32:if(!f.GetDisplayItem){e.next=37;break}if(A=Qe({template:E}),A){e.next=37;break}return qe({type:t}),e.abrupt("return");case 37:e.next=121;break;case 39:if(2!==t){e.next=60;break}return L=n||{},B=L.deletedTokens,U=void 0===B?[]:B,Z=L.selectedResources,F=void 0===Z?[]:Z,G=L.callback,(F&&F.length||U&&U.length)&&(f.UpdateShoppingDetail={Order:1,UpdateShoppingDetailRequest:(0,i.Z)({Tags:[{Key:"GroupOrSdpPartialUpdate",Value:"true"}],ResourceType:4,ShoppingId:l,SelectedResources:F,DeletedTokens:U},u)}),f.NeedSearchInsurance=!0,e.next=45,x.bookingXResource(t,f);case 45:if(H=e.sent,q=H||{},K=q.ResponseStatus,z=q.UpdateShoppingDetailRes,Y=q.Insurances,Ge("\u9009\u62e9\u62fc\u623f\u4e00\u7cfb\u5217\u64cd\u4f5c",K),He(z),!("Success"!==(null===z||void 0===z||null===(M=z.ResponseStatus)||void 0===M?void 0:M.Ack)||null!==z&&void 0!==z&&null!==(V=z.ResourceStatuses)&&void 0!==V&&V.length)){e.next=54;break}return r.showToast("\u8d44\u6e90\u4e0d\u53ef\u8ba2\u54e6\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u54c8\uff01"),Dn(1),G&&G(!1),e.abrupt("return");case 54:if(G&&G(!0),!Y||!Y.length){e.next=58;break}return e.next=58,Me(Y);case 58:e.next=121;break;case 60:if(3!==t){e.next=84;break}if($=$e(),$.length){e.next=65;break}return Dn(1),e.abrupt("return");case 65:return X={TicketTypes:$},J=o.trainSeatNum,Q=o.selectedTrainSeats,!oe.isEmpty(Q)&&J&&(ee=Q.find((function(e){return e.SeatNumbers&&e.SeatNumbers.length})),te=ee&&ee.SeatNumbers.length||0,te&&te!==J&&(X.SelectedTrainSeats=Q.map((function(e){return{SegmentNo:e.SegmentNo,TrainNo:e.TrainNo,SeatNumbers:[]}})))),f.UpdateResource={Order:1,UpdateResourceRequest:(0,i.Z)({ShoppingId:l,Train:X},u)},f.NeedSearchInsurance=!0,e.next=72,x.bookingXResource(t,f);case 72:if(ne=e.sent,re=ne||{},ae=re.ResponseStatus,ie=re.UpdateResourceRes,se=re.Insurances,Ge("\u9009\u62e9\u7968\u79cd\u4e00\u7cfb\u5217\u64cd\u4f5c",ae),"Success"===(null===ae||void 0===ae?void 0:ae.Ack)&&1===(null===ie||void 0===ie||null===(W=ie.Train)||void 0===W?void 0:W.Status)){e.next=78;break}return qe({type:t}),e.abrupt("return");case 78:if(X.SelectedTrainSeats&&(ce=m.UPDATE_ORDER_INFO,ce({selectedTrainSeats:X.SelectedTrainSeats||[]})),!se||!se.length){e.next=82;break}return e.next=82,Me(se);case 82:e.next=121;break;case 84:if(4!==t){e.next=111;break}if(de=Ke(!1),de&&de.length&&(p.Insurance={AgeInfos:de}),fe=$e(),fe&&fe.length&&(p.Train={TicketTypes:fe}),pe=ot(),pe&&(p.Cruise=pe),!oe.isEmpty(p)){e.next=94;break}return Dn(1),e.abrupt("return");case 94:return f.UpdateResource={Order:1,UpdateResourceRequest:(0,i.Z)((0,i.Z)({ShoppingId:l},p),u)},(fe&&fe.length||pe)&&(f.NeedSearchInsurance=!0),e.next=98,x.bookingXResource(t,f);case 98:if(me=e.sent,he=me||{},ve=he.ResponseStatus,ge=he.UpdateResourceRes,ye=he.Insurances,Ge("\u9009\u62e9\u7968\u79cd\u4e00\u7cfb\u5217\u64cd\u4f5c",ve),!("Success"!==(null===ve||void 0===ve?void 0:ve.Ack)||p.Train&&1!==(null===ge||void 0===ge||null===(le=ge.Train)||void 0===le?void 0:le.Status)||p.Insurance&&1!==(null===ge||void 0===ge||null===(ue=ge.Insurance)||void 0===ue?void 0:ue.Status))){e.next=104;break}return qe({type:t}),e.abrupt("return");case 104:if(be=ge.Insurance||{},Ie=be.Status,xe=be.ChangedPrice,Ye({Status:Ie,ChangedPrice:xe}),!ye||!ye.length){e.next=109;break}return e.next=109,Me(ye);case 109:e.next=121;break;case 111:if(5!==t){e.next=121;break}return e.next=114,rt();case 114:if(Te=e.sent,ke=Te||{},Se=ke.status,Ce=void 0!==Se&&Se,we=ke.ageList,void 0===we?null:we,Ne=ke.retPrice,Ee=void 0===Ne?0:Ne,Pe=Ye({Status:Ce?1:0,ChangedPrice:Ee,hideTip:5===t}),Pe){e.next=120;break}return qe({type:t}),e.abrupt("return");case 120:(null===n||void 0===n?void 0:n.callback)&&n.callback();case 121:if(vr&&(null,je=m.UPDATE_ORDER_INFO,1===t?(Oe=f.UpdateShoppingDetail.UpdateShoppingDetailRequest||{},De=Oe.SelectedResources,Re=Oe.DeletedTokens,console.log("UnitTest_Price-----1",De),je({UnitTest_Price:{SelectedResources:De,DeletedTokens:Re}})):2===t?(Ae=f.UpdateShoppingDetail.UpdateShoppingDetailRequest||{},Ve=Ae.SelectedResources,Le=Ae.DeletedTokens,console.log("UnitTest_Price-----2",Ve),je({UnitTest_Price:{SelectedResources:Ve,DeletedTokens:Le}})):4===t?(console.log("UnitTest_Price-----4",p),je({UnitTest_Price:(0,i.Z)({},p)})):3===t&&(Be=f.UpdateResource.UpdateResourceRequest||{},Ue=Be.Train,je({UnitTest_Price:{Train:Ue}}))),!oe.includes([1,2,3,4],t)){e.next=126;break}Xe(),e.next=129;break;case 126:if(5!==t){e.next=129;break}return e.next=129,Je();case 129:1===t&&s!==_e.CTRIPWX&&Ze(),5===t?r.hideMaskLoading():Dn(1),e.next=138;break;case 133:e.prev=133,e.t0=e["catch"](5),Dn(1),1===t||2===t?r.showToast("\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u91cd\u8bd5"):qe({type:t}),e.t0.isNetError||ca("bookingXResource-".concat(t),e.t0);case 138:case"end":return e.stop()}}),e,null,[[5,133]])})));return function(t,n){return e.apply(this,arguments)}}(),Ze=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,i,s,c;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=d.getState(),n=t.shoppingId,o=void 0===n?"":n,e.next=3,r.post("GetBookForm",{ShoppingId:o,RequestTypeList:["OrderNoticeInfo"]});case 3:i=e.sent,i.ResponseStatus&&"Success"===i.ResponseStatus.Ack&&(s=i.Data.OrderNoticeInfo,c=m.UPDATE_ORDER_INFO,c({OrderNoticeInfo:s}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ge=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,r=n||{},a=r.Errors,o=void 0===a?[]:a,i=o&&o[0]||{},s=i.ErrorCode,c=void 0===s?"":s;sa({module:"\u63a5\u53e3\u8bf7\u6c42",scene:"".concat(t," 20168/BookingXResource"),rootMessageId:null===n||void 0===n||null===(e=n.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===e?void 0:e.Value,key:c})},He=function(e){var t,n=e.ResponseStatus||{},r=n.Errors,a=void 0===r?[]:r,o=a&&a[0]||{},s=o.ErrorCode,c=void 0===s?"":s;null!==b&&void 0!==b&&b.updateResource&&(sa((0,i.Z)({rootMessageId:null===e||void 0===e||null===(t=e.ResponseStatus)||void 0===t||null===(t=t.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===t?void 0:t.Value,key:c},b.updateResource)),b.updateResource=null)},qe=function(e){Qr({typeName:"bookingXResource",operationData:e}),Dn(1)},Ke=function(e){var t=!1,n=d.getState(),r=n.resourceinfo,a=void 0===r?{}:r,o=n.shoppinginfo,i=void 0===o?{}:o,s=n.orderBasicInfo,c=void 0===s?{}:s,l=n.selectIds,u=void 0===l?[]:l,f=n.passengerObj,p=void 0===f?{}:f,m=c||{},h=m.totalPersonCount,v=void 0===h?0:h;if(!u||u.length!==v)return null;if(e&&(t=!0),!t){var g=a[We.INSURANCE]||{},y=i[We.INSURANCE]||{};g.hasAgeRules&&!oe.isEmpty(y)&&(t=!0)}return t?ft(u,p):null},ze=function(){var e=d.getState(),t=e.CommonPassengers,n=void 0===t?[]:t;if(n&&n.length){var r=new Set,a=[];return n.map((function(e){var t=e.commonPassenger&&e.commonPassenger.nationality||"";t&&!r.has(t)&&(r.add(t),a.push({Key:"nationality",Value:t}))})),a}return[]},Ye=function(e){return!(!e||1!==e.Status)&&(e.ChangedPrice&&(b.updatePrice={module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u4fdd\u9669\u5e74\u9f84\u6bb5\u66f4\u65b0\u5bfc\u81f4\u4ef7\u683c\u53d8\u5316 ",action:p.ActionType.change},e.hideTip||Tr({isShowAlertMask:!0,options:{typeName:"InsurancePriceChange",title:"\u60a8\u9009\u62e9\u7684\u4fdd\u9669\u4ef7\u683c\u5df2\u968f\u88ab\u4fdd\u9669\u4eba\u7684\u771f\u5b9e\u5e74\u9f84\u53d1\u751f\u53d8\u5316"}})),!0)},$e=function(){var e=d.getState(),t=e.orderBasicInfo,n=void 0===t?{}:t,r=e.selectIds,a=void 0===r?[]:r,o=e.passengerObj,i=void 0===o?{}:o,s=n||{},c=s.totalPersonCount,l=void 0===c?0:c,u=a.map((function(e){return i[e]})),f=[];return a&&a.length&&oe.forEach(u,(function(e){e.Height===Pe.free?f.push(3):e.Height===Pe.adult?f.push(1):e.Height===Pe.child&&f.push(2)})),f.length===l?f:[]},Xe=function(){var e=m.UPDATE_ORDER_INFO,t=d.getState(),n=t.forceReloadTimestamp,r=void 0===n?0:n;r?r+=1e3:r=(new Date).getTime(),e({forceReloadTimestamp:r})},Je=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,s,c,l,u,f,p,h,v,g,y,_,I,T,k,S,C,w,N,E,P,O,D,R,A,M,V,L,B,U,Z,F,G,H;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=d.getState(),n=t.tagInfo,o=void 0===n?{}:n,s=t.isCloseInsAgent,c=void 0!==s&&s,l=t.priceDetail,u=t.footPriceStatus,f=t.productBasicInfo,p=t.orderBasicInfo,h=t.isQuickBooking,v=m.UPDATE_ORDER_INFO,u&&v({footPriceStatus:0}),e.next=6,x.getPriceDetail();case 6:if(g=e.sent,g){e.next=10;break}return Qr({typeName:"PriceDetailError",message:"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u91cd\u8bd5\uff01"}),e.abrupt("return",!1);case 10:if(y=g&&g.data||{},_={},_=(null===y||void 0===y?void 0:y.shoppingDetail)||{},I=_,T=I.priceDetail,h&&oe.isEmpty(l)&&!oe.isEmpty(T)&&(C=f.ProductId,w=f.recommendDisplayPrice,N=p.DepartureDate,E=p.AdultCount,P=p.ChildCount,O=p.InfantCount,r.tracelog("grp_shoppingdata_price_load",{productId:C,orderdate:N,displayprice:w,adultnum:E,childnum:P,infantnum:O,payamount:null===T||void 0===T||null===(k=T.totalPrice)||void 0===k?void 0:k.totalPrice,discnt:null===T||void 0===T||null===(S=T.totalPrice)||void 0===S?void 0:S.save})),null!==b&&void 0!==b&&b.updatePrice&&(sa((0,i.Z)({rootMessageId:null===g||void 0===g||null===(D=g.extensions)||void 0===D||null===(D=D.SoaResponseStatus)||void 0===D||null===(D=D.ResponseStatus)||void 0===D||null===(D=D.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===D?void 0:D.Value,value:null===T||void 0===T||null===(R=T.totalPrice)||void 0===R?void 0:R.totalPrice,before:null===l||void 0===l||null===(A=l.totalPrice)||void 0===A?void 0:A.totalPrice},b.updatePrice)),b.updatePrice=null),!T||!T.totalPrice){e.next=30;break}return M=!c&&ln(null===o||void 0===o?void 0:o.isPaidFirst,T),V=null,L=null,B=T||{},U=B.priceDetailList,Z=void 0===U?[]:U,F=Z&&Z.filter((function(e){return 3===e.priceType}))[0]||{},G=F.resourcePriceDetailList,H=void 0===G?[]:G,oe.isEmpty(H)||(V=H.filter((function(e){return!oe.isEmpty(e.tag)&&!oe.isEmpty(e.tag.find((function(e){return"ctrip_vip_discount"===e.key})))}))[0],L=H.filter((function(e){return!oe.isEmpty(e.tag)&&!oe.isEmpty(e.tag.find((function(e){return"ctrip_flight_discount"===e.key})))}))[0]),v({priceDetail:T,InsNeedPayStatus:M,footPriceStatus:1,HighLevelDiscount:V,FlightUserDiscount:L}),e.next=27,j();case 27:return e.abrupt("return",!0);case 30:return Qr({typeName:"PriceDetailError",message:"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u91cd\u8bd5\uff01"}),e.abrupt("return",!1);case 32:e.next=40;break;case 34:return e.prev=34,e.t0=e["catch"](0),Qr({typeName:"PriceDetailError",message:"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u91cd\u8bd5\uff01"}),ca("getPriceDetail",e.t0),Dn(),e.abrupt("return",!1);case 40:case"end":return e.stop()}}),e,null,[[0,34]])})));return function(){return e.apply(this,arguments)}}(),Qe=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,r,o,i;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=d.getState(),r=n.Platform,r!==_e.CTRIPRN&&r!==_e.CTRIPH5){e.next=7;break}return e.next=4,et(t);case 4:return e.abrupt("return",e.sent);case 7:return o=m.UPDATE_PASSENGER_INFO,e.prev=8,e.next=11,tt(2,t);case 11:return i=e.sent,o(i),e.abrupt("return",!0);case 16:return e.prev=16,e.t0=e["catch"](8),console.log(e.t0),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,null,[[8,16]])})));return function(t){return e.apply(this,arguments)}}(),et=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,s,c,l,u,f,p,h,v,g,y,_,b=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=b.length>0&&void 0!==b[0]?b[0]:{},n=t.template,o=d.getState(),s=o.shoppingId,c=o.selectIds,l=o.passengerObj,u=o.Platform,f=m.UPDATE_PASSENGER_INFO,e.prev=3,e.next=6,r.initPassengerInfo(s);case 6:if(p=e.sent,h=p.commonPassengers,v=p.chosenInfo,n){e.next=13;break}return e.next=12,wt(r,s,(null===h||void 0===h?void 0:h.passengers)||[]);case 12:n=e.sent;case 13:return g=At((null===h||void 0===h?void 0:h.passengers)||[],v,n),y=u===_e.CTRIPRN?Lt(c,g):Vt(c,g),e.next=17,Bt(r,y,(0,i.Z)((0,i.Z)({},d.getState()),{},{CommonPassengers:g,isCheck:!0,template:n}));case 17:return _=e.sent,c.length&&oe.forEach(c,(function(e){var t=l[e],n=_[e],r=st(n,d.getState());"U"===r.type?(n.AgeRang=t.AgeRang,n.MayChange=!0):"A"===r.type?n.AgeRang=1:"C"===r.type?n.AgeRang=0:"B"===r.type&&(n.AgeRang=2),n.age=r.age||-1})),f({CommonPassengers:g,ShowPassenger:y,passengerObj:_}),e.abrupt("return",!0);case 23:return e.prev=23,e.t0=e["catch"](3),console.log(e.t0),e.abrupt("return",!1);case 27:case"end":return e.stop()}}),e,null,[[3,23]])})));return function(){return e.apply(this,arguments)}}(),tt=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,o,s,c,l,u,f,p,m,h,v,g,y,_,b,I,T,k,S,C,w,N,E,P=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=P.length>1&&void 0!==P[1]?P[1]:{},e.next=3,x.GetPassenger();case 3:return o=e.sent,s=d.getState(),c=s.selectIds,l=void 0===c?[]:c,u=s.passengerObj,f=s.shoppingId,p=n.backData,m=p||{},h=m.passengers,v=void 0===h?[]:h,g=m.code,y=Nn(o),_=y.commonPassengers,b=y.chosenInfo,I=(0,R.Z)(l),1===g&&v&&(I=v.map((function(e){var t=+e.commonPassenger.passengerID;return e.chosenInfo&&(b[t]=e.chosenInfo),t}))),2===g&&I&&I.length&&(T=[],_&&_.passengers&&_.passengers.forEach((function(e){var t;null!==e&&void 0!==e&&null!==(t=e.commonPassenger)&&void 0!==t&&t.passengerID&&oe.includes(I,+e.commonPassenger.passengerID)&&T.push(+e.commonPassenger.passengerID)})),I=T),k=null,S={},C=[],e.next=15,wt(r,f,(null===_||void 0===_?void 0:_.passengers)||[]);case 15:return w=e.sent,k=At((null===_||void 0===_?void 0:_.passengers)||[],b,w)||[],C=Vt(I,k),e.next=20,Bt(r,C,(0,i.Z)((0,i.Z)({},s),{},{CommonPassengers:k,isCheck:2===t,template:w}));case 20:return S=e.sent,1===t?(N=[],oe.forEach(I,(function(e){if(S[e]){var t=st(S[e],d.getState())||{},n=t.type,a=t.age,o=void 0===a?-1:a,i=t.errorMsg,s=void 0===i?"":i;"X"===n?(r.showToast(s),N.push(e),delete S[e],na("o_vac_order_bbz_passenger_error",{desc:"\u5217\u8868\u9875\u4fdd\u5b58\u8fc7\u6765\u7684",passenger:S[e]})):(S[e].age=o,S[e].type=n)}})),E=Ft(I,S,d.getState()),I=E.selectIds,S=E.passengers):2===t&&I.length&&oe.forEach(I,(function(e){var t=u[e],n=S[e],r=st(n,d.getState());"U"===r.type?n.AgeRang=t.AgeRang:"A"===r.type?n.AgeRang=1:"C"===r.type?n.AgeRang=0:"B"===r.type&&(n.AgeRang=2),n.age=r.age||-1})),e.abrupt("return",{CommonPassengers:k,ShowPassenger:C,passengerObj:S,selectIds:I});case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),rt=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,i,s,c,l,u,f,m,h,v,g,y,_,I,x,T,k,S,C;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=d.getState(),n=t.shoppingId,o=t.resourceinfo,i=void 0===o?{}:o,s=t.shoppinginfo,c=void 0===s?{}:s,l=t.orderBasicInfo,u=void 0===l?{}:l,f=t.selectIds,m=void 0===f?[]:f,h=t.passengerObj,v=void 0===h?{}:h,g=u||{},y=g.totalPersonCount,_=void 0===y?0:y,I=i[We.INSURANCE]||{},x=c[We.INSURANCE]||{},T=0,k=null,I.hasAgeRules&&!oe.isEmpty(x)&&m&&m.length===_&&(k=ft(m,v)),!k){e.next=29;break}return e.prev=8,e.next=11,r.post("UpdateResource",{ShoppingId:n,Insurance:{AgeInfos:k}});case 11:if(S=e.sent,C=S&&S.Insurance,!C||1!==C.Status){e.next=19;break}return T=C.ChangedPrice||0,T&&(b.updatePrice={module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u4fdd\u9669\u5e74\u9f84\u6bb5\u66f4\u65b0\u5bfc\u81f4\u4ef7\u683c\u53d8\u5316 ",action:p.ActionType.change}),e.abrupt("return",{status:!0,ageList:k,retPrice:T});case 19:return e.abrupt("return",{status:!1,ageList:k,retPrice:T});case 20:e.next=27;break;case 22:return e.prev=22,e.t0=e["catch"](8),console.log(e.t0),ca("updateInsAges",e.t0),e.abrupt("return",{status:!1,ageList:k,retPrice:T});case 27:e.next=30;break;case 29:return e.abrupt("return",{status:!0,ageList:k,retPrice:T});case 30:case"end":return e.stop()}}),e,null,[[8,22]])})));return function(){return e.apply(this,arguments)}}(),at=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,o,i,s,c,l,u,f,h,v,g,y,_;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.showMaskLoading(),!oe.isEmpty(t)&&t.map((function(e){var t=e||{},n=t.SeatNumbers;!oe.isEmpty(n)&&n.sort()})),n=d.getState(),o=n.selectIds,i=void 0===o?[]:o,s=n.passengerObj,c=void 0===s?{}:s,l=n.shoppingId,u=void 0===l?"":l,f=i.map((function(e){return c[e]})),h=[],i&&i.length&&oe.forEach(f,(function(e){e.Height===Pe.free?h.push(3):e.Height===Pe.adult?h.push(1):e.Height===Pe.child&&h.push(2)})),e.prev=6,r.hideMaskLoading(),e.next=10,r.post("UpdateResource",{ShoppingId:u,Train:{SelectedTrainSeats:t||[]}});case 10:v=e.sent,g=v&&v.Train,g&&1==g.Status?(y=m.UPDATE_ORDER_INFO,y({selectedTrainSeats:t||[]})):Qr({typeName:"updateTrainSelectedSeatError",message:"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u91cd\u8bd5\uff01",operationData:t}),t&&t.length&&sa({module:"\u706b\u8f66\u7968",scene:"\u9009\u5ea7",role:p.RoleType.usr,action:p.ActionType.change,value:JSON.stringify(t),rootMessageId:null===v||void 0===v||null===(_=v.ResponseStatus)||void 0===_||null===(_=_.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===_?void 0:_.Value}),e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](6),Qr({typeName:"updateTrainSelectedSeatError",message:"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u91cd\u8bd5\uff01",operationData:t}),ca("updateTrainSelectedSeat",e.t0);case 20:case"end":return e.stop()}}),e,null,[[6,16]])})));return function(t){return e.apply(this,arguments)}}(),ot=function(){var e=d.getState(),t=(e.shoppingId,e.cruise),n=e.ResourcePassengerMapList,r=void 0===n?[]:n,a=e.passengerObj,o=void 0===a?{}:a,i=e.ContactInfo,s=void 0===i?{}:i,c=[],l=yt(d.getState());return l?(oe.forEach(t,(function(e){var t=e.cabinIds,n=void 0===t?[]:t;oe.forEach(n,(function(e){var t=r.filter((function(t){return t.ResourceToken===e}))[0],n=t||{},a=n.PassengerTokenList,i=void 0===a?[]:a,s=[];oe.forEach(i,(function(e){var t=o[e]||{},n=t.idInfos,r=void 0===n?[]:n,a=(0,A.Z)(t,dr),i={};for(var c in a)switch(c){case"Birthday":i.BirthDay=a[c];break;case"PassengerID":i.PassengerId=a[c];break;case"CNName":i.Name=a[c];break;case"ENLastName":i.EnLastName=a[c];break;case"ENFirstName":i.EnFirstName=a[c];break;case"Nationality":i.Nationality=a[c];break;case"Gender":i.Gender=a["Gender"]&&"F"===a["Gender"]?"\u5973":"\u7537";break;default:break}var l=[];r&&oe.forEach(r,(function(e){l.push({CardType:null===e||void 0===e?void 0:e.IdCardType,CardNumber:null===e||void 0===e?void 0:e.IdCardNo,TimeLimit:null===e||void 0===e?void 0:e.IdCardValidDate,OrderPassengerId:a.PassengerID})})),i.CardInfos=l,s.push(i)})),c.push({CabinId:e,Passengers:s})}))})),c.length?{SelectedPassengers:c,ContactInfo:{Name:null===s||void 0===s?void 0:s.Name,Email:null===s||void 0===s?void 0:s.Email,CountryCode:null===s||void 0===s?void 0:s.CountryCode,Phone:null===s||void 0===s?void 0:s.Moblie}}:null):null},dt=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,o,i,s,c,l;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r.showMaskLoading(),n=d.getState(),o=n.shoppingId,i=ot(),!i){e.next=28;break}return e.prev=4,e.next=7,r.post("UpdateResource",{ShoppingId:o,Cruise:i});case 7:if(s=e.sent,r.hideMaskLoading(),c=s&&s.Cruise,!c||1!==c.Status){e.next=15;break}return t&&c.ChangedPrice&&(b.updatePrice={module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u8231\u623f\u9009\u6ee1\u51fa\u884c\u4eba\u5bfc\u81f4\u4ef7\u683c\u53d8\u5316 ",action:p.ActionType.change},l=m.UPDATE_ORDER_INFO,l({cruiseUpdatePrice:c.ChangedPrice}),Tr({isShowAlertMask:!0,options:{typeName:"CruisePriceChange",title:"\u5404\u8231\u623f\u5957\u9910\u4ef7\u683c\u5df2\u968f\u51fa\u884c\u4eba\u7684\u771f\u5b9e\u5e74\u9f84\u53d1\u751f\u53d8\u5316"}}),Xe()),e.abrupt("return",1);case 15:return t&&Qr({typeName:"UpdateCruiseError",message:c&&c.Message||"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u91cd\u8bd5\uff01"}),e.abrupt("return",0);case 17:e.next=26;break;case 19:return e.prev=19,e.t0=e["catch"](4),r.hideMaskLoading(),console.log(e.t0),ca("updateCruise",e.t0),t&&Qr({typeName:"UpdateCruiseError",message:"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u91cd\u8bd5\uff01"}),e.abrupt("return",0);case 26:e.next=30;break;case 28:return r.hideMaskLoading(),e.abrupt("return",2);case 30:case"end":return e.stop()}}),e,null,[[4,19]])})));return function(t){return e.apply(this,arguments)}}(),pt=function(){var e=d.getState(),t=e.defaultUsaAdd,n=void 0===t?{}:t,a=e.tagInfo,o=void 0===a?{}:a,i=e.isSubmit,s=void 0!==i&&i,c=n.ProvinceName,l=n.Address,u=n.CityName,f=n.ZipCode,p=n.ProvinceCode,h=n.HotelId,v={CountryCode:"US",StateCode:p,ProvinceName:c,CityName:u,Address:l,ZipCode:f,DestinationEmail:"",RestrictionAreaType:o.needUsAddress,RelatedResourceId:h},g=m.UPDATE_ORDER_INFO;if(g({DestinationAddress:v}),r.doWithUSAddressInfo&&r.doWithUSAddressInfo(v),s){var y=gn(d.getState(),!0)||{};g({ErrorUSAAddress:y})}},mt=function(){var e,t=d.getState(),r=t.pageStatus,a=t.orderBasicInfo,o=t.productBasicInfo,i=t.selectIds,s=t.passengerObj,c=t.OrderKnow,l=t.priceDetail,u=t.preOrderTotalPrice,f=t.ContactInfo,p=t.shoppinginfo,m=t.resourceinfo,h=o||{},v=h.isCruise,g=void 0!==v&&v,y=a||{},_=y.totalPersonCount,b=y.travelDays,I=y.DepartureDate,x=y.ReturnDate,T=c||{},k=T.ContractInfo,S=void 0===k?{}:k,C=T.personLimit,w=T.mergeGroup;if(g){var N=f||{},E=N.Name,P=N.SurenameCN,j=N.GivenNameCN,O=N.Surname,D=N.GivenName;E||(P?E=j+P:O&&(E=D+" "+O)),e=Oe,e.traSign=E,e.choice1='<span class="option-uncheck"></span>',e.choice2='<span class="option-checked"></span>';var R=p&&p.INSURANCE;if(!oe.isEmpty(R)){var A,M=[],V=(null===m||void 0===m||null===(A=m.INSURANCE)||void 0===A?void 0:A.insuranceDic)||{};for(var L in R){var B=V[L]||{},U=B.category,Z=B.baseInfo,F=Z||{},G=F.name;G&&1===U&&(M.push(G),e.choice1='<span class="option-checked"></span>',e.choice2='<span class="option-uncheck"></span>')}M&&M.length&&(e.insuranceName=M.join("\uff0c"))}e.payType1='<span class="option-normal"></span>',e.payType2='<span class="option-normal"></span>'}else{if(e=je,"presale"===r)return e;e.agreeToMerge=w?"\u540c\u610f":"\u4e0d\u540c\u610f",e.nights="/",e.adultCost="/",e.childCost="/",e.payGuide="/",e.agreeToTransfer="\u4e0d\u540c\u610f",e.delayAgree="\u540c\u610f",e.agreeToChangeLine="\u540c\u610f",e.agreeToTerminate="\u540c\u610f",e.teminateDealType="2",e.copys1="\u4e24",e.copys2="\u4e00",e.deptAddr="\u4e0a\u6d77\u5e02\u957f\u5b81\u533a\u91d1\u949f\u8def968\u53f7",e.payType="\u4ee5\u5b9e\u9645\u652f\u4ed8\u4e3a\u51c6"}if(e.totalNumber=_+"",e.starDate=I,"endDate"in e&&(e.endDate=x),"EndDate"in e&&(e.EndDate=x),e.days=b,e.agencyName=(null===S||void 0===S?void 0:S.agencyName)||"",e.travelAgencyLicenseNumber=(null===S||void 0===S?void 0:S.travelAgencyLicenseNumber)||"",e.travelAgencyplace=(null===S||void 0===S?void 0:S.travelAgencyplace)||"",e.leastCustomerNumber=C||"",e.supplementaryClause="\u89c1\u300a\u9884\u8ba2\u987b\u77e5\u300b","preorder"===r)e.totalCost=u||"";else{var H=l||{},q=H.totalPrice,K=void 0===q?{}:q;e.totalCost=(null===K||void 0===K?void 0:K.totalPrice)||""}if(i&&i.length){var z=0;z=i.find((function(e){var t;return s[e]&&s[e].age>=18&&!(null===(t=s[e])||void 0===t||null===(t=t.defaultPhoneInfo)||void 0===t||!t.mobilePhone)})),z||(z=i.find((function(e){return s[e]&&s[e].age>=18}))),z||(z=i[0]);var Y,W,$,X,J,Q,ee=s[z];if("traveler"in e)e.traveler=(null===ee||void 0===ee||null===(Y=ee.userNameObj)||void 0===Y?void 0:Y.cNName)||(null===ee||void 0===ee||null===(W=ee.userNameObj)||void 0===W?void 0:W.eName),e.travelerMobile=(null===ee||void 0===ee||null===($=ee.defaultPhoneInfo)||void 0===$?void 0:$.mobilePhone)||"";if("traveller"in e)e.traveller=(null===ee||void 0===ee||null===(X=ee.userNameObj)||void 0===X?void 0:X.cNName)||(null===ee||void 0===ee||null===(J=ee.userNameObj)||void 0===J?void 0:J.eName),e.travellerTel=(null===ee||void 0===ee||null===(Q=ee.defaultPhoneInfo)||void 0===Q?void 0:Q.mobilePhone)||""}return vr&&(n.g.__replaceObj=e),e},_t=function(e){var t=d.getState(),n=t.ContactInfo,r=void 0===n?{}:n,a=t.ErrorContactMsg,o=void 0===a?{}:a,s=(0,i.Z)({},r),c=s.CountryCode;if(e&&e.countryCode!==c){s.CountryName=e.showName,s.CountryCode=e.countryCode,s.Moblie="";var l=(0,i.Z)({},o);l.Moblie&&(l.Moblie="");var u=m.UPDATE_ORDER_INFO;u({ContactInfo:s,ErrorContactMsg:l}),ne()}},Tt=function(e){r.setPageId&&r.setPageId();var t=d.getState(),n=t.DeliveryTemplate,a=t.OrderDelivery,o=t.OrderInvoice,i=lt(n,e),s=null;i&&(s=ut(n,i,a));var c=m.UPDATE_ORDER_INFO;c({formatDlyData:i,OrderDelivery:s,OrderInvoice:e}),sa({module:"\u53d1\u7968",scene:"\u7f16\u8f91\u53d1\u7968\u62ac\u5934",role:p.RoleType.usr,action:p.ActionType.change,value:(null===e||void 0===e?void 0:e.Title)||"\u65e0",before:(null===o||void 0===o?void 0:o.Title)||"\u65e0",jsonData:e||{}})},kt=function(e){var t=d.getState(),n=t.OrderDelivery,r=void 0===n?{}:n,a=(0,i.Z)({},r);a.AddressInfo=e;var o=m.UPDATE_ORDER_INFO;o({OrderDelivery:a})},St=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,o,i,s,c,l,u,f,h,v,g,y,_,b;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r.setPageId&&r.setPageId(),t){e.next=3;break}return e.abrupt("return");case 3:n=d.getState(),o=n.hotelInfo,i=void 0===o?[]:o,s=t||{},c=s.selectedRemarksListByToken,l=void 0===c?[]:c,u=s.orderRemark,f=void 0===u?"":u,h=s.pickUpRemark,v=void 0===h?[]:h,g=bn(l),y=m.UPDATE_ORDER_INFO,y({customerRequirement:{HotelRemark:g,Remark:f||""},pickUpRemark:v}),_="",f&&(_="\u5907\u6ce8:".concat(f,",")),g&&g.length&&i&&i.length&&(b=g.map((function(e){var t,n=i.filter((function(t){return t.hotelRoomInfo&&t.hotelRoomInfo.token===e.Token}))[0];return"".concat((null===n||void 0===n||null===(t=n.hotelRoomInfo)||void 0===t?void 0:t.hotelName)||"",":").concat(e.commentRemark)})),_+="\u9152\u5e97\u5907\u6ce8:".concat(b.join(";"))),_&&sa({module:"\u7279\u6b8a\u9700\u6c42",scene:"\u7f16\u8f91\u7279\u6b8a\u9700\u6c42",role:p.RoleType.usr,action:p.ActionType.change,value:_});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ct=function(e){var t=d.getState(),n=t.ContactInfo,r=void 0===n?{}:n,a=t.isSubmit,o=void 0!==a&&a,s=(0,i.Z)({},r),c=m.UPDATE_ORDER_INFO,l=m.UPDATA_CONTACT_INFO;if(e.id&&(s.ContactId=e.id+""),e.mobilePhone&&(s.Moblie=e.mobilePhone),e.countryCode&&(s.CountryCode=e.countryCode),e.name&&(s.Name=e.name.trim()),e.contactEmail&&(s.Email=e.contactEmail),c({ContactInfo:s}),o){var u=vn({data:d.getState(),isCheckAll:!0});l({ErrorContactMsg:u})}},Nt=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,o,i,s,c,l,u,f,h,v,g,_,b,I,x,T,k,S,C,w,N,E,P,j,O;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("\ud83e\udd21data",t),n=d.getState(),o=n.selectedPromotion,i=n.shoppingId,s=n.forceReloadTimestamp,c=void 0===s?0:s,l=n.beforeForceReloadTimestamp,u=void 0===l?0:l,f=!0,oe.isEmpty(t)){e.next=46;break}if(h=m.UPDATE_ORDER_INFO,v=t.availableCount,g=t.useStatus,_=t.couponInfo,c&&u&&(I=(null===_||void 0===_?void 0:_.couponName)||"",x=(null===o||void 0===o||null===(b=o.couponInfo)||void 0===b?void 0:b.couponName)||"",(I||x)&&sa({module:"\u4f18\u60e0\u5238",scene:"\u9009\u62e9\u4f18\u60e0\u5238",role:c===u?p.RoleType.usr:p.RoleType.sys,action:c===u?p.ActionType.click:p.ActionType.change,value:I||"\u65e0",before:x||"\u65e0",contents:I?[{key:"id",value:null===_||void 0===_?void 0:_.couponCode},{key:"\u4f18\u60e0\u5238\u540d\u79f0",value:I},{key:"\u4f18\u60e0\u5238\u4ef7\u683c",value:(null===_||void 0===_?void 0:_.deductionAmount)+""}]:[]})),1!==g||!_||!_.couponCode){e.next=24;break}if(S=(null===o||void 0===o||null===(T=o.couponInfo)||void 0===T?void 0:T.couponCode)||"",C=null===o||void 0===o||null===(k=o.couponInfo)||void 0===k?void 0:k.deductionAmount,S===_.couponCode&&C===_.deductionAmount){e.next=22;break}return e.prev=11,e.next=14,r.post("SetPromotionBasicInfo",{ShoppingId:i,PromotionBasicInfo:{PromotionID:_.promotionId,ReducedAmount:_.deductionAmount&&-Math.abs(_.deductionAmount)+""||0,ReducedLocalAmount:_.deductionAmount&&-Math.abs(_.deductionAmount)+""||0,CouponCode:_.couponCode,PromotionName:_.couponName,DeductionStrategyID:_.deductionStrategyType,MatchedQuantity:_.matchedQuantity}});case 14:w=e.sent,w&&w.IsSetSucc?null===y||void 0===y||y.clear():(f=!1,ca("SetPromotionBasicInfo",w)),e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](11),f=!1,ca("SetPromotionBasicInfo",e.t0);case 22:e.next=45;break;case 24:if(2!==g&&3!==g){e.next=45;break}if(E=(null===o||void 0===o||null===(N=o.couponInfo)||void 0===N?void 0:N.couponCode)||"",!E){e.next=45;break}return e.prev=27,e.next=30,r.post("DelPromotionBasicInfo",{ShoppingId:i});case 30:if(P=e.sent,!P||!P.IsDelSucc){e.next=37;break}if(2!==g||!y){e.next=35;break}return e.next=35,y.set({ShoppingId:i,UseCouponStatus:g});case 35:e.next=39;break;case 37:f=!1,ca("DelPromotionBasicInfo",P);case 39:e.next=45;break;case 41:e.prev=41,e.t1=e["catch"](27),f=!1,ca("DelPromotionBasicInfo",e.t1);case 45:f?(console.log("\ud83e\udd21interfaceRight",{selectedPromotion:{availableCount:v,couponInfo:_,useStatus:g}}),h({selectedPromotion:{availableCount:v,couponInfo:_,useStatus:g},beforeForceReloadTimestamp:c}),console.log("\ud83e\udd21Date.now1()",Date.now())):null!==o&&void 0!==o&&null!==(j=o.couponInfo)&&void 0!==j&&j.couponCode||h({selectedPromotion:{availableCount:v,couponInfo:null,useStatus:g}});case 46:return vr&&(O=m.UPDATE_ORDER_INFO,["ff2568e9a6b74146a97cef309b293d30"].includes(i)&&O({UnitTest_Price:t})),Je(),e.abrupt("return",{success:f});case 49:case"end":return e.stop()}}),e,null,[[11,18],[27,41]])})));return function(t){return e.apply(this,arguments)}}(),Et=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,o,s,c,l,u,f,h,v,g,y,_,b,I,x,T,k,S,C,w,N,E,P,j,O,D,A,M,V,L,B,U,Z;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.setPageId&&r.setPageId(),n=t&&t.commonPassenger||{},o=n.cNName,s=n.eNLastName,c=n.eNFirstName,sa({module:"\u51fa\u884c\u4eba",scene:"\u7f16\u8f91\u51fa\u884c\u4eba\u9875\u8fd4\u56de",role:p.RoleType.sys,action:p.ActionType.change,value:o||"".concat(s,"/").concat(c),jsonData:t}),l=d.getState(),u=l.orderBasicInfo,f=l.passengerObj,h=l.CommonPassengers,v=l.selectIds,l.productBasicInfo,g=l.tagInfo,y=void 0===g?{}:g,_=l.shoppingId,b=oe.cloneDeep(f),I=oe.cloneDeep(h),x=(0,R.Z)(v),e.next=9,wt(r,_,[t]);case 9:return T=e.sent,k=At([t],null,T)[0],S=+k.passengerID,C=oe.findIndex(h,(function(e){return+e.passengerID===S})),I.splice(C,1,k),e.next=16,Bt(r,[S],(0,i.Z)((0,i.Z)({},d.getState()),{},{CommonPassengers:[k],template:T}));case 16:if(w=e.sent,N=w[S]||{},E=b[S]||{},P=E.type,j=void 0===P?"":P,O=E.AgeRang,D=st(N,d.getState()),N.age=D.age,A=!1,oe.includes(x,S)?"X"===D.type?(r.showToast(D.errorMsg),x=oe.difference(x,[S])):"U"===D.type?(N.AgeRang=O,N.type=j,N.MayChange=!0):"A"===D.type?(oe.includes(["B","C"],j)&&(x=oe.difference(x,[S]),A=!0),N.AgeRang=1,N.type="A",N.MayChange=!1):"C"===D.type?(oe.includes(["B","A"],j)&&(x=oe.difference(x,[S]),A=!0),N.AgeRang=0,N.type="C",N.MayChange=!1):"B"===D.type&&(oe.includes(["A","C"],j)&&(x=oe.difference(x,[S]),A=!0),N.AgeRang=2,N.type="B",N.MayChange=!1):"X"===D.type?r.showToast(D.errorMsg):("U"===D.type?(N.MayChange=!0,N.AgeRang=1,N.type="A"):"A"===D.type?(N.AgeRang=1,N.type="A"):"C"===D.type?(N.AgeRang=0,N.type="C"):"B"===D.type&&(N.AgeRang=2,N.type="B"),x.push(S)),null!==y&&void 0!==y&&y.isTrain&&(M=ct(E,d.getState()),V=ct(N,d.getState()),M.type&&M.type!==Pe.free&&V.type===Pe.free&&(N.Height=Pe.free)),b[S]=N,L=Kt([b[S]]),na("o_vac_order_passenger",{desc:"\u7f16\u8f91\u9875\u4fdd\u5b58\u56de\u6765\u7684\u51fa\u884c\u4eba\u5904\u7406\u4fe1\u606f",passenger:L}),B=Yt(S,x,b),B&&(Gr({status:!0,options:{type:"samecard",ids:B}}),x=oe.difference(x,[S])),U=m.UPDATE_ORDER_INFO,U({selectIds:x,passengerObj:b,CommonPassengers:I}),A&&(r.showToast("\u60a8\u9009\u62e9\u7684\u51fa\u884c\u4eba\u4fe1\u606f\u53d1\u751f\u53d8\u66f4\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9"),na("o_vac_order_bbz_passenger_error",{desc:"\u7f16\u8f91\u9875\u4fdd\u5b58\u8fc7\u6765\u7684",oldPassengerObj:E,newPassengerObj:N})),Z=u.totalPersonCount,Z!==x.length){e.next=37;break}return e.next=37,K();case 37:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Pt=function(e){var t=d.getState(),n=t.Installment,r=n||{},a=r.selectedIndex,o=void 0===a?-1:a,s=m.UPDATE_ORDER_INFO;s({Installment:(0,i.Z)((0,i.Z)({},n),{},{selectedIndex:e===o?-1:e,recommendIndex:e})})},jt=function(e){if(e){var t=e.ProvinceName,n=e.ProvinceCode,a=e.CityName,o=d.getState(),s=o.DestinationAddress,c=void 0===s?{}:s,l=(0,i.Z)({},c);l.StateCode=n,l.ProvinceName=t,l.CityName=a,l.RelatedResourceId=0;var u=m.UPDATE_ORDER_INFO;u({DestinationAddress:l}),r.doWithUSAddressInfo&&r.doWithUSAddressInfo(l)}},Ot=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n,o){var s,c,l,u,f,h,v,g,y,_,b,I,x,T,k,S,C,w,N,E,P,j;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.setPageId&&r.setPageId(),o&&o.length?(s=o.map((function(e){var t=e||{},n=t.commonPassenger,r=void 0===n?{}:n,a=r||{},o=a.cNName,i=a.eNLastName,s=a.eNFirstName;return o||"".concat(i,"/").concat(s)})),sa({module:"\u51fa\u884c\u4eba",scene:"\u51fa\u884c\u4eba\u5217\u8868\u9875\u9009\u62e9\u8fd4\u56de",role:p.RoleType.sys,action:p.ActionType.change,value:s.join(",")})):sa({module:"\u51fa\u884c\u4eba",scene:"\u5173\u95ed\u51fa\u884c\u4eba\u5217\u8868\u9875\u8fd4\u56de"}),c=d.getState(),e.next=5,wt(r,c.shoppingId,(null===t||void 0===t?void 0:t.passengers)||[]);case 5:return l=e.sent,u=At((null===t||void 0===t?void 0:t.passengers)||[],n,l),f=[],o?f=o.map((function(e){return+e.commonPassenger.passengerID})):(h=(null===c||void 0===c?void 0:c.selectIds)||[],h&&h.length&&u&&u.length&&oe.forEach(u,(function(e){oe.includes(h,e.passengerID)&&f.push(e.passengerID)}))),v=(null===c||void 0===c?void 0:c.Platform)===_e.CTRIPRN?Lt(f,u):Vt(f,u),e.next=12,Bt(r,v,(0,i.Z)((0,i.Z)({},c),{},{CommonPassengers:u,template:l}));case 12:if(g=e.sent,y=Kt(Object.values(g)),na("o_vac_order_passenger",{desc:"\u5217\u8868\u9875\u4fdd\u5b58\u8fc7\u6765\u7684\u51fa\u884c\u4eba\u5904\u7406\u540e\u4fe1\u606f",passenger:y}),_=[],oe.forEach(f,(function(e){if(g[e]){var t=st(g[e],d.getState())||{},n=t.type,a=t.age,o=void 0===a?-1:a,i=t.errorMsg,s=void 0===i?"":i;"X"===n?(r.showToast(s),_.push(e),delete g[e],na("o_vac_order_bbz_passenger_error",{desc:"\u5217\u8868\u9875\u4fdd\u5b58\u8fc7\u6765\u7684",passenger:g[e]})):(g[e].age=o,g[e].type=n)}})),_.length&&(f=oe.difference(f,_)),b=Ft(f,g,d.getState()),f=b.selectIds,g=b.passengers,I=m.UPDATE_PASSENGER_INFO,I({CommonPassengers:u,ShowPassenger:v,passengerObj:g,selectIds:f}),x=c.orderBasicInfo,T=void 0===x?{}:x,c.productBasicInfo,k=T.totalPersonCount,S=T.AdultCount,C=T.ChildCount,w=T.InfantCount,N=void 0===w?0:w,k!==f.length){e.next=28;break}return e.next=28,K();case 28:try{o&&(E=0,P=0,j=0,oe.forEach(f,(function(e){var t=g[e];t&&(0==t.AgeRang&&P++,1==t.AgeRang&&E++,2==t.AgeRang&&j++)})),k===f.length&&E===S&&P===C&&j===N||na("o_vac_order_bbz_passenger_list_number_error",{selectIds:f,AdultCount:S,ChildCount:C,InfantCount:N,num_adu:E,num_chl:P,num_infant:j}))}catch(e){}case 29:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Rt=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,s,c;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.showMaskLoading({text:"\u8bf7\u6c42\u4e2d...",cancelable:!1},(function(){})),t=m.UPDATE_ORDER_INFO,e.prev=2,e.next=5,x.getMemberinfo();case 5:if(n=e.sent,r.hideMaskLoading(),!1!==n){e.next=9;break}return e.abrupt("return");case 9:o=d.getState(),s=rr(n),c=Qt((0,i.Z)((0,i.Z)({},o),{},{memberinfo:s})),oe.isEmpty(c)&&(c={memberinfo:s}),t((0,i.Z)({ErrorContactMsg:null},c)),e.next=21;break;case 16:e.prev=16,e.t0=e["catch"](2),r.hideMaskLoading(),Qr({typeName:"GetMemberinfoError"}),ca("GetMemberinfoError",e.t0);case 21:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(){return e.apply(this,arguments)}}(),Mt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(e){var t=d.getState(),n=t.options,r=n||{},a=r.actionFrom,o=void 0===a?"":a;1===e?W(!0):2===e&&W(!1),Wr({status:!1}),1===e&&"save"===o&&qt(1)}},Ut=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,o,s,c,l,u,f,p,h,v,g,y,_,b,I,x,T,k,S,C,w,N,E,P,j,O,D,R,A,M,V,L,B,U,Z,F,G,H,q,K,z,Y,W,$,X,J,Q,ee,te,ne,re,ae,ie,se,ce,le,ue,de,fe,pe,me,he,ve,ge,ye,be,xe,Te,ke,Se,Ce,we,Ne,Ee,je,Oe,De,Re,Ae,Me,Ve,Le,Be,Ue,Ze,Fe,Ge,He,qe,Ke,ze,Ye,$e,Xe,Je,Qe,et,tt,nt,rt,at,ot,it,st;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(vr&&(n.g.__pagestate=d.getState()),Rn(),t=m.UPDATE_ORDER_INFO,t({isSubmit:!0}),o=d.getState(),s=o.shoppingId,c=o.selectIds,l=void 0===c?[]:c,u=o.passengerObj,f=void 0===u?{}:u,p=o.orderBasicInfo,h=void 0===p?{}:p,v=o.productBasicInfo,g=o.noPhoneError,y=o.formatDlyData,_=o.passengerRules,b=o.sharedRoomInfo,o.userNotice,I=o.tagInfo,x=void 0===I?{}:I,T=o.ProductBasicInfo,void 0===T?{}:T,k=o.train12306LoginData,S=o.OrderDelivery,C=o.cruise,w=o.Platform,N=o.IsContrainSelf,E=o.resourceinfo,P=o.shoppinginfo,j=o.memberinfo,O=o.TrainPassengerMapList,D=o.trainChildPassengerIds,R=o.Channels,A=o.errorTip,void 0===A?{}:A,M=o.getValidatePassengerOfTest,V=x.isContainSystemFlight,L=void 0!==V&&V,B=x.isNeedUsAddress,U=void 0===B?"":B,Z=x.isTrain,F=void 0!==Z&&Z,G=v.SaleMode,H=v.ProductType,q=v.childStandard,K=h.numErrorTip,z=void 0===K?"":K,Y=h.totalPersonCount,W=void 0===Y?0:Y,$=h.AdultCount,X=h.ChildCount,J=h.InfantCount,Q=void 0===J?0:J,ee=h.cabinNum,x.trainChildPriceStandard,te=j||{},ne=te.isCheckPrivacyTerms,re=te.isNeedRegiHotel,ae=te.rooms,ie=void 0===ae?[]:ae,l.length===W){e.next=16;break}return Dn(),r.showToast(z),r.scrollToErrorPosition("Traveler"),Gt({desc:z,key:"vac_30046"}),e.abrupt("return");case 16:if(se=l.map((function(e){return f[e]})),ce=0,le=0,ue=0,de=!1,!0,fe=[],se.map((function(e){0==e.AgeRang&&le++,1==e.AgeRang&&ce++,2==e.AgeRang&&ue++,e.isComplete||(de=!0),F&&(e.Height||!1,e.Height===Pe.child&&fe.push(String(e.PassengerID)))})),ce===$&&le===X&&ue===Q){e.next=27;break}return Dn(),r.showToast(z),r.scrollToErrorPosition("Traveler"),Gt({desc:z,key:"vac_30046"}),e.abrupt("return");case 27:if(!g){e.next=32;break}return r.scrollToErrorPosition("Traveler"),Gt({desc:"\u8bf7\u81f3\u5c11\u586b\u5199\u4e00\u4f4d\u51fa\u884c\u4eba\u65c5\u5ba2\u7684\u624b\u673a\u53f7\u7801",key:"vac_30048"}),Dn(),e.abrupt("return");case 32:if(!de){e.next=38;break}return Dn(),r.showToast("\u65c5\u5ba2\u4fe1\u606f\u672a\u5b8c\u5584\uff0c\u8bf7\u8865\u5145"),r.scrollToErrorPosition("Traveler"),Gt({desc:"\u65c5\u5ba2\u4fe1\u606f\u672a\u5b8c\u5584\uff0c\u8bf7\u8865\u5145",key:"vac_30047"}),e.abrupt("return");case 38:if(!_||!_.isSupportChild){e.next=45;break}if(pe=vt(_.child,se),pe[0]){e.next=45;break}return Tr({isShowAlertMask:!0,options:{typeName:"SdpChildDiff",data:pe[1],title:"\u6240\u9009\u513f\u7ae5\u5e74\u9f84\u4e0e\u67e5\u8be2\u65f6\u9009\u62e9\u7684\u513f\u7ae5\u5e74\u9f84\u8303\u56f4\u4e0d\u4e00\u81f4"}}),Gt({desc:"\u6240\u9009\u513f\u7ae5\u5e74\u9f84\u4e0e\u67e5\u8be2\u65f6\u9009\u62e9\u7684\u513f\u7ae5\u5e74\u9f84\u8303\u56f4\u4e0d\u4e00\u81f4",key:"vac_30063"}),Dn(),e.abrupt("return");case 45:if(me=Ie()||{},he=Object.keys(me),ve=!0,!he||!he.length){e.next=57;break}if(ge={Name:"vac_30055",Moblie:"vac_30056",Email:"vac_30057",ContactIDCardNumber:"vac_30058",Sex:"vac_30059"},oe.forEach(he,(function(e){me[e]&&(ve=!1,Gt({desc:me[e],key:ge[e]}))})),ve){e.next=57;break}return t({ErrorContactMsg:me}),r.scrollToErrorPosition("ContactInfo"),Dn(),null!==R&&void 0!==R&&R.isBestoneMiniProgram&&r.showToast("\u8054\u7cfb\u4eba\u4fe1\u606f\u4e0d\u5168\uff0c\u8bf7\u8054\u7cfb\u95e8\u5e97\u89e3\u51b3"),e.abrupt("return");case 57:if(!re||!1!==ne){e.next=62;break}return Gt({desc:"\u8bf7\u9605\u8bfb\u5e76\u540c\u610f\u4f1a\u5458\u53ca\u4e2a\u4eba\u4fe1\u606f\u6388\u6743\u534f\u8bae",key:"vac_31001"}),r.scrollToErrorPosition("PrivacyTerms"),Dn(),e.abrupt("return");case 62:if(!ie||!ie.length){e.next=69;break}if(ye=ie.find((function(e){return!0===e.isNotInChoosePsg})),!ye){e.next=69;break}return Gt({desc:"\u6539\u9152\u5e97\u6ce8\u518c\u9700\u672c\u4eba\u5165\u4f4f",key:"vac_31002"}),r.scrollToErrorPosition("ContactInfo"),Dn(),e.abrupt("return");case 69:if(2!==H||!U){e.next=81;break}if(be=gn(d.getState(),!0)||{},xe=Object.keys(be),Te=!0,!xe||!xe.length){e.next=81;break}if(ke={CityName:"vac_30060",Address:"vac_30061",ZipCode:"vac_30062"},oe.forEach(xe,(function(e){be[e]&&(Te=!1,Gt({desc:be[e],key:ke[e]}))})),Te){e.next=81;break}return t({ErrorUSAAddress:be}),r.scrollToErrorPosition("USAAddress"),Dn(),e.abrupt("return");case 81:if(!b||!b.status){e.next=88;break}if(b.passengerId){e.next=88;break}return Dn(),r.showToast("\u8bf7\u9009\u62e9\u62fc\u623f\u4eba\u5458"),r.scrollToErrorPosition("SharedRoom"),Gt({desc:"\u8bf7\u9009\u62e9\u62fc\u623f\u4eba\u5458",key:"vac_30051"}),e.abrupt("return");case 88:if(!F||!oe.isEmpty(k)){e.next=94;break}return r.showToast("\u8bf7\u767b\u5f5512306\u8d26\u53f7"),r.scrollToErrorPosition("TrainLogin"),Gt({desc:"\u8bf7\u767b\u5f5512306\u8d26\u53f7",key:"vac_30069"}),Dn(),e.abrupt("return");case 94:if(1!==ee){e.next=105;break}if(Se=!1,Ce=q||{},we=Ce.cruiseAge,Ne=void 0===we?18:we,l.map((function(e){var t=(0,i.Z)({},f[e]);t.age&&t.age>=Ne&&(Se=!0)})),Se){e.next=105;break}return Dn(),Ee="\u6bcf\u95f4\u8231\u623f\u81f3\u5c11\u9700\u8981\u4e00\u4f4d".concat(Ne,"\u5c81\u4ee5\u4e0a\u7684\u6210\u4eba\u5165\u4f4f"),r.showToast(Ee),r.scrollToErrorPosition("Traveler"),Gt({desc:Ee,key:"vac_30123"}),e.abrupt("return");case 105:if(!F){e.next=123;break}if(!D||!D.length){e.next=123;break}je=[],Oe=(0,a.Z)().mark((function e(){var t,n,r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=f[D[De]],n=t.Height===Pe.free,r=null===O||void 0===O?void 0:O.some((function(e){return+e.ChildPassengerToken===t.PassengerID})),n&&!r&&je.push(D[De]);case 4:case"end":return e.stop()}}),e)})),De=0;case 110:if(!(De<D.length)){e.next=115;break}return e.delegateYield(Oe(),"t0",112);case 112:De++,e.next=110;break;case 115:if(!je.length){e.next=123;break}return Dn(),Re="\u514d\u7968\u513f\u7ae5\u9700\u5173\u805416\u5468\u5c81(\u542b)\u4ee5\u4e0a\u6210\u4eba\u53d6\u7968",r.showToast(Re),r.scrollToErrorPosition("TrainTicketType"),t({trainErrorPassengerList:je||[]}),Gt({desc:Re,key:"vac_30053"}),e.abrupt("return");case 123:if(N){e.next=136;break}if(Ae=E[We.INSURANCE]||{},Me=Ae.specialTokens,Ve=void 0===Me?{}:Me,Le=Ve||{},Be=Le.levleCancleTokens,Ue=void 0===Be?[]:Be,!Ue||!Ue.length){e.next=136;break}if(Ze=P[We.INSURANCE]||{},Fe=!1,oe.forEach(Ue,(function(e){Fe||Ze[e]&&Ze[e].count>0&&(Fe=!0)})),!Fe){e.next=136;break}return r.scrollToErrorPosition("UserLevelInsurance"),Gt({desc:"\u9009\u62e9\u7684\u7279\u6743\u9700\u672c\u4eba\u51fa\u884c\u4f7f\u7528",key:"vac_30068"}),Dn(),e.abrupt("return");case 136:if("R"==G||!y){e.next=142;break}if(S&&S.DeliveryType&&S.AddressInfo&&(S.AddressInfo.Address||2!==S.DeliveryType)&&(S.AddressInfo.Recipient||2===S.DeliveryType)){e.next=142;break}return Dn(),r.showToast("\u8bf7\u586b\u5199\u914d\u9001\u5730\u5740"),r.scrollToErrorPosition("Delivery"),e.abrupt("return");case 142:if(Ge=yn(d.getState())||[],!Ge||!Ge.length){e.next=152;break}return He=Ge[0],t({ErrorTokenList:Ge}),qe="\u8d44\u6e90\u6ca1\u6709\u5173\u8054\u51fa\u884c\u4eba",C&&C.length&&(Ke=C.filter((function(e){return oe.includes(e.cabinIds,He)}))[0],Ke&&(He=(null===Ke||void 0===Ke||null===(ze=Ke.Basic)||void 0===ze?void 0:ze.OvaryRoomId)||He,qe="\u90ae\u8f6e\u4ed3\u623f\u6ca1\u6709\u5173\u8054\u51fa\u884c\u4eba")),r.scrollToErrorPosition(He),Gt({desc:qe,key:"vac_30054"}),Dn(),e.abrupt("return");case 152:return e.next=154,zt(r,se,L);case 154:if(Ye=e.sent,!Ye||!Ye.length){e.next=160;break}return Gt({desc:Ye[1]&&Ye[1].join(","),key:1===Ye[0]?"vac_30050":"vac_30049"}),Tr({isShowAlertMask:!0,options:{typeName:"SameName",messages:Ye[1]}}),Dn(),e.abrupt("return");case 160:return e.prev=160,$e=se.map((function(e){return Ht(e)})),Xe={ProductToken:s,BizType:"PKG",QueryType:"CrossCheck",PassengerInfos:$e},vr&&oe.includes(["239733157aef43a4b169b2c05e274576"],s)&&(Xe.getValidatePassengerOfTest=M||"result_error"),e.next=166,r.post("GetValidatePassenger",Xe);case 166:if(Je=e.sent,null===Je||void 0===Je||!Je.CrossValidateInfo||!Je.CrossValidateInfo[0]){e.next=177;break}return Qe=Je.CrossValidateInfo[0].PopupInfo,et=Qe.Buttons,tt=void 0===et?[]:et,nt=Qe.Content,rt=void 0===nt?[]:nt,at=Qe.Title,ot=Qe.Type,w===_e.CTRIPRN?(it=tt.map((function(e){return{status:e.Code,code:e.Code+9999999,text:e.Text,type:e.Type,style:e.Style,params:e.Params}})),t({PassengerModalData:{type:ot,title:at,content:rt,buttons:it}}),r.showPassengerModal&&r.showPassengerModal()):(st=tt.map((function(e){return{code:e.Code,text:e.Text,type:e.Type,style:e.Style,params:e.Params}})),Tr({isShowAlertMask:!0,options:{typeName:"BbzPassengerValid",passengerModalData:{content:rt,buttons:st,title:at}}})),Gt({desc:rt&&rt.join(","),key:"vac_30067"}),Dn(),vr&&oe.includes(["239733157aef43a4b169b2c05e274576"],s)&&t({getValidatePassengerOfTest:"result_success"}),e.abrupt("return");case 177:hn();case 178:e.next=186;break;case 180:e.prev=180,e.t1=e["catch"](160),console.log(e.t1),Dn(),r.showToast("\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u91cd\u8bd5"),e.t1.isNetError||ca("GetValidatePassenger",e.t1);case 186:case"end":return e.stop()}}),e,null,[[160,180]])})));return function(){return e.apply(this,arguments)}}(),Gt=function(e){sa({module:"\u4e1a\u52a1\u963b\u65ad",scene:"\u70b9\u51fb\u53bb\u652f\u4ed8\uff0c\u9519\u8bef\u62e6\u622a",role:p.RoleType.sys,action:p.ActionType.show,value:null===e||void 0===e?void 0:e.desc,key:null===e||void 0===e?void 0:e.key})},qt=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,i,s=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:0,t&&Rn(),n=d.getState(),o=n.shoppingId,e.prev=3,e.next=6,r.post("ForceConfirm",{shoppingid:o});case 6:i=e.sent,i&&i.forceConfirmInformation&&i.forceConfirmInformation.message?(Dn(),Tr({isShowAlertMask:!0,options:{message:i.forceConfirmInformation.message,typeName:"ConfirmInformation"}})):nn(),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](3),Dn(),Qr({typeName:"SaveOrderError"}),e.t0.isNetError||ca("checkShowImprotantTip",e.t0);case 15:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(){return e.apply(this,arguments)}}(),nn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e&&Rn();var t=d.getState(),n=t.order_tips_status,a=void 0===n?{}:n,o=t.shoppingId,s=t.resourceinfo,c=void 0===s?{}:s,l=t.shoppinginfo,u=void 0===l?{}:l,f=t.Channels;if(f&&f.isInBestoneApp)rn();else{var p=a&&(0,i.Z)({},a);if(p&&p.tip_insurance_show===o)rn();else{var h=!0,v=u[We.INSURANCE]||{},g=c[We.INSURANCE]||{},y=g&&g.insuranceCategoryTokenMap&&g.insuranceCategoryTokenMap["1"]||[];if(g&&0!=y.length||(h=!1),h){var _=ht(v,g);_||(h=!1)}if(h){Dn(),p.tip_insurance_show=o;var b=m.UPDATE_ORDER_INFO;b({order_tips_status:p}),r.set("order_tips_status",p),Er(!0),Gt({desc:"\u4fdd\u9669\u633d\u7559\u5f39\u5c42\u663e\u793a",key:"vac_30121"})}else rn()}}},rn=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,i,s,c,l,u,f,p,h,v,g,y,_,b,I,x,T,k=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=k.length>0&&void 0!==k[0]?k[0]:0,t&&Rn(),n=null,o=d.getState(),i=o.productBasicInfo,s=o.orderBasicInfo,c=void 0===s?{}:s,l=o.shoppingId,u=o.selectIds,f=o.passengerObj,p=o.duplicationCheckParamsOfTest,h=i||{},v=h.ProductCategoryId,g=c.DepartureDate,y=c.ReturnDate,_=[],u.map((function(e){var t=Zt(e,f);_.push(t)})),e.prev=8,b={ProductCategoruId:v,TakeOffDate:g,ReturnDate:y,PassengerList:_,ShoppingId:l},vr&&oe.includes(["239733157aef43a4b169b2c05e274576"],l)&&(b.duplicationCheckParamsOfTest=p||"result_has_duplicated"),e.next=13,r.post("CheckOrderDuplicated",b);case 13:n=e.sent,n&&"Success"==n.ResponseStatus.Ack&&n.Data&&n.Data.IsDuplicated&&n.Data.DuplicatedOrderInfo?(Dn(),I=n.Data,I.DuplicatedOrderInfo.OrderDate=ye.parse(I.DuplicatedOrderInfo.OrderDate,!1).format(),Ir({status:!0,options:I.DuplicatedOrderInfo}),Gt({desc:"\u91cd\u590d\u8ba2\u5355\u5f39\u5c42\u663e\u793a",key:"vac_30122"}),vr&&(x=m.UPDATE_ORDER_INFO,oe.includes(["239733157aef43a4b169b2c05e274576"],l)&&(T=b.duplicationCheckParamsOfTest,"result_has_duplicated"===T?T="result_has_duplicated_colse":"result_has_duplicated_colse"===T?T="result_has_duplicated_to_pay":"result_has_duplicated_to_pay"===T&&(T="result_ok"),x({duplicationCheckParamsOfTest:T})))):on(),e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](8),on(),console.log("errorinterface=========","duplicationCheck");case 21:case"end":return e.stop()}}),e,null,[[8,17]])})));return function(){return e.apply(this,arguments)}}(),on=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,r,o,i,s,c,l,u,f,p,m=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=m.length>0&&void 0!==m[0]?m[0]:0,t&&Rn(),n=d.getState(),r=n.tagInfo,o=n.train12306LoginData,i=n.selectIds,void 0===i?[]:i,n.passengerObj,n.Platform,s=r||{},c=s.isTrain,void 0!==c&&c,l=o||{},u=l.token,void 0===u?"":u,e.prev=5,e.next=8,x.bookLimitCheck({scene:4});case 8:f=e.sent,p=null===f||void 0===f?void 0:f.find((function(e){return 30001==(null===e||void 0===e?void 0:e.code)})),p&&p.limitReason?(Dn(),Tr({isShowAlertMask:!0,options:{typeName:"TrainBookingLimit",message:p.limitReason||"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u6c42\u8d85\u65f6",data:p}})):cn(),e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](5),cn(),console.log("errorinterface=========","bookLimitCheck");case 17:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(){return e.apply(this,arguments)}}(),cn=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,i,s,c,l,u,f,p,m=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=m.length>0&&void 0!==m[0]?m[0]:0,console.log(t),t&&Rn(),n=d.getState(),o=n.tagInfo,i=n.train12306LoginData,s=o||{},c=s.isTrain,l=void 0!==c&&c,u=i||{},f=u.userName,!l){e.next=20;break}if(p=!1,"function"!==typeof r.get12306NoticeStatus){e.next=12;break}return e.next=11,r.get12306NoticeStatus(f);case 11:p=e.sent;case 12:if(console.log("\ud83e\udd76isNotice",p),p){e.next=16;break}return pn(),e.abrupt("return");case 16:Dn(),Tr({isShowAlertMask:!0,options:{typeName:"Train12306Time",title:"\u5360\u5ea7\u63d0\u793a",message:"\u6bcf\u4e2a 12306 \u8d26\u53f7\u6bcf\u5929\u53ea\u80fd\u8fdb\u884c 3 \u6b21\u5360\u4f4d\uff0c\u7ee7\u7eed\u9884\u8ba2\u5c06\u6d88\u8017 1 \u6b21\u5360\u4f4d\u673a\u4f1a\uff0c\u8bf7\u60a8\u786e\u8ba4\u4fe1\u606f\u65e0\u8bef\u540e\u518d\u7ee7\u7eed"}}),e.next=21;break;case 20:pn();case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pn=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,s,c,l,u,f,p,h,v,g,y,_,b,I,x,T,k,S,C,w,N,E,P,j,O,D,R,A,M,V,L,B,U=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=U.length>0&&void 0!==U[0]?U[0]:0,t&&Rn(),n=m.UPDATE_ORDER_INFO,o=d.getState(),s=o.shoppingId,c=void 0===s?"":s,l=o.memberinfo,u=void 0===l?{}:l,f=o.ContactInfo,p=void 0===f?{}:f,h=u||{},v=h.isNeedRegiHotel,g=void 0!==v&&v,y=h.mgrGroup,_=void 0===y?{}:y,b=h.mgrGroupIds,I=void 0===b?[]:b,x=h.acceptTime,T=void 0===x?"":x,!g){e.next=49;break}if(k=(0,i.Z)((0,i.Z)({},p),{},{MobilePhone:p.Moblie,IDNumber:p.ContactIDCardNumber,IDType:!!p.IdCardType&&we[p.IdCardType]||"",Gender:0===p.Gender?"Male":1===p.Gender?"Female":""}),S=[],I.forEach((function(e){var t=_[e],n=t.privacyTerms,r=void 0===n?[]:n,a=t.cNSurname,o=void 0===a?"":a,s=t.eNLastName,c=void 0===s?"":s,l=t.groupMembershipCode,u=void 0===l?"":l;if(!o&&!c&&!u){var d=r&&r.map((function(e){return{Name:e.privacyTermsName,SerialNO:e.agreementNo,AcceptTime:T}}));S.push((0,i.Z)((0,i.Z)({},k),{},{MgrGroupId:e,RegTerm:d}))}})),console.log("registerGroup=============",S),e.prev=10,!S||!S.length){e.next=39;break}return e.next=14,r.post("registerGroupMember",{ShoppingId:c,RegisterGroupMemberType:S});case 14:if(w=e.sent,sa({module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u9152\u5e97\u4f1a\u5458\u6ce8\u518c 20168/RegisterGroupMember",rootMessageId:null===w||void 0===w||null===(C=w.ResponseStatus)||void 0===C||null===(C=C.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===C?void 0:C.Value,jsonData:S}),N=w||{},E=N.MrgMemberUserInfos,P=void 0===E?[]:E,j=N.ResponseStatus,O=void 0===j?{}:j,!O||"Success"!==O.Ack){e.next=35;break}if(D={},R=[],A=oe.cloneDeep(u),M=A||{},V=M.mgrGroup,L=M.mgrGroupIds,B=!1,L.forEach((function(e){var t=P.find((function(t){return t.MgrGroupId===e}));t?t.Status&&1===+t.Status&&(t.CNSurname||t.ENLastName)?(V[e].cNName=t.CNName,V[e].cNSurname=t.CNSurname,V[e].eNLastName=t.ENLastName,V[e].eNFirstName=t.ENFirstName):t.GroupMembershipCode?(V[e].cNName=p.GivenNameCN,V[e].cNSurname=p.SurenameCN,V[e].eNLastName=p.Surname,V[e].eNFirstName=p.GivenName,V[e].groupMembershipCode=t.GroupMembershipCode):(t.Message&&t.ReturnCode&&(20001===+t.ReturnCode||20004===+t.ReturnCode?(D.Email||(D.Email=[]),D.Email.push(t.Message)):20002===+t.ReturnCode?(D.Moblie||(D.Moblie=[]),D.Moblie.push(t.Message)):R.push(t.Message)),B=!0):V[e].cNSurname||V[e].eNLastName||V[e].groupMembershipCode||(B=!0)})),A.isNeedRegiHotel=B,A.mgrGroup=V,n({memberinfo:A,ErrorContactMsg:(0,i.Z)({},D)}),!B){e.next=32;break}return Dn(),r.scrollToErrorPosition("ContactInfo"),R.length&&Tr({isShowAlertMask:!0,options:{typeName:"HotelRegisterErrorPop",messageList:R}}),e.abrupt("return");case 32:_n(),e.next=37;break;case 35:Dn(),Qr({typeName:"HotelRegisterError"});case 37:e.next=40;break;case 39:_n();case 40:e.next=47;break;case 42:e.prev=42,e.t0=e["catch"](10),Dn(),Qr({typeName:"HotelRegisterError"}),ca("HotelRegisterError",e.t0);case 47:e.next=50;break;case 49:_n();case 50:case"end":return e.stop()}}),e,null,[[10,42]])})));return function(){return e.apply(this,arguments)}}(),hn=function(){var e=d.getState(),t=e.userNotice,n=void 0===t?{}:t,r=e.Channels,a=void 0===r?{}:r,o=n||{},s=o.isShow,c=void 0!==s&&s,l=o.isSelect,u=void 0!==l&&l,f=o.isSelectAuthorize,p=void 0!==f&&f,h=o.isShowAuthorize,v=void 0!==h&&h,g=o.isReadAirClause,y=o.airlineClause,_=o.tipMessages,b=a||{},I=b.isBestone,x=void 0!==I&&I,T=-1;if(c&&!u||v&&!p){var k=m.UPDATE_ORDER_INFO;return k({userNotice:(0,i.Z)((0,i.Z)({},n),{},{isShowTip:!0})}),setTimeout((function(){x&&!g&&y&&y.length&&(T=_.findIndex((function(e){return 0===e.key.indexOf("fly_")}))),Wr({status:!0,options:{actionFrom:"save",curTabIndex:T>=0?T:null}})}),200),void Dn()}qt()},_n=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,r,o,i=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=i.length>0&&void 0!==i[0]?i[0]:0,t&&Rn(),n=d.getState(),r=n.InsNeedPayStatus,o=void 0!==r&&r,o?(Dn(),Ur(!0),In(2,{callback:function(e){Pn(e)},scenes:"InsConfirm"})):In(1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),In=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,o){var s,c,l,u,f,p,h,v,g,y,_,b,I,x,T,k,S,C,w,N,E,P,j,O,D,A,M,V,L,B,U,Z,F,G,H,q,K,z,Y,W,$,X,J,Q,ee,te,ne,re,ae,ie,se,ce,le,ue,de,fe,pe,me,he,ve,ge,ye,_e,be,Ie,xe,Te,ke,Se,Ce,we,Ne,Ee,Pe,je,Oe,De,Ae,Me,Ve,Le,Be,Ue,Ze,Fe,Ge,He,qe,Ke,ze;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s=m.UPDATE_ORDER_INFO,c=d.getState(),l=c.query,u=c.serverFrom,f=c.appVersion,p=c.passengerObj,h=c.selectIds,v=void 0===h?[]:h,g=c.shoppingId,y=c.tagInfo,_=void 0===y?{}:y,b=c.ContactInfo,I=void 0===b?{}:b,x=c.ResourcePassengerMapList,T=void 0===x?[]:x,k=c.sharedRoomInfo,S=void 0===k?{}:k,C=c.customerRequirement,w=c.ResourcePassengers,N=c.DestinationAddress,E=c.OrderInvoice,P=c.OrderDelivery,j=c.PolicyHolder,O=c.replayToken,D=c.train12306LoginData,A=c.hotelMainGuest,M=c.transferInfo,V=c.TrainPassengerMapList,L=void 0===V?[]:V,B=c.RemindInfo,U=c.confirmDateTime,Z=c.userNotice,F=c.FareRemark,G=c.saveOrderOfTest,H=c.productBasicInfo,q=l||{},K=q.restore,z=void 0===K?"":K,Y=_.isPaidFirst,W=_.isTrain,$=void 0!==W&&W,X=_.isContainInsurance,J=void 0!==X&&X,Q=I.Moblie,ee=H.mainProductId,te=void 0===ee?0:ee,o&&"InsConfirm"!==o.scenes&&r.showMaskLoading({text:"\u8bf7\u6c42\u4e2d...",cancelable:!1},(function(){})),ne={},ne.HeadTagList=[{Key:"is_new_booking",Value:1}],!r.get||!te){e.next=14;break}return e.next=12,r.get("ctm_ref_".concat(te));case 12:re=e.sent,re&&ne.HeadTagList.push({Key:"ctm_ref",Value:re});case 14:if(ae=r.getHeadTagList&&r.getHeadTagList({appVersion:f}),ae&&ae.length&&(ne.HeadTagList=ne.HeadTagList.concat(ae)),ne.ShoppingId=g,ie=1,ie=t?2===t?10:!0===Y?7:8:4,ne.RequestType=ie,z&&1===+z&&(ne.IsContinueBook=!0),ne.OrderBasicInfo={Remark:(null===C||void 0===C?void 0:C.Remark)||"",IsQuickBooking:!1,IsNullClientOption:!1,ServerFrom:u,TimeZone:60*(new Date).getTimezoneOffset()*-1},se=v.map((function(e){return p[e]})),ce=[],le=!0,oe.forEach(se,(function(e){if(le){var n=Dt(e),a=n.passenger,o=n.missItems;if(o.length){if(t){var i,s,c=(null===a||void 0===a?void 0:a.CnName)||"";!c&&null!==a&&void 0!==a&&null!==(i=a.EnName)&&void 0!==i&&i.Last&&null!==a&&void 0!==a&&null!==(s=a.EnName)&&void 0!==s&&s.First&&(c="".concat(a.EnName.Last,"/").concat(a.EnName.First)),r.showToast("\u51fa\u884c\u4eba".concat(c,"\u7684\u4fe1\u606f\u6709\u7f3a\u5931\uff0c\u8bf7\u8865\u5145")),r.scrollToErrorPosition("Traveler")}return le=!1,void na("o_vac_order_bbz_passenger_error",{desc:"\u4e0b\u5355\u51fa\u884c\u4eba\u6709\u7f3a\u5931\u9879",passenger:a,missItems:o,bookOption:t})}ce.push(a)}})),le){e.next=31;break}return oa(),Dn(1),Ur(!1),e.abrupt("return");case 31:return w&&(ue=[],w.map((function(e){e&&e.ResourceInfo&&51===e.ResourceInfo.ResourceType&&ue.push(e.ResourceInfo.Token)})),ue.length&&T&&T.map((function(e){oe.includes(ue,e.ResourceToken)&&e.PassengerTokenList&&e.PassengerTokenList.map((function(e){ce.map((function(t){+t.PassengerId!==+e||t.MobilePhone||(t.MobilePhone=Q)}))}))}))),S&&S.status&&ce.map((function(e){e.PassengerId===String(S.passengerId)&&(e.IsRoomAssign=!0)})),ce.map((function(e){e.PassengerId&&String(e.PassengerId).indexOf("tempid")>-1&&(e.PassengerId=0)})),ne.PassengerInfoList=ce,I.Name||(I.SurenameCN?I.Name=I.SurenameCN+I.GivenNameCN:I.Surname&&(I.Name=I.Surname+" "+I.GivenName)),ne.ContactInfo=(0,i.Z)((0,i.Z)({},I),{},{Mobile:I.Moblie}),N&&N.StateCode&&(de=(0,i.Z)({},N),de.CountryCode="US",ne.ContactInfo.DestinationAddress=de),fe=T&&(0,R.Z)(T)||[],pe=A||{},me=pe.count,he=pe.mainGuestInfo,me&&me>0&&he.map((function(e){if(e.MainGuestCount&&e.MainGuestCount>0){var t=v.filter((function(t,n){return n<e.MainGuestCount}));fe.push({ResourceToken:e.RoomToken,PassengerTokenList:t.map(String)})}})),ne.ResourcePassengerMapList=fe||[],ne.TrainPassengerMapList=L||[],ne.OrderInvoice=E,ne.DeliveryInfo=P,$&&(ve=D||{},ge=ve.token,ye=ve.userName,ne.HeadTagList.push({Key:"TrainUserToken",Value:ge},{Key:"AccountNumber",Value:ye})),ne.CustomerRequirement=t?C:null,j&&j.Name&&(ne.InsuranceHolder=j),o&&"InsBack"===o.scenes&&(ne.ReplayToken=O,ne.IsContinueBook=!0),_e=r.getSaveOrderRequestParams&&r.getSaveOrderRequestParams(d.getState(),o),oe.isEmpty(_e)||(ne=(0,i.Z)((0,i.Z)({},ne),_e)),be=(null===C||void 0===C?void 0:C.Remark)||"",M&&M.remark&&M.remark.length&&(Ie="".concat(be?"|":"").concat(M.remark.join("|")),Re-be.length>=Ie.length&&(be+=Ie)),console.log("\ud83e\udd21Remark",be),ne.OrderBasicInfo.Remark=be,vr&&(oe.includes(["239733157aef43a4b169b2c05e274576"],g)&&(xe=["transfer_remark","ack_error","canbooking_pricechange","canbooking_coupon","bookerror","order_complete","ack_success"],Te=xe.indexOf(G),ne.saveOrderOfTest=xe[Te+1],s({saveOrderOfTest:ne.saveOrderOfTest})),oe.includes(["7d0a2efe93c84bcb807a92dc56910217"],g)&&(ke=["ack_error","canbooking_pricechange","1605_error","presale_time","presale_inventory","bookerror"],Se=ke.indexOf(G),ne.saveOrderOfTest=ke[Se+1],s({saveOrderOfTest:ne.saveOrderOfTest})),oe.includes(["297725b6c6ed469da244c7c52f41f590"],g)&&(Ce=["train_error_1","success"],we=Ce.indexOf(G),ne.saveOrderOfTest=Ce[we+1],s({saveOrderOfTest:ne.saveOrderOfTest})),n.g.__orderRequest=ne,console.log("\ud83e\udd21orderRequest",JSON.stringify(ne,null,2))),e.prev=56,e.next=59,r.post("SaveOrder",ne,{needErrorInfo:!0,needEncrypt:!0});case 59:if(Ne=e.sent,1!==t&&2!==t||(Pe=Ne.ResponseStatus&&Ne.ResponseStatus.Errors&&Ne.ResponseStatus.Errors[0],je=Pe||{},Oe=je.ErrorCode,De=void 0===Oe?"":Oe,sa({module:"\u63a5\u53e3\u8bf7\u6c42",scene:1===t?"\u4e0b\u5355\u63a5\u53e3":"\u4e0b\u5355\u63a5\u53e3-\u521b\u5efa\u4fdd\u4ee3\u524d\u4fdd\u5b58\u9875\u9762\u4fe1\u606f",rootMessageId:null===Ne||void 0===Ne||null===(Ee=Ne.ResponseStatus)||void 0===Ee||null===(Ee=Ee.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===Ee?void 0:Ee.Value,key:De})),!Ne||"Success"!==Ne.ResponseStatus.Ack){e.next=87;break}if(Ae=Ne.Data,1!==t){e.next=84;break}if(Me=Ae.OrderId,Ve=Ae.CanBookingInfo,Le=Ae.ErrorInfo,Be=Ae.NeedCallPolling,!Ve||Ve.IsSuccess){e.next=70;break}return Dn(1),oa(),Tn(Ae,ne),e.abrupt("return");case 70:if(!Le||!Le.ErrorMessage){e.next=75;break}return Dn(1),oa(),Sn(Ae),e.abrupt("return");case 75:if(Me&&(r.tracelog("grp_orddetail_paygetord_click",{orderid:Me+"",trainticket:$?1:0}),Ue=B||{},Ze=Ue.RemindMessageList,Fe=void 0===Ze?[]:Ze,Ge=[],Fe&&Fe.length&&(Ge=(0,R.Z)(Fe)),U?Ge.push("\u652f\u4ed8\u5b8c\u6210\u540e\uff0c\u8ba2\u5355\u4f1a\u5728".concat(U,"\u786e\u8ba4\u7ed3\u679c")):Y?Ge.push("\u652f\u4ed8\u5b8c\u6210\u540e\uff0c\u8ba2\u5355\u4f1a\u7acb\u5373\u786e\u8ba4"):Ge.push("\u63d0\u4ea4\u8ba2\u5355\u540e\uff0c\u8ba2\u5355\u4f1a\u7acb\u5373\u786e\u8ba4"),He=Z||{},qe=He.isShowOldMan,Ke=void 0!==qe&&qe,Ke&&!J&&Ge.push("\u4e3a\u51fa\u884c\u589e\u6dfb\u4fdd\u969c\uff0c\u5efa\u8bae\u60a8\u8d2d\u4e70\u65c5\u6e38\u610f\u5916\u9669\u3002"),oe.isEmpty(F)||Ge.push("\u60a8\u9009\u62e9\u7684\u822a\u73ed\u9000\u6539\u7b7e\u53ef\u80fd\u6709\u53d8\u5316\uff0c\u8bf7\u70b9\u51fb\u67e5\u770b"),ia({desc:"\u9875\u9762\u5e95\u90e8\u8bdd\u672f",contents:Ge.map((function(e,t){return{key:t+"",value:e}}))})),!Be||10===ie){e.next=81;break}return Dn(1),oa(),Cn(Ae,ne),e.abrupt("return");case 81:xn(Ae),e.next=85;break;case 84:2===t&&o&&o.callback&&o.callback({orderRequest:ne,jsonData:Ae});case 85:e.next=89;break;case 87:Dn(1),1!==t&&2!==t||(oa(),console.log("errorinterface=========","saveOrder/warning"),2===t&&Ur(!1),ze="\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u91cd\u8bd5",Ne&&Ne.ResponseStatus&&Ne.ResponseStatus.Errors&&Ne.ResponseStatus.Errors[0]&&Ne.ResponseStatus.Errors[0].Message&&(ze=Ne.ResponseStatus.Errors[0].Message),r.showToast(ze));case 89:e.next=96;break;case 91:e.prev=91,e.t0=e["catch"](56),Dn(1),1!==t&&2!==t||(console.log("errorinterface=========","saveOrder"),2===t&&Ur(!1),Qr({typeName:"SaveOrderError",operationData:o})),e.t0.isNetError||ca("SaveOrder-".concat(t),e.t0);case 96:case"end":return e.stop()}}),e,null,[[56,91]])})));return function(t,n){return e.apply(this,arguments)}}(),xn=function(e){var t=e.PaymentParameterInfo;if(oa(),!t.IsPaidFirst||0===t.Amount)return Dn(1),void r.goSuccessBack((0,i.Z)((0,i.Z)({},d.getState()),{},{payInfo:e}));Dn(1),r.pay(e,d.getState())},Tn=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,r,o,i,s,c,l,u,d,f,p=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=p.length>1&&void 0!==p[1]?p[1]:{},r=t||{},o=r.CanBookingInfo,i=void 0===o?{}:o,s=i||{},c=s.CanBookingResults,l=void 0===c?[]:c,u=s.TokenInfoList,d=void 0===u?[]:u,f=l&&l[0],na("o_vac_order_save_canbooking",f||{}),!(f&&f.Code&&f.Message)){e.next=14;break}if("invalid_pricechange"!==f.Code){e.next=9;break}return xr({status:!0,options:{typeName:"PriceChange",errorMessage:f.Message,data:t,orderRequest:n}}),e.abrupt("return");case 9:if("invalid_promotion"!==f.Code){e.next=13;break}return Xe(),xr({status:!0,options:{typeName:"PromotionChange",errorMessage:f.Message}}),e.abrupt("return");case 13:Tr({isShowAlertMask:!0,options:{typeName:"CanBookingError",message:null===f||void 0===f?void 0:f.Message,code:null===f||void 0===f?void 0:f.Code,tokenInfoList:d||[]}});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),kn=function(e,t){var n=[];oe.forEach(e,(function(e){n.push(e.Token)}));var a=m.UPDATE_PASSENGER_INFO;a({ErrorCanBookingToken:[].concat(n),ErrorCanBookingMessge:t||""});var o=n[0],i=d.getState(),s=i.resourceinfo,c=s[We.INSURANCE]||{},l=c.specialTokens,u=void 0===l?{}:l,f=u||{},p=f.levleCancleTokens,h=void 0===p?[]:p,v=f.svipCancellation,g=void 0===v?[]:v;h&&oe.includes(h,o)||g&&oe.includes(g,o)?r.scrollToErrorPosition("UserLevelInsurance"):r.scrollToErrorPosition(o)},Sn=function(e){var t=d.getState(),n=t.productBasicInfo,r=e.ErrorInfo,a=void 0===r?{}:r;a&&a.ErrorMessage&&a.Buttons||(a={ErrorMessage:"\u62b1\u6b49\uff0c\u60a8\u9009\u62e9\u7684\u8d44\u6e90\u9884\u8ba2\u5931\u8d25\u3002",Buttons:[{Name:"\u91cd\u9009\u8d44\u6e90",ActionPage:3}]}),na("o_vac_order_save_error",a),xr({status:!0,options:{typeName:"BookError",data:(0,i.Z)({},e),ProductBasicInfo:(0,i.Z)({},n)}})},Cn=function(e,t){var n=e.TransactionId,r=e.OrderId,a=t.PaymentParameter,o=d.getState(),s=o.shoppingId,c=o.TrainList,l=void 0===c?[]:c,u=o.Platform,f=o.train12306LoginData,p=o.Channels,h=void 0===p?{}:p,v=m.TOGGLE_ALERT_MASK;Nr({status:!0,options:{PassengerInfoList:t.PassengerInfoList,ResourceInfo:{TrainList:l}}}),En({TransactionId:n,OrderId:r,PaymentParameter:a,ShoppingId:s}).then((function(e){var t;Nr({status:!1,options:null});var n=e||{},a=n.error,o=n.Data,s=void 0===o?{}:o,c=n.ResponseStatus,l=void 0===c?{}:c,d=l||{},p=d.Errors,m=void 0===p?[]:p,g=m&&m[0];sa({module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u706b\u8f66\u7968\u8f6e\u8bad\u7ed3\u675f 12448/SaveOrderCallback",rootMessageId:null===e||void 0===e||null===(t=e.ResponseStatus)||void 0===t||null===(t=t.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===t?void 0:t.Value,key:g&&g.ErrorCode});var y=s||{},_=y.ResultCode,b=y.ErrorInfo,I=void 0===b?{}:b;if(a||_<0)Tr({isShowAlertMask:!0,options:{message:"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u6c42\u8d85\u65f6",typeName:"SaveOrderError"}});else if(_>=0){if(0===_)return void xn(s);var x=I.ErrorCode,T=I.ErrorMessage;if([10003,10004].includes(x))if(u===_e.CTRIPWX)qr({status:!0,options:{message:T}});else if(u===_e.CTRIPH5){var k=h||{},S=k.isBestone,C=void 0!==S&&S,w=k.isBestoneMiniProgram,N=void 0!==w&&w,E=k.isInCBP,P=void 0!==E&&E;C||N||P?v({isShowAlertMask:!0,options:{title:T||"",typeName:"TrainOrderError",code:x,message:"\u8bf7\u767b\u5f55\u94c1\u8def12306\u5b98\u7f51\u621612306\u5b98\u65b9APP\uff0c\u5728\u201d\u4e2a\u4eba\u4e2d\u5fc3-\u4e58\u8f66\u4eba\u7ba1\u7406\u201c\u4e2d\u4fee\u6539\u540e\u518d\u6b21\u63d0\u4ea4\u8ba2\u5355\u3002"}}):qr({status:!0,options:{message:T,orderid:r}})}else v({isShowAlertMask:!0,options:{typeName:"TrainOrderError",code:2===_?99999:x,message:T||"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u6c42\u8d85\u65f6",data:(0,i.Z)((0,i.Z)({},s),{},{train12306LoginData:f})}});else v({isShowAlertMask:!0,options:{typeName:"TrainOrderError",code:2===_?99999:x,message:T||"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u6c42\u8d85\u65f6",data:(0,i.Z)((0,i.Z)({},s),{},{train12306LoginData:f})}})}else v({isShowAlertMask:!0,options:{message:"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u6c42\u8d85\u65f6",typeName:"SaveOrderError"}})})).catch((function(){Nr({status:!1,options:null}),Tr({isShowAlertMask:!0,options:{message:"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u6c42\u8d85\u65f6",typeName:"SaveOrderError"}})}))},En=function(e){return console.log("params",e),new Promise((function(t,n){var i,s=Date.now(),c=2e3,l=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(o){var u,d,f,p,m;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i&&clearTimeout(i),u=function(){i=setTimeout((function(){l(o)}),c)},e.prev=2,e.next=5,r.post("SaveOrderCallback",o);case 5:if(d=e.sent,f=d.Data,p=Date.now()-s,!(p>3e5)){e.next=11;break}return n({error:1,duration:p}),e.abrupt("return");case 11:if(!f.NeedCallPolling){e.next=14;break}return u(),e.abrupt("return");case 14:t(d),e.next=22;break;case 17:e.prev=17,e.t0=e["catch"](2),m=Date.now()-s,m>3e5&&n({error:1,duration:m}),u();case 22:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t){return e.apply(this,arguments)}}();l(e)}))},Pn=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,o,i,s,c,l,u,f,p,m,h,v,g,y,_,b,I,x,T,k,S,C,w,N,E,P;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=d.getState(),o=n.shoppingId,i=void 0===o?"":o,s=n.Platform,c=n.priceDetail,l=void 0===c?{}:c,u=n.resourceinfo,f=void 0===u?{}:u,p=n.passengerObj,void 0===p?{}:p,m=n.isInCtripApp,h=n.Channels,v=t.orderRequest,g=void 0===v?{}:v,y=t.jsonData,_=void 0===y?{}:y,b=g.PassengerInfoList,I=void 0===b?[]:b,x=g.ResourcePassengerMapList,T=void 0===x?[]:x,k={},S=I.map((function(e){var t=e.CnName,n=e.EnName,r=void 0===n?{}:n,a=e.IdCardInfo,o=void 0===a?[]:a,i=e.Birthday,s=e.AgeRang,c=e.PassengerId,l=t||"".concat(r.Last,"/").concat(r.First),u=o&&o[0],d=i&&Fe(i,null)||-1;!k.Name&&1===s&&d>=18&&(k.Name=l,k.Birthday=i,null!==u&&void 0!==u&&u.IdCardType&&(k.CardType=+u.IdCardType,k.CardNo=u.IdCardNo)),k&&k.Name&&(k.IdCardType=k.CardType,k.IdCardNo=k.CardNo);var f={};return f.Name=l,f.Birthday=i,f.InsuredId=c,f.AgeType=d>=18?"ADU":"CHI",null!==u&&void 0!==u&&u.IdCardType&&(f.IdCardType=+u.IdCardType,f.IdCardNo=u.IdCardNo),f})),C=dn(f&&f[We.INSURANCE],T),w=un(f&&f[We.INSURANCE],l),N={ShoppingId:i,OrderId:null===_||void 0===_?void 0:_.OrderId,IsNeedCheckAvailable:!0,BizCode:"401",CallbackType:s===_e.CTRIPWX?4:1,HasInsureds:!0,PolicyHolderEditable:!0,PolicyHolder:k,InsuredInfoList:S,SelectedInsuranceInfoList:C,InsuranceInfoList:w},s===_e.CTRIPH5&&(E=r.getPayMentJumpUrl({sback:"",eback:""},{scenes:"InsBack"},null===_||void 0===_?void 0:_.OrderId),m||h&&h.isInZTApp?N.CallbackType=1:(N.CallbackType=2,N.ConfirmNotifyUrl=E.fback)),e.prev=9,e.next=12,r.post("BuildInsurance",N);case 12:P=e.sent,Ur(!1),0===(null===P||void 0===P?void 0:P.Result)&&null!==P&&void 0!==P&&P.Token&&null!==P&&void 0!==P&&P.ConfirmUrl?r.goInsuranceConfirm({token:P.Token,url:P.ConfirmUrl,orderId:null===_||void 0===_?void 0:_.OrderId,callback:function(e){jn(e)},eventName:1===N.CallbackType?"insConfirmBack":""}):null!==P&&void 0!==P&&P.CanBookingResults&&null!==P&&void 0!==P&&P.CanBookingResults.length?(Tn({CanBookingInfo:{CanBookingResults:P.CanBookingResults,TokenInfoList:P.TokenInfoList}}),r.traceDevLog("o_vac_order_save_build_ins",{result:P})):(r.showToast("\u7cfb\u7edf\u5f02\u5e38,\u8bf7\u91cd\u8bd5"),r.traceDevLog("o_vac_order_save_build_ins",{result:P})),e.next=22;break;case 17:e.prev=17,e.t0=e["catch"](9),r.showToast("\u7cfb\u7edf\u5f02\u5e38,\u8bf7\u91cd\u8bd5"),Ur(!1),ca("buildInsurance",e.t0);case 22:case"end":return e.stop()}}),e,null,[[9,17]])})));return function(t){return e.apply(this,arguments)}}(),jn=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,o,i,s,c,l,u,f,h,v,g,y,_,b,I,x,T,k,S,C,w,N,E,P,j,O,D;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t||{},o=n.token,i=void 0===o?"":o,s=n.orderId,c=void 0===s?0:s,l=n.status,u=void 0===l?0:l,1!==u){e.next=3;break}return e.abrupt("return");case 3:return aa(),f=d.getState(),h=f.shoppingId,v=void 0===h?{}:h,g=f.ResourcePassengerMapList,y=void 0===g?[]:g,_=f.resourceinfo,b=void 0===_?{}:_,I=f.shoppinginfo,x=void 0===I?{}:I,T=dn(b&&b[We.INSURANCE],y),Zr(!0),r.showMaskLoading(),e.prev=8,e.next=11,r.post("UpdateInsurance",{Token:i,ShoppingId:v,UpdateInsuranceType:1,OrderId:c,SelectedInsuranceInfoList:T,IsRemoveInsurance:2===u});case 11:k=e.sent,k&&0===k.Result&&k.ResponseStatus&&"Success"===k.ResponseStatus.Ack?(sa({module:"\u652f\u4ed8",scene:"\u4fdd\u4ee3\u56de\u6765\u68c0\u67e5\u4fdd\u9669",role:p.RoleType.sys,action:p.ActionType.change,value:k.IsInsuranceChange?"\u53d8\u5316":"\u6ca1\u6709\u53d8\u5316",rootMessageId:null===k||void 0===k||null===(S=k.ResponseStatus)||void 0===S||null===(S=S.Extension.find((function(e){return"RootMessageId"===e.Id})))||void 0===S?void 0:S.Value}),C=m.UPDATE_ORDER_INFO,r.hideMaskLoading(),w={},k.PolicyHolder&&k.PolicyHolder.Name&&(w.Name=k.PolicyHolder.Name,w.CardNo=k.PolicyHolder.IdCardNo,w.CardType=k.PolicyHolder.IdCardType,w.Birthday=k.PolicyHolder.Birthday),k.IsInsuranceChange?(N=oe.cloneDeep(x),E=N[We.INSURANCE]||{},P=fn(E,T,k.SelectedInsuranceInfoList),j=P.newshoppinginfo,O=P.deletetoken,N[We.INSURANCE]=j,D=y.filter((function(e){return!oe.includes(O,e.ResourceToken)})),C({PolicyHolder:w,shoppinginfo:N,Installment:null,replayToken:k.ReplayToken,ResourcePassengerMapList:D}),On()):(C({PolicyHolder:w,replayToken:k.ReplayToken}),In(1,{scenes:"InsBack"}))):(Dn(1),Qr({typeName:"NetWorkError"})),e.next=20;break;case 15:e.prev=15,e.t0=e["catch"](8),Dn(1),Qr({typeName:"NetWorkError"}),e.t0.isNetError||ca("insConfirmBack",e.t0);case 20:case"end":return e.stop()}}),e,null,[[8,15]])})));return function(t){return e.apply(this,arguments)}}(),On=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ue(5,{callback:function(){In(1,{scenes:"InsBack"})}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Dn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(1===e){var t=d.getState(),n=t.isShowFullBgMask,a=void 0!==n&&n;a&&Zr(!1)}r.hideMaskLoading(),vr?Xr(0):setTimeout((function(){Xr(0)}),350)},Rn=function(){r.showMaskLoading({text:"\u8bf7\u6c42\u4e2d...",cancelable:!1},(function(){})),Xr(1)},An=function(e,t){var n=d.getState(),a=n.selectedPromotion,o=void 0===a?{}:a;oe.isEmpty(t)&&(t={}),o&&2===o.useStatus&&(t.useCouponStatus=2),r.backToLastPage(t)},Mn=function(){var e=d.getState(),t=e.shoppingId,n=e.productBasicInfo,a=e.VendorInfo,o=e.IMEntryInfo,i=e.pageid;r.openIM&&r.openIM({shoppingId:t,productBasicInfo:n,vendorInfo:a,iMEntryInfo:o,pageid:i})},Vn=function(e){var t=m.UPDATE_ORDER_INFO;t({IMSatus:+e})},Ln=function(e){var t=d.getState(),n=t.Platform,a=m.UPDATE_ORDER_INFO;n===_e.CTRIPRN?(a({PassengerModalData:{content:e.message,buttons:[{type:"action",code:51001,text:"\u53d6\u6d88",style:"white",status:1001},{type:"action",code:51003,text:"\u66ff\u6362",style:"blue",status:e.status,tokens:e.tokens}]}}),r.showPassengerModal&&r.showPassengerModal()):Tr({isShowAlertMask:!0,options:{typeName:e.typeName,message:e.message.join(""),token:e.tokens}})},Bn=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n){var o,i,s,c,u,f,p,h,v,g,y;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=n.result,i=n.payload,s=d.getState(),c=s.Platform,u=m.UPDATE_ORDER_INFO,o){e.next=8;break}return"selectData"===t&&Zn(!1),"selectPassenger"===t&&Fn(!1),Un(!0),e.abrupt("return");case 8:if(f=i||{},p=f.recommendSearch,h=p||{},v=h.ShoppingId,I={},I.isNeedNewFetch=!0,l.shoppingid=v,c!==_e.CTRIPH5){e.next=18;break}g=lr.location.href.replace(/shoppingId=[^&]+/i,"shoppingId=".concat(v)),r.redirect(g),e.next=22;break;case 18:return y={isShowSelectDate:!1,isShowSelectPassenger:!1,isShowCreateShoppingErrorMask:!1,firstScreenStatus:1,shoppingId:v,forceReloadTimestamp:0,beforeForceReloadTimestamp:0,selectedPromotion:l&&"2"===l.usecouponstatus?{useStatus:2,couponInfo:null}:{}},u(y),e.next=22,T();case 22:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Un=function(e){var t=m.TOGLGLE_CREATE_SHOPPING_ERROR_MASK;t(e)},Zn=function(e){var t=m.TOGLGLE_SELECT_DATE_MASK;t(e)},Fn=function(e,t){var n=m.TOGGLE_SELECT_PASSENGER;n(e),e&&!t&&ta("grp_resource_psgnum_show",{scene:4})},Kn=function(e){var t=m.TOGGLE_TRAVELER_RULE_MASK;t(e),sa({module:"\u5f39\u5c42",scene:(e?"\u6253\u5f00":"\u5173\u95ed")+"\u9000\u6539\u89c4\u5219\u5f39\u5c42"})},zn=function(e){var t=m.TOGGLE_BOOKLIMIT_MASK;t(e),sa({module:"\u5f39\u5c42",scene:(e?"\u6253\u5f00":"\u5173\u95ed")+"\u9884\u8ba2\u9650\u5236\u5f39\u5c42"})},Yn=function(e){var t=m.TOGGLE_TRAINDETAIL_MASK;t(e),sa({module:"\u5f39\u5c42",scene:(e?"\u6253\u5f00":"\u5173\u95ed")+"\u8f66\u6b21\u8be6\u60c5\u5f39\u5c42"})},Wn=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n){var o,i,s,c,l,u,f,h,v,g,y,_,I;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=d.getState(),i=o.trainChildPassengerIds,s=o.selectIds,c=o.passengerObj,l=o.TrainPassengerMapList,u=m.UPDATE_CHILD_TYPE,m.UPDATE_ORDER_INFO,f=(0,R.Z)(i),h=oe.cloneDeep(c),v=oe.cloneDeep(l),g={},s.forEach((function(e){+e===+t&&(g=h[e])})),!oe.isEmpty(g)){e.next=9;break}return e.abrupt("return");case 9:if(g.Height!==n){e.next=11;break}return e.abrupt("return");case 11:if(n!==Pe.free){e.next=20;break}if(y=0,_=0,f.forEach((function(e){var t=h[e]||{},n=(t.AgeRang,t.Height),r=void 0===n?"":n;r===Pe.free&&y++})),s.map((function(e){var t=h[e];1===t.AgeRang&&_++})),!(y>=_)){e.next=18;break}return r.showToast("1\u4f4d\u6210\u4eba\u6700\u591a\u53ef\u5e261\u540d\u514d\u8d39\u4e58\u8f66\u513f\u7ae5"),e.abrupt("return");case 18:e.next=21;break;case 20:v&&v.length&&(v=v.filter((function(e){return+e.ChildPassengerToken!==+t})));case 21:return h[t].Height=n,I=0,s.forEach((function(e){var t=h[e];[Pe.adult,Pe.child].includes(t.Height)&&I++})),u({passengerObj:h,trainSeatNum:I,TrainPassengerMapList:v}),b.updatePrice={module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u706b\u8f66\u7968\u79cd\u53d8\u66f4\u5bfc\u81f4\u4ef7\u683c\u53d8\u5316 ",action:p.ActionType.change},e.next=28,Ue(3);case 28:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),$n=function(e){var t=m.TOGGLE_TRAINSELECTPERSON_MASK,n=e.status,r=e.selectedPassenger,a=e.currentValue;if(n)t({isShowTrainSelectPersonMask:!0,selectedPassenger:r}),sa({module:"\u5f39\u5c42",scene:"\u6253\u5f00\u9009\u62e9\u5173\u8054\u53d6\u7968\u4eba\u5f39\u5c42",role:p.RoleType.usr,action:p.ActionType.click,value:r.CNName||r.PassengerID});else{if(!a)return t({isShowTrainSelectPersonMask:!1,selectedPassenger:null}),void sa({module:"\u5f39\u5c42",scene:"\u5173\u95ed\u9009\u62e9\u5173\u8054\u53d6\u7968\u4eba\u5f39\u5c42"});var o=d.getState(),i=o.selectedPassenger,s=o.passengerObj,c=o.TrainPassengerMapList,l=void 0===c?[]:c,u=o.trainErrorPassengerList,f=void 0===u?[]:u,h=i.PassengerID;if(oe.isEmpty(l)){var v,g=(null===f||void 0===f?void 0:f.filter((function(e){return+e!==+h})))||[];t({isShowTrainSelectPersonMask:!1,selectedPassenger:null,TrainPassengerMapList:[{AdultPassengerToken:a+"",ChildPassengerToken:h+""}],trainErrorPassengerList:g}),sa({module:"\u5f39\u5c42",scene:"\u5173\u95ed\u9009\u62e9\u5173\u8054\u53d6\u7968\u4eba\u5f39\u5c42",role:p.RoleType.usr,action:p.ActionType.change,value:s&&(null===(v=s[a])||void 0===v?void 0:v.CNName)||a,jsonData:{selectedPassenger:null,TrainPassengerMapList:[{AdultPassengerToken:a+"",ChildPassengerToken:h+""}]}})}else{var y,_=!1,b=!1,I=l.map((function(e){return+e.ChildPassengerToken===h&&(_=!0,+e.AdultPassengerToken!==a&&(b=!0,e.AdultPassengerToken=a+"")),e}));if(_||I.push({AdultPassengerToken:a+"",ChildPassengerToken:h+""}),_&&!b)return;var x=(null===f||void 0===f?void 0:f.filter((function(e){return+e!==+h})))||[];t({isShowTrainSelectPersonMask:!1,selectedPassenger:null,TrainPassengerMapList:I,trainErrorPassengerList:x}),sa({module:"\u5f39\u5c42",scene:"\u5173\u95ed\u9009\u62e9\u5173\u8054\u53d6\u7968\u4eba\u5f39\u5c42",role:p.RoleType.usr,action:p.ActionType.change,value:s&&(null===(y=s[a])||void 0===y?void 0:y.CNName)||a,jsonData:{selectedPassenger:null,TrainPassengerMapList:I}})}}},Qn=function(e){var t=m.TOGGLE_TRAIN_HEIHGT_MASK;t(e)},tr=function(e){var t=d.getState(),n=t.selectIds,a=t.passengerObj,o=!0;if(!oe.isEmpty(n)&&n.map((function(e){var t=a[e];!o||null!==t&&void 0!==t&&t.Height||(o=!1)})),o){var i=m.TOGGLE_TRAINSELECTSEAT_MASK;i(e),sa({module:"\u5f39\u5c42",scene:(e?"\u6253\u5f00":"\u5173\u95ed")+"\u9009\u62e9\u5ea7\u4f4d\u5f39\u5c42"})}else r.showToast("\u8bf7\u5148\u9009\u62e9\u706b\u8f66\u7968\u7968\u79cd\u7c7b\u578b")},ir=function(e){var t=m.TOGGLE_DELIVERYINFO_MASK;t(e),sa({module:"\u5f39\u5c42",scene:(e?"\u6253\u5f00":"\u5173\u95ed")+"\u914d\u9001\u6750\u6599\u6e05\u5355\u5f39\u5c42"})},sr=function(e){var t=m.TOGGLE_DELIVERYTYPE_MASK,n=e.status,r=e.currentValue,a=e.index;if(n)t({isShowDeliveryTypeMask:!0}),sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u914d\u9001\u65b9\u5f0f\u5f39\u5c42"});else{var o=d.getState(),s=o.OrderDelivery,c=o.formatDlyData;if(!r)return t({isShowDeliveryTypeMask:!1}),void sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u914d\u9001\u65b9\u5f0f\u5f39\u5c42"});var l=(0,i.Z)({},s),u=l.DeliveryType,f=l.IsUseIntegral,p=0;f&&(p=1),r==u&&a==p||(2!==u&&1!==u&&1!==r&&2!==r||(l.AddressInfo={}),l.DeliveryType=r,l.IsUseIntegral=!!a,2===r&&c&&c.selfPickupAddress&&(l.AddressInfo={},l.AddressInfo.Address=c.selfPickupAddress[0]),t({isShowDeliveryTypeMask:!1,OrderDelivery:l}),sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u914d\u9001\u65b9\u5f0f\u5f39\u5c42",jsonData:{OrderDelivery:l}}))}},cr=function(e){var t=m.TOGGLE_DELIVERYADDRESS_MASK,n=e.status,r=e.currentValue;if(n)t({isShowDeliveryAddressMask:!0}),sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u914d\u9001\u5730\u5740\u5f39\u5c42"});else{if(!r)return t({isShowDeliveryAddressMask:!1}),void sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u914d\u9001\u5730\u5740\u5f39\u5c42"});var a=d.getState(),o=a.OrderDelivery,s=void 0===o?{}:o,c=(0,i.Z)({},s),l=c.AddressInfo;l&&l.Address===r||(c.AddressInfo={},c.AddressInfo.Address=r,t({isShowDeliveryAddressMask:!1,OrderDelivery:c}),sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u914d\u9001\u5730\u5740\u5f39\u5c42",jsonData:{OrderDelivery:c}}))}},yr=function(e){var t=m.TOGGLE_RESOURCESELECTPERSON_MASK,n=m.UPDATE_ORDER_INFO,r=e.status,a=e.selectedToken,o=e.currentValue;if(r){var i;t({isShowResourceSelectPersonMask:!0,selectedToken:a});var s=d.getState(),c=s.ResourcePassengers,l=void 0===c?[]:c,u=l&&l.find((function(e){return e.ResourceInfo&&e.ResourceInfo.Token===a}));sa({module:"\u5f39\u5c42",scene:"\u6253\u5f00\u8d44\u6e90\u5173\u8054\u51fa\u884c\u4eba\u5f39\u5c42",role:p.RoleType.usr,action:p.ActionType.click,value:"".concat((null===u||void 0===u||null===(i=u.ResourceInfo)||void 0===i?void 0:i.ResourceName)||a)})}else{if(!o)return t({isShowResourceSelectPersonMask:!1,selectedToken:null}),void sa({module:"\u5f39\u5c42",scene:"\u5173\u95ed\u8d44\u6e90\u5173\u8054\u51fa\u884c\u4eba\u5f39\u5c42"});var f=d.getState(),h=f.selectedToken,v=f.ResourcePassengerMapList,g=void 0===v?[]:v,y=f.ErrorTokenList,_=void 0===y?[]:y,b=f.passengerObj,I=void 0===b?{}:b,x=oe.indexOf(_,h);if(x>-1){var T=(0,R.Z)(_);T.splice(x,1),n({ErrorTokenList:(0,R.Z)(T)})}var k=o.map((function(e){return Zt(e,I)}));if(oe.isEmpty(g))t({isShowResourceSelectPersonMask:!1,selectedToken:null,ResourcePassengerMapList:[{ResourceToken:h,PassengerTokenList:(0,R.Z)(o)}]}),sa({module:"\u5f39\u5c42",scene:"\u5173\u95ed\u8d44\u6e90\u5173\u8054\u51fa\u884c\u4eba\u5f39\u5c42",value:"".concat(k.join(","),"\uff08").concat(o.join(","),"\uff09"),role:p.RoleType.usr,action:p.ActionType.change,jsonData:{selectedToken:null,ResourcePassengerMapList:[{ResourceToken:h,PassengerTokenList:(0,R.Z)(o)}]}});else{var S=!1,C=g.map((function(e){return e.ResourceToken===h&&(S=!0,e.PassengerTokenList=(0,R.Z)(o)),e}));S||C.push({ResourceToken:h,PassengerTokenList:(0,R.Z)(o)}),t({isShowResourceSelectPersonMask:!1,selectedToken:null,ResourcePassengerMapList:C}),sa({module:"\u5f39\u5c42",scene:"\u5173\u95ed\u8d44\u6e90\u5173\u8054\u51fa\u884c\u4eba\u5f39\u5c42",value:"".concat(k.join(","),"\uff08").concat(o.join(","),"\uff09"),role:p.RoleType.usr,action:p.ActionType.change,jsonData:{selectedToken:null,ResourcePassengerMapList:C}})}}},_r=function(e){var t=m.TOGGLE_CRUISESELECTPERSON_MASK,n=m.UPDATE_ORDER_INFO,r=e.status,a=e.selectedToken,o=e.currentValue;if(r){t({isShowCruiseSelectPersonMask:!0,selectedToken:a});var s=d.getState(),c=s.cruise,l=c.find((function(e){return oe.includes(e.cabinIds,a)}))||{},u=l||{},f=u.cabinIds,h=u.Basic,v=f.indexOf(a)+1;sa({module:"\u5f39\u5c42",scene:"\u6253\u5f00\u90ae\u8f6e\u4ed3\u623f\u5173\u8054\u51fa\u884c\u4eba\u5f39\u5c42",role:p.RoleType.usr,action:p.ActionType.click,value:null!==h&&void 0!==h&&h.Name?"".concat(h.Name,"\uff08\u7b2c").concat(v,"\u95f4\uff09"):a})}else{if(!o)return t({isShowCruiseSelectPersonMask:!1,selectedToken:null}),void sa({module:"\u5f39\u5c42",scene:"\u5173\u95ed\u90ae\u8f6e\u4ed3\u623f\u5173\u8054\u51fa\u884c\u4eba\u5f39\u5c42"});var g=d.getState(),y=g.selectedToken,_=g.ResourcePassengerMapList,b=void 0===_?[]:_,I=g.ErrorTokenList,x=void 0===I?[]:I,T=g.cruise,k=g.passengerObj,S=[],C="";oe.forEach(T,(function(e){var t,n=e.cabinIds;oe.includes(n,y)&&(C=(null===e||void 0===e||null===(t=e.Basic)||void 0===t?void 0:t.OvaryRoomId)||"");S=S.concat(n)}));var w=o.map((function(e){return Zt(e,k)}));if(oe.intersection(x,[y,C]).length){var N=oe.difference(x,[y,C]);n({ErrorTokenList:(0,R.Z)(N)})}if(oe.isEmpty(b))t({isShowCruiseSelectPersonMask:!1,selectedToken:null,ResourcePassengerMapList:[{ResourceToken:y,PassengerTokenList:(0,R.Z)(o)}]}),sa({module:"\u5f39\u5c42",scene:"\u5173\u95ed\u90ae\u8f6e\u4ed3\u623f\u5173\u8054\u51fa\u884c\u4eba\u5f39\u5c42",role:p.RoleType.usr,action:p.ActionType.change,value:"".concat(w.join(","),"\uff08").concat(o.join(","),"\uff09"),jsonData:{selectedToken:null,ResourcePassengerMapList:[{ResourceToken:y,PassengerTokenList:(0,R.Z)(o)}]}});else{var E=!1,P=[];oe.forEach(b,(function(e){var t=(0,i.Z)({},e),n=t.ResourceToken,r=t.PassengerTokenList;n===y?(E=!0,t.PassengerTokenList=(0,R.Z)(o),P.push(t)):oe.includes(S,n)&&oe.intersection(r,o).length||P.push(t)})),E||P.push({ResourceToken:y,PassengerTokenList:(0,R.Z)(o)}),t({isShowCruiseSelectPersonMask:!1,selectedToken:null,ResourcePassengerMapList:P}),sa({module:"\u5f39\u5c42",scene:"\u5173\u95ed\u90ae\u8f6e\u4ed3\u623f\u5173\u8054\u51fa\u884c\u4eba\u5f39\u5c42",role:p.RoleType.usr,action:p.ActionType.change,value:"".concat(w.join(","),"\uff08").concat(o.join(","),"\uff09"),jsonData:{selectedToken:null,ResourcePassengerMapList:P}})}dt(!0)}},br=function(e){var t=m.TOGGLE_COUPON_MASK;t(e),sa({module:"\u5f39\u5c42",scene:(e?"\u6253\u5f00":"\u5173\u95ed")+"\u4f18\u60e0\u5238\u5f39\u5c42"})},Ir=function(e){var t=m.TOGGLE_DUPLICATION_MASK,n=e.status,r=e.options;r=n?r:null,t({isShowDuplicationMask:n,options:r}),sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u9884\u8ba2\u63d0\u9192\u5f39\u5c42",jsonData:r||null})},xr=function(e){var t=m.TOGGLE_SAVEORDER_MASK,n=e.status,r=e.options;r=n?r:null,t({isShowSaveOrderMask:n,options:r})},Tr=function(e){var t=m.TOGGLE_ALERT_MASK;t(e)},kr=function(e){var t=m.TOGGLE_INSURANCESELECTPERSON_MASK,n=e.status,a=e.selectedToken,o=e.currentValue;if(n)t({isShowInsuranceSelectPersonMask:!0,selectedToken:a}),sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u88ab\u4fdd\u4eba\u4fe1\u606f\u5f39\u5c42"});else{if(!o)return t({isShowInsuranceSelectPersonMask:!1,selectedToken:null}),void sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u88ab\u4fdd\u4eba\u4fe1\u606f\u5f39\u5c42"});var i=d.getState(),s=i.selectedToken,c=i.ResourcePassengerMapList,l=void 0===c?[]:c;if(oe.isEmpty(l))return void r.showToast("\u8bf7\u8865\u5145\u88ab\u4fdd\u4eba\u4fe1\u606f");var u=l.filter((function(e){return e.ResourceToken===s}))[0];u?(t({isShowInsuranceSelectPersonMask:!1,selectedToken:null}),sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u88ab\u4fdd\u4eba\u4fe1\u606f\u5f39\u5c42"})):r.showToast("\u8bf7\u8865\u5145\u88ab\u4fdd\u4eba\u4fe1\u606f")}},Sr=function(e){var t=d.getState(),n=t.isShowInstalmentBar,r=m.TOGGLE_INSTALLMENT_BAR;n!==e&&r(e)},Cr=function(e){var t=m.TOGGLE_PRICEDETAIL_MASK;t(e),sa({module:"\u5f39\u5c42",scene:(e?"\u6253\u5f00":"\u5173\u95ed")+"\u4f59\u989d\u660e\u7ec6\u5f39\u5c42"})},wr=function(e){var t=m.TOGGLE_RESOURCEERROR_MASK,n=e.status,r=e.options;r=n?r:null,t({isShowResourceErrorMask:n,options:r}),sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u8d44\u6e90\u53d8\u52a8\u5f39\u5c42"})},Nr=function(e){var t=m.TOGGLE_BUYTRAINTICKET_MASK,n=e.status,r=e.options;r=n?r:null,t({isShowBuyTrainTicketMask:n,options:r}),sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u706b\u8f66\u7968\u8f6e\u8be2\u5f39\u5c42",jsonData:r||null})},Er=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=m.TOGGLE_INSURANCETIP_MASK;n(e),sa(e?{module:"\u5f39\u5c42",scene:"\u6253\u5f00\u672a\u6dfb\u52a0\u51fa\u884c\u4fdd\u969c\u5f39\u5c42"}:{module:"\u5f39\u5c42",scene:"\u5173\u95ed\u672a\u6dfb\u52a0\u51fa\u884c\u4fdd\u969c\u5f39\u5c42",role:p.RoleType.usr,action:p.ActionType.click,value:t.btnName||"\u8499\u5c42"})},Pr=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,r,o,s,c,l,u,f,h,v,g,y,_,I,x,T,k,S,C,w,N,E,P;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=m.TOGGLE_SHAREROOM_MASK,r=m.UPDATE_ORDER_INFO,o=t.status,s=(0,A.Z)(t,fr),!o){e.next=7;break}n({isShowShareRoomMask:!0}),sa({module:"\u5f39\u5c42",scene:(o?"\u6253\u5f00":"\u5173\u95ed")+"\u9009\u62e9\u62fc\u623f\u4eba\u5458\u5f39\u5c42"}),e.next=30;break;case 7:if(c=t.passengerId,l=d.getState(),u=l.sharedRoomInfo,f=void 0===u?{}:u,h=l.passengerObj,v=void 0===h?{}:h,g=f.passengerId,y=void 0===g?0:g,_=(0,i.Z)((0,i.Z)({},f),s),c===y){e.next=30;break}if(!(-1===c&&-1!==y||-1===y&&c>0)){e.next=28;break}if(I=d.getState(),x=I.shoppinginfo,T=void 0===x?{}:x,k=I.resourceinfo,S=void 0===k?{}:k,C=oe.cloneDeep(T),w=C[We.SINGLE_ROOM_CHARGE],N=w.Count,-1===c&&-1!==y?N=Math.ceil(N):-1===y&&c>0&&(N-=.5),E=S[We.SINGLE_ROOM_CHARGE],P=E.filter((function(e){return e.Count===N}))[0],!P){e.next=26;break}return C[We.SINGLE_ROOM_CHARGE]=P,b.updateResource={module:"\u62fc\u623f",scene:"\u66f4\u65b0\u8d2d\u7269\u8f66-\u5207\u6362\u662f\u5426\u62fc\u623f",role:p.RoleType.usr,action:p.ActionType.change,value:c>0?Zt(c,v):"\u4e0d\u62fc\u623f",before:y>0?Zt(y,v):"\u4e0d\u62fc\u623f"},b.updatePrice={module:"\u63a5\u53e3\u8bf7\u6c42",scene:"\u66f4\u65b0\u662f\u5426\u62fc\u623f\u5bfc\u81f4\u4ef7\u683c\u53d8\u5316 ",action:p.ActionType.change},e.next=26,Ue(2,{selectedResources:[{Token:P.Token,Count:P.Count}],callback:function(e){e?(r({shoppinginfo:C,roomcount:N}),n({isShowShareRoomMask:!1,sharedRoomInfo:_})):n({isShowShareRoomMask:!1}),sa({module:"\u5f39\u5c42",scene:"\u5173\u95ed\u62fc\u623f\u5f39\u5c42\u5e76\u4e14\u66f4\u65b0\u8d2d\u7269\u8f66"})}});case 26:e.next=30;break;case 28:n({isShowShareRoomMask:!1,sharedRoomInfo:_}),sa({module:"\u5f39\u5c42",scene:(o?"\u6253\u5f00":"\u5173\u95ed")+"\u9009\u62e9\u62fc\u623f\u4eba\u5458\u5f39\u5c42",role:p.RoleType.usr,action:p.ActionType.change,value:Zt(c,v),before:y>0?Zt(y,v):"\u65e0"});case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),jr=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var o,s,c,l,u,f,h,v,g,y,_,b,I,x,T,k;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=m.TOGGLE_SHAREROOM_MASK,s=t.status,c=(0,A.Z)(t,pr),!s){e.next=12;break}if(l=d.getState(),u=l.passengerObj,f=l.selectIds,h=f&&f.find((function(e){var t;return 1===(null===(t=u[e])||void 0===t?void 0:t.AgeRang)})),h){e.next=8;break}return r.showToast("\u8bf7\u5148\u9009\u62e9\u51fa\u884c\u4eba"),e.abrupt("return");case 8:o({isShowShareRoomMask:!0}),sa({module:"\u5f39\u5c42",scene:(s?"\u6253\u5f00":"\u5173\u95ed")+"\u9009\u62e9\u62fc\u623f\u4eba\u5458\u5f39\u5c42"}),e.next=17;break;case 12:v=t.passengerId,g=d.getState(),y=g.sharedRoomInfo,_=void 0===y?{}:y,b=g.passengerObj,I=void 0===b?{}:b,x=_.passengerId,T=void 0===x?0:x,k=(0,i.Z)((0,i.Z)({},_),c),v!==T&&(o({isShowShareRoomMask:!1,sharedRoomInfo:k}),vr&&(n.g.__sharedRoomInfo=k),sa({module:"\u5f39\u5c42",scene:(s?"\u6253\u5f00":"\u5173\u95ed")+"\u9009\u62e9\u62fc\u623f\u4eba\u5458\u5f39\u5c42",role:p.RoleType.usr,action:p.ActionType.change,value:Zt(v,I),before:T>0?Zt(T,I):"\u65e0"}));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Or=function(e){var t=m.TOGGLE_WECHATSHARE_MASK;t(e),sa({module:"\u5f39\u5c42",scene:(e?"\u6253\u5f00":"\u5173\u95ed")+"\u5fae\u4fe1\u5206\u4eab\u5f39\u5c42"})},Dr=function(e){var t=m.TOGGLE_URGENTNOTICE_MASK;t(e),sa({module:"\u5f39\u5c42",scene:(e?"\u6253\u5f00":"\u5173\u95ed")+"\u516c\u544a\u8be6\u60c5\u5f39\u5c42"})},Rr=function(e){var t=m.TOGGLE_VENDOR_MASK;t(e),sa({module:"\u5f39\u5c42",scene:(e?"\u6253\u5f00":"\u5173\u95ed")+"\u96f6\u552e\u5546\u5f39\u5c42"})},Ar=function(e){var t=m.TOGGLE_CHILDSTANDAR_MASK;t(e),sa({module:"\u5f39\u5c42",scene:(e?"\u6253\u5f00":"\u5173\u95ed")+"\u8d39\u7528\u5305\u542b\u5f39\u5c42"})},Mr=function(e){var t=m.TOGGLE_MEMBERCARDS_MASK,n=e.status,r=e.options,a=e.currentValue;if(n)t({isShowMemberCardsMask:n,options:r}),sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u9009\u62e9\u8bc1\u4ef6\u7c7b\u578b\u5f39\u5c42"});else{if(!a)return t({isShowMemberCardsMask:n,options:null}),void sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u9009\u62e9\u8bc1\u4ef6\u7c7b\u578b\u5f39\u5c42"});t({isShowMemberCardsMask:n,options:null}),sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u9009\u62e9\u8bc1\u4ef6\u7c7b\u578b\u5f39\u5c42",role:p.RoleType.usr,action:p.ActionType.change,value:Ne[a]||""}),J(a,"IdCardType")}},Vr=function(e){var t=m.TOGGLE_RETAILINVOICE_MASK;t(e),sa({module:"\u5f39\u5c42",scene:(e?"\u6253\u5f00":"\u5173\u95ed")+"\u96f6\u552e\u5546\u53d1\u7968\u63d0\u793a\u5f39\u5c42"})},Lr=function(e){var t=m.TOGGLE_INSINTRODUC_MASK,n=e.status,r=e.options;r=n?r:null,t({isShowInsuranceIntroductionMask:n,options:r}),sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u4fdd\u9669\u8bf4\u660e\u5f39\u5c42",jsonData:r||null})},Br=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,r,o,i,s,c,l,u,f,p,h;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=m.TOGGLE_FAREREMARK_MASK,r=m.UPDATE_ORDER_INFO,n(t),sa({module:"\u5f39\u5c42",scene:(t?"\u6253\u5f00":"\u5173\u95ed")+"\u673a\u7968\u9000\u6539\u7b7e\u5f39\u5c42"}),o=d.getState(),i=o.FareRemark_NeedRetry,s=void 0!==i&&i,!t||!s){e.next=10;break}return e.next=7,x.getFareRemark();case 7:l=e.sent,u=null===l||void 0===l||null===(c=l.CabinInfo)||void 0===c?void 0:c.QTEFareRemarkForShopping,oe.isEmpty(u)||(f=u.RemarkList,p=void 0===f?{}:f,h=u.NeedRetry,r({FareRemark:p,FareRemark_NeedRetry:h}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ur=function(e){var t=m.TOGGLE_INSCONFIRM_MASK;t(e),sa({module:"\u5f39\u5c42",scene:(e?"\u6253\u5f00":"\u5173\u95ed")+"\u53bb\u4fdd\u4ee3\u9875\u9762\u5f39\u5c42"})},Zr=function(e){var t=m.TOGGLE_FULLBG_MASK;t(e)},Fr=function(e){var t=m.TOGGLE_IMENTRY_MASK;t(e)},Gr=function(e){var t=m.TOGGLE_PERSONLIST_MASK,n=e.status,r=e.options;r=n?r:null,t({isShowPersonListMask:n,options:r}),sa({module:"\u5f39\u5c42",scene:(n?"\u6253\u5f00":"\u5173\u95ed")+"\u8bc1\u4ef6\u53f7\u91cd\u590d\u63d0\u793a\u5f39\u5c42"})},Hr=function(e){var t=m.TOGGLE_COUNTRY_CODE_MASK;t(e)},qr=function(e){var t=e.status,n=e.options,r=void 0===n?{}:n,a=m.TOGGLE_TRAIN12306_CONTACT_MASK;a(t?{isShowTrain12306ContactMask:!0,options:r}:{isShowTrain12306ContactMask:!1,options:null})},Kr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=m.TOGGLE_HOTELSELECTCONTACT_MASK;if(n(e),e)sa({module:"\u5f39\u5c42",scene:"\u6253\u5f00\u9152\u5e97\u4f1a\u5458\u5feb\u9009\u51fa\u884c\u4eba\u5f39\u5c42"});else{var r=d.getState(),a=r.passengerObj,o=t||{},i=o.id,s=a&&a[i],c=(null===s||void 0===s?void 0:s.CNName)||(null===s||void 0===s?void 0:s.ENLastName)+(null===s||void 0===s?void 0:s.ENFirstName)||"\u8499\u5c42";sa({module:"\u5f39\u5c42",scene:"\u5173\u95ed\u9152\u5e97\u4f1a\u5458\u5feb\u9009\u51fa\u884c\u4eba\u5f39\u5c42",role:p.RoleType.usr,action:p.ActionType.click,value:c})}},zr=function(e){var t=m.TOGGLE_AIRLINECLAUSE_MASK;if(1===e||0===e)t(!!e);else if(2===e){var n=m.UPDATE_ORDER_INFO,r=d.getState(),a=r.userNotice,o=void 0===a?{}:a;n({isShowAirlineClauseMask:!1,userNotice:(0,i.Z)((0,i.Z)({},o),{},{isSelect:!0,isReadAirClause:1})})}},Yr=function(e){var t=m.TOGGLE_ROOMINTRODUCTION_MASK;t(e),sa({module:"\u5f39\u5c42",scene:(e?"\u6253\u5f00":"\u5173\u95ed")+"\u623f\u95f4\u8bf4\u660e\u5f39\u5c42"})},Wr=function(e){var t=d.getState(),n=t.options,r=void 0===n?{}:n,a=m.TOGGLE_BOOKREAD_MASK,o=e.status,s=e.options;r=o?(0,i.Z)((0,i.Z)({},r),s):null,a({isShowBookReadMask:o,options:r}),sa({module:"\u5f39\u5c42",scene:(o?"\u6253\u5f00":"\u5173\u95ed")+"\u8ba2\u524d\u5fc5\u8bfb\u5f39\u5c42"})},$r=function(){var e=d.getState(),t=e.pageEmotionalObj,n=t&&oe.cloneDeep(t)||{};delete n.bottomEmotional;var r=m.UPDATE_ORDER_INFO;r({pageEmotionalObj:n})},Xr=function(e){var t=m.UPDATE_ORDER_INFO;t({payStatus:e})},Jr=function(){var e=m.UPDATE_ORDER_INFO;e((0,i.Z)({},mr))},Qr=function(e){var t=e.typeName,n=e.message,r=e.operationName,a=e.operationData;oa(),Tr({isShowAlertMask:!0,options:{typeName:t,message:n||"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u8bf7\u91cd\u8bd5\uff01",operationName:r||null,operationData:a}})},ea=function(e,t){var n=d.getState()||{},a=n.logInfo,o=void 0===a?{}:a;t&&(o=(0,i.Z)((0,i.Z)({},o),t));var s="grp_order_".concat(e,"_").concat(o.pageid);o.pageid&&r.tracelog(s,o)},ta=function(e,t){var n=d.getState()||{},a=n.logInfo,o=void 0===a?{}:a,s=o,c=s.pageid,l=void 0===c?"":c;t&&(o=(0,i.Z)((0,i.Z)({},o),t)),e.indexOf("pageid")>-1&&(e=e.replace("pageid",l)),l&&r.tracelog&&r.tracelog(e,o)},na=function(e,t){r.traceDevLog(e,t)},ra=function(){var e=d.getState();r.basicLog&&r.basicLog(e);var t=e||{},n=t.Channels,a=void 0===n?{}:n,o=t.query,i=void 0===o?{}:o,s=t.Platform;if(a&&a.isBestone){var c=m.UPDATE_ORDER_INFO;r.subscribeVolumeButton({callback:function(e){c({showPeerPrice:e})}})}var l=i||{},u=l.token,f=l.status,p=l.orderid;if(u&&f){var h={token:u,status:f,orderId:p};return s===_e.CTRIPH5&&r.replacePageUrl&&r.replacePageUrl(i),void jn(h)}var v=e.tagInfo,g=v||{},y=g.isContainSystemFlight;y&&r.timeOutTip&&r.timeOutTip((function(){Tr({isShowAlertMask:!0,options:{typeName:"TimeoutTip"}})}),18e5)},aa=function(){var e=d.getState(),t=e.Platform;t===_e.CTRIPH5&&r.showLoading&&r.showLoading()},oa=function(){var e=d.getState(),t=e.Platform;t===_e.CTRIPH5&&r.hideLoading&&r.hideLoading()},ia=function(e){if(!vr&&r.getDHTLogger&&r.getDHTLogger().logPageInfo){var t=d.getState(),n=t.shoppingId;try{console.log("traceKMPageLog================================",e),r.getDHTLogger().logPageInfo((0,i.Z)({attrs:[{key:"shoppingid",value:n}]},e))}catch(e){}}},sa=function(e){if(!vr&&r.getDHTLogger&&r.getDHTLogger().logActionInfo){var t=d.getState(),n=t.shoppingId;try{console.log("traceKMActionLog================================",e),r.getDHTLogger().logActionInfo((0,i.Z)({attrs:[{key:"shoppingid",value:n}]},e))}catch(e){}}},ca=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if(!vr&&r.getDHTLogger&&r.getDHTLogger().logError)try{r.getDHTLogger().logError({pageName:"OrderV3",message:e,ex:t})}catch(t){}},la=function(){var e=d.getState(),t=e.shoppingId,n=e.productBasicInfo,r=e.IMEntryInfo,a=e.logInfo,o=n||{},i=o.ProductCategoryId,s=o.ProductId,c=o.ProductAlias,l=void 0===c?"":c,u=o.DepartureId,f=o.SaleCityId,p=o.IsThemeProduct,m=a||{},h=m.pageid,v=void 0===h?"":h,g=(null===r||void 0===r?void 0:r.resolveImCode)||"";g||(g=p?"30000500":i&&[33,34,41,42].indexOf(+i)>-1?"01330500":"01090500");var y="grp-".concat(v,"-bubble-imconsult-").concat(s,"-").concat(l),_={shoppingId:t,productId:s,destinationIdList:[u],departureCityId:u,saleCityId:f,hasProduct:0,platformId:1,extendJson:{Platform:"H5"},pageId:v,isPreSale:1,actionId:y,IMCode:g,notShowFixedButton:!0,conversationType:"groupchat"};return _},ua=function(){var e,t=d.getState(),n=t.train12306LoginData,a={};oe.isEmpty(n)||(a={userName:null!==(e=null===n||void 0===n?void 0:n.userName)&&void 0!==e?e:""});r.goTo12306Page&&r.goTo12306Page(ma,a)},da=function(e){var t=d.getState(),n=t.shoppingId,a=t.options,o=t.Platform,i=t.passengerObj,s=t.taroInfo,c=a.passengerModalData,l=c.passenger,u=l||{},f=u.PassengerID;if(1003===e)if(o===_e.CTRIPWX){var p=i[f];r.goToPassengerEdit({shoppingId:n,passengerId:f,chosenInfo:null===p||void 0===p?void 0:p.chosenInfo,taroInfo:s})}else r.openEditPage&&r.openEditPage(n,l,(function(e){Et(e)}))},fa=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,o,i,s,c;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.showLoadingDialog(),n=d.getState(),o=n.orderBasicInfo,e.next=5,tt(1,{backData:t});case 5:return i=e.sent,s=i.selectIds,void 0===s?[]:s,c=m.UPDATE_ORDER_INFO,c(i),o.totalPersonCount,e.next=12,K();case 12:r.hideLoadingDialog();case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pa=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,o,s,c,l,u,f,p,h,v,g,y,_,b,I,x,T,k,S,C,w,N,E,P,j,O,D,A,M,V,L;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r.showLoadingDialog(),n=t.passengers,o=void 0===n?[]:n,s=t.cards,c=o&&o[0],na("o_vac_order_bbz_passenger_edit_save",{desc:"\u7ec4\u4ef6\u7f16\u8f91\u9875\u56de\u8c03\u51fa\u884c\u4eba\u4fe1\u606f",passenger:c}),c){e.next=6;break}return e.abrupt("return");case 6:return l=d.getState(),l.orderBasicInfo,u=l.passengerObj,f=l.CommonPassengers,p=l.selectIds,h=l.tagInfo,v=void 0===h?{}:h,g=l.shoppingId,y=oe.cloneDeep(u),_=oe.cloneDeep(f),b=(0,R.Z)(p),c.chosenInfo||(c.chosenInfo={unEffect:"F",chosenCards:s}),e.next=13,wt(r,g,[c]);case 13:return I=e.sent,x=At([c],null,I)[0],T=+x.passengerID,k=oe.findIndex(f,(function(e){return+e.passengerID===T})),_.splice(k,1,x),e.next=20,Bt(r,[T],(0,i.Z)((0,i.Z)({},d.getState()),{},{CommonPassengers:[x],template:I}));case 20:return S=e.sent,C=S[T]||{},w=y[T]||{},N=w.type,E=void 0===N?"":N,P=w.AgeRang,j=st(C,d.getState()),C.age=j.age,O=!1,oe.includes(b,T)?"X"===j.type?(r.showToast(j.errorMsg),b=oe.difference(b,[T])):"U"===j.type?(C.AgeRang=P,C.type=E,C.MayChange=!0):"A"===j.type?(oe.includes(["B","C"],E)&&(b=oe.difference(b,[T]),O=!0),C.AgeRang=1,C.type="A",C.MayChange=!1):"C"===j.type?(oe.includes(["B","A"],E)&&(b=oe.difference(b,[T]),O=!0),C.AgeRang=0,C.type="C",C.MayChange=!1):"B"===j.type&&(oe.includes(["A","C"],E)&&(b=oe.difference(b,[T]),O=!0),C.AgeRang=2,C.type="B",C.MayChange=!1):"X"===j.type?r.showToast(j.errorMsg):("U"===j.type?(C.MayChange=!0,C.AgeRang=1,C.type="A"):"A"===j.type?(C.AgeRang=1,C.type="A"):"C"===j.type?(C.AgeRang=0,C.type="C"):"B"===j.type&&(C.AgeRang=2,C.type="B"),b.push(T)),null!==v&&void 0!==v&&v.isTrain&&(D=ct(w,d.getState()),A=ct(C,d.getState()),D.type&&D.type!==Pe.free&&A.type===Pe.free&&(C.Height=Pe.free)),y[T]=C,M=Kt([y[T]]),na("o_vac_order_passenger",{desc:"\u7f16\u8f91\u9875\u4fdd\u5b58\u56de\u6765\u7684\u51fa\u884c\u4eba\u5904\u7406\u4fe1\u606f",passenger:M}),V=Yt(T,b,y),V&&(Gr({status:!0,options:{type:"samecard",ids:V}}),b=oe.difference(b,[T])),L=m.UPDATE_ORDER_INFO,L({selectIds:b,passengerObj:y,CommonPassengers:_}),O&&(r.showToast("\u60a8\u9009\u62e9\u7684\u51fa\u884c\u4eba\u4fe1\u606f\u53d1\u751f\u53d8\u66f4\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9"),na("o_vac_order_bbz_passenger_error",{desc:"\u7f16\u8f91\u9875\u4fdd\u5b58\u8fc7\u6765\u7684",oldPassengerObj:w,newPassengerObj:C})),e.next=39,K();case 39:r.hideLoadingDialog();case 40:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ma=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,r,o;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("\ud83e\udd76train12306Callback",t),sa({module:"12306\u767b\u5f55",scene:"\u706b\u8f66\u7968\u767b\u5f55\u8fd4\u56de",action:p.ActionType.change,value:null===t||void 0===t?void 0:t.userName,jsonData:t}),n=m.UPDATE_ORDER_INFO,n({train12306LoginData:t||{}}),r=d.getState(),o=r.Platform,o!==_e.CTRIPRN||null===t||void 0===t||!t.token){e.next=8;break}return e.next=8,x.bookLimitCheck({scene:3});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ha=function(){var e=d.getState(),t=e.isPrivateGroup;t&&(va("01090508"),ta("grp_psgnum_loservice_click"))},va=function(e){var t;if(e){var n=d.getState(),a=n.productBasicInfo,o=n.shoppingId,s=n.IMEntryInfo,c=n.VendorInfo,l=(n.pageStatus,n.pageid),u=s||{},f={providerId:String(c.SalerInfo.VendorId)};try{u&&u.extendJson&&(f=(0,i.Z)((0,i.Z)({},f),JSON.parse(u.extendJson)))}catch(e){}var p={providerId:String(null===c||void 0===c||null===(t=c.SalerInfo)||void 0===t?void 0:t.VendorId),shoppingId:o,productId:String(a.ProductId),saleCityId:String(a.SaleCityId),departureCityId:String(a.DepartureId),destinationIdList:[a.DestCityId],isPreSale:1,pageId:l,IMCode:e,ExtendJson:JSON.stringify(f)};r.Storage.save({key:"TOUR_GROUPCHAT_ROBOT",value:JSON.stringify(p),domain:"tour"});var m="ctrip://wireless/tour_groupchat_robot?groupBizType=1105&timestamp="+(new Date).getTime();r.openURL(m)}},ga=r&&r.getPlatform&&r.getPlatform()===_e.CTRIPWX?null:ie({ctx:r,store:d,actions:m,fetchs:x,modelObj:{firstScreenRet:I,setInterfaceFail:Qr,toggleCommonAlertMask:Tr,getContactErrorMsg:Ie,diyPayHideLoading:Dn,diyPayShowLoading:Rn,beforeSaveOrder:_n,KMPayErrorLog:Gt,traceKMActionLog:sa,traceKMErrorLog:ca,toggleCreateShoppingErrorMask:Un,traceKMPageInfo:O,toggleSelectPassenger:Fn}}),ya=(t={ctrl:s,initPage:T,preloadCallBackAction:g,getSecondData:P,getLastInfo:j,updateShopping:Ae,doCheckPassenger:X,changeMemberInfo:J,checkMemberInfo:ee,changeUSAAddressInfo:re,checkUSAAddressInfo:ae,handleSelectFirstNamePY:ge,handleSelectLastNamePY:ve,handleClosePinYinPop:be,handleToSplitPinYin:he,handleToSplitCnName:de,selectHotelRegNotice:xe,getReplaceContractObj:mt,repalceContactMobile:te,clearRepalceMobile:ne,countryCodeBack:_t,chooseInvoiceBack:Tt,chooseDeliveryAddressBack:kt,specialCallBack:St,useCouponBack:Nt,installmentCallBack:Pt,insuranceMul:Te,beforeSelectInsurance:ke,selectInsurance:Ce,changeHotelRooms:Le,clickOldManTip:Y,checkAllClauses:W,payNext:Ut,checkShowImprotantTip:qt,checkInsuranceNonSelect:nn,duplicationCheck:rn,saveOrder:In,beforeSaveOrder:_n,saveOrderCallBack:xn,pollResources:Cn,autoUsaAddress:pt,usaAddressPickCallBack:jt,getNewShowIns:Ve,beforeReturnPage:An,bookingXResource:Ue,chooseContactBack:Ct,insChangeBack:On,getLastCouponInfo:Xe,getPriceDetailAndCoupon:Je,updateCruise:dt,updateTrainSelectedSeat:at,signCanBookingToken:kn,openIM:Mn,changeIMSatus:Vn,registerGroupMember:pn,hotelLoginCallBack:Rt,contractCallBack:Mt,choosePassenger:H,rnPsgListCallBack:Ot,rnPassengerEditCallBack:Et,passengerModalCallBack:$,handleCreateShopping:Bn,toggleCreateShoppingErrorMask:Un,toggleSelectDate:Zn,toggleSelectPassenger:Fn,toggleTravelerRuleMask:Kn,toggleBookLimitMask:zn,toggleTrainDetailMask:Yn,toggleTrainSelectSeatMask:tr,toggleTrainHeightMask:Qn,handleChangeTrainChildType:Wn,toggleCouponMask:br,toggleCommonAlertMask:Tr,toggleDeliveryInfoMask:ir,toggleDeliveryTypeMask:sr,toggleDeliveryAddressMask:cr,toggleResourceSelectPersonMask:yr,toggleCruiseSelectPersonMask:_r,toggleSaveOrderMask:xr,toggleInsuranceSelectPersonMask:kr,togglePriceDetailMask:Cr,toggleInstallmentBar:Sr,toggleResourceErrorMask:wr,toggleBuyTrainTicketMask:Nr,toggleInsuranceTipMask:Er,toggleShareRoomMask:Pr,toggleWeChatShareMask:Or,toggleUrgentNoticeMask:Dr,toggleVendorMask:Rr,toggleChildStandarMask:Ar,hideBottomEmotional:$r,toggleDuplicationMask:Ir,toggleInsIntroducMask:Lr,toggleMemberCardsMask:Mr,toggleRetailInvoiceMask:Vr,toggleFareRemarkMask:Br,toggleInsConfirmMask:Ur,toggleIMEntryInfo:Fr,togglePersonListMask:Gr,hideAllMask:Jr,togglePayStatus:Xr,toggleCountryCodeMask:Hr,toggleTrain12306ContactMask:qr,toggleHotelSelectContactMask:Kr,toggleAirlineClauseMask:zr,toggleShareRoomPersonMask:jr,toggleRoomIntroductionMask:Yr,toggleBookReadMask:Wr,toggleTrainSelectPersonMask:$n,insConfirmBack:jn,actionTraceLog:ea,clickTraceLog:ta,orderTraceDevLog:na,traceKMActionLog:sa,goTo12306Login:ua},(0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)(t,"handleCreateShopping",Bn),"toggleCreateShoppingErrorMask",Un),"toggleSelectDate",Zn),"toggleSelectPassenger",Fn),"toggleTravelerRuleMask",Kn),"toggleBookLimitMask",zn),"toggleTrainDetailMask",Yn),"toggleTrainSelectSeatMask",tr),"toggleTrainHeightMask",Qn),"handleChangeTrainChildType",Wn),(0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)(t,"toggleCouponMask",br),"toggleCommonAlertMask",Tr),"toggleDeliveryInfoMask",ir),"toggleDeliveryTypeMask",sr),"toggleDeliveryAddressMask",cr),"toggleResourceSelectPersonMask",yr),"toggleCruiseSelectPersonMask",_r),"toggleSaveOrderMask",xr),"toggleInsuranceSelectPersonMask",kr),"togglePriceDetailMask",Cr),(0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)(t,"toggleInstallmentBar",Sr),"toggleResourceErrorMask",wr),"toggleBuyTrainTicketMask",Nr),"toggleInsuranceTipMask",Er),"toggleShareRoomMask",Pr),"toggleWeChatShareMask",Or),"toggleUrgentNoticeMask",Dr),"toggleVendorMask",Rr),"toggleChildStandarMask",Ar),"hideBottomEmotional",$r),(0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)(t,"toggleDuplicationMask",Ir),"toggleInsIntroducMask",Lr),"toggleMemberCardsMask",Mr),"toggleRetailInvoiceMask",Vr),"toggleFareRemarkMask",Br),"toggleInsConfirmMask",Ur),"toggleIMEntryInfo",Fr),"togglePersonListMask",Gr),"hideAllMask",Jr),"togglePayStatus",Xr),(0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)(t,"toggleCountryCodeMask",Hr),"toggleTrain12306ContactMask",qr),"toggleHotelSelectContactMask",Kr),"toggleAirlineClauseMask",zr),"toggleShareRoomPersonMask",jr),"toggleRoomIntroductionMask",Yr),"toggleBookReadMask",Wr),"toggleTrainSelectPersonMask",$n),"insConfirmBack",jn),"actionTraceLog",ea),(0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)(t,"clickTraceLog",ta),"orderTraceDevLog",na),"traceKMActionLog",sa),"goTo12306Login",ua),"bbzPassengerValidCallback",da),"passengerListCallBack",fa),"passengerEditCallBack",pa),"checkTrainBookingLimit",on),"checkTrain12306Time",cn),"getIMParams",la),(0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)((0,f.Z)(t,"handleGoPrivateIM",ha),"orderPreSaleModel",ga),"preloadCallback",h),"startCallback",v),"fetchGetUserInfo",S),"getInitPassenger",N),"initBasicInfo_app",w),"initPageCallback_App",E),"initBasicInfo_wx",k),"initPageCallback",C),(0,f.Z)((0,f.Z)(t,"getContactErrorMsg",Ie),"commonAlertMask",Ln)),_a=r&&r.getPlatform&&r.getPlatform()===_e.CTRIPWX?null:se({ctx:r,ctrl:s,store:d,actions:m,modelFetchs:x,fns:{getBbzPassengerInfo:U,handleCreateShopping:Bn,setInterfaceFail:Qr,fetchGetUserInfo:S,initBasicInfo_wx:k,initPassenger:Xn,diyPayShowLoading:Rn,diyPayHideLoading:Dn,KMPayErrorLog:Gt,toggleCommonAlertMask:Tr,toggleCreateShoppingErrorMask:Un,checkPassengerTemp:Qe,choosePassenger:H,traceKMErrorLog:ca,traceKMActionLog:sa}});return{store:d,actions:(0,i.Z)((0,i.Z)((0,i.Z)({},m),ya),{},{ctx:r,preOrder:_a,orderPreSaleModel:ga})}})),_r=n(2269),br=function(){var e=yr.useState((function(e){var t=e.pageEmotionalObj,n=e.taroInfo,r=e.selectIds;return{pageEmotionalObj:t,taroInfo:n,selectIds:r}})),t=e.pageEmotionalObj,n=e.taroInfo,r=e.selectIds,a=n||{},o=a.navBarMarginTop,i=t&&t.backEmotional||[],s=yr.useActions(),c=s.toggleCommonAlertMask,l=s.saveOrder,u={paddingTop:o};return(0,_r.jsxs)(D.View,{className:"order_header",style:u,children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_back",onClick:function(){r&&r.length&&l(0),c({isShowAlertMask:!0,options:{typeName:"PageBack",data:(0,R.Z)(i)}})}}),(0,_r.jsx)(D.Text,{children:"\u8ba2\u5355\u586b\u5199"})]})},Ir=br;function xr(e){var t=e.className,n=void 0===t?"":t,r=e.style,a=void 0===r?{}:r;return(0,_r.jsx)(D.View,{className:"skeleton_con breath_loading ".concat(n),style:a})}function Tr(){return(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsxs)(D.View,{className:"proInfoCardTop",children:[(0,_r.jsx)(xr,{className:"proInfoCardTopItem1"}),(0,_r.jsx)(xr,{className:"proInfoCardTopItem2"}),(0,_r.jsx)(xr,{className:"proInfoCardTopItem2"}),(0,_r.jsx)(xr,{className:"proInfoCardTopItem3"})]}),(0,_r.jsxs)(D.View,{className:"contentCard",children:[(0,_r.jsx)(D.View,{className:"contentCardTitle",children:(0,_r.jsx)(xr,{className:"contentCardItem1"})}),(0,_r.jsx)(D.View,{className:"contentCardLine"}),(0,_r.jsxs)(D.View,{className:"passengerLabelView contentCardCommon",children:[(0,_r.jsx)(xr,{className:"passengerLabelItem"}),(0,_r.jsx)(xr,{className:"passengerLabelItem"}),(0,_r.jsx)(xr,{className:"passengerLabelItem"}),(0,_r.jsx)(xr,{className:"passengerLabelItem"}),(0,_r.jsx)(xr,{className:"passengerLabelItem"}),(0,_r.jsx)(xr,{className:"passengerLabelItem"})]})]}),(0,_r.jsxs)(D.View,{className:"otherCard",children:[(0,_r.jsx)(xr,{className:"otherCardItem1"}),(0,_r.jsx)(xr,{className:"otherCardItem2"})]}),(0,_r.jsxs)(D.View,{className:"otherCard",children:[(0,_r.jsx)(xr,{className:"otherCardItem1"}),(0,_r.jsx)(xr,{className:"otherCardItem2"})]}),(0,_r.jsxs)(D.View,{className:"otherCard",children:[(0,_r.jsx)(xr,{className:"otherCardItem1"}),(0,_r.jsx)(xr,{className:"otherCardItem2"})]}),(0,_r.jsxs)(D.View,{className:"otherCard",children:[(0,_r.jsx)(xr,{className:"otherCardItem1"}),(0,_r.jsx)(xr,{className:"otherCardItem2"})]}),(0,_r.jsxs)(D.View,{className:"otherCard",children:[(0,_r.jsx)(xr,{className:"otherCardItem1"}),(0,_r.jsx)(xr,{className:"otherCardItem2"})]}),(0,_r.jsxs)(D.View,{className:"otherCard",children:[(0,_r.jsx)(xr,{className:"otherCardItem1"}),(0,_r.jsx)(xr,{className:"otherCardItem2"})]})]})}var kr=Tr,Sr=function(){var e=yr.useState((function(e){var t=e.urgentInfo;return{urgentInfo:t}})),t=e.urgentInfo,n=yr.useActions(),r=n.toggleUrgentNoticeMask;if(null===t||void 0===t||!t.length)return null;var a=[],o=1;null===t||void 0===t||t.forEach((function(e){(null===e||void 0===e?void 0:e.Title)&&a.push(e.Title),o&&0===(null===e||void 0===e?void 0:e.Weight)&&(o=0)}));var i=a.join(" | ");return(0,_r.jsx)(D.View,{className:"urgent_card ".concat(be[o]),onClick:function(){r(!0)},children:(0,_r.jsxs)(D.View,{className:"flex_box",children:[(0,_r.jsx)(D.View,{className:"flex_1",children:(0,_r.jsxs)(D.View,{className:"urgent_item one_line",id:"content",children:[(0,_r.jsx)(D.Text,{style:{position:"absolute",top:2,left:0,fontSize:14},className:"prs_iconfont iconfont_strong_tips"}),(0,_r.jsx)(D.Text,{className:"txt_bold",children:"\u516c\u544a\uff1a"}),(0,_r.jsx)(D.Text,{children:i})]})}),(0,_r.jsx)(D.View,{className:"flex_0",children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward"})})]})})},Cr=Sr,wr=function(){var e=yr.useState((function(e){var t=e.productBasicInfo,n=e.orderBasicInfo,r=e.pageEmotionalObj,a=e.roomcount,o=e.VendorInfo,i=e.specialBrandInfo,s=e.taroInfo;return{productBasicInfo:t,orderBasicInfo:n,pageEmotionalObj:r,roomcount:a,VendorInfo:o,specialBrandInfo:i,taroInfo:s}})),t=e.productBasicInfo,n=e.orderBasicInfo,r=e.pageEmotionalObj,a=e.roomcount,o=e.VendorInfo,i=e.specialBrandInfo,s=e.taroInfo,c=yr.useActions(),l=c.toggleVendorMask,u=(0,O.useState)(!oe.isEmpty(i)),d=(0,M.Z)(u,2),f=d[0],p=d[1],m=n||{},h=m.DepartureDate,v=void 0===h?"":h,g=m.ReturnDate,y=void 0===g?"":g,_=m.AdultCount,b=void 0===_?0:_,I=m.ChildCount,x=void 0===I?0:I,T=m.InfantCount,k=void 0===T?0:T,S=(m.numShowTip,t||{}),C=S.ProductName,w=void 0===C?"":C,N=S.ProductAlias,E=void 0===N?"":N,P=S.DepartureCityName,j=void 0===P?"":P,R=S.SaleMode,A=void 0===R?"":R,V=(S.ProductPatternId,S.returnTip),L=void 0===V?"":V,B="";b&&(B+="".concat(b,"\u6210\u4eba")),x&&(B+="".concat(B?"\uff0c":"").concat(x,"\u513f\u7ae5")),k&&(B+=B?"\uff0c"+"".concat(k,"\u5a74\u513f"):""),a&&(B+=" | ".concat(a,"\u95f4\u623f"));var U=o||{},Z=U.IsDistributor,F=void 0!==Z&&Z,G=U.SalerInfo,H=void 0===G?{}:G,q="";("R"===A||F)&&H&&H.FullName&&(q=H.FullName);var K=r||{},z=K.productEmotional,Y=void 0===z?{}:z,W=s||{},$=W.windowWidth;return console.log("BannerCom render ======="),(0,_r.jsx)(D.View,{className:"BannerBox",children:(0,_r.jsxs)(D.View,{className:"banner_card",children:[(0,_r.jsx)(Cr,{}),(0,_r.jsxs)(D.View,{className:"banner_title_card",children:[(0,_r.jsxs)(D.View,{className:"banner_product_title",children:[w," ",E&&" - ".concat(E,"\u7ebf")]}),!!q&&(0,_r.jsxs)(D.Text,{className:"banner_product_sub_title",onClick:function(){l(!0)},children:["\u7531 ",q," \u76f4\u552e"]}),(0,_r.jsxs)(D.View,{className:"banner_product_sub_title",children:[j,"\u51fa\u53d1 ",v,"\u51fa\u53d1",y,"\u8fd4\u7a0b"]}),(0,_r.jsx)(D.View,{className:"banner_product_sub_title",children:B}),!!L&&(0,_r.jsxs)(D.View,{className:"banner_product_sub_title",children:[(0,_r.jsx)(D.View,{className:"banner_tagview",children:(0,_r.jsx)(D.Text,{className:"Text22_30 color_green",children:L})}),(0,_r.jsx)(D.Text,{className:"Text22_30 color_green",children:"\uff08\u4fdd\u9669\u9664\u5916\uff09"})]})]}),(0,_r.jsxs)(D.View,{className:"banner_bottom_card",style:{background:f?"#fff":"#faf9fe"},children:[!!Y&&Y.title&&(0,_r.jsxs)(D.View,{className:"banner_bottom_tip tip_green",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_insure"}),(0,_r.jsxs)(D.Text,{className:"text",children:[Y.title,"\uff1a",Y.content]}),f&&(0,_r.jsx)(D.Text,{className:"line"})]}),f&&(0,_r.jsx)(D.View,{className:"banner_bottom_private",children:(0,_r.jsx)(D.Image,{mode:"widthFix",lazyLoad:!0,style:{width:$-16,height:88/750*($-16)},src:null===i||void 0===i?void 0:i.entranceImg,onError:function(){p(!1)}})})]})]})})},Nr=wr;function Er(e){var t=Pr(e),n=function(n){var r=e.cur,a=e.onChange,o=e.customOptions||t,i=o.indexOf(r);0===i&&n<0||i===o.length-1&&n>0||a(o[i+n],n>0)},r=e.customOptions||t,a=e.cur,o=(e.unit,e.required),i=e.min;a=+a,a=r.indexOf(a)>-1?a:o?i:0;var s=!1,c=!1;a===r[r.length-1]&&(s=!0),a===r[0]&&(c=!0);var l=a;return(0,_r.jsxs)(D.View,{className:"CommonUINumContainer",children:[(0,_r.jsx)(D.View,{className:"CommonUINumButton",onClick:function(){n(-1)},children:(0,_r.jsx)(D.Text,{className:c?"CommonUINumButtonText disable":"CommonUINumButtonText",children:"\ued0a"})}),(0,_r.jsx)(D.View,{className:"CommonUINumCount",children:(0,_r.jsx)(D.Text,{className:"CommonUINumCountText",children:l})}),(0,_r.jsx)(D.View,{className:"CommonUINumButton",onClick:function(){n(1)},children:(0,_r.jsx)(D.Text,{className:s?"CommonUINumButtonText disable":"CommonUINumButtonText",children:"\ue93e"})})]})}var Pr=function(e){var t=e.min,n=[t];while((t+=e.step)<=e.max)n.push(t);return!e.required&&n.indexOf(0)<0&&n.unshift(0),n},jr=function(e){e.token,e.type;var t=e.title,n=e.text,r=e.placeholder,a=e.clickEvent,o=yr.useState((function(e){var t=e.selectIds,n=e.passengerObj,r=e.ResourcePassengerMapList,a=e.template,o=e.orderBasicInfo,i=e.ErrorTokenList,s=e.logInfo;return{selectIds:t,passengerObj:n,ResourcePassengerMapList:r,template:a,orderBasicInfo:o,ErrorTokenList:i,logInfo:s}}));o.selectIds,o.passengerObj,o.ResourcePassengerMapList,o.template,o.orderBasicInfo,o.ErrorTokenList,o.logInfo;return(0,_r.jsxs)(D.View,{className:"flex_box resouce_info_user",children:[(0,_r.jsx)(D.View,{className:"flex_0",children:(0,_r.jsx)(D.View,{className:"item_name",children:t})}),(0,_r.jsx)(D.View,{className:"flex_1",onClick:function(){a&&a()},children:(0,_r.jsxs)(D.View,{className:"main_con ".concat(n?"":"blur"),children:[(0,_r.jsx)(D.View,{className:"text",children:n||r}),(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward"})]})})]})},Or=jr,Dr={"#000":"jqd2qb0","#111":"jqd2qb1","#222":"jqd2qb2","#333":"jqd2qb3","#555":"jqd2qb4","#666":"jqd2qb5","#999":"jqd2qb6","#ccc":"jqd2qb7","#eee":"jqd2qb8","#fff":"jqd2qb9","#ccd6e5":"jqd2qba","#c5c5c5":"jqd2qbb","#f70":"jqd2qbc","#0066f6":"jqd2qbd","#006ff6":"jqd2qbe","#0086f6":"jqd2qbf","#287dfa":"jqd2qbg","#00B87A":"jqd2qbh",text20:"jqd2qbi",text22:"jqd2qbj",text24:"jqd2qbk",text26:"jqd2qbl",text28:"jqd2qbm",text30:"jqd2qbn",text34:"jqd2qbo",textW500:"jqd2qbp",textBold:"jqd2qbq",fontNumber:"jqd2qbr",fontNumberBold:"jqd2qbs",fontIcon:"jqd2qbt",gap4:"jqd2qbu",mr4:"jqd2qbv",ml4:"jqd2qbw",mt4:"jqd2qbx",mb4:"jqd2qby",mr6:"jqd2qbz",ml6:"jqd2qb10",mt6:"jqd2qb11",mb6:"jqd2qb12",mr8:"jqd2qb13",ml8:"jqd2qb14",mt8:"jqd2qb15",mb8:"jqd2qb16",mr9:"jqd2qb17",ml9:"jqd2qb18",mt9:"jqd2qb19",mb9:"jqd2qb1a",mr10:"jqd2qb1b",ml10:"jqd2qb1c",mt10:"jqd2qb1d",mb10:"jqd2qb1e",mr12:"jqd2qb1f",ml12:"jqd2qb1g",mt12:"jqd2qb1h",mb12:"jqd2qb1i",mr16:"jqd2qb1j",ml16:"jqd2qb1k",mt16:"jqd2qb1l",mb16:"jqd2qb1m",mr20:"jqd2qb1n",ml20:"jqd2qb1o",mt20:"jqd2qb1p",mb20:"jqd2qb1q",mr24:"jqd2qb1r",ml24:"jqd2qb1s",mt24:"jqd2qb1t",mb24:"jqd2qb1u",mr28:"jqd2qb1v",ml28:"jqd2qb1w",mt28:"jqd2qb1x",mb28:"jqd2qb1y",mr32:"jqd2qb1z",ml32:"jqd2qb20",mt32:"jqd2qb21",mb32:"jqd2qb22",mr36:"jqd2qb23",ml36:"jqd2qb24",mt36:"jqd2qb25",mb36:"jqd2qb26",mr40:"jqd2qb27",ml40:"jqd2qb28",mt40:"jqd2qb29",mb40:"jqd2qb2a",mr48:"jqd2qb2b",ml48:"jqd2qb2c",mt48:"jqd2qb2d",mb48:"jqd2qb2e",mr64:"jqd2qb2f",ml64:"jqd2qb2g",mt64:"jqd2qb2h",mb64:"jqd2qb2i",pr24:"jqd2qb2j",pl24:"jqd2qb2k",pt24:"jqd2qb2l",pb24:"jqd2qb2m",pr32:"jqd2qb2n",pl32:"jqd2qb2o",pt32:"jqd2qb2p",pb32:"jqd2qb2q",pr34:"jqd2qb2r",pl34:"jqd2qb2s",pt34:"jqd2qb2t",pb34:"jqd2qb2u",pr64:"jqd2qb2v",pl64:"jqd2qb2w",pt64:"jqd2qb2x",pb64:"jqd2qb2y",pr97:"jqd2qb2z",pl97:"jqd2qb30",pt97:"jqd2qb31",pb97:"jqd2qb32",flex_row:"jqd2qb33",flex_column:"jqd2qb34",flex_align_center:"jqd2qb35",flex_vertical_center:"jqd2qb36",flex_1:"jqd2qb37",flex_wrap:"jqd2qb38",flex_space_between:"jqd2qb39",relative:"jqd2qb3j",subBtnStyle:"jqd2qb3a",subTextStyle:"jqd2qb3b",mainBtnStyle:"jqd2qb3c",Contact:{replacePhoneView:"jqd2qb3d",tipArror:"jqd2qb3e",replaceLeftView:"jqd2qb3f",replaceCenterView:"jqd2qb3g",replaceRightView:"jqd2qb3h",replaceText:"jqd2qb3i"}};function Rr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((function(e){return Dr[e]})).filter(Boolean).join(" ")}var Ar=function(){var e=yr.useState((function(e){var t=e.sharedRoomInfo,n=e.resourceinfo,r=e.logInfo;return{sharedRoomInfo:t,resourceinfo:n,logInfo:r}})),t=e.sharedRoomInfo,n=e.resourceinfo,r=(e.logInfo,yr.useActions()),i=r.toggleShareRoomPersonMask,s=r.toggleRoomIntroductionMask,c=r.actionTraceLog,l=r.changeHotelRooms,u=t||{},d=u.minCount,f=u.maxCount,p=u.currentCount,m=u.status,h=u.name,v=(0,O.useMemo)((function(){if(oe.isEmpty(n))return"";if(m)return"1\u540d\u6210\u4eba\u9700\u8981\u4e0e\u540c\u6027\u56e2\u53cb\u62fc\u623f\uff0c\u5982\u4e0d\u60f3\u62fc\u623f\u53ef\u589e\u52a0\u623f\u95f4\u6570";var e=n["SINGLE_ROOM_CHARGE"]||[],t=e&&e.find((function(e){return e.Count===p}))||{},r=t.singleRoomTotalPrice,a=t.childBedTotalPrice;if(r||a){var o="\u9700\u652f\u4ed8";return a&&(o+="\u513f\u7ae5\u5360\u5e8a\u8d39\uffe5".concat(a).concat(r?"\uff0c":"")),r&&(o+="\u623f\u5dee\u8d39\uffe5".concat(r)),o}return""}),[n,m,p]);return oe.isEmpty(t)?null:(0,_r.jsxs)(D.View,{className:Rr("pt32","pb32"),children:[(0,_r.jsxs)(D.View,{className:Rr("flex_row","flex_align_center","flex_space_between"),children:[(0,_r.jsxs)(D.View,{className:Rr("flex_row","flex_align_center"),children:[(0,_r.jsx)(D.Text,{className:Rr("text30","#333","textBold"),children:"\u623f\u95f4\u6570"}),(0,_r.jsx)(D.Text,{"data-test-id":"room_introduction",className:Rr("text30","#666","fontIcon","mr4","ml9","mt4"),onClick:function(){s(!0)},children:"\ue931"})]}),(0,_r.jsx)(Er,{min:d,max:f,step:.5,cur:p,required:!0,onChange:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n,r){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:c("room_click"),console.log(n),l(n);case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()})]}),!!v&&(0,_r.jsxs)(D.View,{className:Rr("flex_row","flex_align_center","mt16",m?"mt16":""),children:[(0,_r.jsx)(D.Text,{className:Rr("text30","#f70","fontIcon","mr9","mt4"),children:"\uef89"}),(0,_r.jsx)(D.Text,{"data-test-id":"shareRoomTipText",className:Rr("text24","#f70"),children:v})]}),!!m&&(0,_r.jsx)(D.View,{className:Rr("mt16"),children:(0,_r.jsx)(Or,{"data-test-id":"shareroom",title:"\u62fc\u623f\u4fe1\u606f",text:h,placeholder:"\u8bf7\u9009\u62e9\u62fc\u623f\u4eba\u5458",clickEvent:function(){c("roomsharing_select"),i({status:!0})}})})]})},Mr=(0,O.memo)(Ar),Vr=O.memo(Ur),Lr=function(){var e=(0,O.useRef)(null),t=yr.useActions(),n=t.toggleBookLimitMask,r=t.choosePassenger,a=t.actionTraceLog,o=(t.rnPsgListCallBack,t.rnPassengerEditCallBack,t.traceKMActionLog,t.toggleSelectPassenger),i=t.ctrl,s=yr.useState((function(e){var t=e.taroInfo,n=e.ShowPassenger,r=e.passengerObj,a=e.selectIds,o=e.bookingLimit,i=e.staticEmotional,s=e.shoppingId,c=e.noPhoneError,l=e.tagInfo,u=e.CommonInfo,d=e.CommonPassengers,f=e.Segments,p=e.hotelMainGuest,m=e.productBasicInfo,h=e.orderBasicInfo,v=e.isQuickBooking;return{taroInfo:t,ShowPassenger:n,passengerObj:r,selectIds:a,bookingLimit:o,staticEmotional:i,shoppingId:s,noPhoneError:c,tagInfo:l,CommonInfo:u,CommonPassengers:d,Segments:f,hotelMainGuest:p,productBasicInfo:m,orderBasicInfo:h,isQuickBooking:v}})),c=s.taroInfo,l=s.ShowPassenger,u=void 0===l?[]:l,d=s.passengerObj,f=void 0===d?{}:d,p=s.selectIds,m=void 0===p?[]:p,h=s.bookingLimit,v=void 0===h?[]:h,g=s.staticEmotional,y=void 0===g?[]:g,_=s.shoppingId,b=s.noPhoneError,I=void 0===b?"":b,x=s.tagInfo,T=s.CommonInfo,k=s.CommonPassengers,S=s.Segments,C=s.hotelMainGuest,w=s.productBasicInfo,N=s.orderBasicInfo,E=s.isQuickBooking,P=x||{},j=P.isContainCarInfo,A=void 0!==j&&j,M=P.isHasHKTrain,V=void 0!==M&&M,L=(P.isHidePassengerType,(0,O.useMemo)((function(){return nn(S,y)}),[S,y])),B=(0,O.useMemo)((function(){return rn(S)}),[S]),U="";if(V&&m&&m.length)for(var Z=0;Z<m.length;Z++)if("CN"===f[m[Z]].Nationality){U="\u4e2d\u56fd\u5883\u5185\u65c5\u5ba2\u5165\u5883\u9999\u6e2f\u8bf7\u643a\u5e26\u597d\u6e2f\u6fb3\u901a\u884c\u8bc1\u53ca\u6709\u6548\u7b7e\u6ce8";break}var F=(0,O.useMemo)((function(){var e=T||{},t=e.ExtendInfos,n=void 0===t?[]:t;if(oe.isEmpty(n))return null;var r=n.filter((function(e){return"hotel_limit_country"===e.Type}))[0];return r?r.Content:null}),[T]),G=w||{},H=G.isPureDiyfhxsdp,q=N||{},K=q.AdultCount,z=void 0===K?0:K,Y=q.ChildCount,W=void 0===Y?0:Y,$=q.InfantCount,X=void 0===$?0:$,J=(0,O.useMemo)((function(){var e=[];return e.push("".concat(z,"\u6210\u4eba")),e.push("".concat(W,"\u513f\u7ae5")),H&&e.push("".concat(X,"\u5a74\u513f")),e}),[z,W,X,H]),Q=z+W+X,ee=Q-((null===m||void 0===m?void 0:m.length)||0),te=["\u8bf7\u52a1\u5fc5\u4fdd\u8bc1\u586b\u5199\u9879\u4e0e\u51fa\u6e38\u6240\u6301\u8bc1\u4ef6\u4e00\u81f4"];null!==F&&void 0!==F&&F.length&&te.push.apply(te,(0,R.Z)(F)),A&&te.push("\u63a5\u9001\u673a\u53f8\u673a\u5c06\u4e0e\u51fa\u884c\u4eba\u624b\u673a\u53f7\u7801\u8054\u7cfb\uff0c\u8bf7\u6ce8\u610f\u4fdd\u6301\u624b\u673a\u7545\u901a"),null!==C&&void 0!==C&&C.count&&null!==m&&void 0!==m&&m.length&&te.push("\u529e\u7406\u9152\u5e97\u5165\u4f4f\u65f6\uff0c\u8bf7\u63d0\u4f9b\u9152\u5e97\u5165\u4f4f\u767b\u8bb0\u4eba\u59d3\u540d");var ne=te.length>1;return(0,_r.jsxs)(D.View,{className:"ModuleBox PassengerBox",id:"Traveler",style:{padding:0},children:[(0,_r.jsxs)(D.View,{children:[!!E&&(0,_r.jsxs)(D.View,{className:Rr("flex_align_center","#666","pl32","pr32","pt32","pb24"),style:{boxShadow:"inset 0 -0.5px 0 #eee"},children:[(0,_r.jsxs)(D.Text,{className:Rr("text34","#333","textBold","flex_1"),children:["\u51fa\u884c\u4eba\uff1a",J.join("   ")]}),(0,_r.jsx)(D.Text,{className:Rr("text26","#0086f6","pl24"),onClick:function(){o(!0)},children:"\u4fee\u6539"})]}),(0,_r.jsxs)(D.View,{className:Rr("flex_align_center","#666","pl32","pr32","pt24","mb16"),children:[(0,_r.jsxs)(D.View,{className:Rr("flex_1","flex_align_center"),children:[(0,_r.jsxs)(D.Text,{className:Rr("text30","#333","textBold","mr12"),children:["\u9700\u9009 ",Q," \u4f4d\u6e38\u5ba2"]}),!!ee&&ee<Q&&(0,_r.jsxs)(D.View,{style:{background:"#f5f7fa",display:"inline-flex",alignItems:"center",justifyContent:"center",borderTopLeftRadius:45,borderTopRightRadius:50,borderBottomRightRadius:50,height:21,paddingLeft:8,paddingRight:7,color:"#333",fontSize:13,boxSizing:"border-box"},children:[(0,_r.jsx)(D.Text,{children:"\u8fd8\u9700\u9009"}),(0,_r.jsxs)(D.Text,{className:Rr("#f70"),children:["\xa0",ee,"\xa0"]}),(0,_r.jsx)(D.Text,{children:"\u4f4d"})]})]}),v&&v.length>0&&(0,_r.jsxs)(D.Text,{className:Rr("text26","#666","pl24"),onClick:function(){a("bookrestrictions_click"),n(!0)},children:["\u9884\u8ba2\u9650\u5236",(0,_r.jsxs)(D.Text,{className:Rr("fontIcon","#666","text30","ml4"),style:{verticalAlign:"middle"},children:[" ","\ue931"]})]})]}),(0,_r.jsx)(D.View,{className:Rr("flex_column","gap4","pl32","pr32"),children:te.map((function(e,t){return(0,_r.jsxs)(D.View,{className:Rr("text26","#666"),children:[!!ne&&(0,_r.jsx)(D.Text,{className:Rr("textBold"),children:"\xb7 "}),e]},t)}))})]}),(0,_r.jsxs)(D.View,{className:"ModuleBox ModuleContent",children:[(0,_r.jsxs)(D.View,{className:"passenger_label_card flex_box split_line",children:[u.length>0&&u.map((function(t,n){var o=oe.includes(m,t);return o?(0,_r.jsxs)(D.View,{className:"passenger_label_item cur",onClick:function(){var n=Date.now(),o=e.current||0;(!o||n-o>=500)&&(e.current=n,a("travelers_click"),r(t))},children:[(0,_r.jsx)(D.Text,{className:"passenger_name",children:Zt(t,f)}),(0,_r.jsx)(D.View,{className:"iconfont_check_box",children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_btn_check"})})]}):(0,_r.jsx)(D.View,{className:"passenger_label_item",onClick:function(){var n=Date.now(),a=e.current||0;(!a||n-a>=500)&&(e.current=n,r(t))},children:(0,_r.jsx)(D.Text,{className:"passenger_name",children:Zt(t,f)})})})),(0,_r.jsx)(D.View,{className:"passenger_label_item",onClick:function(){a("travelers_select_click"),i&&i.goToPassengerList({shoppingId:_,selectIds:m,passengerObj:f,taroInfo:c})},children:(0,_r.jsxs)(D.Text,{className:"passenger_name",children:["\u9009\u62e9\u51fa\u884c\u4eba",(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward"})]})})]}),m&&m.length>0&&(0,_r.jsx)(D.View,{className:"passenger_selected_card",children:m.map((function(e,t){var n=f[e]||{},o=n.idInfo,s=void 0===o?{}:o,l=(n.idInfos,n.PassengerID),u=n.AgeRang,d=n.isComplete,p=(n.MayChange,n.defaultPhoneInfo,n.Nationality,n.prompts),m=void 0===p?[]:p,h=Zt(e,f,k,!0),v=[{idtype:s.cardName,idno:ze(s||{})}],g=[];if(d&&m&&m.length&&oe.forEach(m,(function(e){var t=e||{},n=t.tips,r=void 0===n?[]:n;oe.forEach(r,(function(e){null!==e&&void 0!==e&&e.tips&&oe.forEach(e.tips,(function(e){null!==e&&void 0!==e&&e.text&&g.push(e.text)}))}))})),B){var y=qt(n,B);n.age&&n.age<=12&&1!==n.AgeRang&&y>=12&&L&&g.push(L)}var b=!1;return null!==C&&void 0!==C&&C.count&&t<C.count&&(b=!0),(0,_r.jsxs)(D.View,{className:"passenger_selected_item flex_box split_line",children:[(0,_r.jsx)(D.View,{className:"passenger_delete_box",onClick:function(){a("travelers_delete"),r(l)},children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_delete"})}),(0,_r.jsxs)(D.View,{className:"passenger_info_box flex_1",onClick:function(){a("travelers_detail"),i&&i.goToPassengerEdit({shoppingId:_,passengerId:e,chosenInfo:null===n||void 0===n?void 0:n.chosenInfo,taroInfo:c})},children:[(0,_r.jsx)(Vr,{taroInfo:c,name:h,ageRang:u,index:t,isHotelGuest:b}),v&&v.length>0&&v.map((function(e,t){return(0,_r.jsxs)(D.View,{className:"sub_con",children:[e.idtype," ",e.idno]},t)})),!d&&(0,_r.jsxs)(D.View,{className:"sub_con txt_warning",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_warning"}),(0,_r.jsx)(D.View,{className:"text",children:"\u4fe1\u606f\u4e0d\u5168\u6216\u6709\u8bef\uff0c\u70b9\u51fb\u8865\u5145"})]}),g&&g.length>0&&g.map((function(e,t){return(0,_r.jsxs)(D.View,{className:"sub_con txt_orange",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_tips"}),(0,_r.jsx)(D.View,{className:"text",children:e})]},t)}))]}),(0,_r.jsx)(D.View,{className:"passenger_arrow_box",children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward"})})]})}))}),(0,_r.jsxs)(D.View,{className:"tips_card",children:[!!I&&(0,_r.jsxs)(D.View,{className:"txt_warning",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_warning"}),(0,_r.jsx)(D.View,{className:"text",children:I})]}),!!U&&(0,_r.jsx)(D.View,{className:"weak_tips_box",children:(0,_r.jsxs)(D.View,{className:"txt_weak",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_tips"}),(0,_r.jsx)(D.View,{className:"text",children:U})]})})]}),(0,_r.jsx)(Mr,{})]})]})},Br=Lr;function Ur(e){var t=(0,O.useRef)(null),n=e.taroInfo,r=e.name,a=e.ageRang,o=e.isHotelGuest,i=void 0!==o&&o,s=e.index,c=n.windowWidth,l=(0,O.useState)(0),u=(0,M.Z)(l,2),d=u[0],f=u[1];return(0,O.useEffect)((function(){try{if(!t.current)return;setTimeout((function(){h().createSelectorQuery().select("#passenger_name").boundingClientRect((function(e){if(e){var t=e.width;console.log(t);var n=135;i&&(n+=98),console.log("".concat(s,"--------").concat(c-n,"--------------").concat(t)),f(c-n>t?1:2)}else f(1)})).exec()}),200)}catch(e){console.log(e)}}),[t.current,r]),(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsxs)(D.View,{className:"main_con",children:[(0,_r.jsx)(D.Text,{ref:t,id:"passenger_name",className:"sub-name",children:r}),1===d&&(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsx)(D.Text,{className:"sub-type",children:1===a?"\u6210\u4eba":2===a?"\u5a74\u513f":"\u513f\u7ae5"}),!!i&&(0,_r.jsx)(D.Text,{className:"sub-type sub-hotel-type",children:"\u9152\u5e97\u5165\u4f4f\u767b\u8bb0\u4eba"})]})]}),2===d&&(0,_r.jsxs)(D.View,{className:"main_con",children:[(0,_r.jsx)(D.Text,{className:"sub-type",children:1===a?"\u6210\u4eba":2===a?"\u5a74\u513f":"\u513f\u7ae5"}),!!i&&(0,_r.jsx)(D.Text,{className:"sub-type sub-hotel-type",children:"\u9152\u5e97\u5165\u4f4f\u767b\u8bb0\u4eba"})]})]})}var Zr=n(94262),Fr=n(77610),Gr=function(e){var t=e.token,n=e.type,r=e.count,a=e.mimCount,o=e.maxCount,i=e.order,s=e.category,c=yr.useState((function(e){var t=e.selectIds,n=e.passengerObj,r=e.ResourcePassengerMapList,a=e.template,o=e.orderBasicInfo,i=e.ErrorTokenList,s=e.logInfo;return{selectIds:t,passengerObj:n,ResourcePassengerMapList:r,template:a,orderBasicInfo:o,ErrorTokenList:i,logInfo:s}})),l=c.selectIds,u=c.passengerObj,d=c.ResourcePassengerMapList,f=(c.template,c.orderBasicInfo),p=c.ErrorTokenList,m=void 0===p?[]:p,h=(c.logInfo,yr.useActions()),v=h.toggleInsuranceSelectPersonMask,g=h.toggleResourceSelectPersonMask,y=h.toggleCruiseSelectPersonMask,_=h.actionTraceLog,b=h.clickTraceLog,I=f||{},x=(I.AdultCount,I.ChildCount,I.totalPersonCount),T=void 0===x?0:x;if(!l||l.length!==T)return null;var k="";k=a&&o?a!==o?"".concat(a,"-").concat(o):a+"":r+"";var S="\u4f7f\u7528\u4eba",C="\u8bf7\u9009\u62e9".concat(k,"\u4f4d\u4f7f\u7528\u4eba"),w="\u8bf7\u9009\u62e9".concat(k,"\u4f4d\u4f7f\u7528\u4eba");"insurance"===n?(S="\u88ab\u4fdd\u4eba",C="\u8bf7\u8865\u5145\u88ab\u4fdd\u4eba\u4fe1\u606f"):"cruise"===n&&(S="".concat(i?"\u7b2c"+i+"\u95f4":"\u4f7f\u7528\u4eba"),C="\u8231\u623f\u4f7f\u7528\u4eba\u4e0d\u80fd\u4e3a\u7a7a",w="\u8bf7\u9009\u62e9".concat(k,"\u4eba"));var N=d&&d.filter((function(e){return e.ResourceToken===t}))[0]||{},E=!1;"insurance"===n?oe.isEmpty(N)&&(E=!0):oe.isEmpty(N)&&m&&oe.includes(m,t)&&(E=!0);var P=[];if(E)"insurance"===n&&(P=l.map((function(e){return Zt(e,u)})));else{var j=N.PassengerTokenList,O=void 0===j?[]:j;P=O.map((function(e){return Zt(e,u)}))}14===s&&(P=P.slice(0,1));var R=P.length?P.join(","):"";return(0,_r.jsxs)(D.View,{className:"flex_box resouce_info_user",children:[(0,_r.jsx)(D.View,{className:"flex_0",children:(0,_r.jsx)(D.View,{className:"item_name",children:S})}),(0,_r.jsxs)(D.View,{className:"flex_1",onClick:function(){"insurance"===n?(_("insurant_click"),v({status:!0,selectedToken:t})):"cruise"===n?(b("cru-pageid-pkgmore-click"),y({status:!0,selectedToken:t})):(_("resource_user_click"),g({status:!0,selectedToken:t}))},children:[(0,_r.jsxs)(D.View,{className:"main_con ".concat(R?"":"blur"),children:[(0,_r.jsx)(D.View,{className:"text",children:R||w}),(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward"})]}),!!E&&(0,_r.jsxs)(D.View,{className:"sub_con txt_warning",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_warning"}),(0,_r.jsx)(D.View,{className:"text",children:C})]})]})]})},Hr=Gr,qr=function(){var e=yr.useState((function(e){var t=e.ResourcePassengers,n=e.orderBasicInfo,r=e.selectIds,a=e.ResourcePassengerMapList,o=e.passengerObj,i=e.logInfo,s=e.cruise,c=e.ErrorTokenList;return{ResourcePassengers:t,orderBasicInfo:n,selectIds:r,ResourcePassengerMapList:a,passengerObj:o,logInfo:i,cruise:s,ErrorTokenList:c}})),t=e.ResourcePassengers,n=e.orderBasicInfo,r=e.selectIds,a=e.ResourcePassengerMapList,o=e.passengerObj,i=void 0===o?{}:o,s=e.logInfo;e.cruise,e.ErrorTokenList;if(!t||!t.length)return null;var c=n||{},l=c.totalPersonCount,u=void 0===l?0:l;return(0,_r.jsxs)(D.View,{className:"ModuleBox",children:[(0,_r.jsxs)(D.View,{className:"ModuleTitle",children:[(0,_r.jsx)(D.View,{className:"main_title",children:"\u8d44\u6e90\u4fe1\u606f"}),(0,_r.jsx)(D.View,{className:"sub_text",children:"\u4ee5\u4e0b\u8d44\u6e90\u9700\u9009\u62e9\u5b9e\u9645\u4f7f\u7528\u4eba"})]}),(0,_r.jsx)(D.View,{className:"ModuleContent",children:t.map((function(e,t){var n=e.ResourceInfo,o=void 0===n?{}:n,c=e.PassengerInfo,l=void 0===c?{}:c,d=l.AdultCount,f=l.ChildCount,p=o.Token,m=(o.ResourceType,o.CategoryId,o.MinAge,o.MaxAge,o.ResourceName),h=void 0===m?"":m,v=o.Count,g=void 0===v?0:v,y=o.ChargeUnit,_=a&&a.filter((function(e){return e.ResourceToken===p}))[0]||{},b=[];return _&&_.PassengerTokenList&&(b=_.PassengerTokenList.map((function(e){return Zt(e,i[e])}))),(0,_r.jsx)(zr,{Token:p,ResourceName:h,Count:g,ChargeUnit:y,selectIds:r,totalPersonCount:u,AdultCount:d,ChildCount:f,logInfo:s,names:b},t)}))})]})},Kr=qr;function zr(e){var t=(0,Fr.Z)({},((0,Zr.Z)(e),e)),n=yr.useActions(),r=(n.toggleResourceSelectPersonMask,n.actionTraceLog,t.Token),a=t.ResourceName,o=t.Count,i=t.ChargeUnit,s=t.selectIds,c=t.totalPersonCount,l=t.AdultCount,u=t.ChildCount;t.logInfo,t.names;return(0,_r.jsxs)(D.View,{className:"resource_info_card_item",children:[(0,_r.jsxs)(D.View,{className:"content_title",children:[a,(0,_r.jsxs)(D.Text,{className:"sub_right",children:["x",o,i]})]}),s&&c===s.length&&(0,_r.jsx)(Hr,{token:r,type:"resource",count:l+u})]})}function Yr(e){var t=e.checked,n=e.onpress,r=(e.testid,e.label);return t?(0,_r.jsxs)(D.View,{className:"flex",onClick:function(e){n&&n()},children:[(0,_r.jsx)(D.View,{className:"checkbox checked"}),!!r&&(0,_r.jsx)(D.Text,{className:"label_text",children:r})]}):(0,_r.jsxs)(D.View,{className:"flex",onClick:function(e){n&&n()},children:[(0,_r.jsx)(D.View,{className:"checkbox"}),!!r&&(0,_r.jsx)(D.Text,{className:"label_text",children:r})]})}var Wr=(0,O.memo)(ea),$r=(0,O.memo)(Xr);function Xr(){var e=yr.useState((function(e){var t=e.selectIds,n=e.passengerObj,r=e.logInfo,a=e.template,o=e.orderBasicInfo,i=e.TrainPassengerMapList,s=e.trainInfo,c=e.selectedTrainSeats,l=e.trainSeatNum,u=e.tagInfo,d=e.trainChildPassengerIds;return{selectIds:t,passengerObj:n,logInfo:r,template:a,orderBasicInfo:o,TrainPassengerMapList:i,trainInfo:s,selectedTrainSeats:c,trainSeatNum:l,tagInfo:u,trainChildPassengerIds:d}})),t=e.selectIds,n=void 0===t?[]:t,r=(e.passengerObj,e.logInfo,e.template,e.orderBasicInfo),a=(e.TrainPassengerMapList,e.trainInfo),o=e.selectedTrainSeats,i=e.trainSeatNum,s=e.tagInfo,c=e.trainChildPassengerIds,l=s||{},u=l.isTrain,d=void 0!==u&&u,f=a||{},p=f.isSupportSelectSeat,m=void 0!==p&&p,h=r||{},v=h.totalPersonCount,g=void 0===v?0:v;return d&&null!==n&&void 0!==n&&n.length&&n.length===g&&(m||null!==c&&void 0!==c&&c.length)?(0,_r.jsxs)(D.View,{className:"ModuleBox",id:"TrainTicketType",children:[(0,_r.jsx)(Jr,{trainInfo:a}),(0,_r.jsx)(Qr,{}),(0,_r.jsx)(D.View,{className:"ModuleContent",children:!!m&&(0,_r.jsx)(Wr,{selectedTrainSeats:o,trainInfo:a,trainSeatNum:i})})]}):null}function Jr(e){var t=e.trainInfo,n=yr.useActions(),r=n.toggleTrainDetailMask,a=t||{},o=a.isSupportSelectSeat,i=void 0!==o&&o,s=a.data,c=void 0===s?[]:s;return(0,_r.jsx)(D.View,{className:"ModuleTitle",children:(0,_r.jsxs)(D.View,{className:"main_title",children:[i?"\u706b\u8f66\u7968\u4fe1\u606f":"\u706b\u8f66\u7968\u7968\u79cd\u7c7b\u578b",c&&c.length>0&&(0,_r.jsx)(D.Text,{onClick:function(){r(!0)},className:"sub_right_title",children:"\u8f66\u6b21\u8be6\u60c5"})]})})}var Qr=function(){var e=yr.useState((function(e){var t=e.trainChildPassengerIds,n=e.passengerObj,r=e.TrainPassengerMapList,a=e.trainErrorPassengerList;return{trainChildPassengerIds:t,passengerObj:n,TrainPassengerMapList:r,trainErrorPassengerList:a}})),t=e.trainChildPassengerIds,n=void 0===t?[]:t,r=e.passengerObj,a=e.TrainPassengerMapList,o=e.trainErrorPassengerList,i=void 0===o?[]:o,s=yr.useActions(),c=s.handleChangeTrainChildType,l=s.toggleTrainSelectPersonMask,u=s.toggleTrainHeightMask;return oe.isEmpty(n)?null:(0,_r.jsxs)(D.View,{className:Rr("mt32"),children:[(0,_r.jsx)(D.View,{className:Rr("#333","textBold"),children:"\u9700\u4e3a6\u5c81\u4ee5\u4e0b\u513f\u7ae5\u9009\u62e9\u4e58\u8f66\u65b9\u5f0f"}),(0,_r.jsx)(D.View,{children:(0,_r.jsxs)(D.Text,{className:Rr("#999","text26"),onClick:function(){u(!0)},children:[(0,_r.jsx)(D.Text,{className:Rr("#f70"),children:"\u514d\u8d39\u4e58\u8f66\u513f\u7ae5\u4e0d\u5360\u5ea7\u4f4d"}),"\u4e14\u9700\u9009\u62e9\u5173\u8054\u4e58\u8f66\u4eba\u51fa\u7968\u540e\u4e3a\u60a8\u81ea\u52a8\u7533\u62a5; \u5982\u9700\u5ea7\u4f4d\u53ef\u8d2d\u4e70\u513f\u7ae5\u7968 ",(0,_r.jsx)(D.Text,{className:Rr("#0086f6"),children:"\u513f\u7ae5\u7968\u987b\u77e5"})]})}),(0,_r.jsx)(D.View,{style:{borderRadius:4,marginTop:8,background:"#f6f8fa"},className:Rr("pl24","pr24"),children:n.map((function(e,t){var o=r[e],s=o.AgeRang,u=o.Height,d="";if(a&&a.length>0){var f=a.filter((function(t){return+t.ChildPassengerToken==e}))[0];f&&(d=Zt(f.AdultPassengerToken,r,null,!1))}return(0,_r.jsxs)(D.View,{style:t!==n.length-1&&{borderBottom:"1px solid #eee"},className:Rr("pt32","pb32"),children:[(0,_r.jsxs)(D.View,{className:Rr("flex_row"),children:[(0,_r.jsxs)(D.View,{className:Rr("flex_align_center","flex_row","flex_1"),children:[(0,_r.jsx)(D.Text,{className:Rr("#333","mr8"),style:{fontSize:15},children:Zt(e,r,null,!1)}),(0,_r.jsx)(D.View,{style:{padding:"0 3px",border:"1px solid #0086F6",color:"#0086f6",fontSize:11,borderRadius:2},children:1===s?"\u6210\u4eba":2===s?"\u5a74\u513f":"\u513f\u7ae5"})]}),(0,_r.jsxs)(D.View,{className:Rr("flex_row"),children:[(0,_r.jsx)(D.View,{className:Rr("flex_row","flex_align_center","mr32"),children:(0,_r.jsx)(Yr,{checked:u===Pe.free,label:"\u514d\u8d39\u4e58\u8f66",onpress:function(){c(e,Pe.free)}})}),(0,_r.jsx)(D.View,{className:Rr("flex_row","flex_align_center"),children:(0,_r.jsx)(Yr,{checked:u===Pe.child,label:"\u8d2d\u4e70\u513f\u7ae5\u7968",onpress:function(){c(e,Pe.child)}})})]})]}),u===Pe.free&&(0,_r.jsxs)(D.View,{className:Rr("pl24","pr24","pt24","pb24","mt28","flex_row"),style:{background:"#fff",position:"relative"},children:[(0,_r.jsx)(D.View,{className:Rr("text30"),children:"\u5173\u8054\u6210\u4eba"}),(0,_r.jsxs)(D.View,{className:Rr("ml32","flex_row","flex_1","flex_align_center"),onClick:function(){l({status:!0,selectedPassenger:o})},children:[(0,_r.jsxs)(D.View,{className:Rr("text30","mr24","flex_1","flex_column"),style:{gap:6},children:[d?(0,_r.jsx)(D.Text,{className:Rr("#333"),children:d}):(0,_r.jsx)(D.Text,{className:Rr("#ccc"),children:"\u8bf7\u9009\u62e9"}),!(null===i||void 0===i||!i.includes(e))&&(0,_r.jsxs)(D.View,{className:"train_login_danger",children:[(0,_r.jsx)(D.Text,{className:"train_login_danger_icon prs_iconfont iconfont_strong_warning"}),(0,_r.jsx)(D.Text,{className:"train_login_danger_txt",children:"\u8bf7\u9009\u62e9\u5173\u8054\u6210\u4eba"})]})]}),(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward",style:{color:"#ccc"}})]}),(0,_r.jsx)(D.View,{style:{width:10,height:10,backgroundColor:"#fff",position:"absolute",right:186,top:-5,transform:"rotate(45deg)"}})]})]},t)}))})]})};function ea(e){var t=e.selectedTrainSeats,n=e.trainInfo,r=e.trainSeatNum,a=yr.useActions(),o=a.ctrl,i=a.toggleTrainSelectSeatMask,s=(a.updateTrainSelectedSeat,(0,O.useState)(!1)),c=(0,M.Z)(s,2),l=c[0],u=c[1],d=t.filter((function(e){return e.SeatNumbers&&e.SeatNumbers.length}))||[];return(0,O.useEffect)((function(){if(r&&d&&d.length){var e=d[0].SeatNumbers.length;e!==r&&r<=5&&(u(!0),o&&o.showToast&&o.showToast("\u9009\u5ea7\u4eba\u6570\u53d8\u5316\uff0c\u8bf7\u91cd\u9009\u706b\u8f66\u7968\u5ea7\u4f4d"))}else u(!1)}),[r]),(0,_r.jsxs)(D.View,{className:"train_card",children:[(0,_r.jsx)(D.View,{className:"card_title",children:"\u5728\u7ebf\u9009\u5ea7 (\u9009\u586b)"}),r>5?(0,_r.jsxs)(D.View,{className:"txt_orange",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_tips"}),(0,_r.jsx)(D.View,{className:"text",children:"\u706b\u8f66\u7968\u6682\u4e0d\u652f\u63015\u4eba\u4ee5\u4e0a\u51fa\u884c\u4eba\u9009\u5ea7"})]}):(0,_r.jsx)(D.View,{className:"sub_text",children:"\u4f18\u5148\u6309\u6307\u5b9a\u5ea7\u4f4d\u51fa\u7968\uff0c\u82e5\u6307\u5b9a\u5ea7\u4f4d\u65e0\u7968\uff0c\u5c06\u8f6c\u8d2d\u5176\u4ed6\u5ea7\u4f4d\uff0c\u652f\u6301\u975e\u62a2\u7968\u884c\u7a0b\u6bb5G/D/C\u8f66\u6b21\u7684\u4e8c\u7b49\u5ea7\u3001\u4e00\u7b49\u5ea7\u548c\u5546\u52a1\u5ea7\u9009\u5ea7"}),r<=5&&(0,_r.jsx)(D.View,{className:"train_card_item_box",children:(0,_r.jsxs)(D.View,{className:"train_card_item flex_box",children:[(0,_r.jsx)(D.View,{className:"flex_0",children:(0,_r.jsx)(D.View,{className:"item_name",children:"\u6307\u5b9a\u5ea7\u4f4d"})}),(0,_r.jsx)(D.View,{className:"flex_1",onClick:function(){i(!0),u(!1)},children:oe.isEmpty(d)?(0,_r.jsxs)(D.View,{className:"main_con blur",children:[(0,_r.jsx)(D.View,{className:"text",children:"\u82e5\u9700\u6307\u5b9a\u5ea7\u4f4d\uff0c\u8bf7\u9009\u62e9"}),(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward"})]}):(0,_r.jsx)(ta,{retSeats:d,trainInfo:n})})]})}),!!l&&(0,_r.jsxs)(D.View,{className:"txt_orange",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_tips"}),(0,_r.jsx)(D.View,{className:"text",children:"\u9009\u5ea7\u4eba\u6570\u53d8\u5316\uff0c\u8bf7\u91cd\u9009\u706b\u8f66\u7968\u5ea7\u4f4d"})]})]})}function ta(e){var t=e.retSeats,n=e.trainInfo;if(oe.isEmpty(t))return null;var r=Mn(t)||{};return(0,_r.jsx)(D.View,{className:"main_con",children:t.map((function(e,t){var a=e||{},o=a.SegmentNo,i=a.TrainNo,s=n.data,c=void 0===s?[]:s,l=c.filter((function(e){return e.segmentNo===o&&e.trainNo===i}))[0]||{};return(0,_r.jsxs)(D.View,{className:"seat_con",children:[(0,_r.jsx)(D.Text,{className:"num",children:null===l||void 0===l?void 0:l.trainIndex}),(0,_r.jsxs)(D.View,{className:"flex_box seat_con_item",children:[(0,_r.jsxs)(D.View,{className:"train_num",children:[null===l||void 0===l?void 0:l.departCityName,(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_to"}),null===l||void 0===l?void 0:l.arriveCityName]}),(0,_r.jsx)(D.View,{className:"seat_con_line"}),(0,_r.jsx)(D.View,{children:null===l||void 0===l?void 0:l.trainNo}),(0,_r.jsx)(D.View,{className:"seat_con_line"}),(0,_r.jsx)(D.View,{children:null===l||void 0===l?void 0:l.seatName})]}),!!r[o]&&(0,_r.jsx)(D.View,{children:r[o]})]})}))})}var na=Dr.Contact,ra=function(e){return e["Name"]="Name",e["Moblie"]="Moblie",e["Email"]="Email",e["ContactIDCardNumber"]="ContactIDCardNumber",e["GivenName"]="GivenName",e}({}),aa=function(e){var t=e.title,n=e.placeholderText,r=e.initialValue,a=e.type,o=e.valueChangeCallback,i=e.maxlength,s=void 0===i?-1:i,c=e.valueCheckCallback,l=(e.readOnly,e.countryCodeChangeCallback),u=e.countryCodeReadOnly,d=void 0!==u&&u,f=e.tips,p=e.idTypeList,m=void 0===p?[]:p,h=e.errorMessage,v=void 0===h?"":h,g=e.countryCode,_=e.selectMemberCard,b=e.isMember,I=e.focusCallback,x=(0,O.useState)(r||""),T=(0,M.Z)(x,2),k=T[0],S=T[1],C=(0,O.useState)(!1),w=(0,M.Z)(C,2),N=w[0],E=w[1],P=(0,O.useState)(!r||a!==ra.Moblie),j=(0,M.Z)(P,2),R=j[0],A=j[1],V=(0,O.useState)(!1),L=(0,M.Z)(V,2),B=L[0],U=L[1];(0,O.useEffect)((function(){var e=r;!R&&a===ra.Moblie&&r&&(e=e.trim(),e=qe(e)),S(e)}),[r]);var Z=function(e){var t,n=null===e||void 0===e||null===(t=e.detail)||void 0===t?void 0:t.value;if(n=n&&n.trim(),n&&(a===ra.Name||a===ra.GivenName?(n=n.trim(),n=n.replace(/[\u2219\u2022\u30FB\u25CF]/g,"\xb7")):/\s/g.test(n)&&(n=n.replace(/\s/g,"")),a===ra.Moblie)){if(!R){var r;if(n="",k&&null!==e&&void 0!==e&&null!==(r=e.detail)&&void 0!==r&&r.value){var o=e.detail.value.replace(k,"");o!=e.detail.value&&(n=o),n=n.replace(/[^\d]/g,"")}A(!0)}n=n.replace(/[^\d]/g,"")}S(n)},F=function(e){E(!0),I&&I(),y().uploadUserAction(e,"vac_order_contact_".concat(a))},G=function(e){if(console.log("handleBlur"),B)U(!1);else{E(!1);var t=k;"Moblie"===a&&(t=R?k:r),o(t,a),c(a)}},H=function(e){console.log("handleClear"),E(!0),S(""),R||A(!0),o("",a),y().uploadUserAction(e,"vac_order_contact_".concat(a,"_close"))},q=function(e){U(!0)};return console.log("ContactInput render===="),(0,_r.jsxs)(D.View,{className:"flex_box split_line",style:"Name"===a?{position:"relative",zIndex:3}:null,children:[(0,_r.jsx)(D.View,{className:"flex_0",children:(0,_r.jsxs)(D.View,{className:"item_name",onClick:m&&m.length>1?_:null,children:[t,!!m&&m.length>1&&(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_arrow_down"})]})}),(0,_r.jsxs)(D.View,{className:"flex_1",children:[(0,_r.jsxs)(D.View,{className:"main_con ".concat(a===ra.Moblie?"flex_box":""),children:[a===ra.Moblie&&(0,_r.jsxs)(D.View,{className:"area_code flex_0",onClick:l,children:["+",g,!d&&(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_arrow_down"})]}),(0,_r.jsxs)(D.View,{className:"contact_card_item text ".concat(a===ra.Moblie?Rr("flex_column","flex_1"):""),style:{position:"relative"},children:[(0,_r.jsx)(D.Input,{className:"contact_input",placeholder:n,value:k,maxlength:s,onInput:Z,onFocus:F,onBlur:G,type:a===ra.Moblie?"number":"text"}),a===ra.Moblie&&!v&&(0,_r.jsx)(ca,{}),!!N&&k&&(0,_r.jsx)(D.View,{className:"clear_input",onTouchStart:q,onClick:H})]})]}),!!b&&(0,_r.jsx)(ia,{value:k}),!!f&&(0,_r.jsx)(D.View,{className:"sub_con txt_grey",children:(0,_r.jsx)(D.View,{className:"text",children:f})}),Array.isArray(v)&&v.length>0&&(0,_r.jsx)(D.View,{className:"sub_con",children:v.map((function(e,t){return(0,_r.jsxs)(D.View,{className:"txt_red txt_warning",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_warning"}),(0,_r.jsx)(D.Text,{className:"text",children:e})]},t)}))}),"string"===typeof v&&!!v&&(0,_r.jsx)(D.View,{className:"sub_con",children:(0,_r.jsxs)(D.View,{className:"txt_red txt_warning",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_warning"}),(0,_r.jsx)(D.Text,{className:"text",children:v})]})})]})]})},oa=O.memo(aa);function ia(e){var t=e.value,n=yr.useState((function(e){var t=e.selectIds,n=e.passengerObj,r=e.contactShowItems;return{selectIds:t,passengerObj:n,contactShowItems:r}})),r=n.selectIds,a=n.passengerObj,o=yr.useActions(),i=o.toggleHotelSelectContactMask,s=o.handleToSplitCnName,c=(0,O.useState)(0),l=(0,M.Z)(c,2),u=l[0],d=l[1];return(0,O.useEffect)((function(){!t&&r&&r.length?u||d(1):1===u&&d(0)}),[t,r]),(0,_r.jsx)(_r.Fragment,{children:1===u&&(0,_r.jsxs)(D.View,{className:"modInputTipView",children:[(0,_r.jsx)(D.ScrollView,{className:"modInputTipScroll",scrollX:!0,scrollWithAnimation:!0,children:(0,_r.jsx)(D.View,{className:"modTipNameWrap",children:r.map((function(e){var t=Zt(e,a);return(0,_r.jsx)(D.View,{className:"modTipNameView",onClick:function(){s(e)},children:(0,_r.jsx)(D.Text,{className:"text",children:t})},e)}))})}),!!r&&r.length>=3&&(0,_r.jsx)(D.View,{className:"modInputTipMore",onClick:function(){i(!0)},children:(0,_r.jsx)(D.Text,{className:"Text26_32 color_blue",children:"\u66f4\u591a"})}),(0,_r.jsx)(D.View,{className:"modInputTipClose",onClick:function(){d(-1)},children:(0,_r.jsx)(D.Text,{className:"modInputTipCloseIcon",children:"\ue940"})}),(0,_r.jsx)(D.View,{className:"modPopArr"})]})})}var sa=function(){var e=yr.useState((function(e){var t=e.contactDealInfo;return{contactDealInfo:t}})),t=e.contactDealInfo,n=yr.useActions(),r=n.repalceContactMobile,a=n.clearRepalceMobile,o=t||{},i=o.replaceInfo,s=i||{},c=s.mobile,l=s.name,u=s.mulRepalceTipMessage,d=s.isReplaceOver;return!d&&c&&l?(0,_r.jsx)(D.View,{className:Rr("flex_row","mb2","mt24"),style:{marginRight:"-16px"},children:(0,_r.jsxs)(D.View,{className:na.replacePhoneView,children:[u?(0,_r.jsx)(D.View,{className:na.replaceCenterView,children:(0,_r.jsx)(D.Text,{className:na.replaceText,children:u})}):(0,_r.jsxs)(D.View,{className:Rr("flex_row","flex_1"),onClick:function(){r(i)},children:[(0,_r.jsx)(D.View,{className:na.replaceLeftView,onClick:function(){},children:(0,_r.jsx)(D.Text,{className:na.replaceText,children:"\u66ff\u6362\u6210"})}),(0,_r.jsxs)(D.View,{className:"".concat(na.replaceCenterView," ").concat(Rr("pl24")),children:[(0,_r.jsx)(D.Text,{className:na.replaceText,style:{marginBottom:"2px"},children:He(c)}),(0,_r.jsx)(D.Text,{className:na.replaceText,children:l})]})]}),(0,_r.jsx)(D.View,{className:na.replaceRightView,onClick:function(){a()},children:(0,_r.jsx)(D.Text,{className:Rr("text28","fontIcon","#666"),children:"\ue940"})}),(0,_r.jsx)(D.View,{className:na.tipArror})]})}):null},ca=O.memo(sa),la=function(){var e=yr.useState((function(e){var t=e.ContactInfo,n=e.contactShowItems,r=e.contactTemplate,a=e.ErrorContactMsg,o=e.tagInfo,i=e.logInfo,s=e.memberinfo,c=e.selectIds,l=e.passengerObj,u=e.isSubmit;return{ContactInfo:t,contactShowItems:n,contactTemplate:r,ErrorContactMsg:a,tagInfo:o,logInfo:i,memberinfo:s,selectIds:c,passengerObj:l,isSubmit:u}})),t=e.ContactInfo,n=e.contactShowItems,r=e.contactTemplate,a=e.ErrorContactMsg,o=e.tagInfo,i=(e.logInfo,e.memberinfo),s=(e.selectIds,e.passengerObj,e.isSubmit),c=yr.useActions(),l=c.ctrl,u=c.changeMemberInfo,d=c.checkMemberInfo,f=c.toggleMemberCardsMask,p=c.toggleCountryCodeMask,m=c.actionTraceLog,h=c.selectHotelRegNotice,v=c.beforeReturnPage,g=c.handleToSplitPinYin,y=c.clearRepalceMobile;a=a||{};var _=o||{},b=_.isMember,I=void 0!==b&&b,x=r||{},T=(x.cardRelationRules,x.idTypes),k=void 0===T?[]:T,S=x.idOptions,C=void 0===S?[]:S,w=x.isNeedEmail,N=void 0!==w&&w,E=(x.channelType,x.items),P=void 0===E?{}:E,j=t||{},R=j.IdCardType,A=void 0===R?0:R,M=j.Name,V=void 0===M?"":M,L=j.ContactIDCardNumber,B=void 0===L?"":L,U=j.Moblie,Z=void 0===U?"":U,F=j.CountryCode,G=void 0===F?"":F,H=j.Email,q=void 0===H?"":H,K=j.Gender,z=void 0===K?-1:K,Y=(j.CountryName,t||{}),W=Y.SurenameCN,$=void 0===W?"":W,X=Y.GivenNameCN,J=void 0===X?"":X,Q=Y.Surname,ee=void 0===Q?"":Q,te=Y.GivenName,ne=void 0===te?"":te,re=Y.BirthDate,ae=void 0===re?"":re,ie=i||{},se=ie.flights,ce=void 0===se?{}:se,le=ie.rooms,ue=void 0===le?[]:le,de=ie.mgrGroup,fe=void 0===de?{}:de,pe=ie.topTip,me=void 0===pe?"":pe,he=ie.isCheckPrivacyTerms,ve=void 0!==he&&he,ge=ie.privacyTerms,ye=ie.isNeedRegiHotel,_e=null;A>0?_e=A:k&&k.length&&(_e=k[0]);var be=I||ye,Ie=(0,O.useMemo)((function(){var e={};return _e&&C&&(e=C.filter((function(e){return+e.customerInfoItemType===+_e}))[0]),e}),[_e]),xe=(0,O.useCallback)((function(){console.log("handleChangeCountryCode",be),be||(m("phone_countrycode_click"),p(!0))}),[be]),Te=(0,O.useCallback)((function(e){console.log("prev Gender",z),console.log("next Gender",e),e!==z&&u(e,"Sex")}),[z]),ke=(0,O.useCallback)((function(){m("idtype_change_click"),f({status:!0})}),[]);if(!r||!Object.keys(r).length)return null;var Se=[];return n.Sex&&(Se=[{gender:0,name:"\u7537"},{gender:1,name:"\u5973"}]),(0,_r.jsxs)(D.View,{className:"ModuleBox ContactModuleBox",id:"ContactInfo",children:[(0,_r.jsxs)(D.View,{className:"ModuleTitle",children:[(0,_r.jsx)(D.View,{className:"main_title",children:"\u8054\u7cfb\u4eba\u4fe1\u606f"}),!!me&&(0,_r.jsx)(D.View,{className:"sub_text",children:me})]}),!oe.isEmpty(i)&&(0,_r.jsxs)(D.View,{className:"modFlightHotelView",children:[!oe.isEmpty(ce)&&(0,_r.jsxs)(D.View,{className:"modFlightView autoExpose",id:"contact_reg_flight","data-expose":{ubtKeyName:"grp_ordwrt_change_expo",data:{applyType:"2"}},children:[(0,_r.jsx)(D.View,{className:"modFlightTitleView",children:(0,_r.jsxs)(D.View,{className:"Text26_32 color_text_2",children:[ce.title,":"]})}),ce.segments&&!!ce.segments.length&&ce.segments.map((function(e,t){return(0,_r.jsxs)(D.View,{className:"modFlightContentView ".concat(t===ce.segments.length-1?"modFlightContentLastView":null),children:[(0,_r.jsxs)(D.View,{className:"modFlightContentleftView",children:[(0,_r.jsx)(D.View,{className:"Text30_38 color_text_1",children:e.flightNo.join(",")}),(0,_r.jsx)(D.View,{className:"modFlightline"}),(0,_r.jsx)(D.View,{className:"Text30_38 color_text_1",children:e.departCity}),(0,_r.jsx)(D.View,{className:"modFlightArrow prs_color_text_3",children:"\ue9e2"}),(0,_r.jsx)(D.View,{className:"Text30_38 color_text_1",children:e.arriveCity})]}),0===t&&(0,_r.jsx)(D.View,{className:"modFlightContentRightView",onClick:function(){l&&l.tracelog("grp_ordwrt_change_click",{applyType:"2"}),v(!1,{ReselectTokenInfoList:[e.token]})},children:(0,_r.jsx)(D.View,{className:"Text26_32 color_blue",children:"\u66f4\u6362"})})]},t)}))]}),ue&&!!ue.length&&ue.map((function(e,t){var n=e.mgrGroupId,r=e.hotelName,a=e.roomName,o=e.roomToken,i=e.isNotInChoosePsg,s=void 0!==i&&i,c=(e.segmentNo,e.basePrice,fe[n]),u=c||{},d=u.title,f=(u.loginUrl,u.privacyTerms,u.cNName),p=void 0===f?"":f,m=u.cNSurname,h=void 0===m?"":m,g=u.eNLastName,y=void 0===g?"":g,_=u.eNFirstName,b=void 0===_?"":_,I=u.groupMemberName,x=void 0===I?"\u4f1a\u5458":I,T=(u.groupName,"");return h&&(T="".concat(h).concat(p)),!T&&y&&(T="{".concat(y," ").concat(b,"}")),(0,_r.jsxs)(D.View,{className:"modFlightView modHotelView autoExpose",id:"contact_reg_hotel","data-expose":{ubtKeyName:"grp_ordwrt_change_expo",data:{applyType:"1"}},children:[(0,_r.jsx)(D.View,{className:"modFlightTitleView",children:(0,_r.jsxs)(D.View,{className:"Text26_32 color_text_2",children:[d,":"]})}),(0,_r.jsxs)(D.View,{className:"modFlightContentView modFlightContentLastView",children:[(0,_r.jsxs)(D.View,{className:"modFlightContentleftView",children:[(0,_r.jsxs)(D.Text,{className:"Text30_38 color_text_1",children:[r,(0,_r.jsx)(D.Text,{style:{color:"#ddd"},children:" | "}),a]}),!!s&&(0,_r.jsxs)(D.View,{className:"txt_red txt_warning",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_warning"}),(0,_r.jsx)(D.Text,{className:"text",children:"\u6ce8\u518c\u4eba\u4e0d\u5728\u51fa\u884c\u4eba\u4e2d\uff0c\u8bf7\u66f4\u6362\u623f\u578b"})]})]}),(0,_r.jsx)(D.View,{className:"modFlightContentRightView",onClick:function(){l&&l.tracelog("grp_ordwrt_change_click",{applyType:"1"}),v(!1,{ReselectTokenInfoList:[o]})},children:(0,_r.jsx)(D.View,{className:"Text26_32 color_blue",children:"\u66f4\u6362"})})]}),!!T&&(0,_r.jsx)(D.View,{className:"modHotelLoginView2",children:(0,_r.jsxs)(D.View,{className:"modFlightContentleftView",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_i infoicon",children:"\uef89"}),(0,_r.jsx)(D.Text,{className:"Text26_32 color_text_1",children:"\u5c0a\u656c\u7684".concat(x,": ").concat(T,"\uff0c\u5df2\u767b\u9646")})]})})]},o)}))]}),(0,_r.jsx)(D.View,{className:"ModuleContent contactContent",children:(0,_r.jsxs)(D.View,{className:"contact_card",children:[n.UserName&&(0,_r.jsx)(oa,{title:P["UserName"].name,initialValue:V,type:ra.Name,valueChangeCallback:u,valueCheckCallback:d,placeholderText:"\u8f93\u5165\u8054\u7cfb\u4eba\u59d3\u540d",errorMessage:a.Name,maxlength:50,isMember:I}),n.SurenameCN&&(0,_r.jsxs)(D.View,{className:"modHotelNameView",children:[(0,_r.jsxs)(D.View,{className:"modHotelNameLeftView",children:[(0,_r.jsx)(oa,{title:"\u4e2d\u6587\u59d3",placeholderText:"\u4e0e\u8bc1\u4ef6\u59d3\u540d\u4e00\u81f4",initialValue:$,type:"SurenameCN",valueChangeCallback:u,valueCheckCallback:d,errorMessage:a.SurenameCN,isMember:!0}),(0,_r.jsx)(oa,{title:"\u4e2d\u6587\u540d",placeholderText:"\u4e0e\u8bc1\u4ef6\u59d3\u540d\u4e00\u81f4",initialValue:J,type:"GivenNameCN",valueChangeCallback:u,valueCheckCallback:d,errorMessage:a.GivenNameCN})]}),n.Surname&&(0,_r.jsx)(D.View,{className:"modHotelNameRightView",onClick:function(){g($+J)},children:(0,_r.jsx)(D.Text,{className:"Text26_32 color_blue",children:"\u8f6c\u62fc\u97f3"})})]}),n.Surname&&(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsx)(oa,{title:"\u82f1\u6587\u59d3",placeholderText:"\u4e0e\u8bc1\u4ef6\u59d3\u540d\u4e00\u81f4",initialValue:ee,type:"Surname",valueChangeCallback:u,valueCheckCallback:d,errorMessage:a.Surname,isMember:!n.SurenameCN}),(0,_r.jsx)(oa,{title:"\u82f1\u6587\u540d",placeholderText:"\u4e0e\u8bc1\u4ef6\u59d3\u540d\u4e00\u81f4",initialValue:ne,type:"GivenName",valueChangeCallback:u,valueCheckCallback:d,errorMessage:a.GivenName})]}),n.ChineseName&&(0,_r.jsx)(oa,{title:P["ChineseName"].name,placeholderText:"\u8bf7\u586b\u5199\u8054\u7cfb\u4eba\u4e2d\u6587\u59d3\u540d",initialValue:V,type:ra.Name,valueChangeCallback:u,valueCheckCallback:d,errorMessage:a.Name,maxlength:50,isMember:I}),n.EnglishName&&(0,_r.jsx)(oa,{title:P["EnglishName"].name,initialValue:V,type:ra.Name,valueChangeCallback:u,valueCheckCallback:d,placeholderText:"\u8bf7\u586b\u5199\u8054\u7cfb\u4eba\u82f1\u6587\u59d3\u540d",errorMessage:a.Name,maxlength:50,isMember:I}),n.IDNumber&&(0,_r.jsx)(oa,{title:Ie.name||"\u8eab\u4efd\u8bc1",initialValue:B,type:ra.ContactIDCardNumber,valueChangeCallback:u,valueCheckCallback:d,placeholderText:"\u8bc1\u4ef6\u53f7\u7801\uff0c\u7528\u4e8e\u6ce8\u518c\u4f1a\u5458",errorMessage:a.ContactIDCardNumber,idTypeList:k,tips:"",selectMemberCard:ke}),n.Birthday&&(0,_r.jsxs)(D.View,{className:"contact_card_item flex_box split_line",children:[(0,_r.jsx)(D.View,{className:"flex_0",children:(0,_r.jsx)(D.View,{className:"item_name",children:"\u51fa\u751f\u65e5\u671f"})}),(0,_r.jsxs)(D.View,{className:"flex_1",children:[(0,_r.jsx)(D.Picker,{mode:"date",value:ae||"1900-01-01",start:"",end:"",onChange:function(e){u(e.detail.value,"BirthDate"),a.Birthday&&d("BirthDate")},children:(0,_r.jsx)(D.View,{className:"main_con",children:(0,_r.jsx)(D.View,{className:"gender_item",children:ae?(0,_r.jsx)(D.Text,{className:"Text28 color_text_1",children:ae}):(0,_r.jsx)(D.Text,{className:"Text28 color_text_4",children:"\u8bf7\u9009\u62e9\u51fa\u751f\u65e5\u671f"})})})}),!!a.Birthday&&(0,_r.jsx)(D.View,{className:"sub_con",children:(0,_r.jsxs)(D.View,{className:"txt_red txt_warning",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_warning"}),(0,_r.jsx)(D.Text,{className:"text",children:a.Birthday})]})})]})]}),n.Sex&&(0,_r.jsxs)(D.View,{className:"contact_card_item flex_box split_line",children:[(0,_r.jsx)(D.View,{className:"flex_0",children:(0,_r.jsx)(D.View,{className:"item_name",children:"\u6027\u522b"})}),(0,_r.jsxs)(D.View,{className:"flex_1",children:[(0,_r.jsx)(D.View,{className:"main_con",children:Se.map((function(e){return(0,_r.jsxs)(D.View,{className:"gender_item ".concat(z===e.gender?"cur":""),onClick:function(){return Te(e.gender)},children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont ".concat(0===e.gender?"iconfont_boy":"iconfont_girl")}),e.name]})}))}),!!a.Sex&&(0,_r.jsx)(D.View,{className:"sub_con",children:(0,_r.jsxs)(D.View,{className:"txt_red txt_warning",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_warning"}),(0,_r.jsx)(D.Text,{className:"text",children:a.Sex})]})})]})]}),n.ContactPhone&&(0,_r.jsx)(oa,{title:"\u624b\u673a\u53f7\u7801",initialValue:Z,countryCode:G,type:ra.Moblie,valueChangeCallback:u,valueCheckCallback:d,placeholderText:"\u7528\u4e8e\u63a5\u6536\u884c\u7a0b\u4fe1\u606f",errorMessage:a.Moblie,countryCodeReadOnly:!!be,countryCodeChangeCallback:xe,tips:"",focusCallback:y}),(0,_r.jsx)(oa,{title:"\u7535\u5b50\u90ae\u7bb1",initialValue:q,type:ra.Email,valueChangeCallback:u,valueCheckCallback:d,placeholderText:"\u7528\u4e8e\u63a5\u6536\u786e\u8ba4\u5355\uff0c".concat(N?"":"\u975e","\u5fc5\u586b"),errorMessage:a.Email}),!!ye&&ge&&!!ge.length&&(0,_r.jsxs)(D.View,{className:"modRegisterView",id:"PrivacyTerms",children:[(0,_r.jsxs)(D.View,{className:"modRegisterTermsView",children:[(0,_r.jsx)(D.View,{onClick:function(e){h(!ve)},children:ve?(0,_r.jsx)(D.View,{className:"modRegisterCheckbox color_blue",children:"\ue179"}):(0,_r.jsx)(D.View,{className:"modRegisterCheckbox color_gray",children:"\ue178"})}),(0,_r.jsxs)(D.View,{className:"Text30 color_text_1",children:["\u6211\u5df2\u9605\u8bfb\u5e76\u540c\u610f",ge.map((function(e,t){return(0,_r.jsxs)(O.Fragment,{children:[(0,_r.jsx)(D.Text,{className:"color_blue",onClick:function(){e.privacyTermsUrl&&l.jumpH5({url:e.privacyTermsUrl})},children:e.privacyTermsName}),t!==ge.length-1?" \u548c ":""]},e.agreementNo||t)}))]})]}),!!s&&!ve&&(0,_r.jsxs)(D.View,{className:"txt_red txt_warning",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_warning"}),(0,_r.jsx)(D.Text,{className:"text",children:"\u8bf7\u9605\u8bfb\u5e76\u52fe\u9009\u62a5\u9519\u6587\u6848\u4ee5\u4ea7\u54c1\u5b9a\u4e49\u4e3a\u51c6"})]})]})]})})]})},ua=la;var da={TRAIN:"TRAIN",TRAIN_DETAIL_GET:"TRAIN_DETAIL_GET",TRAFFIC:"TRAFFIC",TICKET:"TICKET",RECREATION:"RECREATION",EXCURSION:"EXCURSION",OVERSEASE_ONE_DAY_TOUR:"OVERSEASE_ONE_DAY_TOUR",INSURANCE:"INSURANCE",VISA:"VISA",SPECIAL_SERVICE:"SPECIAL_SERVICE",EXTRA_CHARGE:"EXTRA_CHARGE",SPECIAL_OFFERS:"SPECIAL_OFFERS",SINGLE_TRAFFIC:"SINGLE_TRAFFIC",SINGLE_TRIP:"SINGLE_TRIP",SINGLE_BUS:"SINGLE_BUS",SINGLE_BOAT:"SINGLE_BOAT",FOOD:"FOOD",OVERSEASE_TOUR:"OVERSEASE_TOUR",CAR_RENTAL:"CAR_RENTAL",GOLF:"GOLF",UPGRADE_CLASS:"UPGRADE_CLASS",ONE_DAY_TOUR:"ONE_DAY_TOUR",ROUND_TRIP:"ROUND_TRIP",THROUGH_TRAFFIC:"THROUGH_TRAFFIC",INDIVIDUAL_SERVICE:"INDIVIDUAL_SERVICE",SEND_OF_SERVICE:"SEND_OF_SERVICE",WIRELESS_LEASE:"WIRELESS_LEASE",AIRPORT_TRANSFER:"AIRPORT_TRANSFER",CHANGE_PRICE:"CHANGE_PRICE",LEFT_BAGGAGE:"LEFT_BAGGAGE",TRAVEL_STEWARD:"TRAVEL_STEWARD",ROOM_TYPE:"ROOM_TYPE",TRAFFIC_GUIDE:"TRAFFIC_GUIDE",TOUR_GUIDE:"TOUR_GUIDE",GUIDE_ADDITIONAL_SERVICES:"GUIDE_ADDITIONAL_SERVICES",FLIGHT:"FLIGHT",HOTEL:"HOTEL",CAR:"CAR",AirPortCAR:"AirPortCAR",DISCOUNTS:"DISCOUNTS",REQUIRED:"REQUIRED",SINGLE:"SINGLE",SINGLE_ROOM_CHARGE:"SINGLE_ROOM_CHARGE",SINGLE_ROOM_CATEID:"SINGLE_ROOM_CATEID",CHILD_PRICE_CATEID:"CHILD_PRICE_CATEID",VIRTUAL_ROOM:"VIRTUAL_ROOM",CRUISE:"CRUISE",HIDE:"HIDE",OFFERTYPES:"OFFERTYPES",TICKETS:"TICKETS",TTD:"TTD"};da.TRAVEL_STEWARD,da.ROOM_TYPE,da.SPECIAL_SERVICE,da.EXCURSION,da.TRAFFIC,da.TICKET,da.FOOD,da.RECREATION,da.SINGLE_ROOM_CATEID,da.EXTRA_CHARGE,da.SEND_OF_SERVICE,da.LEFT_BAGGAGE,da.WIRELESS_LEASE,da.INDIVIDUAL_SERVICE,da.OVERSEASE_ONE_DAY_TOUR,da.OVERSEASE_TOUR,da.CAR_RENTAL,da.GOLF,da.UPGRADE_CLASS,da.ONE_DAY_TOUR,da.ROUND_TRIP,da.THROUGH_TRAFFIC,da.CHANGE_PRICE,da.TRAFFIC_GUIDE,da.TOUR_GUIDE,da.GUIDE_ADDITIONAL_SERVICES,da.CHILD_PRICE_CATEID;function fa(e){var t=e.checked,n=e.onpress,r=e.testid;return(0,_r.jsx)(D.View,{className:t?"item_checkboxed":"item_checkbox",onClick:function(e){!t&&r&&y().uploadUserAction(e,r),n&&n()},children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_btn_check check"})})}var pa=function(){var e,t=yr.useActions(),n=t.beforeSelectInsurance,r=t.clickTraceLog,a=t.toggleInsIntroducMask,o=yr.useState((function(e){var t=e.resourceinfo,n=e.shoppinginfo,r=e.pageData,a=e.IsContrainSelf,o=e.selectIds,i=e.logInfo,s=e.ErrorCanBookingMessge,c=e.ErrorCanBookingToken,l=e.HighLevelDiscount,u=e.footPriceStatus;return{resourceinfo:t,shoppinginfo:n,pageData:r,IsContrainSelf:a,selectIds:o,logInfo:i,ErrorCanBookingMessge:s,ErrorCanBookingToken:c,HighLevelDiscount:l,footPriceStatus:u}})),i=o.resourceinfo,s=o.shoppinginfo,c=o.pageData,l=o.IsContrainSelf,u=o.selectIds,d=o.logInfo,f=o.ErrorCanBookingMessge,p=o.ErrorCanBookingToken,m=o.HighLevelDiscount,h=o.footPriceStatus,v=i&&i[da.INSURANCE],g=s&&s[da.INSURANCE]||{},y=v||{},_=y.specialTokens,b=void 0===_?{}:_,I=y.insuranceDic,x=void 0===I?{}:I,T=b||{},k=T.levleCancleTokens,S=void 0===k?[]:k,C=T.svipCancellation,w=void 0===C?[]:C,N=!oe.isEmpty(S)||!oe.isEmpty(w);if(!h)return null;if(!N&&oe.isEmpty(m))return null;var E=c||{},P=E.userInterests,j=void 0===P?{}:P,O=j||{},R=O.superInterest,A=void 0===R?{}:R,M=O.levelInterest,V=void 0===M?{}:M;u&&u.length||(l=!0);var L=w&&w[0]||S&&S[0],B=x&&x[L]&&(null===(e=x[L].baseInfo)||void 0===e?void 0:e.tagList)||[],U="",Z="",F="";return!m&&oe.isEmpty(S)||(U=null===V||void 0===V?void 0:V.LevelName,Z=(null===V||void 0===V?void 0:V.bgImgUrl)||"",F=(null===V||void 0===V?void 0:V.titleColor)||""),oe.isEmpty(w)||(U+=U?"&"+(null===A||void 0===A?void 0:A.LevelName):null===A||void 0===A?void 0:A.LevelName,Z||(Z=null===A||void 0===A?void 0:A.bgImgUrl),F||(F=null===A||void 0===A?void 0:A.titleColor)),(0,_r.jsxs)(D.View,{className:"ModuleView userlevel",id:"UserLevelInsurance",children:[!!Z&&(0,_r.jsx)(D.Image,{className:"titleImage",src:Z}),(0,_r.jsx)(D.View,{className:"titleView",children:(0,_r.jsxs)(D.Text,{className:"titleText",style:F?{color:F}:{},children:[U,"\u5c0a\u4eab"]})}),(0,_r.jsxs)(D.View,{className:"contentView",children:[!!m&&(0,_r.jsxs)(D.View,{className:"itemView",children:[(0,_r.jsx)(D.View,{className:"item_main_title_view",children:(0,_r.jsx)(D.Text,{className:"item_main_title_text",children:"\u4f18\u60e0\u7279\u6743"})}),(0,_r.jsx)(D.View,{className:"item_list",children:(0,_r.jsxs)(D.View,{className:"item_content",children:[(0,_r.jsxs)(D.View,{className:"item_content_left",children:[!(null===V||void 0===V||!V.imageUrl)&&(0,_r.jsx)(D.View,{className:"imageView",children:(0,_r.jsx)(D.Image,{className:"imageSize",src:null===V||void 0===V?void 0:V.imageUrl})}),(0,_r.jsx)(D.Text,{className:"item_content_main_text",children:null===m||void 0===m?void 0:m.resourceName})]}),(0,_r.jsx)(D.View,{className:"item_content_right",children:(0,_r.jsxs)(D.Text,{className:"priceText",children:["-",(0,_r.jsx)(D.Text,{className:"price_unit_text",children:"\xa5"}),Math.abs(m.adultPrice)]})})]})})]}),!!N&&(0,_r.jsxs)(D.View,{className:"itemView",children:[(0,_r.jsxs)(D.View,{className:"item_main_title_view",children:[(0,_r.jsx)(D.Text,{className:"item_main_title_text",children:"\u65e0\u5fe7\u9000\u8ba2\u7279\u6743"}),(0,_r.jsx)(D.View,{className:"item_sub_title_view",children:(0,_r.jsx)(D.Text,{className:"item_sub_title_text",children:B[0]})})]}),(0,_r.jsxs)(D.View,{className:"item_list",children:[!!w&&w.length>0&&w.map((function(e,t){var o=g&&g[e]&&g[e].count>0||!1,i=x&&x[e]||{};return(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsxs)(D.View,{className:"item_content",children:[(0,_r.jsxs)(D.View,{className:"item_left",onClick:function(){a({status:!0,options:null===i||void 0===i?void 0:i.addInfo})},children:[(0,_r.jsxs)(D.View,{className:"item_content_left",children:[!(null===A||void 0===A||!A.imageUrl)&&(0,_r.jsx)(D.View,{className:"imageView",children:(0,_r.jsx)(D.Image,{className:"imageSize",src:null===A||void 0===A?void 0:A.imageUrl})}),(0,_r.jsx)(D.Text,{className:"item_content_main_text",children:null===A||void 0===A?void 0:A.InterestName}),(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward item_arr"})]}),!(null===A||void 0===A||!A.InterestExpireDate)&&!(null===A||void 0===A||!A.InterestCounts)&&(0,_r.jsx)(D.View,{className:"item_content_sub_left",children:(0,_r.jsx)(D.Text,{className:"item_sub_title_text",children:"".concat(A.InterestExpireDate,"\u524d\u5269").concat(A.InterestCounts,"\u6b21\u53ef\u7528")})})]}),(0,_r.jsx)(D.View,{className:"item_content_right",children:(0,_r.jsx)(fa,{checked:o,onpress:function(){if(!o){var t=d.pageid,a=void 0===t?"":t;r("grp-".concat(a,"-popups-ins"))}n(!o,e)}})})]}),t!==w.length-1&&(0,_r.jsx)(D.View,{className:"item_line"})]})})),!!S&&S.length>0&&!!w&&w.length>0&&(0,_r.jsx)(D.View,{className:"item_line"}),!!S&&S.length>0&&S.map((function(e,t){var r=g&&g[e]&&g[e].count>0||!1,o=x&&x[e]||{},i=!r&&!l,s=p&&oe.includes(p,e)||!1;return(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsxs)(D.View,{className:"item_content_view ".concat(i?"unavailable":""),children:[(0,_r.jsxs)(D.View,{className:"item_content",children:[(0,_r.jsxs)(D.View,{className:"item_left",onClick:function(){a({status:!0,options:null===o||void 0===o?void 0:o.addInfo})},children:[(0,_r.jsxs)(D.View,{className:"item_content_left",children:[!(null===V||void 0===V||!V.imageUrl)&&(0,_r.jsx)(D.View,{className:"imageView",children:(0,_r.jsx)(D.Image,{className:"imageSize",src:null===V||void 0===V?void 0:V.imageUrl})}),(0,_r.jsx)(D.Text,{className:"item_content_main_text",children:null===V||void 0===V?void 0:V.InterestName}),(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward item_arr"})]}),!(null===V||void 0===V||!V.InterestExpireDate)&&!(null===V||void 0===V||!V.InterestCounts)&&(0,_r.jsx)(D.View,{className:"item_content_sub_left",children:(0,_r.jsx)(D.Text,{className:"item_sub_title_text",children:"".concat(V.InterestExpireDate,"\u524d\u5269").concat(V.InterestCounts,"\u6b21\u53ef\u7528")})})]}),(0,_r.jsx)(D.View,{className:"item_content_right",children:(0,_r.jsx)(fa,{checked:r,testid:"grp_ordwrite_chosvipins_click",onpress:function(){n(!r,e)}})})]}),!l&&!!r&&(0,_r.jsxs)(D.View,{className:"tips sub_con txt_warning",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_warning"}),(0,_r.jsx)(D.View,{className:"text",children:"\u8be5\u7279\u6743\u9700\u672c\u4eba\u51fa\u884c\u4f7f\u7528"})]}),!l&&!r&&(0,_r.jsxs)(D.View,{className:"tips sub_con txt_orange",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_tips"}),(0,_r.jsx)(D.View,{className:"text",children:"\u8be5\u7279\u6743\u9700\u672c\u4eba\u51fa\u884c\u4f7f\u7528"})]}),!!s&&!!f&&(0,_r.jsxs)(D.View,{className:"tips sub_con txt_warning",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_warning"}),(0,_r.jsx)(D.View,{className:"text",children:f})]})]}),t!==w.length-1&&(0,_r.jsx)(D.View,{className:"item_line"})]})}))]})]})]})]})},ma=pa,ha=function(){var e=yr.useState((function(e){var t=e.shoppingId,n=e.productBasicInfo,r=e.customerRequirement,a=e.hotelInfo;return{shoppingId:t,productBasicInfo:n,customerRequirement:r,hotelInfo:a}})),t=e.shoppingId,n=e.productBasicInfo,r=e.customerRequirement,a=e.hotelInfo,o=void 0===a?[]:a;console.log(r,o);var i=yr.useActions(),s=i.ctrl,c=(0,O.useMemo)((function(){if(!o.length)return[];var e=[];return o.forEach((function(t){var n;(null!==t&&void 0!==t&&t.receiveTextRemark||null!==t&&void 0!==t&&null!==(n=t.specialRemarks)&&void 0!==n&&n.length)&&e.push(t)})),e}),[o]),l=r||{},u=l.HotelRemark,d=void 0===u?[]:u,f=l.Remark,p=n||{},m=p.ProductType,h=void 0===m?0:m,v=p.ProductId,g=p.DepartureId;if(4===h||2===h&&oe.isEmpty(c))return null;var y=d&&d.length>0||!!f;return(0,_r.jsxs)(D.View,{className:"ModuleBox",children:[(0,_r.jsx)(D.View,{className:"ModuleTitle",children:(0,_r.jsxs)(D.View,{className:"main_title",children:["\u5907\u6ce8",(0,_r.jsx)(D.Text,{className:"sub_right_title",onClick:function(){s&&s.goToOrderMiniRemark({shoppingid:t,productid:v,departcityid:g,fromnative:1})},children:y?"\u7f16\u8f91":"\u6dfb\u52a0"})]})}),!!d.length&&c&&!!c.length&&(0,_r.jsx)(D.View,{className:"ModuleContent RemarkBox",children:(0,_r.jsx)(D.View,{className:"remark_item",children:d.map((function(e){var t=e||{},n=t.Token,r=t.commentRemark,a=void 0===r?"":r,o=(t.RemarkTokens,c.filter((function(e){return e.hotelRoomInfo&&e.hotelRoomInfo.token===n}))[0]),i=null===o||void 0===o?void 0:o.hotelRoomInfo;if(!Object.keys(i).length)return null;var s=[];return i.hotelName&&s.push(i.hotelName+(i.hotelEnName?"("+i.hotelEnName+")":"")),i.checkinDate&&i.checkoutDate&&s.push(i.checkinDate+"-"+i.checkoutDate),i.daily&&s.push(i.daily+"\u665a"),i.city&&s.push(i.city),(0,_r.jsxs)(D.View,{className:"remark_content_box",children:[(0,_r.jsx)(D.View,{className:"remark_date",children:s.join(" ")}),!!a&&(0,_r.jsx)(D.View,{className:"remark_info",children:a})]})}))})}),!!f&&(0,_r.jsx)(D.View,{className:"ModuleContent RemarkBox",children:(0,_r.jsxs)(D.View,{className:"remark_item",children:[(0,_r.jsx)(D.View,{className:"remark_title",children:"\u5176\u4ed6\u5907\u6ce8"}),(0,_r.jsx)(D.View,{className:"remark_content_box",children:(0,_r.jsx)(D.View,{className:"remark_info",children:f})})]})})]})},va=ha,ga=function(){var e,t=yr.useState((function(e){var t=e.orderNoticeInfo,n=e.tagInfo,r=e.shoppingId,a=e.productBasicInfo,o=e.OrderNoticeInfo,i=e.RemindInfo,s=e.confirmDateTime,c=e.FareRemark,l=e.logInfo,u=e.userNotice,d=e.taroInfo;return{orderNoticeInfo:t,tagInfo:n,shoppingId:r,productBasicInfo:a,OrderNoticeInfo:o,RemindInfo:i,confirmDateTime:s,FareRemark:c,logInfo:l,userNotice:u,taroInfo:d}})),n=t.orderNoticeInfo,r=t.tagInfo,a=t.shoppingId,o=t.productBasicInfo,i=(t.OrderNoticeInfo,t.RemindInfo),s=void 0===i?{}:i,c=t.confirmDateTime,l=t.FareRemark,u=(t.logInfo,t.userNotice),d=t.taroInfo,f=yr.useActions(),p=f.clickOldManTip,m=(f.actionTraceLog,f.clickTraceLog,f.toggleFareRemarkMask),h=f.ctrl,v=(f.toggleBookReadMask,f.getReplaceContractObj),g=n||{},_=(g.isShowCheckBox,g.orderNoticeInfo,r||{}),b=_.isContainInsurance,I=void 0!==b&&b,T=_.isPaidFirst,k=void 0!==T&&T,S=s||{},C=S.RemindMessageList,w=void 0===C?[]:C,N=u||{},E=N.isShow,P=void 0!==E&&E,j=N.isSelect,R=void 0!==j&&j,A=N.isShowAuthorize,M=void 0!==A&&A,V=N.isSelectAuthorize,L=void 0!==V&&V,B=N.isShowTip,U=N.isShowOldMan,Z=void 0!==U&&U,F=N.isShowUnderAge,G=void 0!==F&&F,H=(N.airlineClause,N.highMessage,N.tipMessages),q=void 0===H?[]:H;return(0,_r.jsx)(D.View,{className:"ModuleBox order_gap_tip_box",id:"OrderGapNotice",children:(0,_r.jsxs)(D.View,{className:"ModuleContent",children:[(!!P||!!M)&&(0,_r.jsxs)(D.View,{className:"need_select_tip split_line",children:[(0,_r.jsx)(D.View,{className:"need_select_tip_title_box",children:(0,_r.jsx)(D.Text,{className:"",style:{fontWeight:"bold"},children:"\u8bf7\u9605\u8bfb\u5e76\u540c\u610f\u4ee5\u4e0b\u5185\u5bb9"})}),!!P&&(0,_r.jsxs)(D.View,{className:"oldman_tip",children:[(0,_r.jsx)(D.View,{className:R?"need_checkboxed":"need_checkbox",onClick:function(){p(1)},children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_btn_check check"})}),(0,_r.jsxs)(D.View,{children:[(0,_r.jsx)(D.Text,{style:{color:"#0086f6"},onClick:function(){var e=v()||{};h&&h.goToContract({isShowOldMan:Z,isShowUnderAge:G,isShowAuthorize:M,tabIndex:0,shoppingId:a,productBasicInfo:o,taroInfo:d,replaceObj:e})},children:null===(e=q[0])||void 0===e?void 0:e.name}),q.length>1&&q.map((function(e,t){return 0===t?null:(0,_r.jsxs)(O.Fragment,{children:[1===t?"\u4ee5\u53ca":"",(0,_r.jsx)(D.Text,{style:{color:"#0086f6"},onClick:function(){var e=v()||{};h&&h.goToContract({isShowOldMan:Z,isShowUnderAge:G,isShowAuthorize:M,tabIndex:t,shoppingId:a,productBasicInfo:o,taroInfo:d,replaceObj:e})},children:e.name}),t<q.length-1?"\uff0c":""]},t)}))]})]}),!!M&&(0,_r.jsxs)(D.View,{className:"oldman_tip",children:[(0,_r.jsx)(D.View,{className:L?"need_checkboxed":"need_checkbox",onClick:function(){p(2)},children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_btn_check check"})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(D.Text,{style:{color:"#0086f6"},onClick:function(){var e=v()||{};h&&h.goToContract({isShowOldMan:Z,isShowUnderAge:G,isShowAuthorize:M,tabIndex:q.length,shoppingId:a,productBasicInfo:o,taroInfo:d,replaceObj:e})},children:"\u4e2a\u4eba\u4fe1\u606f\u51fa\u5883\u6388\u6743\u58f0\u660e"})})]}),(!R||M&&!L)&&!!B&&(0,_r.jsxs)(D.View,{className:"txt_warning oldmanErrorView",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_warning"}),(0,_r.jsx)(D.View,{className:"text",children:"\u8bf7\u9605\u8bfb\u4ee5\u4e0a\u4fe1\u606f\u5e76\u8bc4\u4f30\u98ce\u9669\u540e\uff0c\u518d\u7ee7\u7eed\u64cd\u4f5c"})]})]}),(0,_r.jsxs)(D.View,{className:"gap_show_tips ".concat(P?"gap_show_tips_top":""),children:[!!Z&&!I&&(0,_r.jsx)(D.View,{children:"\u4e3a\u51fa\u884c\u589e\u6dfb\u4fdd\u969c\uff0c\u5efa\u8bae\u60a8\u8d2d\u4e70\u65c5\u6e38\u610f\u5916\u9669\u3002"}),!x.isEmpty(l)&&(0,_r.jsxs)(D.View,{children:[(0,_r.jsx)(D.Text,{children:"\u60a8\u9009\u62e9\u7684\u822a\u73ed\u9000\u6539\u7b7e\u53ef\u80fd\u6709\u53d8\u5316\uff0c"}),(0,_r.jsx)(D.Text,{className:"txt_blue",onClick:function(e){m(!0),y().uploadUserAction(e,"vac_order_fareremark")},children:"\u8bf7\u70b9\u51fb\u67e5\u770b"})]}),w&&w.length>0&&w.map((function(e,t){return(0,_r.jsx)(D.View,{children:e},t)})),c?(0,_r.jsxs)(D.View,{children:["\u652f\u4ed8\u5b8c\u6210\u540e\uff0c\u8ba2\u5355\u4f1a\u5728",c,"\u786e\u8ba4\u7ed3\u679c"]}):(0,_r.jsx)(D.View,{children:k?"\u652f\u4ed8\u5b8c\u6210\u540e\uff0c\u8ba2\u5355\u4f1a\u7acb\u5373\u786e\u8ba4":"\u63d0\u4ea4\u8ba2\u5355\u540e\uff0c\u8ba2\u5355\u4f1a\u7acb\u5373\u786e\u8ba4"})]})]})})},ya=ga;function _a(){return(0,_r.jsx)(D.View,{className:"SafeArea"})}var ba=function(){var e=(0,O.useState)(Date.now()),t=(0,M.Z)(e,2),n=(t[0],t[1],yr.useActions()),r=n.togglePriceDetailMask,a=n.toggleIMEntryInfo,o=n.payNext,i=n.actionTraceLog,s=(n.openIM,yr.useState((function(e){var t=e.isNext,n=e.InsNeedPayStatus,r=e.priceDetail,a=e.IMEntryInfo,o=e.isShowPriceDetailMask,i=e.productBasicInfo,s=e.shoppingId,c=e.VendorInfo,l=e.footPriceStatus,u=e.pageid,d=e.OrderDelivery,f=e.formatDlyData,p=e.tagInfo,m=e.logInfo,h=e.payStatus,v=e.HighLevelDiscount,g=e.FlightUserDiscount,y=e.pageData,_=e.IMSatus,b=e.pGroupImVer;return{isNext:t,InsNeedPayStatus:n,priceDetail:r,IMEntryInfo:a,isShowPriceDetailMask:o,productBasicInfo:i,shoppingId:s,VendorInfo:c,footPriceStatus:l,pageid:u,OrderDelivery:d,formatDlyData:f,tagInfo:p,logInfo:m,payStatus:h,HighLevelDiscount:v,FlightUserDiscount:g,pageData:y,IMSatus:_,pGroupImVer:b}}))),c=s.isNext,l=s.InsNeedPayStatus,u=s.priceDetail,d=s.IMEntryInfo,f=s.isShowPriceDetailMask,p=(s.productBasicInfo,s.shoppingId,s.VendorInfo,s.footPriceStatus),m=(s.pageid,s.OrderDelivery),h=s.formatDlyData,v=s.tagInfo,g=s.logInfo,_=s.payStatus,b=void 0===_?0:_,I=s.HighLevelDiscount,x=s.FlightUserDiscount,T=s.pageData,k=(s.IMSatus,s.pGroupImVer),S=(0,O.useMemo)((function(){return cn(m,h)}),[m,h]),C=u||{},w=C.totalPrice,N=void 0===w?{}:w,E=(C.priceDetailList,N||{}),P=E.totalPrice,j=void 0===P?0:P,R=E.save,A=void 0===R?0:R,V=E.shopPayPrice,L=void 0===V?0:V,B=L||{},U=(B.price,B.currencyCode,j&&j.toString().length,v||{}),Z=U.isPaidFirst,F=void 0!==Z&&Z,G=F?"\u53bb\u652f\u4ed8":"\u63d0\u4ea4\u8ba2\u5355",H=g||{};H.shoppingid,H.productId;S&&(j+=S),"number"===typeof j&&j<0&&(c=!1),"number"===typeof j&&j<=0&&(G="\u63d0\u4ea4\u8ba2\u5355");var q=d&&(d.imSwitch||d.inquiry)||!1;k&&(q=d&&d.imSwitch||!1);var K=!1;"boolean"===typeof F&&"boolean"===typeof l&&(K=!0);var z=T||{},Y=z.userInterests,W=void 0===Y?{}:Y,$=W||{},X=$.levelInterest,J=void 0===X?{}:X,Q="\u8ba2\u5355\u603b\u989d";I&&(Q=(null===J||void 0===J?void 0:J.LevelName)+"\u4ef7"),x&&(Q="\u673a\u7968\u7528\u6237\u4ef7");var ee=Ia((function(){o()}),1e3);return(0,_r.jsxs)(D.View,{className:"order_footer flex_box",style:{flexDirection:"column"},children:[(0,_r.jsxs)(D.View,{className:"order_footer_main",children:[!p&&(0,_r.jsx)(D.View,{className:"vcm-footer-price",children:(0,_r.jsx)(D.View,{className:"vcm-foot-price-row vcm-foot-nowrap",children:(0,_r.jsx)(D.View,{className:"vcm-foot-circle vcm-animate-circle"})})}),!!p&&(0,_r.jsxs)(D.View,{className:"flex_1",children:[(0,_r.jsxs)(D.View,{className:"foot_price",style:{fontSize:String(j).replace(".","").length>5?"34rpx":"40rpx"},children:[(0,_r.jsxs)(D.View,{style:{wordBreak:"break-all"},children:[(0,_r.jsx)(D.Text,{className:"foot_price_text1 txt_orange",children:"\xa5"}),(0,_r.jsx)(D.Text,{className:"foot_price_text2 txt_orange",children:j})]}),A>0&&(0,_r.jsxs)(D.Text,{className:"foot_price_label txt_orange",children:["\u5171\u4f18\u60e0\xa5",A]})]}),(0,_r.jsx)(D.View,{className:"foot_price",children:(0,_r.jsx)(D.Text,{className:"foot_price_text3",children:Q})})]}),!!K&&!!p&&(0,_r.jsxs)(D.View,{className:"foot_price_detail_btn",onClick:function(e){i("expense_details"),r(!f),y().uploadUserAction(e,"vac_order_pricedetail")},children:["\u660e\u7ec6",(0,_r.jsx)(D.Text,{className:"prs_iconfont ".concat(f?"iconfont_arrow_down":"iconfont_arrow_up")})]}),!!q&&(0,_r.jsxs)(D.View,{className:"customer_service_btn",onClick:function(e){i("IM"),a(!0),y().uploadUserAction(e,"vac_order_im")},children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_service"}),(0,_r.jsx)(D.View,{className:"text",children:"\u5ba2\u670d"})]}),!K&&(0,_r.jsx)(D.View,{className:"order_foot_btn vcm-btn-org btn-org-linear",children:(0,_r.jsxs)(D.View,{className:"loader_inner",children:[(0,_r.jsx)(D.View,{className:"item"}),(0,_r.jsx)(D.View,{className:"item"}),(0,_r.jsx)(D.View,{className:"item"})]})}),!!c&&K&&(0,_r.jsx)(_r.Fragment,{children:0===b&&p?(0,_r.jsx)(D.View,{className:"order_foot_btn vcm-btn-org",onClick:function(e){ee(),y().uploadUserAction(e,"vac_order_pay")},children:l?(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsx)(D.View,{className:"main_text2",children:"\u4e0b\u4e00\u6b65"}),(0,_r.jsx)(D.View,{className:"sub_text",children:"\u6838\u5bf9\u4fdd\u9669+\u652f\u4ed8"})]}):(0,_r.jsx)(D.View,{className:"main_text1",children:G})}):(0,_r.jsx)(D.View,{className:"order_foot_btn vcm-btn-org btn-org-linear",children:(0,_r.jsxs)(D.View,{className:"loader_inner",children:[(0,_r.jsx)(D.View,{className:"item"}),(0,_r.jsx)(D.View,{className:"item"}),(0,_r.jsx)(D.View,{className:"item"})]})})}),!c&&K&&(0,_r.jsx)(D.View,{className:"order_foot_btn vcm-btn-gray",children:G})]}),(0,_r.jsx)(_a,{})]})},Ia=function(e,t){var n;return function(){n&&clearTimeout(n);var r=!n;n=setTimeout((function(){n=null}),t),r&&e()}},xa=ba,Ta=function(){var e=yr.useState((function(e){var t=e.formatDlyData,n=e.productBasicInfo,r=e.OrderDelivery,a=e.DeliveryTemplate,o=e.logInfo,i=e.Channels;return{formatDlyData:t,productBasicInfo:n,OrderDelivery:r,DeliveryTemplate:a,logInfo:o,Channels:i}})),t=e.formatDlyData,n=e.productBasicInfo,r=e.OrderDelivery,a=(e.DeliveryTemplate,e.logInfo),o=(e.Channels,yr.useActions()),i=o.toggleDeliveryTypeMask,s=o.toggleDeliveryInfoMask,c=o.toggleDeliveryAddressMask,l=o.ctrl,u=o.actionTraceLog,d=n||{},f=d.SaleMode,p=void 0===f?"":f,m=d.DepartureCityName;if("R"===p||!t||!t.isDlyShow)return null;var h=null;r&&r.DeliveryType&&(h=dt({DeliveryInfo:r,formatDlyData:t}));var v=h||{},g=v.curDelivery,y=v.remark;v.amount;if(!g)return null;var _="";r&&r.AddressInfo&&r.AddressInfo.Address?(_=r.AddressInfo.Address,r.AddressInfo.Recipient):r&&2===r.DeliveryType&&(r.AddressInfo&&r.AddressInfo.Address||(_=t.selfPickupAddress[0]));var b=a||{},I=(b.productId,b.lineid,b.pageid,b.shoppingid,g&&g.name,t&&t.scrollUiData||[]);I.length>1||g&&g.list&&g.list.length;return(0,_r.jsxs)(D.View,{className:"ModuleBox",children:[(0,_r.jsx)(D.View,{className:"ModuleTitle",children:(0,_r.jsx)(D.View,{className:"main_title",children:"\u914d\u9001"})}),(0,_r.jsx)(D.View,{className:"ModuleContent DeliveryBox",children:(0,_r.jsxs)(D.View,{className:"contact_card",children:[(0,_r.jsxs)(D.View,{onClick:function(){return i({status:!0})},className:"flex_box split_line",children:[(0,_r.jsx)(D.View,{className:"flex_0",children:(0,_r.jsx)(D.View,{className:"item_name",children:"\u914d\u9001\u65b9\u5f0f"})}),(0,_r.jsx)(D.View,{className:"flex_1",children:(0,_r.jsxs)(D.View,{className:"main_con",children:[(0,_r.jsxs)(D.View,{className:"text",children:[g.name,y&&" "+y]}),(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward"})]})})]}),(0,_r.jsxs)(D.View,{className:"flex_box split_line",onClick:function(){u("bus-address"),2===r.DeliveryType?c({status:!0}):l&&l.goToAddressList({type:r.DeliveryType,id:r&&r.AddressInfo&&r.AddressInfo.InfoId,city:m,fromnative:1})},children:[(0,_r.jsx)(D.View,{className:"flex_0",children:(0,_r.jsx)(D.View,{className:"item_name",children:"\u914d\u9001\u5730\u5740"})}),(0,_r.jsx)(D.View,{className:"flex_1",children:(0,_r.jsxs)(D.View,{className:"main_con ".concat(_?"":"blur"),children:[(0,_r.jsx)(D.View,{className:"text",children:_||"\u8bf7\u586b\u5199\u914d\u9001\u5730\u5740"}),(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward"})]})})]}),(0,_r.jsxs)(D.View,{onClick:function(){u("bus-material"),s(!0)},className:"flex_box split_line",children:[(0,_r.jsx)(D.View,{className:"flex_0",children:(0,_r.jsx)(D.View,{className:"item_name",children:"\u914d\u9001\u6750\u6599"})}),(0,_r.jsxs)(D.View,{className:"flex_1",children:[(0,_r.jsxs)(D.View,{className:"main_con",children:[(0,_r.jsx)(D.View,{className:"text",children:"\u67e5\u770b\u914d\u9001\u6750\u6599"}),(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward"})]}),(0,_r.jsx)(D.View,{className:"sub_con txt_grey",children:(0,_r.jsx)(D.View,{className:"text",children:"\u4ee5\u5b9e\u9645\u9001\u51fa\u7269\u4e3a\u51c6"})})]})]})]})})]})},ka=Ta,Sa=function(){var e=yr.useState((function(e){var t=e.shoppingId,n=e.productBasicInfo,r=e.OrderInvoice,a=e.logInfo;return{shoppingId:t,productBasicInfo:n,OrderInvoice:r,logInfo:a}})),t=e.shoppingId,n=e.productBasicInfo,r=e.OrderInvoice,a=(e.logInfo,yr.useActions()),o=a.ctrl,i=a.actionTraceLog,s=a.toggleRetailInvoiceMask,c=n||{},l=c.SaleMode,u=void 0===l?"":l,d=r||{},f=d.Title,p=void 0===f?"":f,m=d.RatepayerCode,h=void 0===m?"":m,v=d.InvoiceType,g=void 0===v?0:v,_=(d.IsNeedInvoice,d.IsSelectedEinvoice),b=void 0!==_&&_,I=["","\u4e2a\u4eba","\u4f01\u4e1a","\u975e\u4f01\u4e1a\u6027\u5355\u4f4d"];return(0,_r.jsxs)(D.View,{className:"commonBox",onClick:function(e){"R"!==u?(i("invoice-click"),o&&o.goToInvoice({shoppingid:t,invoicetitle:p||"",fromnative:1}),y().uploadUserAction(e,"vac_order_invoice")):s(!0)},children:[(0,_r.jsx)(D.View,{className:"commonBox_left",children:(0,_r.jsx)(D.View,{className:"name",children:"\u53d1\u7968"})}),(0,_r.jsxs)(D.View,{className:"commonBox_right",children:["R"===u&&(0,_r.jsx)(D.View,{className:"commonBox_right_content",children:(0,_r.jsxs)(D.View,{className:"main_con",children:["\u7531\u96f6\u552e\u5546\u5f00\u5177",(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_strong_tips"})]})}),"R"!==u&&(p?(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsxs)(D.View,{className:"commonBox_right_content",children:[(0,_r.jsx)(D.View,{className:"main_con",children:"".concat(b?"\u7535\u5b50\u53d1\u7968":"\u7eb8\u8d28\u53d1\u7968","\uff08").concat(I[g],"\uff09")}),(0,_r.jsx)(D.View,{className:"sub_con",children:p}),!!h&&(0,_r.jsx)(D.View,{className:"sub_con",children:h})]}),(0,_r.jsx)(D.View,{className:"commonBox_right_arr",children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward"})})]}):(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsx)(D.View,{className:"commonBox_right_content",children:(0,_r.jsx)(D.View,{className:"main_con",children:"\u4e0d\u9700\u8981\u53d1\u7968"})}),(0,_r.jsx)(D.View,{className:"commonBox_right_arr",children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward"})})]}))]})]})},Ca=Sa,wa=function(e){var t=(0,Fr.Z)({},((0,Zr.Z)(e),e)),n=yr.useState((function(e){var t=e.ErrorCanBookingToken,n=e.ErrorCanBookingMessge,r=e.logInfo;return{ErrorCanBookingToken:t,ErrorCanBookingMessge:n,logInfo:r}})),r=n.ErrorCanBookingToken,a=(n.ErrorCanBookingMessge,n.logInfo,yr.useActions()),o=a.beforeSelectInsurance,i=a.toggleInsIntroducMask,s=t||{},c=(s.id,s.data),l=void 0===c?{}:c,u=s.shoppingData,d=void 0===u?{}:u,f=(s.insuranceType,s.orderBasicInfo),p=void 0===f?{}:f,m=s.pageData,h=void 0===m?{}:m,v=s.lowPriceInsInfo,g=void 0===v?{}:v;s.errorInsTokenList;if(oe.isEmpty(l))return null;h.interestCounts;var y=l.category,_=l.baseInfo,b=void 0===_?{}:_,I=l.customInsuranceType,x=void 0===I?Xe.NONE:I,T=l.resourceShoppingInfo,k=void 0===T?{}:T,S=l.addInfo,C=void 0===S?{}:S,w=l.hasDetailInfo,N=void 0!==w&&w,E=p||{},P=E.AdultCount,j=void 0===P?0:P,O=E.ChildCount,R=void 0===O?0:O,A=(E.totalPersonCount,E.InfantCount,g.isShow),M=void 0!==A&&A,V=g.lowPriceToken,L=b.tagList,B=void 0===L?[]:L,U=b.token,Z=void 0===U?"":U,F=b.name,G=b.minTravelDays,H=b.maxTravelDays,q=(b.svipCancellation,b.tipMessage),K=void 0===q?"":q,z=k.isRequired,Y=k.price,W=k.childPrice,$=k.unit,X=k.stepCount,J=Ye([{price:Y,count:j},{price:W,count:R}]),Q="";1==y&&null!=b&&G>0&&H>0&&(Q=G==H?"".concat(G,"\u5929"):"".concat(G,"-").concat(H,"\u5929"));var ee=d&&d.count>0,te="",ne="";B&&B.length>0&&(z?te=B[1]||B[0]||"":ee?te=B[1]||"":(te=B[3]||"",ne=B[2]||""));var re="";x===Xe.MAJOR?re="\u4e3b\u9669":x===Xe.ADDITION&&(re="\u9644\u52a0\u9669");r&&oe.includes(r,Z);return(0,_r.jsx)(_r.Fragment,{children:(0,_r.jsxs)(D.View,{className:"ins_item_view",children:[(0,_r.jsxs)(D.View,{className:"ins_item_main_view",children:[(0,_r.jsxs)(D.View,{className:"item_left",children:[(0,_r.jsxs)(D.View,{className:"item_content_left",onClick:function(){N&&i({status:!0,options:C})},children:[(0,_r.jsx)(D.View,{className:"ins_item_left_title_view",children:(0,_r.jsxs)(D.Text,{className:"item_content_main_text",children:[F,Q?" "+Q:""]})}),!!N&&(0,_r.jsx)(D.View,{className:"ins_item_left_arr_view",children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward item_arr",children:"\u6295\u4fdd\u987b\u77e5"})})]}),(0,_r.jsxs)(D.View,{className:"ins_tags_view",children:[!!re&&(0,_r.jsx)(D.View,{className:"ins_tag_view",children:(0,_r.jsx)(D.Text,{className:"ins_tag_text",children:re})}),!!M&&V===Z&&(0,_r.jsx)(D.View,{className:"ins_tag_view ins_view_blue",children:(0,_r.jsx)(D.Text,{className:"ins_tag_text ins_text_blue",children:"\u5b9e\u60e0\u4e4b\u9009"})}),!ee&&!!ne&&(0,_r.jsx)(D.View,{className:"ins_tag_view ins_view_blue",children:(0,_r.jsx)(D.Text,{className:"ins_tag_text ins_text_blue",children:ne})})]}),!!te&&(0,_r.jsx)(D.View,{className:"item_content_sub_left",children:(0,_r.jsx)(D.Text,{className:"item_sub_title_text",children:te})}),!!K&&(0,_r.jsx)(D.View,{className:"item_content_sub_left",children:(0,_r.jsx)(D.Text,{className:"item_sub_title_text",children:K})})]}),(0,_r.jsxs)(D.View,{className:"ins_item_right_view",children:[J&&J>0?(0,_r.jsxs)(D.View,{className:"ins_price_text",children:[(0,_r.jsx)(D.Text,{className:"price_unit_text",children:"\xa5"}),J," ",X>0?"x"+X+$:"/".concat($)]}):(0,_r.jsxs)(D.View,{className:"ins_price_text price_orange",children:["\u8d60\u9001 ",X>0?"x"+X+$:"/".concat($)]}),(0,_r.jsx)(D.View,{className:"ins_checkitem",children:(0,_r.jsx)(fa,{checked:ee,onpress:function(){o(!ee,Z)}})})]})]}),!!ee&&(0,_r.jsx)(Hr,{token:Z,type:"insurance",count:X,category:y})]})})},Na=wa,Ea=function(){var e=(0,O.useState)(!1),t=(0,M.Z)(e,2),n=t[0],r=t[1],a=yr.useState((function(e){var t=e.resourceinfo,n=e.shoppinginfo,r=e.showresourceinfo,a=e.orderBasicInfo,o=e.lowPriceInsInfo,i=e.pageData,s=e.logInfo,c=e.isCloseInsAgent,l=e.QConfigInfo;return{resourceinfo:t,shoppinginfo:n,showresourceinfo:r,orderBasicInfo:a,lowPriceInsInfo:o,pageData:i,logInfo:s,isCloseInsAgent:c,QConfigInfo:l}})),o=a.resourceinfo,i=a.shoppinginfo,s=a.showresourceinfo,c=a.orderBasicInfo,l=a.lowPriceInsInfo,u=a.pageData,d=(a.logInfo,a.isCloseInsAgent),f=a.QConfigInfo,p=yr.useActions(),m=p.getNewShowIns,h=p.actionTraceLog,v=o&&o[We.INSURANCE],g=i&&i[We.INSURANCE]||{},y=(0,O.useMemo)((function(){var e=!1;return oe.isEmpty(g)||oe.forEach(g,(function(t){t.count>0&&(e=!0)})),e}),[g]);if(!v)return null;var _=v.insuranceDic,b=void 0===_?{}:_,I=(v.additionMoreThanOneTokenMap,v.insuranceSortList),x=void 0===I?[]:I,T=v.hasNeedPayIns,k=void 0!==T&&T,S=s||{},C=S.insuranceList,w=void 0===C?[]:C,N=x&&x.length||0,E=w&&w.length||0,P=0;w&&oe.forEach(x,(function(e){g&&g[e]&&g[e].count&&P++}));var j=s||{};n&&(j=v);var R=j||{},A=R.insuranceCategoryTokenMap,V=void 0===A?{}:A,L=R.majorAndAdditionTokenMap,B=void 0===L?{}:L,U=f.filter((function(e){return"order_clauses"===e.Key}))[0],Z=U&&U.Value&&JSON.parse(U.Value)&&JSON.parse(U.Value).insuranceTip||[];return(0,_r.jsxs)(D.View,{className:"ModuleView",id:"Insurance",children:[(0,_r.jsxs)(D.View,{className:"ins_title_view ".concat(y?"ins_HdGreen":""),children:[y?(0,_r.jsx)(D.Image,{className:"ins_image_icon",src:"https://pic.c-ctrip.com/VacationH5Pic/group_travel/process_v2/baozhang_check.png"}):(0,_r.jsx)(D.Image,{className:"ins_image_icon",src:"https://pic.c-ctrip.com/VacationH5Pic/group_travel/process_v2/baozhang.png"}),(0,_r.jsx)(D.View,{className:"ins_image_right_view",children:(0,_r.jsx)(D.Text,{className:"title_image_text",children:"80%\u7684\u4eba\u9009\u62e9\u4fdd\u9669\uff0c\u4fdd\u969c\u51fa\u884c\u5b89\u5168"})})]}),(0,_r.jsx)(D.View,{className:"ins_introd",children:(0,_r.jsx)(D.Text,{className:"ins_introd_text",children:"\u4ee5\u4e0b\u4fdd\u9669\u4ef7\u683c\u5747\u4e3a\u53c2\u8003\u4ef7\uff0c\u6700\u7ec8\u4f1a\u4ee5\u88ab\u4fdd\u4eba\u5b9e\u9645\u5e74\u9f84\u91cd\u65b0\u8ba1\u7b97"})}),(0,_r.jsx)(D.View,{className:"item_line"}),$e.map((function(e,t){var n=Je[e],r=V[e];return r?(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsx)(D.View,{className:"ins_name_view",children:(0,_r.jsx)(D.Text,{className:"ins_name_text",children:n})}),r.map((function(e,t){var r=b[e];if(oe.isEmpty(r))return null;var a=B[e];return(0,_r.jsxs)(O.Fragment,{children:[(0,_r.jsx)(Na,{id:e,data:r,shoppingData:g[e],insuranceType:n,orderBasicInfo:c,lowPriceInsInfo:l,pageData:u},e),!!a&&a.map((function(e,t){var a=b[e];return oe.isEmpty(r)?null:(0,_r.jsx)(Na,{id:e,data:a,shoppingData:g[e],insuranceType:n,orderBasicInfo:c,pageData:u},e)}))]},e)}))]}):null})),!!d&&!!k&&(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsxs)(D.View,{className:"ins_bottom_tips_view",children:[(0,_r.jsx)(D.View,{className:"ins_bottom_image_view",children:(0,_r.jsx)(D.Image,{className:"ins_bottom_image",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/insurance_agent_logo_s.png"})}),Z&&Z.length>0&&Z.map((function(e,t){return(0,_r.jsx)(D.View,{className:"ins_bottom_text_view",children:(0,_r.jsx)(D.Text,{className:"ins_bottom_text",children:e})})}))]}),(0,_r.jsx)(D.View,{className:"item_line"})]}),P<N&&E<N&&(0,_r.jsx)(_r.Fragment,{children:(0,_r.jsx)(D.View,{className:"insure_bottom_btn",onClick:function(){n||h("insurance_all_click"),n&&m(),r(!n)},children:n?(0,_r.jsx)(D.Text,{className:"insure_bottom_btn_text",children:"\u6536\u8d77"}):(0,_r.jsxs)(D.Text,{className:"insure_bottom_btn_text",children:["\u66f4\u591a\u4fdd\u9669\uff08",N-E,"\uff09"]})})})]})},Pa=Ea,ja=function(){var e=yr.useState((function(e){var t=e.ShoppingPromotionList,n=e.ExtendPromotion,r=e.selectedPromotion,a=e.logInfo,o=e.productBasicInfo,i=e.FlightUserDiscount,s=e.isLoadingFlightUserPrice;return{ShoppingPromotionList:t,ExtendPromotion:n,selectedPromotion:r,logInfo:a,productBasicInfo:o,FlightUserDiscount:i,isLoadingFlightUserPrice:s}})),t=(e.ShoppingPromotionList,e.ExtendPromotion,e.selectedPromotion),n=(e.logInfo,e.productBasicInfo),r=e.FlightUserDiscount,a=e.isLoadingFlightUserPrice,o=yr.useActions(),i=o.actionTraceLog,s=o.orderTraceDevLog,c=o.toggleCouponMask,l=n||{},u=l.ProductType,d=void 0===u?0:u;if(!d||4===d)return null;var f=t||{},p=f.availableCount,m=void 0===p?0:p,h=f.couponInfo,v=void 0===h?{}:h,g=null;return g=v&&v.couponName?(0,_r.jsx)(D.View,{className:"text",children:v.couponName}):m?(0,_r.jsxs)(D.View,{className:"text",children:[m,"\u5f20\u5238\u53ef\u7528"]}):(0,_r.jsx)(D.View,{className:"text",children:"\u53bb\u586b\u5199\u5238\u7801"}),(0,_r.jsxs)(D.View,{className:"ModuleBox offerBox",children:[(0,_r.jsx)(D.View,{className:"ModuleTitle",children:(0,_r.jsxs)(D.View,{className:"main_title",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_discount"}),"\u4f18\u60e0"]})}),!oe.isEmpty(r)&&(0,_r.jsxs)(D.View,{className:"flex_box",children:[(0,_r.jsx)(D.View,{className:"flex_0",children:(0,_r.jsx)(D.View,{className:"item_name",children:"\u4f18\u60e0\u6d3b\u52a8"})}),(0,_r.jsx)(D.View,{className:"flex_1",children:(0,_r.jsx)(D.View,{className:"main_con",children:(0,_r.jsxs)(D.View,{className:"flight_discount",children:[(0,_r.jsx)(D.Text,{children:null===r||void 0===r?void 0:r.resourceName}),a?(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_vertificate_loading price_loading"}):(0,_r.jsxs)(D.Text,{className:"price_orange_text flight_discount_price",children:["-",(0,_r.jsx)(D.Text,{className:"flight_discount_yuan",children:"\uffe5"}),Math.abs(null===r||void 0===r?void 0:r.adultPrice)]})]})})})]}),(0,_r.jsxs)(D.View,{className:"flex_box",onClick:function(){i("coupon-click"),s("o_vac_order_click_coupon"),c(!0)},children:[(0,_r.jsx)(D.View,{className:"flex_0",children:(0,_r.jsx)(D.View,{className:"item_name",children:"\u4f18\u60e0\u5238"})}),(0,_r.jsx)(D.View,{className:"flex_1",children:(0,_r.jsxs)(D.View,{className:"main_con",children:[g,(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_forward"})]})})]})]})},Oa=ja;function Da(e){var t=e.children,n=e.handleClose,r=function(){setTimeout((function(){n&&n()}),200)};return(0,_r.jsxs)(D.View,{catchMove:!0,className:"CommonPopContainer",children:[(0,_r.jsx)(D.View,{className:"CommonPopGrayBg",onClick:r}),(0,_r.jsx)(D.View,{className:"CommonPopContentContainer",children:t})]})}function Ra(e){var t=e.title,n=e.message,r=e.diyText,a=e.mainBtnText,o=e.subBtnText,i=e.mainCallback,s=e.subCallback,c=e.subBtnText2,l=e.subCallback2,u=e.btnType,d=e.subTitle;return(0,_r.jsx)(Da,{handleClose:function(){},children:(0,_r.jsxs)(D.View,{className:"alert_box",children:[(0,_r.jsxs)(D.View,{className:"alert_box_content",children:[!!t&&(0,_r.jsx)(D.View,{className:"title_view ".concat(n||r?"title_view_bottom":""),children:(0,_r.jsx)(D.Text,{className:"title_text",children:t})}),!!d&&(0,_r.jsx)(D.View,{className:"title_view",children:(0,_r.jsx)(D.Text,{className:"title_text",children:d})}),!!n&&(0,_r.jsx)(D.View,{className:"message_view",children:(0,_r.jsx)(D.Text,{className:"message_text",children:n})}),!!r&&r]}),"col"===u?(0,_r.jsxs)(D.View,{className:"alert_box_button btnColWrap",children:[!!a&&(0,_r.jsx)(D.View,{className:"alertModBtn btnColStyle",onClick:function(){i&&i()},children:(0,_r.jsx)(D.Text,{className:"alertModBtnText",children:a})}),!!o&&(0,_r.jsx)(D.View,{className:"alertModBtn alertModBtnSub btnColStyle btnDelimiter",onClick:function(){s&&s()},children:(0,_r.jsx)(D.Text,{className:"alertModBtnText alertModBtnSubText",children:o})}),!!c&&(0,_r.jsx)(D.View,{className:"alertModBtn alertModBtnSub btnColStyle btnDelimiter",onClick:function(){l&&l()},children:(0,_r.jsx)(D.Text,{className:"alertModBtnText alertModBtnSubText",children:c})})]}):(0,_r.jsxs)(D.View,{className:"alert_box_button",children:[!!o&&(0,_r.jsx)(D.View,{className:"alertModBtn alertModBtnSub",onClick:function(){s&&s()},children:(0,_r.jsx)(D.Text,{className:"alertModBtnText alertModBtnSubText",children:o})}),!!a&&(0,_r.jsx)(D.View,{className:"alertModBtn",onClick:function(){i&&i()},children:(0,_r.jsx)(D.Text,{className:"alertModBtnText",children:a})})]})]})})}function Aa(e){return 1===e.length?(0,_r.jsx)(D.View,{className:"message_view",children:(0,_r.jsx)(D.Text,{className:"message_text",children:e[0]})}):(0,_r.jsx)(_r.Fragment,{children:e.map((function(e,t){return(0,_r.jsxs)(D.View,{style:{display:"flex",alignItems:"flex-start"},children:[(0,_r.jsx)(D.Text,{className:"crn_iconfont iconfont_round limit_view_icon",style:{marginTop:"9px"}}),(0,_r.jsx)(D.Text,{className:"limit_view_text",children:e})]},t)}))})}function Ma(){var e=yr.useState((function(e){var t=e.isShowAlertMask,n=e.options;return{isShowAlertMask:t,options:n}})),t=e.isShowAlertMask,n=e.options,r=yr.useActions(),s=r.ctrl,c=r.toggleCommonAlertMask,l=r.doCheckPassenger,u=r.insuranceMul,d=r.checkInsuranceNonSelect,f=r.saveOrderCallBack,m=(r.toggleCouponMask,r.beforeReturnPage),h=(r.passengerEditCallBack,r.initPage),v=r.payNext,g=r.insChangeBack,y=r.saveOrder,_=(r.getLastCouponInfo,r.getPriceDetailAndCoupon),b=r.updateCruise,I=r.signCanBookingToken,x=r.updateTrainSelectedSeat,T=r.getSecondData,k=r.getLastInfo,S=(r.getThirdInfo,r.bbzPassengerValidCallback),C=r.selectInsurance,w=(r.openIM,r.goTo12306Login),N=(r.removeWX12306Cache,r.beforeSaveOrder),E=r.registerGroupMember,P=r.bookingXResource,j=r.traceKMActionLog;if(!t)return null;var O=(0,i.Z)({},n),D=O||{},R=D.typeName,A=void 0===R?"":R,M=D.data,V=void 0===M?[]:M,L=D.token,B=void 0===L?"":L,U=D.code,Z=void 0===U?"":U,F=D.message,G=void 0===F?"":F,H=D.tokenInfoList,q=void 0===H?[]:H,K=D.passengerModalData,z=void 0===K?{}:K,Y=D.messageList,W=void 0===Y?[]:Y;if(!A)return null;var $=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";c({isShowAlertMask:!1,options:null}),j({module:"\u5f39\u5c42",scene:"\u5173\u95ed\u516c\u7528\u6a21\u6001\u5f39\u5c42",role:p.RoleType.usr,action:p.ActionType.click,value:e||"\u8499\u5c42",jsonData:O})},X=z||{},J=X.buttons,Q=void 0===J?[]:J,ee=X.content;X.title;switch(O.diyText=Va(W),A){case"SameName":O.mainBtnText="\u786e\u5b9a",O.mainCallback=function(){return $(O.mainBtnText)};var te=O||{},ne=te.messages,re=void 0===ne?[]:ne,ae=te.title,oe=void 0===ae?"":ae;O.diyText=Va(re);break;case"SdpChildDiff":O.mainBtnText="\u786e\u5b9a",O.mainCallback=function(){return $(O.mainBtnText)},O.diyText=Aa(V);break;case"InsuranceMajor":O.subBtnText="\u70b9\u9519\u4e86",O.subCallback=function(){return $(O.subBtnText)},O.mainBtnText="\u786e\u8ba4\u53d6\u6d88",O.mainCallback=function(){$(O.mainBtnText),u(B)};break;case"InsuranceAddition":O.subBtnText="\u77e5\u9053\u4e86",O.subCallback=function(){$(O.subBtnText)},O.mainBtnText="\u52fe\u9009\u4e3b\u9669",O.mainCallback=function(){$(O.mainBtnText),u(B)};break;case"Membership_privilege":O.subBtnText="\u53d6\u6d88",O.subCallback=function(){$(O.subBtnText)},O.mainBtnText="\u66ff\u6362",O.mainCallback=function(){$(O.mainBtnText),C(!0,B)};break;case"InsuranceAgeRule":case"InsurancePriceChange":case"CruisePriceChange":O.mainBtnText="\u786e\u5b9a",O.mainCallback=$;break;case"PriceDetailError":case"NetWorkError":case"SaveOrderError":case"InitFunForPriceError":case"UpdateTrianCountError":case"updateTrainSelectedSeatError":case"UpdateCruiseError":case"SecondInterfaceError":case"ThirdInterfaceError":case"HotelRegisterError":case"bookingXResource":O.mainBtnText="\u91cd\u8bd5",O.mainCallback=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,r,o,i,s,c,l,u,d,f,p,m;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if($(O.mainBtnText),"bookingXResource"!==A){e.next=13;break}if(t=O||{},n=t.operationData,r=void 0===n?{}:n,o=r||{},i=o.type,5!==i){e.next=9;break}return e.next=7,g();case 7:e.next=11;break;case 9:return e.next=11,P(i);case 11:e.next=53;break;case 13:if("PriceDetailError"!==A){e.next=17;break}_(),e.next=53;break;case 17:if("NetWorkError"!==A){e.next=21;break}h(),e.next=53;break;case 21:if("SaveOrderError"!==A){e.next=27;break}s=O||{},c=s.operationData,l=void 0===c?{}:c,u=l||{},d=u.scenes,f=void 0===d?"":d,"InsBack"===f?y(1,{scenes:"InsBack"}):v(),e.next=53;break;case 27:if("PriceDetailError"!==A){e.next=31;break}_(),e.next=53;break;case 31:if("UpdateCruiseError"!==A){e.next=36;break}return e.next=34,b(!0);case 34:e.next=53;break;case 36:if("updateTrainSelectedSeatError"!==A){e.next=42;break}return p=O||{},m=p.operationData,e.next=40,x(m);case 40:e.next=53;break;case 42:if("ThirdInterfaceError"!==A){e.next=47;break}return e.next=45,k();case 45:e.next=53;break;case 47:if("SecondInterfaceError"!==A){e.next=52;break}return e.next=50,T();case 50:e.next=53;break;case 52:"HotelRegisterError"===A&&E(1);case 53:case"end":return e.stop()}}),e)}))),O.subBtnText="\u8fd4\u56de",O.subCallback=function(){$(O.subBtnText),s.backToLastPage()},console.log("options",(0,i.Z)({},O));break;case"QuickSelectPassenger":Q.forEach((function(e){var t=e.style,n=void 0===t?"":t,r=e.text,a=void 0===r?"":r,o=e.code,i=void 0===o?"":o;"blue"===n?(O.mainBtnText=a,O.mainCallback=function(){$(O.mainBtnText),l({status:i})}):(O.subBtnText=a,O.subCallback=function(){$(O.subBtnText),l({status:i})})})),O.message=ee&&ee[0];break;case"BbzPassengerValid":Q.forEach((function(e){var t=e.style,n=void 0===t?"":t,r=e.text,a=void 0===r?"":r,o=e.code,i=void 0===o?"":o;"blue"===n?(O.mainBtnText=a,O.mainCallback=function(){S(i),$(O.mainBtnText)}):(O.subBtnText=a,O.subCallback=function(){S(i),$(O.subBtnText)})})),O.message=ee&&ee[0],O.title=oe;break;case"CanBookingError":O.subBtnText="\u53d6\u6d88",O.subCallback=function(){return $(O.subBtnText)},O.mainBtnText="\u91cd\u65b0\u9009\u62e9",O.mainCallback=function(){switch($(O.mainBtnText),Z){case"invalid_product":case"reselect_cruise":case"lack_resource":case"invalid_shopping":m(!1,{historyCount:2});break;case"resource_soldout":case"reselect_resource":var e=q.filter((function(e){return 7!==e.Key}))||[];if(e.length)return void m(!1,{TokenInfoList:q});I(q,O.message);break;case"reselect_flight":case"reselect_hotel":case"reselect_cruisetour":case"reselect_cargroup":case"invalid_departure_date":case"reselect_use_date":case"flight_soldout":case"invalid_hotel_promotion":case"special_resource_limitcount":case"invalid_resource_count":m(!1,{TokenInfoList:q});break;default:break}};break;case"PageBack":var ie=O||{},se=ie.data,ce=void 0===se?[]:se;ce&&ce.length||(O.message="\u4f60\u79bb\u8bf4\u8d70\u5c31\u8d70\u4ec5\u5dee\u4e00\u6b65\uff0c\u786e\u8ba4\u8981\u79bb\u5f00\u5417\uff1f"),O.diyText=La(ce),O.mainBtnText="\u72e0\u5fc3\u79bb\u5f00",O.mainCallback=function(){$(O.mainBtnText),m(!0)},O.subBtnText="\u7ee7\u7eed\u9884\u8ba2",O.subCallback=function(){$(O.subBtnText)};break;case"TimeoutTip":O.diyText=Va(["\u975e\u5e38\u62b1\u6b49\uff0c\u60a8\u7684\u9884\u8ba2\u65f6\u95f4\u8fc7\u957f","\u8d44\u6e90\u5df2\u53d1\u751f\u53d8\u52a8\uff0c\u8bf7\u91cd\u65b0\u67e5\u8be2"]),O.mainBtnText="\u91cd\u65b0\u9009\u62e9",O.mainCallback=function(){$(O.mainBtnText),s.backToLastPage({needFlightUpdate:!0})};break;case"OrderStatus":202===Z?G=G||"\u5f53\u524d\u767b\u5f55\u7528\u6237\u4e0e\u8ba2\u5355\u6240\u5c5e\u7528\u6237\u4e0d\u4e00\u81f4\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55":204===Z?G=G||"\u60a8\u7684\u8ba2\u5355\u5df2\u751f\u6210,\u8bf7\u52ff\u91cd\u590d\u4e0b\u5355":205===Z&&(G=G||"\u60a8\u7684\u8ba2\u5355\u72b6\u6001\u5df2\u53d1\u751f\u53d8\u5316\uff0c\u8bf7\u91cd\u65b0\u9884\u8ba2"),O.mainBtnText="\u77e5\u9053\u4e86",O.mainCallback=function(){$(O.mainBtnText),m()};break;case"TrainType":case"HotelRegisterErrorPop":O.mainBtnText="\u77e5\u9053\u4e86",O.mainCallback=function(){return $(O.mainBtnText)};break;case"TrainOrderError":switch(O.message=G,Z){case 10002:s.remove&&s.remove("12306token"),O.mainBtnText="\u7acb\u5373\u767b\u5f55",O.mainCallback=function(){$(O.mainBtnText),w()},O.subBtnText="\u53d6\u6d88",O.subCallback=function(){return $(O.subBtnText)};break;case 99999:O.mainBtnText="\u7ee7\u7eed\u652f\u4ed8",O.mainCallback=function(){$(O.mainBtnText),f(V)},O.subBtnText="\u91cd\u9009\u8d44\u6e90",O.subCallback=function(){$(O.subBtnText),m()};break;default:O.mainBtnText="\u786e\u5b9a",O.mainCallback=function(){return $(O.mainBtnText)}}break;case"Train12306Time":O.mainBtnText="\u7ee7\u7eed\u9884\u8ba2",O.mainCallback=function(){$(O.mainBtnText),N(!0)},O.subBtnText="\u53d6\u6d88",O.subCallback=function(){return $(O.subBtnText)};break;case"floatInsurancePriceChange":O.mainBtnText="\u77e5\u9053\u4e86",O.mainCallback=$;break;case"ConfirmInformation":O.mainBtnText="\u786e\u8ba4\u5e76\u9884\u8ba2",O.mainCallback=function(){$(O.mainBtnText),d(1)},O.subBtnText="\u53d6\u6d88",O.subCallback=function(){$(O.subBtnText)};break;default:console.log("default")}return j({module:"\u5f39\u5c42",scene:"\u6253\u5f00\u516c\u7528\u6a21\u6001\u5f39\u5c42",jsonData:n}),(0,_r.jsx)(Ra,{title:O.title,message:O.message,diyText:O.diyText,mainBtnText:O.mainBtnText,mainCallback:O.mainCallback,subBtnText:O.subBtnText,subCallback:O.subCallback})}function Va(e){return e.map((function(e,t){return(0,_r.jsx)(D.Text,{className:"text",children:e},t)}))}var La=function(e){var t=e.map((function(e){var t=e.match(/\[\d+\]/g);if(t){var n=e.split(/\[.*?\]/g);return t.map((function(e,t){var r=e.match(/\d+/);n.splice(t+t+1,0,(0,_r.jsxs)(D.Text,{className:"txt_orange",style:{fontSize:"18px"},children:[" ",r[0]," "]},t))})),n}return e}));return(0,_r.jsx)(_r.Fragment,{children:t.map((function(e,n){return(0,_r.jsx)(D.View,{style:{flexDirection:"row"},className:"page_back",children:t.length>1?(0,_r.jsxs)(D.View,{className:"text_tl_list",children:[(0,_r.jsx)(D.Text,{className:"crn_iconfont iconfont_round limit_view_icon"}),(0,_r.jsx)(D.Text,{className:"text",children:e})]}):(0,_r.jsx)(D.Text,{className:"text",children:e})},n)}))})};function Ba(e){var t=e.title,n=e.children,r=e.handleClose,a=e.subBtnText,o=e.mainBtnText,s=e.subCallback,c=e.mainCallback,l=e.isUpBottom,u=void 0!==l&&l,d=e.topElement,f=e.isFullScreen,p=e.isBackMask,m=e.headRightText,v=e.headRightCallback,g=e.scrollIntoView,y=void 0===g?"":g,_=e.zIndex,b=e.headLeftText,I=e.headLeftCallback,x=e.hideTitle,T=void 0!==x&&x,k=e.isCustomNavigation,S=void 0===k||k,C=e.bodyDiyStyle,w=void 0===C?{}:C,N=e.btnLogoUrl,E=e.subBtnStyle,P=e.subTextStyle,j=e.mainBtnStyle,R=e.mainTextStyle,A=e.isShowHeaderBorderBottom,V=void 0!==A&&A,L=(0,O.useState)(!0),B=(0,M.Z)(L,2),U=B[0],Z=B[1],F=h().getSystemInfoSync(),G=F.statusBarHeight,H=F.windowHeight,q=!!a||!!o||!!N,K=(0,i.Z)({},w),z=G;!1===S&&(z=0);var Y=H;S&&(Y=Y-G-78-60),f?K.height=Y:K.maxHeight=Y;var W=function(){Z(!1),setTimeout((function(){r&&r(),Z(!0)}),150)};return(0,_r.jsxs)(D.View,{catchMove:!0,className:"h_order_pop_full ".concat(!1===S?"":"h_order_pop_full_margin"," ").concat(u?"h_order_pop_full_upbottom":""),style:{zIndex:_,top:z},children:[(0,_r.jsx)(D.View,{className:"h_pop_close_mask",onClick:function(){W()}}),(0,_r.jsx)(D.View,{className:"h_pop_layout ".concat(U?"fadeInUp":"fadeOutDown"),children:(0,_r.jsxs)(D.View,{className:"h_pop_white",children:[!T&&(0,_r.jsxs)(D.View,{className:"h_pop_hd ".concat(V?"h_pop_hd_bt_border":""),children:[!!t&&(0,_r.jsx)(D.View,{className:"h_pop_hd_title",children:t}),!b&&!!r&&(0,_r.jsx)(D.View,{className:"h_pop_hd_close",children:(0,_r.jsx)(D.Text,{className:"h_pop_hd_close_text pop_iconfont ".concat(p?"back_iconfont":"close_iconfont"),onClick:function(){W()}})}),!!b&&(0,_r.jsx)(D.View,{className:"h_pop_hd_close",children:(0,_r.jsx)(D.Text,{className:"h_pop_hd_close_text",onClick:function(){I?I():W()},children:b})}),!!m&&(0,_r.jsx)(D.View,{className:"h_pop_hd_right",children:(0,_r.jsx)(D.Text,{className:"h_pop_hd_right_text",onClick:function(){v&&v()},children:m})})]}),(0,_r.jsxs)(D.View,{className:"h_pop_bd",children:[!!d&&d,(0,_r.jsx)(D.ScrollView,{className:"".concat(q?"btn-placeholder":""),style:K,scrollY:!0,scrollIntoView:y,children:n})]}),!!q&&(0,_r.jsx)(D.View,{className:"h_pop_foot",children:(0,_r.jsxs)(D.View,{className:"alertModBtnBox",children:[!!a&&(0,_r.jsx)(D.View,{className:"alertModBtn alertModBtnSub ".concat(E||""),onClick:function(){s?s():W()},children:(0,_r.jsx)(D.Text,{className:"popModBtnText alertModBtnSubText ".concat(P||""),children:a})}),!!o&&(0,_r.jsx)(D.View,{className:"alertModBtn ".concat(j||""),onClick:function(){console.log("\ud83d\ude3f",c,W),c?c():W()},children:(0,_r.jsx)(D.Text,{className:"popModBtnText ".concat(R||""),children:o})}),!!N&&(0,_r.jsx)(D.View,{className:"flex-center btnLogoUrl",children:(0,_r.jsx)(D.Image,{style:{width:"35%"},mode:"widthFix",src:N})})]})}),(0,_r.jsx)(_a,{})]})})]})}function Ua(){var e=yr.useState((function(e){var t=e.isShowBookLimitMask,n=e.bookingLimit;return{isShowBookLimitMask:t,bookingLimit:n}})),t=e.isShowBookLimitMask,n=e.bookingLimit,r=yr.useActions(),a=r.toggleBookLimitMask,o=r.ctrl;return t?(0,_r.jsx)(Ba,{title:"\u9884\u8ba2\u9650\u5236",handleClose:function(){a(!1)},mainBtnText:"\u786e\u5b9a",children:(0,_r.jsx)(D.View,{className:"limit_view",children:n.map((function(e,t){var n=oe.getRemoveHTMLTagExcludeA(e.description),r=e.clauseIsHighlight?{color:"#f70",fontWeight:600}:{};return(0,_r.jsxs)(D.View,{style:(0,i.Z)({display:"flex",alignItems:"flex-start"},r),children:[(0,_r.jsx)(D.Text,{className:"crn_iconfont iconfont_round limit_view_icon",style:{marginTop:"9px"}}),(0,_r.jsx)("mp-html",{content:n,copyLink:!1,onLinktap:function(e){e&&e.detail&&e.detail.href&&o.jumpH5({url:e.detail.href})}})]},t)}))})}):null}function Za(){var e=yr.useState((function(e){var t=e.isShowSaveOrderMask,n=e.options,r=e.tagInfo;return{isShowSaveOrderMask:t,options:n,tagInfo:r}})),t=e.isShowSaveOrderMask,n=e.options,r=e.tagInfo,a=yr.useActions(),o=a.ctrl,s=a.toggleSaveOrderMask,c=a.toggleCouponMask,l=a.openIM,u=a.saveOrderCallBack,d=a.beforeReturnPage,f=a.clickTraceLog,p=a.pollResources;if(!t)return null;var m=(0,i.Z)({},n),h=m.typeName,v=void 0===h?"":h,g=m.errorMessage,y=void 0===g?"":g,_={},b="dp_01";if("PriceChange"===v){var I=n.data,x=n.orderRequest,T=r||{},k=T.isTrain,S=void 0!==k&&k;_={mainBtnText:"\u7ee7\u7eed\u652f\u4ed8",mainCallback:function(){s({status:!1,options:null}),o.tracelog&&o.tracelog("grp_orddetail_paygetord_click",{orderid:I&&I.OrderId+"",trainticket:S?1:0}),I.NeedCallPolling?p(I,x):u(I)},subBtnText:"\u91cd\u65b0\u9009\u62e9",subCallback:function(){s({status:!1,options:null}),f("cru-pageid-room-click"),o.backToLastPage()}}}else if("PromotionChange"===v)_={mainBtnText:"\u91cd\u9009\u4f18\u60e0\u5238",mainCallback:function(){s({status:!1,options:null}),c(!0)}};else if("BookError"===v){b="dp_02";var C=n.data,w=n.shoppingId,N=n.ProductBasicInfo,E=N||{},P=(E.ProductId,E.SalesCityId,E.DepartCityId,C.ErrorInfo),j=void 0===P?{}:P;C.PaymentParameterInfo;j&&j.ErrorMessage&&j.Buttons||(j={ErrorMessage:"\u62b1\u6b49\uff0c\u60a8\u9009\u62e9\u7684\u8d44\u6e90\u9884\u8ba2\u5931\u8d25\u3002",Buttons:[{Name:"\u91cd\u9009\u8d44\u6e90",ActionPage:3}]}),y=j.AssistanceMsg||j.ErrorMessage;var O=function(e,t){return function(){if(2===t){o.backToLastPage({historyCount:2})}else if(4===t){var n=e.PaymentParameterInfo,r=void 0===n?{}:n,a=e.OrderId,i=(e.TempOrderId,r.IsPaidFirst),s="order_sback?tmpOrderId="+a+"&shoppingid="+w+"&themeproduct="+(N.IsThemeProduct?1:"")+"&ispaidfirst="+(i?1:"");o.jumpH5({url:"/webapp/vacations/tour/order_sback",params:s})}else if(5===t)l();else if(6===t){e.PaymentParameterInfo;var c=e.OrderId,u=e.TempOrderId,f=c||u;o.goToOrderDetail&&o.goToOrderDetail(f)}else if(7===t||3===t){var p=e.ErrorInfo,m=void 0===p?{}:p,h=m||{},v=h.ErrorCode,g=void 0===v?0:v;d(!1,{ErrorCode:g})}}};j.Buttons.map((function(e,t){var n=O(C,e.ActionPage),r=function(){s({status:!1}),n()};0===t?(_.mainBtnText=e.Name,_.mainCallback=r):1===t&&(_.subBtnText=e.Name,_.subCallback=r)}))}var R=_||{},A=R.mainBtnText,M=R.mainCallback,V=R.subBtnText,L=R.subCallback;return(0,_r.jsx)(Ba,{title:"\u8ba2\u5355\u63d0\u4ea4",handleClose:function(){s({status:!1})},mainBtnText:A,mainCallback:M,subBtnText:V,subCallback:L,children:(0,_r.jsxs)(D.View,{className:"book_error_view",children:[(0,_r.jsx)(D.View,{className:"book_error_image_view",children:(0,_r.jsx)(D.Image,{className:"book_error_image",src:"https://pic.c-ctrip.com/VacationH5Pic/group_travel/process_v2/".concat(b,".png")})}),(0,_r.jsx)(D.View,{className:"book_error_message",children:y||"\u4e0b\u5355\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"})]})})}function Fa(){var e=yr.useState((function(e){var t=e.isShowDuplicationMask,n=e.options;return{isShowDuplicationMask:t,options:n}})),t=e.isShowDuplicationMask,n=e.options,r=yr.useActions(),a=r.toggleDuplicationMask,o=r.checkTrain12306Time,i=r.ctrl;if(!t||!n)return null;var s=function(){a({status:!1}),o(1)},c=function(){a({status:!1}),n.OrderID&&i.goToOrderDetail(n.OrderID)};return(0,_r.jsx)(Ba,{title:"\u9884\u8ba2\u63d0\u9192",handleClose:function(){a({status:!1})},mainBtnText:"\u662f\uff0c\u7ee7\u7eed\u9884\u8ba2",mainCallback:s,subBtnText:"\u67e5\u770b\u91cd\u590d\u8ba2\u5355",subCallback:c,children:(0,_r.jsxs)(D.View,{className:"duplicate_view",children:[(0,_r.jsx)(D.View,{className:"duplicate_tit",children:"\u60a8\u8fd1\u671f\u5728\u8be5\u51fa\u884c\u65f6\u95f4\u5185\u9884\u8ba2\u8fc7\u76f8\u4f3c\u4ea7\u54c1\uff0c\u82e5\u91cd\u590d\u9884\u8ba2\u4f1a\u5bfc\u81f4\u5bf9\u5e94\u4eba\u5458\u884c\u7a0b\u51b2\u7a81"}),(0,_r.jsxs)(D.View,{className:"duplicate_detail",children:[(0,_r.jsxs)(D.View,{className:"duplicate_row",children:[(0,_r.jsx)(D.View,{className:"duplicate_row_left",children:(0,_r.jsx)(D.Text,{className:"duplicate_text",children:"\u8ba2\u5355\u53f7"})}),(0,_r.jsx)(D.View,{className:"duplicate_row_right",children:(0,_r.jsx)(D.Text,{className:"duplicate_text",children:n.OrderID})})]}),(0,_r.jsxs)(D.View,{className:"duplicate_row",children:[(0,_r.jsx)(D.View,{className:"duplicate_row_left",children:(0,_r.jsx)(D.Text,{className:"duplicate_text",children:"\u4ea7\u54c1\u540d\u79f0"})}),(0,_r.jsx)(D.View,{className:"duplicate_row_right",children:(0,_r.jsx)(D.Text,{className:"duplicate_text",children:n.PkgName})})]}),(0,_r.jsxs)(D.View,{className:"duplicate_row",children:[(0,_r.jsx)(D.View,{className:"duplicate_row_left",children:(0,_r.jsx)(D.Text,{className:"duplicate_text",children:"\u4e0b\u5355\u65f6\u95f4"})}),(0,_r.jsx)(D.View,{className:"duplicate_row_right",children:(0,_r.jsx)(D.Text,{className:"duplicate_text",children:n.OrderDate})})]}),(0,_r.jsxs)(D.View,{className:"duplicate_row",children:[(0,_r.jsx)(D.View,{className:"duplicate_row_left",children:(0,_r.jsx)(D.Text,{className:"duplicate_text",children:"\u4ef7\u683c"})}),(0,_r.jsx)(D.View,{className:"duplicate_row_right",children:(0,_r.jsxs)(D.Text,{className:"duplicate_text",children:["\xa5",n.OrderPrice]})})]}),(0,_r.jsxs)(D.View,{className:"duplicate_row",children:[(0,_r.jsx)(D.View,{className:"duplicate_row_left",children:(0,_r.jsx)(D.Text,{className:"duplicate_text",children:"\u8ba2\u5355\u72b6\u6001"})}),(0,_r.jsx)(D.View,{className:"duplicate_row_right",children:(0,_r.jsx)(D.Text,{className:"duplicate_text",children:n.OrderState})})]}),(0,_r.jsxs)(D.View,{className:"duplicate_row",children:[(0,_r.jsx)(D.View,{className:"duplicate_row_left",children:(0,_r.jsx)(D.Text,{className:"duplicate_text",children:"\u51fa\u884c\u4eba"})}),(0,_r.jsx)(D.View,{className:"duplicate_row_right",children:(0,_r.jsx)(D.Text,{className:"duplicate_text",children:n.ClientNameList&&n.ClientNameList.join(" ")})})]})]})]})})}var Ga=n(32180)["document"],Ha=function(e){var t=e.isShowCountryCodeMask,n=void 0!==t&&t,r=e.curCode,i=void 0===r?86:r,s=e.curName,c=e.handleClose,l=e.handleSelect,u=e.isShowCountryCode,d=void 0===u||u,f=(0,O.useState)(null),p=(0,M.Z)(f,2),m=p[0],h=p[1],v=(0,O.useState)(""),g=(0,M.Z)(v,2),y=g[0],_=g[1];(0,O.useEffect)((function(){if((!m||!Object.keys(m).length)&&n){var e=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ka();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e().then((function(e){h(e)}))}}),[n]);var b=function(e){var t=e||{},n=t.cn,r=t.code;t.open,t.py,t.country,t.en;l({showName:n,countryCode:r}),c()},I=function(e){try{if(!e)return;var t=e.mpEvent||{},n=t.target,r=n||{},a=r.id,o=Ga.getElementById(a);if(o){var i=o.props["data-label"],s=Ga.getElementsByClassName(i)[0],c=s,l=c.uid;l&&_(l)}}catch(e){console.log("error",e)}};if(!n||!m)return null;var x=m||{},T=x.resultData,k=x.words,S=za(k,I);return console.log("CountryCode render==="),(0,_r.jsx)(Ba,{title:"\u9009\u62e9\u56fd\u5bb6\u6216\u5730\u533a",handleClose:c,scrollIntoView:y,topElement:S,zIndex:101,isFullScreen:!0,isCustomNavigation:!0,children:(0,_r.jsx)(D.View,{className:"country_code_module",children:!!k&&!!k.length&&k.map((function(e,t){return(0,_r.jsxs)(D.View,{className:"code_area lable_".concat(e),children:[(0,_r.jsx)(D.View,{className:"code_tit lable_hot",children:"hot"===e?"\u70ed\u95e8":e}),(0,_r.jsx)(D.View,{className:"code_con",children:T[e].map((function(e,t){var n=e.code===i&&(!s||e.cn===s);return(0,_r.jsxs)(D.View,{className:"item ".concat(n?"current":""," flex_box split_line "),onClick:function(){b(e)},children:[(0,_r.jsx)(D.View,{className:"flex_0",children:(0,_r.jsx)(D.Text,{className:"country",children:e.cn})}),!!d&&(0,_r.jsx)(D.View,{className:"code flex_1",children:e.code}),!!n&&(0,_r.jsx)(D.View,{children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_check"})})]})}))})]})}))})})},qa=O.memo(Ha),Ka=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,r,o,s;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,m.request)({url:"https://sec-m.ctrip.com/restapi/soa2/12687/GetCountryCode",method:"GET"});case 3:if(t=e.sent,n=t.data,!n||!n.ResponseStatus||"Success"!==n.ResponseStatus.Ack){e.next=15;break}return r=(null===n||void 0===n?void 0:n.countryInfoList)||[],o={},s=[],r.map((function(e,t){var n=e||{},r=n.py;if(r){var a=r.split("")[0];o[a]||(o[a]=[],s.push(a)),t<8&&(o["hot"]||(o["hot"]=[]),o["hot"].push((0,i.Z)({},e))),o[a].push((0,i.Z)({},e))}})),s.sort((function(e,t){return e.charCodeAt(0)-t.charCodeAt(0)})),s.unshift("hot"),e.abrupt("return",{resultData:o,words:s});case 15:return e.abrupt("return",!1);case 16:e.next=21;break;case 18:return e.prev=18,e.t0=e["catch"](0),e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}(),za=function(e,t){return(0,_r.jsx)(D.View,{className:"letter_navi",children:e&&e.map((function(e,n){return(0,_r.jsx)(D.Text,{"data-label":"lable_".concat(e),onClick:t,children:"hot"===e?"\u70ed\u95e8":e})}))})};function Ya(){var e=yr.useState((function(e){var t=e.isShowTrainDetailMask,n=e.trainInfo;return{isShowTrainDetailMask:t,trainInfo:n}})),t=e.isShowTrainDetailMask,n=e.trainInfo,r=yr.useActions(),a=r.toggleTrainDetailMask,o=(0,O.useCallback)((function(){a(!1)}),[]);if(!t)return null;var i=n||{},s=i.data,c=void 0===s?[]:s,l=[],u=[];return(0,_r.jsx)(Ba,{title:"\u8f66\u6b21\u8be6\u60c5",handleClose:o,children:(0,_r.jsx)(D.View,{className:"train_detail_wrapper",children:c&&c.map((function(e,t){return null!==e&&void 0!==e&&e.isShowTicketSoldOut&&(l.push(null===e||void 0===e?void 0:e.trainNo),u.push(null===e||void 0===e?void 0:e.seatName)),(0,_r.jsxs)(O.Fragment,{children:[(0,_r.jsxs)(D.View,{className:"prs_FlexRow prs_FlexAlignCenter",children:[(0,_r.jsx)(D.View,{className:"prs_NumBluebg",children:(0,_r.jsx)(D.View,{className:"prs_Text22 prs_color_fff",children:null===e||void 0===e?void 0:e.trainIndex})}),(0,_r.jsxs)(D.View,{className:"prs_FlightLineTit prs_flex_1 prs_FlexRow",children:[(0,_r.jsx)(D.View,{className:"prs_Text26 prs_color_text_1",children:null===e||void 0===e?void 0:e.departDate}),(0,_r.jsx)(D.View,{className:"prs_FlightlineDiv"}),(0,_r.jsxs)(D.View,{className:"prs_FlexRow prs_FlexAlignCenter",children:[(0,_r.jsx)(D.View,{className:"prs_Text26 prs_color_text_1",children:null===e||void 0===e?void 0:e.departCityName}),(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_to prs_FlightlineIcon1 prs_color_text_3"}),(0,_r.jsx)(D.View,{className:"prs_Text26 prs_color_text_1",children:null===e||void 0===e?void 0:e.arriveCityName})]}),(0,_r.jsx)(D.View,{className:"prs_FlightlineDiv"}),(0,_r.jsxs)(D.View,{className:"prs_FlexRow prs_FlexAlignCenter",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_clock prs_FlightlineIcon2 prs_Text30"}),(0,_r.jsx)(D.View,{className:"prs_Text26 prs_color_text_1",children:null===e||void 0===e?void 0:e.durationMinutes})]})]})]}),(0,_r.jsx)(D.View,{className:"prs_FlexRow prs_marginTextTop",children:(0,_r.jsxs)(D.View,{className:"prs_FlightLineTit prs_flex_1 prs_FlexRow",children:[(0,_r.jsx)(D.View,{className:"prs_Text26 prs_color_text_3",children:null===e||void 0===e?void 0:e.trainNo}),(0,_r.jsx)(D.View,{className:"prs_FlightlineDiv"}),(0,_r.jsx)(D.View,{className:"prs_Text26 prs_color_text_3",children:null===e||void 0===e?void 0:e.seatName}),((null===e||void 0===e?void 0:e.confirmDuration)||(null===e||void 0===e?void 0:e.isSupportIDCard)||(null===e||void 0===e?void 0:e.isShowTicketSoldOut)||(null===e||void 0===e?void 0:e.isCR))&&(0,_r.jsx)(D.View,{className:"prs_FlightlineDiv"}),!(null===e||void 0===e||!e.confirmDuration)&&(0,_r.jsx)(D.View,{className:"prs_tag tag_green",children:"\u7acb\u5373\u786e\u8ba4"}),!(null===e||void 0===e||!e.isShowTicketSoldOut)&&(0,_r.jsx)(D.View,{className:"prs_tag tag_orange",children:"\u9700\u62a2\u7968"}),!(null===e||void 0===e||!e.isSupportIDCard)&&(0,_r.jsx)(D.View,{className:"prs_tag tag_blue",children:"\u53ef\u5237\u8eab\u4efd\u8bc1"}),!(null===e||void 0===e||!e.isCR)&&(0,_r.jsx)(D.View,{className:"prs_tag tag_blue",children:"\u590d\u5174\u53f7"})]})}),(0,_r.jsx)(D.View,{className:"prs_FlexColumn",children:(0,_r.jsxs)(D.View,{className:"prs_marginOutTop prs_FlexColumn prs_relative",children:[(0,_r.jsxs)(D.View,{className:"prs_FlightRangeLine",children:[(0,_r.jsx)(D.View,{className:"prs_FlightRangeLineCircle_top"}),(0,_r.jsx)(D.View,{className:"prs_FlightRangeLineCircle_bottom"})]}),(0,_r.jsxs)(D.View,{className:"prs_FlexRow prs_marginModBottom",children:[(0,_r.jsx)(D.View,{className:"prs_FlightRangeTime",children:(0,_r.jsx)(D.View,{className:"prs_Flight_TextMedium",children:null===e||void 0===e?void 0:e.departTime})}),(0,_r.jsx)(D.View,{className:"prs_FlightRangeName",children:(0,_r.jsx)(D.View,{className:"prs_Flight_TextMedium",children:null===e||void 0===e?void 0:e.departStationName})})]}),(0,_r.jsxs)(D.View,{className:"prs_FlexRow prs_marginModTop prs_relative",children:[(0,_r.jsx)(D.View,{className:"prs_FlightRangeTime",children:(0,_r.jsx)(D.View,{className:"prs_Flight_TextMedium",children:null===e||void 0===e?void 0:e.arriveTime})}),(0,_r.jsx)(D.View,{className:"prs_FlightRangeName",children:(0,_r.jsx)(D.View,{className:"prs_Flight_TextMedium",children:null===e||void 0===e?void 0:e.arriveStationName})})]})]})}),(0,_r.jsx)(D.View,{className:"prs_DividingLineHorizon"}),!(null===e||void 0===e||!e.trainNoGrabList)&&(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsxs)(D.View,{className:"prs_FlexRow",children:[(0,_r.jsx)(D.View,{className:"prs_titleAlternative prs_flex_0",children:(0,_r.jsx)(D.View,{className:"prs_Text30 prs_color_text_1",children:"\u62a2\u7968\u8f66\u6b21"})}),(0,_r.jsx)(D.View,{className:"prs_FlexRow prs_flex_1 prs_FlexAlignCenter",children:(0,_r.jsx)(D.View,{className:"prs_tour_flex1 prs_FlexColumn",children:(0,_r.jsx)(D.View,{className:"prs_Text30 prs_color_text_1",children:e.trainNoGrabList})})})]}),(0,_r.jsx)(D.View,{className:"prs_DividingLineHorizon"})]}),!(null===e||void 0===e||!e.trainSeatGrabList)&&(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsxs)(D.View,{className:"prs_FlexRow",children:[(0,_r.jsx)(D.View,{className:"prs_titleAlternative prs_flex_0",children:(0,_r.jsx)(D.View,{className:"prs_Text30 prs_color_text_1",children:"\u62a2\u7968\u5750\u5e2d"})}),(0,_r.jsx)(D.View,{className:"prs_FlexRow prs_flex_1 prs_FlexAlignCenter",children:(0,_r.jsx)(D.View,{className:"prs_tour_flex1 prs_FlexColumn",children:(0,_r.jsx)(D.View,{className:"prs_Text30 prs_color_text_1",children:e.trainSeatGrabList})})})]}),(0,_r.jsx)(D.View,{className:"prs_DividingLineHorizon"})]})]},(null===e||void 0===e?void 0:e.trainNo)||t)}))})})}function Wa(){var e=yr.useState((function(e){var t=e.isShowTrainSelectSeatMask,n=e.trainInfo,r=e.selectedTrainSeats,a=e.trainSeatNum;return{isShowTrainSelectSeatMask:t,trainInfo:n,selectedTrainSeats:r,trainSeatNum:a}})),t=e.isShowTrainSelectSeatMask,n=e.trainInfo,r=e.selectedTrainSeats,a=e.trainSeatNum,o=void 0===a?0:a,s=yr.useActions(),c=s.updateTrainSelectedSeat,l=s.toggleTrainSelectSeatMask,u=(0,O.useState)(oe.cloneDeep(r)),d=(0,M.Z)(u,2),f=d[0],p=d[1],m=(0,O.useState)({}),h=(0,M.Z)(m,2),v=h[0],g=h[1],y=(0,O.useMemo)((function(){return o>1?[1,2]:[1]}),[o]);if((0,O.useEffect)((function(){t&&p(oe.cloneDeep(r)),!t&&g([])}),[t]),(0,O.useEffect)((function(){oe.forEach(f,(function(e){(oe.isEmpty(null===e||void 0===e?void 0:e.SeatNumbers)||e.SeatNumbers.length===o)&&(v[e.TrainNo]=!1)})),g((0,i.Z)({},v))}),[f]),!t)return null;var _=n||{},b=_.data,I=void 0===b?[]:b;return console.log("TrainSelectSeatPop render==="),(0,_r.jsx)(Ba,{title:"\u9009\u62e9\u5ea7\u4f4d",handleClose:function(){l(!1)},mainBtnText:"\u786e\u5b9a",mainCallback:function(){console.log("======selectedSeats======",f);var e=!0;oe.forEach(f,(function(t,n){null!==t&&void 0!==t&&t.SeatNumbers&&t.SeatNumbers.length&&t.SeatNumbers.length!==o&&(e=!1,v[t.TrainNo]=!0)})),e?(c(f),l(!1)):g((0,i.Z)({},v))},children:(0,_r.jsxs)(D.View,{className:"choose_seat_wrap",children:[(0,_r.jsx)(D.View,{className:"top_tip_con",children:(0,_r.jsxs)(D.View,{className:"top_tip_con_text",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_strong_tips"}),"\u4f18\u5148\u6309\u6307\u5b9a\u5ea7\u4f4d\u51fa\u7968\uff0c\u82e5\u6307\u5b9a\u5ea7\u4f4d\u65e0\u7968\uff0c\u5c06\u8f6c\u8d2d\u5176\u4ed6\u5ea7\u4f4d"]})}),I&&I.map((function(e,t){if(null===e||void 0===e||!e.isSupportSelectSeat)return null;var n=f&&f.filter((function(t){return t.SegmentNo===e.segmentNo&&t.TrainNo===e.trainNo}))[0];return n=n&&n.SeatNumbers||[],(0,_r.jsxs)(D.View,{className:"choose_seat_item",children:[(0,_r.jsxs)(D.View,{className:"choose_seat_item_tit prs_flex_box prs_flex_1",children:[(0,_r.jsxs)(D.View,{className:"ticket_info prs_flex_1",children:[(0,_r.jsx)(D.View,{className:"num",children:e.trainIndex}),(0,_r.jsxs)(D.View,{className:"prs_flex_1 prs_flex_box ticket_info_text",children:[(0,_r.jsxs)(D.View,{className:"prs_flex_box",children:[null===e||void 0===e?void 0:e.departCityName,(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_to prs_FlightlineIcon1 prs_color_text_3"}),null===e||void 0===e?void 0:e.arriveCityName]}),(0,_r.jsx)(D.View,{className:"ticket_info_line"}),(0,_r.jsx)(D.View,{className:"prs_flex_box train_num",children:null===e||void 0===e?void 0:e.trainNo}),(0,_r.jsx)(D.View,{className:"ticket_info_line"}),(0,_r.jsx)(D.View,{className:"prs_flex_box",children:null===e||void 0===e?void 0:e.seatName})]})]}),(0,_r.jsxs)(D.View,{className:"seat_info prs_flex_0",children:["\u5df2\u9009\u5ea7",(0,_r.jsx)(D.Text,{className:"num",children:n.length}),"/",o]})]}),y.map((function(t,r){return(0,_r.jsxs)(D.View,{className:"choose_seat_item_con  prs_flex_box prs_flex_1",children:[(0,_r.jsxs)(D.View,{className:"seat_left prs_flex_box",children:[(0,_r.jsx)(D.View,{className:"seat_text seat_text_l",children:"\u9760\u7a97"}),(0,_r.jsxs)(D.View,{className:"seat_con1 prs_flex_box prs_flex_1",children:[(0,_r.jsx)($a,{type:"A",selected:oe.includes(n,"".concat(t,"A")),callback:function(){p(Xa(f,e.segmentNo,e.trainNo,o,"".concat(t,"A")))}}),"\u4e8c\u7b49\u5ea7"===(null===e||void 0===e?void 0:e.seatName)&&(0,_r.jsx)($a,{type:"B",selected:oe.includes(n,"".concat(t,"B")),callback:function(){p(Xa(f,e.segmentNo,e.trainNo,o,"".concat(t,"B")))}}),(0,_r.jsx)($a,{type:"C",selected:oe.includes(n,"".concat(t,"C")),callback:function(){p(Xa(f,e.segmentNo,e.trainNo,o,"".concat(t,"C")))}})]})]}),(0,_r.jsx)(D.View,{className:"seat_center",children:(0,_r.jsx)(D.View,{className:"seat_text seat_text_center",children:"\u8fc7\u9053"})}),(0,_r.jsxs)(D.View,{className:"seat_right prs_flex_box",children:[(0,_r.jsxs)(D.View,{className:"seat_con1 prs_flex_box prs_flex_1",children:[("\u4e00\u7b49\u5ea7"===(null===e||void 0===e?void 0:e.seatName)||"\u4e8c\u7b49\u5ea7"===(null===e||void 0===e?void 0:e.seatName))&&(0,_r.jsx)($a,{type:"D",selected:oe.includes(n,"".concat(t,"D")),callback:function(){p(Xa(f,e.segmentNo,e.trainNo,o,"".concat(t,"D")))}}),(0,_r.jsx)($a,{type:"F",selected:oe.includes(n,"".concat(t,"F")),callback:function(){p(Xa(f,e.segmentNo,e.trainNo,o,"".concat(t,"F")))}})]}),(0,_r.jsx)(D.View,{className:"seat_text seat_text_r",children:"\u9760\u7a97"})]})]},"seatline-".concat(t))}))]},(null===e||void 0===e?void 0:e.trainNo)||t)}))]})})}function $a(e){var t=e.type,n=e.selected,r=e.callback,a=null;switch(t){case"A":a=(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_seat iconfont_seat_a ".concat(n?"current":"")});break;case"B":a=(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_seat iconfont_seat_b ".concat(n?"current":"")});break;case"C":a=(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_seat iconfont_seat_c ".concat(n?"current":"")});break;case"D":a=(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_seat iconfont_seat_d ".concat(n?"current":"")});break;case"F":a=(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_seat iconfont_seat_f ".concat(n?"current":"")});break;default:break}return(0,_r.jsx)(D.View,{className:"seat_con_item prs_flex_box prs_flex_1",onClick:r,children:a})}function Xa(e,t,n,r,a){var o=!1;return console.log("\ud83e\udd2cselectedSeats",e),oe.forEach(e,(function(e){if(e&&e.SegmentNo===t&&e.TrainNo===n){o=!0;var i=e.SeatNumbers||[],s=i.indexOf(a);s>-1?i.splice(s,1):(r<=i.length&&i.pop(),i.push(a)),e.SeatNumbers=i}})),o||e.push({SegmentNo:t,TrainNo:n,SeatNumbers:[a]}),(0,R.Z)(e)}function Ja(){var e=yr.useState((function(e){var t=e.selectIds,n=e.template,r=e.passengerObj,a=e.isShowInsuranceSelectPersonMask,o=e.shoppingId,i=e.ResourcePassengerMapList,s=e.selectedToken,c=e.resourceinfo,l=e.taroInfo;return{selectIds:t,template:n,passengerObj:r,isShowInsuranceSelectPersonMask:a,shoppingId:o,ResourcePassengerMapList:i,selectedToken:s,resourceinfo:c,taroInfo:l}})),t=e.selectIds,n=(e.template,e.passengerObj),r=e.isShowInsuranceSelectPersonMask,a=e.shoppingId,o=e.ResourcePassengerMapList,i=e.selectedToken,s=e.resourceinfo,c=e.taroInfo,l=yr.useActions(),u=l.ctrl,d=l.toggleInsuranceSelectPersonMask;if(!r)return null;var f=o&&o.filter((function(e){return e.ResourceToken===i}))[0]||{},p=(null===f||void 0===f?void 0:f.PassengerTokenList)||[];if(oe.isEmpty(p)){var m;p=t;var h=s["INSURANCE"]||{},v=(null===h||void 0===h||null===(m=h.specialTokens)||void 0===m?void 0:m.floatCancellation)||[];oe.includes(v,i)&&(p=p.slice(0,1))}return console.log("InsuranceSelectPersonPop render==="),(0,_r.jsx)(Ba,{title:"\u88ab\u4fdd\u4eba\u4fe1\u606f",handleClose:function(){d({status:!1})},headLeftText:"\u53d6\u6d88",headLeftCallback:function(){d({status:!1})},headRightText:"\u5b8c\u6210",headRightCallback:function(){d({status:!1,currentValue:1})},children:(0,_r.jsx)(_r.Fragment,{children:(0,_r.jsx)(D.View,{className:"prs_pop_select_list",children:p.map((function(e,t){var r=n[e],o=Zt(e,n,null,!0),i=r||{},s=i.PassengerID,l=void 0===s?0:s,d=i.idInfos,f=void 0===d?[]:d,p=i.isComplete,m=void 0!==p&&p;return(0,_r.jsxs)(D.View,{className:"prs_pop_select ".concat(e.related>4?" not_optional":""),onClick:function(){u&&u.goToPassengerEdit({shoppingId:a,passengerId:l,chosenInfo:null===r||void 0===r?void 0:r.chosenInfo,taroInfo:c})},children:[(0,_r.jsxs)(D.View,{className:"select_main",children:[(0,_r.jsx)(D.View,{className:"item_name",children:o}),f&&f.length>0&&f.map((function(e,t){return e.cardName?(0,_r.jsx)(D.View,{className:"item_name_sub",children:"".concat(e.cardName," ").concat(ze(e||{}))}):null})),!m&&(0,_r.jsxs)(D.View,{className:"item_name_sub txt_warning",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_common iconfont_strong_warning"}),(0,_r.jsx)(D.View,{className:"text",children:"\u4fe1\u606f\u4e0d\u5168\uff0c\u8bf7\u8865\u5145"})]})]}),(0,_r.jsx)(D.View,{className:"right_ins_check",children:(0,_r.jsx)(fa,{checked:!0})})]})}))})})})}function Qa(){var e=yr.useState((function(e){var t=e.isShowResourceSelectPersonMask,n=e.ResourcePassengers,r=e.selectIds,a=e.ResourcePassengerMapList,o=e.selectedToken,i=e.passengerObj;return{isShowResourceSelectPersonMask:t,ResourcePassengers:n,selectIds:r,ResourcePassengerMapList:a,selectedToken:o,passengerObj:i}})),t=e.isShowResourceSelectPersonMask,n=e.ResourcePassengers,r=e.selectIds,a=e.ResourcePassengerMapList,o=e.selectedToken,s=e.passengerObj,c=yr.useActions(),l=c.orderTraceDevLog,u=c.toggleResourceSelectPersonMask,d=(0,O.useState)([]),f=(0,M.Z)(d,2),p=f[0],m=f[1];if((0,O.useEffect)((function(){var e=a&&a.filter((function(e){return e.ResourceToken===o}))[0],t=e||{},n=t.PassengerTokenList,r=void 0===n?[]:n;m((0,R.Z)(r))}),[a,o]),!t)return null;var v=n.filter((function(e){return e.ResourceInfo&&e.ResourceInfo.Token===o}))[0],g=v||{},y=g.PassengerInfo,_=void 0===y?{}:y,b=g.ResourceInfo,I=void 0===b?{}:b,x=I||{},T=x.MinAge,k=void 0===T?0:T,S=x.MaxAge,C=void 0===S?0:S,w=x.ResourceType,N=x.CategoryId,E=x.Token,P=void 0===E?"":E,j="";k&&C?j="\u8be5\u8d44\u6e90\u4ec5\u652f\u6301".concat(k,"\u5c81-").concat(C,"\u5c81\u5ba2\u4eba\u9884\u8ba2"):k?j="\u8be5\u8d44\u6e90\u4ec5\u652f\u6301".concat(k,"\u5c81\u4ee5\u4e0a\u5ba2\u4eba\u9884\u8ba2"):C&&(j="\u8be5\u8d44\u6e90\u4ec5\u652f\u6301".concat(C,"\u5c81\u4ee5\u4e0b\u5ba2\u4eba\u9884\u8ba2"));var A=_||{},V=A.AdultCount,L=void 0===V?0:V,B=A.ChildCount,U=void 0===B?0:B,Z=L+U,F=Z>1,G=3===w&&15===N,H="03TL"===P.substr(0,4),q="04TO"===P.substr(0,4),K=[];return oe.forEach(r,(function(e){var t=(0,i.Z)({},s[e]),n=t||{},r=n.AgeRang,a=void 0===r?-1:r,o=n.age,c=void 0===o?-1:o;(k&&C&&c>-1&&(c>C||c<k)||k&&c>-1&&c<k||C&&c>-1&&c>C)&&(t.isOut=!0),G||H||q?K.push(t):0!==a&&1!==a||K.push(t)})),console.log("ResourceSelectPersonPop render==="),F?(0,_r.jsx)(Ba,{title:"\u8bf7\u9009\u62e9".concat(Z,"\u4f4d\u4f7f\u7528\u4eba"),handleClose:function(){u({status:!1})},mainBtnText:"\u786e\u5b9a",mainCallback:function(){p.length===Z?(l("o_vac_order_select_resourceperson",{ids:p,token:P}),u({status:!1,currentValue:p})):h().showToast({title:"\u8bf7\u9009\u62e9".concat(Z,"\u540d\u4f7f\u7528\u4eba"),mask:!0})},children:(0,_r.jsxs)(_r.Fragment,{children:[!!j&&(0,_r.jsx)(D.View,{className:"prs_pop_top_tip",children:(0,_r.jsxs)(D.View,{className:"tip_text",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_strong_tips iconfont_i"}),j]})}),(0,_r.jsx)(D.View,{className:"prs_pop_select_list",children:K.map((function(e,t){var n=Zt(e.PassengerID,s),r=oe.includes(p,String(e.PassengerID));return(0,_r.jsxs)(D.View,{className:"prs_pop_select ".concat(e.isOut?" not_optional":""),onClick:function(){if(!e.isOut){var t=(0,R.Z)(p);r?t=t.filter((function(t){return+t!==+e.PassengerID})):t.push(String(e.PassengerID)),m(t)}},children:[(0,_r.jsx)(D.View,{className:"select_main",children:(0,_r.jsx)(D.View,{className:"item_name",children:n})}),(0,_r.jsx)(D.View,{className:"right_com_check",children:(0,_r.jsx)(fa,{checked:r,onpress:null})})]})}))})]})}):(0,_r.jsx)(Ba,{title:"\u8bf7\u9009\u62e9".concat(Z,"\u4f4d\u4f7f\u7528\u4eba"),handleClose:function(){u({status:!1})},children:(0,_r.jsxs)(_r.Fragment,{children:[!!j&&(0,_r.jsx)(D.View,{className:"prs_pop_top_tip",children:(0,_r.jsxs)(D.View,{className:"tip_text",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_strong_tips iconfont_i"}),j]})}),(0,_r.jsx)(D.View,{className:"prs_pop_select_list",children:K.map((function(e,t){var n=Zt(e.PassengerID,s);return(0,_r.jsxs)(D.View,{className:"prs_pop_select ".concat(e.isOut?" not_optional":""),onClick:function(){e.isOut||(l("o_vac_order_select_resourceperson",{ids:e.PassengerID,token:P}),u({status:!1,currentValue:[String(e.PassengerID)]}))},children:[(0,_r.jsx)(D.View,{className:"select_main",children:(0,_r.jsx)(D.View,{className:"item_name",children:n})}),oe.includes(p,String(e.PassengerID))&&(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_big_check"})]})}))})]})})}function eo(){var e=yr.useState((function(e){var t=e.isShowUrgentNoticeMask,n=e.urgentInfo;return{isShowUrgentNoticeMask:t,urgentInfo:n}})),t=e.isShowUrgentNoticeMask,n=e.urgentInfo,r=yr.useActions(),a=r.toggleUrgentNoticeMask;return t?(0,_r.jsx)(Ba,{title:"\u516c\u544a\u8be6\u60c5",handleClose:function(){return a(!1)},children:(0,_r.jsx)(D.View,{className:"prs_pop_urgent_con",children:null===n||void 0===n?void 0:n.map((function(e){var t=be[e.Weight]||"",n=0===e.Weight?be[0]:be[1];return(0,_r.jsxs)(D.View,{className:"prs_pop_urgent_item",children:[(0,_r.jsx)(D.View,{className:"icon_container flex_center",children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_strong_tips iconfont_i ".concat(n)})}),(0,_r.jsxs)(D.View,{className:"text_container",children:[!(null===e||void 0===e||!e.Title)&&(0,_r.jsx)(D.View,{className:"title_container",children:(0,_r.jsx)(D.Text,{className:"title ".concat(t),children:e.Title})}),(0,_r.jsx)(D.View,{className:"content_container",style:{fontSize:"12px",lineHeight:"18px"},children:null!==e&&void 0!==e&&e.RichContent?(0,_r.jsx)("mp-html",{content:e.RichContent,copyLink:!1}):(0,_r.jsx)(D.Text,{children:e.Content})})]})]},e.Title)}))})}):null}function to(){var e=yr.useState((function(e){var t=e.isShowInsuranceIntroductionMask,n=e.options;return{isShowInsuranceIntroductionMask:t,options:n}})),t=e.isShowInsuranceIntroductionMask,n=e.options,r=yr.useActions(),a=r.ctrl,o=r.toggleInsIntroducMask;if(!t)return null;var i=n.name,s=void 0===i?"":i,c=n.coverageGroupList,l=void 0===c?[]:c,u=n.detailUrl,d=n.clauseUrl,f=n.description,p=n.diyRules,m=void 0===p?[]:p;n.saleTag;oe.isEmpty(f)||(f=f.replace(/(\r\n|\n|\r)/gm,""));var h="";return u&&(h+="\u8be6\u7ec6\u4fe1\u606f\u8bf7\u89c1<a href=".concat(u,' class="txt_blue">').concat(s,"</a>")),u&&d&&(h+="\uff0c"),d&&(h+="\u8bf7\u4ed4\u7ec6\u9605\u8bfb<a href=".concat(d,' class="txt_blue">\u201c\u4fdd\u9669\u6761\u6b3e(\u53ca\u5907\u6848\u53f7)\u201d\u548c\u5176\u4e2d\u7684\u514d\u9664\u8d23\u4efb</a>')),h&&(h+="\u3002"),f&&(f=f.replace(/src="\/\//g,'src="https://'),f=f.replace(/style="/g,'style="font-size: 14px !important;text-align: left!important;line-height: 1.3!important;float: none!important;padding: 0!important;position: static!important;height: auto!important;'),f=f.replace(/<img(.*?)src="(.*?)"(.*?)\/>/g,'<img style="display: block!important;vertical-align: top!important;width: 100%!important;" src="$2" />')),(0,_r.jsx)(Ba,{title:s,handleClose:function(){o({status:!1})},children:(0,_r.jsxs)(D.View,{className:"flight-retreat-remark",children:[!oe.isEmpty(m)&&(0,_r.jsxs)(D.View,{className:"fx_items",children:[(0,_r.jsx)(D.View,{className:"ins_title",children:(0,_r.jsx)(D.Text,{className:"ins_title_text",children:"\u4f7f\u7528\u89c4\u5219"})}),(0,_r.jsx)(D.View,{className:"rules",children:m.map((function(e,t){return(0,_r.jsx)(D.View,{children:"".concat(t+1,". ").concat(e)},t)}))})]}),l.length>0&&(0,_r.jsxs)(D.View,{className:"fx_items",children:[(0,_r.jsx)(D.View,{className:"ins_title",children:(0,_r.jsx)(D.Text,{className:"ins_title_text",children:"\u4fdd\u9669\u9879\u76ee\u548c\u4fdd\u9669\u9650\u989d"})}),l.map((function(e){return(0,_r.jsxs)(D.View,{className:"fx_lis",children:[(0,_r.jsx)(D.View,{className:"fx_lab",children:e.GroupName}),(0,_r.jsx)(D.View,{className:"fx_lan",children:e.CoverageItems.map((function(e,t){return(0,_r.jsxs)(D.View,{className:"fx_lis",children:[(0,_r.jsx)(D.View,{className:"fx_lab_4",children:e.Name}),(0,_r.jsx)(D.View,{className:"fx_lan",children:(0,_r.jsx)(D.View,{className:"fx_lab_price",children:e.Amount})})]},t)}))})]},e.GroupId)}))]}),h&&(0,_r.jsx)(D.View,{className:"prs_pop_explain_info",children:h&&(0,_r.jsx)("mp-html",{content:h,copyLink:!1,onLinktap:function(e){e&&e.detail&&e.detail.href&&a.jumpH5({url:e.detail.href})}})}),f&&(0,_r.jsxs)(D.View,{className:"info_text",children:[(0,_r.jsx)(D.View,{className:"info_text_tit",children:"\u7279\u6b8a\u8bf4\u660e\uff1a"}),(0,_r.jsx)("mp-html",{content:f,copyLink:!1,onLinktap:function(e){e&&e.detail&&e.detail.href&&a.jumpH5({url:e.detail.href})}})]}),(0,_r.jsx)(_a,{})]})})}function no(){var e=yr.useState((function(e){var t=e.isShowCouponMask,n=e.selectedPromotion,r=e.logInfo,a=e.forceReloadTimestamp,o=e.priceDetail,i=e.marketingInfo,s=e.shoppingId;return{isShowCouponMask:t,selectedPromotion:n,logInfo:r,forceReloadTimestamp:a,priceDetail:o,marketingInfo:i,shoppingId:s}})),t=e.isShowCouponMask,n=e.selectedPromotion,r=e.forceReloadTimestamp,s=(e.logInfo,e.priceDetail,e.marketingInfo),c=e.shoppingId,l=yr.useActions(),u=l.useCouponBack,d=l.orderTraceDevLog,f=l.toggleCouponMask;if(!r)return null;var m=p.CouponEnum||{},h=m.SourceEnum,v=m.EnvEnum,g=m.CTEnum,y=m.ClientEnum,_=m.SaleChannel3Enum,b=s.allianceid,I=s.sid,T=x.getEnv();console.log("==================env==================",T);var k={visible:t,initCouponCode:"",notUseCoupon:!(!n||2!==n.useStatus),clientEnv:{env:"prd"===T?v.Prod:v.Fat,ctType:g.CTRIP,clientType:y.MiniProgram},data:{forceReloadTimestamp:r+"",source:h.TOUR,saleChannel:_.Ctrip_Mina,allianceId:b,siteId:I,clientId:"",pageId:String("pkg_order"),locale:"zh-CN",currency:"CNY",bookingInfo:{shoppingId:c},rmsToken:""},onSelect:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return d("o_vac_order_click_coupon_callback",t),e.next=3,u(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),onClose:function(){f(!1)},onError:function(e){u(null)}};return(0,_r.jsx)(p.UseCoupon,(0,i.Z)({},k))}function ro(){var e=yr.useState((function(e){return e.isShowInsConfirmMask})),t=yr.useState((function(e){return e.resourceinfo})),n=yr.useState((function(e){return e.shoppinginfo}));if(!e)return null;var r=t&&t[We.INSURANCE]||{},a=n&&n[We.INSURANCE]||{},o=r||{},i=o.insuranceDic,s=void 0===i?{}:i,c=!1;for(var l in a){var u=s[l]||{},d=u.resourceShoppingInfo,f=void 0===d?{}:d;if((null===f||void 0===f||!f.price)&&(null===f||void 0===f||!f.childPrice)){c=!0;break}}return(0,_r.jsx)(Ba,{headLeftText:" ",children:(0,_r.jsxs)(D.View,{className:"build_ins_pop",children:[(0,_r.jsx)(D.View,{className:"build_ins_loading",children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_vertificate_loading"})}),(0,_r.jsxs)(D.View,{className:"build_ins",children:[(0,_r.jsx)(D.View,{className:"content",children:"\u5373\u5c06\u8fdb\u5165\u643a\u7a0b\u4fdd\u9669\u4ee3\u7406\u5e73\u53f0\u8fdb\u884c\u6295\u4fdd..."}),(0,_r.jsx)(D.View,{className:"desp",children:"\u5e76\u6388\u6743\u51fa\u884c\u65c5\u5ba2\u4e3a\u88ab\u4fdd\u4eba\uff0c\u9700\u4ed4\u7ec6\u9605\u8bfb\u4fdd\u9669\u6761\u6b3e\uff0c\u6295\u4fdd\u4eba\u5728\u9500\u552e\u9875\u9762\u7684\u64cd\u4f5c\u5c06\u88ab\u8bb0\u5f55".concat(c?"\uff08\u8d60\u9001\u4fdd\u9669\u65e0\u9700\u6b64\u6b65\u786e\u8ba4\uff09":"")})]})]})})}function ao(){var e,t=yr.useState((function(e){var t=e.isShowBuyTrainTicketMask,n=e.taroInfo,r=e.passengerObj,a=e.selectIds,o=e.options;return{isShowBuyTrainTicketMask:t,taroInfo:n,passengerObj:r,selectIds:a,options:o}})),n=t.isShowBuyTrainTicketMask,r=t.taroInfo,a=t.passengerObj,o=t.selectIds,i=t.options,s=void 0===i?{}:i,c=r||{},l=c.windowWidth,u=(0,O.useState)(1),d=(0,M.Z)(u,2),f=d[0],p=d[1];(0,O.useEffect)((function(){var e=null;if(!n)return p(1),void clearTimeout(e);if(!(f>=l)){var t=f<10?1:10,r=parseInt(f*Math.random()/t+"")||.8;return e=setTimeout((function(){var e=f+r;p(e>l?l:e)}),1e3),function(){clearTimeout(e)}}}),[f,n]);var m=(0,O.useMemo)((function(){if(!o||!o.length)return[];var e=o.map((function(e){return Zt(e,a)}));return e}),[o]);if(!n)return null;var h=s||{},v=h.ResourceInfo,g=void 0===v?{}:v,y=(h.PassengerInfoList,parseInt(f/l*100+""));return console.log("pre========",y),(0,_r.jsx)(Ba,{title:"",children:(0,_r.jsxs)(D.View,{className:"train_pop_con",children:[(0,_r.jsxs)(D.View,{className:"train_masking",children:[(0,_r.jsx)(D.View,{className:"train_title",children:"\u706b\u8f66\u7968"}),(0,_r.jsx)(D.View,{className:"train_ifo",children:(0,_r.jsx)(D.View,{className:"info",children:"\u8d44\u6e90\u4fe1\u606f"})}),!(null===g||void 0===g||!g.TrainList)&&(null===(e=g.TrainList)||void 0===e?void 0:e.map((function(e,t){return 1===e.BookingType?(0,_r.jsx)(D.View,{className:"train_book_box",children:(0,_r.jsxs)(D.View,{className:"train_book_modify",children:[(0,_r.jsxs)(D.View,{className:"from",children:[(0,_r.jsx)(D.View,{children:e.FromStationName}),(0,_r.jsx)(D.Text,{className:"train_book_time",children:e.StartTime}),(0,_r.jsxs)(D.View,{children:[e.DepartDateString," ",e.DepartDayOfWeek]})]}),(0,_r.jsxs)(D.View,{className:"to",children:[(0,_r.jsx)(D.View,{children:e.ToStationName}),(0,_r.jsx)(D.Text,{className:"train_book_time",children:e.ArriveTime}),(0,_r.jsxs)(D.View,{children:[e.ArriveDateString," ",e.ArriveDayOffWeek]})]}),(0,_r.jsx)(D.View,{className:"mid",children:e.TrainNo})]})},t):null}))),(0,_r.jsx)(D.View,{className:"train_ifo",children:(0,_r.jsx)(D.View,{className:"info",children:"\u4e58\u8f66\u4eba"})}),(0,_r.jsx)(D.View,{className:"train_name",children:m.join("\u3001")})]}),(0,_r.jsxs)(D.View,{className:"train_progress",children:[(0,_r.jsx)(D.Progress,{activeColor:"#00c0ff",backgroundColor:"#9e9e9e",showInfo:!1,percent:y,strokeWidth:32,duration:1500,activeMode:"backwards"}),(0,_r.jsxs)(D.View,{className:"progress_w",children:[y>15?"\u706b\u8f66\u7968\u7d27\u5f20\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\u2026 ":"\u6b63\u5728\u4e3a\u60a8\u62a2\u5ea7\u706b\u8f66\u7968\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f855-10\u79d2\u2026 "," "]})]})]})})}function oo(){var e=yr.useState((function(e){var t=e.isShowResourceErrorMask,n=e.options;return{isShowResourceErrorMask:t,options:n}})),t=e.isShowResourceErrorMask,n=e.options,r=yr.useActions(),a=r.toggleResourceErrorMask,o=r.saveOrderCallBack,i=r.backToLastPage;if(!t)return null;var s=n.ResultCode,c=n.BookResourceInfo,l=(n.ErrorInfo,c||{}),u=l.Train,d=l.TotalPrice;if(!u||!u.length)return null;var f=d||{},p=f.OriginalPrice,m=f.CurrentPrice,h=p||0,v=m||0;return(0,_r.jsx)(Ba,{title:"\u8d44\u6e90\u53d8\u52a8",subBtnText:"\u91cd\u9009\u8d44\u6e90",subCallback:function(){a({status:!1}),i()},mainBtnText:2===s?"\u7ee7\u7eed\u652f\u4ed8":"",mainCallback:function(){o(n),a({status:!1})},children:(0,_r.jsxs)(D.View,{className:"include-train-changed",children:[(0,_r.jsx)(D.View,{className:"res-changed",children:(0,_r.jsxs)(D.View,{className:"res_splite",children:[(0,_r.jsx)(D.View,{className:"res-flex",children:(0,_r.jsx)(D.View,{className:"res-flex-item title",children:"\u706b\u8f66\u7968"})}),u.map((function(e,t){e.Price;var n=e.Status,r=(e.DepartTime,e.DepartStation),a=(e.ArriveTime,e.ArriveStation),o=e.ExtendInfo,i=e.TrainNo,s=e.ErrorMessage,c=e.SeatList;return(0,_r.jsx)(D.View,{className:"res_splite_inner",children:(0,_r.jsxs)(D.View,{className:"res-flex",children:[(0,_r.jsxs)(D.View,{className:"res-flex-item",children:[(0,_r.jsxs)(D.View,{className:"res-inner-tit",children:[i," ",r,"-",a]}),!!o&&(0,_r.jsx)(D.View,{className:"res-inner-tips",children:o}),c&&c.length>0&&c.map((function(e,t){return t%2!==0?null:(0,_r.jsxs)(D.View,{className:"res-inner-tips",children:[e,c[t+1]&&(0,_r.jsx)(D.View,{className:"sit-divider"}),c[t+1]]},t)})),s&&(0,_r.jsx)(D.View,{className:"res-inner-tips",children:s})]}),(0,_r.jsxs)(D.View,{className:"res-right",children:[1===n&&(0,_r.jsx)(D.View,{className:"fc_green",children:"\u9884\u8ba2\u6210\u529f"}),3===n&&(0,_r.jsx)(D.View,{className:"gray",children:"\u9884\u8ba2\u5931\u8d25"}),2===n&&(0,_r.jsx)(D.View,{className:"fc_green",children:"\u62a2\u5ea7\u6210\u529f"})]})]})},t)}))]})}),(0,_r.jsx)(D.View,{className:"res-pay",children:(0,_r.jsx)(D.View,{className:"res_splite",children:(0,_r.jsxs)(D.View,{className:"res-flex",children:[(0,_r.jsx)(D.View,{className:"res-flex-item price-title",children:"\u57fa\u7840\u56e2\u8d39"}),(0,_r.jsxs)(D.View,{className:"res-right",children:[5===s&&(0,_r.jsx)(D.View,{className:"order-price",children:(0,_r.jsxs)(D.View,{className:"order-price-dele",children:["\xa5",h]})}),5!==s&&!!h&&(0,_r.jsxs)(D.View,{className:"order-price",children:[(0,_r.jsxs)(D.Text,{className:"order-price-dele order-price-changed",children:["\xa5",h]})," ","\xa5",v]})]})]})})})]})})}function io(){var e=yr.useState((function(e){var t=e.passengerObj,n=e.isShowPersonListMask,r=e.shoppingId,a=e.options,o=e.taroInfo;return{passengerObj:t,isShowPersonListMask:n,shoppingId:r,options:a,taroInfo:o}})),t=e.passengerObj,n=e.isShowPersonListMask,r=e.shoppingId,a=e.options,o=e.taroInfo,i=yr.useActions(),s=i.ctrl,c=i.togglePersonListMask;if(!n)return null;var l=a.type,u=void 0===l?"":l,d=a.ids,f=void 0===d?[]:d,p="",m=[],h="";if("samecard"===u){p="\u8bc1\u4ef6\u53f7\u91cd\u590d";var v=f.map((function(e){return'"'.concat(Zt(e,t),'"')})),g=v.join("\u548c");m=["".concat(g,"\u8bc1\u4ef6\u53f7\u91cd\u590d\uff0c\u8bf7\u6838\u5bf9\u4fe1\u606f")],h="\u77e5\u9053\u4e86"}return(0,_r.jsx)(Ba,{title:p,handleClose:function(){c({status:!1})},mainBtnText:h,children:(0,_r.jsxs)(D.View,{className:"same_info_list",children:[(0,_r.jsx)(D.View,{className:"same_info_item",children:m.map((function(e,t){return(0,_r.jsx)(D.Text,{className:"same_info_tips_text",children:e},t)}))}),f.map((function(e,n){var a=t[e],i=Zt(e,t,null,!0),c=a||{},l=c.PassengerID,u=void 0===l?0:l,d=c.idInfos,p=void 0===d?[]:d;c.isComplete;return(0,_r.jsxs)(D.View,{children:[(0,_r.jsxs)(D.View,{className:"same_info_item",onClick:function(){s&&s.goToPassengerEdit({shoppingId:r,passengerId:u,chosenInfo:null===a||void 0===a?void 0:a.chosenInfo,taroInfo:o})},children:[(0,_r.jsxs)(D.View,{className:"same_info_item_left",children:[(0,_r.jsx)(D.Text,{className:"same_info_name",children:i}),p&&p.length>0&&p.map((function(e,t){return e.cardName?(0,_r.jsx)(D.Text,{className:"same_info_card",children:"".concat(e.cardName," ").concat(e.IdCardNo)},t):null}))]}),(0,_r.jsx)(D.View,{className:"same_info_item_right",children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_edit"})})]}),n!==f.length-1&&(0,_r.jsx)(D.View,{className:"same_info_line"})]})}))]})})}function so(){var e=yr.useState((function(e){var t=e.isShowMemberCardsMask,n=e.ContactInfo,r=e.contactTemplate;return{isShowMemberCardsMask:t,ContactInfo:n,contactTemplate:r}})),t=e.isShowMemberCardsMask,n=e.ContactInfo,r=e.contactTemplate,a=yr.useActions(),o=a.toggleMemberCardsMask;if(!t)return null;var i=r||{},s=i.idOptions,c=void 0===s?[]:s,l=n||{},u=l.IdCardType,d=void 0===u?0:u,f=c.map((function(e){var t=!1;return+d===+e.customerInfoItemType&&(t=!0),{key:+e.customerInfoItemType,value:e.name,selected:t}}));return(0,_r.jsx)(Ba,{title:"\u8bf7\u9009\u62e9\u8bc1\u4ef6\u7c7b\u578b",handleClose:function(){o({status:!1})},children:(0,_r.jsx)(D.View,{className:"prs_pop_select_list",children:f.map((function(e,t){return(0,_r.jsxs)(D.View,{className:"prs_pop_select",onClick:function(){o({status:!1,currentValue:e.key})},children:[(0,_r.jsx)(D.View,{className:"select_main",children:(0,_r.jsx)(D.View,{className:"item_name",children:e.value})}),!!e.selected&&(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_big_check"})]},t)}))})})}var co=function(){var e=yr.useState((function(e){return e.isShowInsuranceTipMask})),t=yr.useState((function(e){return e.resourceinfo})),n=yr.useState((function(e){return e.orderBasicInfo})),r=yr.useActions(),a=r.toggleInsuranceTipMask,o=r.duplicationCheck,i=r.beforeSelectInsurance,s=r.ctrl;if(!e)return null;var c=t[We.INSURANCE];if(!c)return null;var l=n.AdultCount,u=n.ChildCount,d=(n.InfantCount,n.totalPersonCount,c.insuranceCategoryTokenMap),f=void 0===d?{}:d,p=c.insuranceDic,m=void 0===p?{}:p,h=f["1"]||[],v=h[0]||"",g=m[v]||{},y=g.baseInfo,_=void 0===y?{}:y,b=g.resourceShoppingInfo,I=void 0===b?{}:b,x="",T=I.price,k=I.childPrice,S=Ye([{price:T,count:l},{price:k,count:u}]);x=S&&S>0?"\uffe5".concat(S,"/\u4eba"):"\u8d60\u9001/\u4eba";var C="\u6dfb\u52a0\u4fdd\u9669",w=function(){a(!1),i(!0,v),s&&s.scrollToErrorPosition&&s.scrollToErrorPosition("Insurance")},N="\u6211\u4e0d\u9700\u8981",E=function(){a(!1),o(1)};return(0,_r.jsx)(Ba,{title:"\u60a8\u5c1a\u672a\u6dfb\u52a0\u51fa\u884c\u4fdd\u969c",handleClose:function(){a(!1)},mainBtnText:C,mainCallback:w,subBtnText:N,subCallback:E,bodyDiyStyle:{background:"#f1f9fb"},children:(0,_r.jsxs)(D.View,{className:"add_ins_pop",children:[(0,_r.jsx)(D.View,{className:"ins_con"}),(0,_r.jsxs)(D.View,{className:"ins_tit",children:["\u4e3a\u4f7f\u5bb6\u4eba",(0,_r.jsx)(D.Text,{className:"txt_mint",children:"\u66f4\u5b89\u5fc3"}),"\uff0c\u5efa\u8bae\u8d2d\u4e70"]}),(0,_r.jsx)(D.View,{className:"ins_text",children:_.name}),(0,_r.jsx)(D.View,{className:"ins_text",children:x})]})})},lo=O.memo(co);function uo(){var e=yr.useState((function(e){var t=e.isShowShareRoomMask,n=e.selectIds,r=e.passengerObj,a=e.sharedRoomInfo;return{isShowShareRoomMask:t,selectIds:n,passengerObj:r,sharedRoomInfo:a}})),t=e.isShowShareRoomMask,n=e.selectIds,r=e.passengerObj,a=e.sharedRoomInfo,o=yr.useActions(),i=o.toggleShareRoomMask;if(!t)return null;var s=a||{},c=(s.status,s.passengerId),l=void 0===c?0:c,u=(s.name,s.noShareInfo,[]);return n.forEach((function(e){var t=r[e];1===t.AgeRang&&u.push(t)})),(0,_r.jsx)(Ba,{title:"\u9009\u62e9\u62fc\u623f\u4eba\u5458",handleClose:function(){i({status:!1})},children:(0,_r.jsx)(D.View,{className:"prs_pop_select_list",children:u.map((function(e,t){var n=Zt(e.PassengerID,r);return(0,_r.jsxs)(D.View,{className:"prs_pop_select",onClick:function(){i({status:!1,passengerId:e.PassengerID,name:n})},children:[(0,_r.jsx)(D.View,{className:"select_main",children:(0,_r.jsx)(D.View,{className:"item_name",children:n})}),e.PassengerID===l&&(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_big_check"})]},t)}))})})}function fo(){var e=yr.useState((function(e){var t=e.isShowIMEntryInfo,n=e.IMEntryInfo,r=e.productBasicInfo,a=e.VendorInfo,o=e.IMServiceInfo;return{isShowIMEntryInfo:t,IMEntryInfo:n,productBasicInfo:r,VendorInfo:a,IMServiceInfo:o}})),t=e.isShowIMEntryInfo,n=e.IMEntryInfo,r=e.productBasicInfo,a=(e.VendorInfo,e.IMServiceInfo),o=yr.useActions(),i=o.toggleIMEntryInfo,s=o.getIMParams,c=o.ctrl;if(!t||!n)return null;var l=r||{},u=l.ProductId,d=void 0===u?0:u,f=l.ProductAlias,m=void 0===f?"":f,h=l.DepartureId,v=void 0===h?0:h;return(0,_r.jsx)(p.CustomerService,{isShow:t,onClose:function(){return i(!1)},imEntryInfo:{imInfo:n,serviceInfo:a},cacheKey:JSON.stringify({productId:d,alias:m,departCityId:v}),zIndex:990,onJumpIM:function(){c.openIM(s())}})}function po(){var e=yr.useState((function(e){var t=e.isShowRetailInvoiceMask;return{isShowRetailInvoiceMask:t}})),t=e.isShowRetailInvoiceMask,n=yr.useActions(),r=n.toggleRetailInvoiceMask;if(!t)return null;var a=["\u6b64\u4e3a\u96f6\u552e\u4ea7\u54c1\uff0c\u53d1\u7968\u8bf7\u8054\u7cfb\u96f6\u552e\u5546\u5f00\u5177\uff0c\u914d\u9001\u8d39\u548c\u914d\u9001\u65b9\u5f0f\uff0c\u4ee5\u96f6\u552e\u5546\u786e\u8ba4\u4e3a\u51c6","\u5982\u96f6\u552e\u5546\u62d2\u7edd\u5361\u7968\u6216\u9700\u8981\u6536\u53d6\u7a0e\u70b9\uff0c\u5747\u4e3a\u4e0d\u5408\u7406\u884c\u4e3a\uff0c\u53ef\u8054\u7cfb\u643a\u7a0b\u53cd\u9988"];return(0,_r.jsx)(Ba,{title:"\u96f6\u552e\u5546\u53d1\u7968\u63d0\u793a",handleClose:function(){r(!1)},mainBtnText:"\u786e\u5b9a",children:(0,_r.jsx)(D.View,{className:"limit_view",children:a.map((function(e,t){return(0,_r.jsx)(D.View,{style:{display:"flex",alignItems:"flex-start"},children:(0,_r.jsxs)(D.Text,{className:"common_text",children:[t+1,". ",e]})},t)}))})})}function mo(){var e=yr.useState((function(e){var t=e.isShowVendorMask,n=e.VendorInfo;return{isShowVendorMask:t,VendorInfo:n}})),t=e.isShowVendorMask,n=e.VendorInfo,r=yr.useActions(),a=r.toggleVendorMask;if(!t)return null;var o=n.SalerInfo,i=void 0===o?{}:o,s=i.ContractPhoneInfo,c=(i.ExtNumber,i.WorkTimeDescription);return(0,_r.jsx)(Ba,{title:"",handleClose:function(){a(!1)},hideTitle:!0,subBtnText:"\u53d6\u6d88",children:(0,_r.jsxs)(D.View,{className:"jmp_sale_explain",children:[(0,_r.jsxs)(D.View,{className:"sale_title",children:["\u7531",i.FullName,"\u76f4\u552e"]}),(0,_r.jsxs)(D.View,{className:"content",children:[(0,_r.jsx)(D.View,{className:"common_text",children:"\u672c\u4ea7\u54c1\u7531\u96f6\u552e\u5546\u63d0\u4f9b\uff0c\u6709\u5173\u8d44\u6e90\u786e\u8ba4\u3001\u5408\u540c\u7b7e\u7f72\u3001\u884c\u7a0b\u5b89\u6392\u7b49\u4e8b\u5b9c\uff0c\u53ef\u54a8\u8be2\u5ba2\u670d\u3002"}),!!c&&(0,_r.jsxs)(D.View,{className:"common_text",children:["\u670d\u52a1\u65f6\u95f4: ",c]}),!!s&&(0,_r.jsxs)(D.View,{className:"common_text",children:["\u54a8\u8be2\u7535\u8bdd\uff1a",s]}),(0,_r.jsx)(D.View,{className:"common_text",children:"\u60a8\u63d0\u4ea4\u8ba2\u5355\u540e\uff0c\u5546\u5bb6\u4f1a\u4e0e\u60a8\u8054\u7cfb\u786e\u8ba4\u3002"})]})]})})}function ho(){var e=yr.useState((function(e){var t=e.isShowDeliveryTypeMask,n=e.currentValue,r=e.OrderDelivery,a=e.formatDlyData;return{isShowDeliveryTypeMask:t,currentValue:n,OrderDelivery:r,formatDlyData:a}})),t=e.isShowDeliveryTypeMask,n=(e.currentValue,e.OrderDelivery),r=e.formatDlyData;if(!t)return null;var a=yr.useActions(),o=a.toggleDeliveryTypeMask,i=r||{},s=i.scrollUiData,c=void 0===s?[]:s,l=0;return n&&n.IsUseIntegral&&(l=1),(0,_r.jsx)(Ba,{title:"\u914d\u9001\u65b9\u5f0f",handleClose:function(){return o({status:!1})},headLeftCallback:function(){return o({status:!1})},children:(0,_r.jsx)(D.View,{className:"type_info_con",children:c.map((function(e,t){return(0,_r.jsxs)(D.View,{className:"type_info_item",children:[(0,_r.jsx)(D.View,{className:"type_info_item_name",children:(0,_r.jsx)(D.View,{className:"name",children:e.name})}),(0,_r.jsx)(D.View,{className:"type_info_item_select",children:e.list.map((function(t,r){return(0,_r.jsxs)(D.View,{className:"type_info_item_select_item",onClick:function(){console.log(e.type),o({status:!1,currentValue:e.type,index:r})},children:[(0,_r.jsx)(D.Text,{children:t.remark}),(0,_r.jsx)(D.View,{className:"type_info_item_Radio ".concat(n.DeliveryType===e.type&&r===l?"active":""),children:(0,_r.jsx)(D.Text,{className:"type_check prs_iconfont iconfont_btn_check"})})]},r)}))})]},e.type)}))})})}function vo(){var e=yr.useState((function(e){var t=e.isShowDeliveryAddressMask,n=e.formatDlyData,r=e.OrderDelivery;return{isShowDeliveryAddressMask:t,formatDlyData:n,OrderDelivery:r}})),t=e.isShowDeliveryAddressMask,n=e.formatDlyData,r=e.OrderDelivery,a=yr.useActions(),o=a.toggleDeliveryAddressMask;if(!t)return null;var i=n||{},s=i.selfPickupAddress,c=void 0===s?[]:s,l=r&&r.AddressInfo||{};return(0,_r.jsx)(Ba,{title:"\u914d\u9001\u5730\u5740",handleClose:function(){o({status:!1})},children:(0,_r.jsx)(_r.Fragment,{children:(0,_r.jsx)(D.View,{className:"prs_pop_select_list",children:c.map((function(e,t){return(0,_r.jsxs)(D.View,{className:"prs_pop_select",onClick:function(){o({status:!1,currentValue:e})},children:[(0,_r.jsx)(D.View,{className:"select_main",children:(0,_r.jsx)(D.View,{className:"item_name",children:e})}),e===l.Address&&(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_big_check"})]})}))})})})}function go(){var e=yr.useState((function(e){var t=e.isShowDeliveryInfoMask,n=e.formatDlyData;return{isShowDeliveryInfoMask:t,formatDlyData:n}})),t=e.isShowDeliveryInfoMask,n=e.formatDlyData;if(!t)return null;var r=yr.useActions(),a=r.toggleDeliveryInfoMask,o=n||{},i=o.materialsInfo,s=void 0===i?[]:i;return(0,_r.jsx)(Ba,{title:"\u914d\u9001\u6750\u6599\u6e05\u5355",handleClose:function(){return a(!1)},headLeftCallback:function(){return a(!1)},children:(0,_r.jsxs)(D.View,{children:[(0,_r.jsxs)(D.View,{className:"delivery_info_tip",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_strong_tips"}),(0,_r.jsx)(D.Text,{className:"delivery_info_tip_text",children:"\u5185\u5bb9\u4ec5\u4f9b\u53c2\u8003"})]}),s.map((function(e){return(0,_r.jsx)(D.View,{className:"delivery_info_item",children:e},e)}))]})})}function yo(){var e=(0,O.useRef)(null),t=yr.useState((function(e){return e.pageEmotionalObj}))||{},n=(0,O.useState)(!1),r=(0,M.Z)(n,2),a=r[0],o=r[1],i=t.bottomEmotional;return(0,O.useEffect)((function(){var t=e&&e.current,n=null,r=null;return t&&(n=setTimeout((function(){t.className+=" prs_emotion_show"}),2e3),r=setTimeout((function(){t.className="prs_bottom_emotion"}),7e3)),function(){n&&clearTimeout(n),r&&clearTimeout(r)}}),[i]),!i||a?null:(0,_r.jsxs)(D.View,{ref:e,className:"prs_bottom_emotion",children:[(0,_r.jsx)(D.View,{className:"prs_emotion_icon"}),(0,_r.jsx)(D.View,{className:"prs_emotion_text",children:(0,_r.jsx)(D.Text,{className:"text_s",children:i.content})}),(0,_r.jsx)(D.View,{className:"prs_emotion_btn_close",onClick:function(){o(!0)},children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_close"})})]})}var _o=(0,O.memo)(Io),bo=_o;function Io(){var e=yr.useState((function(e){var t=e.isShowFareRemarkMask,n=e.FareRemark;return{isShowFareRemarkMask:t,FareRemark:n}})),t=e.isShowFareRemarkMask,n=e.FareRemark;if(!t)return null;var r=yr.useActions(),a=r.toggleFareRemarkMask;return(0,_r.jsx)(p.FlightFareRemarkMask,{fareMaskInfo:n,handleHiddenMask:function(){a(!1)}})}var xo=(0,O.memo)(To);function To(){var e=yr.useState((function(e){var t=e.isShowTrain12306ContactMask,n=e.options;return{isShowTrain12306ContactMask:t,options:n}})),t=e.isShowTrain12306ContactMask,n=e.options,r=yr.useActions(),a=r.toggleTrain12306ContactMask;return t?(0,_r.jsx)(Ba,{title:"\u706b\u8f66\u7968\u63d0\u793a",handleClose:function(){a({status:!1})},mainBtnText:"\u6211\u77e5\u9053\u4e86",btnLogoUrl:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/order/ctriplogo.png",children:(0,_r.jsxs)(D.View,{className:"contact-12306",children:[(0,_r.jsx)(D.View,{className:"contact-12306-title",children:null===n||void 0===n?void 0:n.message}),(0,_r.jsx)(D.View,{className:"contact-12306-tip",children:"\u5df2\u4e3a\u60a8\u6682\u5b58\u8ba2\u5355\uff0c\u8bf7\u5c3d\u5feb\u524d\u5f80\u3010\u643a\u7a0b\u65c5\u884cAPP\u3011\u7ee7\u7eed\u64cd\u4f5c"}),(0,_r.jsx)(D.View,{className:"contact-12306-img-box",children:(0,_r.jsx)(D.Image,{style:{width:"100%"},mode:"widthFix",src:"https://pic.c-ctrip.com/VacationH5Pic/tourpic/group_travel/order/guidetoapp.png"})})]})}):null}function ko(){var e=yr.useState((function(e){var t=e.popLastNameIndex,n=e.popFirstNameIndex;return{popLastNameIndex:t,popFirstNameIndex:n}})),t=e.popLastNameIndex,n=e.popFirstNameIndex;return t>-1?(0,_r.jsx)(So,{}):n>-1?(0,_r.jsx)(Co,{}):null}function So(){var e=(0,O.useState)({}),t=(0,M.Z)(e,2),n=t[0],r=t[1],a=yr.useState((function(e){var t=e.nameList,n=e.selectedCnName;return{nameList:t,selectedCnName:n}})),o=a.nameList,s=a.selectedCnName,c=yr.useActions(),l=c.handleClosePinYinPop,u=c.handleSelectLastNamePY,d=s||"";if(!d)return null;var p=o[d]||{},m=p.lastNameList,h=p.isNeedSplit,v=Object.keys(m),g=(0,O.useCallback)((function(){var e=v.map((function(e,t){var r=n[t]||0;return m[e]&&m[e][r]}));console.log("\ud83e\udd2cenLastName",e),u(e.join(""))}),[n,h]);return(0,_r.jsx)(Ra,{diyText:(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsx)(D.View,{className:"title_text",children:"\u9009\u62e9\u62fc\u97f3\u59d3"}),(0,_r.jsx)(D.View,{className:"tips_text",children:"\u59d3\uff1a\u4e0e\u8bc1\u4ef6\u6240\u793a\u82f1\u6587\u59d3\u4e00\u81f4"}),(0,_r.jsx)(D.View,{className:"conent_box_single",children:v.map((function(e,t){var a=m[e];if(a.length>1)return(0,_r.jsx)(D.View,{children:a.map((function(a,o){var s=void 0==n[t]&&0==o||n[t]==o;return(0,_r.jsxs)(D.View,{className:"item_single ".concat(s?"selected":""),onClick:function(){return r((0,i.Z)((0,i.Z)({},n),{},(0,f.Z)({},t,o)))},children:[(0,_r.jsx)(D.Text,{children:"".concat(e).concat(a)}),(0,_r.jsx)(D.View,{className:"icon_view",children:(0,_r.jsx)(D.Text,{className:"icon_checkbox_on",children:"\ueaa9"})})]})}))})}))})]}),mainBtnText:"\u786e\u5b9a",mainCallback:function(){return g()},subBtnText:"\u624b\u52a8\u8f93\u5165",subCallback:function(){return l()}})}function Co(){var e=(0,O.useState)({}),t=(0,M.Z)(e,2),n=t[0],r=t[1],a=yr.useState((function(e){var t=e.nameList,n=e.selectedCnName;return{nameList:t,selectedCnName:n}})),o=a.nameList,s=a.selectedCnName,c=yr.useActions(),l=c.handleClosePinYinPop,u=c.handleSelectFirstNamePY,d=s||"";if(!d)return null;var p=o[d]||{},m=p.firstNameList,h=p.isNeedSplit,v=Object.keys(m),g=(0,O.useCallback)((function(){var e=v.map((function(e,t){var r=n[t]||0;return m[e]&&m[e][r]}));console.log("enFirstName",e,v,Object.keys(m)),u(e.join(""))}),[n,h]);return(0,_r.jsx)(Ra,{diyText:(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsx)(D.View,{className:"title_text",children:"\u9009\u62e9\u62fc\u97f3\u540d"}),(0,_r.jsx)(D.View,{className:"tips_text",children:"\u540d\uff1a\u4e0e\u8bc1\u4ef6\u6240\u793a\u82f1\u6587\u540d\u4e00\u81f4"}),(0,_r.jsx)(D.View,{className:"conent_box_single",children:v.map((function(e,t){var a=m[e];if(a.length>1)return(0,_r.jsx)(D.View,{children:a.map((function(a,o){var s=void 0==n[t]&&0==o||n[t]==o;return(0,_r.jsxs)(D.View,{className:"item_single ".concat(s?"selected":""),onClick:function(){return r((0,i.Z)((0,i.Z)({},n),{},(0,f.Z)({},t,o)))},children:[(0,_r.jsxs)(D.Text,{children:[e,a]}),(0,_r.jsx)(D.View,{className:"icon_view",children:(0,_r.jsx)(D.Text,{className:"icon_checkbox_on",children:"\ueaa9"})})]},o)}))},t)}))})]}),mainBtnText:"\u786e\u5b9a",mainCallback:function(){return g()},subBtnText:"\u624b\u52a8\u8f93\u5165",subCallback:function(){return l()}})}function wo(){var e=yr.useState((function(e){var t=e.isShowHotelSelectContactMask,n=e.selectIds,r=e.passengerObj,a=e.ContactInfo;return{isShowHotelSelectContactMask:t,selectIds:n,passengerObj:r,ContactInfo:a}})),t=e.isShowHotelSelectContactMask,n=e.selectIds,r=e.passengerObj,a=e.ContactInfo,o=yr.useActions(),i=o.toggleHotelSelectContactMask,s=o.handleToSplitCnName;return t?(0,_r.jsx)(Ba,{title:"\u9009\u62e9\u8054\u7cfb\u4eba",handleClose:function(){i(!1)},children:(0,_r.jsxs)(D.View,{className:"hotel_contact_box",children:[(0,_r.jsx)(D.View,{className:"hotel_contact_box_title",children:(0,_r.jsx)(D.Text,{className:"Text32 color_text_1 TextBold",children:"\u5df2\u9009\u51fa\u884c\u4eba"})}),n&&n.map((function(e){var t=r[e]||{},n=t||{},o=n.idInfos,c=void 0===o?[]:o,l=n.defaultPhoneInfo,u=Zt(e,r,null,!0),d=No(a,t);return(0,_r.jsxs)(D.View,{className:"itemView",children:[(0,_r.jsxs)(D.View,{className:"itemLeftView",onClick:function(){s(e),i(!1,{id:e})},children:[(0,_r.jsx)(D.Text,{className:"Text32 color_text_1",children:u}),!!c&&!!c.length&&c.map((function(e){return(0,_r.jsx)(D.View,{className:"cardView",children:(0,_r.jsx)(D.Text,{className:"Text28 color_text_3",children:"".concat(e.cardName,"\uff1a").concat(e.IdCardNo)})},e.IdCardType)})),!(null===l||void 0===l||!l.mobilePhone)&&(0,_r.jsx)(D.View,{className:"cardView",children:(0,_r.jsx)(D.Text,{className:"Text28 color_text_3",children:"\u624b\u673a\u53f7\uff1a".concat(l.mobilePhone)})})]}),!!d&&(0,_r.jsx)(D.View,{className:"itemRightView",children:(0,_r.jsx)(D.Text,{className:"selectedIconText",children:"\uf1c8"})})]},e)}))]})}):null}function No(e,t){var n=t.CNName,r=t.ENFirstName,a=t.ENLastName,o=(t.ENMiddleName,a&&r?"".concat(a," ").concat(r):""),i=n,s=e||{},c=s.Name,l=s.SurenameCN,u=s.GivenNameCN,d=s.Surname,f=s.GivenName,p=l+u||c,m=d?"".concat(d," ").concat(f):c;return p&&i===p||m&&o===m}function Eo(){var e=yr.useState((function(e){var t=e.isSubmit,n=e.tagInfo,r=e.train12306LoginData;return{isSubmit:t,tagInfo:n,train12306LoginData:r}})),t=e.isSubmit,n=e.tagInfo,r=e.train12306LoginData,a=n||{},o=a.isTrain,i=void 0!==o&&o,s=yr.useActions(),c=s.goTo12306Login;if(!i)return null;var l=!oe.isEmpty(r);return(0,_r.jsxs)(D.View,{id:"TrainLogin",className:"train_login ".concat(l?"green":"orange"),children:[(0,_r.jsx)(D.View,{className:"train_login_user",children:l?(0,_r.jsxs)(D.View,{className:"train_login_islogin_txt ",children:[(0,_r.jsx)(D.Text,{style:{backgroundImage:l?"linear-gradient(-180deg, rgb(92, 234, 92) 0%, rgb(0, 184, 122) 100%)":"linear-gradient(-180deg, rgb(255, 210, 45) 0%, rgb(247, 107, 28) 100%)"},className:"train_login_user_icon",children:"\ue431"}),(0,_r.jsx)(D.Text,{className:"train_login_islogin_label",children:"12306\u8d26\u53f7\uff1a"}),(0,_r.jsx)(D.Text,{className:"train_login_islogin_name",children:Ke(r.userName)})]}):(0,_r.jsxs)(D.View,{children:[(0,_r.jsxs)(D.View,{className:"flex_vertical_center",children:[(0,_r.jsx)(D.Text,{style:{backgroundImage:l?"linear-gradient(-180deg, rgb(92, 234, 92) 0%, rgb(0, 184, 122) 100%)":"linear-gradient(-180deg, rgb(255, 210, 45) 0%, rgb(247, 107, 28) 100%)"},className:"train_login_user_icon",children:"\ue431"}),(0,_r.jsx)(D.Text,{className:"train_login_user_txt",children:"\u8d2d\u4e70\u706b\u8f66\u7968\u9700\u767b\u5f5512306\u8d26\u53f7"})]}),!!t&&(0,_r.jsxs)(D.View,{className:"train_login_danger",children:[(0,_r.jsx)(D.Text,{className:"train_login_danger_icon prs_iconfont iconfont_strong_warning"}),(0,_r.jsx)(D.Text,{className:"train_login_danger_txt",children:"\u884c\u7a0b\u5305\u542b\u706b\u8f66\u7968\uff0c\u767b\u5f55\u540e\u65b9\u53ef\u4e0b\u5355"})]})]})}),(0,_r.jsx)(D.View,{onClick:function(){return c()},className:"train_login_btn flex_center ".concat(l?"train_login_btn_noPR":"train_login_btn_border"),children:(0,_r.jsx)(D.Text,{className:"train_login_btn_txt",children:l?"\u5207\u6362\u5e10\u53f7":"\u7acb\u5373\u767b\u5f55"})})]})}function Po(){var e,t=yr.useState((function(e){var t=e.isShowPriceDetailMask,n=e.priceDetail,r=e.productBasicInfo,a=e.resourceinfo,o=e.OrderDelivery,i=e.formatDlyData,s=e.tagInfo,c=e.selectIds,l=e.passengerObj,u=e.pageData;return{isShowPriceDetailMask:t,priceDetail:n,productBasicInfo:r,resourceinfo:a,OrderDelivery:o,formatDlyData:i,tagInfo:s,selectIds:c,passengerObj:l,pageData:u}})),n=t.isShowPriceDetailMask,r=t.priceDetail,a=t.productBasicInfo,o=t.resourceinfo,i=t.OrderDelivery,s=t.formatDlyData,c=t.tagInfo,l=t.selectIds,u=void 0===l?[]:l,d=t.passengerObj,f=(t.pageData,yr.useActions()),m=f.togglePriceDetailMask;if(oe.isEmpty(r))return null;var h=c||{},v=h.isTrain,g=void 0!==v&&v,y=h.isContainFlight,_=void 0!==y&&y,b=!1;if(g&&u&&u.length){var I=u.map((function(e){return d[e]}));b=(null===I||void 0===I?void 0:I.some((function(e){return"below_120"===e.Height&&2!==e.AgeRang})))||!1}var x=cn(i,s),T=a.ProductAlias,k=a.ProductId,S=a.DepartureId;return(0,_r.jsx)(p.PriceDetail,{pageName:"order",isShow:n,onClose:function(){m(!1)},priceDetail:r,cacheKey:JSON.stringify({productId:k,alias:T,departCityId:S}),basePriceProps:{isContainFlight:_,isShowFreeTicket:b},insuranceProps:{hasAgeRules:null===o||void 0===o||null===(e=o[We.INSURANCE])||void 0===e?void 0:e.hasAgeRules},freightProps:{freightPrice:x},bottomDistance:120,zIndex:98})}function jo(){var e,t=yr.useState((function(e){var t=e.isShowBookReadMask,n=e.userNotice,r=e.productBasicInfo,a=e.shoppingId,o=e.taroInfo,i=e.options;return{isShowBookReadMask:t,userNotice:n,productBasicInfo:r,shoppingId:a,taroInfo:o,options:i}})),n=t.isShowBookReadMask,r=t.userNotice,a=t.productBasicInfo,o=t.shoppingId,i=t.taroInfo,s=t.options,c=yr.useActions(),l=c.toggleBookReadMask,u=c.checkShowImprotantTip,d=c.clickOldManTip,f=c.ctrl,p=c.checkAllClauses,m=c.getReplaceContractObj;if(!n)return null;var h=r||{},v=(h.isShow,h.isSelect),g=void 0!==v&&v,y=h.isShowAuthorize,_=void 0!==y&&y,b=h.isSelectAuthorize,I=void 0!==b&&b,x=h.isShowOldMan,T=void 0!==x&&x,k=h.isShowUnderAge,S=void 0!==k&&k,C=h.tipMessages,w=void 0===C?[]:C,N=s||{},E=N.actionFrom,P=void 0===E?"":E;return(0,_r.jsx)(Ba,{title:"\u8bf7\u9605\u8bfb\u5e76\u540c\u610f\u4ee5\u4e0b\u5185\u5bb9",isShowHeaderBorderBottom:!0,handleClose:function(){l({status:!1})},mainBtnText:"\u540c\u610f\u5e76\u9884\u8ba2",mainCallback:function(){p(!0),l({status:!1}),u(1)},mainBtnStyle:Rr("mainBtnStyle"),subBtnText:"\u4e0d\u540c\u610f\u534f\u8bae",subCallback:function(){p(!1),l({status:!1})},subBtnStyle:Rr("subBtnStyle"),subTextStyle:Rr("subTextStyle"),children:(0,_r.jsxs)(D.View,{className:Rr("#333","text24","pt34","pl32","pr32","pb97"),children:[(0,_r.jsxs)(D.View,{className:Rr("flex_row","mt12"),children:[(0,_r.jsx)(D.View,{style:{marginTop:"2Px"},className:g?"need_checkboxed":"need_checkbox",onClick:function(){d(1)},children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_btn_check check"})}),(0,_r.jsxs)(D.View,{children:[(0,_r.jsx)(D.Text,{className:Rr("#0086f6"),onClick:function(){var e=m()||{};f&&f.goToContract({isShowOldMan:T,isShowUnderAge:S,isShowAuthorize:_,tabIndex:0,shoppingId:o,productBasicInfo:a,taroInfo:i,actionFrom:P,replaceObj:e})},children:null===(e=w[0])||void 0===e?void 0:e.name}),w.length>1&&w.map((function(e,t){return 0===t?null:(0,_r.jsxs)(O.Fragment,{children:[1===t?"\u4ee5\u53ca":"",(0,_r.jsx)(D.Text,{className:Rr("#0086f6"),onClick:function(){var e=m()||{};f&&f.goToContract({isShowOldMan:T,isShowUnderAge:S,isShowAuthorize:_,tabIndex:t,shoppingId:o,productBasicInfo:a,taroInfo:i,actionFrom:P,replaceObj:e})},children:e.name}),t<w.length-1?"\uff0c":""]},t)}))]})]}),!!_&&(0,_r.jsxs)(D.View,{className:Rr("flex_row","mt12"),children:[(0,_r.jsx)(D.View,{style:{marginTop:"2Px"},className:I?"need_checkboxed":"need_checkbox",onClick:function(){d(2)},children:(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_btn_check check"})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(D.Text,{className:Rr("#0086f6"),onClick:function(){var e=m()||{};f&&f.goToContract({isShowOldMan:T,isShowUnderAge:S,isShowAuthorize:_,tabIndex:w.length,shoppingId:o,productBasicInfo:a,taroInfo:i,actionFrom:P,replaceObj:e})},children:"\u4e2a\u4eba\u4fe1\u606f\u51fa\u5883\u6388\u6743\u58f0\u660e"})})]})]})})}function Oo(){var e=yr.useState((function(e){var t=e.isShowTrainSelectPersonMask,n=e.selectIds,r=e.passengerObj,a=e.TrainPassengerMapList,o=e.selectedPassenger,i=e.orderBasicInfo;return{isShowTrainSelectPersonMask:t,selectIds:n,passengerObj:r,TrainPassengerMapList:a,selectedPassenger:o,orderBasicInfo:i}})),t=e.isShowTrainSelectPersonMask,n=e.selectIds,r=e.passengerObj,a=e.TrainPassengerMapList,o=e.selectedPassenger,i=e.orderBasicInfo,s=yr.useActions(),c=s.orderTraceDevLog,l=s.toggleTrainSelectPersonMask;if(!t)return null;var u=o||{},d=u.PassengerID,f=void 0===d?0:d,p=i.ReturnDate,m=[];n.map((function(e){var t=r[e],n=0,o=t.Birthday||"";if(o&&(n=Fe(o,p)),"above_150"===t.Height&&n>=16){var i=a&&a.filter((function(e){return+e.AdultPassengerToken===t.PassengerID}))||[];m.push({name:Zt(e,r),related:i.length,passengerId:+t.PassengerID})}}));var h="",v=a&&a.filter((function(e){return+e.ChildPassengerToken===f}))[0]||{};return h=v&&v.AdultPassengerToken,console.log("TrainHeightPop render===",h),(0,_r.jsxs)(Ba,{title:"\u8bf7\u9009\u62e9\u5173\u8054\u6210\u4eba",handleClose:function(){l({status:!1})},children:[(0,_r.jsx)(D.View,{className:"prs_pop_top_tip",style:{background:"#FFF8F2"},children:(0,_r.jsxs)(D.View,{className:"tip_text",children:[(0,_r.jsx)(D.Text,{className:"prs_iconfont iconfont_strong_tips iconfont_i"}),"\u4ec5\u53ef\u5173\u805416\u5468\u5c81\u4ee5\u4e0a\u7684\u6210\u4eba\uff0c1\u4f4d\u6210\u4eba\u6700\u591a\u53ef\u5173\u80541\u4f4d\u514d\u8d39\u4e58\u8f66\u513f\u7ae5"]})}),(0,_r.jsxs)(D.View,{className:"prs_pop_select_list",children:[!m.length&&(0,_r.jsxs)(D.View,{className:Rr("flex_align_center","flex_column","pt24","pb64"),children:[(0,_r.jsx)(D.Image,{src:"https://pic.c-ctrip.com/platform/h5/component/empty-state/empty-result.png",mode:"widthFix",style:{width:133}}),(0,_r.jsx)(D.Text,{className:Rr("text30","textBold","mt16"),children:"\u6ca1\u6709\u53ef\u5173\u8054\u7684\u51fa\u884c\u4eba"})]}),m.map((function(e,t){var n=e.related>=1;return(0,_r.jsx)(D.View,{className:"prs_pop_select ".concat(n?" not_optional":""),style:{display:"flex",alignItems:"center"},onClick:function(){n||(c("o_vac_order_select_trainperson",{relatedid:e.passengerId}),l({status:!1,currentValue:e.passengerId}))},children:n?(0,_r.jsx)(D.View,{className:"select_main",children:(0,_r.jsxs)(D.View,{className:"item_name",style:{color:"#ccc"},children:[(0,_r.jsxs)(D.Text,{children:[e.name," "]}),(0,_r.jsxs)(D.Text,{children:[" ","\u5df2\u6709\u5173\u8054\u513f\u7ae5"]})]})}):(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsx)(D.View,{className:"select_main",children:(0,_r.jsx)(D.View,{className:"item_name",children:e.name})}),e.passengerId===+h&&(0,_r.jsx)(D.Text,{style:{position:"absolute",right:16,color:"#0086f6",fontSize:22},className:"crn_iconfont",children:"\uf1c8"})]})})}))]})]})}var Do=O.memo(Ro);function Ro(){var e=yr.useState((function(e){var t=e.isShowTrainHeightMask,n=e.shoppingId;return{isShowTrainHeightMask:t,shoppingId:n}})),t=e.isShowTrainHeightMask,n=e.shoppingId,r=yr.useActions(),a=r.toggleTrainHeightMask;return(0,_r.jsx)(p.TrainChildNotice,{isShow:t,shoppingId:n,onClose:function(){a(!1)},zIndex:999})}var Ao=(0,O.memo)(Mo);function Mo(){var e=yr.useState((function(e){var t=e.isShowSelectDate,n=e.firstScreenStatus,r=e.isQuickBooking;return{isShowSelectDate:t,firstScreenStatus:n,isQuickBooking:r}})),t=e.isShowSelectDate,n=e.firstScreenStatus,r=e.isQuickBooking,a=yr.useActions(),o=a.toggleSelectDate,i=a.handleCreateShopping,s=a.ctx;return!r||n<2?null:(0,_r.jsx)(p.SelectDate,{logger:!0,pageName:"order",isShow:t,onError:function(){},onRef:function(e){s.selectDateRef&&(s.selectDateRef.current=e)},onSelect:function(e){var t=e.result,n=e.payload;i("selectData",{result:t,payload:n})},onClose:function(){o(!1)},zIndex:2e3})}var Vo,Lo,Bo=(0,O.memo)(Uo);function Uo(){var e=yr.useState((function(e){var t=e.isShowSelectPassenger,n=e.productBasicInfo,r=e.firstScreenStatus,a=e.isQuickBooking;return{isShowSelectPassenger:t,productBasicInfo:n,firstScreenStatus:r,isQuickBooking:a}})),t=e.isShowSelectPassenger,n=e.productBasicInfo,r=e.firstScreenStatus,a=e.isQuickBooking,o=yr.useActions(),i=o.toggleSelectPassenger,s=o.handleCreateShopping,c=o.handleGoPrivateIM,l=o.beforeReturnPage;return!a||oe.isEmpty(n)||r<2?null:(0,_r.jsx)(p.SelectPassenger,{pageName:"order",isShow:t,isShowPrivateIM:!1,onClickIM:c,onOpen:function(){i(!0,!0)},onClose:function(){return i(!1)},onSubmit:function(e){var t=e.result,n=e.payload;s("selectPassenger",{result:t,payload:n})},cacheKey:JSON.stringify({productId:n.ProductId,alias:n.ProductAlias,departCityId:n.DepartureId}),onBack:function(){l()},zIndex:2e3})}function Zo(){var e=yr.useState((function(e){var t=e.isShowCreateShoppingErrorMask,n=e.productBasicInfo;return{isShowCreateShoppingErrorMask:t,productBasicInfo:n}})),t=e.isShowCreateShoppingErrorMask,n=e.productBasicInfo,r=yr.useActions(),a=r.toggleCreateShoppingErrorMask,o=r.toggleSelectPassenger,s=r.toggleSelectDate,c=r.ctx;if((0,O.useEffect)((function(){if(t&&!oe.isEmpty(n)&&c.selectDateRef){var e=n.ProductAlias,r=n.ProductId,a=n.DepartureId;c.selectDateRef.current&&c.selectDateRef.current.initCalendar({productId:r,alias:e,departCityId:a})}}),[t,n,c]),!t)return null;var l={btnType:"col",mainBtnText:"\u66f4\u6362\u65e5\u671f",mainCallback:function(){console.log("mainCallback"),s(!0)},subBtnText:"\u66f4\u6362\u4eba\u6570",subCallback:function(){o(!0),console.log("subCallback")},subBtnText2:"\u653e\u5f03\u66f4\u6539",subCallback2:function(){console.log("subCallback2"),a(!1)},title:"\u60a8\u67e5\u8be2\u7684\u884c\u7a0b\u6682\u4e0d\u53ef\u8ba2",subTitle:"\u8bf7\u66f4\u6362\u65e5\u671f\u6216\u4eba\u6570\u540e\u518d\u8bd5"};return(0,_r.jsx)(Ra,(0,i.Z)({},l))}function Fo(){var e=yr.useState((function(e){var t=e.isShowRoomIntroductionMask;return{isShowRoomIntroductionMask:t}})),t=e.isShowRoomIntroductionMask,n=yr.useActions(),r=n.toggleRoomIntroductionMask;n.ctrl;if(!t)return null;var a=["\u672c\u4ea7\u54c1\u4ef7\u683c\u662f\u6309\u201c\u53cc\u4eba\u5171\u4f4f\u4e00\u95f4\u623f\u201d\u6838\u7b97\u7684\u5355\u4eba\u4ef7\u683c\u3002","\u5f53\u51fa\u884c\u4eba\u6570\u4e3a\u5947\u6570\u65f6\u4e14\u5e73\u53f0\u652f\u6301\u62fc\u623f\u65f6\uff0c\u53ef\u9009\u62e9\u62fc\u623f\uff0c\u6b64\u65f6\u9700\u6709\u4e00\u4f4d\u51fa\u884c\u4eba\u4e0e\u5176\u4ed6\u56e2\u53cb\u62fc\u623f\u3002","\u5f53\u51fa\u884c\u4eba\u6570\u4e3a\u5947\u6570\u6216\u6709\u6e38\u5ba2\u9700\u8981\u5355\u72ec\u4e00\u95f4\u623f\u65f6\uff0c\u53ef\u9009\u62e9\u589e\u52a0\u623f\u95f4\u6570\uff0c\u6b64\u65f6\u9700\u8981\u8865\u4e0a\u53e6\u5916\u623f\u95f4\u7684\u8d39\u7528\u3002"];return(0,_r.jsx)(Ba,{title:"\u623f\u95f4\u8bf4\u660e",handleClose:function(){r(!1)},mainBtnText:"\u77e5\u9053\u4e86",children:(0,_r.jsx)(D.View,{className:"limit_view",children:a.map((function(e,t){return(0,_r.jsx)(D.View,{className:Rr(t>0?"mb64":""),children:(0,_r.jsxs)(D.Text,{className:Rr("text28","#222","ml10"),children:["\xb7 ",e]})},t)}))})})}function Go(){var e=yr.useState((function(e){var t=e.isShowCountryCodeMask,n=e.ContactInfo,r=e.firstScreenStatus,a=e.taroInfo;return{isShowCountryCodeMask:t,ContactInfo:n,firstScreenStatus:r,taroInfo:a}})),t=e.isShowCountryCodeMask,n=e.ContactInfo,r=e.firstScreenStatus,a=e.taroInfo,o=yr.useActions(),i=o.toggleCountryCodeMask,s=(o.getFirstScreenInterface,o.countryCodeBack),c=o.chooseDeliveryAddressBack,l=o.specialCallBack,u=o.chooseInvoiceBack,d=o.passengerEditCallBack,f=o.passengerListCallBack,p=o.orderTraceDevLog,m=(o.initPage,o.insConfirmBack),h=(o.preloadCallBackAction,o.contractCallBack);(0,O.useEffect)((function(){var e=function(e,t){y().Observer.addObserverForKeyOnly(e,(function(e){var n=e.type,r=e.options;"message"===n&&t&&t(r)}))},t=function(e){y().Observer.removeAllObserversForKey(e)};return e("address-list",(function(e){var t,n=null===e||void 0===e||null===(t=e.detail)||void 0===t?void 0:t.data.find((function(e){return"onShare"!==e.type}));x.isEmpty(n)||(console.log("================= addressList postMessage ================",n),n&&c(n.selectAddress))})),e("order-remark",(function(e){var t,n=null===e||void 0===e||null===(t=e.detail)||void 0===t?void 0:t.data.find((function(e){return"onShare"!==e.type}));x.isEmpty(n)||(console.log("================= orderRemark postMessage ================",n),n&&l(n))})),e("order-invoice",(function(e){var t,n;console.log("======================options",null===e||void 0===e||null===(t=e.detail)||void 0===t?void 0:t.data);var r=null===e||void 0===e||null===(n=e.detail)||void 0===n?void 0:n.data.find((function(e){return"order-invoice"===e.type}));r&&u(r.invoice)})),e("ins-build",(function(e){var t,n;console.log("======================options",null===e||void 0===e||null===(t=e.detail)||void 0===t?void 0:t.data);var r=null===e||void 0===e||null===(n=e.detail)||void 0===n?void 0:n.data.find((function(e){return e.token}));console.log("postMessageData====",r),m(r)})),e("_cmp_passenger-picker",(function(e){var t,n=(null===e||void 0===e||null===(t=e.detail)||void 0===t?void 0:t.data)||[];p("o_vac_order_h5_bbz_callback",n);var r=null;n.forEach((function(e){1===e.code&&(r=e),2!==e.code||r||(r=e),3===e.code&&d(e),e.code})),r&&f(r)})),e("order-contract",(function(e){var t,n;console.log("======================options",null===e||void 0===e||null===(t=e.detail)||void 0===t?void 0:t.data);var r=null===e||void 0===e||null===(n=e.detail)||void 0===n?void 0:n.data.find((function(e){return"order-contract"===e.type}));console.log("======================postMessageData",r);var a=r||{},o=a.result;h(o)})),function(){t("address-list"),t("order-remark"),t("order-invoice"),t("ins-build"),t("train-check"),t("_cmp_passenger-picker"),t("order-contract")}}),[]);var v=(0,O.useCallback)((function(){i(!1)}),[]),g=a||{},_=g.navBarMarginTop;return(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsxs)(D.View,{className:"Layout",children:[(0,_r.jsx)(Ir,{}),r?(0,_r.jsxs)(D.ScrollView,{className:"Order_Module",style:{marginTop:"".concat(_+44,"Px")},children:[(0,_r.jsx)(Nr,{}),(0,_r.jsx)(Br,{}),(0,_r.jsx)(Kr,{}),(0,_r.jsx)(Eo,{}),(0,_r.jsx)($r,{}),(0,_r.jsx)(ua,{}),(0,_r.jsx)(ma,{}),(0,_r.jsx)(Pa,{}),(0,_r.jsx)(Oa,{}),(0,_r.jsx)(Ca,{}),(0,_r.jsx)(ka,{}),(0,_r.jsx)(va,{}),(0,_r.jsx)(ya,{})]}):(0,_r.jsx)(D.ScrollView,{className:"Order_Module",style:{marginTop:"".concat(_+44,"Px")},children:(0,_r.jsx)(kr,{})}),(0,_r.jsx)(xa,{}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(Ma,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(Ua,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(Po,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(Za,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(Fa,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(Ya,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(Wa,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(Ja,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(Qa,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(eo,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(to,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(no,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(ro,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(lo,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(ao,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(oo,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(io,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(so,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(uo,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(fo,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(po,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(mo,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(qa,{isShowCountryCodeMask:t,handleClose:v,curCode:n&&+n.CountryCode,handleSelect:s})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(ho,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(vo,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(go,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(bo,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(yo,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(xo,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(ko,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(wo,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(jo,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(Oo,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(Do,{})}),(0,_r.jsx)(D.View,{children:(0,_r.jsx)(Fo,{})})]}),(0,_r.jsx)(Ao,{}),(0,_r.jsx)(Bo,{}),(0,_r.jsx)(Zo,{})]})}var Ho=(Vo=(0,p.PureModel)({Model:yr}),Vo(Lo=function(e){(0,u.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,s.Z)(this,n),r=t.call(this,e),(0,f.Z)((0,l.Z)(r),"selectDateRef",{current:{}}),(0,f.Z)((0,l.Z)(r),p.MODEL_CONTEXT,(0,i.Z)((0,i.Z)((0,i.Z)({},de.impl({serverFrom:"WAP/WECHATAPP"})),pe.impl((0,i.Z)((0,i.Z)({},r.tourContext),{},{ctrl:(0,l.Z)(r),logPageError:r.logPageError.bind((0,l.Z)(r)),preSetPageId:r.setPageId.bind((0,l.Z)(r)),getTaroInfo:r.getTaroInfo.bind((0,l.Z)(r)),pay:r.pay.bind((0,l.Z)(r)),getMarketingInfo:r.getMarketingInfo.bind((0,l.Z)(r)),scrollToErrorPosition:r.scrollToErrorPosition.bind((0,l.Z)(r)),getInitialData:r.getInitialData.bind((0,l.Z)(r)),openIM:r.openIM.bind((0,l.Z)(r)),backToLastPage:r.backToLastPage.bind((0,l.Z)(r)),showMaskLoading:r.showMaskLoading.bind((0,l.Z)(r)),hideMaskLoading:r.hideMaskLoading.bind((0,l.Z)(r)),goToPassengerList:r.goToPassengerList.bind((0,l.Z)(r)),goToPassengerEdit:r.goToPassengerEdit.bind((0,l.Z)(r)),goToTrainPsgCheck:r.goToTrainPsgCheck.bind((0,l.Z)(r)),goToInvoice:r.goToInvoice.bind((0,l.Z)(r)),goToAddressList:r.goToAddressList.bind((0,l.Z)(r)),goToOrderMiniRemark:r.goToOrderMiniRemark.bind((0,l.Z)(r)),goToOrderContract:r.goToOrderContract.bind((0,l.Z)(r)),goInsuranceConfirm:r.goInsuranceConfirm.bind((0,l.Z)(r)),goSuccessBack:r.goSuccessBack.bind((0,l.Z)(r)),getSaveOrderRequestParams:r.getSaveOrderRequestParams.bind((0,l.Z)(r)),goTo12306Page:r.goTo12306Page.bind((0,l.Z)(r)),basicLog:r.basicLog.bind((0,l.Z)(r)),get12306UserInfo:r.get12306UserInfo.bind((0,l.Z)(r)),get12306NoticeStatus:r.get12306NoticeStatus.bind((0,l.Z)(r)),getPlatform:r.getPlatform.bind((0,l.Z)(r)),getHeadTagList:r.getHeadTagList.bind((0,l.Z)(r)),timeOutTip:r.timeOutTip.bind((0,l.Z)(r)),selectDateRef:r.selectDateRef}))),le.impl((0,i.Z)({},r.getUrlQuery())))),(0,f.Z)((0,l.Z)(r),"flightTime",null),(0,f.Z)((0,l.Z)(r),"goToOrderDetail",(function(e){var t="/tour/order_info/order_detail",n={url:t,params:{orderId:e},options:{needHost:!0}};r.jumpH5(n)})),r.autoExpose=!0,r}return(0,c.Z)(n,[{key:"getPlatform",value:function(){return _e.CTRIPWX}},{key:"getInitialData",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=h().getSystemInfoSync(),n=t.statusBarHeight,r={windowHeight:t.windowHeight,windowWidth:t.windowWidth,navBarMarginTop:n,safeArea:t.safeArea,env:x.getEnv()},e.abrupt("return",{Platform:_e.CTRIPWX,taroInfo:r});case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"setPageId",value:function(e){var t=e||{},n=t.producttype,r=void 0===n?"":n;if(r&&["grp","sdp","cruise"].includes(r)){var a="220170";return"sdp"===r&&(a="414040"),this.sendPV({pageId:a,url:this.getPageUrl()}),a}}},{key:"getTaroInfo",value:function(){var e=h().getSystemInfoSync(),t=e.statusBarHeight,n={windowHeight:e.windowHeight,windowWidth:e.windowWidth,navBarMarginTop:t,safeArea:e.safeArea,env:x.getEnv()};return n}},{key:"basicLog",value:function(e){var t=e||{},n=t.productBasicInfo,r=void 0===n?{}:n,a=t.orderBasicInfo,o=void 0===a?{}:a,i=t.tagInfo,s=void 0===i?{}:i,c=t.IMEntryInfo,l=void 0===c?{}:c,u=l&&(l.imSwitch||l.inquiry)||!1;this.tracelog("grp_order_basic_info_expo",{stcityid:null===r||void 0===r?void 0:r.DepartureId,slcityid:null===r||void 0===r?void 0:r.SaleCityId,pkgid:null===r||void 0===r?void 0:r.ProductId,adlt_num:null===o||void 0===o?void 0:o.AdultCount,child_num:null===o||void 0===o?void 0:o.ChildCount,isocexpo:u?"1":"0",hassysflt:null!==s&&void 0!==s&&s.isContainSystemFlight?"1":"0",shoppingid:null===r||void 0===r?void 0:r.shoppingId,yn_login:1,startdate:null===o||void 0===o?void 0:o.DepartureDate,isPaidFirst:null!==s&&void 0!==s&&s.isPaidFirst?1:0})}},{key:"componentWillMount",value:function(){console.log("componentWillMount")}},{key:"componentDidMount",value:function(){console.log("componentDidMount");var e=this;y().sendUbtExpose.refreshObserve(e)}},{key:"componentWillUnmount",value:function(){console.log("componentWillUnmount");var e=this.get&&this.get("storage_from_order")||null;h().eventCenter&&h().eventCenter.trigger("orderPageInfo",e),this.flightTime&&clearTimeout(this.flightTime)}},{key:"componentDidShow",value:function(){console.log("componentDidShow")}},{key:"componentDidHide",value:function(){console.log("componentDidHide")}},{key:"logPageError",value:function(){}},{key:"getMarketingInfo",value:function(){return y().mkt.getUnion()}},{key:"pay",value:function(e,t){var n=this,r=t.productBasicInfo,a=t.shoppingId,o=r||{},i=o.IsThemeProduct,s=e.PaymentParameterInfo,c=e.TransactionId,l=s||{},u=l.BuzType,d=l.OrderId,f=l.PayToken,p=l.IsPABCReceive,m=l.RedirectUrl,h={url:"/webapp/vacations/tour/order_completev2",params:{shoppingid:a,orderid:d,themeproduct:i?"1":"",prename:"tour_order"},options:{needLogin:!1,isRedirect:!0}},v=null;v=p&&m?{payLink:m}:{requestId:c,orderId:d,payToken:f,busType:u},y().payment.callPay2({serverData:v,sbackCallback:function(e){n.jumpH5(h)},fromCallback:function(){},ebackCallback:function(e){n.jumpH5(h)},rbackCallback:function(e){}})}},{key:"scrollToErrorPosition",value:function(e){console.log("position====",e),h().createSelectorQuery().select("#".concat(e)).boundingClientRect((function(e){console.log("rect===",e);var t=h().getSystemInfoSync(),n=e.top,r=e.bottom,a=e.height;console.log("rect===",n,r,a),console.log("rect===",t.windowHeight),(n<44||r>=t.windowHeight-70)&&(console.log("position====","\u51fa\u53d1\u6eda\u52a8\u62c9\uff01\uff01\uff01\uff01\uff01"),h().createSelectorQuery().selectViewport().scrollOffset((function(a){var o=a.scrollTop;console.log("scrollTop===",o),n<44?e&&h().pageScrollTo({scrollTop:o-(150-n),duration:300}):r>=t.windowHeight-70&&e&&h().pageScrollTo({scrollTop:o+(n-150),duration:300})})).exec())})).exec()}},{key:"openIM",value:function(e){var t="/tour/im/group",n={needLogin:!0,needHost:!0};this.jumpH5({url:t,params:e,options:n})}},{key:"backToLastPage",value:function(e){this.set("storage_from_order",e),e&&e.historyCount?y().navigateBack({delta:+e.historyCount}):this.navigateBack()}},{key:"showMaskLoading",value:function(){this.showLoadingDialog({})}},{key:"hideMaskLoading",value:function(){this.hideLoadingDialog()}},{key:"getSaveOrderRequestParams",value:function(e){var t=e.marketingInfo,n={},r=t||{},a=r.allianceid,o=r.ouid,s=r.sid,c=r.sourceid,l=r.exmktid,u=l&&JSON.parse(l)||{},d=u.openid;n={AllianceID:a,SID:s,OUID:o};var f={UniqueDisplayCode:"",AppId:""};l&&(f=(0,i.Z)((0,i.Z)({},f),{},{AwakeAllianceId:a?String(a):"",AwakeSid:s?String(s):"",AwakeOuid:o,AwakeSourceId:c,OpenId:d,exmktId:l})),c&&(f.SourceId=c);var p={PlatformId:2,FromUrl:"",RBackUrl:"",SBackUrl:"",EBackUrl:""};return{MarketingInfo:n,SaleChannelInfo:f,PaymentParameter:p}}},{key:"getHeadTagList",value:function(){return[{Key:"platform",Value:2}]}},{key:"goInsuranceConfirm",value:function(e){this.jumpH5({url:e.url,params:{hideBack:1},options:{observerKey:"ins-build"}})}},{key:"goToPassengerList",value:function(e){var t=e.shoppingId,n=void 0===t?"":t,r=e.selectIds,a=void 0===r?[]:r,o=e.passengerObj,i=void 0===o?{}:o,s=e.taroInfo,c=void 0===s?{}:s,l=(null===a||void 0===a?void 0:a.join("|"))||"",u=null===a||void 0===a?void 0:a.reduce((function(e,t){var n;return e[t]=(null===(n=i[t])||void 0===n?void 0:n.chosenInfo)||{},e}),{}),d=c&&"fat"===c.env?"https://m.ctrip.fat49.qa.nt.ctripcorp.com":"https://m.ctrip.com";this.jumpH5({url:"".concat(d,"/webapp/cpage/passenger-picker?bizType=PKG&prdToken=").concat(n,"&chosenIds[]=").concat(l,"&chosenInfoMap=").concat(encodeURIComponent(JSON.stringify(u)),"&reload=1#/list"),options:{observerKey:"_cmp_passenger-picker",needLogin:!0}})}},{key:"goToPassengerEdit",value:function(e){var t=e.shoppingId,n=void 0===t?"":t,r=e.passengerId,a=e.chosenInfo,o=void 0===a?{}:a,i=e.taroInfo,s=void 0===i?{}:i,c=s&&"fat"===s.env?"https://m.ctrip.fat49.qa.nt.ctripcorp.com":"https://m.ctrip.com";this.jumpH5({url:"".concat(c,"/webapp/cpage/passenger-picker?bizType=PKG&prdToken=").concat(n,"&passengerId=").concat(r,"&chosenState=").concat(encodeURIComponent(JSON.stringify(o)),"&disableDelete=true&isInitialPage=true&reload=1#/edit"),options:{observerKey:"_cmp_passenger-picker",needLogin:!0}})}},{key:"goToTrainPsgCheck",value:function(e){this.jumpH5({url:"/webapp/vacations/tour/order_traincheck",params:e,options:{observerKey:"train-check"}})}},{key:"goToInvoice",value:function(e){this.jumpH5({url:"/webapp/vacations/tour/invoice",params:e,options:{observerKey:"order-invoice"}})}},{key:"goToAddressList",value:function(e){this.jumpH5({url:"/webapp/vacations/tour/address_list",params:e,options:{observerKey:"address-list"}})}},{key:"goToOrderMiniRemark",value:function(e){this.jumpH5({url:"/webapp/vacations/tour/orderremark",params:e,options:{observerKey:"order-remark"}})}},{key:"goToOrderContract",value:function(e){this.jumpH5({url:"/webapp/vacations/tour/ordercontract",params:e})}},{key:"goToContract",value:function(e){var t=e.isShowOldMan,n=e.isShowUnderAge,r=e.shoppingId,a=e.tabIndex,o=e.productBasicInfo,i=e.taroInfo,s=e.actionFrom,c=e.isShowAuthorize,l=e.replaceObj,u=o||{},d=u.isDiyfhxsdp,f="?fromnative=1&shoppingid=".concat(r,"&tabindex=").concat(a||0,"&isold=").concat(t?1:0,"&isunderage=").concat(n?1:0,"&isoversea=").concat(c?1:0,"&issdp=").concat(d?1:0,"&actionfrom=").concat(s||""),p=l||{},m=p.traveler,h=p.travelerMobile,v=p.totalCost;m&&(f+="&traveler=".concat(m)),h&&(f+="&mobile=".concat(h)),v&&(f+="&price=".concat(v));var g=i&&"fat"===i.env?"https://m.ctrip.fat30.qa.nt.ctripcorp.com":"https://m.ctrip.com";this.jumpH5({url:"".concat(g,"/webapp/vacations/tour/ordercontract").concat(f),options:{observerKey:"order-contract"}})}},{key:"goSuccessBack",value:function(e){var t=e||{},n=t.shoppingId,r=t.productBasicInfo,a=t.payInfo,o=r||{},i=o.IsThemeProduct,s=void 0!==i&&i,c=a||{},l=c.OrderId,u={url:"/webapp/vacations/tour/order_completev2",params:{shoppingid:n,orderid:l,themeproduct:s?"1":"",prename:"tour_order"},options:{needLogin:!1,isRedirect:!0}};this.jumpH5(u)}},{key:"get12306UserInfo",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,r,o,i,s;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.get("12306token");case 2:if(t=e.sent,!oe.isEmpty(t)){e.next=5;break}return e.abrupt("return",{});case 5:if(n=t.time,r=t.data,o=r.userName,i=r.token,s=ye.dayDiff(n,Date.now()),!(s<30)){e.next=11;break}return e.abrupt("return",{userName:o,token:i});case 11:return this.remove("12306token"),e.abrupt("return",{});case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"goTo12306Page",value:function(e,t){if(this.isPlatformStandalone){var n=this,r="https://m.ctrip.com/webapp/train/activity/ctrip-train-12306/#/login?from=booking";oe.isEmpty(t)||(r=x._parseUrl(r,t)),this.navigateTo({url:"/pages/trainWebview/webview",data:{url:r,bridgeIns:function(t){var r=t.detail.data[0],a=r.userName,o=r.token;n.set("12306token",{time:Date.now(),data:{userName:a,token:o}}),e&&e({userName:a,token:o})},needLogin:!0}})}else{var a=this,o="https://m.ctrip.com/webapp/train/activity/ctrip-train-12306/#/login?from=booking",i=y().getCurrentPage();i.navigateTo({url:"/pages/train/webview/webview",data:{url:o,bridgeIns:function(t){var n=t.detail.data[0],r=n.userName,o=n.token;a.set("12306token",{time:Date.now(),data:{userName:r,token:o}}),console.log("\ud83e\udd2cwxLoginuccess"),e&&e({userName:r,token:o})},needLogin:!0}})}}},{key:"get12306NoticeStatus",value:function(e){var t=this.get("12306OccupyMessage")||{},n=t[e];return n&&ye.format(Date.now(),"YYYY-MM-DD")===ye.format(n,"YYYY-MM-DD")||(h().setStorageSync("12306OccupyMessage",(0,i.Z)((0,i.Z)({},t),{},(0,f.Z)({},e,Date.now()))),!1)}},{key:"timeOutTip",value:function(e,t){this.flightTime=setTimeout((function(){e()}),t)}},{key:"render",value:function(){return(0,_r.jsx)(Go,{})}}]),n}(j))||Lo),qo={navigationStyle:"custom",navigationBarTextStyle:"black",usingComponents:{"mp-html":"../common/mp-html/index"}};Page((0,r.createPageConfig)(Ho,"pages/tourbooking/order/index",{root:{cn:[]}},qo||{}))},79181:function(e){"use strict";e.exports=require("../../../cwx/cpage/initNavigator")},91783:function(e){"use strict";e.exports=require("../../../cwx/cpage/ubt_wx")},56884:function(e){"use strict";e.exports=require("../../../cwx/cwx")},65238:function(e){"use strict";e.exports=require("../../../cwx/ext/global")},33675:function(e){"use strict";e.exports=require("../../../cwx/cwx")},46346:function(e){"use strict";e.exports=require("../../../cwx/ext/global")}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[2107,1216,8592],(function(){return t(82422)}));e.O()}]);
//# sourceMappingURL=index.js.map