"use strict";require("../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[949],{56392:function(e,n,t){var o=t(32180),i=t(79301),s=t(95308),c=t(57042),a=t(24460),r=t(21867),l=t(86066),u=t(90201),d=t(71515),p=t(65542),x=t(3979),h=t(38717),v=t(22276),f=t(298),g=t(90129),w=t(56884),b=t.n(w),C=t(2269),k=function(){},j=b().train,Z=function(e){var n=e.selectCoupon,t=void 0===n?{}:n,o=e.couponList,i=void 0===o?[]:o,s=e.disabledCouponList,c=void 0===s?[]:s,a=e.isUpperCase,r=void 0!==a&&a,l=e.isSelectArgent,p=e.isNotSelectPackage,x=void 0!==p&&p,w=e.navigateBack,b=void 0===w?k:w,Z=(0,u.useState)(t),m=(0,g.Z)(Z,2),S=m[0],V=m[1],P=(0,u.useState)(i),L=(0,g.Z)(P,2),O=L[0],y=L[1],N=(0,u.useState)(c),B=(0,g.Z)(N,2),A=B[0],T=B[1];(0,u.useEffect)((function(){V(t),y(i),T(c)}),[t,i,c]);var U=function(e,n){var o,i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(n){var c=s.unavailableToast||(x?"\u60a8\u672a\u8d2d\u4e70\u5957\u9910\uff0c\u4e0d\u53ef\u4f7f\u7528\u8be5\u4f18\u60e0\u5238\u54e6":"\u6b64\u4f18\u60e0\u5238\u5f53\u524d\u65e0\u6cd5\u4f7f\u7528");h.ZP.showModal({m:c})}else if(l)h.ZP.showModal({m:"\u7d27\u6025\u4ee3\u8d2d\u4e0d\u53ef\u4f7f\u7528\u4f18\u60e0\u5238\u54e6"});else{var a=-1===e?{}:O[e];(null===(o=a)||void 0===o?void 0:o.couponCode)===(null===S||void 0===S?void 0:S.couponCode)||null!==(i=a)&&void 0!==i&&i.disabled||(V(a),j.selectCoupon=t,r&&(a=Object.keys(a).length>0?(0,h.Zs)(a,!1):null),b({selectCoupon:a}))}},q=function(e,n){var t=n?A[e]:O[e];n?(A[e]=(0,f.Z)((0,f.Z)({},t),{},{allowOpen:!t.allowOpen}),T((0,v.Z)(A))):(O[e]=(0,f.Z)((0,f.Z)({},t),{},{allowOpen:!t.allowOpen}),y((0,v.Z)(O)))},F=function(e,n){return(0,C.jsx)(C.Fragment,{children:e.map((function(e,t){return(0,C.jsxs)(d.View,{onClick:function(){return U(t,n,e)},class:"coupon-box ".concat(e.disabled?"disabled":"","} \n          ").concat((null===S||void 0===S?void 0:S.couponCode)===e.couponCode?"current":""),children:[(0,C.jsxs)(d.View,{class:"coupon-bd",children:[(0,C.jsxs)(d.View,{class:"coupon-left",children:[(0,C.jsx)(d.View,{class:"coupon-left-txt",children:"\u7acb\u51cf\u5238"}),(0,C.jsxs)(d.View,{class:"coupon-left-price",children:[e.deductionAmount,(0,C.jsx)(d.Text,{children:"\u5143"})]})]}),(0,C.jsx)(d.View,{class:"coupon-right ".concat(e.allowOpen?"open":""),children:(0,C.jsxs)(d.View,{class:"coupon-right-txts",children:[(0,C.jsx)(d.View,{class:"txts-title",children:e.couponDisplayName}),(0,C.jsxs)(d.View,{class:"txts-date",children:["\u6709\u6548\u671f\u81f3",e.couponEndDateStr]}),(0,C.jsx)(d.View,{class:"txts-des",onClick:function(e){e.stopPropagation(),q(t,n)},children:"\u4f7f\u7528\u8bf4\u660e"})]})})]}),(0,C.jsx)(d.View,{class:"coupon-info-none ".concat(e.allowOpen?"coupon-info":""),onClick:function(e){e.stopPropagation(),q(t,n)},children:(0,C.jsx)(d.View,{class:"remark-box",children:e.remark})}),e.disabled?null:(0,C.jsx)(d.View,{class:"checkbox check-box-base \n             ".concat((null===S||void 0===S?void 0:S.couponCode)===e.couponCode?"active ifont-radio":"")})]},t)}))})};return(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)(d.View,{className:"coupon-page",children:[(0,C.jsxs)(d.View,{class:"coupon-no-use-box  ".concat(S&&Object.keys(S).length?"":"current"),onClick:function(){return U(-1)},children:[(0,C.jsx)(d.Text,{children:"\u4e0d\u4f7f\u7528\u4f18\u60e0"}),(0,C.jsx)(d.View,{class:"checkbox check-box-base ".concat(S&&Object.keys(S).length?"":"active ifont-radio")})]}),F(O),(null===A||void 0===A?void 0:A.length)>0?(0,C.jsx)(d.View,{class:"coupon-disable-list",children:"\u4e0d\u53ef\u7528\u4f18\u60e0\u5238"}):null,F(A,!0)]})})},m=Z,S=function(e){(0,r.Z)(t,e);var n=(0,l.Z)(t);function t(e){var o;return(0,c.Z)(this,t),o=n.call(this,e),o.pageId=x.Z.grabBooking,o.checkPerformance=!0,o.state={disabledCouponList:[],couponList:[],selectCoupon:{},isUpperCase:!1,isSelectArgent:!1,isNotSelectPackage:!1},o}return(0,a.Z)(t,[{key:"onLoad",value:function(){var e=(0,s.Z)((0,i.Z)().mark((function e(n){var t,o,s,c,a,r,l,u,d,p;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.data&&(t=n.data,o=void 0===t?{}:t,s=o.selectCoupon,c=o.couponList,a=o.isUpperCase,r=o.isSelectArgent,l=o.isNotSelectPackage,u=c.filter((function(e){return e.disabled})),c=c.filter((function(e){return!e.disabled})),d=c.map((function(e){return(0,h.Zs)(e)})),p=u.map((function(e){return(0,h.Zs)(e)})),this.setState({disabledCouponList:p,couponList:d,selectCoupon:(0,h.Zs)(s),isUpperCase:a,isSelectArgent:r,isNotSelectPackage:l}));case 1:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"render",value:function(){var e=this;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(m,{selectCoupon:this.state.selectCoupon,couponList:this.state.couponList,disabledCouponList:this.state.disabledCouponList,isSelectArgent:this.state.isSelectArgent,isNotSelectPackage:this.state.isNotSelectPackage,isUpperCase:this.state.isUpperCase,navigateBack:this.navigateBack.bind(this)}),(0,C.jsx)(d.View,{className:"view-check",onAnimationEnd:function(){return e.viewReadyHandle()}})]})}}]),t}(p.Z),V={navigationBarTitleText:"\u4f7f\u7528\u4f18\u60e0\u5238",navigationStyle:"default",navigationBarBackgroundColor:"#0086F6",navigationBarTextStyle:"white"};Page((0,o.createPageConfig)(S,"pages/trainBooking/coupon/index",{root:{cn:[]}},V||{}))},79181:function(e){e.exports=require("../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../cwx/cwx")},65238:function(e){e.exports=require("../../../cwx/ext/global")}},function(e){var n=function(n){return e(e.s=n)};e.O(0,[2119,2107,1216,8592],(function(){return n(56392)}));e.O()}]);
//# sourceMappingURL=index.js.map