"use strict";require("../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[6739],{40319:function(e,t,n){var i=n(32180),a=n(79301),s=n(95308),r=n(90129),c=n(298),o=n(57042),l=n(24460),u=n(21867),d=n(86066),m=n(90201),p=n(56884),f=n.n(p),h=n(92954),x=n.n(h),g=n(71515),v=n(65542),N=n(38717),j=n(79496),T=n(79062),k=n(3979),b=n(45023),w=n(81719),S=n.n(w),y=n(66728),I=n(2269),P=function(e){var t=e.visible,n=void 0!==t&&t,i=e.title,a=void 0===i?"":i,s=e.selectedOtherProduct,r=void 0===s?"":s;function c(){N.ZP.showToast("\u5b66\u751f\u7968"===r?"\u5b66\u751f\u7968\u6682\u4e0d\u652f\u6301".concat(a):"\u9009\u62e9\u4e86".concat(r,"\u529f\u80fd\u540e\uff0c\u65e0\u6cd5\u4f7f\u7528").concat(a),"none")}return(0,I.jsx)(g.View,{className:"disable-box".concat(n?"":" hide"),onClick:c,children:(0,I.jsxs)(g.View,{className:"package-hd disabled",children:[(0,I.jsx)(g.View,{className:"tit",children:a}),(0,I.jsxs)(g.View,{className:"rbox",children:[(0,I.jsx)(g.Text,{className:"ifont-tips"}),"\u4e0d\u652f\u6301\u4e0e".concat(r,"\u540c\u65f6\u9009\u62e9")]})]})})},Z=P,C=S().classnames,V=function(e){var t,n=e.outerVisible,i=void 0!==n&&n,o=e.curSelSeatPosInfo,l=void 0===o?{}:o,u=e.onCurSelSeatPosInfoChange,d=void 0===u?function(){}:u,h=e.selectedPassengers,v=void 0===h?[]:h,j=e.selectedOtherProduct,T=void 0===j?"":j,k=e.selectSeatServiceList,b=void 0===k?[]:k,w=e.selectSeatAlertInfoList,S=void 0===w?[]:w,P=e.selSeatRef,V=void 0===P?{}:P,D=e.setFreeBedList,L=void 0===D?N.UH:D,B=e.setFreeBedSelList,R=void 0===B?N.UH:B,A=e.freeBedList,_=void 0===A?[]:A,F=(0,m.useState)(0),O=(0,r.Z)(F,2),M=O[0],z=O[1],E=(0,m.useState)([]),Y=(0,r.Z)(E,2),H=Y[0],U=Y[1],K=(0,m.useState)(!1),G=(0,r.Z)(K,2),q=G[0],W=G[1];function X(){var e,t,n=b.filter((function(e){return!e.showName.includes("\u8f66\u53a2")&&e.isShow}));n.forEach((function(e){var t,n;e.acceptRules=null===(t=e.bottomMessageList)||void 0===t?void 0:t.filter((function(e){return e.buttonOn})).map((function(e){return e.tips})),e.rejectRules=null===(n=e.bottomMessageList)||void 0===n?void 0:n.filter((function(e){return!e.buttonOn})).map((function(e){return e.tips}))}));var i={title:null!==(e=n[0])&&void 0!==e&&e.showName.includes("\u5ea7\u5e2d")?"\u5b9a\u5236\u5ea7\u5e2d":"\u5b9a\u5236\u94fa\u4f4d",subTitle:null!==(t=n[0])&&void 0!==t&&t.showName.includes("\u5ea7\u5e2d")?"\u9760\u7a97\u3001\u8fc7\u9053\u4efb\u610f\u9009\uff0c\u5b9a\u5236\u51fa\u884c\u597d\u5fc3\u60c5":"\u94fa\u4f4d\u4efb\u610f\u9009\uff0c\u5b9a\u5236\u51fa\u884c\u597d\u5fc3\u60c5",selSeatIdx:-1},a=n.filter((function(e){return e.is12306SelectSeatService}));L(a),U(n),d(i)}function J(e){return Q.apply(this,arguments)}function Q(){return Q=(0,s.Z)((0,a.Z)().mark((function e(t){var n,i,s,r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=(0,c.Z)({},l),i=S.find((function(e){return e.serviceType===H[t].serviceType})),n.hasPopSelSeatPos||!i){e.next=6;break}return e.next=5,new Promise((function(e,t){x().showModal({title:i.title,content:i.content,showCancel:!0,cancelText:"\u4e0d\u63a5\u53d7",confirmText:"\u63a5\u53d7",confirmColor:"#0086f6",success:function(t){t.confirm?n.acceptOther=!0:n.acceptOther=!1,n.title.includes("\u94fa\u4f4d")&&N.ZP.ubtTrace("c_trn_c_10650084622",{bizkey:"chooseBedPopupClick",clickType:+t.confirm}),e()}})}));case 5:n.hasPopSelSeatPos=!0;case 6:i||(n.acceptOther=!1),n.selSeatIdx=t===l.selSeatIdx?-1:t,n.num=M?1:0,s=p._.pick(H[t],["serviceFee","priceName","productName","serviceType","isCanEleCToDZTicket","productId","selectSeatCode"]),d((0,c.Z)((0,c.Z)({},n),s)),r=n.title.includes("\u94fa\u4f4d")?"chooseBedClick":"chooseSeatClick",N.ZP.ubtTrace("c_trn_c_10650084622",{bizKey:r,clickType:n.selSeatIdx>=0?1:0});case 13:case"end":return e.stop()}}),e)}))),Q.apply(this,arguments)}function $(e){d((0,c.Z)((0,c.Z)({},l),{},{acceptOther:!l.acceptOther}))}function ee(e){if(e.stopPropagation(),l.num<=0)return N.ZP.showToast("\u4efd\u6570\u4e0d\u80fd\u518d\u5c11\u5566~","none",1500);d((0,c.Z)((0,c.Z)({},l),{},{num:l.num-1}))}function te(e){if(e.stopPropagation(),l.num>=M)return N.ZP.showToast("\u4efd\u6570\u4e0d\u80fd\u5927\u4e8e\u4e58\u5ba2\u6570~","none",1500);d((0,c.Z)((0,c.Z)({},l),{},{num:l.num+1}))}function ne(){var e=f().getCurrentPage(),t=_.length?_[0].titleDescUrl:"https://m.ctrip.com/webapp/train/activity/orderservice/InsuranceDetail.aspx?ProductID=1729&terminal=1&terminal=1";e.navigateTo({url:"/pages/trainActivity/twebview/index",data:{url:t,needLogin:!0}})}(0,m.useEffect)((function(){X()}),[b]),(0,m.useEffect)((function(){var e,t=[l.title,null===(e=_[0])||void 0===e?void 0:e.showName];W(T&&!t.includes(T))}),[T]),(0,m.useEffect)((function(){z(v.length),l.num>v.length&&d((0,c.Z)((0,c.Z)({},l),{},{num:v.length}))}),[v]),(0,m.useImperativeHandle)(V,(function(){return{initSelSeatServiceInfo:X}}));var ie=function(){var e,t,n;return(0,I.jsxs)(g.View,{className:"comb-bd",children:[(0,I.jsx)(g.View,{className:"comb-flex",children:H.map((function(e,t){return(0,I.jsxs)(g.View,{className:"item ".concat(t===l.selSeatIdx?"cur":""),onClick:function(){return J(t)},children:[(0,I.jsx)(g.View,{className:"tit",children:e.productName}),(0,I.jsxs)(g.View,{className:"txt",children:["\xa5",e.serviceFee,"/\u4eba"]}),(0,I.jsx)(g.Text,{className:"ifont-gou2"})]},t)}))}),(0,I.jsxs)(g.View,{className:"addition-box".concat(l.selSeatIdx>-1?" active":""),children:[(0,I.jsxs)(g.View,{className:"comb-people",children:[(0,I.jsx)(g.View,{className:"tit",children:"\u9009\u62e9\u4eba\u6570"}),(0,I.jsxs)(g.View,{className:"num-select",children:[(0,I.jsx)(g.Text,{className:"ifont-numminus ".concat(l.num<=0?"disabled":""),onClick:ee}),(0,I.jsx)(g.View,{className:"num-input",children:l.num}),(0,I.jsx)(g.Text,{className:"ifont-numadd ".concat(l.num>=M?"disabled":""),onClick:te})]})]}),(0,I.jsxs)(g.View,{className:"comb-fail",children:[(0,I.jsx)(g.View,{className:"txt",children:null===(e=H[l.selSeatIdx])||void 0===e?void 0:e.acceptTip}),(0,I.jsx)(g.Checkbox,{className:"checkbox",onClick:$,checked:l.acceptOther})]}),(0,I.jsx)(g.View,{className:"tips-orage",children:l.acceptOther?(0,I.jsx)(I.Fragment,{children:null===(t=H[l.selSeatIdx])||void 0===t?void 0:t.acceptRules.map((function(e,t){return(0,I.jsx)(g.View,{className:"item",children:(0,I.jsx)(g.RichText,{nodes:e})},t)}))}):(0,I.jsx)(I.Fragment,{children:null===(n=H[l.selSeatIdx])||void 0===n?void 0:n.rejectRules.map((function(e,t){return(0,I.jsx)(g.View,{className:"item",children:(0,I.jsx)(g.RichText,{nodes:e})},t)}))})})]})]})};return(0,I.jsx)(I.Fragment,{children:i&&H.length>0?(0,I.jsxs)(I.Fragment,{children:[l.title&&N.ZP.ubtTrace("s_trn_c_trace_10650084622",{exposureType:"normal",bizKey:l.title.includes("\u94fa\u4f4d")?"chooseBed":"chooseSeat"}),(0,I.jsxs)(g.View,{className:"white-box sel-seat-box fadeIn fold-box".concat(q?" fold":"").concat(l.selSeatIdx>-1||_.length>0?"":" init"),children:[(0,I.jsx)(Z,{visible:q,selectedOtherProduct:T,title:_.length>0?_[0].showName:l.title}),(0,I.jsxs)(g.View,{className:"comb-hd",children:[(0,I.jsxs)(g.View,{className:"tit",children:[(0,I.jsx)(g.View,{className:"tstrong",children:_.length>0?_[0].showName:l.title}),(0,I.jsx)(g.Text,{className:"ifont-qus",onClick:ne})]}),(0,I.jsx)(g.View,{className:C("txt",{"txt-disable":q}),children:l.subTitle}),(0,I.jsx)(g.Image,{src:"".concat(null!==(t=l.title)&&void 0!==t&&t.includes("\u94fa\u4f4d")?"https://images3.c-ctrip.com/train/activity/ctrip-wechat-ordinaryBooking/icon-zhidingpuwei.png":"https://images3.c-ctrip.com/train/activity/ctrip-wechat-ordinaryBooking/icon-zhidingzuoxi.png"),className:C("icon",{"icon-disable":q})})]}),_.length>0?(0,I.jsx)(y.Z,{from:"ordinary",freeBedList:_,setFreeBedSelList:R,selectedPassengers:v}):(0,I.jsx)(ie,{})]})]}):null})},D=n(22276),L=S().classnames,B=function(){},R=function(e){var t=e.psgAmount,n=void 0===t?0:t,i=e.outerVisible,a=void 0!==i&&i,s=e.onChange,c=void 0===s?B:s,o=e.onChangeSecond,l=void 0===o?B:o,u=e.selectedOrderSeats,d=void 0===u?[]:u,p=e.selectedOrderSecondSeats,f=void 0===p?[]:p,h=e.selectedOtherProduct,x=void 0===h?"":h,v=e.train,j=void 0===v?{}:v,T=e.trainTransferInfos,k=void 0===T?[]:T,b=e.isCanSilent,w=void 0!==b&&b,S=e.selectedSilent,y=void 0!==S&&S,P=e.onSelectSilentChange,C=void 0===P?B:P,V=(0,m.useState)(1),R=(0,r.Z)(V,2),A=R[0],_=R[1],F=(0,m.useMemo)((function(){var e,t,n=Object.keys(j).length?j.seatName:null===(e=k[0])||void 0===e?void 0:e.seatName,i=N.ZP.isFirstClassSeat(n)||N.ZP.isSecondClassSeat(n)||N.ZP.isBussinessClassSeat(n),a=null===(t=k[1])||void 0===t?void 0:t.seatName,s=N.ZP.isFirstClassSeat(a)||N.ZP.isSecondClassSeat(a)||N.ZP.isBussinessClassSeat(a);if(k.length>0&&"1_1"!==k[0].tripType&&"1_1"!==k[1].tripType){var r=k[0],c=k[1],o=(0,N.DR)(r.seatName,r.seatList),l=(0,N.DR)(c.seatName,c.seatList);i=i&&(null===o||void 0===o?void 0:o.seatInventory)>0,s=s&&(null===l||void 0===l?void 0:l.seatInventory)>0}return{seatName:n,secondSeatName:a,showFirstPart:i,showSecondPart:s}}),[j,k]),O=F.seatName,M=F.showFirstPart,z=F.secondSeatName,E=F.showSecondPart,Y=n>1?[1,2]:[1],H=x.includes("\u5b9a\u5236")||x.includes("\u8f66\u53a2"),U=Object.keys(j).length>0&&w&&N.ZP.isSecondClassSeat(O);function K(e){var t=q(e,d);c(t)}function G(e){var t=q(e,f);l(t)}function q(e,t){if(0===n)return N.ZP.showToast("\u8bf7\u5148\u9009\u62e9\u4e58\u5ba2","none",1e3),[];var i=[];return t.includes(e)?i=t.filter((function(t){return e!==t})):(t.length>=n&&t.pop(),i=[].concat((0,D.Z)(t),[e])),i}function W(){C(!y)}if((0,m.useEffect)((function(){var e=d.slice(0,n);if(c(e),k.length>0){var t=f.slice(0,n);l(t)}}),[n]),Object.keys(j).length>0&&!M||k.length>0&&!M&&!E)return null;var X=function(e,t,n){return Y.map((function(i){var a=N.ZP.isSecondClassSeat(e),s=N.ZP.isFirstClassSeat(e);return(0,I.jsxs)(g.View,{className:"seat-select",children:[(0,I.jsx)(g.View,{className:"txt",children:"\u9760\u7a97"}),(0,I.jsxs)(g.View,{className:L("item",{cur:t.includes("".concat(i,"A"))}),onClick:function(){return n("".concat(i,"A"))},children:[(0,I.jsx)(g.Text,{className:"ifont-seat"}),(0,I.jsx)(g.View,{className:"t",children:"A"})]}),a&&(0,I.jsxs)(g.View,{className:L("item",{cur:t.includes("".concat(i,"B"))}),onClick:function(){return n("".concat(i,"B"))},children:[(0,I.jsx)(g.Text,{className:"ifont-seat"}),(0,I.jsx)(g.View,{className:"t",children:"B"})]}),(0,I.jsxs)(g.View,{className:L("item",{cur:t.includes("".concat(i,"C"))}),onClick:function(){return n("".concat(i,"C"))},children:[(0,I.jsx)(g.Text,{className:"ifont-seat"}),(0,I.jsx)(g.View,{className:"t",children:"C"})]}),(0,I.jsx)(g.View,{className:"txt",children:"\u8fc7\u9053"}),(s||a)&&(0,I.jsxs)(g.View,{className:L("item",{cur:t.includes("".concat(i,"D"))}),onClick:function(){return n("".concat(i,"D"))},children:[(0,I.jsx)(g.Text,{className:"ifont-seat"}),(0,I.jsx)(g.View,{className:"t",children:"D"})]}),(0,I.jsxs)(g.View,{className:L("item",{cur:t.includes("".concat(i,"F"))}),onClick:function(){return n("".concat(i,"F"))},children:[(0,I.jsx)(g.Text,{className:"ifont-seat"}),(0,I.jsx)(g.View,{className:"t",children:"F"})]}),(0,I.jsx)(g.View,{className:"txt",children:"\u9760\u7a97"})]},i)}))};return(0,I.jsx)(I.Fragment,{children:a&&(0,I.jsxs)(g.View,{className:"white-box fadeIn",children:[k.length>0&&(0,I.jsxs)(g.View,{className:"travel-tab",children:[(0,I.jsxs)(g.View,{className:"tab tab1 ".concat(1===A?"cur":""),onClick:function(){return _(1)},children:["\u7b2c\u4e00\u7a0b",2===A&&d.length>0&&(0,I.jsx)(g.Text,{className:"selet-tag",children:"\u5df2\u9009\u5ea7"})]}),(0,I.jsx)(g.View,{className:"tab tab2 ".concat(2===A?"cur":""),onClick:function(){return _(2)},children:"\u7b2c\u4e8c\u7a0b"}),1===A&&f.length>0&&(0,I.jsx)(g.Text,{className:"selet-tag selet-tag2",children:"\u5df2\u9009\u5ea7"}),(0,I.jsx)(g.View,{className:"tab-slider tab-slider".concat(A)})]}),(0,I.jsxs)(g.View,{className:"package-box online-box fold-box ".concat(H?"fold":"").concat(d.length>0?"":" init"),children:[(0,I.jsx)(Z,{visible:H,selectedOtherProduct:x,title:"\u5728\u7ebf\u9009\u5ea7"}),k.length>0?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(g.View,{className:"package-hd",children:1===A&&!M||2===A&&!E?(0,I.jsx)(g.View,{className:"tit",children:"\u8be5\u8f66\u6b21\u6682\u4e0d\u652f\u6301\u9009\u62e9\u5ea7\u5e2d"}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(g.View,{className:"tit",children:"\u5728\u7ebf\u9009\u5ea7"}),(0,I.jsxs)(g.View,{className:"rbox",children:[1===A?d.length:f.length,"/",(0,I.jsx)(g.Text,{class:"tgrey",children:n})]})]})}),1===A&&M&&X(O,d,K),2===A&&E&&X(z,f,G)]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(g.View,{className:"package-hd",children:[(0,I.jsx)(g.View,{className:"tit",children:"\u5728\u7ebf\u9009\u5ea7"}),(0,I.jsxs)(g.View,{className:"rbox",children:[d.length,"/",(0,I.jsx)(g.Text,{class:"tgrey",children:n})]})]}),X(O,d,K)]}),(0,I.jsx)(g.View,{className:"addition-box".concat(U?" active":""),children:(0,I.jsxs)(g.View,{className:L("tips-grey train-seat-jing",{cur:y}),onClick:W,children:[(0,I.jsx)(g.Text,{className:"".concat(y?"ifont-checked":"ifont-checkbox")}),"\u672c\u5217\u8f66\u6709\u9759\u97f3\u8f66\u53a2\uff0c\u8bf7\u4f18\u5148\u4e3a\u6211\u5206\u914d",(0,I.jsx)(g.Text,{class:"tgreen",children:"\u201c\u9759\u97f3\u8f66\u53a2\u201d"}),"\u5e2d\u4f4d"]})}),(0,I.jsx)(g.View,{className:"addition-box".concat(1===A&&M&&d.length>0||2===A&&E&&f.length>0?" active":""),children:(0,I.jsx)(g.View,{className:"tips-grey train-seat-tip",children:"\u4f18\u5148\u6309\u6307\u5b9a\u5ea7\u5e2d\u51fa\u7968\uff0c\u82e5\u6307\u5b9a\u5ea7\u5e2d\u65e0\u7968\uff0c\u5c06\u8f6c\u8d2d\u5176\u4ed6\u5750\u5e2d"})})]})]})})},A=R,_=function(e){var t=e.outerVisible,n=void 0!==t&&t,i=e.selectSeatServiceList,a=void 0===i?[]:i,s=e.onCurSelCarrInfoChange,o=void 0===s?function(){}:s,l=e.selectedOtherProduct,u=void 0===l?"":l,d=e.curSelCarrInfo,p=void 0===d?{}:d,f=e.selCarriageRef,h=void 0===f?{}:f,x=(0,m.useState)(!1),v=(0,r.Z)(x,2),j=v[0],T=v[1],k=(0,m.useState)(!1),b=(0,r.Z)(k,2),w=b[0],S=b[1],y=(0,m.useState)(""),P=(0,r.Z)(y,2),C=P[0],V=P[1];function D(e){if(!w&&e){var t=e.findIndex((function(e){return e.carriageDesc})),n=t-4>=0?t-4:0;setTimeout((function(){V("carr".concat(n)),S(!0)}),500)}}function L(){var e=a.filter((function(e){return e.showName.includes("\u8f66\u53a2")&&e.isShow}));e.forEach((function(e){var t;return e.rules=null===(t=e.bottomMessageList)||void 0===t?void 0:t.filter((function(e){return e.buttonOn})).map((function(e){return e.tips}))})),D((0,c.Z)({},e[0]).carriageList),o((0,c.Z)((0,c.Z)({},e[0]),{},{selCarrIdx:-1}))}function B(e){var t=(0,c.Z)({},p),n=p.carriageList,i=p.selCarrIdx,a=n[e];if(!a.isAvailable)return N.ZP.showToast("\u6b64\u8f66\u53a2\u6682\u65f6\u4e0d\u652f\u6301\u6307\u5b9a\uff0c\u8bf7\u9009\u62e9\u5176\u4ed6\u8f66\u53a2","none");t.selCarrIdx=i===e?-1:e,t.curTitle=t.selCarrIdx>=0?"\u5df2\u9009".concat(a.carriageNo,"\u8f66\u53a2"):"",o(t),N.ZP.ubtTrace("c_trn_c_10650084622",{bizKey:"chooseTrainClick",clickType:t.selCarrIdx>=0?1:0})}return(0,m.useEffect)((function(){L()}),[a]),(0,m.useEffect)((function(){T(u&&u!==p.productName)}),[u]),(0,m.useImperativeHandle)(h,(function(){return{initSelCarrConfig:L}})),(0,I.jsx)(I.Fragment,{children:n&&p.carriageList&&(0,I.jsxs)(I.Fragment,{children:[N.ZP.ubtTrace("s_trn_c_trace_10650084622",{exposureType:"normal",bizKey:"chooseTrain"}),(0,I.jsxs)(g.View,{className:"white-box package-box fadeIn carr-box fold-box".concat(j?" fold":"").concat(p.selCarrIdx>-1?"":" init"),children:[(0,I.jsx)(Z,{visible:j,selectedOtherProduct:u,title:p.productName}),(0,I.jsxs)(g.View,{className:"package-hd",children:[(0,I.jsx)(g.View,{className:"tit",children:p.curTitle||p.productName}),(0,I.jsxs)(g.View,{className:"rbox",children:["\uffe5",p.serviceFee,"/\u4eba"]})]}),(0,I.jsx)(g.View,{className:"carriage-select",children:(0,I.jsxs)(g.ScrollView,{className:"carriage-list",scrollIntoView:C,scrollX:!0,scrollWithAnimation:!0,children:[p.carriageList.map((function(e,t){return(0,I.jsxs)(g.View,{id:"carr".concat(t),className:"item".concat(e.carriageDesc?" dinner":"").concat(e.isAvailable?"":" disabled").concat(t===p.selCarrIdx?" cur":""," "),onClick:function(){return B(t)},children:[(0,I.jsx)(g.View,{className:"no",children:e.carriageNo}),e.carriageDesc&&(0,I.jsxs)(g.View,{className:"t",children:[e.carriageDesc," "]})]},t)})),(0,I.jsx)(g.View,{class:"padding-block"})]})}),(0,I.jsx)(g.View,{className:"addition-box".concat(p.selCarrIdx>-1?" active":""),children:(0,I.jsx)(g.View,{className:"tips-orage",children:p.rules.map((function(e,t){return(0,I.jsx)(g.View,{className:"item",children:(0,I.jsx)(g.RichText,{nodes:e})},t)}))})})]})]})})},F=_,O=n(74760),M={SuperMemberReturnChangeIns:"\u8d85\u7ea7\u4f1a\u5458\u5b89\u5fc3\u9000\u6539\u6743\u76ca",CtripNewCustomReturnIns:"\u65b0\u5ba2\u5b89\u5fc3\u9000\u6539\u6743\u76ca",CtripStudentCardReturnIns:"\u5b66\u751f\u5b89\u5fc3\u9000\u6539\u6743\u76ca"},z=function(e){var t=e.outerVisible,n=void 0!==t&&t,i=e.trainAppendProductList,a=void 0===i?[]:i,s=e.trainOtherProductList,o=void 0===s?[]:s,l=e.selectedPassengers,u=void 0===l?[]:l,d=e.returnChangeInsSelectInfo,p=void 0===d?{}:d,h=e.selectedOtherProduct,x=void 0===h?"":h,v=e.onChange,N=void 0===v?function(){}:v,j=(0,m.useState)(!1),k=(0,r.Z)(j,2),b=k[0],w=k[1],S=(0,m.useState)(!1),y=(0,r.Z)(S,2),P=y[0],C=y[1];function V(){var e=a.find((function(e){return"ReturnChangeIns"==e.productSubType}))||{},t=o.find((function(e){return"CtripReturnChangeIns"==e.rightsSpecialRealSubType}));if(!t)return N(e);var n=t.appendSubTitle.split("#AppendSubTitle#");t.selectedSubtitle=n[0],t.unselectedSubtitle=n[1],t.dataTitle=M[t.specialRealSubType]||"\u5b89\u5fc3\u9000\u6539\u6743\u76ca",w(!0),N((0,c.Z)((0,c.Z)({},e),{},{rightsInfo:t}))}function D(){var e=b&&!p.selectedReturnChangeIns,t=(0,c.Z)((0,c.Z)({},p),{},{selectedReturnChangeInsRight:e,selectedReturnChangeIns:!p.selectedReturnChangeIns});N(t)}function L(){var e=f().getCurrentPage();e.navigateTo({url:"/pages/trainActivity/twebview/index",data:{url:p.appendInfoUrl,needLogin:!0}})}return(0,m.useEffect)((function(){V()}),[a,o]),(0,m.useEffect)((function(){C(x&&"\u5b89\u5fc3\u9000\u6539"!==x&&"\u5b66\u751f\u7968"!==x&&"\u5728\u7ebf\u9009\u5ea7"!==x)}),[x]),(0,m.useEffect)((function(){var e,t=u.find((function(e){return e.passengerType===O.SS.STUDENT}));if("CtripStudentCardReturnIns"===(null===(e=p.rightsInfo)||void 0===e?void 0:e.specialRealSubType)){var n=(0,c.Z)((0,c.Z)({},p),{},{selectedReturnChangeInsRight:!!t&&p.selectedReturnChangeIns});w(!!t),N(n)}}),[u]),(0,I.jsx)(I.Fragment,{children:n&&p.appendTitle&&(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(g.View,{className:"white-box fold-box anxin-box fadeIn init".concat(p.selectedReturnChangeIns?" cur":"").concat(P?" fold":""),children:[(0,I.jsx)(Z,{visible:P,selectedOtherProduct:x,title:p.appendTitle}),(0,I.jsx)(g.View,{className:"slogan",children:"\u9000\u6539\u66f4\u5b89\u5fc3\uff0c\u51fa\u884c\u66f4\u653e\u5fc3"}),(0,I.jsxs)(g.View,{className:"anxin-bd",children:[(0,I.jsxs)(g.View,{className:"cont",children:[(0,I.jsxs)(g.View,{className:"tit",children:[(0,I.jsx)(g.View,{className:"tstrong",children:p.appendTitle}),(0,I.jsx)(g.Text,{className:"ifont-detail",onClick:L}),(0,I.jsx)(g.View,{className:"tag",children:p.appendTag})]}),(0,I.jsx)(g.View,{className:"txt",children:p.appendSubTitle})]}),(0,I.jsxs)(g.View,{className:"rbox",children:["\xa5",p.appendPrice,"/\u4efd"]}),(0,I.jsx)(g.Checkbox,{className:"checkbox",onClick:D,checked:p.selectedReturnChangeIns,disabled:!!T.Z.isBaiduApp})]}),p.rightsInfo&&b?(0,I.jsxs)(g.View,{class:"free-equity",onClick:D,children:[p.selectedEquity?p.rightsInfo.selectedSubtitle:p.rightsInfo.unselectedSubtitle,(0,I.jsx)(g.Checkbox,{className:"checkbox",checked:p.selectedReturnChangeInsRight,disabled:!!T.Z.isBaiduApp})]}):null]})})})},E=z,Y=n(48782),H=function(e){var t=e.returnChangeInsInfo,n=e.visible,i=void 0!==n&&n,a=e.onClickAccept,s=void 0===a?function(){}:a,r=e.onClickReject,c=void 0===r?function(){}:r;return(0,I.jsx)(I.Fragment,{children:t&&(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(Y.Z,{clickMaskClose:!0,visible:i,direction:"middle",children:(0,I.jsxs)(g.View,{className:"pop-anxin-wrap",children:[(0,I.jsx)(g.View,{className:"pop-anxin-hd"}),(0,I.jsxs)(g.View,{className:"pop-anxin-bd",children:[(0,I.jsx)(g.View,{className:"tit",children:"\u6dfb\u52a0\u5b89\u5fc3\u9000\u6539\u6743\u76ca"}),(0,I.jsx)(g.View,{className:"tips",children:"\u9000\u6539\u66f4\u5b89\u5fc3\uff0c\u51fa\u884c\u66f4\u653e\u5fc3"}),(0,I.jsx)(g.View,{className:"txt",children:"".concat(t.appendPrice,"\u5143/\u4efd\uff0c").concat(t.appendSubTitle)}),(0,I.jsxs)(g.View,{className:"btn-box",children:[(0,I.jsx)(g.Button,{className:"btn-cancel",onClick:c,"data-ubt-key":"train_axtg_poprefuse",children:"\u5426"}),(0,I.jsx)(g.Button,{className:"btn-submit",onClick:s,"data-ubt-key":"train_axtg_popaccept",children:"\u662f"})]})]})]})})})})},U=H,K=function(e){var t=e.packageList,n=void 0===t?[]:t,i=e.selectedPackage,a=void 0===i?{}:i,s=e.packagePopVisible,r=void 0!==s&&s,o=e.setPackagePopVisible,l=void 0===o?N.UH:o,u=e.onVendorIDChange,d=void 0===u?N.UH:u,m=e.onSelectedPackageChange,p=void 0===m?N.UH:m,h=e.login12306Name,x=void 0===h?"":h,v=n;x&&(v=n.filter((function(e){return"CtripEToPTicketProduct"!==e.specialRealSubType})));var j=v.map((function(e){var t="".concat(e.packageSubTitle).split("\n");return(0,c.Z)((0,c.Z)({},e),{},{ruleList:t})}));function T(e){p(n[e]),l(!1),0===n[e].packagePrice&&(N.ZP.showLoading(),d(O.h6.NORMAL))}function k(e){f().navigateTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(e))})}return(0,I.jsx)(Y.Z,{visible:r,clickMaskClose:!0,close:function(){return l(!1)},defaultZindex:1020,children:(0,I.jsxs)(g.View,{className:"pkg-list-box",children:[(0,I.jsxs)(g.View,{className:"package-hd pkg-list-hd",children:[(0,I.jsx)(g.Text,{className:"ifont-closed-line",onClick:function(){return l(!1)}}),(0,I.jsx)(g.View,{className:"tit",children:"\u5957\u9910\u9009\u62e9"})]}),(0,I.jsx)(g.View,{className:"package-list-bd",children:j.map((function(e,t){return(0,I.jsxs)(g.View,{className:"package-item".concat(a.packageID===e.packageID?" cur":""),onClick:function(){return T(t)},children:[(0,I.jsx)(g.View,{className:"r-gou"}),(0,I.jsxs)(g.View,{className:"item-hd",children:[(0,I.jsx)(g.View,{className:"tit",children:e.packageTitle}),e.packageInfoUrl&&(0,I.jsx)(g.Text,{className:"ifont-qus",onClick:function(t){t.stopPropagation(),t.preventDefault(),k(e.packageInfoUrl)}}),(0,I.jsxs)(g.View,{className:"rbox",children:["\uffe5",e.packagePrice||0,"/\u4eba"]})]}),e.ruleList.map((function(e,t){return(0,I.jsx)(g.View,{className:"rule",children:(0,I.jsx)(g.RichText,{nodes:e})},t)}))]},t)}))})]})})},G=K,q=function(){},W=S().classnames,X=function(e){var t=e.rescheduleTicketInfo,n=e.rescheduleCode,i=e.isAbroadRes,a=e.artiPasIndex,s=e.onChangeRescheduleTicketInfo,r=void 0===s?q:s,o=function(e){var i=(0,c.Z)({},t),a=i.passengerInfos,s=void 0===a?[]:a,o=i.arriveStation,l=i.departStation,u=s[e];if((o.includes("\u9999\u6e2f")||l.includes("\u9999\u6e2f"))&&s.find((function(t,n){return n!==e&&t.isSelected})))return N.ZP.showToast("\u6839\u636e\u94c1\u8def\u5c40\u89c4\u5b9a\uff0c\u5e7f\u6df1\u6e2f\u8de8\u5883\u5217\u8f66\u6539\u7b7e\u65f6\u6bcf\u4f4d\u4e58\u5ba2\u9700\u5355\u72ec\u64cd\u4f5c","none");1!==n&&u.realTicketInfo.enableChangeTicket&&(u.isSelected=!u.isSelected,r(i))},l=function(){var e=t.arriveStation,n=t.departStation,i=e.includes("\u9999\u6e2f")||n.includes("\u9999\u6e2f")?3:2,a="https://pages.ctrip.com/ztrip/document/ydxzctrip.html?__ares_maxage=3m&noticetype=".concat(i,"&r=393eeaa7-f574-42b0-b94d-376675b49fe5&from_native_page=1");f().navigateTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(a))})};return(0,I.jsxs)(g.View,{className:"book-bd",children:[(0,I.jsxs)(g.View,{className:"book-white add-pasg",children:[(0,I.jsx)(g.View,{className:"book-tips",children:i?"\u6bcf\u5f20\u7968\u53ea\u80fd\u6539\u7b7e\u4e00\u6b21\uff0c\u6539\u7b7e\u6210\u529f\u540e\u4e0d\u80fd\u9000\u7968":"\u6bcf\u5f20\u7968\u53ea\u80fd\u6539\u7b7e\u4e00\u6b21\uff0c\u6539\u7b7e\u6210\u529f\u540e\u7684\u8f66\u7968\u4e0d\u80fd\u518d\u6b21\u6539\u7b7e"}),t.passengerInfos.map((function(e,t){return(1!==n||1===n&&a===t)&&(0,I.jsxs)(g.View,{className:W("gaiqian-box",{disabled:!e.realTicketInfo.enableChangeTicket}),onClick:function(){return o(t)},children:[(0,I.jsx)(g.Text,{className:W("ifont-select",{selected:e.realTicketInfo.enableChangeTicket&&e.isSelected})}),(0,I.jsxs)(g.View,{className:"cont",children:[(0,I.jsxs)(g.View,{className:"name",children:[e.ticketPassengerName,(0,I.jsx)(g.Text,{className:"type",children:e.ticketTypeName})]}),(0,I.jsx)(g.View,{className:"cert",children:e.identityNo})]})]},t)}))]}),2===n&&(0,I.jsxs)(g.View,{className:"book-white add-pasg",children:[(0,I.jsxs)(g.View,{className:"book-resc",children:[(0,I.jsx)(g.Text,{className:"book-resc-arti-title",children:"\u8dd1\u817f\u6539\u7b7e\u8d39"}),(0,I.jsx)(g.Text,{className:"book-resc-arti-price",children:"\uffe515"})]}),(0,I.jsx)(g.View,{className:"book-resc-arti-desc",children:"\u6539\u7b7e\u5931\u8d25\u5c06\u9000\u8fd8\u8dd1\u817f\u8d39"})]}),(0,I.jsxs)(g.View,{className:"rescheduleInfo-box",children:[(0,I.jsx)(g.View,{children:"\u8bf7\u60a8\u5728\u6539\u7b7e\u524d\u4ed4\u7ec6\u9605\u8bfb"}),(0,I.jsx)(g.View,{className:"rescheduleInfo-link",onClick:l,children:"\u6539\u7b7e\u9884\u8ba2\u987b\u77e5"})]})]})},J=X,Q=n(35997),$=S().dayjs,ee=function(e){var t=e.train,n=void 0===t?{}:t,i=e.rescheduleInfo,r=void 0===i?{}:i,c=e.rescheduleTicketInfo,o=void 0===c?{}:c,l=e.selectDate,u=e.rescheduleCode,d=e.reschedulePrice,m=e.originPrice,p=function(){N.ZP.showModal({m:"\u60a8\u7684\u6539\u7b7e\u7533\u8bf7\u5df2\u63d0\u4ea4\uff0c\u8bf7\u5728\u7ea65\u5206\u949f\u540e\u67e5\u770b\u6539\u7b7e\u7ed3\u679c\u3002\u5982\u6709\u5dee\u989d\u9000\u6b3e\uff0c\u5c06\u57281~15\u4e2a\u5de5\u4f5c\u65e5\u9000\u56de\u81f3\u60a8\u7684\u539f\u652f\u4ed8\u8d26\u6237",confirmText:"\u77e5\u9053\u5566",done:function(){f().navigateBack({delta:2})}})},h=function(e){N.ZP.showModal({m:e&&e.message||"\u6539\u7b7e\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"})},x=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,i,s,c,d;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(v()){e.next=2;break}return e.abrupt("return");case 2:return t="".concat(l," ").concat(n.departTime),i="".concat($(l).add(n.takeDays,"day").format("YYYY-MM-DD")," ").concat(n.arriveTime),s={Channel:"WX",Orders:{OrderTicketId:o.changeOrderTicketId,OrderNumber:r.orderInfo.orderId,TrainNumber:n.trainNumber,DepartStationName:n.departStation,ArriveStationName:n.arriveStation,DepartTime:t,ArriveTime:i,TicketPrice:n.price,SeatName:n.seatName,AcceptSeatName:""},ReScheduleOrderRealTicketIdList:o.passengerInfos.filter((function(e){return e.isSelected})).map((function(e){return{OrderRealTicketId:e.realTicketInfo.orderRealTicketId}})),PartnerName:"Ctrip.Train",BookSourceID:1913,Operate:"",RescheduleCode:u},N.ZP.showLoading(),e.prev=6,e.next=9,(0,Q.t)(s);case 9:c=e.sent,0!==c.retCode?h(c):c.orderAmount>0?(d={oid:c.rescheduleOrderNumber},(0,N.td)({token:d},{sbackCallback:p,ebackCallback:h,rbackCallback:h})):p(),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](6),h();case 16:N.ZP.hideLoading();case 17:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=n.seatList.find((function(e){return e.seatName===n.seatName})),t=o.passengerInfos.filter((function(e){return e.isSelected}));if(!t.length)return N.ZP.showToast("\u8bf7\u9009\u62e9\u6539\u7b7e\u4e58\u5ba2","none"),!1;if(t.some((function(t){return 3==t.ticketType&&!(0,N.c6)([null===e||void 0===e?void 0:e.seatName])})))return N.ZP.showToast("\u5b66\u751f\u7968\u4ec5\u652f\u6301\u786c\u5ea7\u3001\u786c\u5367\u3001\u4e8c\u7b49\u5ea7\u3001\u65e0\u5ea7\u7b49\u5ea7\u5e2d\u4f18\u60e0\u3002\u5f53\u524d\u9009\u62e9\u4e86\u4e0d\u652f\u6301\u7684\u5ea7\u5e2d\uff0c\u8bf7\u8fd4\u56de\u4fee\u6539\u5ea7\u5e2d","none"),!1;var i=r.orderInfo.ticketInfos.some((function(e){return-1!==e.seatName.indexOf("\u5367")}));return!(i&&o.passengerInfos.filter((function(e){return e.isSelected})).length>1)||(N.ZP.showToast("\u5f88\u62b1\u6b49\uff0c\u5367\u94fa\u4e0d\u652f\u6301\u540c\u65f6\u591a\u4eba\u6539\u7b7e\uff0c\u8bf7\u5206\u5f00\u6539\u7b7e","none"),!1)};return(0,I.jsxs)(g.View,{children:[m<d&&(0,I.jsx)(g.View,{className:"botm-tips",children:"\u6539\u7b7e\u8f66\u6b21\u4e0e\u539f\u8f66\u6b21\u5b58\u5728\u5dee\u4ef7\uff0c\u6211\u4eec\u5c06\u5148\u6536\u53d6\u6539\u7b7e\u8f66\u6b21\u7684\u7968\u4ef7\uff0c\u6539\u7b7e\u6210\u529f\u540e\u9000\u8fd8\u5dee\u4ef7"}),m>d&&(0,I.jsx)(g.View,{className:"botm-tips",children:"\u9ad8\u4ef7\u66f4\u6539\u4f4e\u4ef7\u7968\uff0c\u5dee\u989d\u90e8\u5206\u6309\u7167\u73b0\u884c\u9000\u7968\u89c4\u5219\u6536\u53d6\u624b\u7eed\u8d39\uff0c\u5177\u4f53\u6536\u8d39\u660e\u7ec6\u8bf7\u67e5\u770b\u6539\u7b7e\u9884\u8ba2\u987b\u77e5"}),(0,I.jsxs)(g.View,{className:"botm-pay",children:[(0,I.jsxs)(g.View,{className:"lbox",children:["\u8ba2\u5355\u603b\u989d:",(0,I.jsxs)(g.Text,{className:"price",children:[(0,I.jsx)(g.Text,{className:"price-symbol",children:"\uffe5"}),d]})]}),(0,I.jsx)(g.Button,{className:"btn-submit",onClick:x,children:"\u6539\u7b7e"})]})]})},te=ee,ne=n(19908),ie=S().dayjs,ae=function(e){var t=e.visible,n=void 0!==t&&t,i=e.orderId,c=e.loadOrder,o=e.onClose,l=e.selectedPassengers,u=void 0===l?[]:l,d=(0,m.useContext)(j._),p=d.bookingStates,h=p.train,x=p.isTransit,v=p.trainTransferInfos,T=p.transtimestr,k=p.transferStation,b=p.costalltime,w=p.takeDays,S=(0,m.useState)(!1),y=(0,r.Z)(S,2),P=y[0],Z=y[1],C=(0,m.useState)(0),V=(0,r.Z)(C,2),D=V[0],L=V[1],B=(0,m.useState)(null),R=(0,r.Z)(B,2),A=R[0],_=R[1],F=(0,m.useState)(0),O=(0,r.Z)(F,2),M=O[0],z=O[1],E=(0,m.useRef)(null);function H(){z(1),E.current=setInterval((function(){return L((function(e){return e<99?e+1:(clearInterval(E.current),E.current=null,99)}))}),300*Math.random()+100),U()}function U(){return K.apply(this,arguments)}function K(){return K=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r,o,l,u,d;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return Z(!0),t=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,Q.nd)({userId:f().user.auth,orderNumber:i,pollingKey:(null===t||void 0===t?void 0:t.pollingKey)||""});case 2:if(n=e.sent,1!==n.retCode&&0!==n.retCode){e.next=5;break}return e.abrupt("return",n);case 5:return e.abrupt("return",{pollingFlag:!0,pollingRate:n.pollingRate,pollingKey:n.pollingKey});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=4,(0,N.nP)(t);case 4:if(n=e.sent,1!==n.retCode){e.next=12;break}return e.next=8,c();case 8:if(o=e.sent,11!==(null===o||void 0===o||null===(r=o.alertInfo)||void 0===r?void 0:r.alertType)){e.next=11;break}return e.abrupt("return",G());case 11:return e.abrupt("return",q());case 12:if(0!==n.retCode){e.next=25;break}return setTimeout((function(){L(99)}),500),e.next=16,c();case 16:if(u=e.sent,console.log(u,"orderRes"),d=(null===(l=u.extendList)||void 0===l||null===(l=l.find((function(e){return"SystemAutoAddNoSeat"===e.key})))||void 0===l?void 0:l.value)||"",!d||1!=d){e.next=22;break}return(0,N.GQ)(i,"",!1,!0),e.abrupt("return");case 22:N.ZP.showToast("\u6b63\u5728\u8df3\u8f6c\u5fae\u4fe1\u652f\u4ed8"),z(3),(0,N.rW)(u);case 25:case"end":return e.stop()}}),e)}))),K.apply(this,arguments)}function G(){var e=null,t=null;t=setInterval((0,s.Z)((0,a.Z)().mark((function n(){var i;return(0,a.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,c();case 2:i=n.sent,_(i),null!==i&&void 0!==i&&i.relationOrderInfo&&(clearInterval(t),clearTimeout(e),e=null,t=null,q());case 5:case"end":return n.stop()}}),n)}))),1e3),e=setTimeout((function(){clearInterval(t),t=null,q()}),15e3)}function q(){clearInterval(E.current),E.current=null,Z(!1),o(),(0,N.GQ)(i)}function W(){var e;return(0,I.jsx)(I.Fragment,{children:x?v.map((function(e,t){return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(g.View,{className:"tit-zz",children:["\u7b2c",t+1,"\u7a0b ",e.departDatemj+" "+e.trainNumber+" "+e.departTime+" - "+e.arriveTime]}),!A||M<3?(0,I.jsxs)(g.View,{className:"txt",children:[(0,I.jsx)(g.Text,{children:e.seatName}),M>=2?(0,I.jsx)(g.Icon,{className:"icon-ok"}):(0,I.jsx)(g.Icon,{className:"icon-loading"})]}):(0,I.jsxs)(g.View,{className:"txt",children:[A.ticketInfos[t].passengerInfos.map((function(e){return(0,I.jsx)(g.View,{children:e.realTicketInfo.dealSeatNo+" "})})),(0,I.jsx)(g.Icon,{className:"icon-ok"})]})]})})):(0,I.jsx)(I.Fragment,{children:!A||M<3?(0,I.jsxs)(g.View,{className:"txt",children:[(0,I.jsx)(g.Text,{children:h.seatName}),M>=2?(0,I.jsx)(g.Icon,{className:"icon-ok"}):(0,I.jsx)(g.Icon,{className:"icon-loading"})]}):(0,I.jsxs)(g.View,{className:"txt",children:[null===A||void 0===A||null===(e=A.ticketInfos)||void 0===e||null===(e=e[0])||void 0===e||null===(e=e.passengerInfos)||void 0===e?void 0:e.map((function(e){return e.realTicketInfo.dealSeatNo+" "})),(0,I.jsx)(g.Icon,{className:"icon-ok"})]})})})}return(0,m.useEffect)((function(){return n&&!P&&i&&H(),function(){return clearInterval(E.current)}}),[n,i]),(0,I.jsx)(Y.Z,{visible:n,direction:"middle",clickMaskClose:!0,close:q,children:(0,I.jsxs)(g.View,{className:"pop-mid active",children:[null!==A&&void 0!==A&&A.enablePayOrder?(0,I.jsxs)(g.View,{className:"qz-hd",children:[(0,I.jsx)(g.Icon,{className:"icon-suc"}),(0,I.jsx)(g.Text,{children:"\u5ea7\u4f4d\u9501\u5b9a\u6210\u529f\uff0c\u8bf7\u652f\u4ed8"})]}):(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(g.View,{className:"qz-hd",children:[(0,I.jsx)(g.Icon,{className:"icon-seat"}),(0,I.jsx)(g.Text,{children:"\u6b63\u5728\u4e3a\u60a8\u9501\u5b9a\u5ea7\u5e2d\u2026"}),D>0&&(0,I.jsxs)(g.View,{className:"fr",children:[D,"%"]})]})}),(0,I.jsxs)(g.View,{className:"qz-bd",children:[x?(0,I.jsxs)(g.View,{className:"qz-tick",children:[(0,I.jsxs)(g.View,{className:"from",children:[(0,I.jsx)(g.View,{className:"strong",children:v[0].departTime}),(0,I.jsxs)(g.Text,{className:"station",children:[v[0].departStation,"\u7ad9"]})]}),(0,I.jsxs)(g.View,{className:"zhongzhuan",children:[(0,I.jsxs)(g.View,{className:"txt",children:["\u6362\u4e58",T]}),(0,I.jsxs)(g.Text,{className:"station",children:[k,"\u7ad9"]}),(0,I.jsxs)(g.View,{className:"txt",children:["\u5168\u7a0b",b]})]}),(0,I.jsxs)(g.View,{className:"to",children:[(0,I.jsxs)(g.View,{className:"strong",children:[v[v.length-1].arriveTime,(0,I.jsx)(g.Text,{className:"small",style:"position:relative",children:w?"+"+w:""})]}),(0,I.jsxs)(g.Text,{className:"station",children:[v[v.length-1].arriveStation,"\u7ad9"]})]})]}):(0,I.jsxs)(g.View,{className:"qz-tick",children:[(0,I.jsxs)(g.View,{className:"from",children:[(0,I.jsx)(g.View,{className:"strong",children:h.showDepartTime||h.departTime||h.departureTime}),(0,I.jsxs)(g.Text,{className:"station",children:[h.departStation||h.departureStationName,"\u7ad9"]})]}),(0,I.jsxs)(g.View,{className:"mid",children:[(0,I.jsx)(g.View,{className:"date",children:ie(h.departTimeStamp).format("MM\u6708DD\u65e5")}),(0,I.jsx)(g.View,{className:"checi",children:h.trainNumber})]}),(0,I.jsxs)(g.View,{className:"to",children:[(0,I.jsxs)(g.View,{className:"strong",children:[h.showArriveTime||h.arriveTime||h.arrivalTime,(0,I.jsx)("text",{className:"small",style:"position:relative",children:h.takeDays?"+"+h.takeDays:""})]}),(0,I.jsxs)(g.Text,{className:"station",children:[h.arriveStation||h.arrivalStationName,"\u7ad9"]})]})]}),(0,I.jsxs)(g.View,{className:"qz-info",children:[(0,I.jsx)(g.View,{className:"tit",children:"\u4e58\u5ba2\u4fe1\u606f"}),(0,I.jsxs)(g.View,{className:"txt",children:[u.map((function(e,t){return(0,I.jsxs)(g.Text,{children:[e.pasName," "]},t)})),M>=1?(0,I.jsx)(g.Icon,{className:"icon-ok"}):(0,I.jsx)(g.Icon,{className:"icon-loading"})]}),(0,I.jsx)(g.View,{className:"tit",children:"\u5ea7\u5e2d\u4fe1\u606f"}),W()]})]}),(0,I.jsx)(g.Icon,{className:"ifont-closed",onClick:q})]})})},se=ae,re=n(6208),ce=function(e){var t,n=e.visible,i=void 0!==n&&n,a=e.alertInfo,s=e.orderBody,r=e.createOrder,o=e.onClose;function l(){var e=a.alertType;0===e&&(f().navigateTo({url:a.buttonList[1].jumpUrl}),N.ZP.ubtTrace("c_trn_c_10650026051",{bizKey:"tripConflictClick",type:1,clickType:0}),o()),3===e&&(r({orderBody:(0,c.Z)((0,c.Z)({},s),{},{confirmBookOrder:!0})}),N.ZP.ubtTrace("c_trn_c_10650026051",{bizKey:"tripConflictClick",type:0,clickType:1}),o()),4===e&&(N.ZP.ubtTrace("c_trn_c_10650026051",{bizKey:"tripConflictClick",type:1,clickType:0}),o())}function u(){var e=3===a.alertType?0:1;N.ZP.ubtTrace("c_trn_c_10650026053",{bizKey:"tripConflictClick",type:e,clickType:0}),o()}return(0,I.jsx)(Y.Z,{visible:i,direction:"middle",children:(0,I.jsxs)(g.View,{class:"pop-mid active order-alert",children:[(0,I.jsx)(g.View,{class:"order-alert-title",children:a.title}),(0,I.jsx)(g.View,{class:"order-alert-cont",children:a.content}),a.buttonList&&(0,I.jsx)(g.View,{class:"order-alert-btns",children:a.buttonList.length>1?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(g.View,{class:"btn cancel",onClick:u,children:a.buttonList[0].buttonName}),(0,I.jsx)(g.View,{class:"btn submit",onClick:l,children:a.buttonList[1].buttonName})]}):(0,I.jsx)(g.View,{class:"btn submit",onClick:u,children:null===(t=a.buttonList)||void 0===t?void 0:t[0].buttonName})})]})})},oe=ce,le=n(43972),ue=S().classnames,de=function(e){var t=e.linkList,n=e.insuranceDesc,i=e.singleRow,a=void 0!==i&&i,s=(0,m.useState)(a),c=(0,r.Z)(s,2),o=c[0],l=c[1];function u(e){e.link&&f().navigateTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(e.link+"&titleType=2"))})}if(!t||!n)return null;var d=n.split("#").map((function(e){var n=t.find((function(t){return t.key===e}));return n||{value:e}}));return(0,I.jsxs)(g.View,{className:ue({"single-box":o}),children:[(0,I.jsx)(g.View,{className:ue("ins-info-box",{"single-box-left":o}),children:d.map((function(e,t){return(0,I.jsx)(g.Text,{onClick:function(){return u(e)},className:ue({"info-link-txt":e.link}),children:e.value},t)}))}),o&&(0,I.jsxs)(g.View,{className:"detail-btn",onClick:function(){return l(!1)},children:["\u8be6\u60c5",(0,I.jsx)(g.Text,{className:"ifont-arr"})]})]})},me=de,pe=S().classnames,fe=S().trackFn,he="https://images3.c-ctrip.com/train/2021/app/V8.43/zhuliucheng/jiaotongyiwaixian/img-dagou.png",xe="https://images3.c-ctrip.com/train/2021/app/V8.43/zhuliucheng/jiaotongyiwaixian/img-aixin.png",ge=function(e){var t=e.isTransit,n=e.insProList,i=e.insExtendInfo,a=e.setSelectedInsInfo,s=e.selectedProIdx,c=e.setSelectedProIdx,o=(0,m.useState)({unSelectedIcon:"https://images3.c-ctrip.com/train/app/824/zlc/yqxsr.png",selectedIcon:"https://images3.c-ctrip.com/train/app/824/zlc/yqxsg.png",title:"\u75ab\u60c5\u671f\u95f4\uff0c\u63d0\u9192\u60a8\u51fa\u884c\u52a0\u5f3a\u9632\u62a4",uncheckedImg:"https://images3.c-ctrip.com/train/2021/app/V8.43/zhuliucheng/jiaotongyiwaixian/img-bg-default.png"}),l=(0,r.Z)(o,2),u=l[0],d=l[1],p=(0,m.useState)(!1),h=(0,r.Z)(p,2),x=h[0],v=h[1];function j(){f().navigateTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(n[0].appendInfoUrl+"&titleType=2"))})}function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=null===e||void 0===e?void 0:e.find((function(e){return e.key===t}));return(null===n||void 0===n?void 0:n.value)||""}function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.appendSubTitle.split("<br/>")||[]}function b(e,t){a(t?e:{}),v(!0),c(t)}function w(e){return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(g.View,{className:"tag-arrow",style:{borderBottomColor:"".concat(T(e.extendList,"AppendMarkColor"))}}),(0,I.jsx)(g.View,{className:"tag-text-wrapper",style:{backgroundColor:"".concat(T(e.extendList,"AppendMarkColor"))},children:(0,I.jsx)(g.Text,{className:"tag-text",children:T(e.extendList,"AppendMark")})})]})}function S(){var e=n.length;return(0,I.jsx)(g.View,{className:"ins-body-box",children:[O.Ou].concat((0,D.Z)(n)).map((function(t,n){return(0,I.jsxs)(g.View,{className:pe("ins-body-box-view","ins-interval",{"ins-interval-right":n===e,"ins-interval-left":!n},{"two-pros-second":2===e&&n}),children:[(0,I.jsxs)(g.View,{className:pe("ins-body-item",{"body-color":n===s,adjust:!n}),onClick:function(){return b(t,n)},children:[(0,I.jsx)(g.Image,{className:"ins-icon-outer",src:t.appendIcon}),(0,I.jsx)(g.Image,{className:pe("ins-icon-inner",{"tag-scale":n===s}),src:n===s?he:xe}),(0,I.jsx)(g.Text,{className:"append-title",children:T(t.extendList,"AppendTitle")}),(0,I.jsx)(g.Text,{className:"append-right-title",children:t.appendRightTitle}),(0,I.jsx)(g.View,{className:"ins-body-line"}),t.appendSubTitle?(0,I.jsx)(g.View,{className:"append-sub-title",children:k(t).map((function(e,t){return(0,I.jsx)(g.RichText,{className:"append-sub-txt",nodes:e},t)}))}):(0,I.jsx)(g.Text,{className:"ifont-closed-line"}),s===n?(0,I.jsx)(g.Image,{className:"check-icon",src:"https://images3.c-ctrip.com/train/2022/app/8.58/xiaochengxu/baoxian/img-xuanzhong.png"}):(0,I.jsx)(g.Image,{className:"check-icon",src:"https://images3.c-ctrip.com/train/2022/app/8.58/xiaochengxu/baoxian/img-weixuan.png"})]}),1===n&&!x&&(0,I.jsx)(g.View,{className:"tag-view tag-loop",children:w(t)}),s===n&&x&&(0,I.jsx)(g.View,{className:"tag-view tag-scale",children:w(t)})]},n)}))})}return(0,m.useEffect)((function(){var e=i.topMessageList,t=null===e||void 0===e?void 0:e.find((function(e){return 1===e.type})),a=null===t||void 0===t?void 0:t.iconUrl,s=null===t||void 0===t?void 0:t.title;if(a&&s&&d({unSelectedIcon:a.split("#IconUrl#")[0],selectedIcon:a.split("#IconUrl#")[1],title:s}),!x){var r=n.findIndex((function(e){return e.isDefault}))+1;c(r)}}),[i,n]),t||0===n.length?null:(0,I.jsxs)(g.View,{className:"add-box ins-box",children:[N.ZP.ubtTrace("TCWBuyFill_InsuranceModule_exposure",{PageId:"10650084622",ProductIds:n.map((function(e){return e.appendID}))}),(0,I.jsx)(g.View,{className:pe("header-box",{"unselected-header":!s}),children:(0,I.jsx)(g.Text,{className:"header-tit",children:u.title})}),(0,I.jsxs)(g.View,{className:"ins-body",children:[(0,I.jsxs)(g.View,{className:"ins-body-tit",children:[(0,I.jsx)(g.Text,{className:"main-tit",children:n[0].appendTitle}),(0,I.jsx)(g.Text,{className:"ins-intro",onClick:fe("ordinaryBookingClickJumpToDesc",j),children:"\u6295\u4fdd\u987b\u77e5"}),s>0&&(0,I.jsx)(g.View,{className:"tag",children:n[0].appendTag})]}),S()]}),(0,I.jsxs)(g.View,{className:"ins-info-box-view",children:[(0,I.jsx)(g.View,{className:"ins-body-line line-top"}),(0,I.jsx)(me,{linkList:i.linkList,insuranceDesc:i[s?"insuranceDesc":"defaultInsuranceDesc"]})]}),i.slogan&&(0,I.jsx)(g.View,{className:"ins-slogan-view",children:(0,I.jsx)(g.Image,{src:i.slogan,className:"ins-slogan"})})]})},ve=ge,Ne=n(27653),je=n(71280),Te=n(72201),ke=n(19008),be=S().dayjs,we=S().classnames,Se=function(e){var t=e.trainTransferInfos,n=e.index,i=(0,m.useMemo)((function(){var e=t[n],i=(0,N.DR)(e.seatName,e.seatList);return{transferItem:e,transferSeat:i}}),[t,n]),a=i.transferItem,s=i.transferSeat;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(g.View,{className:"tag",children:[n+1,"\u7a0b"]}),(0,I.jsx)(g.View,{className:"date zhongzhuan-date",children:a.departDatemj}),(0,I.jsxs)(g.View,{className:"station",children:[a.departStation,(0,I.jsx)(g.Text,{className:"ifont-zhida"}),a.arriveStation]}),(0,I.jsx)(g.View,{className:"time zhongzhuan-seat",children:a.seatName}),0==(null===s||void 0===s?void 0:s.seatInventory)&&(0,I.jsx)(g.View,{className:"rob-tag",children:"\u62a2\u7968"})]})},ye=function(e){var t=e.pkg,n=void 0===t?{}:t,i=e.login12306Name,a=e.display12306Name,s=e.onLogin12306Pkg,r=e.onLogin12306Cancel,c=e.onLogin12306Success,o=e.isNewGuest,l=e.statusBarHeight,u=e.trainInfo,d=e.trainTransferInfos,m=e.isTransit,p=e.isCombiSeat,f=e.isThenByTrainTicket,h=e.takeDays,v=e.middleTips,j=e.middleTipList,T=e.orderTicketType,k=e.selectDate,b=e.setSpreadTrainCard,w=e.login12306Ref,S=e.selectedPackage,y=e.isReschedule,P=e.selectedPassengers,Z=e.vendorID,C=e.setPackagePopVisible,V=void 0===C?N.UH:C,D=u.arriveStation,L=u.departStation,B=u.seatName,R=u.price,A=u.departTime,_=function(){N.ZP.ubtTrace("c_trn_c_10650084622",{bizKey:"choosePackage"}),V(!0)},F=function(){var e=be(d[0].departTimeStamp).format("M\u6708D\u65e5");return(0,I.jsxs)(g.View,{className:"combi-tit-box flex-row",children:[(0,I.jsx)(g.View,{className:"change",children:"\u8f66\u5185\u6362\u5ea7"}),(0,I.jsx)(g.Image,{src:"https://images3.c-ctrip.com/train/2022/app/8.58/zhuliucheng/chaonengli/logo/img-znfa-cnl.png",className:"cnl-img"}),(0,I.jsx)(g.View,{className:"flex-row inner-tit",children:(0,I.jsxs)(g.Text,{className:"inner-txt",children:[e," ",d[0].trainNumber," \u7ec4\u5408\u5ea7 \xa5",d[0].price+d[1].price]})})]})},O=function(e){e&&x().navigateTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(e))})},M=function(e,t,n){var i="https://m.ctrip.com/webapp/train/activity/ctrip-train-timetable?fromStation=".concat(e,"&toStation=").concat(t,"&date=").concat(k,"&TrainNumber=").concat(n);x().navigateTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(i))})},z=function(){var e=u.thenByTicketInfo;if(e){var t=function(){console.log("1234567",u,e);var t={},n={},i=e.recommendDepartStation,a=e.recommendArriveStation,s=e.solutionType,r=e.crossType,c=e.originInfo,o=e.reminderContentList,l=c.originArriveStation,d=c.originDepartStation;return t.tip="\u8d2d\u4e70".concat(i,"-").concat(a),2===s&&"FRONT"==r?(t.tip+="\uff0c\u5168\u7a0b\u591a\u82b1\u7ea6<span style='color:#2582f5;font-weight: 500;'>".concat(u.diffPrice,"\u5143</span>"),n.tip="\u60a8\u53ef\u6301\u7968\u5728<span style='color:#2582f5;font-weight: 500;'>".concat(d,"\u4e0a\u8f66</span>")):2===s&&"BACK"==r?(t.tip+="\uff0c\u5168\u7a0b\u591a\u82b1\u7ea6<span style='color:#2582f5;font-weight: 500;'>".concat(u.diffPrice,"\u5143</span>"),n.tip="\u60a8\u53ef\u6301\u7968\u5728<span style='color:#2582f5;font-weight: 500;'>".concat(l,"\u4e0b\u8f66</span>")):(n.tip="\u4e0a\u8f66\u540e\u9700\u627e\u5217\u8f66\u5458\u60a8\u8865\u7968\u81f3<span style='color:#2582f5;font-weight: 500;'>".concat(l,'</span>\uff0c\u672a\u8865\u7968\u5f3a\u884c\u8d8a\u7ad9\u4e58\u8f66\uff0c\u60a8\u9700\u81ea\u884c\u627f\u62c5\u5168\u90e8\u6cd5\u5f8b\u8d23\u4efb <span style="font-size:24rpx;color: #5678A8;" id="thenByDetail">\u67e5\u770b\u8be6\u60c5<span>'),n.tip='\u4e0a\u8f66\u5fc5\u987b\u8865\u7968\uff0c\u8bf7\u9075\u5b88\u94c1\u8def\u653f\u7b56\u670d\u4ece\u5217\u8f66\u5458\u5b89\u6392\uff01<span style=\'color:#ff7700;\'>\u5229\u7528\u201c\u4e70\u77ed\u4e58\u957f\u201d\u6076\u610f\u9003\u7968\u5c5e\u8fdd\u6cd5\u884c\u4e3a</span>\uff0c\u60c5\u8282\u4e25\u91cd\u9700\u627f\u62c5\u6cd5\u5f8b\u8d23\u4efb <span style="font-size:24rpx;color: #5678A8;" id="thenByDetail">\u67e5\u770b\u8be6\u60c5<span>',n.url="https://m.ctrip.com/webapp/train/activity/orderservice/InsuranceDetail.aspx?ProductID=5433&terminal=1"),o||[t,n]};return(0,I.jsxs)(g.View,{children:[(0,I.jsxs)(g.View,{className:"combi-tit-box flex-row",children:[(0,I.jsxs)(g.View,{className:"change",children:[" ",e.superTag]}),(0,I.jsx)(g.Image,{src:"https://images3.c-ctrip.com/train/2022/app/8.58/zhuliucheng/chaonengli/logo/img-znfa-cnl.png",className:"cnl-img"}),(0,I.jsx)(g.View,{className:"flex-row inner-tit",children:(0,I.jsxs)(g.Text,{className:"inner-txt",children:[e.dDateTag," ",e.trainNum," ",u.seatName," \xa5",e.price]})})]}),(0,I.jsxs)(g.View,{className:"then-by-ticket-info",children:[e.hasTakeDays&&(0,I.jsx)(g.View,{class:"then-by combi-info-time combi-info-day",children:e.ticketList.map((function(e,t){return(0,I.jsx)(g.Text,{className:"".concat(e.showDate?"":"hidden"," ").concat(e.isReal?"":"grey"),children:e.showDate?e.showDate:"0\u67080\u65e5"},t)}))}),(0,I.jsx)(g.View,{class:"combi-info-time",children:e.ticketList.map((function(e,t){return(0,I.jsx)(g.Text,{className:"".concat(e.isReal?"":"grey"),children:e.time},t)}))}),(0,I.jsxs)(g.View,{className:"journey-line then-by",children:[e.ticketList.map((function(e,t){return(0,I.jsx)(g.Text,{className:"journey ".concat(e.tag?"":"hidden"),children:e.tag},t)})),(0,I.jsxs)(g.View,{className:"journey-btm-line-box",children:[(0,I.jsx)(g.View,{className:"".concat("FRONT"===e.crossType?"dashed":"solid")}),(0,I.jsx)(g.View,{className:"".concat("BACK"===e.crossType?"dashed":"solid")})]}),(0,I.jsx)(g.View,{className:"journey-btm-dot",children:e.ticketList.map((function(e,t){return(0,I.jsx)(g.View,{className:"dot"},t)}))}),(0,I.jsxs)(g.View,{className:"journey-line-tag",children:["BACK"===e.crossType&&1===e.actionType?(0,I.jsx)(g.View,{className:"solu-tag front youpiao",children:"\u6709\u7968"}):(0,I.jsx)(g.View,{className:"solu-tag ".concat("BACK"===e.crossType?"hidden":"front"),children:e.tag}),(0,I.jsx)(g.View,{className:"solu-tag ".concat("FRONT"===e.crossType?"hidden":""," ").concat(1===e.solutionType?"bupiao":"kuazhan"),children:e.tag})]})]}),(0,I.jsx)(g.View,{class:"combi-info-time then-by-station-info",children:e.ticketList.map((function(e,t){return(0,I.jsx)(g.Text,{className:"".concat(e.isReal?"":"grey"),children:e.name},t)}))})]}),(0,I.jsxs)(g.View,{className:"remark-box",children:[(0,I.jsx)(g.View,{className:"remark-left",children:t().map((function(e,t){return(0,I.jsx)(g.View,{className:"remark-info then-by",onClick:function(){return O(e.url)},children:(0,I.jsx)(g.RichText,{className:"remark-tip",nodes:e.tip})},t)}))}),(0,I.jsx)(g.View,{className:"remark-right",onClick:function(){return M(e.originInfo.originDepartStation,e.originInfo.originArriveStation,e.trainNum)},children:(0,I.jsx)(g.Text,{children:"\u7ecf\u505c\u4fe1\u606f"})})]})]})}},E=function(){var e=be(d[1].arriveTimeStamp).format("M\u6708D\u65e5"),t=be(d[0].arriveTimeStamp).format("M\u6708D\u65e5"),n=be(d[0].departTimeStamp).format("M\u6708D\u65e5");return(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(g.View,{className:"combi-info-box",children:[0!==h&&(0,I.jsxs)(g.View,{className:"combi-info-time combi-info-day",children:[(0,I.jsx)(g.Text,{className:"hide",children:n}),(0,I.jsx)(g.Text,{className:we("middle-time",{hide:t===n}),children:t}),(0,I.jsx)(g.Text,{children:e})]}),(0,I.jsxs)(g.View,{className:"combi-info-time",children:[(0,I.jsx)(g.Text,{children:d[0].departTime}),(0,I.jsx)(g.Text,{className:"middle-time",children:d[0].arriveTime}),(0,I.jsx)(g.Text,{children:d[1].arriveTime})]}),(0,I.jsxs)(g.View,{className:"journey-line",children:[(0,I.jsxs)(g.View,{className:"journey",children:["\u7b2c1\u7a0b ",d[0].seatName]}),(0,I.jsx)(g.View,{className:"journey journey-two",children:"\u8f66\u5185\u6362\u5ea7"}),(0,I.jsxs)(g.View,{className:"journey",children:["\u7b2c2\u7a0b ",d[1].seatName]}),(0,I.jsx)(g.View,{className:"journey-circle journey-circle-one"}),(0,I.jsx)(g.View,{className:"journey-circle journey-circle-two"}),(0,I.jsx)(g.View,{className:"journey-btm-line"})]}),(0,I.jsxs)(g.View,{className:"combi-info-time station-info",children:[(0,I.jsx)(g.Text,{children:d[0].departStation}),(0,I.jsx)(g.Text,{className:"middle-time",children:d[0].arriveStation}),(0,I.jsx)(g.Text,{children:d[1].arriveStation})]})]})})};return(0,I.jsxs)(g.View,{className:"top-box",style:"margin-top:"+(l+40)+"px",children:[m&&p&&F(),f&&z(),!f&&(0,I.jsxs)(g.View,{className:"top-ticket",children:[m?p?null:(0,I.jsxs)(g.View,{children:[(0,I.jsxs)(g.View,{className:"hd",children:[(0,I.jsx)(Se,{index:0,trainTransferInfos:d}),(0,I.jsxs)(g.View,{className:"rbox",onClick:function(){return b(!0)},children:["\u8be6\u60c5",(0,I.jsx)(g.Text,{className:"ifont-arr"})]})]}),(0,I.jsx)(g.View,{className:"hd",children:(0,I.jsx)(Se,{index:1,trainTransferInfos:d})})]}):(0,I.jsxs)(g.View,{className:"hd",children:[(0,I.jsx)(g.View,{className:"tag",children:"\u5355\u7a0b"}),(0,I.jsxs)(g.View,{className:"station",children:[L,(0,I.jsx)(g.Text,{className:"ifont-zhida"}),D]}),(0,I.jsx)(g.View,{className:"date",children:be(k).format("MM-DD")}),(0,I.jsx)(g.View,{className:"time",children:A}),(0,I.jsxs)(g.View,{className:"rbox",onClick:function(){return b(!0)},children:["\u8be6\u60c5",(0,I.jsx)(g.Text,{className:"ifont-arr"})]})]}),(0,I.jsx)(g.View,{className:"bd",children:m?p?null:(0,I.jsxs)(g.View,{className:"item",children:["\u8f66\u7968\u603b\u4ef7 \xa5",d[0].price+d[1].price]}):S.packagePrice?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(g.View,{className:"item ticket-info-View",onClick:_,children:["".concat(B," \xa5").concat(R," | ").concat(S.packageTitle,"\xa5").concat(S.packagePrice,"X").concat(P.length),(0,I.jsx)(g.Image,{className:"jump-arr",src:"https://images3.c-ctrip.com/train/2022/app/8.54/zhuliucheng/taocanxuanze/ic-hs.png"})]}),N.ZP.ubtTrace("s_trn_c_trace_10650084622",{exposureType:"normal",bizKey:"packageSelectionExposure",vendorId:Z})]}):(0,I.jsxs)(g.View,{className:"item",children:[" ","".concat(B," \xa5").concat(R)]})}),m&&p&&E()]}),m&&(null===j||void 0===j?void 0:j.length)>0&&4===T&&(0,I.jsx)(g.View,{className:"top-tips",children:j.map((function(e,t){return(0,I.jsx)(g.RichText,{className:"txt",nodes:e.tip},t)}))}),v&&(0,I.jsx)(g.View,{className:"top-tips",children:(0,I.jsx)(g.RichText,{className:"txt",nodes:v})}),!y&&(0,I.jsx)(ke.Z,{isOrdinary:!0,pkg:n,isTransit:m,isNewGuest:o,login12306Name:i,display12306Name:a,onLogin12306Pkg:s,onLogin12306Cancel:r,onLogin12306Success:c,login12306Ref:w})]})},Ie=ye,Pe=S().dayjs,Ze=["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"];function Ce(e){var t=e.index,n=e.trainTransferInfos,i=(0,m.useMemo)((function(){var e=n[t],i=(0,N.DR)(e.seatName,e.seatList);return{trainTransferInfo:e,transferSeat:i}}),[n,t]),a=i.trainTransferInfo,s=i.transferSeat;return(0,I.jsxs)(g.View,{className:"pop-ticket-zhongzhuan",children:[(0,I.jsxs)(g.View,{className:"pop-ticket-hd",children:[(0,I.jsxs)(g.View,{className:"tag",children:[t+1,"\u7a0b"]}),(0,I.jsxs)(g.View,{className:"zhongzhuan-subtitle",children:[a.departDatemj," ",Ze[Pe(a.departDateymj).day()]," \u51fa\u53d1"]}),(0,I.jsx)(g.View,{className:"flex-1"}),0==(null===s||void 0===s?void 0:s.seatInventory)&&(0,I.jsx)(g.View,{className:"rob-tag",children:"\u62a2\u7968"}),(0,I.jsxs)(g.View,{className:"rbox zhongzhuan-rbox",children:[a.seatName," \xa5",a.price]})]}),(0,I.jsxs)(g.View,{className:"flex-row pop-ticket-hd-zhongzhuan",children:[(0,I.jsxs)(g.View,{className:"from",children:[(0,I.jsx)(g.View,{className:"time",children:a.departTime}),(0,I.jsxs)(g.View,{className:"station",children:[a.departStation,"\u7ad9"]})]}),(0,I.jsxs)(g.View,{className:"mid transit-mid",children:[(0,I.jsx)(g.View,{className:"checi",children:a.runTimeHM}),(0,I.jsx)(g.View,{className:"jingting-zhongzhuan"}),(0,I.jsx)(g.View,{className:"checi",children:a.trainNumber})]}),(0,I.jsxs)(g.View,{className:"to",children:[(0,I.jsxs)(g.View,{className:"time",children:[a.arriveTime,a.takeDays>0&&(0,I.jsxs)(g.Text,{className:"jiayi",children:["+",a.takeDays,"\u5929"]})]}),(0,I.jsxs)(g.View,{className:"station",children:[a.arriveStation,"\u7ad9"]})]})]})]})}var Ve=function(e){var t=e.statusBarHeight,n=e.trainInfo,i=e.selectDate,c=e.spreadTrainCard,o=e.setSpreadTrainCard,l=e.trainTransferInfos,u=e.isTransit,d=e.selectedPackage,p=e.setPackagePopVisible,h=e.selectedPassengers,x=e.needGrabBuy,v=n.arriveStation,j=n.departStation,T=n.arriveTime,k=n.departTime,b=n.seatName,w=n.price,S=n.trainNumber,y=n.timesCost,P=n.takeDays,Z=n.timeZoneFlag,C=n.showDepartTime,V=n.showArriveTime,D=n.localStartDate,L=n.localArriveDate,B=(0,m.useState)({}),R=(0,r.Z)(B,2),A=R[0],_=R[1],F="",O="",M="";if(u){F=l[0].arriveStation===l[1].departStation?"\u540c\u7ad9\u6362\u4e58":"\u5f02\u7ad9\u6362\u4e58";var z=l[0].arriveDateymj+" "+l[0].arriveTime,E=l[1].departDateymj+" "+l[1].departTime,Y=Pe(E).diff(Pe(z),"minute");O=N.ZP.costTimeString(Y),M=N.ZP.costTimeString(parseInt(l[0].runTime+l[1].runTime+Y))}function H(){return U.apply(this,arguments)}function U(){return U=(0,s.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={Channel:"wx",DepartDateTime:Pe("".concat(i," ").concat(k)).format("YYYYMMDDHHmmss"),TrainNumber:S},e.next=3,(0,N.ZT)(t);case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0={};case 6:n=e.t0,_(n);case 8:case"end":return e.stop()}}),e)}))),U.apply(this,arguments)}function K(){var e="https://m.ctrip.com/webapp/train/activity/ctrip-train-timetable?fromStation=".concat(j,"&toStation=").concat(v,"&date=").concat(i,"&TrainNumber=").concat(S);f().navigateTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(e))})}function G(){f().navigateTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(A.url))})}function q(){N.ZP.ubtTrace("c_trn_c_10650084622",{bizKey:"choosePackage"}),p(!0)}return(0,m.useEffect)((function(){c&&N.ZP.ubtTrace("TCWBuyFill_TransitDetail_exposure",{scmType:x?2:1})}),[n,c,x]),(0,m.useEffect)((function(){H()}),[n]),(0,I.jsxs)(g.View,{style:"top:"+(t+52)+"px;",className:"pop-ticket ".concat(c?"":"pop-ticket-hide"," ").concat(u?"transit-pop-ticket":""),children:[u?(0,I.jsxs)(g.View,{className:"pop-ticket-hd ".concat(c?"":"pop-ticket-hd-hide"," transit-pop-ticket-hd"),children:[(0,I.jsxs)(g.View,{className:"zhongzhuan-title",children:[l[0].departStation," -"," ",l[1].arriveStation]}),(0,I.jsxs)(g.View,{className:"rbox zhongzhuan-rbox",children:["\u5168\u7a0b\u8017\u65f6",M]})]}):(0,I.jsxs)(g.View,{className:"pop-ticket-hd ".concat(c?"":"pop-ticket-hd-hide"),children:[(0,I.jsx)(g.View,{className:"tag",children:"\u5355\u7a0b"}),(0,I.jsxs)(g.View,{className:"time",children:[Pe(i).format("MM-DD")," ",Ze[Pe(i).day()]," \u51fa\u53d1"]}),(0,I.jsxs)(g.View,{className:"rbox",children:["\u5168\u7a0b\u8017\u65f6",y]})]}),u?(0,I.jsxs)(g.View,{className:"pop-ticket-bd ".concat(c?"":"pop-ticket-bd-hide"," ").concat(u?"pop-ticket-bd-zhongzhuan-view":""),children:[(0,I.jsx)(Ce,{index:0,trainTransferInfos:l}),(0,I.jsx)(g.View,{children:(0,I.jsxs)(g.View,{className:"huancheng-tip-view",children:[(0,I.jsx)(g.View,{className:"huancheng-line"}),(0,I.jsx)(g.View,{className:"huancheng-tip-outer",children:(0,I.jsxs)(g.Text,{className:"huancheng-tip",children:[F,"\xb7\u6362\u4e58\u65f6\u957f",O]})})]})}),(0,I.jsx)(Ce,{index:1,trainTransferInfos:l})]}):(0,I.jsxs)(g.View,{className:"pop-ticket-bd ".concat(c?"":"pop-ticket-bd-hide"),children:[(0,I.jsxs)(g.View,{className:"from",children:[Z>0?(0,I.jsxs)(g.View,{className:"local-title",children:[(0,I.jsx)(g.Text,{className:1===Z?"orange":"",children:1===Z?"\u5f53\u5730\u65f6\u95f4":"\u5317\u4eac\u65f6\u95f4"}),D?(0,I.jsx)(g.Text,{children:D}):null]}):null,(0,I.jsx)(g.View,{className:"time",children:C||k}),(0,I.jsxs)(g.View,{className:"station",children:[j,"\u7ad9"]})]}),(0,I.jsxs)(g.View,{className:"mid",children:[(0,I.jsx)(g.View,{className:"checi",children:S}),A.url&&A.value&&(0,I.jsxs)(g.View,{className:"chexing",onClick:G,children:[A.value,(0,I.jsx)(g.Text,{className:"ifont-arr"})]}),(0,I.jsx)(g.View,{className:"jingting",onClick:K,children:"\u7ecf\u505c\u4fe1\u606f"})]}),(0,I.jsxs)(g.View,{className:"to",children:[Z>0?(0,I.jsxs)(g.View,{className:"local-title",children:[(0,I.jsx)(g.Text,{className:2===Z?"orange":"",children:2===Z?"\u5f53\u5730\u65f6\u95f4":"\u5317\u4eac\u65f6\u95f4"}),L?(0,I.jsx)(g.Text,{children:L}):null]}):null,(0,I.jsxs)(g.View,{className:"time",children:[V||T,P>0&&(0,I.jsxs)(g.Text,{className:"jiayi",children:["+",P,"\u5929"]})]}),(0,I.jsxs)(g.View,{className:"station",children:[v,"\u7ad9"]})]})]}),(0,I.jsxs)(g.View,{className:"pop-ticket-botm ".concat(c?"":"pop-ticket-botm-hide"," ").concat(u?"rbox-zhongzhuan":""),children:[u?(0,I.jsxs)(g.View,{className:"seat",children:["\u8f66\u7968 \xa5",l[0].price+l[1].price]}):d.packagePrice?(0,I.jsxs)(g.View,{className:"item",onClick:q,children:[" ","".concat(b," \xa5").concat(w," | ").concat(d.packageTitle,"\xa5").concat(d.packagePrice,"X").concat(h.length),(0,I.jsx)(g.Image,{className:"jump-arr",src:"https://images3.c-ctrip.com/train/2022/app/8.54/zhuliucheng/taocanxuanze/ic-hs.png"})]}):(0,I.jsx)(g.View,{className:"seat",children:"".concat(b," \xa5").concat(w)}),(0,I.jsxs)(g.View,{className:"rbox",onClick:function(){return o(!1)},children:["\u6536\u8d77",(0,I.jsx)(g.Text,{className:"ifont-arr"})]})]})]})},De=Ve,Le=function(e){var t=e.data,n=e.visible,i=e.isTransit,a=e.defaultPackage,s=e.done,c=e.close,o=(0,m.useState)([]),l=(0,r.Z)(o,2),u=l[0],d=l[1],p=function(){var e="".concat(a.packagePrice,"\u5143").concat(i?"x2":"","/\u4eba");d(["".concat(e," ").concat(t.rules[0]),t.rules.slice(1)])};return(0,m.useEffect)((function(){(null===t||void 0===t?void 0:t.isOpen)&&a&&p()}),[a,t]),(0,I.jsx)(I.Fragment,{children:(null===t||void 0===t?void 0:t.isOpen)&&(0,I.jsx)(Y.Z,{visible:n,direction:"middle",clickMaskClose:!0,close:c,children:(0,I.jsxs)(g.View,{className:"transfer-pop",children:[(0,I.jsx)(g.Image,{className:"bg",src:t.banner}),(0,I.jsxs)(g.View,{className:"cont",children:[(0,I.jsx)(g.Image,{className:"tit",src:t.title}),(0,I.jsxs)(g.View,{className:"det",children:[(0,I.jsx)(g.Image,{src:"https://images3.c-ctrip.com/train/2021/xiaochengxu/V8.44/youxiang_bule_2@3x.png"}),(0,I.jsx)(g.View,{className:"desc",children:u.map((function(e,t){return(0,I.jsxs)(g.View,{className:"item",children:[(0,I.jsx)(g.View,{className:"ico"}),(0,I.jsx)(g.Text,{children:e})]},t)}))})]}),(0,I.jsxs)(g.View,{className:"btns",children:[(0,I.jsx)(g.Button,{className:"btn cancel",onClick:c,children:"\u5426"}),(0,I.jsx)(g.Button,{className:"btn done",onClick:s,children:"\u662f"})]})]})]})})})},Be=Le,Re=S().dayjs,Ae="https://images3.c-ctrip.com/train/2022/app/8.55/zhuliucheng/baoxiantianxieyefuceng/pic_moren.png",_e=function(e){var t,n,i=e.insAlertExtendInfo,a=e.insPopVisible,s=e.selectedPassengers,o=e.train,l=e.insProList,u=e.onClickNormalBooking,d=(0,m.useState)({}),p=(0,r.Z)(d,2),h=p[0],x=p[1],v=(0,m.useState)(0),j=(0,r.Z)(v,2),T=j[0],k=j[1];function b(e,t,n,i){var a,s;return e?(null===t||void 0===t||null===(s=t.find((function(e){return e.type===n})))||void 0===s?void 0:s.url)||i:(null===t||void 0===t||null===(a=t.find((function(e){return e.type===n})))||void 0===a?void 0:a.subTitle)||""}function w(){f().navigateTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(l[0].appendInfoUrl+"&titleType=2"))})}function S(e){N.ZP.ubtTrace("TCWBuyFill_InsurancePopup_click",{PageId:"10650084622",ProductId:T,Name:h.title,Tag:h.subTitle,clickType:e}),u(!0,1===e)}return(0,m.useEffect)((function(){var e=i.topImgList,t=void 0===e?[]:e,n=i.subTitleList,a=void 0===n?[]:n,r=s.filter((function(e){return 2==e.passengerType})).length>0,u="",d="",m=s.filter((function(e){return e.birthday&&1*e.birthday.substr(0,4)+54<=parseInt(Re().format("YYYY"))})).length>0;r||m?(u=b(!0,t,"laoyou",Ae),d=b(!1,a,"laoyou")):o.runTime>240?(u=b(!0,t,"changtu",Ae),d=b(!1,a,"changtu")):(u=b(!0,t,"moren",Ae),d=b(!1,a,"moren")),x((0,c.Z)((0,c.Z)({},i),{},{topImg:u,subTitle:d}));var p,f=l.findIndex((function(e){var t;return 1==(null===(t=e.extendList)||void 0===t||null===(t=t.find((function(e){return"IsAlertRecommend"===e.key})))||void 0===t?void 0:t.value)}));f<0?k(null===(p=l[0])||void 0===p?void 0:p.appendID):k(l[f].appendID)}),[i,l]),(0,I.jsx)(Y.Z,{visible:a,clickMaskClose:!0,close:function(){return S(3)},children:(0,I.jsxs)(g.View,{className:"ins-pop-box",children:[a&&N.ZP.ubtTrace("TCWBuyFill_InsurancePopup_exposure",{PageId:"10650084622",ProductId:T,Name:h.title,Tag:h.subTitle}),(0,I.jsx)(g.Image,{className:"title-img",src:h.titleImg}),(0,I.jsx)(g.Image,{className:"top-img",src:h.topImg}),(0,I.jsx)(g.View,{className:"linear-view"}),(0,I.jsxs)(g.View,{className:"container",children:[(0,I.jsx)(g.RichText,{className:"title-text",nodes:h.title}),(0,I.jsx)(g.Text,{className:"sub-title",children:h.subTitle}),(0,I.jsxs)(g.View,{className:"product-view",children:[(0,I.jsx)(g.Image,{className:"heart-img",src:"https://images3.c-ctrip.com/train/2022/app/8.55/zhuliucheng/baoxiantianxieyefuceng/pic_shield.png"}),(0,I.jsxs)(g.View,{className:"product-info",children:[(0,I.jsx)(g.Text,{className:"title-txt",children:null===(t=l[0])||void 0===t?void 0:t.appendTitle}),(0,I.jsx)(g.Text,{className:"link-txt",onClick:w,children:"\u6295\u4fdd\u987b\u77e5"})]}),null===(n=h.productIntroList)||void 0===n?void 0:n.map((function(e,t){return(0,I.jsxs)(g.View,{className:"pro-intro-view",children:[(0,I.jsx)(g.Image,{className:"product-intro",src:e.icon}),(0,I.jsx)(g.RichText,{className:"product-content",nodes:e.content})]},t)}))]}),(0,I.jsx)(g.View,{className:"pop-ins-info-box",children:(0,I.jsx)(me,{linkList:h.linkList,insuranceDesc:h.insuranceDesc,singleRow:!0})}),(0,I.jsxs)(g.View,{className:"btm-btns",children:[(0,I.jsx)(g.View,{className:"btn-item",onClick:function(){return S(2)},children:"\u5426"}),(0,I.jsx)(g.View,{className:"btn-item btn-right",onClick:function(){return S(1)},children:"\u662f"})]})]})]})})},Fe=_e,Oe=n(74937),Me=function(e){var t=e.pointNotEnoughPop,n=e.pointTipPop,i=e.totalPoint,a=void 0===i?0:i,s=e.priceInfo,r=void 0===s?{}:s,c=e.passengerRef,o=void 0===c?{}:c,l=e.setSelectedAssigneePassengers,u=void 0===l?N.UH:l,d=e.setPointNotEnoughPop,m=void 0===d?N.UH:d,p=e.setPointTipPop,f=void 0===p?N.UH:p,h=e.onClickNormalBooking,x=void 0===h?N.UH:h,v=e.setUsePointFlag,j=void 0===v?N.UH:v,T=function(){m(!1),f(!1)},k=function(){n&&(f(!1),x()),t&&(N.ZP.ubtTrace("TCWBuyFill_PointsPopup_click",{PageId:"10650084622",clickType:1}),m(!1),u([]),j(!1),o.current.openNormalPsgTab())},b=function(){return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(g.View,{className:"tit-box",children:[(0,I.jsx)(g.View,{className:"title",children:"\u79ef\u5206\u4e0d\u8db3\u5151\u6362\u8ba2\u5355\u91d1\u989d"}),(0,I.jsx)(g.View,{className:"subtit",children:"\u60a8\u7684\u79ef\u5206\u4f59\u989d\u4e0d\u8db3\u4ee5\u5151\u6362\u5f53\u524d\u8ba2\u5355\uff0c\u662f\u5426\u5207\u6362\u4e3a\u4ed8\u8d39\u8d2d\u7968\uff1f"})]}),(0,I.jsxs)(g.View,{className:"content",children:[(0,I.jsx)(g.Image,{className:"img",src:"https://images3.c-ctrip.com/train/2023-3/app-maipiao/3.23/jifenyouhua/img-zuo.png",alt:""}),(0,I.jsx)(g.Image,{className:"img",src:"https://images3.c-ctrip.com/train/2023-3/app-maipiao/3.23/jifenyouhua/img-zhong.png",alt:""}),(0,I.jsx)(g.Image,{className:"img",src:"https://images3.c-ctrip.com/train/2023-3/app-maipiao/3.23/jifenyouhua/img-you.png",alt:""}),(0,I.jsxs)(g.View,{className:"point-pop-inner-box",children:[(0,I.jsx)(g.Text,{children:"\u79ef\u5206\u53ef\u5151\u6362"}),(0,I.jsxs)(g.Text,{className:"strong-size number-zx2",children:[a/100,(0,I.jsx)(g.Text,{className:"normal-size",children:"\u5143"})]})]}),(0,I.jsxs)(g.View,{className:"point-pop-inner-box order-box",children:[(0,I.jsx)(g.Text,{children:"\u5f53\u524d\u8ba2\u5355\u91d1\u989d"}),(0,I.jsxs)(g.Text,{className:"strong-size number-zx2",children:[r.totalPricePas,(0,I.jsx)(g.Text,{className:"normal-size",children:"\u5143"})]})]})]})]})},w=function(){return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(g.View,{className:"tit-box",children:(0,I.jsx)(g.View,{className:"title",children:"\u79ef\u5206\u5151\u6362\u987b\u77e5"})}),(0,I.jsx)(g.View,{className:"content tip-content",children:(0,I.jsxs)(g.Text,{className:"point-tip-txt",children:["\u6839\u636e\u94c1\u8def\u5c40\u89c4\u5b9a\uff0c\u79ef\u5206\u5151\u6362\u7684\u8f66\u7968",(0,I.jsx)(g.Text,{className:"blue",children:"\u4e0d\u53ef\u9000\u7968"}),"\uff0c\u60a8\u786e\u8ba4\u8981\u5151\u6362\u5417\uff1f"]})})]})};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(Y.Z,{visible:t,direction:"middle",clickMaskClose:!0,close:T,children:[t&&N.ZP.ubtTrace("TCWBuyFill_PointsPopup_exposure",{PageId:"10650084622"}),(0,I.jsxs)(g.View,{className:"transfer-pop",children:[(0,I.jsx)(b,{}),(0,I.jsxs)(g.View,{className:"btns",children:[(0,I.jsx)(g.Button,{className:"btn cancel",onClick:function(){N.ZP.ubtTrace("TCWBuyFill_PointsPopup_click",{PageId:"10650084622",clickType:0}),T()},children:"\u6211\u518d\u60f3\u60f3"}),(0,I.jsx)(g.Button,{className:"btn done",onClick:k,children:"\u53bb\u4ed8\u8d39\u8d2d\u7968"})]})]})]}),(0,I.jsx)(Y.Z,{visible:n,direction:"middle",clickMaskClose:!0,close:T,children:(0,I.jsxs)(g.View,{className:"transfer-pop",children:[(0,I.jsx)(w,{}),(0,I.jsxs)(g.View,{className:"btns",children:[(0,I.jsx)(g.Button,{className:"btn cancel",onClick:T,children:"\u6211\u518d\u60f3\u60f3"}),(0,I.jsx)(g.Button,{className:"btn done",onClick:k,children:"\u786e\u8ba4\u5151\u6362"})]})]})})]})},ze=Me,Ee=function(e){var t=e.jLExpiredTimeInfo,n=void 0===t?{}:t,i=n.jLExpiredTimeOffsetList,a=void 0===i?[]:i,s=n.defaultIndex,r=n.title,c=(0,m.useMemo)((function(){return a&&a.length?a[s].timeOffsetDesc:"\u53d1\u8f66\u524d30\u5206\u949f"}),[s,a]);return(0,I.jsxs)(g.View,{class:"offset-box",children:[(0,I.jsx)(g.View,{class:"offset-title",children:r}),(0,I.jsx)(g.View,{className:"offset-list-box",children:(0,I.jsx)(g.View,{class:"offset-list",children:(0,I.jsx)(g.View,{class:"offset-item",children:c})})})]})},Ye=Ee,He=S().dayjs,Ue=S().trackFn,Ke=S().getToken,Ge=f().train,qe=function(e){e.defaultSelectedPassengers;var t=e.loginFlag,n=void 0!==t&&t,i=(0,m.useContext)(j._),o=i.bookingStates,l=i.ctripLogin,u=o.statusBarHeight,d=o.isTransit,p=o.train,h=void 0===p?{}:p,x=o.selectDate,v=void 0===x?"":x,T=o.configData,k=o.isBupiao,w=o.vendorID,S=o.trainTransferInfos,y=o.isReschedule,P=o.rescheduleCode,Z=o.rescheduleInfo,C=o.orderSource,D=o.isHasZhiDa,L=o.transferTime,B=o.trnFromScene,R=o.isCombiSeat,_=o.combiRemark,M=o.takeDays,z=o.fromH5,Y=o.extraCreateOrderParams,H=o.isThenByTrainTicket,K=h.seatName,q=(h.departureDate,h.departTimeStamp,h.departTime),W=h.arriveTime,X=h.departStation,$=h.arriveStation,ee=h.trainNumber,ie=(h.isCanHB,h.isCanSilent),ae=h.price,ce=h.isCanPointsPay,ue=Z||{},de=ue.ticketInfo,me=void 0===de?{}:de,pe=ue.artiPasIndex,fe=(0,m.useState)({disableDefaultPassenger:!0}),he=(0,r.Z)(fe,2),xe=he[0],ge=he[1],ke=(0,m.useState)([]),be=(0,r.Z)(ke,2),we=be[0],Se=be[1],ye=(0,m.useState)({}),Pe=(0,r.Z)(ye,2),Ze=Pe[0],Ce=Pe[1],Ve=(0,m.useState)({}),Le=(0,r.Z)(Ve,2),Re=Le[0],Ae=Le[1],_e=(0,m.useState)([]),Me=(0,r.Z)(_e,2),Ee=Me[0],qe=Me[1],We=(0,m.useState)([]),Xe=(0,r.Z)(We,2),Je=Xe[0],Qe=Xe[1],$e=(0,m.useState)([]),et=(0,r.Z)($e,2),tt=et[0],nt=et[1],it=(0,m.useState)([]),at=(0,r.Z)(it,2),st=at[0],rt=at[1],ct=(0,m.useState)([]),ot=(0,r.Z)(ct,2),lt=ot[0],ut=ot[1],dt=(0,m.useState)({}),mt=(0,r.Z)(dt,2),pt=mt[0],ft=mt[1],ht=(0,m.useState)(null),xt=(0,r.Z)(ht,2),gt=xt[0],vt=xt[1],Nt=(0,m.useState)(!1),jt=(0,r.Z)(Nt,2),Tt=jt[0],kt=jt[1],bt=(0,m.useState)(""),wt=(0,r.Z)(bt,2),St=wt[0],yt=wt[1],It=(0,m.useState)([]),Pt=(0,r.Z)(It,2),Zt=Pt[0],Ct=Pt[1],Vt=(0,m.useState)(!1),Dt=(0,r.Z)(Vt,2),Lt=Dt[0],Bt=Dt[1],Rt=(0,m.useState)({}),At=(0,r.Z)(Rt,2),_t=At[0],Ft=At[1],Ot=(0,m.useState)({}),Mt=(0,r.Z)(Ot,2),zt=Mt[0],Et=Mt[1],Yt=(0,m.useState)(0),Ht=(0,r.Z)(Yt,2),Ut=Ht[0],Kt=Ht[1],Gt=(0,m.useState)({}),qt=(0,r.Z)(Gt,2),Wt=qt[0],Xt=qt[1],Jt=(0,m.useState)(!1),Qt=(0,r.Z)(Jt,2),$t=Qt[0],en=Qt[1],tn=(0,m.useState)(!1),nn=(0,r.Z)(tn,2),an=nn[0],sn=nn[1],rn=(0,m.useState)([]),cn=(0,r.Z)(rn,2),on=cn[0],ln=cn[1],un=(0,m.useState)([]),dn=(0,r.Z)(un,2),mn=dn[0],pn=dn[1],fn=(0,m.useState)({}),hn=(0,r.Z)(fn,2),xn=hn[0],gn=hn[1],vn=(0,m.useState)({}),Nn=(0,r.Z)(vn,2),jn=Nn[0],Tn=Nn[1],kn=(0,m.useState)({}),bn=(0,r.Z)(kn,2),wn=(bn[0],bn[1]),Sn=(0,m.useState)({}),yn=(0,r.Z)(Sn,2),In=yn[0],Pn=yn[1],Zn=(0,m.useState)({}),Cn=(0,r.Z)(Zn,2),Vn=Cn[0],Dn=Cn[1],Ln=(0,m.useState)(1),Bn=(0,r.Z)(Ln,2),Rn=Bn[0],An=Bn[1],_n=(0,m.useState)(!0),Fn=(0,r.Z)(_n,2),On=Fn[0],Mn=Fn[1],zn=(0,m.useState)(5),En=(0,r.Z)(zn,2),Yn=En[0],Hn=En[1],Un=(0,m.useState)(""),Kn=(0,r.Z)(Un,2),Gn=Kn[0],qn=Kn[1],Wn=(0,m.useState)("86"),Xn=(0,r.Z)(Wn,2),Jn=Xn[0],Qn=Xn[1],$n=(0,m.useState)([]),ei=(0,r.Z)($n,2),ti=ei[0],ni=ei[1],ii=(0,m.useState)([]),ai=(0,r.Z)(ii,2),si=ai[0],ri=ai[1],ci=(0,m.useState)({}),oi=(0,r.Z)(ci,2),li=oi[0],ui=oi[1],di=(0,m.useState)(!1),mi=(0,r.Z)(di,2),pi=mi[0],fi=mi[1],hi=(0,m.useState)(!1),xi=(0,r.Z)(hi,2),gi=xi[0],vi=xi[1],Ni=(0,m.useState)(!0),ji=(0,r.Z)(Ni,2),Ti=ji[0],ki=ji[1],bi=(0,m.useState)(!1),wi=(0,r.Z)(bi,2),Si=wi[0],yi=wi[1],Ii=(0,m.useState)([]),Pi=(0,r.Z)(Ii,2),Zi=Pi[0],Ci=Pi[1],Vi=(0,m.useState)(""),Di=(0,r.Z)(Vi,2),Li=Di[0],Bi=Di[1],Ri=(0,m.useState)(""),Ai=(0,r.Z)(Ri,2),_i=Ai[0],Fi=Ai[1],Oi=(0,m.useState)(null),Mi=(0,r.Z)(Oi,2),zi=Mi[0],Ei=Mi[1],Yi=(0,m.useState)(!1),Hi=(0,r.Z)(Yi,2),Ui=Hi[0],Ki=Hi[1],Gi=(0,m.useState)(""),qi=(0,r.Z)(Gi,2),Wi=qi[0],Xi=qi[1],Ji=(0,m.useState)(!1),Qi=(0,r.Z)(Ji,2),$i=Qi[0],ea=Qi[1],ta=(0,m.useState)({}),na=(0,r.Z)(ta,2),ia=na[0],aa=na[1],sa=(0,m.useState)({}),ra=(0,r.Z)(sa,2),ca=(ra[0],ra[1],(0,m.useState)(!0)),oa=(0,r.Z)(ca,2),la=oa[0],ua=(oa[1],(0,m.useState)(!1)),da=(0,r.Z)(ua,2),ma=da[0],pa=da[1],fa=(0,m.useState)(!1),ha=(0,r.Z)(fa,2),xa=ha[0],ga=ha[1],va=(0,m.useState)(""),Na=(0,r.Z)(va,2),ja=Na[0],Ta=Na[1],ka=(0,m.useState)([]),ba=(0,r.Z)(ka,2),wa=ba[0],Sa=ba[1],ya=(0,m.useState)(0),Ia=(0,r.Z)(ya,2),Pa=Ia[0],Za=Ia[1],Ca=(0,m.useState)([]),Va=(0,r.Z)(Ca,2),Da=Va[0],La=Va[1],Ba=(0,m.useState)([]),Ra=(0,r.Z)(Ba,2),Aa=Ra[0],_a=Ra[1],Fa=(0,m.useState)(!1),Oa=(0,r.Z)(Fa,2),Ma=Oa[0],za=Oa[1],Ea=(0,m.useState)(!1),Ya=(0,r.Z)(Ea,2),Ha=Ya[0],Ua=Ya[1],Ka=(0,m.useState)({}),Ga=(0,r.Z)(Ka,2),qa=Ga[0],Wa=Ga[1],Xa=(0,m.useState)(0),Ja=(0,r.Z)(Xa,2),Qa=Ja[0],$a=Ja[1],es=(0,m.useState)({}),ts=(0,r.Z)(es,2),ns=ts[0],is=ts[1],as=(0,m.useState)(null),ss=(0,r.Z)(as,2),rs=ss[0],cs=ss[1],os=(0,m.useState)({}),ls=(0,r.Z)(os,2),us=ls[0],ds=ls[1],ms=(0,m.useState)(me),ps=(0,r.Z)(ms,2),fs=ps[0],hs=ps[1],xs=(0,m.useState)(0),gs=(0,r.Z)(xs,2),vs=gs[0],Ns=gs[1],js=(0,m.useState)(0),Ts=(0,r.Z)(js,2),ks=Ts[0],bs=Ts[1],ws=(0,m.useState)({}),Ss=(0,r.Z)(ws,2),ys=Ss[0],Is=Ss[1],Ps=(0,m.useState)(),Zs=(0,r.Z)(Ps,2),Cs=Zs[0],Vs=Zs[1],Ds=(0,m.useState)(),Ls=(0,r.Z)(Ds,2),Bs=Ls[0],Rs=Ls[1],As=(0,m.useState)(!1),_s=(0,r.Z)(As,2),Fs=_s[0],Os=_s[1],Ms=(0,m.useState)(!1),zs=(0,r.Z)(Ms,2),Es=zs[0],Ys=zs[1],Hs=(0,m.useState)(!1),Us=(0,r.Z)(Hs,2),Ks=Us[0],Gs=Us[1],qs=(0,m.useState)(!1),Ws=(0,r.Z)(qs,2),Xs=Ws[0],Js=Ws[1],Qs=(0,m.useState)([]),$s=(0,r.Z)(Qs,2),er=$s[0],tr=$s[1],nr=(0,m.useState)(!1),ir=(0,r.Z)(nr,2),ar=ir[0],sr=ir[1],rr=(0,m.useState)({}),cr=(0,r.Z)(rr,2),or=cr[0],lr=cr[1],ur=(0,m.useRef)(),dr=(0,m.useRef)(),mr=(0,m.useRef)(),pr=(0,m.useRef)(),fr=(0,m.useRef)(null),hr=(0,m.useRef)(null),xr=(0,m.useRef)(null),gr=(0,m.useRef)(null),vr=(0,m.useRef)(!1),Nr=(0,m.useRef)({});(0,m.useEffect)((function(){n&&(Rr(),Mr(),Hr(),Vr(),Lr(),sc(),Sr())}),[n]),(0,m.useEffect)((function(){ri(ti.filter((function(e){return!e.isFreeChild})))}),[ti]),(0,m.useEffect)((function(){w&&n&&Rr()}),[Rn]),(0,m.useEffect)((function(){65===+w&&h.isThenByTrainTicket?An(2):w&&An(+w)}),[w]),(0,m.useEffect)((function(){Es||Jr()}),[on,mn,Es]);var jr=(0,m.useMemo)((function(){var e=!1;if(d){var t=S[0],n=S[1],i=(0,N.DR)(t.seatName,t.seatList),a=(0,N.DR)(n.seatName,n.seatList);i&&a&&(e=0===i.seatInventory||0===a.seatInventory)}var s=h.thenByTicketInfo;return 1===(null===s||void 0===s?void 0:s.solutionType)&&1===(null===s||void 0===s?void 0:s.actionType)&&(e=!0),e}),[d,S,h]);function Tr(){return kr.apply(this,arguments)}function kr(){return kr=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,i;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([(0,N.zY)(_i),(0,N.uy)(_i)]);case 3:if(t=e.sent,1!==t[0].result||1!==t[1].result){e.next=13;break}if(!t[0].memberInfo||!t[1].pointList){e.next=13;break}if(Vs(t[0].memberInfo.memberStatus),n=t[0].memberInfo.totalPoint,i=t[1].pointList.some((function(e){return 2==e.tradeFlag})),Number.isNaN(parseInt(n))||0!=t[0].memberInfo.memberStatus||!(n>=1e4||i)){e.next=13;break}return Rs(t[0].memberInfo.totalPoint),jr||Os(!0),e.abrupt("return");case 13:Os(!1),e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](0),Os(!1);case 19:case"end":return e.stop()}}),e,null,[[0,16]])}))),kr.apply(this,arguments)}function br(){return wr.apply(this,arguments)}function wr(){return wr=(0,s.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,N.zY)(_i);case 3:t=e.sent,1===t.result&&t.memberInfo&&Vs(t.memberInfo.memberStatus),e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])}))),wr.apply(this,arguments)}function Sr(){return yr.apply(this,arguments)}function yr(){return yr=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,i,s;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[{key:"230705_TRN_PBTC",name:"newGuestShieldPop"}],n=function(e){var t=e.key,n=e.name;return new Promise((function(e){f().ABTestingManager.valueForKeyAsync(t,(function(t){return e((0,b.Z)({},n,t))}))}))},e.next=4,Promise.all(t.map((function(e){return n(e)})));case 4:i=e.sent,s=i.reduce((function(e,t){return(0,c.Z)((0,c.Z)({},e),t)}),{}),lr(s);case 7:case"end":return e.stop()}}),e)}))),yr.apply(this,arguments)}function Ir(){vi(pi||si.length>0),pi&&0===si.length&&!Es&&(mr.current.initSelSeatServiceInfo(),pr.current.initSelCarrConfig())}function Pr(){var e=st.find((function(e){return"ReturnChangeIns"==e.productSubType}));vt(e)}function Zr(){var e=st.filter((function(e){return 1===e.groupID&&"NorIns"==e.productSubType&&"NewVirusIns"===e.specialRealSubType}));if(e.length>0){var t,n,i=JSON.parse((null===(t=e[0].extendList)||void 0===t||null===(t=t.find((function(e){return"CovidInsuranceInfoExtendInfo"===e.key})))||void 0===t?void 0:t.value)||"{}"),a=JSON.parse((null===(n=e[0].extendList)||void 0===n||null===(n=n.find((function(e){return"CovidInsuranceAlertExtendInfo"===e.key})))||void 0===n?void 0:n.value)||"{}");Ft(i),Et(a)}Ct(e)}(0,m.useEffect)((function(){w&&!jr||(Os(!1),Ys(!1))}),[w,Fs,Es,jr]),(0,m.useEffect)((function(){d||jr||!_i||Vn.isSelectArgent||Ha||zi&&si.length>0||Es||_r()}),[d,R,_i,on,jn,pt,xn,li,si]),(0,m.useEffect)((function(){var e,t=!d||He(null===(e=S[1])||void 0===e?void 0:e.departDateymj).isBefore(He(Ge.childAgeLimit),"day");if(ki(t),Ze.selCarrIdx>=0)return yt(Ze.productName);var n=Ee.some((function(e){return e.selectPassageCount>0}));return Re.selSeatIdx>=0||n?yt(n?Ee[0].showName:Re.title):ti.some((function(e){return 3===e.passengerType}))?yt("\u5b66\u751f\u7968"):Da.length?yt("\u5728\u7ebf\u9009\u5ea7"):pt.selectedReturnChangeIns?yt("\u5b89\u5fc3\u9000\u6539"):yt("")}),[ti,Da,Ze,Re,pt,Ee]),(0,m.useEffect)((function(){ui((0,N.aS)((0,b.Z)((0,b.Z)({train:(0,c.Z)({},h),isTransit:d,trainTransferInfos:S,forecastPriceList:Zi,selectedPassengers:Es?er:si,selectedPackage:xn,selectedCoupon:zi,curSelCarrInfo:Ze,curSelSeatPosInfo:Re,returnChangeInsSelectInfo:pt,selectedInsInfo:Wt},"isTransit",d),"trainTransferInfosLength",S.length)))}),[ti,zi,xn,Ze,Re,pt,S,Wt,si,er]),(0,m.useEffect)((function(){Qa&&ic(ns.packageType)}),[Qa]),(0,m.useEffect)((function(){y&&Cr()}),[fs,P]),(0,m.useEffect)((function(){if(y){var e=(0,c.Z)({},fs);e.passengerInfos.forEach((function(e,t){e.isSelected=t===+pe&&1===P})),hs(e)}}),[Z]),(0,m.useEffect)((function(){Pr(),Zr()}),[st]),(0,m.useEffect)((function(){Ir()}),[pi,ti,si]),(0,m.useEffect)((function(){!_i&&!ar||d||(ce?Tr():br(),sr(!1))}),[_i,ar]),(0,m.useEffect)((function(){Es&&Fs?(Tn({}),Ei(null),Xt({}),Ae({}),Ce({}),ft({}),gn({}),La([])):La([])}),[Es]);var Cr=function(){var e=fs.passengerInfos.filter((function(e){return e.isSelected}))||[],t=h.price*e.length||0,n=e.reduce((function(e,t){return e+t.realTicketInfo.dealTicketPrice}),0),i=15*e.length;2===P&&(t=t+i||0),Ns(t),bs(n)};function Vr(){return Dr.apply(this,arguments)}function Dr(){return Dr=(0,s.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,ne.nT)();case 2:t=e.sent,Hn(t);case 4:case"end":return e.stop()}}),e)}))),Dr.apply(this,arguments)}function Lr(){return Br.apply(this,arguments)}function Br(){return Br=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,i,s,r,c;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i={keys:["international-train","wechat_mini_insurance_pop"]},e.next=3,(0,Q.Fz)(i);case 3:if(s=e.sent,1==s.resultCode){e.next=6;break}throw s.resultMessage;case 6:r=d?[S[0].departStation,S[1].departStation,S[0].arriveStation,S[1].arriveStation]:[X,$],c=(0,N.zB)(null===(t=s.configs[0])||void 0===t?void 0:t.data,r),Nr.current=null===(n=s.configs[1])||void 0===n?void 0:n.data.insuranceSwitch,ge(c);case 10:case"end":return e.stop()}}),e)}))),Br.apply(this,arguments)}function Rr(){return Ar.apply(this,arguments)}function Ar(){return Ar=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,i,s,r,o,l,u,m,p,x,g,j,T,k,b,w,y;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s={userId:f().clientID||"",channel:"ctripwx",clientId:"",platform:f().util.systemInfo.model,appVersion:f().util.systemInfo.version,departStation:h.departStation,arriveStation:h.arriveStation,departDate:v+" "+h.departTime+":00",trainNumber:h.trainNumber,seatName:h.seatName,orderType:h.IsUrgent?"P":"E",isMember:f().user.isLogin(),vendorID:Rn,extendInfo:"263382&1464975"},d&&(r=S[0],o=S[1],l=(0,N.DR)(r.seatName,r.seatList),u=(0,N.DR)(o.seatName,o.seatList),m={},p=!1,N.DR&&u&&(p=0===l.seatInventory||0===u.seatInventory,p&&(m.grabRoute=0===l.seatInventory?1:2)),x=S.map((function(e){return{departStation:e.departStation,arriveStation:e.arriveStation,departDate:He(e.departTimeStamp).format("YYYY-MM-DD HH:mm:ss"),arriveDate:He(e.arriveTimeStamp).format("YYYY-MM-DD HH:mm:ss"),trainNumber:e.trainNumber,seatName:e.seatName,routeSequence:e.sequence,ticketPrice:e.price}})),Object.assign(s,(0,c.Z)({departStation:r.departStation,arriveStation:r.arriveStation,secondDepartStation:o.departStation,secondArriveStation:o.arriveStation,secondDepartDate:o.departDateymj+" "+o.departTime+":00",secondTrainNumber:o.trainNumber,secondSeatName:o.seatName,departDate:r.departDateymj+" "+r.departTime+":00",trainNumber:r.trainNumber,seatName:r.seatName,orderType:"E",vendorID:p?89:1,ticketPrice:(r.price+o.price)/2,type:1,ticketList:x},m))),g=h.thenByTicketInfo,1===(null===g||void 0===g?void 0:g.solutionType)&&1===(null===g||void 0===g?void 0:g.actionType)&&(j=g.ticketInfo,T=[],k=He(h.departTimeStamp).utcOffset(8),b=k.add(h.takeDays,"day").format("YYYY-MM-DD"),T.push({departStation:s.departStation,arriveStation:s.arriveStation,departDate:s.departDate,arriveDate:b+" "+h.arriveTime+":00",trainNumber:s.trainNumber,seatName:s.seatName,routeSequence:1,ticketPrice:h.price}),T.push({departStation:j.departureStationName,arriveStation:j.arrivalStationName,departDate:j.departureDateTime,arriveDate:j.arrivalDateTime,trainNumber:j.trainNumber,seatName:j.seatName,routeSequence:2,ticketPrice:j.ticketPrice}),Object.assign(s,{secondDepartStation:j.departureStationName,secondArriveStation:j.arrivalStationName,secondDepartDate:j.departureDateTime,secondTrainNumber:j.trainNumber,secondSeatName:j.seatName,ticketList:T,type:1})),e.next=6,(0,N.Gm)();case 6:return fr.current=e.sent,e.next=9,(0,Q.Gu)(s);case 9:if(w=e.sent,vr.current||!w.resultMessage||w.isBookable){e.next=12;break}return e.abrupt("return",N.ZP.showModal({m:w.resultMessage,done:function(){vr.current=!0,f().navigateBack()}}));case 12:y="1"===(null===(t=w.extendList)||void 0===t||null===(t=t.find((function(e){return"IsNewGuest"===e.key})))||void 0===t?void 0:t.value),sn(y),Se(w.selectSeatServiceList||[]),nt(w.selectSeatAlertInfoList||[]),rt(w.trainAppendProductList||[]),ut(w.trainOtherProductList||[]),ln(w.trainPackageProductList||[]),pn(w.trainBindPackageProductList||[]),Pn(w.realNameAuthentication||{}),Is(w.jLExpiredTimeInfo),Dn((0,c.Z)((0,c.Z)({},w.urgentTicketInfo),{},{isSelectArgent:(null===(n=w.urgentTicketInfo)||void 0===n?void 0:n.isDefault)&&(null===(i=w.urgentTicketInfo)||void 0===i?void 0:i.isOpen)})||{}),Ta(w.middleTips),Sa(w.middleTipList),Za(w.orderTicketType);case 26:case"end":return e.stop()}}),e)}))),Ar.apply(this,arguments)}function _r(){return Fr.apply(this,arguments)}function Fr(){return Fr=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,i,s,r,c,o,l;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=si.map((function(e){return{PassengerName:e.pasName,PassengerType:e.passengerType}})),n=Or()+((null===jn||void 0===jn?void 0:jn.packagePrice)||0),i=on.map((function(e){return{PackageID:e.packageID}})),s=0,s=d?S[0].price+S[1].price:null===h||void 0===h?void 0:h.price,r=li.totalPricePas||s,c={ChannelName:"WX",OrderType:"E",PassengerList:t,PackageSumPrice:n,PackageList:i,TicketPrice:r,DepartStation:X,ArriveStation:$,TrainNumber:ee,DepartDateTime:He(v+q).format("YYYYMMDDHHmmss")},d&&(o=S[0],Object.assign(c,{DepartStation:o.departStation,ArriveStation:o.arriveStation,DepartDateTime:He(v+o.departTime).format("YYYYMMDDHHmmss"),TrainNumber:o.trainNumber})),e.next=10,(0,Q.f2)(c);case 10:l=e.sent,1===(null===l||void 0===l?void 0:l.retCode)&&null!==l&&void 0!==l&&l.isDefault?(Ei(l.defaultCouponInfo),Ua(!0)):Ei(null);case 12:case"end":return e.stop()}}),e)}))),Fr.apply(this,arguments)}function Or(){var e=0,t=0,n=0;return Object.keys(xn).length&&(t=d?(xn.packagePrice||0)*si.length*S.length:(xn.packagePrice||0)*si.length),pt&&Object.keys(pt).length&&(n=(pt.appendPrice||0)*si.length),e=t+n,e}function Mr(){return zr.apply(this,arguments)}function zr(){return zr=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,i;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=je.WG.getAttr("bind12306")||{},n=t.name,Fi(n),Bi(t.displayName||t.name),t.name){e.next=10;break}return e.next=7,(0,N._P)();case 7:n=e.sent,Fi(n),Bi(n);case 10:if(!n||Rn!==O.h6.NORMAL){e.next=15;break}return e.next=13,(0,N.fE)(n);case 13:i=e.sent,i||(N.ZP.ubtDevTrace("train_tinyapp_dev_log",{bizKey:"ordinary_booking_12306_invalid",value:{userName:n}}),yi(!0));case 15:case"end":return e.stop()}}),e)}))),zr.apply(this,arguments)}var Er=N.ZP.useSyncCallback((function(){ns.orderStep&&(1==ns.orderStep&&ic(ns.packageType),2==ns.orderStep&&(gr.current=(0,c.Z)((0,c.Z)({},gr.current),{},{isSelect:!0}),rc({pkg:rs})),is({orderStep:0}))})),Yr=function(e){var t=e.displayName,n=e.userName;Fi(n),Bi(t),Os(!1),yi(!1),Er()};function Hr(){return Ur.apply(this,arguments)}function Ur(){return Ur=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,i,s;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={DepartStation:h.departStation,ArriveStation:h.arriveStation,DepartDate:v.replace(/-/g,""),TrainNumber:h.trainNumber},e.next=3,(0,Q.cG)(t);case 3:n=e.sent,1===n.retCode&&(s=null===(i=n.seatList)||void 0===i?void 0:i.find((function(e){return e.seatName===K})),Ci((null===s||void 0===s?void 0:s.forecastSeatPriceList)||[]));case 5:case"end":return e.stop()}}),e)}))),Ur.apply(this,arguments)}function Kr(){xr.current=null,is({orderStep:0})}function Gr(){return qr.apply(this,arguments)}function qr(){return qr=(0,s.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return xr.current=(0,c.Z)((0,c.Z)({},xr.current),{},{isSelect:!0}),e.next=3,rc({pkg:rs});case 3:xr.current=null;case 4:case"end":return e.stop()}}),e)}))),qr.apply(this,arguments)}function Wr(){return Xr.apply(this,arguments)}function Xr(){return Xr=(0,s.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,Q.l)({orderId:Wi,ver:1,channel:"WX"});case 3:if(t=e.sent,t.orderInfo){e.next=6;break}throw"\u8ba2\u5355\u8be6\u60c5\u83b7\u53d6\u5931\u8d25".concat(Wi);case 6:return e.abrupt("return",t.orderInfo);case 9:return e.prev=9,e.t0=e["catch"](0),(0,N.vJ)(e.t0),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[0,9]])}))),Xr.apply(this,arguments)}function Jr(){if(N.ZP.hideLoading(),w||on.length)if(!w||R){var e=(null===mn||void 0===mn?void 0:mn.find((function(e){var t;return 4===(4&(null!==(t=e.packageFlag)&&void 0!==t?t:0))})))||on.find((function(e){var t;return 4===(4&(null!==(t=e.packageFlag)&&void 0!==t?t:0))}))||on[0];Tn(on[0]),gn(on.find((function(e){return 0===e.packagePrice}))||{}),wn(e)}else Rn===O.h6.CTRIP?gn(on[0]||{}):Rn===O.h6.NORMAL&&gn(on.find((function(e){return 0===e.packagePrice}))||{})}function Qr(){dr.current.goToLogin()}var $r=N.ZP.useSyncCallback((function(){kt(!1),ft((0,c.Z)((0,c.Z)({},pt),{},{selectedReturnChangeIns:!0})),$a(Qa+1)}));function ec(){var e=N.ZP.getNextDayTimeOut();je.ZK.setAttr("YOUXIANGALERT",{key:!0,timeout:e}),kt(!1),$a(Qa+1)}function tc(){if(!d){var e=N.ZP.getNextDayTimeOut();je.ZK.setAttr("YOUXIANGALERT",{key:!0,timeout:e})}Wa({visible:!1,clicked:!0}),$a(Qa+1)}function nc(){is((0,c.Z)((0,c.Z)({},ns),{},{packageType:"default"})),Wa({visible:!1,clicked:!0}),$a(Qa+1)}var ic=function(e){var t,n;Ua(!0);var i="default"==e?jn:xn,a=function(){var t="\u94c1\u8def\u5c40\u89c4\u5b9a\uff0c\u5728\u7ebf\u8d2d\u4e70\u5b66\u751f\u7968\u9700\u8981\u767b\u5f5512306\u8d26\u53f7\u3002\u8bf7\u767b\u5f55\u6216\u6ce8\u518c12306\u8d26\u53f7\u540e\uff0c\u8d2d\u4e70\u5b66\u751f\u7968";N.ZP.showModal({m:t,showCancel:!0,done:function(t){var n=t.confirm;n&&(Qr(),is({orderStep:1,packageType:e}))}})},s=function(){return N.ZP.showModal({m:"\u7cfb\u7edf\u9650\u5236\uff0c\u5b89\u5fc3\u9000\u6539\u4fdd\u969c\u548c\u514d\u767b\u5f55\u5957\u9910\u4e0d\u80fd\u540c\u65f6\u8d2d\u4e70\uff0c\u8bf7\u9009\u62e9\u9700\u8981\u4fdd\u7559\u7684\u4ea7\u54c1",confirmText:"\u77e5\u9053\u4e86",done:function(){}})},r=function(){return N.ZP.showModal({m:"\u94c1\u8def\u5c40\u89c4\u5b9a\uff0c\u8d2d\u7968\u9700\u5b9e\u540d\u5236\uff0c\u8bf7\u767b\u5f5512306\u8d26\u53f7\u540e\u7ee7\u7eed\u8d2d\u7968",showCancel:!0,done:function(t){var n=t.confirm;n&&(Qr(),is({orderStep:1,packageType:e}))}})};if((0,ne.z4)(Jn,Gn)){if(je.WG.setAttr("mobile",Gn),je.WG.setAttr("areaCode",Jn),0==si.length&&0===er.length)return N.ZP.showToast("\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u4e2a\u4e58\u5ba2","none"),void ur.current.onClickAddPasg();if(jr||!d||"normal"!=e||null===(t=T.transferAlertInfo)||void 0===t||!t.isOpen||qa.clicked||!(an&&_i&&"B"!==or.newGuestShieldPop||!an)&&_i){if(!_i){var o=(null===on||void 0===on?void 0:on.find((function(e){return 0==e.packageSubTitle.split("\r\n")&&e.packageActionCode})))||0;if("normal"==e&&null!==In&&void 0!==In&&In.isShow)return;if(1==o||3==o)return Qr(),void is({orderStep:1,packageType:e});if(2==o||4==o)return}if(Si)return N.ZP.showToast("12306\u8d26\u53f7\u5df2\u5931\u6548\uff0c\u9700\u91cd\u65b0\u767b\u5f55","none"),Qr(),void is({orderStep:1,packageType:e});if(16==(16&(null!==(n=null===i||void 0===i?void 0:i.packageFlag)&&void 0!==n?n:0))){var l,u;if((0,ne.n)(ti))return a();if(null!==pt&&void 0!==pt&&pt.selectedReturnChangeIns&&null!==(l=xr.current)&&void 0!==l&&l.isSelect)return s();if(null!==(u=T.eleCounterTimeInfo)&&void 0!==u&&u.limitMinutes){var m,p=Date.now(),f=60*(null===(m=T.eleCounterTimeInfo)||void 0===m?void 0:m.limitMinutes)*1e3,x=null===h||void 0===h?void 0:h.departTimeStamp;if(x-p<f)return r()}}cs(i),rc({pkg:i})}else Wa((0,c.Z)((0,c.Z)({},qa),{},{visible:!0}))}},ac=function(){Ei(null),N.ZP.showToast("\u60a8\u672a\u9009\u62e9\u5957\u9910\uff0c\u4f18\u60e0\u5238\u4e0d\u53ef\u7528\u54e6~","none",1e3),N.ZP.ubtTrace("s_trn_c_trace_10650084622",{bizKey:"couponNotice",exposureType:"normal"}),setTimeout((function(){$a(Qa+1)}),1e3)},sc=function(){console.log("\u8fd9\u91cc\u662f\u4ec0\u4e48\u4e1c\u897f",z),"schemequery"===z&&Mn(!1)},rc=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(t){var n,i,s,r,o,l,u,m,p,f,x,g;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(p=t.pkg,!Ge.isTrainApp||d||0!=p.packagePrice||null===(n=T.transferAlertInfo)||void 0===n||!n.isOpen||je.ZK.getAttr("YOUXIANGALERT")){e.next=4;break}return Wa((0,c.Z)((0,c.Z)({},qa),{},{visible:!0,hasShow:!0})),e.abrupt("return");case 4:if(!((null===pt||void 0===pt||!pt.selectedReturnChangeIns)&&!(null!==p&&void 0!==p&&p.packagePrice)>0&&!Vn.isSelectArgent&&Ze.selCarrIdx<0&&Re.selSeatIdx<0&&!qa.hasShow&&gt)||$t){e.next=11;break}if(f=je.ZK.getAttr("RETURNCHANGEINSFLAG"),!(an&&_i&&"B"!==or.newGuestShieldPop||!an)&&_i){e.next=11;break}if(f){e.next=11;break}return kt(!0),je.ZK.setAttr("RETURNCHANGEINSFLAG",{key:!0,timeout:1440}),e.abrupt("return");case 11:if(!(!(null!==p&&void 0!==p&&p.packagePrice)>0&&2==(null===zi||void 0===zi?void 0:zi.couponType))){e.next=13;break}return e.abrupt("return",ac());case 13:if(!hr.current){e.next=15;break}return e.abrupt("return");case 15:return hr.current=!0,setTimeout((function(){hr.current=!1}),2e3),x={},g=(0,N.Og)((0,c.Z)({pkg:p,train:h,mobile:Gn,areaCode:Jn,isBupiao:k,unionData:fr.current,isTransit:d,isSectionTicket:R,isSectional:4==Pa,acceptSilent:Ma,login12306Name:_i,selectedCoupon:zi,selCarriageConfig:Ze,seatPositionInfo:Da,secondSeatPositionInfo:Aa,curSelSeatPosInfo:Re,selSeatPosConfigList:[],isSelectArgent:Vn.isSelectArgent,trainTransferInfos:S,selectedPassengers:Es?er:si,isCanPointsPay:Es,freeChildrenPassengers:ti.filter((function(e){return e.isFreeChild})),isEleCounterTicket:16==(16&(null!==(i=p.packageFlag)&&void 0!==i?i:0)),isChooseSeatOnlineButtonVisible:d?0!=Da.length||0!=Aa.length:0!=Da.length,returnChangeIns:pt,rightInReturnChangeIns:null===pt||void 0===pt?void 0:pt.rightsInfo,selectReturnChangeIns:null===pt||void 0===pt?void 0:pt.selectedReturnChangeIns,selectRightInReturnChangeIns:null===pt||void 0===pt?void 0:pt.selectedReturnChangeInsRight,skipLogin12306Package:null===(s=xr.current)||void 0===s?void 0:s.package,reBookLogin12306Package:null===(r=gr.current)||void 0===r?void 0:r.package,isSelectedSkip12306Package:null===(o=xr.current)||void 0===o?void 0:o.isSelect,isSelectedLogin12306Package:null===(l=gr.current)||void 0===l?void 0:l.isSelect,selectedInsInfo:Wt,orderSource:C,fromH5:z,extraCreateOrderParams:Y,insToken:Ke(),freeBedSelList:Ee.filter((function(e){return e.selectPassageCount>0})),vendorID:w},x)),g.crossProductList=null===(u=h.selectedSeat)||void 0===u||null===(u=u.bannerTaskInfo)||void 0===u||null===(u=u.taskList)||void 0===u?void 0:u.map((function(e){return{type:e.taskType,newGuest:e.isNewGuest,discountAmount:e.discountAmount}})),g.extendInfoList=g.extendInfoList.concat((null===(m=h.selectedSeat)||void 0===m||null===(m=m.bannerTaskInfo)||void 0===m?void 0:m.extendList)||[]),ds(g),console.log("\u4e0b\u5355\u53c2\u6570",g),e.abrupt("return",cc({orderBody:g}));case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function cc(e){return oc.apply(this,arguments)}function oc(){return oc=(0,s.Z)((0,a.Z)().mark((function e(t){var n,i,r,c,o,u,m,p,x,g,v,j,T,k,b,w,y,I,P;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n="\u7cfb\u7edf\u5f02\u5e38\uff0c\u63d0\u4ea4\u8ba2\u5355\u5931\u8d25\u3002\u6211\u4eec\u6b63\u5728\u52aa\u529b\u4fee\u590d\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\u3002",N.ZP.showLoading(),e.prev=2,e.next=5,(0,Q.$k)(t);case 5:if(i=e.sent,r=f().getCurrentPage(),f().mkt.sendUnionTrace(r,i.orderId,"TRN"),c=i.retCode,o=i.message,u=i.alertInfo,m=i.riskOrderId,p=i.isPreHoldSeat,x=i.extendInfoList,N.ZP.hideLoading(),2!=c){e.next=19;break}if(m){e.next=15;break}if(!(o&&o.indexOf("\u60a8\u5c1a\u672a\u767b\u5f55\u643a\u7a0b\u8d26\u53f7")>=0)){e.next=14;break}return e.abrupt("return",l());case 14:throw o;case 15:g={alertType:0,title:"\u6e29\u99a8\u63d0\u793a",content:o,buttonList:[{buttonName:"\u77e5\u9053\u4e86",jumpUrl:""},{buttonName:"\u67e5\u770b\u8ba2\u5355",jumpUrl:"/pages/train/orderdetail/orderdetail?oid=".concat(m)}]},ea(!0),aa(g),N.ZP.ubtTrace("s_trn_c_trace_10650084622",{exposureType:"popup",bizKey:"tripConflict",type:1});case 19:if(20!=c){e.next=25;break}if(u){e.next=22;break}throw o||n;case 22:ea(!0),aa(u),N.ZP.ubtTrace("s_trn_c_trace_10650084622",{exposureType:"popup",bizKey:"tripConflict",type:3===u.AlertType?0:1});case 25:if(21!=c){e.next=40;break}if(v=x.find((function(e){return"ETicketUser12306ProcessV3"===e.key})),v){e.next=29;break}throw o||n;case 29:return j=JSON.parse(v.value).processList||[],T=j.find((function(e){return 2===e.type||3===e.type||7===e.type})),k=j.find((function(e){return 1===e.type})),xr.current={isSelect:!1,package:T},gr.current={isSelect:!1,package:k},Qr(),is({orderStep:2}),e.next=38,(0,Te.g)();case 38:b=e.sent,N.ZP.ubtTrace("s_trn_c_trace_10650084622",{exposureType:"actionbar",bizKey:"loginFloatExposure",scenes:b?1:7,isLoginFreeEntrance:T?1:0,isCharged:T&&T.productPrice>0?1:0});case 40:if(0!=c){e.next=58;break}if(!i.pollingKey){e.next=54;break}return N.ZP.showLoading("\u4e0b\u5355\u5904\u7406\u4e2d..."),w=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,s=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},e.next=3,(0,Q.uO)({pollingKey:t.pollingKey||i.pollingKey,pollingActionType:i.pollingActionType,orderNumber:t.orderId||i.orderId});case 3:if(n=e.sent,1!==n.pollingResult&&2!==n.pollingResult){e.next=6;break}return e.abrupt("return",n);case 6:return e.abrupt("return",{pollingFlag:!0,pollingRate:n.pollingRate,pollingKey:n.pollingKey,orderId:n.orderNumber});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=46,(0,N.nP)(w);case 46:if(y=e.sent,N.ZP.hideLoading(),1==y.retCode&&y.orderNumber){e.next=51;break}return N.ZP.showModal({m:y.secondOrderFailReason||y.retMessage||"\u4e0b\u5355\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5"}),e.abrupt("return");case 51:if(!y.secondOrderFailReason){e.next=54;break}return e.next=54,N.ZP.showToastPromise(y.secondOrderFailReason,"none",2500);case 54:if(d||N.ZP.ubtTrace("c_tra_booking_remaining_ticket_info_applets",{partner:"Ctrip.Train",userId:f().user.duid,orderId:"".concat(i.orderId),orderTime:He().format("YYYY-MM-DD HH:mm:ss"),seatList:JSON.stringify(null===(I=h.seatList)||void 0===I?void 0:I.map((function(e){return{name:e.seatName,amount:e.seatInventory}}))),trainInfo:JSON.stringify({trainNumber:t.orderBody.ticketList[0].trainNumber,departStation:t.orderBody.ticketList[0].departureStationName,departDateTime:t.orderBody.ticketList[0].departureDateTime,arriveStation:t.orderBody.ticketList[0].arrivalStationName,arriveDateTime:t.orderBody.ticketList[0].arrivalDateTime})}),!Es&&!Pa){e.next=57;break}return e.abrupt("return",f().navigateTo({url:"/pages/train/orderdetail/orderdetail?oid=".concat(i.orderId)}));case 57:p?(Ki(!0),Xi(i.orderId)):(P=d?S.map((function(e,t){return 0==t?e.departStation:e.arriveStation})).join(" - "):"".concat(h.departStation," - ").concat(h.arriveStation),(0,N.NL)(i,{title:P,type:"ordinary"}));case 58:e.next=65;break;case 60:e.prev=60,e.t0=e["catch"](2),console.log("error----",e.t0),N.ZP.hideLoading(),N.ZP.showModal({m:e.t0});case 65:case"end":return e.stop()}}),e,null,[[2,60]])}))),oc.apply(this,arguments)}function lc(){if(d)return f().navigateBack();N.ZP.showModal({m:"\u8ba2\u5355\u5c31\u8981\u5b8c\u6210\u4e86\uff0c\u60a8\u786e\u5b9a\u8981\u79bb\u5f00\u5417\uff1f",showCancel:!0,cancelText:"\u786e\u8ba4\u79bb\u5f00",confirmText:"\u7ee7\u7eed\u9884\u8ba2",done:function(e){var t=e.confirm;t||f().navigateBack()}})}function uc(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!("86"===Jn||!Wt.appendID&&!e)&&(qn(""),Qn("86"),N.ZP.showToast("\u8d2d\u4e70\u4fdd\u9669\u9700\u8981\u586b\u5199\u56fd\u5185\u624b\u673a\u53f7","none"),!0)}var dc=function(){if(Fs&&Es){if(!(li.totalPrice<=Bs/100))return Gs(!0),!1;if(!Xs)return Js(!0),!1}return!0},mc=function(e){var t={PageId:"10650084622",originalVendorId:w,vendorId:Rn,package:xn.packageID},n=t;n=d&&S.length>0?(0,c.Z)((0,c.Z)({},t),{},{TripType:jr?9:R?4:S[0].arriveStation===S[1].departStation?2:3,TrnFromScene:B,Status:D?1:2,TrnSmcInfo:S.map((function(e,t){return{TicketSeat:e.seatName,departdatetime:e.departTime,arrivaldatetime:e.arriveTime,departstationname:e.departStation,arrivestationname:e.arriveStation,trainnumber:e.trainNumber,route:t+1,ticketprice:e.price}})),ButtonName:"default"===e?"\u7acb\u5373\u9884\u8ba2":"\u666e\u901a\u9884\u8ba2"}):(0,c.Z)((0,c.Z)({},t),{},{TripType:H?h.thenByTicketInfo.scmType+3:1,TrnSmcInfo:[{TicketSeat:K,departdatetime:q,arrivaldatetime:W,departstationname:X,arrivestationname:$,trainnumber:ee,route:1,ticketprice:ae}],ButtonName:Es?"\u53bb\u5151\u6362":"\u7acb\u5373\u9884\u8ba2"});var i=Ut?(0,c.Z)((0,c.Z)({},n),{},{ProductId:Wt.appendID}):n;N.ZP.ubtTrace("TCWBuyFill_BookButton_click",i)};function pc(){return fc.apply(this,arguments)}function fc(){return fc=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,i,s,r,c,o,l,u=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]&&u[0],n=u.length>1&&void 0!==u[1]&&u[1],Es){e.next=28;break}if(mc(),i=He().format("MMDD")!==je.ZK.getAttr("INSPOPFLAG"),!(!t&&Zt.length>0&&!d&&si.length>0&&0===Object.keys(Wt).length&&i)||Rn!==O.h6.NORMAL&&!Nr.current){e.next=10;break}if(!(an&&_i&&"B"!==or.newGuestShieldPop||!an)&&_i){e.next=10;break}return Bt(!0),en(!0),e.abrupt("return");case 10:if(!t){e.next=25;break}if(!n){e.next=20;break}return s=Zt.findIndex((function(e){var t;return 1==(null===(t=e.extendList)||void 0===t||null===(t=t.find((function(e){return"IsAlertRecommend"===e.key})))||void 0===t?void 0:t.value)})),s<0?(Xt(Zt[0]),Kt(1)):(Xt(Zt[s]),Kt(s+1)),Bt(!1),r=uc(n),!r&&$a(Qa+1),e.abrupt("return");case 20:return c=He().format("MMDD"),je.ZK.setAttr("INSPOPFLAG",c),Bt(!1),ic("normal"),e.abrupt("return");case 25:return o=uc(),o||ic("normal"),e.abrupt("return");case 28:if(mc(),l=dc(),l){e.next=32;break}return e.abrupt("return");case 32:ic("normal");case 33:case"end":return e.stop()}}),e)}))),fc.apply(this,arguments)}return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(g.View,{className:"ordinary-top-bar",children:la&&(0,I.jsx)(Oe.ZP,{leftType:"back",title:"\u586b\u5199\u8ba2\u5355",titleFontSize:17,fontWeight:500,onClickLeftIcon:lc})}),d&&S.length>0&&N.ZP.ubtTrace("TCWBuyFill_exposure",{PageId:"10650084622",TripType:jr?9:R?4:S[0].arriveStation===S[1].departStation?2:3,TrnFromScene:B,Status:D?1:2,WaitingTime:L,vendorId:+w,TrnSmcInfo:S.map((function(e,t){return{TicketSeat:e.seatName,departdatetime:e.departTime,arrivaldatetime:e.arriveTime,departstationname:e.departStation,arrivestationname:e.arriveStation,trainnumber:e.trainNumber,route:t+1,ticketprice:e.price}}))}),!d&&h&&Object.keys(h).length>0&&N.ZP.ubtTrace("TCWBuyFill_exposure",{PageId:"10650084622",TripType:H?h.thenByTicketInfo.scmType+3:1,TrnSmcInfo:[{TicketSeat:K,departdatetime:q,arrivaldatetime:W,departstationname:X,arrivestationname:$,trainnumber:ee,route:1,ticketprice:ae}],vendorId:+w}),(0,I.jsx)(Ie,{middleTips:ja,middleTipList:wa,orderTicketType:Pa,pkg:xr.current,login12306Name:_i,display12306Name:Li,onLogin12306Pkg:Gr,onLogin12306Cancel:Kr,onLogin12306Success:Yr,isNewGuest:an,trainInfo:h,trainTransferInfos:S,isTransit:d,isCombiSeat:R,isThenByTrainTicket:H,takeDays:M,combiRemark:_,statusBarHeight:u,selectDate:v,setSpreadTrainCard:pa,login12306Ref:dr,selectedPackage:xn,isReschedule:y,selectedPassengers:si,vendorID:w,setPackagePopVisible:ga}),(0,I.jsx)(g.View,{className:"shadowbase ".concat(ma?"shadow":""),onClick:function(){return pa(!1)}}),(0,I.jsx)(De,{trainInfo:h,statusBarHeight:u,selectDate:v,spreadTrainCard:ma,setSpreadTrainCard:pa,trainTransferInfos:S,isTransit:d,selectedPackage:xn,selectedPassengers:si,setPackagePopVisible:Ue("ordinaryBookingPackagePopVisible",ga),needGrabBuy:jr}),!y&&(0,I.jsxs)(g.View,{className:"wrap",children:[(0,I.jsx)(ne.ZP,{pageId:"10650084622",convertStu:!1,mobile:Gn,areaCode:Jn,loginFlag:n,from:"ordinary",needDefaultPassenger:On,internationalConfig:xe,isTransit:d,transitDateFlag:Ti,seatNames:d?S.map((function(e){return e.seatName})):[K],maxPassengerLength:Yn,productLimitParams:{selectedOtherProduct:St},selectedPassengers:ti,setPasgChanged:Ue("ordinaryBookingPasgChanged",fi),onSelectedPassengersChange:Ue("ordinaryBookingSelectPassenger",ni),onAreaCodeChange:Ue("ordinaryBookingAreaCodeChange",Qn),onMobileChange:Ue("ordinaryBookingMobileChange",qn),passengerRef:ur,login12306Name:_i,canUsePoint:Fs,selectedAssigneePassengers:er,setSelectedAssigneePassengers:tr,memberStatus:Cs,totalPoint:Bs,usePointFlag:Es,setUsePointFlag:Ys,priceInfo:li,train:h,setReloadPointFlag:sr}),(0,I.jsx)(A,{outerVisible:gi,psgAmount:Es?er.length:si.length,onChange:Ue("ordinaryBookingSelectedOrderSeats",La),onChangeSecond:Ue("ordinaryBookingSelectedOrderSecondSeats",_a),onSelectSilentChange:Ue("ordinaryBookingSelectedSilent",za),selectedSilent:Ma,selectedOrderSeats:Da,selectedOrderSecondSeats:Aa,train:h,trainTransferInfos:S,isCanSilent:ie,selectedOtherProduct:St}),!Es&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(V,{outerVisible:gi,curSelSeatPosInfo:Re,selectSeatServiceList:we,selectedPassengers:si,selectSeatAlertInfoList:tt,selectedOtherProduct:St,onCurSelSeatPosInfoChange:Ue("ordinaryBookingCurSelSeatPosInfoChange",Ae),selSeatRef:mr,setFreeBedSelList:qe,setFreeBedList:Qe,freeBedList:Je}),(0,I.jsx)(F,{outerVisible:gi,selectSeatServiceList:we,curSelCarrInfo:Ze,selectedPassengers:si,onCurSelCarrInfoChange:Ue("ordinaryBookingCurSelCarrInfoChange",Ce),selectedOtherProduct:St,selCarriageRef:pr}),jr&&(null===ys||void 0===ys?void 0:ys.isDisplay)&&(0,I.jsx)(g.View,{className:"cell",children:(0,I.jsx)(Ye,{jLExpiredTimeInfo:ys})}),(0,I.jsx)(E,{outerVisible:gi,trainAppendProductList:st,trainOtherProductList:lt,selectedOtherProduct:St,selectedPassengers:si,returnChangeInsSelectInfo:pt,onChange:Ue("ordinaryBookingReturnChangeInsSelectInfo",ft)}),(0,I.jsx)(ve,{isTransit:d,insProList:Zt,insExtendInfo:_t,setSelectedInsInfo:Ue("ordinaryBookingSelectedInsInfo",Xt),selectedProIdx:Ut,setSelectedProIdx:Ue("ordinaryBookingSelectedProIdx",Kt)}),!d&&!jr&&(0,I.jsx)(le.Z,{outerVisible:gi,login12306Name:_i,goTo12306Login:Qr,selectedPassengers:si,selectedPackage:xn||{},selectedCoupon:zi||{},ticketPrice:d?S[0].price+S[1].price:null===h||void 0===h?void 0:h.price,loginFlag:n,vendorID:R?"":w,packageVendorID:Rn,from:"ordinary",priceInfo:li,departStation:h.departStation,arriveStation:h.arriveStation,onSelectedCouponChange:Ue("ordinaryBookingSelectedCouponChange",Ei)})]}),(0,I.jsx)(Ne.Z,{type:"0",from:"ordinary",internationalConfig:xe})]}),y?(0,I.jsx)(J,{rescheduleTicketInfo:fs,onChangeRescheduleTicketInfo:hs,rescheduleCode:P,isAbroadRes:Z.isAbroad,artiPasIndex:+pe}):(0,I.jsx)(re.Z,{from:"ordinary",selectedPackage:xn,defaultPackage:jn,packageList:on,selectedPassengers:Es?er:si,seatNames:d?S.map((function(e){return e.seatName})):[K],curSelCarrInfo:Ze,curSelSeatPosInfo:Re,returnChangeInsSelectInfo:pt,selectedCoupon:zi,priceInfo:li,isTransit:d,trainTransferInfos:S,vendorID:w,onClickDefaultBooking:function(){mc("default"),ic("default")},selectedInsInfo:Wt,onClickNormalBooking:function(){return pc(!1,!1)},usePointFlag:Es}),y&&(0,I.jsx)(te,{train:h,selectDate:v,rescheduleInfo:Z,rescheduleTicketInfo:fs,rescheduleCode:P,reschedulePrice:vs,originPrice:ks}),(0,I.jsx)(U,{returnChangeInsInfo:gt,visible:Tt&&!Es,onClickAccept:Ue("ordinaryBookingClickAcceptChangeIns",$r),onClickReject:Ue("ordinaryBookingClickRejectChangeIns",ec)}),(0,I.jsx)(se,{visible:Ui,orderId:Wi,loadOrder:Wr,selectedPassengers:si,onClose:function(){return Ki(!1)}}),(0,I.jsx)(oe,{alertInfo:ia,visible:$i,orderBody:us,createOrder:cc,onClose:function(){return ea(!1)}}),(0,I.jsx)(Be,{visible:qa.visible,isTransit:d,data:T.transferAlertInfo,defaultPackage:jn,close:tc,done:nc}),(0,I.jsx)(Fe,{insAlertExtendInfo:zt,insPopVisible:Lt&&!Es,selectedPassengers:si,train:h,insProList:Zt,onClickNormalBooking:Ue("ordinaryBookingClickInsPopNormalBooking",pc)}),on.length>0&&(0,I.jsx)(G,{packageList:on,selectedPackage:xn,packagePopVisible:xa,setPackagePopVisible:Ue("ordinaryBookingClickPackagePopVisible",ga),onVendorIDChange:Ue("ordinaryBookingVendorIDChange",An),onSelectedPackageChange:Ue("ordinaryBookingSelectedPackageChange",gn),login12306Name:_i}),(0,I.jsx)(ze,{setSelectedAssigneePassengers:tr,totalPoint:Bs,priceInfo:li,pointTipPop:Xs,pointNotEnoughPop:Ks,setPointNotEnoughPop:Gs,setPointTipPop:Js,onClickNormalBooking:pc,passengerRef:ur,setUsePointFlag:Ys})]})},We=qe,Xe=S().dayjs,Je=S().trackPage,Qe=S().trackInitData,$e=S().initCoffeebeanTaro,et=S().getToken;$e({path:"pages/trainBooking/booking/ordinary/index",code:"CB61a2c1d54e19122eb2a2251181c7ab18"},{cwx:f()});var tt=f().train,nt=function(e){(0,u.Z)(n,e);var t=(0,d.Z)(n);function n(e){var i,a;return(0,o.Z)(this,n),a=t.call(this,e),a.checkPerformance=!0,Je(),Qe("cwxTrain",f().train,(function(e){f().train=e})),tt=f().train,a.pageId=k.Z.ordinaryBooking,a.state=(0,c.Z)((0,c.Z)({loginFlag:!1,train:tt.train,isThenByTrainTicket:null===(i=tt.train)||void 0===i?void 0:i.isThenByTrainTicket,selectDate:tt.selectDate,trainsit:tt.trainsitObj,isReschedule:tt.isReschedule,rescheduleCode:+tt.rescheduleCode,rescheduleInfo:(0,N.Zs)(tt.rescheduleInfo),isBed:!1,isBupiao:!1,statusBarHeight:0,configData:{},internationalConfig:{},trainTransferInfos:[]},a.formatTransitInfo((0,N.Zs)(tt.transitObj||tt.transitObjSplit))),a.initalTrain((0,N.Zs)(tt.train))),console.log("\u521d\u59cb\u5316 state",a.state),tt.trainsit={},tt.transitObj={},tt.transitObjSplit={},a}return(0,l.Z)(n,[{key:"onLoad",value:function(e){var t=this;x().hideShareMenu({menus:["shareAppMessage","shareTimeline"]});var n=x().getSystemInfoSync();this.setState({statusBarHeight:n.statusBarHeight});var i=e.vendorID;this.setState({vendorID:i});var a=(0,N.Zs)(tt.train||{}),s=(0,N.$U)(e),c=e.data||{},o=c.isBupiao,l=void 0===o?!!e.cancelRobToOrdinary:o;if(this.getConfigInfos(),this.setState({isBupiao:l}),e.orderSource&&(tt.orderSource=e.orderSource),s.trainName){var u={departStation:s.dStation,arriveStation:s.aStation,departDate:s.dDate,trainName:s.trainName},d=function(e){var t=e.departureTime.split(":"),n=(0,r.Z)(t,2),i=n[0],a=n[1],s=(new Date).getTime(),c=Xe(e.departureDate).hour(i).minute(a).valueOf();return c-s>0},m=function(e){N.ZP.showModal({m:e,confirmText:"\u56de\u5217\u8868\u9875",done:function(e){e.confirm&&f().redirectTo({url:"/pages/train/list/list?".concat(N.ZP.outparamsToString(s))})}})};(0,N.Ab)(u).then((function(e){var n,i;return N.ZP.hideLoading(),null!==e&&void 0!==e&&null!==(n=e.seatList)&&void 0!==n&&n.length?d(e)?(tt.selectDate=s.dDate,s.seat&&(null===e||void 0===e||e.seatList.forEach((function(e){e.seatTypeName===s.seat&&(i=e)}))),i&&s.seat?(e.isJianLou=!i.seatInventory,e.seatName=i.seatTypeName,e.price=i.seatPrice,void t.setState(t.initalTrain(e))):m("\u672a\u627e\u5230\u76f8\u5e94\u5750\u5e2d")):m("\u5df2\u8fc7\u53d1\u8f66\u65f6\u95f4\uff0c\u8bf7\u9009\u62e9\u5176\u4ed6\u8f66\u6b21"):m("\u672a\u627e\u5230\u8be5\u8f66\u6b21\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9")})).catch((function(){N.ZP.hideLoading(),m("\u7cfb\u7edf\u5f02\u5e38\uff0c\u8bf7\u91cd\u8bd5")}))}else a||N.ZP.showModal({m:"\u7cfb\u7edf\u5f02\u5e38\uff0c\u8bf7\u91cd\u8bd5"});N.ZP.setBookStore()}},{key:"componentDidShow",value:function(){var e=this;N.ZP.ubtTrace("TCWBuyFill_InsuranceRecall_exposure",{PageId:k.Z.ordinaryBooking,Token:et()});var t=function(){f().user.nonmemberLogin((function(t){0===t.returnCode?e.setState({loginFlag:!0}):(0,N.lX)()}))};f().user.isLogin()?f().user.checkLoginStatusFromServer((function(n){if(n)e.setState({loginFlag:!0});else{if(f().user.logout((function(){console.log("logout")})),"baidu"===T.Z.miniProgramType)return void t();(0,N.lX)()}})):this.hasGoLogin?this.navigateBack():(this.hasGoLogin=!0,(0,N.lX)())}},{key:"formatTransitInfo",value:function(e){if(!e||!e.trainTransferInfos)return{};var t="\u5e95\u90e8\u65b9\u6848";if(e.recommendType){var n=["A","B","C","D","F","E"];t=n[e.recommendType-1]}var i=e.trainTransferInfos.map((function(t){var n=Xe(parseInt(t.departDate.slice(6,19))),i=Xe(parseInt(t.arriveDate.slice(6,19))),a=N.ZP.costTimeString(t.runTime),s=n.format("MM-DD"),r=n.format("YYYY-MM-DD"),o=i.format("YYYY-MM-DD"),l=+n,u=+i;return(0,c.Z)((0,c.Z)({},t),{},{runTimeHM:a,departDatemj:s,departDateymj:r,arriveDateymj:o,departTimeStamp:l,arriveTimeStamp:u,tripType:e.tripType})}));return(0,c.Z)((0,c.Z)({},e),{},{trainTransferInfos:i,isTransit:!!i,trnFromScene:t})}},{key:"initalTrain",value:function(e){var t;if(!e)return{train:{}};var n=(0,c.Z)({},e),i=(null===(t=n.seatName)||void 0===t?void 0:t.indexOf("\u5367"))>-1,a=Xe(n.departTimeStamp).format("MM\u6708DD\u65e5"),s=Xe(n.departTimeStamp).add(n.takeDays,"day").format("MM\u6708DD\u65e5"),r=n.thenByTicketInfo,o={};if(1===(null===r||void 0===r?void 0:r.solutionType)&&1===(null===r||void 0===r?void 0:r.actionType)){var l=Xe(r.leftTicketDepStationDate+" "+r.leftTicketDepStationTime,"YYYYMMDD HH:mm"),u=Xe(r.originInfo.originArriveDate+" "+r.originInfo.originArriveTime,"YYYYMMDD HH:mm");r.ticketInfo={departureStationName:r.leftTicketDepartName,arrivalStationName:r.originInfo.originArriveStation,departureDateTime:l.format("YYYY-MM-DD HH:mm:ss"),arrivalDateTime:u.format("YYYY-MM-DD HH:mm:ss"),trainNumber:r.leftTicketTrainNum,ticketPrice:+r.leftTicketPrice,seatName:n.seatName},o.isCombiSeat=!0}return console.log("\u521d\u59cb\u5316 state \u554a",n,this.state),(0,c.Z)((0,c.Z)({train:n},o),{},{isBed:i,departDateStr:a,disabledDate:a,disabledSeat:n.seatName,arriveDateStr:s,orderSource:tt.orderSource,selectDate:tt.selectDate,allPas:[]})}},{key:"getConfigInfos",value:function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,i,s,r,c,o,l;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,Q.zC)({key:"Ctrip_EleCounterTicketInfo"});case 2:return t=e.sent,n=t.content,i=void 0===n?"":n,e.next=7,(0,Q.Gl)({ConfigKey:"ctrip-transferpage-alert"});case 7:s=e.sent,r=s.configInfo,c=void 0===r?"":r,o=JSON.parse(i),l=JSON.parse(c.content),this.setState({configData:{eleCounterTimeInfo:o,transferAlertInfo:l}});case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onShareAppMessage",value:function(e){if("button"==e.from&&"inviteAddFriend"===e.target.id)return(0,N.MK)(3,this.state.train)}},{key:"componentWillUnmount",value:function(){var e;null!==(e=f().train)&&void 0!==e&&e.train&&(f().train.train=null)}},{key:"render",value:function(){var e=this,t=this.state.loginFlag;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(j._.Provider,{value:{bookingStates:(0,c.Z)({},this.state)},children:[(0,I.jsx)(We,{loginFlag:t}),(0,I.jsx)("authorization-float",{id:"cwxAuthFloat"}),(0,I.jsx)("perinfo-protect-float",{})]}),(0,I.jsx)(g.View,{className:"view-check",onAnimationEnd:function(){return e.viewReadyHandle()}})]})}}]),n}(v.Z),it=nt,at={navigationBarTitleText:"\u8ba2\u5355\u586b\u5199",navigationStyle:"custom",navigationBarBackgroundColor:"#ffffff",navigationBarTextStyle:"black",backgroundColor:"#EEF1F6",usingComponents:{"authorization-float":"@miniapp/cwx/component/authorizationFloat/index","perinfo-protect-float":"@miniapp/cwx/component/perInfoProtectFloat/index"}};it.enableShareAppMessage=!0;Page((0,i.createPageConfig)(it,"pages/trainBooking/booking/ordinary/index",{root:{cn:[]}},at||{}))},79181:function(e){e.exports=require("../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../cwx/ext/global")}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[2119,2107,1216,8592],(function(){return t(40319)}));e.O()}]);
//# sourceMappingURL=index.js.map