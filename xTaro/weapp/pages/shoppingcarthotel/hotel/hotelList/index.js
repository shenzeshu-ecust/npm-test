"use strict";require("../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[8503],{84699:function(e,t,n){var i={};n.r(i),n.d(i,{handleCloseHierarchy:function(){return E},updateCurFilter:function(){return H},updateFetchAndPageStatus:function(){return C},updateFetchStatus:function(){return _},updateFilterHistory:function(){return B},updateFilterSelect:function(){return j},updateHotelList:function(){return N},updatePageIndex:function(){return Q},updatePageStatus:function(){return F},updateParamInfo:function(){return I},updatePayLoad:function(){return D},updatePositionInfo:function(){return q},updateRangeData:function(){return R},updateSelectModel:function(){return V},updateSimpleModel:function(){return T},updateSinglePolicies:function(){return A},updateSlts:function(){return O},updateTotalSlts:function(){return M}});var r={};n.r(r),n.d(r,{updatePageStatus:function(){return z},updateShowTips:function(){return K}});var o={};n.r(o),n.d(o,{getFilterCurStatus:function(){return me},getInitSort:function(){return Ze},getInitSortNew:function(){return ke},getQuickFilters:function(){return ve},getSortValue:function(){return be},handleClearAllSelected:function(){return Le},handleClearQuickFilter:function(){return Pe},handleClearSelectedAll:function(){return Fe},handleClearSelectedOne:function(){return Ne},handleClearSelectedType:function(){return Ie},handleClickQuickFilters:function(){return fe},handleCloseFilterPop:function(){return Se},handleFetchAndClosePop:function(){return xe},handleOpenFilterPop:function(){return we},handleShowSelectedFilter:function(){return Te},handleTempToggleAll:function(){return ge},handleTempToggleOne:function(){return ye},handleToggleAll:function(){return he},handleToggleOne:function(){return de},handleUpdateAndPull:function(){return pe}});var a={};n.r(a),n.d(a,{handleHideDiscount:function(){return De},handleShowDiscount:function(){return Ve},hideError:function(){return Be},hideLoading:function(){return He},hideSkeleton:function(){return Ce},showLoading:function(){return je},showSkeleton:function(){return _e},toggleShowHotelEdit:function(){return Re},updateCurrentFilter:function(){return Ee}});var s={};n.r(s),n.d(s,{setHeaderInfo:function(){return _t},updateShoppingCartConfig:function(){return jt},updateShowTradePrice:function(){return Ct}});var l=n(32180),c=n(298),u=n(57042),d=n(24460),h=n(81876),p=n(21867),f=n(86066),v=n(45023),m=n(90983),y=n(22276),g=n(90129),w=n(68277),S=n(79301),x=n(95308),Z=n(53059),k=n(14930),b=["curFirstType","newSlts","sltsForBottom","type"],P=["curFirstType","newSlts","sltsForBottom","type"],L=k._,T=function(e,t){return(0,c.Z)((0,c.Z)({},e),t)},I=function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{paramInfo:t})},N=function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{hotelList:t})},F=function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{pageStatus:(0,c.Z)((0,c.Z)({},e.pageStatus),t)})},_=function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{fetchStatus:(0,c.Z)((0,c.Z)({},e.fetchStatus),t)})},C=function(e,t){var n=t.fetchStatus,i=t.pageStatus;return(0,c.Z)((0,c.Z)({},e),{},{fetchStatus:(0,c.Z)((0,c.Z)({},e.fetchStatus),n),pageStatus:(0,c.Z)((0,c.Z)({},e.pageStatus),i)})},j=function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{hasMap:t.hasMap,selected:t.selected,positions:t.positions})},H=function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{curFilter:t})},V=function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{hasMap:t.hasMap,selected:t.selected,positions:t.positions})},D=function(e,t){var n=L.cloneDeep(t);if("h5"===e.mapedAppType&&n.selected){var i=L.get(n,["selected","10","0","value"],""),r=e,o=r.rangeData,a=void 0===o?{}:o;if(i){var s=i.split("-");a.priceValues=s,a.priceRange=s}else{var l=a.rangeMin,u=a.rangeMax;a.priceValues=[l,u],a.priceRange=[l,u]}}return e=(0,c.Z)((0,c.Z)({},e),n),n=null,e},B=function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{filterHistory:[].concat((0,y.Z)(e.filterHistory),[t])})},E=function(e){return(0,c.Z)((0,c.Z)({},e),{},{hieObj:{},hierarchyIds:[],curFilter:""})},R=function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{rangeData:(0,c.Z)((0,c.Z)({},e.rangeData),t)})},A=function(e,t){var n=t.hotelId,i=t.Policies;return(0,c.Z)((0,c.Z)({},e),{},{hotelPolicies:(0,c.Z)((0,c.Z)({},e.hotelPolicies),{},(0,v.Z)({},n,i||{}))})},O=function(e,t){var n=t.curFirstType,i=t.newSlts,r=void 0===i?[]:i,o=t.sltsForBottom,a=void 0===o?{}:o,s=(t.type,(0,w.Z)(t,b)),l=L.cloneDeep(null===e||void 0===e?void 0:e.slts)||{},u=L.cloneDeep(null===e||void 0===e?void 0:e.sltsBtn)||{};return L.isEmpty(r)?(delete l[n],delete u[n]):(l=(0,c.Z)((0,c.Z)({},l),{},(0,v.Z)({},n,r)),u=(0,c.Z)((0,c.Z)({},u),{},(0,v.Z)({},n,a))),(0,c.Z)((0,c.Z)((0,c.Z)({},e),s),{},{slts:l,sltsBtn:u})},M=function(e,t){var n,i=t.curFirstType,r=t.newSlts,o=void 0===r?[]:r,a=(t.sltsForBottom,t.type),s=(0,w.Z)(t,P),l=L.cloneDeep(null===e||void 0===e?void 0:e.totalSlts)||{},u=l[a]||{};L.isEmpty(o)?(null===(n=l)||void 0===n||null===(n=n[a])||void 0===n?void 0:n[i])&&delete l[a][i]:l=(0,c.Z)((0,c.Z)({},l),{},(0,v.Z)({},a,(0,c.Z)((0,c.Z)({},u),{},(0,v.Z)({},i,o))));return(0,c.Z)((0,c.Z)((0,c.Z)({},e),s),{},{totalSlts:l})},Q=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e.firstData,r=i.pageIndex,o=null!==t&&void 0!==t?t:r+(n?1:-1);return(0,c.Z)((0,c.Z)({},e),{},{firstData:(0,c.Z)((0,c.Z)({},i),{},{pageIndex:o})})},q=function(e,t){var n=t.top,i=t.positionInfo,r=L.cloneDeep(null===e||void 0===e?void 0:e.filterTypes);return r.map((function(e){e.listProps.wrapperStyle.top=n})),(0,c.Z)((0,c.Z)({},e),{},{filterTypes:r,positionInfo:(0,c.Z)((0,c.Z)({},e.positionInfo),i)})},W=n(96854),K=function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{showTips:t})},z=function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{pageStatus:(0,c.Z)((0,c.Z)({},e.pageStatus),t)})},U=n(95565),G=n(17394),$=n(93212),Y=["name"],X=k._;function J(e){var t;if("object"===(0,$.Z)(e))for(var n in t=Array.isArray(e)?[]:{},e)e.hasOwnProperty(n)&&("object"!==(0,$.Z)(e[n])?t[n]=e[n]:t[n]=J(e[n]));else t=e;return t}var ee,te=function(e){return e["LandMark"]="spot",e["Zone"]="4",e["Location"]="3",e["MetroStation"]="metro",e}(te||{}),ne=function(e){return function(e){(0,p.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;(0,u.Z)(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),(0,v.Z)((0,h.Z)(e),"query",{}),(0,v.Z)((0,h.Z)(e),"staticParams",{}),(0,v.Z)((0,h.Z)(e),"parameter",{}),(0,v.Z)((0,h.Z)(e),"isAbroad",!1),(0,v.Z)((0,h.Z)(e),"centerName",""),e}return(0,d.Z)(n,[{key:"initHotelParam",value:function(e){this.query=e,this.initParams(),this.centerName=""}},{key:"params",get:function(){return(0,c.Z)((0,c.Z)({},this.staticParams),{},{Parameter:J(this.parameter)})}},{key:"pageIndex",get:function(){var e;return(null===this||void 0===this||null===(e=this.parameter)||void 0===e||null===(e=e.Sort)||void 0===e?void 0:e.PageIndex)||1},set:function(e){this.parameter.Sort.PageIndex=e}},{key:"pageSize",get:function(){var e;return(null===this||void 0===this||null===(e=this.parameter)||void 0===e||null===(e=e.Sort)||void 0===e?void 0:e.PageSize)||10},set:function(e){this.parameter.Sort.PageSize=e}},{key:"map",get:function(){var e;return(null===this||void 0===this||null===(e=this.parameter)||void 0===e?void 0:e.Map)||{}},set:function(e){if(this.parameter&&this.parameter.Map){var t=e.name,n=(0,w.Z)(e,Y);this.parameter.Map=(0,c.Z)((0,c.Z)({},this.parameter.Map),n),this.centerName=t||this.centerName}}},{key:"sortValue",get:function(){var e;return(null===this||void 0===this||null===(e=this.parameter)||void 0===e?void 0:e.Sort)||{}},set:function(e){this.parameter&&this.parameter.Sort&&this.parameter.Map&&(this.parameter.Sort.Direction=e.Direction,this.parameter.Sort.OrderBy=e.OrderBy,2===e.Direction&&8===e.OrderBy&&this.parameter.Map.DotX&&this.parameter.Map.DotY&&(this.parameter.Map.IsQuery=!0))}},{key:"keyword",set:function(e){this.parameter.Keyword=e}},{key:"orderByDis",value:function(){this.parameter.Sort.Direction=2,this.parameter.Sort.OrderBy=8}},{key:"hotSpaceFunc",value:function(e){var t=e.poiType,n=te[t];this.defaultFunc((0,c.Z)((0,c.Z)({},e),{},{tempPosition:[n]}))}},{key:"brandFunc",value:function(e){var t=e.value,n=void 0===t?"":t,i=e.type;n&&("1"===i?this.parameter.HotelBrandList.push(n):"2"===i&&this.parameter.HotelGroupList.push(n))}},{key:"cityFunc",value:function(e){var t=e.lat,n=e.lon,i=e.name,r=e.value;this.staticParams.ProvinceId=0,this.staticParams.CityId=Number(r),this.map={DotX:t,DotY:n,IsQuery:!1,name:i}}},{key:"defaultFunc",value:function(e){var t=e.position,n=e.tempPosition,i=void 0===n?t:n,r=e.value,o=void 0===r?"":r;if(o){var a={99:"8",metro:"18"},s=Number(a[i[0]]||i[0]),l=this.parameter.Filters.find((function(e){return e.Id===s}))||{Id:s,Values:[]};l.Values.push(o),1===l.Values.length&&this.parameter.Filters.push(l)}}},{key:"disFunc",value:function(e){var t=e.value;"auto"===t&&(t=this.isAbroad?"10":"4",this.orderByDis()),this.map={Distance:t,IsQuery:!0}}},{key:"priceFunc",value:function(e){var t=e.value,n=void 0===t?"":t,i=n.split("-");2===i.length&&(this.parameter.Price={LowPrice:Number(i[0]),HighPrice:Number(i[1])})}},{key:"selected2Param",set:function(e){var t=this,n=e.selected,i=e.positions,r={hotSpace:this.hotSpaceFunc,"2_24":this.brandFunc,10:this.priceFunc,11:this.disFunc,16:this.cityFunc};i.map((function(e){var i=X.get(n,e);i.forEach((function(e){var n=e.lat,i=e.lon,o=e.name,a=e.position,s=e.isMap;if(s)t.map={DotX:n,DotY:i,IsQuery:!0,name:o},t.orderByDis();else{var l=r[a[0]]||t.defaultFunc;l.bind(t)(e)}}))}))}},{key:"initParams",value:function(){var e=this.query,t=e.type,n=void 0===t?"":t,i=e.typeid,r=void 0===i?0:i,o=e.cidt,a=void 0===o?"":o,s=e.codt,l=void 0===s?"":s,c=e.cityid,u=void 0===c?0:c,d=e.shoppingid,h=void 0===d?"":d,p=e.slthotelid,f=void 0===p?0:p,v=e.slthoteltoken,m=e.orderid,y=e.segment,g=e.sltroomtoken,w=e.isabroad;this.isAbroad=w;var S=n.indexOf("Province")>-1?Number(r):0;this.staticParams={CheckInDate:a,CheckOutDate:l,ShoppingId:h,ProvinceId:S,CityId:S?0:Number(u),ActionType:f?2:1,SegmentNumber:Number(y),HotelTokenTBChanged:v,OrderId:m,RoomTokenTBChanged:g,SelectedHotelId:f||("Hotel"===n?r:"")},this.parameter={Filters:[],Keyword:"",Map:{},Sort:{Direction:1,OrderBy:w?6:1,PageIndex:1,PageSize:10},Price:{},HotelBrandList:[],HotelGroupList:[],BasicRoomCount:1}}}]),n}(e)},ie=n(87406),re=(k._,(0,d.Z)((function e(t){var n=this;(0,u.Z)(this,e),(0,v.Z)(this,"traceLog",void 0),(0,v.Z)(this,"traceLogHotelClick",(function(e,t,i){var r=i.hotelList,o=void 0===r?[]:r,a=(i.recList,i.sortValue),s=void 0===a?{}:a,l=i.selected,u=void 0===l?{}:l,d=i.positions,h=void 0===d?[]:d,p=i.searchInfo,f=void 0===p?{}:p,v=(0,W.getFilterTrackValue)(u,h),m=f.type,y=f.word,g=(0,W.getHotelTraceInfo)(e,t,{positions:h,hotelList:o,sortValue:s,filter:v,type:m,word:y});g=(0,c.Z)((0,c.Z)({},g),{},{pkgid:g.hotelid,sortid:g.seq,subsortid:g.subseq}),delete g.hotelid,delete g.seq,delete g.subseq,n.traceLog(ie.HW.CLICK,g)})),(0,v.Z)(this,"traceLogPricePop",(function(){return n.traceLog(ie.HW.PRICEPOP)})),(0,v.Z)(this,"traceLogSearch",(function(e){n.traceLog(ie.HW.SEARCH,{bu:"dp2.0",kwd:e})})),(0,v.Z)(this,"traceLogFilter",(function(e,t){var i=(0,W.getFilterValue)({selected:t.selected,positions:t.positions,filterObj:e},t.isAbroad);n.traceLog(ie.HW.FILTER,{filtervalue:i})})),this.traceLog=t}))),oe=re,ae=n(94628),se=n(32180)["document"],le=["needUpdate"],ce=k._,ue=function(e,t){var n=t.store,i=t.actions,r=n.getState(),o=r.quickFilters,a=r.urlQuery,s=r.filterHistory,l=(0,y.Z)(s||[]),u=i.updatePayLoad,d=e.value,h=e.position,p=void 0===h?[]:h,f=e.isRadio,v=void 0===f||f,m=e.name,g=p[0],w=ce.some(o,(function(e){return ce.get(e,["position","0"],"")===g&&e.value===d})),S=["99","coordinate"],x=ce.some(S,(function(e){return e===g}));w||x||!m||(v&&ce.remove(l,(function(e){return ce.get(e,["position","0"],"")===g})),l.push((0,c.Z)((0,c.Z)({},e),{},{cityId:ce.some(ie.uf.space,(function(e){return e===g}))?a.cityid:"",showType:"history"})),l=ce.uniqBy(l,(function(e){return e.name})),u({filterHistory:l}))},de=function(e,t){var n=e.store,i=e.actions,r=e.HotelParams,o=e.SelectModel,a=e.trace,s=n.getState(),l=i.updatePayLoad,c=i.handlePullNew,u=s.sort,d=s.sortValue,h=t.needSelect,p=t.type,f=t.selectObj,v=void 0===f?{}:f,m=t.isQuick,y=void 0!==m&&m,g=t.needUpdate,w=void 0===g||g,S=t.isSearch,x=void 0!==S&&S,Z=v.position,k=void 0===Z?[]:Z;console.log(t,"toggle");var b=y?(0,ae.uP)(v):p,P=["3","4"],L=ce.some(o.positions,(function(e){return"coordinate"===e[0]}));if(L&&ce.some(P,(function(e){return e===k[0]}))){ce.set(o.selected,["coordinate"],null),ce.remove(o.positions,(function(e){return"coordinate"===e[0]})),r.hasMap=!1;var T,I=ce.get(o.selected,["11","0","value"],"");if("auto"===I)ce.set(o.selected,["11"],null),8===(null===(T=r.sortValue)||void 0===T?void 0:T.OrderBy)&&(r.sortValue=u[0]);r.map={name:s.cityCenter.name,DotX:s.cityCenter.lat,DotY:s.cityCenter.lon,IsQuery:!1,Distance:""}}if(o.toggleSelectOne(t),ue(v,e),w){var N,F=s.searchKeyWord;l({searchKeyWord:x?F:r.parameter.Keyword,sortValue:be(u,r.sortValue,d),selected:o.selected,positions:o.positions},"clickFilters",{value:"".concat(h?"\u9009\u4e2d":"\u53d6\u6d88\u9009\u4e2d").concat(null===v||void 0===v?void 0:v.name)}),c({isFilter:!0,isSearch:x}),x||a.traceLogFilter(null===s||void 0===s||null===(N=s.filterObj)||void 0===N?void 0:N[b],o)}},he=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t,n){var i,r,o,a,s,l,c;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=t.actions,r=t.SelectModel,t.trace,o=i.handlePullNew,a=i.updatePayLoad,s=n.needUpdate,l=void 0===s||s,c=(0,w.Z)(n,le),r.toggleSelectAll(c),a({selected:r.selected,positions:r.positions}),l&&o({isFilter:!0});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),pe=function(e){var t=e.actions,n=e.SelectModel,i=t.updatePayLoad,r=t.handlePullNew;i({selected:n.selected,positions:n.positions}),r({isFilter:!0})},fe=function(e,t){var n=e.store,i=e.actions,r=n.getState(),o=i.updatePayLoad,a=t.isCur,s=t.item,l=s.showType,u=s.position,d=s.id;switch(l){case"hierarchy":var h=(0,W.getQuickIds)({ids:r.hierarchyIds||[],data:u[0]||d,isCur:a});o({curFilter:a?"":"quick",hieObj:a?{}:s,hierarchyIds:h});break;case"combination":var p=(0,W.getQuickIds)({ids:r.combinationIds||[],data:d,isCur:a});o({combinationIds:p});var f=s.childQuickFilters,v=void 0===f?[]:f;ce.each(v,(function(t){ce.each(t.childQuickFilters||[],(function(t){de(e,{isQuick:!0,needSelect:!a,selectObj:(0,c.Z)((0,c.Z)({},t),{},{isRadio:1===t.type,position:["".concat(t.id)]}),needUpdate:!1})}))})),pe(e);break;case"flat":case"history":de(e,{isQuick:!0,needSelect:!a,selectObj:s});break;default:break}},ve=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t,n){var i,r,o,a,s,l,c,u,d,h,p,f,v,m,g,w=arguments;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=w.length>2&&void 0!==w[2]?w[2]:"h5",r=t.store,o=t.storage,a=r.getState(),s=a.urlQuery,l=a.rangeData,c=a.hasShell,u=s.cityid,d=l.rangeMax,h=["h5","ctrip"],!h.includes(i)){e.next=22;break}return e.next=9,null===o||void 0===o?void 0:o.get("filterHistory");case 9:if(e.t0=e.sent,e.t0){e.next=12;break}e.t0=[];case 12:return p=e.t0,f=(0,y.Z)(p),v=(null===n||void 0===n?void 0:n.allQuickFilters)||[],c&&(m=[25,32],ce.remove(v,(function(e){return m.includes(e.id)}))),g=ce.some(v,(function(e){return 32===e.id})),ce.remove(p,(function(e){var t=e.cityId&&e.cityId!==u;if(!t&&10===e.id){var n,i=null===e||void 0===e||null===(n=e.value)||void 0===n?void 0:n.split("-");t=Number(i[0])>d||2147483647!==Number(i[1])&&Number(i[1])>d}return t})),v.splice.apply(v,[g?2:1,0].concat((0,y.Z)(p))),e.abrupt("return",{quickFilters:v,filterHistory:f,hierarchyFilters:null===n||void 0===n?void 0:n.hierarchyFilters});case 22:return e.abrupt("return",{quickFilters:null===n||void 0===n?void 0:n.flatQuickFilters});case 23:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),me=function(e){var t=e.item,n=e.selected,i=e.autoValue,r=t.position,o=t.type,a=t.value;return ce.some(ce.get(n,r,[]),(function(e){switch(r[0]){case"11":return i===a&&"auto"===e.value||e.value===a;case"2_24":return e.value===a&&e.type===o;default:return e.value===a}}))},ye=function(e,t){var n=e.actions,i=e.SelectModel,r=n.updatePayLoad,o=t.selectObj;o.metroPosition=o.position,i.toggleSelectOne(t),r({selected:i.selected,positions:i.positions})},ge=function(e,t,n){var i=e.actions,r=e.SelectModel,o=i.updatePayLoad;r.toggleSelectAll(t),o({selected:r.selected,positions:r.positions})},we=function(e,t){var n=e.actions,i=e.store,r=n.updatePayLoad,o=i.getState(),a=o.selected,s=void 0===a?{}:a,l=o.positions,u=void 0===l?[]:l;se.body.style.cssText="overflow: hidden;height: 100%;",r({filterPopInfo:(0,c.Z)({showFilterPop:!0},t),backupSelected:ce.cloneDeep(s),backupPositions:ce.cloneDeep(u)})},Se=function(e){var t=e.actions,n=e.store,i=e.SelectModel,r=t.updatePayLoad,o=n.getState(),a=o.appType,s=o.selected,l=void 0===s?{}:s,c=o.positions,u=void 0===c?[]:c,d=o.backupSelected,h=void 0===d?l:d,p=o.backupPositions,f=void 0===p?u:p;"online"===a&&(se.body.style.cssText=""),r({filterPopInfo:{showFilterPop:!1},selected:ce.cloneDeep(h),positions:ce.cloneDeep(f),backupSelected:void 0,backupPositions:void 0}),i.initFilterSelect(h,f)},xe=function(e){var t=e.actions,n=e.store,i=e.SelectModel,r=n.getState(),o=r.backupSelected,a=void 0===o?{}:o,s=r.selected,l=r.positions,c=r.sort,u=r.sortValue;if(ce.isEqual(i.selected,a))Se(e);else{var d=t.updatePayLoad,h=t.handlePullNew,p=ce.get(s,["11"],[])[0],f=ce.some(l,(function(e){return["3","4"].includes(e[0])})),v=p&&"auto"===p.value&&!f;d({backupSelected:void 0,backupPositions:void 0,sortValue:v?c[4]:u}),Se(e),h({isFilter:!0})}},Ze=function(e){return[{name:e("#recommendSort"),Direction:1,OrderBy:1},{name:e("#commentSort"),Direction:1,OrderBy:2},{name:e("#priceSort"),directions:[2,1],directionsName:[e("#priceSort1"),e("#priceSort2")],OrderBy:4},{name:e("#starSort"),directions:[2,1],directionsName:[e("#starSort2"),e("#starSort1")],OrderBy:5},{name:e("#distanceSort"),Direction:2,OrderBy:8}]},ke=function(e){return[{name:e("#recommendSort"),valueType:'{"filterId":"17|1","type":"17","value":"1","subType":"2","childValue":"","propertyValue":""}',OrderBy:1},{name:e("#commentSort"),valueType:'{"filterId":"17|6","type":"17","value":"6","subType":"2","childValue":"","propertyValue":""}',OrderBy:2},{name:e("#priceSort"),valueTypes:['{"filterId":"17|3","type":"17","value":"3","subType":"2","childValue":"","propertyValue":""}','{"filterId":"17|4","type":"17","value":"4","subType":"2","childValue":"","propertyValue":""}'],typesName:[e("#priceSort1"),e("#priceSort2")],OrderBy:3},{name:e("#starSort"),valueType:'{"filterId":"17|14","type":"17","value":"14","subType":"2","childValue":"","propertyValue":""}',OrderBy:4},{name:e("#distanceSort"),valueType:'{"filterId":"17|5","type":"17","value":"5","subType":"2","childValue":"","propertyValue":""}',OrderBy:5}]},be=function(e,t,n){t.Direction;var i=t.OrderBy,r=(t.name,n.Direction),o=n.OrderBy;8===i&&e[e.length-1].name;var a=ce.find(e,(function(e){return e.OrderBy===o&&(e.Direction===r||e.directions&&e.directions.includes(r))}))||{};return(0,c.Z)((0,c.Z)({},a),{},{name:a.directions?a.directionsName[Math.abs(r-2)]:a.name,Direction:r})},Pe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.actions,i=e.SelectModel,r=n.updatePayLoad,o=n.handlePullNew;ce.forEach(t,(function(t){de(e,{needSelect:!1,needUpdate:!1,selectObj:t})})),r({selected:i.selected,positions:i.positions}),o({isFilter:!0})},Le=function(e){var t=e.actions,n=e.SelectModel,i=t.updatePayLoad,r=t.handlePullNew;n.initFilterSelect(),i({selected:n.selected,positions:n.positions}),r({isFilter:!0})},Te=function(e,t,n){var i=e.store,r=e.actions,o=r.updatePayLoad,a=i.getState(),s=a.selectedObj,l=a.typeList,u=a.totalSlts,d=t.isCur,h=t.curFirstType,p=t.filter,f=t.sltsArray,m=t.newSlts;if(console.log("==========>source",t),d){var g=ce.get(s,n,[]);ce.remove(g,(function(e){return(null===e||void 0===e?void 0:e.type)===p.type})),g.length||ce.remove(l,(function(e){return e===n})),o({selectedObj:s,typeList:l})}else{var w=ce.get(s,n,[]),S=[].concat((0,y.Z)(w),[(0,c.Z)((0,c.Z)({},p),{},{curFirstType:h,newSlts:m})]);if(ce.remove(S,(function(e){return!ce.some(f,{type:e.type})})),"SPACE"===n){var x=u.SPACE,Z=void 0===x?{}:x;ce.remove(S,(function(e){return!Z[e.curFirstType]}))}o({selectedObj:(0,c.Z)((0,c.Z)({},s),{},(0,v.Z)({},n,S)),typeList:ce.uniq([].concat((0,y.Z)(l),[n]))})}},Ie=function(e,t){console.log("handleClearSelectedType==============>");var n=e.store,i=e.actions,r=i.updatePayLoad,o=n.getState(),a=o.selectedObj,s=o.typeList;o.filterObj,o.filterKey;a[t]=[];var l=s.filter((function(e){return e!==t}));r({selectedObj:a,typeList:l})},Ne=function(e,t,n){console.log("handleClearSelectedOne==============>");var i=e.store,r=e.actions,o=r.updatePayLoad,a=r.updateTotalSlts,s=r.fetchHotelListNew,l=i.getState(),c=l.selectedObj,u=l.typeList,d=l.filterObj,h=l.filterKey,p=void 0===h?0:h,f=t.newSlts,v=t.curFirstType;ce.remove(f,(function(e){return e===t.type}));var m=ce.get(c,n,[]);ce.remove(m,(function(e){return(null===e||void 0===e?void 0:e.type)===t.type})),m.length||ce.remove(u,(function(e){return e===n}));var y=ce.get(d,n.toLowerCase(),[]);ce.each(y.subs,(function(e){e.type===t.curFirstType&&e.lastBottom&&e.lastSlt&&(e.lastSlt=e.lastSlt.filter((function(e){return e!==t.type})),e.lastBottom&&e.lastBottom[t.type]&&delete e.lastBottom[t.type])})),o({selectedObj:c,typeList:u,filterObj:d,filterKey:p+1}),a({type:n,newSlts:f,curFirstType:v,isCur:!0}),s(!1,!0)},Fe=function(e){var t=e.store,n=e.actions,i=n.updatePayLoad,r=n.fetchHotelListNew,o=t.getState(),a=o.selectedObj,s=(o.typeList,o.filterObj),l=o.filterKey,c=void 0===l?0:l;ce.forEach(a,(function(e){ce.each(e,(function(e){ce.forEach(s,(function(t){ce.each(t.subs,(function(t){t.type===e.curFirstType&&t.lastBottom&&t.lastSlt&&(t.lastSlt=t.lastSlt.filter((function(t){return t!==e.type})),t.lastBottom&&t.lastBottom[e.type]&&delete t.lastBottom[e.type])}))}))}))})),i({totalSlts:{},selectedObj:{},typeList:[],filterObj:s,filterKey:c+1}),r(!1,!0)},_e=(k._,function(e){var t=e.actions.updatePayLoad,n={showSkeleton:!0,needTop:!1};t({skeletonInfo:n})}),Ce=function(e){var t=e.actions.updatePayLoad,n={showSkeleton:!1,needTop:!1};t({skeletonInfo:n})},je=function(e){var t=e.actions.updatePayLoad,n={showBottom:!0,showError:!1,showCircle:!0,text:"\u52a0\u8f7d\u4e2d..."};t({bottomInfo:n})},He=function(e){var t=e.actions.updatePayLoad,n=e.store,i=n.getState(),r=i.allFinish;if(!r){var o={showBottom:!1,showCircle:!1};t({bottomInfo:o})}},Ve=function(e,t){var n=e.actions.updatePayLoad,i=e.trace;n({showPricePop:!0,popInfo:t}),i.traceLogPricePop()},De=function(e){var t=e.actions.updatePayLoad;t({showPricePop:!1})},Be=function(e){var t=e.actions.updatePayLoad;t({errorInfo:{showError:!1}})},Ee=function(e,t){for(var n=e.actions.updatePayLoad,i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];n.apply(void 0,[{curFilter:t}].concat(r))},Re=function(e){var t=e.actions.updatePageStatus,n=e.store,i=(e.trace,n.getState()),r=i.pageStatus.showHotelEdit;i.pageId;t({showHotelEdit:!r})},Ae=k._,Oe=(0,d.Z)((function e(t){var n=this;(0,u.Z)(this,e),(0,v.Z)(this,"store",void 0),(0,v.Z)(this,"actions",void 0),(0,v.Z)(this,"context",void 0),(0,v.Z)(this,"getSharkValue",void 0),(0,v.Z)(this,"platform",void 0),(0,v.Z)(this,"isRN",void 0),(0,v.Z)(this,"isOnline",void 0),(0,v.Z)(this,"onSelectFilter",(function(e,t){var i=e.isCur,r=e.list,o=void 0===r?[]:r,a=e.newSlts,s=e.curFirstType,l=e.sltsForBottom;console.log("onSelectFilter",i,o,a,s);var c=n.actions,u=c.updateSlts,d=c.updatePageIndex,h=c.updateTotalSlts,p=(c.updatePayLoad,n.isRN||n.isOnline?h:u);p({curFirstType:s,newSlts:a,sltsForBottom:l,type:t}),d(1)})),(0,v.Z)(this,"onSelectSort",(function(e){var t=e.isCur,i=e.filter,r=e.newSlts,o=(e.curFirstType,n.store.getState()),a=o.filterTypes,s=n.actions,l=s.updatePayLoad,c=s.updatePageIndex;if(!t){var u=(0,g.Z)(r,1),d=u[0],h=Ae.cloneDeep(a);h[0].defTitle=i.text,h[0].listProps.lastSlt=r,l({sort:d,filterTypes:h})}c(1)})),(0,v.Z)(this,"onSelectSpace",(function(e){var t=e.isCur,i=e.list,r=void 0===i?[]:i,o=e.newSlts,a=e.curFirstType,s=e.setTotalSum,l=e.setSltsArray,c=e.sltsForBottom,u=e.filter,d=void 0===u?{}:u;console.log("onSelectSpace",t,r,d,o,a);var h=n.store.getState(),p=h.totalSlts,f=n.actions,v=(f.updatePayLoad,f.updatePageIndex),m=f.updateTotalSlts,y=0;if(!t&&a!==ie.EY.distance){r.forEach((function(e){var t;if(e.selfType===ie.B2.distance);else if(a!==e.type){var n;(null===p||void 0===p||null===(n=p.SPACE)||void 0===n?void 0:n[e.type])&&m({curFirstType:e.type,newSlts:[],type:"SPACE"}),delete e.lastSlt,delete e.lastBottom}null!==e&&void 0!==e&&null!==(t=e.lastSlt)&&void 0!==t&&t.length&&(y+=e.lastSlt.length)}));var g=[];r.forEach((function(e,t){if(null!==e&&void 0!==e&&e.lastBottom){var n=e.lastBottom;for(var i in n)n[i]&&g.push({_index:e.type,type:i,text:n[i]})}}));try{null===l||void 0===l||l(g)}catch(e){console.log(e)}}return n.onSelectFilter({isCur:t,list:r,newSlts:o,curFirstType:a,sltsForBottom:c},"SPACE"),y&&s(y),v(1),{changeList:!t,list:r}})),(0,v.Z)(this,"onMMSelectSpace",(function(e){var t,i=e.isCur,r=e.list,o=e.newSlts,a=e.curFirstType,s=e.setTotalSum,l=e.sltsForBottom,c=e.filter,u=void 0===c?{}:c;console.log("onSelectSpace",i,r,u,o,a);var d=n.store.getState(),h=d.slts,p=u.lat,f=u.lon,m=a===ie.fw.zoneDetailList,g=p&&f&&(!m||1===o.length),w=n.store.getState(),S=w.urlQuery.isabroad,x=w.cityCenter,Z=w.filterTypes,k=void 0===Z?[]:Z,b=n.actions,P=b.updatePayLoad,L=b.updatePageIndex,T=b.updateSlts,I=(0,y.Z)(k),N=null===I||void 0===I||null===(t=I[1])||void 0===t?void 0:t.listProps,F=0;if(i||r.forEach((function(e){var t;if(e.type===ie.fw.distance){if(!e.lastSlts&&g&&!m){var i=S?"10":"4",o="".concat(i,"\u516c\u91cc\u4ee5\u5185"),s=[i];e.lastSlt=s,n.onSelectFilter({isCur:!1,list:r,newSlts:s,sltsForBottom:(0,v.Z)({},i,o),curFirstType:ie.fw.distance})}}else a!==e.type&&(console.log("\u5f53\u524d\u5df2\u9009\uff0c\u5220\u9664\uff01"),(null===h||void 0===h?void 0:h[e.type])&&T({curFirstType:e.type,newSlts:[]}),delete e.lastSlt,delete e.lastBottom);null!==e&&void 0!==e&&null!==(t=e.lastSlt)&&void 0!==t&&t.length&&(F+=e.lastSlt.length,console.log(F,e.type))})),g){var _={mapFilter:i?x:u};if(m)n.onSelectFilter({isCur:i,list:r,newSlts:o,curFirstType:a,sltsForBottom:l});else{var C=n.store.getState(),j=C.filterTypes,H=(C.sltsBtn,ie._G[5]),V=Ae.cloneDeep(j);V[0].defTitle=H.text,V[0].listProps.lastSlt=[H.type],_.sort=H.type,_.filterTypes=V}P(_)}else n.onSelectFilter({isCur:i,list:r,newSlts:o,curFirstType:a,sltsForBottom:l});return F&&(N.sum=F,P({filterTypes:I}),s(F)),console.log(F,N),L(1),{changeList:!i,list:r}})),(0,v.Z)(this,"onSelectFlatQuick",(function(e,t,i,r,o){var a,s=i.newSlts,l=i.newSltBottom,u=t.type,d=t.parentType,h=t.isRadio,p=t.text,f=[ie.fw.commentNums,ie.fw.score].includes(d)?ie.fw.comments:d,m=n.getFilterType(f),y=m.filterIndex,g=null===r||void 0===r||null===(a=r[y])||void 0===a?void 0:a.listProps,w=null===g||void 0===g?void 0:g.list;if(e){var S,x;if(h)delete s[f];else s[f]=null===(S=s[f])||void 0===S||null===(x=S.filter)||void 0===x?void 0:x.call(S,(function(e){return e!==u}));delete l[f][u]}else{if(h)s[f]=[u];else{var Z=s[f]||[];Z.push(u),s[f]=Z}l[f]=(0,c.Z)((0,c.Z)({},l[f]||{}),{},(0,v.Z)({},u,p))}if(!o){var k,b,P=s[f],L=l[f];if(w=null===(k=w)||void 0===k?void 0:k.map((function(e){return(null===e||void 0===e?void 0:e.type)===f&&(e.lastSlt=P,e.lastBottom=L),e})),g)g.sum=null===(b=w)||void 0===b?void 0:b.reduce((function(e,t){var n;return e+=(null===(n=t.lastSlt)||void 0===n?void 0:n.length)||0,e}),0)}})),(0,v.Z)(this,"onSelectQuick",(function(e,t){var i=n.store.getState(),r=i.slts,o=void 0===r?{}:r,a=i.sltsBtn,s=i.filterTypes,l=(0,c.Z)({},o),u=(0,c.Z)({},a),d=(0,y.Z)(s);if(t.subs)n.onSelectFlatQuick(e,t,{newSlts:l,newSltBottom:u},d,!0),t.subs.forEach((function(t){n.onSelectFlatQuick(e,t,{newSlts:l,newSltBottom:u},d)}));else{var h=s[3];h.listProps;n.onSelectFlatQuick(e,t,{newSlts:l,newSltBottom:u},d)}var p=n.actions,f=p.updatePayLoad,v=p.updatePageIndex;f({slts:l,sltsBtn:u,filterTypes:d}),v(1)})),(0,v.Z)(this,"onSelectBottom",function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t){var i,r,o,a,s,l,c,u,d,h,p,f,v,m,g,w,x,Z,k,b,P,L,T,I,N,F,_,C,j,H;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=t.type,r=t.isMap,o=t.firstType,a=n.store.getState(),s=a.slts,l=a.sltsBtn,c=a.cityCenter,u=a.filterTypes,d=n.actions,h=d.updateSlts,p=d.updatePayLoad,f=d.updatePageIndex,v=(0,y.Z)(u),r?(p({mapFilter:c}),w=(null===(m=v[1])||void 0===m?void 0:m.listProps)||{},x=w.list,Z=void 0===x?[]:x,k=0,Z=null===(g=Z)||void 0===g?void 0:g.map((function(e){var t;(null===e||void 0===e?void 0:e.type)!==ie.fw.distance?e.lastSlt=[]:k=(null===e||void 0===e||null===(t=e.lastSlt)||void 0===t?void 0:t.length)||0;return e})),w&&(w.sum=k)):(T=(0,y.Z)(s[o]||[]).filter((function(e){return e!==i})),(null===l||void 0===l||null===(b=l[o])||void 0===b?void 0:b[i])&&delete l[o][i],I={curFirstType:o,newSlts:T,sltsForBottom:null===l||void 0===l?void 0:l[o]},i===ie.fw.zoneDetailList&&(I.mapFilter=c),h(I),N=n.getFilterType(o),F=N.filterIndex,_=null===v||void 0===v||null===(P=v[F])||void 0===P?void 0:P.listProps,C=null===_||void 0===_?void 0:_.list,j=T[o],C=null===(L=C)||void 0===L?void 0:L.map((function(e){return(null===e||void 0===e?void 0:e.type)===o&&(e.lastSlt=j,e.lastBottom=null===l||void 0===l?void 0:l[o]),e})),_&&(_.sum=null===(H=C)||void 0===H?void 0:H.reduce((function(e,t){var n;return e+=(null===(n=t.lastSlt)||void 0===n?void 0:n.length)||0,e}),0))),f(1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,v.Z)(this,"onClear",(function(e){var t=ie.JW[e],i=n.store.getState(),r=i.slts,o=i.cityCenter,a=(0,c.Z)({},r);t.forEach((function(e){return a[e]&&delete a[e]}));var s,l=n.actions,u=l.updatePayLoad,d=l.updatePageIndex,h={};("SPACE"===e&&(h.mapFilter=o),"SORT"===e)&&(h.sort=null===(s=ie._G[0])||void 0===s?void 0:s.type);u((0,c.Z)({slts:a},h)),d(1)})),(0,v.Z)(this,"onRNClear",(function(e){var t=n.store.getState(),i=t.totalSlts,r=void 0===i?{}:i,o=(t.cityCenter,(0,c.Z)({},r));o[e]&&delete o[e];var a=n.actions,s=a.updatePayLoad,l=a.updatePageIndex;s({totalSlts:o}),l(1)})),(0,v.Z)(this,"getFilterType",(function(e){var t="";for(var n in ie.JW){var i;if(null!==(i=ie.JW[n])&&void 0!==i&&i.includes(e)){t=n.toLowerCase();break}}var r={space:1,star:2,filter:3};return{filterIndex:r[t],filterType:t}}));var i=t.store,r=t.actions,o=t.context,a=t.getSharkValue;this.store=i,this.actions=r,this.context=o,this.getSharkValue=a,this.platform=null===o||void 0===o?void 0:o.platform,this.isRN="CtripApp"===this.platform,this.isOnline="Browser"===this.platform})),Me=Oe,Qe=["HotelListData"],qe=["filterData","firstData"],We=["HotelListData"],Ke=k._,ze=k.moment,Ue=function(e){(0,p.Z)(n,e);var t=(0,f.Z)(n);function n(e){var i;(0,u.Z)(this,n),i=t.call(this,e),(0,v.Z)((0,h.Z)(i),"fetch",void 0),(0,v.Z)((0,h.Z)(i),"store",void 0),(0,v.Z)((0,h.Z)(i),"actions",void 0),(0,v.Z)((0,h.Z)(i),"storage",void 0),(0,v.Z)((0,h.Z)(i),"context",void 0),(0,v.Z)((0,h.Z)(i),"getSharkValue",void 0),(0,v.Z)((0,h.Z)(i),"trace",void 0),(0,v.Z)((0,h.Z)(i),"platform",void 0),(0,v.Z)((0,h.Z)(i),"isRN",void 0),(0,v.Z)((0,h.Z)(i),"isOnline",void 0),(0,v.Z)((0,h.Z)(i),"setStaticParams",(function(e){var t=e.type,n=void 0===t?"":t,i=e.typeid,r=void 0===i?0:i,o=e.cidt,a=void 0===o?"":o,s=e.codt,l=void 0===s?"":s,c=e.cityid,u=void 0===c?0:c,d=e.shoppingid,h=void 0===d?"":d,p=e.slthotelid,f=void 0===p?0:p,v=e.slthoteltoken,m=e.orderid,y=e.segment,g=e.sltroomtoken,w=e.sourcefrom,S=n.indexOf("Province")>-1,x=S?Number(r):0,Z=["order_change","4126"].includes(w)?1:0;return{CheckInDate:a,CheckOutDate:l,ShoppingId:h,ProvinceId:x,CityId:x?0:Number(u),ActionType:Z||(f?2:1),SegmentNumber:Number(y),HotelTokenTBChanged:v,OrderId:m,RoomTokenTBChanged:g,SelectedHotelId:f||("Hotel"===n?r:"")}})),(0,v.Z)((0,h.Z)(i),"fetchHotelListAndFilters",(0,x.Z)((0,S.Z)().mark((function e(){var t,n,r,o,a,s,l,u,d,h,p,f,v,m,y,x,Z,k,b,P,L,T,I,N,F,_,C,j,H,V,D,B,E,R,A,O;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=i.store.getState(),n=t.urlQuery,r=void 0===n?{}:n,o=t.isTour,t.cargoContext,a=t.isInTDS,s=t.hasShell,l=t.appType,u=void 0===l?"h5":l,d=t.hasShell,h=i.context.sharkContext,p=i.actions,f=p.updatePayLoad,v=p.updatePageStatus,e.prev=3,m="query GetHotelList($params: HotelListDataReq) {\n                HotelListData(params: $params) {\n                    hotelList,\n                    mainFinish,\n                    totalCount,\n                    filterData,\n                    firstData\n                }\n            }",y={urlQuery:r,opts:{isTour:o||s,isNew:!0,newFilter:!!i.isRN,appType:u}},x=r.shoppingid,Z=r.roomtoken,k=r.sltprice,b=r.cachekey1,P=void 0===b?x||Z||k?"hotelList_".concat(x,"_").concat(Z,"_").concat(k,"_0"):"":b,f({allFinish:!1}),e.next=10,i.fetch(m,y,P?{cachePolicy:{enableCache:!0,cacheExpireTime:5,cacheLocation:"MEM",cacheKey:P}}:void 0);case 10:return L=e.sent,T=L.HotelListData,I=void 0===T?{}:T,(0,w.Z)(L,Qe),N=I.filterData,F=I.firstData,_=void 0===F?{}:F,C=(0,w.Z)(I,qe),null!==_&&void 0!==_&&_.staticParams||(_.staticParams=i.setStaticParams(null===N||void 0===N?void 0:N.queryInfo),_.PageSize=5),console.log("==========> fetchHotelListAndFilters HotelListData"),j=i.isRN?i.formatFilterData:W.formatFilterData,e.next=20,Promise.all([j(r,N,u,{onClear:i.onClear,onSelectFilter:i.onSelectFilter,onSelectSort:i.onSelectSort,onSelectSpace:i.onSelectSpace,fetchHotelList:i.fetchHotelList}),(0,W.formatHotelData)(C,u,a,h,i.getSharkValue)]);case 20:H=e.sent,V=(0,g.Z)(H,2),D=V[0],B=V[1],f((0,c.Z)((0,c.Z)({firstData:(0,c.Z)((0,c.Z)({},_),{},{pageIndex:1}),slts:{},sltsFilter:{},mapFilter:{},sort:ie._G[0].type},D),B)),v({initDone:!0}),E=C.mainFinish,R=C.hotelList,A=void 0===R?[]:R,O=C.totalCount,(E||A.length>=O)&&(d||"online"===u||"ibu"===u||"h5"===u?i.handleShowAll(A):setTimeout(i.handlePullRecList,0)),e.next=34;break;case 30:e.prev=30,e.t0=e["catch"](3),i.handleInitError(e.t0,u),i.hideLoading();case 34:return e.prev=34,i.hideSkeleton(),e.finish(34);case 37:case"end":return e.stop()}}),e,null,[[3,30,34,37]])})))),(0,v.Z)((0,h.Z)(i),"fetchHotelList",(0,x.Z)((0,S.Z)().mark((function e(){var t,n,r,o,a,s,l,u,d,h,p,f,v,m,y,g,x,Z,k,b,P,L,T,I,N,F,_,C,j,H,V,D,B,E,R,A,O,M,Q,q,K,z,U,G,$,Y,X,J,ee=arguments;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=ee.length>0&&void 0!==ee[0]&&ee[0],n=ee.length>1&&void 0!==ee[1]&&ee[1],r=i.store.getState(),o=r.urlQuery,a=void 0===o?{}:o,s=r.isTour,r.cargoContext,l=r.firstData,u=void 0===l?{}:l,d=r.slts,h=r.totalSlts,p=r.sort,f=r.mapFilter,v=r.isInTDS,m=r.hasShell,y=r.appType,g=void 0===y?"h5":y,x=r.hasShell,Z=r.searchKeyWord,k=void 0===Z?"":Z,b=r.bottomInfo,P=i.context.sharkContext,L=u.staticParams,T=u.PageSize,I=u.cityName,N=u.pageIndex,F=t?1:N,_=i.actions,C=_.updatePayLoad,j=_.updatePageStatus,j({showHotelEmpty:!1}),t&&C({bottomInfo:(0,c.Z)((0,c.Z)({},b),{},{showBottom:!1})}),(i.isRN||i.isOnline)&&!Ke.isEmpty(h))for(V in H={},h)Ke.isEmpty(h[V])||(H=(0,c.Z)((0,c.Z)({},H),h[V]));return console.log("================>totalSlt",H),e.prev=11,(t||n)&&i.showSkeleton(),E="query GetHotelList($params: HotelListDataReq) {\n                HotelListData(params: $params) {\n                    hotelList,\n                    mainFinish,\n                    totalCount,\n                }\n            }",R=a.cachekey1,A=a.keyword,O=a.cityid,M=a.slthotelid,Q={staticParams:L,urlQuery:a,slts:d,totalSlt:H,sort:p,mapFilter:f,opts:{isTour:s||m,isNew:!0,PageSize:T,cityName:I,newFilter:!!i.isRN||!!i.isOnline,pageIndex:F,keyword:k||A,cityId:O,hotelId:M,isProvince:(null===(D=a.type)||void 0===D||null===(B=D.indexOf)||void 0===B?void 0:B.call(D,"Province"))>-1?2:0,appType:g}},C({allFinish:!1}),e.next=20,i.fetch(E,Q,R?{cachePolicy:{enableCache:!0,cacheExpireTime:5,cacheLocation:"MEM",cacheKey:R}}:void 0);case 20:q=e.sent,K=q.HotelListData,z=void 0===K?{}:K,(0,w.Z)(q,We),console.log("=====> fetchHotelList end"),U=(0,W.formatHotelData)(z,g,v,P,i.getSharkValue),G=U.hotelList,F>1&&($=i.store.getState(),Y=$.hotelList,G=Y.concat(G)),C(t?(0,c.Z)((0,c.Z)({firstData:(0,c.Z)((0,c.Z)({},u),{},{pageIndex:1}),slts:{},totalSlts:{},sltsFilter:{},sort:i.isOnline?p:ie._G[0].type},U),{},{hotelList:G}):(0,c.Z)((0,c.Z)({},U),{},{hotelList:G})),X=z.mainFinish,J=z.totalCount,console.log("=====> fetchHotelList hotelList.length, isNewPull, mainFinish, totalCount",G.length,t,X,J),(X||G.length>=J)&&(x||"online"===g||"ibu"===g||"h5"===g?i.handleShowAll(G,[],t):setTimeout(i.handlePullRecList,0)),e.next=38;break;case 34:e.prev=34,e.t0=e["catch"](11),console.log(e.t0),i.handleInitError(e.t0,g);case 38:return e.prev=38,i.hideLoading(),i.hideSkeleton(),e.finish(38);case 42:case"end":return e.stop()}}),e,null,[[11,34,38,42]])})))),(0,v.Z)((0,h.Z)(i),"handleShowAll",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];console.log("handleShowAll");var r=i.store.getState(),o=r.hotelList,a=void 0===o?[]:o,s=r.recList,l=void 0===s?[]:s,c=r.slts,u=void 0===c?{}:c,d=r.totalSlts,h=i.actions,p=h.updatePayLoad,f=h.updatePageStatus,v=h.kmDevTraceLog;p({allFinish:!0,bottomInfo:{showBottom:!0,showError:!1,showCircle:!1,text:"\u5df2\u663e\u793a\u6240\u6709\u9152\u5e97"}});var m=!(a.length+l.length+e.length+t.length);f({showHotelEmpty:!n&&Ke.isEmpty(i.isRN?d:u)&&m}),m&&v({messageId:ie.n6.no_hotel,desc:ie.DV.no_hotel})})),(0,v.Z)((0,h.Z)(i),"pullNext",(function(){console.log("=======> pullNext");var e=i.actions.updatePageIndex,t=i.store.getState(),n=t.bottomInfo.showBottom,r=t.errorInfo.showError;if(!n&&!r)try{e(),i.showLoading(),i.fetchHotelList()}catch(t){console.log(t,"pull next error"),e(!1)}})),(0,v.Z)((0,h.Z)(i),"handleInitError",(function(e,t){if(![e.message,e].includes("abort")){var n=i.actions.updatePayLoad;console.log("initProcess error:",e),n({errorInfo:{showError:!0,callBack:{funcName:"initProcess",funcParams:{appType:t}}}})}})),(0,v.Z)((0,h.Z)(i),"handlePullRecList",(0,x.Z)((0,S.Z)().mark((function e(){var t,n,r,o,a,s,l,c,u,d,h,p;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=i.store.getState(),n=t.hotelList,r=t.recList,o=t.recParams,t.totalCount,a=i.actions.updatePayLoad,s=n.length+r.length<100,l=o||{},c=l.ExpandFilterSearchPriority,u=void 0===c?0:c,s&&u<3?(d=n.map((function(e){return e.hotelId})),h=r.map((function(e){return e.hotelId})),p=d.concat(h).join(","),a({recParams:{SearchMode:1,HiddenHotelList:p,ExpandFilterSearchPriority:u+1}}),i.fetchHotelList()):i.handleShowAll(n,r);case 5:case"end":return e.stop()}}),e)})))),(0,v.Z)((0,h.Z)(i),"handleSearchKeyWord",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("handleSearchKeyWord",e);var n=t.isdingzhi,r=i.store.getState(),o=r.searchKeyWord,a=void 0===o?"":o;if(e!==a){var s=i.actions.updatePayLoad;s({showSelected:!n,searchKeyWord:e||"",searchStatus:!1}),i.saveSearch({type:"string",word:e}),n||i.fetchHotelList(!0),i.trace.traceLogSearch(e)}})),(0,v.Z)((0,h.Z)(i),"saveSearch",(function(e){var t,n,r=e.word,o={};o=(0,c.Z)((0,c.Z)({},e),{},{word:r}),null===(t=i.storage)||void 0===t||null===(n=t.addHistory)||void 0===n||n.call(t,o)})),(0,v.Z)((0,h.Z)(i),"getFilterBarData",(function(e,t){var n=e.space,r=void 0===n?{}:n,o=e.sort,a=void 0===o?{}:o,s=e.filter,l=void 0===s?{}:s,u=e.star,d=void 0===u?{}:u;return[{defTitle:"\u6b22\u8fce\u5ea6\u6392\u5e8f",listProps:(0,c.Z)((0,c.Z)({},a||{}),{},{type:"SimpleList",onFilterHide:!0,list:null===a||void 0===a?void 0:a.subs,wrapperStyle:{},onFilter:function(){var e=(0,x.Z)((0,S.Z)().mark((function e(){var t,n,r,o,a,s,l,c=arguments;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(o=c.length,a=new Array(o),s=0;s<o;s++)a[s]=c[s];if(l=a[0].isCur,(t=console).log.apply(t,["onFilter:args"].concat(a)),!l){e.next=5;break}return e.abrupt("return");case 5:return i.isRN?(n=i).onSelectFilter.apply(n,a.concat(["SORT"])):(r=i).onSelectSort.apply(r,a),e.next=8,i.fetchHotelList(!1,!0);case 8:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()})},{defTitle:r.text||"\u4f4d\u7f6e\u533a\u57df",listProps:{type:"FilterList",list:r.subs,key:"space",wrapperStyle:{},onFilter:function(){var e=(0,x.Z)((0,S.Z)().mark((function e(){var t,n,o,a,s=arguments;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(n=s.length,o=new Array(n),a=0;a<n;a++)o[a]=s[a];return(t=i).onSelectSpace.apply(t,o.concat([r])),e.next=4,i.fetchHotelList(!1,!0);case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),clearFunc:function(){var e=(0,x.Z)((0,S.Z)().mark((function e(){return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i.isRN?i.onRNClear("SPACE"):i.onClear("SPACE"),e.next=3,i.fetchHotelList(!1,!0);case 3:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}},{defTitle:"\u661f\u7ea7",listProps:{type:"GridList",list:d,wrapperStyle:{},showBottom:!0,onFilter:function(){var e=(0,x.Z)((0,S.Z)().mark((function e(){var t,n,r,o,a=arguments;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(n=a.length,r=new Array(n),o=0;o<n;o++)r[o]=a[o];return(t=i).onSelectFilter.apply(t,r.concat(["STAR"])),e.next=4,i.fetchHotelList(!1,!0);case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),clearFunc:function(){var e=(0,x.Z)((0,S.Z)().mark((function e(){return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i.isRN?i.onRNClear("STAR"):i.onClear("STAR"),e.next=3,i.fetchHotelList(!1,!0);case 3:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}},{defTitle:l.text||"\u7b5b\u9009",listProps:{type:"ScrollList",list:l.subs,key:"filter",wrapperStyle:{},onFilter:function(){var e=(0,x.Z)((0,S.Z)().mark((function e(){var t,n,r,o,a=arguments;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(n=a.length,r=new Array(n),o=0;o<n;o++)r[o]=a[o];return(t=i).onSelectFilter.apply(t,r.concat(["FILTER"])),e.next=4,i.fetchHotelList(!1,!0);case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),clearFunc:function(){var e=(0,x.Z)((0,S.Z)().mark((function e(){return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i.isRN?i.onRNClear("FILTER"):i.onClear("FILTER"),e.next=3,i.fetchHotelList(!1,!0);case 3:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}}]})),(0,v.Z)((0,h.Z)(i),"formatFilterData",function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t,n,i){var r,o,a,s,l,u,d,h,p,f,v,m,y,g=arguments;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(g.length>3&&void 0!==g[3]?g[3]:{},r=n.FilterModel,o=void 0===r?{}:r,a=n.queryInfo,s=void 0===a?{}:a,l=n.filters,!Ke.isEmpty(o)){e.next=4;break}return e.abrupt("return",{});case 4:return u=!!Number(null===s||void 0===s?void 0:s.pdid)||!!Number(null===s||void 0===s?void 0:s.pid),d=o.center,h=o.quicks,p=s.cidt,f=s.codt,v=p?ze(p).format("MM-DD"):"",m=f?ze(f).format("MM-DD"):"",y=(0,c.Z)((0,c.Z)({},d),{},{text:"\u5e02\u4e2d\u5fc3"}),e.abrupt("return",{urlQuery:(0,c.Z)((0,c.Z)({},t),s),hasShell:u,date:[v,m],cityCenter:y,mapFilter:y,filterObj:l,quickFilters:h});case 11:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}());var r=e.store,o=e.actions,a=e.fetch,s=e.storage,l=e.context,d=e.getSharkValue,p=e.trace;return i.store=r,i.actions=o,i.fetch=a,i.storage=s,i.context=l,i.getSharkValue=d,i.trace=p,i.platform=null===l||void 0===l?void 0:l.platform,i.isRN="CtripApp"===i.platform,i.isOnline="Browser"===i.platform,i}return(0,d.Z)(n)}(Me),Ge=Ue,$e=function(e){(0,p.Z)(n,e);var t=(0,f.Z)(n);function n(e){var i;(0,u.Z)(this,n),i=t.call(this,e),(0,v.Z)((0,h.Z)(i),"fetch",void 0),(0,v.Z)((0,h.Z)(i),"store",void 0),(0,v.Z)((0,h.Z)(i),"actions",void 0),(0,v.Z)((0,h.Z)(i),"slts",void 0),(0,v.Z)((0,h.Z)(i),"setSlts",void 0),(0,v.Z)((0,h.Z)(i),"initProcess",(0,x.Z)((0,S.Z)().mark((function e(){return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.fetchHotelListAndFilters();case 2:case"end":return e.stop()}}),e)})))),(0,v.Z)((0,h.Z)(i),"showSkeleton",(function(){var e=i.actions.updatePayLoad,t={showSkeleton:!0,needTop:!1};e({skeletonInfo:t})})),(0,v.Z)((0,h.Z)(i),"hideSkeleton",(function(){var e=i.actions.updatePayLoad,t={showSkeleton:!1,needTop:!1};e({skeletonInfo:t})})),(0,v.Z)((0,h.Z)(i),"showLoading",(function(){var e=i.actions.updatePayLoad,t={showBottom:!0,showError:!1,showCircle:!0,text:"\u52a0\u8f7d\u4e2d..."};e({bottomInfo:t})})),(0,v.Z)((0,h.Z)(i),"hideLoading",(function(){var e=i.actions.updatePayLoad,t=i.store.getState(),n=t.allFinish;if(!n){var r={showBottom:!1,showCircle:!1};e({bottomInfo:r})}}));var r=e.store,o=e.actions,a=e.fetch;return i.store=r,i.actions=o,i.fetch=a,i}return(0,d.Z)(n)}(Ge),Ye=$e,Xe=n(45913),Je=n(32180)["window"],et=n(32180)["document"],tt=["ExpandFilterSearchPriority"],nt=["DotX","DotY"],it=["hotelList","recList","mainFinish","totalCount"],rt=["HotelListData"],ot=["filterData","firstData"],at=["firstHotel"],st=["quickFilters"],lt=["ExpandFilterSearchPriority"],ct=k.createReactModel,ut=k.setupEnvContext,dt=k.setupContext,ht=k.moment,pt=k.setupPreloadCallback,ft=k.setupFinishCallback,vt=k._,mt=de,yt=he,gt=fe,wt=be,St=ve,xt=ke,Zt=me,kt=W.getStringWord,bt={},Pt=!1,Lt={pageStatus:{showPageInitLoading:!1,showPageInitEmpty:void 0,showPageNextLoading:!1,showPolicyLoading:!1,showSearchLoading:!1,showSearchPage:!1,showHotelEmpty:!1,showHotelEnd:!1,isInitHotelList:!1,showHotelEdit:!1,initDone:!1},fetchStatus:{fetchFilters:!1,fetchHotels:!1},positionInfo:{headerHeight:87,filterHeight:79,searchBoxHeight:50},pageInfo:{},filterTypes:ie.kE,paramInfo:{},hotelList:[],recList:[],selected:{},positions:[],selectedObj:{},typeList:[],filterObj:{},sortValue:ie.IR[0],errorInfo:{showError:!1},searchStatus:!1,allFinish:!1,isPullNew:!1,showPricePop:!1,skeletonInfo:{showSkeleton:!0,needTop:!0},singleParams:{},bottomInfo:{showBottom:!1,showCircle:!0},recParams:{},curFilter:"",quickFilters:[],filterHistory:[],traced:[],needScrollToTop:!1,isTour:!1},Tt={CTRIP:"h5",H5:"h5",ONLINE:"online",TRIP:"ibu",offline:"online",bestone:"online"},It=function(e){var t=ut(),n=dt(U.Iy),s=n.storage,l=n.distribution,h=n.initialState,p=n.HotelPreFetch,f=n.ClassedSelect,k=dt(G.fH),b=dt(G.z1),P=dt(G.G1),L=dt(G.fI),T=L.urlQuery,I=L.pageOptions,N=void 0===I?{}:I,F=k.baseContext,_=k.requestFn,C=k.gqlRequestFn,j=b.traceLog,H=b.diyForwardPage,V=b.jumpH5,D=b.getBaseState,B=null===F||void 0===F?void 0:F.isServer,E=C((0,c.Z)((0,c.Z)({},t),k)),R=_((0,c.Z)((0,c.Z)({},t),k)),A=t.platform,O=null,M=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t){var n,i,r,o,a,s=arguments;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=s.length>1&&void 0!==s[1]?s[1]:{},a=s.length>2&&void 0!==s[2]?s[2]:{},t===(null===(n=O)||void 0===n?void 0:n.query)&&(null===(i=O)||void 0===i||null===(i=i.fetch)||void 0===i||null===(r=i.abort)||void 0===r||r.call(i)),O={fetch:null===E||void 0===E?void 0:E(t,o,(0,c.Z)((0,c.Z)({},a),{},{notAbort:!0})),query:t},e.abrupt("return",O.fetch);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(e){return(0,ae.k8)(e,P.SharkUtil)},q=ie.IR,K=(0,d.Z)((function e(){(0,u.Z)(this,e)})),z=ne(K),$=new z,Y=new oe(j),X=W.getQueryObj(T,N),J=(null===D||void 0===D?void 0:D())||{},ee="MicroMessenger"===A,te="CtripApp"===A,re="Browser"===A,se=!!X.choosesingleresource,le=!!Number(X.pdid)||!!Number(X.pid),ce={tour_channel:"isTour",order_change:"isWoxie",4126:"is4126"}[X.sourcefrom]||"isNothing",ue="isTour"===ce||se&&le,de=ie.RB[ce]||{},he=(0,Z.zn)({keyTraceMap:ie.A9,name:"HotelListModel",initialState:(0,c.Z)((0,c.Z)((0,c.Z)((0,c.Z)((0,c.Z)({},Lt),{},{isInTDS:"bestone"===(null===h||void 0===h?void 0:h.appType)},h),J),h),{},(0,v.Z)((0,v.Z)((0,v.Z)((0,v.Z)((0,v.Z)((0,v.Z)((0,v.Z)({isSSR:B,urlQuery:X,DistributionConfig:ee?{}:W.getDistributionConfig(l,F)},ce,!0),"isTour",ue),"showOptions",de),"hasShell",le),"isCustomSearch",!!Number(X.iscustomsearch)),"filterTypes",W.getFilterTypes(le)),"rangeData",W.getRangeData(X))),reducers:(0,c.Z)((0,c.Z)((0,c.Z)({},i),r),a),logger:"fat"===t.env&&!B,devtools:"fat"===t.env&&!B}),pe=he.store,fe=he.actions,ve={store:pe,actions:fe,fetch:M,trace:Y,storage:s,context:{sharkContext:P,platform:null===t||void 0===t?void 0:t.platform},getSharkValue:Q},me=new Ye(ve),ye={};vt.forEach(a,(function(e,t){ye[t]=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.apply(void 0,[ve].concat(n))}}));var ge=ye.showSkeleton,we=ye.hideSkeleton,Se=ye.showLoading,xe=ye.hideLoading,Ze=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t){var n,i,r,o,a,s,l;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,n="query HotelAutoComplete($params: HotelAutoCompleteReq){\n                HotelAutoComplete(params: $params) {\n                    ResponseStatus\n                    docs\n                    total\n                }\n            }",i=fe.kmDevTraceLog,e.next=5,M(n,t);case 5:if(r=e.sent,o=r.rootMessageId,a=r.HotelAutoComplete.docs,s=void 0===a?[]:a,console.log("fetchSearchKeyword",o),l=fe.updatePayLoad,l({},"search",{value:"\u5173\u952e\u5b57\uff1a".concat(t.keyword," "),rootMessageId:o}),!vt.isEmpty(s)||vt.isEmpty(t.keyword)){e.next=15;break}return((null===t||void 0===t?void 0:t.keyword)||"").match(/[a-zA-Z]+/)?i({messageId:ie.n6.no_keyword_en,desc:ie.DV.no_keyword_en}):i({messageId:ie.n6.no_keyword,desc:ie.DV.no_keyword}),e.abrupt("return",[]);case 15:return e.abrupt("return",s);case 18:return e.prev=18,e.t0=e["catch"](0),console.log(e.t0),e.abrupt("return",[]);case 22:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t){return e.apply(this,arguments)}}(),ke=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t,n){var i,r,o,a,s,l,u,d,h,p,f,v,m,y,g,x,Z,k,b,L,T,I,N,F,_,C,j,H,V,D,B,E,A,O,Q,q,K,z,G,Y,X,J,ee,te,ne,ie,re,oe,se;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("fetchHotelList"),i=pe.getState(),r=i.recParams,o=i.singleParams,a=i.isInTDS,i.isTour,s=i.hasShell,l=i.urlQuery,u=i.cargoContext,d=fe.updateFetchAndPageStatus,h=fe.updateFetchStatus,p=r||{},f=p.ExpandFilterSearchPriority,v=(0,w.Z)(p,tt),m=o||{},y=m.DotX,g=m.DotY,x=(0,w.Z)(m,nt),Z=l.sltprice,d({pageStatus:{showHotelEmpty:!1},fetchStatus:{fetchHotels:!0}}),$.parameter=(0,c.Z)((0,c.Z)((0,c.Z)({},$.parameter),x),{},{ExpandFilterSearchPriority:f}),vt.remove($.parameter.Filters,(function(e){return 32===e.Id})),vt.isEmpty(x)||($.map=(0,c.Z)((0,c.Z)({},$.map),{},{DotX:y,DotY:g,name:"\u8be5\u9152\u5e97"})),Ce($),e.next=13,(0,U.zo)(R,(0,c.Z)((0,c.Z)({},l),{},{hotelid:0}),u);case 13:if(k=e.sent,k!==U.dw.WAIT){e.next=17;break}throw setTimeout((function(){return Oe(null===t||void 0===t?void 0:t.funcParams)}),10),new Error("abort");case 17:return e.prev=17,L=pe.getState(),T=L.paramInfo,I=L.urlQuery,N=L.cityCenter,F=L.mapedAppType,_=L.hotelList,C=t.funcName,j="handlePullNew"===C?[]:_,H="query HotelList($params: HotelListReq){\n                HotelList(params: $params) {\n                    hotelList,\n                    recList,\n                    mainFinish,\n                    totalCount\n                }\n            }",V=I.cityid,D=I.slthotelid,B=I.isabroad,E=I.type,A=void 0===E?"":E,O=I.typeid,Q=void 0===O?0:O,q=I.basetradeprice,K=void 0===q?0:q,z={id:A.indexOf("Province")>-1?Q:V,isAbroad:B,type:A},G=(0,c.Z)((0,c.Z)({},T),v),k&&null!==(b=Je)&&void 0!==b&&b.idiyHotelAntiSpiderToken&&(X={Key:"ValidateToken",Value:Je.idiyHotelAntiSpiderToken},G.Headers=vt.isArray(G.Headers)?G.Headers.push(X):[X],G.Headers.push({Key:"fingerprintkeys",Value:(null===(Y=Je.Kar98k)||void 0===Y?void 0:Y.hoteluuidkeys)||""})),J={opts:(0,c.Z)((0,c.Z)({},n),{},{sltPrice:Z,centerName:$.centerName,appType:F,isIBU:"ibu"===F,baseTradePrice:K,isTour:s}),paramInfo:G,hotelId:Number(D),searchInfo:x,filterParams:z},e.next=29,M(H,J);case 29:return ee=e.sent,te=ee.HotelList,ne=te.hotelList,ie=te.recList,re=te.mainFinish,oe=te.totalCount,se=(0,w.Z)(te,it),ne=(0,ae.Ys)(ne,F,P.SharkUtil,a),(re||j.length+ne.length>=oe)&&(s||"online"===F||"ibu"===F?$e(ne,ie):setTimeout(Ge,0)),e.abrupt("return",(0,c.Z)({hotelList:vt.isEmpty(x)||vt.isEmpty(ie)?ne:vt.map(ne,(function(e){return W.replaceHotelDis(e,N)})),recList:ie,totalCount:oe},se));case 37:return e.prev=37,e.t0=e["catch"](17),console.log(e.t0),e.abrupt("return",Le({e:e.t0,callBack:{funcName:(null===t||void 0===t?void 0:t.funcName)||"fetchHotelList",funcParams:(null===t||void 0===t?void 0:t.funcParams)||null},opts:n}));case 41:return e.prev=41,h({fetchHotels:!1}),_e(),e.finish(41);case 45:case"end":return e.stop()}}),e,null,[[17,37,41,45]])})));return function(t,n){return e.apply(this,arguments)}}(),be=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t,n){var i,r,o,a,s,l,u,d,h,p,f,v,m,y,x,Z,k,b,P,L,T,I,N,_,C,j,H,V,D,B,E,A,O,Q;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=pe.getState(),r=i.urlQuery,o=void 0===r?{}:r,a=i.isTour,s=i.cargoContext,l=i.isInTDS,u=i.hasShell,e.next=3,(0,U.zo)(R,(0,c.Z)((0,c.Z)({},o),{},{hotelid:0}),s);case 3:if(d=e.sent,d!==U.dw.WAIT){e.next=7;break}throw setTimeout((function(){return Te(!1,t,n)}),10),new Error("abort");case 7:return e.prev=7,p="query GetHotelList($params: HotelListDataReq) {\n                HotelListData(params: $params) {\n                    hotelList,\n                    mainFinish,\n                    totalCount,\n                    filterData,\n                    firstData\n                }\n            }",f={urlQuery:o,opts:{isTour:a||u,appType:t,isNew:"online"===t,newFilter:"online"===t}},d&&null!==(h=Je)&&void 0!==h&&h.idiyHotelAntiSpiderToken&&(f.opts.token=Je.idiyHotelAntiSpiderToken,f.opts.fingerprintkeys=(null===(v=Je.Kar98k)||void 0===v?void 0:v.hoteluuidkeys)||""),m=o.roomtoken,y=o.shoppingid,x=o.sltprice,Z=o.cachekey1,k=void 0===Z?"hotelList_".concat(y,"_").concat(m,"_").concat(x,"_0"):Z,e.next=14,M(p,f,k?{cachePolicy:{enableCache:!0,cacheExpireTime:5,cacheLocation:"MEM",cacheKey:k}}:void 0);case 14:return b=e.sent,P=b.HotelListData,L=void 0===P?{}:P,(0,w.Z)(b,rt),T=L.filterData,I=L.firstData,N=void 0===I?{}:I,_=(0,w.Z)(L,ot),null!==N&&void 0!==N&&N.staticParams||(N.staticParams=me.setStaticParams(null===T||void 0===T?void 0:T.queryInfo),N.PageSize=5),e.next=22,Promise.all(["online"===t?Ne(o,T,t):Ie(T,t),Fe(_,t,l)]);case 22:C=e.sent,j=(0,g.Z)(C,2),H=j[0],V=j[1],fe.updatePayLoad((0,c.Z)((0,c.Z)({firstData:(0,c.Z)((0,c.Z)({},N),{},{pageIndex:1}),slts:{},sltsFilter:{},mapFilter:{},firstHotel:null,isSSR:null===F||void 0===F?void 0:F.isServer},H),V)),D=H,B=D.hasShell,E=_.mainFinish,A=_.hotelList,O=void 0===A?[]:A,Q=_.totalCount,(E||O.length>=Q)&&(B||"online"===t||"ibu"===t||"h5"===t?$e(O):setTimeout(Ge,0)),e.next=37;break;case 32:e.prev=32,e.t0=e["catch"](7),console.log(e.t0),Ae(e.t0,t),xe();case 37:return e.prev=37,we(),qe(),e.finish(37);case 41:case"end":return e.stop()}}),e,null,[[7,32,37,41]])})));return function(t,n){return e.apply(this,arguments)}}(),Pe=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t,n,i){var r,o,a,s,l,u,d,h,p,f,v,m,y;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:if(r=pe.getState(),o=r.urlQuery,r.isTour,a=r.positions,s=void 0===a?[]:a,l=fe.updateFetchStatus,!s.length){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,u="query GetHotelFirstData($params: HotelFirstDataReq) {\n                HotelFirstData(params: $params) {\n                    firstHotel,\n                    FilterModel,\n                    autoValue,\n                    queryInfo\n                }\n            }",d={urlQuery:o,opts:{needHotel:B,newBrand:!0,appType:i}},e.next=11,M(u,d);case 11:return h=e.sent,p=h.HotelFirstData,f=fe.updatePayLoad,v=p.firstHotel,m=(0,w.Z)(p,at),e.next=17,Ie(m,i,!0);case 17:y=e.sent,f((0,c.Z)((0,c.Z)({},y),{},{firstHotel:v})),e.next=28;break;case 21:return e.prev=21,e.t0=e["catch"](6),console.log(e.t0),Ae(e.t0,i),we(),xe(),e.abrupt("return");case 28:return e.prev=28,l({fetchFilters:!1}),_e(),qe(),e.finish(28);case 33:case"end":return e.stop()}}),e,null,[[6,21,28,33]])})));return function(t,n,i){return e.apply(this,arguments)}}(),Le=function(e){var t=e.callBack,n=e.e,i=e.opts;if("abort"===n||"abort"===(null===n||void 0===n?void 0:n.message))return{e:new Error("abort")};var r=fe.updatePayLoad;r({errorInfo:{showError:!0,callBack:t,opts:i}})},Te=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t,n,i){return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,e.t0=t,e.t0){e.next=5;break}return e.next=5,be(n,i);case 5:It(i),e.next=12;break;case 8:if(e.prev=8,e.t1=e["catch"](0),"abort"!==(null===e.t1||void 0===e.t1?void 0:e.t1.message)){e.next=12;break}return e.abrupt("return");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n,i){return e.apply(this,arguments)}}(),Ie=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t,n){var i,r,o,a,l,u,d,h,p,v,m,y,g,x,Z,k,b,L,T,I,N,F,_,C=arguments;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=C.length>2&&void 0!==C[2]&&C[2],a=t.FilterModel,l=t.queryInfo,u=t.autoValue,d=pe.getState(),h=d.positions,p=d.selected,v=d.urlQuery,bt=new f(u),bt.initFilterSelect(p,h),ct.SelectModel=bt,!vt.isEmpty(a)){e.next=8;break}return e.abrupt("return",{});case 8:return m=!!Number(null===l||void 0===l?void 0:l.pdid)||!!Number(null===l||void 0===l?void 0:l.pid),m&&vt.remove(null===(i=a.filters)||void 0===i?void 0:i.star,(function(e){return"10"===e.id})),m&&vt.map(null===(r=a.filters)||void 0===r?void 0:r.space,(function(e){"18"===(null===e||void 0===e?void 0:e.id)&&vt.map(null===e||void 0===e?void 0:e.items,(function(e){vt.remove(e.items,(function(e,t){return 0===t}))}))})),y=a.center,g=a.filters,x=a.quicks,o&&($.map=(0,c.Z)((0,c.Z)({},$.map),{},{name:y.name,DotX:y.lat,DotY:y.lon}),Ce($)),e.next=15,St((0,c.Z)((0,c.Z)({},ve),{},{storage:s}),x,n);case 15:return Z=e.sent,k=Z.quickFilters,b=(0,w.Z)(Z,st),e.next=20,je(s,k,m);case 20:return L=e.sent,T=l.cidt,I=l.codt,N=T?ht(T).format("MM-DD"):"",F=I?ht(I).format("MM-DD"):"",_=(0,ae.ne)(l,n,P.SharkUtil),e.abrupt("return",(0,c.Z)((0,c.Z)((0,c.Z)({DefaultSharkString:_,urlQuery:(0,c.Z)((0,c.Z)({},v),l),hasShell:m,filterTypes:W.getFilterTypes(m),date:[N,F],cityCenter:y,filterObj:g,quickFilters:k},b),L),{},{quicks:x}));case 26:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ne=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t,n,i){var r,o,a,s,l,u,d,h,p,f,v,m,y,g,w,x=arguments;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(x.length>3&&void 0!==x[3]?x[3]:{},r=n.FilterModel,o=void 0===r?{}:r,a=n.queryInfo,s=void 0===a?{}:a,l=n.filters,!vt.isEmpty(o)){e.next=4;break}return e.abrupt("return",{});case 4:return re&&(u=vt.get(l,["sort","subs"],[]),vt.forEach(q,(function(e){var t;e.valueTypes?(e.types=[],vt.forEach(e.valueTypes,(function(t){var n;e.types.push(null===(n=vt.find(u,{type:t}))||void 0===n?void 0:n.type)}))):e.type=null===(t=vt.find(u,{type:e.valueType}))||void 0===t?void 0:t.type}))),d=!!Number(null===s||void 0===s?void 0:s.pdid)||!!Number(null===s||void 0===s?void 0:s.pid),h=o.center,p=o.quicks,f=s.cidt,v=s.codt,m=f?ht(f).format("MM-DD"):"",y=v?ht(v).format("MM-DD"):"",g=(0,ae.ne)(s,i,P.SharkUtil),w=(0,c.Z)((0,c.Z)({},h),{},{text:"\u5e02\u4e2d\u5fc3"}),e.abrupt("return",{DefaultSharkString:g,urlQuery:(0,c.Z)((0,c.Z)({},t),s),hasShell:d,date:[m,y],cityCenter:w,mapFilter:w,filterObj:l,quickFilters:p,sort:q});case 13:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),Fe=function(e,t,n){var i=e.hotelList,r=e.totalCount;i=(0,ae.Ys)(i,t,P.SharkUtil,n);var o={hotelList:i,totalCount:r,hotelNum:Q(["#totalHotel",r||0])};return o},_e=function(){var e=pe.getState(),t=e.fetchStatus,n=void 0===t?{}:t,i=e.skeletonInfo,r=void 0===i?{}:i,o=r.showSkeleton;if(console.log("==========> checkSkeleton",n,r),o){var a=n.fetchHotels,s=n.fetchFilters;a||s||(console.log("==========> hideSkeleton"),we())}},Ce=function(e){var t=pe.getState(),n=t.recParams,i=t.is4126,r=t.isWoxie,o=n||{},a=(o.ExpandFilterSearchPriority,(0,w.Z)(o,lt)),s=e.params,l=(0,c.Z)((0,c.Z)({},s),a);(i||r)&&(l.ActionType=1),fe.updateParamInfo(l)},je=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t,n,i){var r,o,a,s,l,c;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r={showTips:!1,showToast:!1},i){e.next=10;break}return e.next=4,null===t||void 0===t||null===(o=t.get)||void 0===o?void 0:o.call(t,"showTips");case 4:return s=e.sent,e.next=7,null===t||void 0===t||null===(a=t.get)||void 0===a?void 0:a.call(t,"viewedToastTips");case 7:l=e.sent,c=!l&&vt.some(n,(function(e){return 32===e.id})),r={showTips:!s,showToast:c};case 10:return e.abrupt("return",r);case 11:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),He=function(){var e,t,n,i=(null===s||void 0===s||null===(e=s.get)||void 0===e?void 0:e.call(s,"searchList"))||[];return null===(t=i)||void 0===t||null===(n=t.then)||void 0===n||n.call(t,(function(e){i=e||[]})),i},Ve=function(e){var t,n=e.word,i={};i=(0,c.Z)((0,c.Z)({},e),{},{word:n}),null===s||void 0===s||null===(t=s.addHistory)||void 0===t||t.call(s,i)},De=function(){var e;null===s||void 0===s||null===(e=s.set)||void 0===e||e.call(s,[],"searchList")},Be=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("click keyword",e);var n=pe.getState(),i=n.filterObj,r=(n.isTour,n.mapedAppType),o=n.hasShell,a=fe.updatePayLoad,s=t.needUpdate,l=void 0===s?!o:s,c=t.filterinfo,u=void 0===c?{}:c,d=t.isInit,h=void 0===d?!l:d,p=t.isHistory,f=t.isdingzhi,v=(0,ae.k_)({item:e,filterObj:i,keyWordInfo:u});if(f&&(l=!1,h=!1),It(),e.word=kt(e.word),o&&p)Re(e.word,{isdingzhi:f});else if(v&&"Hotel"===v.type&&(v.value||o)){var m=["h5","app"],y=!f&&(o||!m.includes(r));a({showSelected:!f,searchInfo:h?{}:e,searchKeyWord:l||f?e.word:"",searchStatus:!1}),Ve(e),y?jt(v,0,!0):We({singleSearchInfo:{KeyWordType:"Hotel",KeyWordId:v.value,DotX:e.gdlat,DotY:e.gdlon},isSearch:!0})}else null!==v&&void 0!==v&&v.type?(a({showSelected:!f,searchInfo:h?{}:e,searchKeyWord:l||f?e.word:"",searchStatus:!1}),v.type>0||delete v.type,(l||f)&&Ve(e),mt(ct,{needUpdate:l,isSearch:l||f,type:v.objType,needSelect:!0,selectObj:v}),l||a({selected:bt.selected,positions:bt.positions,tempSlt:v})):Re(e.word,{isdingzhi:f})},Ee=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("click keyword new",e);var n=pe.getState(),i=n.filterObj,r=(n.isTour,n.mapedAppType),o=n.hasShell,a=fe.updatePayLoad,s=t.needUpdate,l=void 0===s?!o:s,c=t.filterinfo,u=void 0===c?{}:c,d=t.isInit,h=void 0===d?!l:d,p=t.isHistory,f=t.isdingzhi,v=(0,ae.k_)({item:e,filterObj:i,keyWordInfo:u});if(f&&(l=!1,h=!1),It(),e.word=kt(e.word),o&&p)me.handleSearchKeyWord(e.word,{isdingzhi:f});else if(v&&"Hotel"===v.type&&(v.value||o)){var m=["h5","app"],y=!f&&(o||!m.includes(r));a({showSelected:!f,searchInfo:h?{}:e,searchKeyWord:l||f?e.word:"",searchStatus:!1}),Ve(e),y?jt(v,0,!0):me.fetchHotelList(!0)}else null!==v&&void 0!==v&&v.type?(a({showSelected:!f,searchInfo:h?{}:e,searchKeyWord:l||f?e.word:"",searchStatus:!1}),v.type>0||delete v.type,(l||f)&&Ve(e),mt(ct,{needUpdate:l,isSearch:l||f,type:v.objType,needSelect:!0,selectObj:v}),l||a({selected:bt.selected,positions:bt.positions,tempSlt:v})):me.handleSearchKeyWord(e.word,{isdingzhi:f})},Re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.isdingzhi,i=pe.getState(),r=i.searchKeyWord,o=void 0===r?"":r;if(e!==o){var a=fe.updatePayLoad;a({showSelected:!n,searchKeyWord:e||"",searchStatus:!1}),Ve({type:"string",word:e}),n||We(),Y.traceLogSearch(e)}},Ae=function(e,t){var n=fe.updatePayLoad,i=fe.updatePageStatus;console.log("initHotelList error:",e),i({isInitHotelList:!1,showPageInitLoading:!1}),n({showError:!0,callBack:{funcName:"initHotelList",funcParams:{appType:t}}})},Oe=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t){var n,i,r,o,a;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=fe.updatePayLoad,e.prev=1,e.next=4,ke({funcName:"initHotelList",funcParams:t},{isInitFetch:!0});case 4:return i=e.sent,r=i.hotelList,o=i.totalCount,i.e,a={hotelList:r,totalCount:o,hotelNum:Q(["#totalHotel",o||0])},n(a),e.abrupt("return",{});case 13:return e.prev=13,e.t0=e["catch"](1),console.log("init list data",e.t0),e.abrupt("return",e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),Me=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t,n,i,r){var o,a,s,l,c,u,d;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.next=3,Pe(n,i,r);case 3:o=(0,ae.ne)(pe.getState().urlQuery,r,P.SharkUtil);case 4:a=pe.getState(),s=a.urlQuery,l=s.cidt,c=s.codt,u=l?ht(l).format("MM-DD"):"",d=c?ht(c).format("MM-DD"):"",fe.updatePayLoad({date:[u,d],DefaultSharkString:o,sortValue:q[0],sort:q,mapedAppType:Tt[r]||r,appType:r,pageId:ie.Yu[r]});case 9:case"end":return e.stop()}}),e)})));return function(t,n,i,r){return e.apply(this,arguments)}}(),Qe=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t){var n,i,r,o,a,s,l,u,d,h,p,f,v,m,y,g,w,x,Z,k,b,P,L,T,I,N,F,_,C,j,H,V,D,B,E,R,A,O,M,W,K,z,G,$,Y,X,J,ee,te,ne=arguments;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=ne.length>1&&void 0!==ne[1]?ne[1]:{},console.log("initHotelList"),r=fe.updatePayLoad,o=fe.updatePageStatus,fe.logPageInfo,a=pe.getState(),s=a.Link,l=a.hasPreload,u=a.pageStatus,d=u.isInitHotelList,h=u.hasInitCustom,p=a.isCustomSearch,f=a.is4126,v=a.urlQuery,!d){e.next=6;break}return e.abrupt("return");case 6:if(m=i.isdingzhi,y=i.isSearch,void 0===y||y,g=Tt[t]||t,f&&!Pt&&(w=v.searchParams,x=void 0===w?{}:w,Z=v.pid,k=v.keyword,b=x.pid,P=void 0===b?Z:b,L=x.keywords,P=Number(P),r({urlQuery:(0,c.Z)((0,c.Z)({},v),{},{pdid:P}),searchKeyWord:L||k,isTour:!!P,mapedAppType:g,appType:g})),!p||h){e.next=11;break}return e.abrupt("return");case 11:if(null!==(n=Je)&&void 0!==n&&null!==(n=n.document)&&void 0!==n&&n.body&&(et.body.style.cssText="overflow: hidden;height: 100%;"),o({isInitHotelList:!0,showPageInitLoading:!0}),"online"===g&&(q=xt(Q)),T=v.pageoptions,I=void 0===T?{}:T,N=v.filterinfo,F=void 0===N?{}:N,v.cidt,_=v.type,C=v.typeid,j=I,H=j.listData,V=j.keyWordInfo,D=void 0===V?{}:V,B=F.name?F:D,vt.isEmpty(H),E={funcName:"initHotelList",funcParams:{appType:g}},R=["IntlProvince","Hotel","City","IntlCity","",void 0],A=vt.some(R,(function(e){return e===_})),O=(0,c.Z)({type:_,id:Number(C),word:B.name},B),M=pe.getState().urlQuery,W=M.cidt,K=M.codt,z=M.cityid,G="CTRIP"!==t&&"ONLINE"!==t&&(!W||!K||!z||!A),l){e.next=29;break}return e.next=27,Me(G,E,!0,g);case 27:e.next=30;break;case 29:(0,U.ZW)(s);case 30:if(e.prev=30,G&&ge(),Y={needUpdate:!1,filterinfo:B,isdingzhi:m},A||Be(O,Y),X=null,Te(G,g,{isFilter:!0,isSearch:m&&!A}),!G){e.next=42;break}return e.next=39,Oe(g);case 39:J=e.sent,ee=J.e,X=ee;case 42:if(!X||"abort"===(null===($=X)||void 0===$?void 0:$.message)){e.next=44;break}throw X;case 44:e.next=49;break;case 46:e.prev=46,e.t0=e["catch"](30),Ae(e.t0,g);case 49:return e.prev=49,xe(),r({showSelected:!0}),o({showPageInitLoading:!1}),null!==(te=Je)&&void 0!==te&&null!==(te=te.document)&&void 0!==te&&te.body&&setTimeout((function(){et.body.style.cssText=""}),0),e.finish(49);case 55:case"end":return e.stop()}}),e,null,[[30,46,49,55]])})));return function(t){return e.apply(this,arguments)}}(),qe=function(){var e=pe.getState(),t=e.urlQuery,n=fe.logPageInfo,i={cidt:"\u5165\u4f4f\u65e5\u671f",codt:"\u79bb\u5e97\u65e5\u671f",name:"\u57ce\u5e02"},r=[];for(var o in t)i[o]&&r.push({key:i[o],value:t[o]});n({contents:r})},We=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(){var t,n,i,r,o,a,s,l,u,d,h,p,f,m,y,g,w,x,Z,k=arguments;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=k.length>0&&void 0!==k[0]?k[0]:{},console.log("handlePullNew"),n=t.isRec,i=void 0!==n&&n,r=t.isFilter,o=void 0!==r&&r,a=t.singleSearchInfo,s=t.isSearch,l=t.isSort,u=pe.getState(),d=u.bottomInfo,h=void 0===d?{}:d,p=fe.updatePayLoad,f=!0,e.prev=6,$.pageIndex=1,Ce($),p({bottomInfo:(0,c.Z)((0,c.Z)({},h),{},{showBottom:!1}),isPullNew:!0}),i||(ge(),l||It({isFilter:o,singleSearchInfo:a,isSearch:s})),e.next=13,ke({funcName:"handlePullNew",funcParams:t});case 13:if(m=e.sent,y=m.hotelList,g=m.recList,w=m.totalCount,x=m.e,"abort"!==(null===x||void 0===x?void 0:x.message)){e.next=20;break}throw x;case 20:Z=i?"recList":"hotelList",p((0,v.Z)((0,v.Z)((0,v.Z)((0,v.Z)((0,v.Z)({},Z,y),"recList",i?y:g),"totalCount",w),"hotelNum",Q(["#totalHotel",w||0])),"needScrollToTop",!0)),e.next=28;break;case 24:e.prev=24,e.t0=e["catch"](6),console.log("handlePullNew error:",e.t0),"abort"===(null===e.t0||void 0===e.t0?void 0:e.t0.message)&&(f=!1);case 28:return e.prev=28,i||f&&we(),p({isPullNew:!1}),e.finish(28);case 32:case"end":return e.stop()}}),e,null,[[6,24,28,32]])})));return function(){return e.apply(this,arguments)}}(),Ke=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t){var n,i,r,o,a,s,l,c,u=arguments;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=u.length>1&&void 0!==u[1]&&u[1],console.log("auto pull"),r=pe.getState(),o=r.bottomInfo.showBottom,!o){e.next=5;break}return e.abrupt("return");case 5:if(a=t.listHeight,s=void 0===a?0:a,l=t.topHeight,c=void 0===l?0:l,!(s&&c&&s+c<(null===(n=Je)||void 0===n?void 0:n.innerHeight))){e.next=9;break}return e.next=9,ze({isRec:i});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ze=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t){var n,i,r,o,a,s,l,u,d,h,p,f,m,y,g;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("handlePullNext"),i=t||{},r=i.isRec,o=void 0!==r&&r,a=i.reTry,o=o||(null===(n=pe.getState().recList)||void 0===n?void 0:n.length),s=fe.updatePayLoad,l=pe.getState(),u=l.hotelList,d=l.recList,l.paramInfo,h=l.bottomInfo,p=l.isPullNew,console.log(h.showBottom,p,"pull next conditions"),a||!h.showBottom&&!p){e.next=8;break}return e.abrupt("return");case 8:return f=o?"recList":"hotelList",e.prev=9,Se(),$.pageIndex=$.pageIndex+1,Ce($),e.next=15,ke({funcName:"handlePullNext",funcParams:t});case 15:if(m=e.sent,y=m.hotelList,g=m.e,"abort"!==(null===g||void 0===g?void 0:g.message)){e.next=20;break}throw g;case 20:s((0,v.Z)((0,v.Z)({},f,vt.concat(o?d:u,y)),"bottomInfo",(0,c.Z)((0,c.Z)({},pe.getState().bottomInfo),{},{showBottom:pe.getState().allFinish}))),e.next=29;break;case 23:e.prev=23,e.t0=e["catch"](9),console.log(e.t0,"pull next error"),$.pageIndex=$.pageIndex-1,Ce($),s({bottomInfo:{showBottom:!0,showError:!0,showCircle:!1,text:"\u91cd\u65b0\u52a0\u8f7d",callBack:{funcName:"handlePullNext",funcParams:(0,c.Z)((0,c.Z)({},t),{},{reTry:!0})}}});case 29:case"end":return e.stop()}}),e,null,[[9,23]])})));return function(t){return e.apply(this,arguments)}}(),Ue=function(e){var t=fe.updatePayLoad,n=fe.updateTotalSlts,i=fe.updatePageIndex,r={isCur:!1,curFirstType:"SimpleList",newSlts:[null===e||void 0===e?void 0:e.type],type:"SORT"};n(r),i(1),$.sortValue=e,t({sortValue:e}),me.fetchHotelList(!1,!0)},Ge=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(){var t,n,i,r,o,a,s,l,c,u,d,h;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("handlePullRecList"),t=pe.getState(),n=t.hotelList,i=t.recList,r=t.recParams,t.totalCount,o=fe.updatePayLoad,a=n.length+i.length<100,s=r||{},l=s.ExpandFilterSearchPriority,c=void 0===l?0:l,a&&c<3?(u=vt.map(n,(function(e){return e.hotelId})),d=vt.map(i,(function(e){return e.hotelId})),h=u.concat(d).join(","),o({recParams:{SearchMode:1,HiddenHotelList:h,ExpandFilterSearchPriority:c+1}}),We({isRec:!0})):$e(n,i);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=pe.getState(),i=n.positions,r=n.hotelList,o=void 0===r?[]:r,a=n.recList,s=void 0===a?[]:a,l=fe.updatePayLoad,c=fe.updatePageStatus,u=fe.kmDevTraceLog;l({allFinish:!0,bottomInfo:{showBottom:!0,showError:!1,showCircle:!1,text:"\u5df2\u663e\u793a\u6240\u6709\u9152\u5e97"}});var d=!(o.length+s.length+e.length+t.length);c({showHotelEmpty:d&&vt.isEmpty(i)}),d&&u({messageId:ie.n6.no_hotel,desc:ie.DV.no_hotel})},ct={store:pe,actions:(0,c.Z)((0,c.Z)({},fe),{},{handlePullNew:We,fetchHotelListNew:me.fetchHotelList}),HotelParams:$,trace:Y,SelectModel:bt},It=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("initNewParams");var t=pe.getState(),n=t.searchKeyWord,i=t.selected,r=t.recList,o=t.sort,a=t.mapedAppType,s=t.cityCenter,l=void 0===s?{}:s,c=t.urlQuery,u=t.sortValue,d=e.isFilter,h=e.singleSearchInfo,p=void 0===h?{}:h,f=e.isSearch,v=void 0!==f&&f,m=fe.updatePayLoad;d||(bt.selected={},bt.positions=[],bt.hasMap=!1,$.sortValue=q[0]),$.initHotelParam(c),$.sortValue=u,$.map={name:l.name,DotX:l.lat,DotY:l.lon,IsQuery:!1,Distance:""};var y=vt.get(i,["4"],[]),g=y[0]||{},w=g.gDLat,S=g.gDLon,x=g.centralName,Z=1===y.length&&w&&S;$.selected2Param={selected:bt.selected,positions:bt.positions},Z&&($.map={DotX:w,DotY:S,IsQuery:!1,name:x||"\u5546\u533a\u4e2d\u5fc3"}),$.pageSize=10,$.keyword=v?"":n,Ce($),m({singleParams:p,allFinish:!1,needScrollToTop:!0,recList:d?[]:r,selected:bt.selected,positions:bt.positions,sortValue:"online"===a?wt(o,u,$.sortValue):$.sortValue,recParams:{SearchMode:0,HiddenHotelList:"",ExpandFilterSearchPriority:0}})},Nt=function(e){var t=fe.updatePayLoad;t({curFilter:"",searchStatus:e},"goToSearch",{value:e?"\u6253\u5f00\u641c\u7d22\u9875\u9762":"\u5173\u95ed\u641c\u7d22\u9875\u9762"})},Ft=function(e){var t=pe.getState(),n=t.showTopBtn,i=t.hotelList,r=t.traced,o=fe.updatePayLoad,a=e.viewableItems,s=e.changed,l=vt.remove(a,(function(e){var t;return 1===(null===e||void 0===e||null===(t=e.section)||void 0===t?void 0:t.title)})),c=vt.filter(s,(function(e){return e.isViewable&&e.index&&!vt.some(r,(function(t){return t===e.index}))})),u=vt.map(c,(function(e){return e.index}));r=[].concat((0,y.Z)(r),(0,y.Z)(u));var d=!1;if(l.length)d=i.length>5;else{var h=vt.sortBy(a,"index"),p=vt.last(h);d=p&&p.index>5}o({traced:r}),d?n||o({showTopBtn:!0}):n&&o({showTopBtn:!1})},_t=function(e){Ft(e);var t=pe.getState(),n=t.allFinish,i=t.hotelList,r=e.viewableItems,o=!n&&r.some((function(e){return Number(e.index)>i.length-5}));o&&me.pullNext()},Ct=function(){null===V||void 0===V||V("https://pages.c-ctrip.com/groupTravelUED/flight_hotel/20190617/h5/activity2.html",{},{openTab:!0})},jt=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(n,i,r){var o,a,l,u,d,h,f,v,m,y,g,w,x,Z,k,b,P,L,T;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{if(a=pe.getState(),l=a.bottomInfo,u=a.urlQuery,d=void 0===u?{}:u,console.log(l.showCircle,"goto detail conditions"),h=Ht(n),console.log("%c hotelDetail","color: red",h),f=fe.updatePayLoad,v=n.name,m=n.diffPrice,y=n.plusSign,g={cidt:"\u5165\u4f4f\u65e5\u671f",codt:"\u79bb\u5e97\u65e5\u671f",hotelId:"\u9152\u5e97id",starCount:"\u661f\u7ea7",score:"\u8bc4\u5206",votesCount:"\u8bc4\u8bba\u6570",distance:"\u8ddd\u79bb\u6587\u6848",address:"\u9152\u5e97\u5730\u5740"},f({},"jumpHotel",{module:r?"\u641c\u7d22\u5217\u8868":"\u5217\u8868\u5361\u7247",value:v,contents:["starCount","score","votesCount","distance","address","hotelId","cidt","codt"].map((function(e){return{key:g[e],value:n[e]||d[e]}})).concat([{key:"\u4ef7\u683c",value:d.baseprice+(y?Number(m):-Number(m))},{key:"\u6392\u5e8f\u4f4d\u7f6e",value:i+1}])}),h.sltQuick,null!==(o=Je)&&void 0!==o&&null!==(o=o.document)&&void 0!==o&&o.body)null===H||void 0===H||H("hotelDetail",h);else{for(w in h)void 0===h[w]&&delete h[w];x=d.baseprice,Z=d.basetradeprice,k=d.distributionchannelid,b=d.choosesingleresource,P=d.frompage,L=d.crnmodulename,T=d.istrade,new p((0,c.Z)({baseprice:x,basetradeprice:Z,distributionchannelid:k,choosesingleresource:b,frompage:P,istrade:T},h),{needJump:!0,pageName:"hotelDetail",env:t.env,jumpOptions:{hotel:"rn_diytour_s"!==L}})}W.beforeJump({store:pe,storage:s}),Y.traceLogHotelClick(n,i,pe.getState())}catch(e){console.log("handleGotoHotelDetail error",e)}case 1:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),Ht=function(e){var t=pe.getState(),n=t.urlQuery,i=t.selected,r=t.positions,o=t.quickFilters,a=t.slts,s=(n.fromconfirm,n.sourcefrom),l=n.shoppingid,c=n.cidt,u=n.codt,d=n.adult,h=n.child,p=n.cityid,f=n.infant,v=n.slthoteltoken,y=n.segment,g=n.frompagename,w=n.sltroomtoken,S=n.sltroomid,x=n.sltuniquekey,Z=n.srcfrom,k=n.opats,b=n.gcny,P=n.orderid,L=n.guidetype,I=n.pid,N=n.pdid,F=void 0===N?I:N,_=n.iswx,C=e.value,j=e.hotelId,H=void 0===j?Number(C):j,V=e.hotelToken,D=e.cityId,B=void 0===D?p:D,E=e.picUrl,R=(e.videoCover,[]);if(r.length){var A,O=(0,m.Z)(r);try{var M=function(){var e=A.value;if(vt.find(o,(function(t){return t.id===Number(e[0])}))){var t=vt.get(i,e,[]);vt.each(t,(function(t){R.push("".concat(e[0],"-").concat(t.value))}))}};for(O.s();!(A=O.n()).done;)M()}catch(e){O.e(e)}finally{O.f()}}else if(!vt.isEmpty(a))for(var Q in a){var q=a[Q];R.push("".concat(Q,"-").concat(q))}return{fromHotelList:2,sourcefrom:s,srcfrom:Z,shoppingId:l,hotelId:H,hotelToken:V,cityId:B,cidt:c,codt:u,adult:d,child:h,infant:f,imgUrl:null===E||void 0===E?void 0:E.replace(/\_R_250_250.(jpg|Jpg|png|jpeg)$/,".$1"),sltHotelToken:v,segment:y,sltRoomToken:w,sltRoomId:S,sltUniqueKey:x,fromPageName:g,opats:k,gcny:b,pid:F,pdid:F,orderId:P,guideType:L,diffCity:B===p?"":"1",sltQuick:JSON.stringify(R),callback:T.callback,isWX:_}},Vt=function(){var e;null===s||void 0===s||null===(e=s.set)||void 0===e||e.call(s,!0,"showTips");var t=fe.updatePayLoad;t({showTips:!1})};ft((function(){console.log("finishCallback"),W.beforeJump({store:pe,storage:s})}));var Dt=function(e){console.log(e);var t=fe.updateRangeData,n=pe.getState(),i=n.rangeData,r=void 0===i?{}:i,o=r.priceRange,a=void 0===o?[]:o,s=r.rangeStep,l=vt.cloneDeep(e),c=-1;vt.forEach(e,(function(e,t){var n=a.indexOf(e);n>-1&&(c=n)})),e[0]===e[1]&&(l[Number(!c)]=e[0]+(a[c]>a[Number(!c)]?s:-s)),t({priceRange:l})},Bt=function(){var e=pe.getState(),t=e.rangeData,n=e.selected,i=void 0===n?{}:n,r=t.priceRange,o=t.rangeMax,a=t.rangeMin,s=t.filterPrice,l=void 0===s?[a,o]:s,c=fe.updateRangeData,u=vt.sortBy(vt.map(r,(function(e){return Number(e)}))),d=[["noChange","\u6539\u53d8\u4e0a\u9650"],["\u6539\u53d8\u4e0b\u9650","\u540c\u65f6\u6539\u53d8"]],h=l[0]-u[0],p=l[1]-u[1],f=d[Number(!!h)][Number(!!p)];if("noChange"!==f){var v=[["\uffe5".concat(u.join("-")),"\uffe5".concat(u[0],"\u4ee5\u4e0a")],["\uffe5".concat(u[1],"\u4ee5\u4e0b"),null]],m=v[Number(u[0]===a)][Number(u[1]===o)];u[1]=u[1]===o?2147483647:u[1];var y=u.join("-");c({priceValues:u,filterPrice:u});var g=vt.get(i,["10","0"]);null!==m&&(g={isRadio:!0,name:m,position:["10"],tier:3,id:"10",value:y}),mt(ct,{selectObj:g,needSelect:null!==m})}},Et=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t){var n,i,r,o,a,s,l,c,u,d,h,p;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=pe.getState(),r=i.urlQuery,o=void 0===r?{}:r,a=i.cargoContext,e.next=3,(0,U.zo)(R,o,a);case 3:return s=e.sent,l="query GetSingleRoom($params: SingleRoomReq) {\n            SingleRoom(params: $params) {\n                newPolicy,\n                policy,\n                ResponseStatus\n            }\n        }",c=o.cidt,u=o.codt,d=o.shoppingid,h={originQuery:{cidt:c,codt:u,hotelid:t}},s&&null!==(n=Je)&&void 0!==n&&n.idiyHotelAntiSpiderToken&&(h.token=Je.idiyHotelAntiSpiderToken,h.fingerprintkeys=null===(p=Je.Kar98k)||void 0===p?void 0:p.hoteluuidkeys),e.prev=8,e.abrupt("return",M(l,{ShoppingId:d,opts:h}));case 12:e.prev=12,e.t0=e["catch"](8),console.log("fetch hotel detail error",e.t0);case 15:case"end":return e.stop()}}),e,null,[[8,12]])})));return function(t){return e.apply(this,arguments)}}(),Rt=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t){var n,i,r,o,a;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Et(t);case 3:n=e.sent,i=n.SingleRoom,r=void 0===i?{}:i,o=r.newPolicy,o?(a=fe.updateSinglePolicies,a({hotelId:t,Policies:o})):console.log("no policy"),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),console.log("setHotelPolicy",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),At=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t,n){var i,r,o,a,s;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=pe.getState(),r=i.hotelPolicies,o=void 0===r?{}:r,a=fe.updatePayLoad,t&&vt.isEmpty(o[t])?(s=new Promise((function(e){return setTimeout(e,200)})),Promise.race([s,Rt(t)]).then((function(){a({showPolicyId:t})}))):a({showPolicyId:t});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ot=function(){var e=pe.getState(),t=e.showPricePop;if(t)fe.updatePayLoad({showPricePop:!1});else{var n=pe.getState(),i=n.curFilter,r=n.searchStatus;if(i||r){var o=fe.updatePayLoad;o({curFilter:"",searchStatus:!1})}else b.diyBackPage&&b.diyBackPage()}},Mt=function(e){var t=fe.updatePayLoad,n=pe.getState(),i=n.urlQuery,r=void 0===i?{}:i,o=n.cityChanged;t({selected:{},positions:[],urlQuery:(0,c.Z)((0,c.Z)({},r),{},{cityid:e}),cityChanged:!o,searchKeyWord:""})},Qt=function(e){var t=e.isError,n=fe.updatePageStatus;t&&n({showPageInitEmpty:!0})},qt=function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t,n){var i,r,o,a,s,l,u,d,h,p,f,v,m,y,g,w,x,Z,k,b;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return null===(i=O)||void 0===i||null===(i=i.fetch)||void 0===i||i.abort(),o=pe.getState(),a=o.searchInfo,s=void 0===a?{}:a,l=fe.updatePayLoad,u=fe.updatePageStatus,d=!0,h=null===(r=et)||void 0===r?void 0:r.querySelector("input#searchInput".concat(t)),p=null===h||void 0===h?void 0:h.value,l({searchKeyWord:p||"",skeletonInfo:{showSkeleton:!0,needTop:!0}}),u({hasInitCustom:!1,isInitHotelList:!1,showPageInitEmpty:!1}),s.word!==p&&(l({selected:{},positions:[],searchInfo:{}}),s={},d=!1),e.next=11,(0,Xe.y)({sourcefrom:T.sourcefrom,orderId:T.orderid,productId:T.pid,isMandatoryOrder:T.ismandatoryorder,distributionChannelId:T.distributionchannelid,distributionChannel:T.distributionchannel,modifiedResToken:T.modifiedrestoken,graphqlRequest:M})(n);case 11:f=e.sent,f.shoppingId?(m=pe.getState(),y=m.appType,g=m.urlQuery,w=m.searchInfo,x=void 0===w?{}:w,Z=fe.updatePageStatus,k=fe.updatePayLoad,Z({hasInitCustom:!0}),x.word&&(f.filterInfo=(0,c.Z)((0,c.Z)({},x),{},{name:x.word}),f.type=x.type,f.typeid=x.id),f.keyword=p||(null===(v=et)||void 0===v||null===(v=v.querySelector("input#searchInput".concat(t)))||void 0===v?void 0:v.value),Pt=!0,console.log({result:f,searchInfo:x,searchParams:n}),b=W.getLowerCaseQuery(f),k({urlQuery:(0,c.Z)((0,c.Z)((0,c.Z)({},g),b),W.getIsAbroad(b))}),Qe(y,{isdingzhi:!0,isSearch:d})):u({showPageInitEmpty:!0});case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Wt={};vt.forEach(o,(function(e,t){Wt[t]=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.apply(void 0,[ct].concat(n))}}));var Kt=T.shoppingId,zt=T.shoppingid,Ut=void 0===zt?Kt:zt;return pt((0,x.Z)((0,S.Z)().mark((function e(){var t,n,i,r;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("===============> isSSR",B),!B){e.next=20;break}return e.prev=2,console.log("preload call back"),t="h5",e.next=7,Promise.all([(0,U.lx)(R,Kt),Me(!0,{funcName:"initHotelList",funcParams:{appType:t}},!0,t)]);case 7:n=e.sent,i=(0,g.Z)(n,1),r=i[0].Link,fe.updatePayLoad({Link:r,hasPreload:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](2),console.log(e.t0),fe.updatePayLoad({hasPreload:!1});case 17:return e.prev=17,ge(),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[2,13,17,20]])})))),{store:pe,actions:(0,c.Z)((0,c.Z)((0,c.Z)((0,c.Z)((0,c.Z)({},fe),W),{},{initListData:Oe,fetchHotelList:ke},Wt),ye),{},{handleToggleOne:function(e){return mt(ct,e)},handleToggleAll:function(e){return yt(ct,e)},getSharkValue:Q,handleClickQuickFilters:function(e){return gt(ct,e)},initHotelList:Qe,initProcess:me.initProcess,initAntiSpider:function(){return(0,U.nu)(R,Ut)},initNewParams:It,onSelectBottom:function(){me.onSelectBottom.apply(me,arguments),me.fetchHotelList(!1,!0)},onSelectFilter:function(){me.onSelectFilter.apply(me,arguments),me.fetchHotelList(!1,!0)},onSelectSpace:function(){me.onSelectSpace.apply(me,arguments),me.fetchHotelList(!1,!0)},onClear:function(){me.onRNClear.apply(me,arguments),me.fetchHotelList(!1,!0)},onSelectQuick:function(){me.onSelectQuick.apply(me,arguments),me.fetchHotelList(!1,!0)},getFilterBarData:me.getFilterBarData,pullNext:me.pullNext,handlePullNew:We,handlePullNext:ze,handlePullRecList:Ge,handleAutoPull:Ke,handleUpdateShowPolicy:At,getFilterCurStatus:Zt,getSearchHistory:He,clearSearchHistory:De,handleClickKeyWord:re?Ee:Be,fetchSearchKeyword:Ze,handleSearchKeyWord:ee||te||re?me.handleSearchKeyWord:Re,getSearchParams:function(e){return W.getSearchParams(ve,e)},handleRangePriceTap:Dt,handleRangeThumbTouch:Bt,handleGotoSearch:Nt,handleSort:Ue,handleGotoHotelDetail:jt,handleCheckTopStatus:Ft,handleCheckLoadPage:_t,handleGotoPkgDetail:Ct,handleCloseTips:Vt,handleBack:Ot,handleSearchChangeCity:Mt,handleSegmentIserror:Qt,handleSearch:qt,fetchFirstData:be})}},Nt=ct(It),Ft=n(96086),_t=function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{headerInfo:t})},Ct=function(e,t){var n={down:!0,up:!1};return(0,c.Z)((0,c.Z)({},e),{},{showTradePrice:n[t]||!1})},jt=function(e,t){return(0,c.Z)((0,c.Z)({},e),{},{shoppingCartConfig:t})},Ht=n(32180)["window"],Vt=["baseContext","gqlRequestFn"],Dt=k.setupStore,Bt=k.setupContext,Et=k.setupStartCallback,Rt=k._,At=k.createReactModel,Ot=k.setupEnvContext,Mt=k.gql,Qt={headerInfo:{title:""},showTradePrice:!1,shoppingCartConfig:{}},qt=function(){var e=Bt(G.z1),t=Bt(G.fH),n=Bt(G.QE),i=Bt(G.fI),r=i.urlQuery,o=Ot(),a=Dt({name:"BaseModel",initialState:Qt,reducers:s,logger:!0}),l=a.store,u=a.actions,d=e.pageType,h=void 0===d?"":d,p=t.baseContext,f=void 0===p?{}:p,v=t.gqlRequestFn,m=(0,w.Z)(t,Vt),y=n.BestonStorage,g=v((0,c.Z)((0,c.Z)({},o),{},{baseContext:f},m));return Et((0,x.Z)((0,S.Z)().mark((function e(){var t,n,i,o;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("bestone"!==f.appType||"H5"!==h||!y||!y.getInstance){e.next=7;break}return e.next=3,y.getInstance().getVolumeStatus();case 3:t=e.sent,t&&u.updateShowTradePrice(t),Ht.testVol=u.updateShowTradePrice,"undefined"!==typeof Ht.TDS&&Ht.TDS.volume((function(e){1===Number(e.volume)&&(u.updateShowTradePrice("up"),y.getInstance().setVolumeStatus("up")),0===Number(e.volume)&&(u.updateShowTradePrice("down"),y.getInstance().setVolumeStatus("down"))}));case 7:if(n=r.shoppingId||r.shoppingid,!n||f.shoppingCartConfig){e.next=14;break}return e.next=11,g(Mt(ee||(ee=(0,Ft.Z)(["\n                    query ShoppingCartConfig($params: ShoppingCartConfigParams) {\n                        ShoppingCartConfig(params: $params) {\n                            config\n                        }\n                    }\n                "]))),{shoppingId:n});case 11:i=e.sent,o=Rt.get(i,"ShoppingCartConfig.config")||{},u.updateShoppingCartConfig(o);case 14:case"end":return e.stop()}}),e)})))),{store:l,actions:u}},Wt=At(qt),Kt=n(59083),zt=n(79038),Ut=n(59772),Gt=n(86638),$t=k._,Yt=function(e){(0,p.Z)(n,e);var t=(0,f.Z)(n);function n(e){var i,r;return(0,u.Z)(this,n),r=t.call(this,e),(0,v.Z)((0,h.Z)(r),"set",(function(e,t){(0,zt.Z)((i=(0,h.Z)(r),(0,Ut.Z)(n.prototype)),"set",i).call(i,t,e)})),r}return(0,d.Z)(n,[{key:"addHistory",value:function(){var e=(0,x.Z)((0,S.Z)().mark((function e(t){var n,i,r,o;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.get("searchList");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:n=e.t0,$t.isEmpty(t)||"object"!==(0,$.Z)(t)||(i=t.type,r=t.word,"string"===i&&(r=r.replace(/^\s+/,"").replace(/\s+$/,"")),$t.isEmpty(r)||(o=$t.remove(n,(function(e){return e.word===r&&e.type===i})),$t.isEmpty(o)&&n.length>=10&&n.pop(),n.unshift(t),this.set(n,"searchList")));case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),n}(Gt.Z),Xt=n(95749),Jt=n(90201),en=n(71515),tn=n(92954),nn=n.n(tn),rn=n(2269),on=k._,an=function(e){var t=e.name;return(0,rn.jsx)(en.View,{className:t})},sn=function(e){var t=e.num,n=e.name,i=e.keyName;return(0,rn.jsx)(en.View,{className:n,children:on.map(Array(t),(function(e,t){return(0,rn.jsx)(an,{name:"s".concat(t+1," s_block")},i+n+t)}))})},ln=function(e){var t=e.i,n=e.setIndex;return(0,rn.jsxs)(en.View,{className:"htl_s_top",ref:function(){if(!t)var e=setTimeout((function(){n(-1),clearTimeout(e)}),200)},children:[(0,rn.jsx)(sn,{num:4,name:"s_top01",keyName:"s_top01"}),(0,rn.jsx)(en.View,{className:"s_top02",children:(0,rn.jsx)(sn,{num:5,name:"block_box",keyName:"s_top02"})})]})},cn=function(e){var t=e.state,n=e.index,i=e.setIndex,r=t.showIndex,o=t.hasShow,a=r>n;return(0,Jt.useEffect)((function(){var e,t=o===n;return t&&!e&&(e=setTimeout((function(){return i(n)}),200)),function(){t=!1,clearTimeout(e)}})),a?(0,rn.jsxs)(en.View,{className:"htl_skeleton_listbox",children:[(0,rn.jsx)(en.View,{className:"skeleton_pic"}),(0,rn.jsxs)(en.View,{className:"skeleton_mod",children:[(0,rn.jsx)(sn,{num:3,name:"s_item_top",keyName:"s_item_top"}),(0,rn.jsx)(sn,{num:2,name:"s_item_bottom",keyName:"s_item_bottom"})]})]}):null},un=function(e,t){return{showIndex:t+2,hasShow:t+1}},dn=function(e){var t=e.needTop,n=(0,Jt.useReducer)(un,{showIndex:t?0:1,hasShow:0}),i=(0,g.Z)(n,2),r=i[0],o=i[1];return(0,rn.jsxs)(en.View,{className:"htl_skeleton",children:[t&&(0,rn.jsx)(ln,{i:r.showIndex,setIndex:o}),on.map(Array(r.showIndex),(function(e,t){return(0,rn.jsx)(cn,{state:r,setIndex:o,index:t},t)}))]})},hn=Jt.memo(dn),pn=k._,fn=function(){function e(t){if((0,u.Z)(this,e),(0,v.Z)(this,"_listeners",{}),!t||"string"!==typeof t)throw"Observer's constructor need a param, and its type must be string";this.pageName=t,this._listeners[this.pageName]={}}return(0,d.Z)(e,[{key:"subscribe",value:function(e,t){(this._listeners[this.pageName][e]||(this._listeners[this.pageName][e]=[])).push(t)}},{key:"unsubscribe",value:function(e,t){var n=this;t?pn.each(this._listeners[this.pageName][e],(function(i,r){i===t&&n._listeners[n.pageName][e].splice(r,1)})):delete this._listeners[this.pageName][e]}},{key:"publish",value:function(e,t){pn.each(this._listeners[this.pageName][e],(function(e,n){"function"===typeof e&&e(t)}))}}],[{key:"getInstance",value:function(t){if(!t||"string"!==typeof t)throw"Observer's constructor need a param, and its type must be string";return e.observers[t]||(e.observers[t]=new e(t)),e.observers[t]}}]),e}();(0,v.Z)(fn,"observers",{});var vn,mn,yn=function(e){return fn.getInstance(e)},gn=yn,wn=k._,Sn=function(){var e,t=Nt.useState(),n=(t.slts,t.sltsBtn),i=void 0===n?{}:n,r=(t.hotelList,t.mapFilter),o=void 0===r?{}:r,a=Nt.useActions(),s=a.onSelectBottom,l=(null===o||void 0===o||null===(e=o.subText)||void 0===e?void 0:e.indexOf("%"))>-1;return(0,rn.jsx)(rn.Fragment,{children:(0,rn.jsx)(en.View,{className:"select_type_box",children:(0,rn.jsxs)(en.View,{className:"select_type_list",children:[wn.map(i,(function(e,t){return wn.map(e,(function(e,n){return(0,rn.jsxs)(en.View,{className:"select_item",children:[(0,rn.jsx)(en.View,{className:"select_text",children:e}),(0,rn.jsx)(en.View,{className:"select_delete_icon",onClick:function(){return s({type:n,firstType:t})}})]},"selectedFilter-".concat(t))}))})),o.type&&!l?(0,rn.jsxs)(en.View,{className:"select_item",children:[(0,rn.jsx)(en.View,{className:"select_text",children:o.text}),(0,rn.jsx)(en.View,{className:"select_delete_icon",onClick:function(){return s({isMap:!0})}})]},"selectedFilter-".concat(o.type)):null]})})})},xn=Sn,Zn=k._,kn=k.classnames,bn=Jt.memo((function(e){var t=e.hotelList,n=void 0===t?[]:t,i=e.slts,r=void 0===i?{}:i,o=e.showHotelEmpty,a=e.mapFilter,s=void 0===a?{}:a,l=!Zn.isEmpty(r),c=!n.length,u=!(Zn.isEmpty(r)&&!s.type||n.length>=10);return o?(0,rn.jsx)(en.View,{className:"fullpage_error",children:(0,rn.jsxs)(en.View,{className:"loading_status_column",children:[(0,rn.jsx)(en.View,{className:"pic status_01",children:(0,rn.jsx)(en.Image,{className:"img",src:"http://pic.c-ctrip.com/VacationH5Pic/taocan/dp2/koala_pub_no_result.png"})}),(0,rn.jsx)(en.View,{className:"loading_status_info",children:(0,rn.jsx)(en.View,{className:"loading_status_text",children:(0,rn.jsx)(en.View,{children:"\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u9152\u5e97"})})})]})}):l||c?(0,rn.jsxs)(en.View,{className:kn({htl_search_failure:c||u}),children:[c&&(0,rn.jsx)(en.View,{children:(0,rn.jsxs)(en.View,{className:"loading_status_row",children:[(0,rn.jsx)(en.View,{className:"pic status_01",children:(0,rn.jsx)(en.Image,{className:"img",src:"http://pic.c-ctrip.com/VacationH5Pic/taocan/dp2/koala_pub_no_result.png"})}),(0,rn.jsx)(en.View,{className:"loading_status_info",children:(0,rn.jsxs)(en.View,{className:"loading_status_text",children:[(0,rn.jsxs)(en.View,{children:["\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u9152\u5e97",l?"\uff0c":""]}),l?(0,rn.jsx)(en.View,{children:"\u60a8\u53ef\u4ee5\u5220\u9664\u4e00\u4e9b\u6761\u4ef6\u518d\u67e5\u8be2"}):null]})})]})}),u&&(0,rn.jsx)(xn,{})]}):null})),Pn=bn,Ln={red:"#F5190A",orange:"#FF7700",blue:"#0086F6",green:"#00B87A",gray:"#AAAAAA",gold:"#B37E36",blueGray:"#5678A8"},Tn={red:"#FCC5C1",orange:"#FFDCBF",blue:"#BFE0FC",green:"#BFEDDD",gray:"#CCCCCC",gold:"#E8DEC2",blueGray:"#B8C6D9"},In=function(e){var t=e.type,n=e.text,i=e.color,r=e.icon,o=e.classname,a={},s={};return"solid"===t?(a={backgroundColor:Ln[i]},s={color:"#FFF"}):(a={borderColor:Tn[i],borderWidth:1},s={color:Ln[i]}),(0,rn.jsxs)(en.View,{className:"'shoppingcart_label_ctr '".concat(o||""),style:a,children:["icon"===t&&(0,rn.jsx)(en.View,{className:"left",style:{backgroundColor:Ln[i]},children:(0,rn.jsx)(en.View,{className:"label_icon ".concat(r)})}),(0,rn.jsx)(en.View,{className:"right",style:s,children:n})]})},Nn=In,Fn=n(36658),_n=function(e){return(0,rn.jsx)(en.View,{"data-testid":"toTop",className:"a_return_top",onClick:function(t){console.log("ToTopBtn onClick handleToTop"),t.preventDefault(),e.handleToTop()},children:(0,rn.jsx)(en.View,{className:"icon-backtop"})})},Cn=_n,jn=function(e){var t=e.text,n=e.className,i=e.clickFunc,r=e.wrapperStyle,o=void 0===r?{}:r;return(0,rn.jsxs)(en.View,{className:"htl_loading_box",style:o,onClick:function(){return i()},children:[(0,rn.jsx)(en.View,{className:n}),(0,rn.jsx)(en.View,{className:"i_text",children:t})]})},Hn=function(e){var t=e.showCircle,n=e.showBottom,i=e.showError,r=e.handlePullHotelList,o=e.showHotel;return n?t?(0,rn.jsx)(jn,{wrapperStyle:{paddingBottom:30},className:"i_loading",text:"\u52a0\u8f7d\u4e2d",clickFunc:function(e){return e}}):i?(0,rn.jsx)(jn,{className:"i_failed",text:"\u91cd\u65b0\u52a0\u8f7d",clickFunc:r}):o?(0,rn.jsx)(en.View,{id:"bottom_nomore",className:"data_no",children:(0,rn.jsx)(en.View,{children:"\u5df2\u663e\u793a\u6240\u6709\u9152\u5e97"})}):null:null},Vn=Hn,Dn=k.classnames,Bn=k._,En=Nt.useState,Rn=Nt.useActions,An=Wt.useState,On=gn("hotelList"),Mn=nn().getSystemInfoSync().windowWidth,Qn=nn().getSystemInfoSync().windowHeight,qn=function(e){var t=e.hotel,n=e.index,i=t.picUrl,r=t.hasFlag,o=t.tagYXH,a=r.view,s=r.video,l=r.vrPicture,c=(0,Jt.useState)(110),u=(0,g.Z)(c,2),d=u[0],h=u[1],p=(0,Jt.useState)(!1),f=(0,g.Z)(p,2),v=f[0],m=f[1],y=s||l;return(0,Jt.useEffect)((function(){var e=setTimeout((function(){var e=nn().createSelectorQuery();e.select("#img-".concat(t.hotelId)).boundingClientRect().exec((function(e){var t,n=null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.height;n>0&&(h(n),m(!0))}))}),100);return function(){e&&clearTimeout(e)}}),[]),(0,rn.jsxs)(en.View,{id:"img-".concat(t.hotelId),className:"htl_img_ctr","data-testid":"imgContainer",children:[o?(0,rn.jsx)(en.View,{className:"member_tips","data-testid":"member_tips",children:"\u4f18\u4eab\u4f1a"}):null,v&&i?(0,rn.jsx)(en.View,{className:"img_pic",style:{backgroundImage:"url(".concat(i,")"),backgroundSize:"cover",height:d}}):(0,rn.jsx)(en.View,{className:"img_default",style:{height:d}}),y||a?(0,rn.jsxs)(en.View,{className:"icon_wrapper",children:[y?(0,rn.jsxs)(en.View,{className:"icons_box",children:[s&&(0,rn.jsx)(en.View,{className:"icons-detail_play","data-testid":"icons-detail_play"}),l&&(0,rn.jsx)(en.View,{className:"icons-detail_360","data-testid":"icons-detail_360"})]}):null,a?(0,rn.jsx)(en.View,{className:"pic_bottom_tag",children:(0,rn.jsx)(en.View,{className:"recent_tag",children:a})}):null]}):null]},n)},Wn=Jt.memo((function(e){var t=e.hotel,n=t.name,i=(t.ename,t.starType),r=void 0===i?"diamondShapeFilling":i,o=t.starCount,a=t.tagHeader,s=t.medalType,l=void 0===s?"":s,c={star:"icon-star",diamondShapeFilling:"icon-diamond"};return(0,rn.jsxs)(en.View,{className:"htl_info_header",children:[(0,rn.jsx)(en.Text,{style:{width:Mn-110-30},className:"name",children:n}),(0,rn.jsx)(en.View,{className:"stars",children:(0,y.Z)(Array(o).keys()).map((function(e,t){return"circle"===r?(0,rn.jsx)(en.View,{className:"icon-bnb",children:"\udb80\ude0e"}):(0,rn.jsx)(en.View,{className:c[r],"data-testid":"htl-star-icon"},t)}))}),!!l&&(0,rn.jsx)(en.Image,{className:"medal",src:"https://pic.c-ctrip.com/VacationH5Pic/shopping-cart/hotel-tag-".concat(l,".png"),"data-testid":"medalType"}),a.map((function(e,t){var n=e.name,i=e.className,r=function(e){return e["gray"]="s_label_gray_n",e["red"]="s_label_orange_n",e}({});return n?(0,rn.jsx)(en.View,{className:Dn((0,v.Z)({label:!0},r[i],!0)),children:n},t+n):null}))]})})),Kn=Jt.memo((function(e){var t=e.hotel,n=t.score,i=t.votesCount,r=t.tagChinese,o=(t.tagComment,t.tagCollection);return(0,rn.jsxs)(en.View,{className:"htl_comment_ctr",children:[n>0?(0,rn.jsx)(en.View,{className:"score",children:n}):null,(0,rn.jsx)(en.View,{className:"no_score",children:n>0?"":"\u6682\u65e0\u8bc4\u5206"}),(0,rn.jsx)(en.View,{className:"tag_chinese",children:r}),(0,rn.jsx)(en.View,{className:"vote_count",children:i}),o?(0,rn.jsx)(en.View,{className:"vote_count",children:" \xb7 ".concat(o)}):null]})})),zn=Jt.memo((function(e){var t=e.hotel,n=t.distance,i=t.address,r=(0,Jt.useState)(!0),o=(0,g.Z)(r,2);o[0],o[1];return(0,rn.jsxs)(en.View,{className:"htl_address_ctr",children:[n?(0,rn.jsx)(en.Text,{style:{maxWidth:Mn-110-30},className:"address_txt",children:n}):null,i?(0,rn.jsx)(en.Text,{style:{maxWidth:Mn-110-30},className:"address_txt",children:i}):null]})})),Un=function(e){return e.map((function(e,t){var n=e.name,i=e.className,r=e.type,o=void 0===r?"border":r,a=e.tagDesc,s=void 0===a?n:a,l="originTag"===i?"orange":i,u="orange"===l?{text:s,color:l,type:o,icon:"icon-stag"}:{text:s,color:"blueGray",type:o};return s?(0,rn.jsx)(en.View,{className:"tag_label",children:(0,rn.jsx)(Nn,(0,c.Z)({},u))},n+t):null}))},Gn=Jt.memo((function(e){var t=e.hotel,n=(t.tagMarket,t.tagTheme),i=t.hasTagBoard,r=t.encourageTag,o=void 0===r?{name:""}:r,a=n.filter((function(e,t){return t<=1})),s=o.name;return(0,rn.jsxs)(en.View,{className:"htl_tags_ctr",children:[(0,rn.jsx)(en.View,{className:"htl_tags_box",children:Un(a)}),(0,rn.jsxs)(en.View,{className:"encourageTagBox",children:[i?(0,rn.jsx)(en.Text,{className:"iconStyle",children:"\udb82\udeb7"}):null,!!s&&(0,rn.jsx)(en.View,{className:"encourageTag",style:i?{color:"#99532E"}:{},children:s})]})]})})),$n=Jt.memo((function(e){var t=e.hotel,n=void 0===t?{}:t,i=e.pageId,r=e.handleShowPricePop,o=e.query,a=e.showTradePrice,s=o.baseprice,l=void 0===s?"":s,c=o.basetradeprice,u=void 0===c?"":c,d=""!==l||""!==u,h=n.price,p=n.tagMarket,f=n.totalDiscount,v=n.totalPkgSave,m=n.tradePriceDiff,y=n.plusSign,g=n.diffPrice;h=a?m:d?g:h;var w=d&&!y;return(0,rn.jsxs)(en.View,{className:"htl_price_ctr",children:[(0,rn.jsxs)(en.View,{className:Dn({green:w,price:!0}),children:[(0,rn.jsx)(en.View,{className:d?"":"gray",children:d?y?"+":"-":"\u6bcf\u95f4\u6bcf\u665a"}),(0,rn.jsx)(en.View,{className:"rmb",children:"\xa5"}),h,(0,rn.jsx)(en.View,{className:"gray",children:"\u8d77"}),f?(0,rn.jsx)(en.View,{className:"icon_wenhao",onClick:function(e){e.preventDefault(),e.stopPropagation(),r(n,i)}}):null]}),p.length?(0,rn.jsx)(en.View,{style:{flexDirection:"row",display:"flex",justifyContent:"flex-end",width:"100%"},children:(0,rn.jsx)(en.View,{className:"marketBox",children:p.map((function(e,t){var n=e.name;return(0,rn.jsxs)(Jt.Fragment,{children:[t?(0,rn.jsx)(en.Text,{style:{height:"15rpx",width:"1rpx",backgroundColor:"#ffc89a",margin:"0 6rpx"}}):null,(0,rn.jsx)(en.Text,{className:"marketTxt",children:n})]},t)}))})}):null,v>0&&(0,rn.jsx)(en.View,{className:"price_drop_box",children:(0,rn.jsxs)(en.View,{className:"price_drop_label .s_label_taocan_n",children:["\u6b64\u5957\u9910\u53ef\u518d\u7701\xa5",v]})})]})})),Yn=Jt.memo((function(e){var t=e.hotel,n=t.ename,i=t.tagTopComment,r=Rn(),o=(r.handleGotoHotelDetail,r.handleShowDiscount),a=En(),s=a.urlQuery,l=(0,Fn.B)(),u=l.pageId,d={hotel:t,pageId:u,query:s,handleShowPricePop:o};return(0,rn.jsxs)(en.View,{className:"htl_info_ctr",children:[(0,rn.jsx)(Wn,{hotel:t}),n?(0,rn.jsx)(en.View,{style:{width:Mn-110-30},className:"e_name",children:t.ename}):null,(0,rn.jsx)(Kn,{hotel:t}),(0,rn.jsx)(zn,{hotel:t}),i?(0,rn.jsx)(en.View,{className:"topComment",children:i}):null,(0,rn.jsxs)(en.View,{className:"htl_bottom_box",children:[(0,rn.jsx)(Gn,{hotel:t}),(0,rn.jsx)($n,(0,c.Z)({},d))]})]})})),Xn=function(e){var t=Rn(),n=t.handleGotoHotelDetail,i=(t.handleShowDiscount,e.index),r=(e.userInfo,e.list_module),o=(0,Jt.useRef)(null),a=An(),s=(a.showTradePrice,En()),l=s.hotelList,c=void 0===l?[]:l,u=s.recList,d=void 0===u?[]:u,h=s.isTour,p=(s.isInTDS,s.DistributionConfig),f=void 0===p?{}:p,v=(s.urlQuery,f.showHotelDetailComments,"\u63a8\u8350\u5217\u8868"===r),m=v?d:c,y=m[i],g=(0,Fn.B)(),w=g.pageId;if(!y)return null;y.name;var S=y.hotelId,x=y.isSelected;return(0,rn.jsxs)(en.View,{className:"htl_box",id:"diy-".concat(w,"-list-detail-").concat(S,"-").concat(y.totalPkgSave>0?1:0),style:{width:Mn},onClick:function(){return null===n||void 0===n?void 0:n(y,i)},ref:o,"data-testid":"hotelList-list-item-".concat(i),children:[x?(0,rn.jsx)(en.View,{className:"htl_selected icon_selected","data-testid":"isSelected-icon"}):null,(0,rn.jsx)(qn,{hotel:y,index:i}),(0,rn.jsx)(Yn,{hotel:y,isTour:h})]},S)},Jn=function(){var e,t=En(),n=t.hotelList,i=void 0===n?[]:n,r=t.recList,o=void 0===r?[]:r,a=t.mainFinish,s=t.slts,l=t.pageStatus,c=void 0===l?{}:l,u=t.bottomInfo,d=t.positionInfo,h=d.headerHeight,p=d.filterHeight,f=Qn-h-p,v=nn().createSelectorQuery(),m=Rn(),y=m.pullNext,w=c.showHotelEmpty,S=u.showBottom,x=u.showError,Z=u.showCircle;(0,Jt.useEffect)((function(){if(0===o.length&&a&&On.publish("MainListFinish"),!(i.length+o.length>7))return e=setTimeout((function(){v.select("#JmainList").boundingClientRect().exec((function(e){var t=e[0].height+e[0].top;console.log("contentHeight",t,Qn),t<=Qn&&y()}))}),200),function(){return clearTimeout(e)}}),[null===i||void 0===i?void 0:i.length]);var k=(0,Jt.useState)(!1),b=(0,g.Z)(k,2),P=b[0],L=b[1],T=(0,Jt.useState)(0),I=(0,g.Z)(T,2),N=I[0],F=I[1];console.log("hotelList.length, listHeight, top",i.length,f,N);var _=Bn.debounce((function(e){var t=e&&e.detail&&e.detail.scrollTop||0;console.log("onPageScroll ==============> onPageScroll res, listHeight",e.detail,f),t>f?!P&&L(!0):P&&L(!1)}),32);return(0,rn.jsxs)(en.ScrollView,{"data-testid":"hotelList-list",className:"htl_list_wrapper",scrollY:!0,scrollTop:N,onScroll:function(e){return _(e)},onScrollToLower:function(e){return y()},style:{height:w&&Bn.isEmpty(s)?f+p:f},children:[(0,rn.jsx)(en.View,{id:"JmainList","data-testid":"hotelList-sectionList",children:null===i||void 0===i?void 0:i.map((function(e,t){return(0,rn.jsx)(Xn,{index:t,list_module:"\u4e3b\u5217\u8868"},t+e.name)}))}),(0,rn.jsx)(Pn,{hotelList:i,slts:s,showHotelEmpty:w}),o.length?(0,rn.jsxs)(rn.Fragment,{children:[(0,rn.jsx)(en.View,{className:"htl_list_tit",children:"\u9644\u8fd1\u70ed\u5356\u9152\u5e97"}),(0,rn.jsx)(en.View,{className:"htl_list htl_listd2",children:o.map((function(e,t){return(0,rn.jsx)(Xn,{index:t,list_module:"\u63a8\u8350\u5217\u8868"},t)}))})]}):null,(0,rn.jsx)(Vn,{showCircle:Z,showBottom:S,showError:x,handlePullHotelList:function(){return y()},showHotel:i.length}),(0,rn.jsx)(en.View,{style:{padding:10}}),P?(0,rn.jsx)(Cn,{handleToTop:function(){return F(Math.random())}}):null]})},ei=Jn,ti=k._,ni=function(e){var t=e.callBack,n=e.opts,i=t.funcName,r=t.funcParams,o=Nt.useActions();return(0,rn.jsx)(en.View,{className:"fullpage_error",children:(0,rn.jsxs)(en.View,{className:"loading_status_column",children:[(0,rn.jsx)(en.View,{className:"pic status_01",children:(0,rn.jsx)(en.Image,{className:"img",src:"http://pic.c-ctrip.com/VacationH5Pic/taocan/dp2/koala_pub_error.png"})}),(0,rn.jsxs)(en.View,{className:"loading_status_info",children:[(0,rn.jsxs)(en.View,{className:"loading_status_text",children:[(0,rn.jsx)(en.View,{children:"\u52a0\u8f7d\u672a\u6210\u529f\uff0c\u8bf7\u518d\u8bd5\u4e00\u6b21"}),(0,rn.jsx)(en.View,{children:"\u5982\u957f\u65f6\u95f4\u65e0\u6cd5\u89e3\u51b3\u8bf7\u8054\u7cfb\u6211\u4eec"})]}),(0,rn.jsx)(en.View,{className:"loading_btn_box",children:(0,rn.jsx)(en.View,{className:"loading_btn",onClick:function(){o.hideError(),o.showSkeleton(),ti.isEmpty(n)?o[i](r):o[i](r,n)},children:"\u518d\u8bd5\u4e00\u6b21"})})]})]})})},ii=ni,ri=n(12167),oi=(0,Jt.memo)((function(e){var t=Nt.useState(),n=t.slts,i=Nt.useActions(),r=i.onSelectQuick,o=e.filterTypes,a=e.quickFilters;return(0,rn.jsx)(en.View,{id:"HotelListFilter",children:(0,rn.jsx)(ri.FilterBar,{tabList:o,slts:n,quickFilters:a,onQuickFilter:r})})})),ai=oi,si=k._,li=k.classnames,ci=Jt.memo((function(e){var t=e.show,n=e.info,i=e.hideFunc,r=e.isAbroad,o=n,a=o.price,s=o.totalDiscount,l=o.discountDetailList,c=o.tagLevel,u=void 0===c?[]:c,d=o.displayUnit,h={name:"",tagPrice:a+s},p=si.concat([],h,u,l);return t?(0,rn.jsx)(ri.PopUp,{title:"\u9152\u5e97\u4ef7\u683c\u53ca\u4f18\u60e0\u8bf4\u660e",height:"short",handleClose:i,children:(0,rn.jsxs)(en.View,{className:"hotel_price_popup",children:[(0,rn.jsx)(en.View,{className:"hotel_price_account",children:p.map((function(e,t){return(0,rn.jsxs)(en.View,{className:"li",children:[(0,rn.jsx)(en.View,{className:li({flex_1:!0,f_member:"gold"===e.className}),children:e.name}),(0,rn.jsxs)(en.Text,{className:li({oth:!0,oth_through:0===t}),children:[(0,rn.jsxs)(en.Text,{className:li({dp_f15:!0,s_label_org:0!==t}),children:[0!==t?"-":"","\xa5",e.tagPrice]}),d]})]},"tag-".concat(t))}))}),(0,rn.jsxs)(en.View,{className:"hotel_price_pay",children:[(0,rn.jsxs)(en.View,{className:"oth",children:[(0,rn.jsxs)(en.Text,{className:"s_label_org",children:["\u5747",(0,rn.jsxs)(en.Text,{className:"dp_f18",children:["\xa5",a]})]}),d]}),r?(0,rn.jsx)(en.Text,{className:"oth",children:"\u542b\u7a0e\u4ef7"}):null]})]})}):null})),ui=ci,di=n(33675),hi=n.n(di),pi=n(21832),fi=n(39680),vi="#FFFFFF",mi=function(e){var t=e.title,n=e.subTitle,i=e.bgColor,r=e.handleBack,o=e.zIndex;console.log(n,"subTitle");var a=pi.y.navBarHeight,s=pi.y.statusBarHeight;(0,Jt.useEffect)((function(){nn().setNavigationBarColor({frontColor:"#000000",backgroundColor:""})}),[]);var l=o?{zIndex:o}:{};return(0,rn.jsxs)(rn.Fragment,{children:[(0,rn.jsxs)(en.View,{style:(0,c.Z)((0,c.Z)({},fi.W.navBar),{},{height:a,backgroundColor:i||vi},l),children:[(0,rn.jsx)(en.View,{style:{height:s}}),(0,rn.jsxs)(en.View,{style:fi.W.barWrap,children:[(0,rn.jsx)(en.View,{style:(0,c.Z)((0,c.Z)({},fi.W.iconBack),fi.W.iconBackDark),onClick:function(){return r?r():hi().navigateBack()},"data-testid":"diy-414093-top-back",children:"\ue1a9"}),(0,rn.jsxs)(en.View,{style:fi.W.titleWrap,children:[(0,rn.jsx)(en.Text,{style:fi.W.titleText,children:t}),!!n&&(0,rn.jsx)(en.Text,{style:fi.W.subTitleText,children:n})]})]})]}),(0,rn.jsx)(en.View,{style:{height:a}})]})},yi=Jt.memo(mi),gi=k._,wi=function(e){(0,p.Z)(n,e);var t=(0,f.Z)(n);function n(e){var i;return(0,u.Z)(this,n),i=t.call(this,e),(0,v.Z)((0,h.Z)(i),"inputRef",void 0),(0,v.Z)((0,h.Z)(i),"timer",void 0),(0,v.Z)((0,h.Z)(i),"headerTimer",void 0),(0,v.Z)((0,h.Z)(i),"response",void 0),(0,v.Z)((0,h.Z)(i),"getSearchHeader",(function(){i.headerTimer=setTimeout((function(){var e=nn().createSelectorQuery();e.select("#HotelListSearchHeader").boundingClientRect().exec((function(e){var t,n=null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.height;n>0&&i.setState({searchContentHeight:i.props.windowHeight-pi.y.navBarHeight-n})}))}),200)})),(0,v.Z)((0,h.Z)(i),"handleChangeInput",(function(e){i.setState({keyword:e.detail.value,searching:!!e.detail.value})})),(0,v.Z)((0,h.Z)(i),"handleClearInput",(function(){i.setState({keyword:"",hotelList:[],searching:!1})})),(0,v.Z)((0,h.Z)(i),"handleClickSearch",(function(){var e={keyword:i.state.keyword,filter:{}};i.props.callback(e),i.props.back()})),(0,v.Z)((0,h.Z)(i),"handlePressSearch",(function(){i.props.handleSearchKeyWord(i.state.keyword)})),(0,v.Z)((0,h.Z)(i),"handleClickList",(function(e){i.props.callback(e),i.props.back()})),(0,v.Z)((0,h.Z)(i),"handleClickHistoryList",(function(e){var t=i.props.cityID;if(t&&t!=e.cityId){var n={currentTarget:{value:e.word}};i.setState({keyword:e.word}),i.handleFocusInput(n)}else i.handleClickList(e)})),(0,v.Z)((0,h.Z)(i),"handleFocusInput",(function(e){i.state.isFirstRender&&""!==e.currentTarget.value&&(i.setState({searching:!0}),i.getHotelListAndSetState())})),(0,v.Z)((0,h.Z)(i),"handleClickHistory",(function(e){var t=e.currentTarget.innerText;i.props.callback({keyword:t.replace(/^\s+|\s+$/,""),filter:{}}),i.props.back()})),(0,v.Z)((0,h.Z)(i),"getHistoryTitle",(function(e){return(0,rn.jsxs)(rn.Fragment,{children:[(0,rn.jsx)(en.View,{className:"left_icon icon_search_history"}),(0,rn.jsx)(en.View,{className:"main_cont",children:(0,rn.jsxs)(en.View,{className:"text_tips",children:[" ",e," "]})})]})})),i.state={keyword:e.keyword||"",searching:!1,historyList:[],hotelList:[],isFirstRender:!0,showRetry:!1,searchContentHeight:i.props.windowHeight},i.getHistory(),i}return(0,d.Z)(n,[{key:"getHistory",value:function(){var e=(0,x.Z)((0,S.Z)().mark((function e(){return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,this.props.getSearchHistory();case 3:if(e.t1=e.sent,e.t1){e.next=6;break}e.t1=[];case 6:e.t2=e.t1,e.t3={historyList:e.t2},e.t0.setState.call(e.t0,e.t3);case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"componentDidMount",value:function(){this.getSearchHeader(),this.inputRef.focus()}},{key:"componentWillMount",value:function(){this.headerTimer&&clearTimeout(this.headerTimer)}},{key:"componentDidUpdate",value:function(e,t){var n=this;this.state.isFirstRender&&this.setState({isFirstRender:!1}),!t.isFirstRender&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.keyword!==n.state.keyword&&""!==n.state.keyword&&n.getHotelListAndSetState()}),400)}},{key:"render",value:function(){var e=this;return(0,rn.jsxs)(en.View,{"data-testid":"hotelList-search",children:[(0,rn.jsx)(yi,{title:"\u9009\u62e9\u9152\u5e97",handleBack:this.props.back}),(0,rn.jsxs)(en.View,{id:"HotelListSearchHeader",className:"search_box fixed_top",children:[(0,rn.jsxs)(en.View,{className:"search_content flexbox",children:[(0,rn.jsx)(en.View,{className:"iconfont icon_search"}),(0,rn.jsx)(en.View,{className:"search_input_mod flex_1",children:(0,rn.jsxs)(en.Form,{children:[(0,rn.jsx)(en.Input,{"data-testid":"hotelList-search-textInput",className:"search_city_input",ref:function(t){return e.inputRef=t},placeholder:"\u8bf7\u8f93\u5165\u9152\u5e97\u5173\u952e\u5b57",value:this.state.keyword,onInput:function(t){e.handleChangeInput(t)},onConfirm:function(){e.handlePressSearch()},onFocus:function(t){e.handleFocusInput(t)}}),this.state.keyword&&(0,rn.jsx)(en.Text,{"data-testid":"clear-input",className:"clear-input icon_clear",onClick:this.handleClearInput})]})})]}),(0,rn.jsx)(en.View,{className:"search_cancel",onClick:this.props.back,children:"\u53d6\u6d88"})]}),(0,rn.jsx)(en.ScrollView,{scrollY:!0,className:"content_box",style:{height:this.state.searchContentHeight},children:this.state.isFirstRender||""===this.state.keyword?(0,rn.jsxs)(en.View,{className:"associational_content",children:[this.state.historyList.length>0&&(0,rn.jsx)(en.View,{className:"text_list associational_list_b",children:this.state.historyList.map((function(t,n){return"string"===typeof t?(0,rn.jsx)(en.View,{onClick:function(t){e.handleClickHistory(t)},className:"associational_type",children:e.getHistoryTitle(t)},n):e.getHistoryItem(t,n)}))}),this.state.historyList.length>0&&(0,rn.jsx)(en.View,{className:"search_clear",onClick:function(){e.props.clearHistory(),e.setState({historyList:[]})},children:"\u6e05\u9664\u5386\u53f2\u8bb0\u5f55"}),0==this.state.historyList.length&&(0,rn.jsx)(en.View,{className:"no_more",children:"\u6ca1\u6709\u5386\u53f2\u8bb0\u5f55"})]}):(0,rn.jsxs)(en.View,{className:"associational_content","data-testid":"hotelList-search-FlatList",children:[this.state.searching&&(0,rn.jsx)(jn,{className:"i_loading",text:"\u641c\u7d22\u4e2d...",clickFunc:function(e){return e}}),!this.state.searching&&this.state.hotelList.length>0&&(0,rn.jsx)(en.View,{className:"text_list associational_list associational_list_b",children:this.state.hotelList.map((function(t,n){return(0,rn.jsx)(Si,{info:t,liKey:n,handleClickList:e.handleClickList,getStringWord:e.props.getStringWord},n)}))}),!this.state.searching&&0===this.state.hotelList.length&&!this.state.showRetry&&(0,rn.jsx)(en.View,{className:"no_more",children:"\u65e0\u641c\u7d22\u7ed3\u679c"}),!this.state.searching&&this.state.showRetry&&(0,rn.jsx)(jn,{className:"i_failed",text:"\u91cd\u65b0\u52a0\u8f7d",clickFunc:function(){return e.getHotelListAndSetState()}})]})})]})}},{key:"getDefaultItem",value:function(e,t,n,i,r){var o=this;return(0,rn.jsxs)(en.View,{className:"associational_type",onClick:function(){o.handleClickList(e)},id:"dp2-".concat("pageId","-search-associate-",e.word,"-").concat(ie.n_[i]),children:[(0,rn.jsxs)(en.Text,{children:[" ",t," "]}),"Markland"!==i&&"IntlPOILandmark"!==i&&"Hotel"!==i&&"RailwayStation"!==i&&"Airport"!==i&&"IntlAirport"!==i||""===n?null:(0,rn.jsx)(en.Text,{className:"text_tips",children:n}),(0,rn.jsx)(en.Text,{className:"type_text",children:ie.n_[i]})]},r)}},{key:"getHistoryItem",value:function(e,t){var n=this,i=e.word,r=void 0===i?"":i;return(0,rn.jsx)(en.View,{className:"associational_type",onClick:function(){n.handleClickHistoryList(e)},children:this.getHistoryTitle(r)},t)}},{key:"getHotelListAndSetState",value:function(){var e=(0,x.Z)((0,S.Z)().mark((function e(){var t;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.fetchHotelList();case 3:t=e.sent,gi.isEmpty(t)?this.setState({hotelList:[],showRetry:!1,searching:!1}):t.length>0&&this.setState({hotelList:t,showRetry:!1,searching:!1}),e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](0),console.log(e.t0),this.setState({hotelList:[],showRetry:!0,searching:!1});case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"fetchHotelList",value:function(){var e=(0,x.Z)((0,S.Z)().mark((function e(){var t,n,i,r;return(0,S.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props,n=t.getSearchParams,i=t.fetchSearchKeyword,r=n(this.state.keyword),e.next=4,i(r);case 4:return this.response=e.sent,e.abrupt("return",this.response);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(Jt.Component),Si=function(e){var t=e.info,n=e.liKey,i=e.handleClickList,r=e.getStringWord,o=t.type,a=t.subTitle,s=t.word,l=t.ename,c=Nt.useState((function(e){return{isabroad:e.urlQuery.isabroad,ishmt:e.urlQuery.ishmt}})),u=c.isabroad,d=c.ishmt,h=u||d;return(0,rn.jsxs)(en.View,{className:"associational_type",onClick:function(){i(t)},id:"dp2-".concat("pageId","-search-associate-",r(t.word),"-").concat(ie.n_[o]),children:["Hotel"===o?(0,rn.jsx)(en.View,{className:"left_icon icon_hotel_sign"}):(0,rn.jsx)(en.View,{className:"left_icon icon_search_sign"}),(0,rn.jsxs)(en.View,{className:"main_cont",children:[(0,rn.jsx)(xi,{pClass:"main_name",name:s}),h&&l?(0,rn.jsx)(xi,{pClass:"text_tips",name:l}):null,a?(0,rn.jsx)(en.View,{className:"text_tips",children:a}):null]}),(0,rn.jsx)(en.View,{className:"type_text",children:ie.n_[o]})]},n)},xi=function(e){var t=e.name,n=e.pClass,i=t.matchArray,r=void 0===i?[]:i,o=t.unMatchArray,a=void 0===o?[]:o,s=r.length>a.length?r:a;return(0,rn.jsx)(en.View,{className:n,children:gi.map(s,(function(e,t){var n=a[t]||"",i=r[t]||"";return(0,rn.jsxs)(Jt.Fragment,{children:[n,i?(0,rn.jsx)(en.Text,{className:"f_ctrip",children:i}):null]},t+n)}))})},Zi=k._,ki=Nt.useState,bi=Nt.useActions,Pi=function(e){var t=e.pageId;return(0,rn.jsxs)(en.View,{id:"HotelListHeader",children:[(0,rn.jsx)(yi,{title:"\u9009\u62e9\u9152\u5e97",zIndex:1003}),Li(t)]})},Li=function(e){var t=ki(),n=t.date,i=t.searchKeyWord,r=bi(),o=r.handleGotoSearch,a=r.handleSearchKeyWord,s=["\u4f4f","\u79bb"];return(0,rn.jsx)(en.View,{id:"headerview",className:"htl_header",children:(0,rn.jsx)(en.View,{className:"header header_white",children:(0,rn.jsxs)(en.View,{id:"diy-".concat(e,"-top-box"),className:"dp_header_top",children:[null!==n&&void 0!==n&&n.length?(0,rn.jsx)(en.View,{className:"dp_header_day",children:Zi.map(n,(function(e,t){return(0,rn.jsxs)(en.Text,{className:"span",children:[s[t],(0,rn.jsx)(en.Text,{className:"s",children:e})]},t)}))}):null,(0,rn.jsxs)(en.View,{onClick:function(){return o(!0)},className:"dp_header_search","data-testid":"hotelList-searchBox",children:[(0,rn.jsx)(en.View,{className:"i icon_base icon_search"}),(0,rn.jsx)(en.View,{className:"search_text",children:i||"\u9152\u5e97/\u5730\u540d/\u5173\u952e\u8bcd"}),i?(0,rn.jsx)(en.View,{className:"icon_base icon_clear",onClick:function(e){e.stopPropagation(),a("")}}):null]})]})})})},Ti=Pi,Ii=(k._,function(){var e=nn().getSystemInfoSync().windowHeight,t=Nt.useState((function(e){return{showPricePop:e.showPricePop,popInfo:e.popInfo,urlQuery:e.urlQuery,errorInfo:e.errorInfo,curFilter:e.curFilter,skeletonInfo:e.skeletonInfo,searchStatus:e.searchStatus,pageStatus:e.pageStatus,bottomInfo:e.bottomInfo,hotelList:e.hotelList,recList:e.recList,filterTypes:e.filterTypes,searchKeyWord:e.searchKeyWord,quickFilters:e.quickFilters}})),n=t.showPricePop,i=t.popInfo,r=void 0===i?{}:i,o=t.urlQuery,a=void 0===o?{}:o,s=t.errorInfo,l=void 0===s?{}:s,c=t.skeletonInfo,u=void 0===c?{}:c,d=t.searchStatus,h=t.pageStatus,p=void 0===h?{}:h,f=(t.bottomInfo,t.hotelList,t.recList,t.filterTypes),v=t.searchKeyWord,m=t.quickFilters,y=(0,Fn.B)(),g=y.pageId,w=Nt.useActions(),S=w.initProcess,x=w.handleHideDiscount,Z=(w.pullNext,w.fetchSearchKeyword),k=w.handleClickKeyWord,b=w.getStringWord,P=w.getSearchParams,L=w.getSearchHistory,T=w.handleSearchKeyWord,I=w.clearSearchHistory,N=w.handleGotoSearch,F=w.updatePositionInfo;(0,Jt.useEffect)((function(){S()}),[]);var _=l.showError,C=void 0!==_&&_,j=l.callBack,H=u.showSkeleton,V=u.needTop,D=p.showHotelEmpty,B=p.initDone;return(0,Jt.useEffect)((function(){if(B){var e=setTimeout((function(){var e=nn().createSelectorQuery();e.select("#HotelListHeader").boundingClientRect(),e.select("#HotelListFilter").boundingClientRect(),e.exec((function(e){var t,n,i=null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.height,r=null===e||void 0===e||null===(n=e[1])||void 0===n?void 0:n.height,o=i+r-4;i>0&&r>0&&F({top:o,positionInfo:{headerHeight:i,filterHeight:r}})}))}),200);return function(){return clearTimeout(e)}}}),[B]),(0,rn.jsxs)(en.View,{id:"HotelList",children:[d?null:(0,rn.jsx)(Ti,{pageId:g}),(0,rn.jsx)(en.View,{className:"container",children:C?(0,rn.jsx)(ii,{callBack:j}):d?(0,rn.jsx)(wi,{windowHeight:e,keyword:v,fetchSearchKeyword:Z,callback:k,getStringWord:b,getSearchParams:P,getSearchHistory:L,handleSearchKeyWord:T,clearHistory:function(){return I()},cityID:null===a||void 0===a?void 0:a.cityid,back:function(){return N(!1)}}):(0,rn.jsxs)(rn.Fragment,{children:[V||D?null:(0,rn.jsx)(rn.Fragment,{children:(0,rn.jsx)(ai,{filterTypes:f,quickFilters:m})}),(0,rn.jsxs)(en.View,{children:[H?(0,rn.jsx)(hn,{needTop:V}):(0,rn.jsx)(ei,{}),(0,rn.jsx)(ui,{show:n,hideFunc:x,info:r,isAbroad:a.isabroad})]})]})})]})}),Ni=Ii,Fi=n(4309),_i=k.PureModel,Ci=k.MODEL_CONTEXT,ji=(vn=_i({hotelListModel:Nt,BaseModel:Wt}),vn(mn=function(e){(0,p.Z)(n,e);var t=(0,f.Z)(n);function n(e){var i;return(0,u.Z)(this,n),i=t.call(this,e),(0,v.Z)((0,h.Z)(i),"pageId",415093),(0,v.Z)((0,h.Z)(i),Ci,(0,c.Z)((0,c.Z)((0,c.Z)({},i[Ci]),G.G1.impl({SharkUtil:Xt.ZP})),U.Iy.impl({storage:new Yt("HOTEL_LIST")}))),i.state={hideHeader:!0},i}return(0,d.Z)(n,[{key:"render",value:function(){return(0,rn.jsx)(Fi.Z.Provider,{value:this,children:(0,rn.jsx)(Ni,{})})}}]),n}(Kt.Z))||mn),Hi={navigationStyle:"custom",backgroundColor:"#eeeeee",backgroundTextStyle:"light",disableScroll:!0};Page((0,l.createPageConfig)(ji,"pages/shoppingcarthotel/hotel/hotelList/index",{root:{cn:[]}},Hi||{}))},79181:function(e){e.exports=require("../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../cwx/ext/global")},33675:function(e){e.exports=require("../../../../cwx/cwx")},46346:function(e){e.exports=require("../../../../cwx/ext/global")}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[7420,2107,1216,8592],(function(){return t(84699)}));e.O()}]);
//# sourceMappingURL=index.js.map