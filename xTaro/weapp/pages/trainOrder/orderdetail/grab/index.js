/*! For license information please see index.js.LICENSE.txt */
"use strict";require("../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[8393],{66551:function(e,t,n){var r=n(32180),a=n(79301),s=n(95308),i=n(298),c=n(57042),o=n(24460),l=n(21867),u=n(86066),d=n(90201),p=n(56884),h=n.n(p),m=n(92954),f=n.n(m),x=n(71515),v=n(65542),g=n(61981),b=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,g.Gl)({ConfigKey:"train_wx_webview_share_new_config"});case 2:if(t=e.sent,n=t.configInfo,!n||!n.content){e.next=6;break}return e.abrupt("return",JSON.parse(n.content));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=["onShareAppMessage"],j=function(){},N=null;b().then((function(e){N=e}));var I=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(e){var r;return(0,c.Z)(this,n),r=t.call(this,e),r.wrapEventHandler(),r}return(0,o.Z)(n,[{key:"wrapEventHandler",value:function(){var e=this;w.forEach((function(t){if("function"===typeof e[t]){var n=e[t]||j,r=function(r){var a=n.call(e,r),s=e["__".concat(t)].call(e,r,a);return console.log("\u8fd9\u91cc\u662f shareBase \u5904\u7406\u540e\u7684\u6570\u636e",s),s};e[t]=r.bind(e)}}))}},{key:"__onShareAppMessage",value:function(e,t){console.log("shareBase\u7684\u539f\u59cb\u5206\u4eab\u6570\u636e",e,t);var n=new Promise((function(e,n){var r=function(e){var t=e.path,n=t;return N.forEach((function(e){var r=new RegExp("^".concat(e.originalPath));r.test(t)&&(n="".concat(e.targetPath,"?url=").concat(encodeURIComponent(t)))})),console.log("shareBase\u7684\u6700\u7ec8\u5206\u4eab\u6570\u636e",(0,i.Z)((0,i.Z)({},e),{},{path:n})),(0,i.Z)((0,i.Z)({},e),{},{path:n})},a=function(t){b().then((function(n){N=n,e(r(t))})).catch(n)};t.pormise?t.promise.then((function(e){return a(e)})).catch(n):a(t)}));return(0,i.Z)((0,i.Z)({},t),{},{promise:n})}}]),n}(v.Z),V=I,k=n(12033),y=d.createContext(null),T=n(67),Z=n(99263),S=n(82566),C=n(90129),P=n(94262),L=n(2269),_=function(){},D=function(e){var t=e.setShowGuideBox,n=void 0===t?_:t,r=e.singleToDouble,i=void 0===r?_:r,c=(0,d.useContext)(y),o=c.orderStates,l=o.orderInfo,u=l.orderId,p=T.WG.getAttr("bind12306")||[],m=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r,s,c,o,u,d,p;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"activateMemberClick",clickType:1}),e.next=3,(0,k.L5)({from:"orderdetail",push:3,isAutoLogin:!0,traceFrom:"guideToActive"});case 3:t=e.sent,n=(0,C.Z)(t,1),r=n[0],s=r.userName,c=void 0===s?"":s,o=r.loginPW,u=void 0===o?"":o,d=r.activateSuccess,p=void 0!==d&&d,p&&i(),(0,k.rP)(c,u,-1,l);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"activateMemberClick",clickType:2}),h().setStorageSync("accountJumpActive",u+"&"+p.name),n(!1)};return(0,L.jsxs)(x.View,{className:"guide-active-box",children:[k.ZP.ubtTrace("s_trn_c_trace_10650072279",{exposureType:"normal",bizKey:"activateMember"}),(0,L.jsxs)(x.View,{className:"top-status",children:[(0,L.jsx)(x.Image,{className:"tips",src:"https://images3.c-ctrip.com/train/2022/app/8.51/qiangpiao/jihuo12306/gth.png"}),(0,L.jsx)(x.Text,{className:"tit",children:"\u514d\u8d39\u6fc0\u6d3b12306\u4f1a\u5458"})]}),(0,L.jsx)(x.View,{className:"btm-active-outer-box",children:(0,L.jsxs)(x.View,{className:"btm-active-box",children:[(0,L.jsx)(x.Image,{className:"tips",src:"https://images3.c-ctrip.com/train/2022/app/8.51/qiangpiao/jihuo12306/img-jihuo12306@3x.png"}),(0,L.jsx)(x.Text,{className:"txt",children:"\u6fc0\u6d3b12306\u4f1a\u5458\uff0c\u63d0\u9ad8\u62a2\u7968\u6210\u529f\u7387"}),(0,L.jsx)(x.Text,{className:"txt2",children:"\u6fc0\u6d3b\u540e\u5373\u53ef\u5f00\u542f\u53cc\u901a\u9053\u62a2\u7968\uff0c\u4eab\u66f4\u9ad8\u6210\u529f\u7387"}),(0,L.jsx)(x.View,{className:"active-btn",onClick:m,children:(0,L.jsx)(x.Text,{className:"btn-txt",children:"\u7acb\u5373\u6fc0\u6d3b"})}),(0,L.jsxs)(x.Text,{className:"jump",onClick:f,children:["\u6682\u4e0d\u6fc0\u6d3b\uff0c\u70b9\u51fb\u8df3\u8fc7",(0,L.jsx)(x.Text,{className:"ifont-arr"})]})]})})]})},F=D,O=n(88381),A=n.n(O),R=A().dayjs,B=function(){},M=function(e){var t=e.showActivationPop,n=void 0===t?B:t,r=e.orderSerial,a=e.showWeakGuide,s=(0,d.useContext)(y),i=s.orderStates,c=s.updateOrder,o=i.orderInfo,l=o.hbInfo,u=void 0===l?{}:l,p=o.jLDetailInfo,h=o.orderStatusBarInfo,m=(0,d.useRef)(0),f=(0,d.useRef)(null),v=(0,d.useState)(""),g=(0,C.Z)(v,2),b=g[0],w=g[1];(0,d.useEffect)((function(){var e="N"===p.jLOrderStatus,t=(0,k.Pm)(p.jLBeginDateTime);"O"!==p.jLOrderStatus&&"L"!==p.jLOrderStatus||R(t).isAfter(R())&&(e=!0),e&&(m.current=parseInt(R(t).diff(R())/1e3),m.current>0&&m.current<86400&&N())}),[p]);var j=function(){return(0,L.jsxs)(L.Fragment,{children:[o.isUseVipGrabRight&&o.isNeedActivateVipRights&&(0,L.jsxs)(x.View,{class:"tag tag-vip",onClick:function(){return n()},children:["VIP\u62a2\u7968\u5f85\u6fc0\u6d3b",(0,L.jsx)(x.View,{class:"ifont-arr"})]}),2===u.state&&(0,L.jsx)(x.View,{class:"tag",children:"\u53cc\u901a\u9053\u62a2\u7968"})]})};function N(){function e(){m.current>0?(m.current=m.current-1,I()):(clearInterval(f.current),c())}I(),f.current&&clearInterval(f.current),f.current=setInterval(e,1e3)}function I(){if(m.current>0){var e=Math.floor(m.current%60),t=Math.floor(m.current/60),n=Math.floor(t/60);return n=n%24>0?n%24<10?"0"+n%24:n%24:"00",t=t%60>0?t%60<10?"0"+t%60:t%60:"00",e=e>0?e<10?"0"+e:e:"00",w("".concat(n,"\u65f6").concat(t,"\u5206").concat(e,"\u79d2\u540e\u5f00\u552e"))}w("")}function V(){return 1!==r?(0,L.jsx)(x.View,{class:"tit",children:"\u6b63\u5728\u62a2\u7968\u4e2d"}):(0,L.jsxs)(L.Fragment,{children:[h.statusName&&(0,L.jsxs)(x.View,{class:"tit",children:[h.statusName,(0,L.jsx)(j,{})]}),b?(0,L.jsx)(x.View,{class:"txt",children:b}):h.statusNameDesc&&(0,L.jsx)(x.View,{class:"txt",children:h.statusNameDesc})]})}return(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)(x.View,{className:"top-status",children:[(0,L.jsx)(x.View,{className:"lbox",children:"N"===(null===p||void 0===p?void 0:p.jLOrderStatus)?(0,L.jsx)(x.Icon,{className:"icon-status-wait"}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(x.Icon,{className:"icon-status-light"}),(0,L.jsx)(x.Icon,{className:"icon-status-loading"}),a&&(0,L.jsx)("image",{className:"warn",src:"https://images3.c-ctrip.com/train/2022/app/8.58/qiangpiao/ruoyingdao/icon_jingshi@3x.png"})]})}),(0,L.jsx)(x.View,{className:"cont",children:V()})]})})},G=M,U=function(e){(0,P.Z)(e);var t=(0,d.useContext)(y),n=t.orderStates,r=n.orderInfo,a=r.topVerifyInfo,s=function(){h().navigateTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(a.jumpUrl))})};return(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)(x.View,{class:"white-box order-notice-white order-heyan",children:[(0,L.jsx)(x.Icon,{class:"icon-ball"}),(0,L.jsx)(x.View,{class:"cont",children:(0,L.jsx)(x.RichText,{nodes:a.message})}),(0,L.jsx)(x.Button,{class:"btn-heyan",onClick:s,"data-ubt-key":"c_train_wx_orderdetail_mobilecheckbtn_pop",children:a.buttonName})]})})},z=U,E=function(){},K=function(e){var t=e.onClose,n=void 0===t?E:t,r=e.nearByPopDetail,i=e.grabTrain,c=(0,d.useContext)(y),o=c.orderStates,l=c.updateOrder,u=o.orderInfo,p=u.orderId,h=u.ticketInfos,m=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,s,c;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=h[0],s={ChangeType:12,IsAcceptRecTrainJL:!0,OriginalOrderId:p,JLRecommodNearTrainInfo:{JLRecommodNearTrainTimeLine:r.timeLine,MaxTicketPrice:i.price,EarliestDepartTime:t.departTime,LatestDepartTime:t.departTime,MaxRunTime:i.runTime,RecommendNearType:1}},k.ZP.showLoading(),e.prev=3,e.next=6,(0,g.PH)(s);case 6:c=e.sent,0===c.result?(n(),l(),k.ZP.showToast("\u5f00\u542f\u6210\u529f\uff01","none")):k.ZP.showToast(c.resultMessage||"\u8bf7\u7a0d\u540e\u91cd\u8bd5","none"),e.next=13;break;case 10:throw e.prev=10,e.t0=e["catch"](3),e.t0;case 13:return e.prev=13,k.ZP.hideLoading(),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[3,10,13,16]])})));return function(){return e.apply(this,arguments)}}();return(0,L.jsx)(x.View,{class:"ticket-change-pop-wrapper",id:"pop-wrapper",children:(0,L.jsxs)(x.View,{class:"ticket-change-pop-container",children:[(0,L.jsx)(x.View,{class:"ticket-change-pop-background"}),(0,L.jsxs)(x.View,{style:"padding: 0 40rpx",children:[(0,L.jsx)(x.View,{class:"ticket-change-pop-title",children:"\u5efa\u8bae\u540c\u65f6\u62a2\u4ee5\u4e0b\u65f6\u6bb5\u8f66\u6b21"}),(0,L.jsxs)(x.View,{class:"ticket-change-pop-timeline",children:[(0,L.jsx)(x.Text,{class:"timeline",children:r.timeLine}),(0,L.jsx)(x.Text,{children:"\u51fa\u53d1"})]}),(0,L.jsx)(x.View,{class:"ticket-change-pop-desc",children:r.desc}),(0,L.jsxs)(x.View,{class:"ticket-change-pop-detail",children:[(0,L.jsx)(x.Text,{class:"li",children:"\u540c\u65f6\u62a2\u8be5\u65f6\u6bb5\u5185\u52a0\u5f00\u7684\u8f66\u6b21"}),(0,L.jsx)(x.Text,{class:"li",children:"\u884c\u7a0b\u8017\u65f6\u4e0d\u9ad8\u4e8e\u6240\u9009\u8f66\u6b21\u768440%"}),(0,L.jsx)(x.Text,{class:"li",children:"\u4ef7\u683c\u4e0d\u9ad8\u4e8e\u62a2\u7968\u8ba2\u5355\u91d1\u989d"})]}),(0,L.jsx)(x.Button,{class:"ticket-change-pop-button",onClick:m,children:"\u7acb\u5373\u5f00\u542f"})]}),(0,L.jsx)(x.Text,{class:"ifont-closed",onClick:n})]})})},H=K,q=function(){},W=function(e){var t=e.onClose,n=void 0===t?q:t,r=(0,d.useContext)(y),a=r.orderStates,s=a.orderInfo,i=s.orderId;return(0,L.jsxs)(x.View,{class:"quit-confirm-pop-container",children:[(0,L.jsx)(x.Icon,{class:"ifont-closed-line close-btn",onClick:n}),(0,L.jsx)(x.View,{class:"quit-confirm-pop-title",children:"\u5750\u5e2d\u5df2\u53d6\u6d88"}),(0,L.jsx)(x.View,{class:"quit-confirm-pop-content",children:"\u7ee7\u7eed\u4e3a\u60a8\u62a2\u539f\u8f66\u6b21\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\u7ed3\u679c"}),(0,L.jsxs)(x.View,{class:"quit-confirm-pop-tip",children:[(0,L.jsx)(x.Icon,{class:"icon-pop-tishi"}),(0,L.jsxs)(x.View,{class:"tips-right",children:[(0,L.jsx)(x.View,{class:"head",children:"\u5efa\u8bae\u6dfb\u52a0\u66f4\u591a\u62a2\u7968\u65b9\u6848"}),(0,L.jsx)(x.View,{class:"body",children:"\u5f53\u524d\u8f66\u6b21\u653e\u7968\u6781\u5c11\uff0c\u6dfb\u52a0\u5176\u4ed6\u8f66\u6b21\u3001\u5ea7\u5e2d\u65e5\u671f\uff0c\u53ef\u4ee5\u63d0\u5347\u62a2\u7968\u6210\u529f\u7387"})]})]}),(0,L.jsx)(x.Button,{class:"quit-confirm-pop-btn",onClick:function(){n(),(0,k._E)(i)},children:"\u6dfb\u52a0\u62a2\u7968\u65b9\u6848"}),(0,L.jsx)(x.View,{class:"quit-confirm-pop-background"})]})},Y=W,J=n(22276),Q=Z.Z.maxOtherAmount,X=(0,k.Rq)(),$=function(){},ee=function(e){var t=e.grabTrain,n=e.recommendFloatingLayerInfo,r=e.recommendTrainList,c=e.otherTrainsSeatsArr,o=e.changeOrderPay,l=void 0===o?$:o,u=e.onClose,p=void 0===u?$:u,h=(0,d.useContext)(y),m=h.orderStates,f=h.updateOrder,v=m.orderInfo,b=v.ticketInfos,w=void 0===b?[]:b,j=v.orderId,N=v.jLDetailInfo,I=(null===w||void 0===w?void 0:w[0])||{},V=I.passengerInfos,T=void 0===V?[]:V,Z=I.ticketPrice,S=I.seatName,P=(0,d.useState)(!1),_=(0,C.Z)(P,2),D=_[0],F=_[1],O=(0,d.useState)(0),A=(0,C.Z)(O,2),R=A[0],B=A[1],M=(0,d.useState)(r),G=(0,C.Z)(M,2),U=G[0],z=G[1],E=(0,d.useState)(c),K=(0,C.Z)(E,2),H=K[0],q=K[1];(0,d.useEffect)((function(){z(r)}),[r]),(0,d.useEffect)((function(){q(c)}),[c]);var W=function(e){var t=(0,J.Z)(U),n=t[e];if(n.current=!n.current,t.filter((function(e){return e.current})).length>Q)return k.ZP.showToast("\u6700\u591a\u9009\u62e9".concat(Q,"\u4e2a"),"none");n.Tag&&k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"multipleChoiceActionbarClick",tag:n.Tag,location:1}),z(t),te(t,H)},Y=function(e){var t=(0,J.Z)(H),n=t[e];n.selected=!n.selected,q(t),te(U,t)},ee=function(){var e=U.filter((function(e){return e.current})).length,t=U.map((function(t){return D?(0,i.Z)((0,i.Z)({},t),{},{current:!1}):e>=Q?(0,i.Z)({},t):(e+=1,(0,i.Z)((0,i.Z)({},t),{},{current:!0}))}));z(t),F(!D),te(t,H)},te=function(e,n){var r=T.length,a=n.filter((function(e){return e.selected})).map((function(e){return e.seatName})),s=[S].concat((0,J.Z)(a)),i=e.filter((function(e){return e.current})),c=[t].concat((0,J.Z)(i)).reduce((function(e,t){var n=t.seatList.filter((function(e){return s.includes(e.seatName)})).map((function(e){return e.seatPrice}));return[].concat((0,J.Z)(e),(0,J.Z)(n))}),[]),o=Math.max.apply(Math,(0,J.Z)(c)),l=o-Z;B(l*r),l>0&&k.ZP.ubtTrace("s_trn_c_trace_10650072279",{exposureType:"normal",bizKey:"priceDifference"}),console.log("\u6ea2\u51fa\u5dee\u4ef7",l)},ne=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var n,r,s,c,o;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=U.filter((function(e){return e.current})),r=H.filter((function(e){return e.selected})),k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"multipleChoiceActionbarSuccessClick",trainNumber:n.map((function(e){return e.trainNumber})),ticketseat:r.map((function(e){return e.seatName}))}),n.length||r.length){e.next=5;break}return e.abrupt("return",p());case 5:return s=(0,k.Ej)({OriginalOrderId:j,TrainNumbers:[].concat((0,J.Z)(n),[t]).map((function(e){return e.trainNumber})).join(","),SeatNames:[].concat((0,J.Z)(r),[{seatName:S}]).map((function(e){return e.seatName})).join(","),ChangeType:17}),s.JLAlternativeDate=(null===N||void 0===N?void 0:N.jLAlternativeDate)||"",s.JlAlternativeTripList=n.map((function(e){return{DepartStation:e.departStation,ArriveStation:e.arriveStation,TrainNumber:e.trainNumber}})),k.ZP.ubtDevTrace("train_tinyapp_dev_log",{bizKey:"GrabRecommend_pop_confirm",value:s}),k.ZP.showLoading(),e.next=12,(0,g.PH)(s);case 12:if(c=e.sent,k.ZP.hideLoading(),p(),0===c.result){e.next=17;break}return e.abrupt("return",k.ZP.showModal({m:c.resultMessage}));case 17:if(o=0===c.changeOrderAmount||c.isFastPay||c.freeFlag,!o){e.next=22;break}return k.ZP.showModal({m:"\u6dfb\u52a0\u6210\u529f"}),f(j),e.abrupt("return");case 22:l((0,i.Z)((0,i.Z)({},c),{},{redirectText:"\u6dfb\u52a0\u6210\u529f"}));case 23:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,L.jsxs)(L.Fragment,{children:[k.ZP.ubtTrace("s_trn_c_trace_10650072279",{exposureType:"Actionbar",bizKey:"multipleChoiceActionbar"}),(0,L.jsxs)(x.View,{className:"pop-qp-recomd ".concat(X?"iphone":""),children:[(0,L.jsxs)(x.View,{className:"pop-botm-hd",children:[(0,L.jsx)(x.Image,{src:n.backgroundUrl,className:"img-recomd"}),(0,L.jsxs)(x.View,{className:"cont",children:[(0,L.jsxs)(x.View,{className:"tit",children:[(0,L.jsx)(x.RichText,{nodes:n.title})," "]}),(0,L.jsxs)(x.View,{className:"txt",children:[!!n.tag&&(0,L.jsx)(x.Text,{className:"tag",children:n.tag}),(0,L.jsx)(x.RichText,{nodes:n.subTitle})]})]})]}),(0,L.jsx)(x.ScrollView,{"scroll-y":"true",className:"scroll-layer",children:(0,L.jsxs)(x.View,{className:"pop-botm-bd",children:[(0,L.jsxs)(x.View,{className:"tit-box",children:[(0,L.jsx)(x.View,{className:"tit",children:"\u63a8\u8350\u8f66\u6b21"}),(0,L.jsxs)(x.View,{onClick:ee,className:D?"sel-all cur":"sel-all",children:[D?"\u53d6\u6d88\u5168\u9009":"\u5168\u9009\u8f66\u6b21",(0,L.jsx)(x.Text,{className:"ifont-checkbox"})]})]}),(0,L.jsxs)(x.View,{className:"qp-recomd-checi",children:[U.map((function(e,t){return(0,L.jsxs)(x.View,{className:e.current?"sel-box cur":"sel-box",onClick:function(){return W(t)},children:[!!e.Tag&&(0,L.jsx)(x.View,{className:"tag",children:e.tag}),(0,L.jsxs)(x.View,{className:"from",children:[(0,L.jsx)(x.View,{className:"time",children:e.departTime}),(0,L.jsx)(x.View,{className:"station",children:e.departStation})]}),(0,L.jsxs)(x.View,{className:"checi",children:[(0,L.jsx)(x.View,{className:"txt",children:e.timesCost}),(0,L.jsxs)(x.View,{className:"txt",children:[e.trainNumber,(0,L.jsx)(x.Text,{className:"ifont-card"})]})]}),(0,L.jsxs)(x.View,{className:"to",children:[(0,L.jsxs)(x.View,{className:"time",children:[e.arriveTime,(0,L.jsx)(x.Text,{className:"small",children:e.takeDays?"+"+e.takeDays:""})]}),(0,L.jsx)(x.View,{className:"station",children:e.arriveStation})]}),(0,L.jsx)(x.View,{className:"rbox",children:(0,L.jsx)(x.Text,{className:"ifont-checkbox"})})]},t)})),H.length>0&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(x.View,{className:"tit",children:"\u63a8\u8350\u5ea7\u5e2d"}),(0,L.jsx)(x.View,{className:"qp-recomd-seat",children:H.map((function(e,t){return(0,L.jsxs)(x.View,{className:e.selected?"item cur":"item",onClick:function(){return Y(t)},children:[(0,L.jsx)(x.View,{className:"cont",children:e.seatName}),(0,L.jsx)(x.Text,{className:"ifont-checkbox"})]},t)}))})]})]})]})}),R>0&&(0,L.jsxs)(x.View,{className:"over-price-tip",children:["\u8fd8\u9700\u8865\u6b3e\uffe5",R,"\uff0c\u51fa\u7968\u65f6\u6309\u5b9e\u9645\u7968\u4ef7\u6536\u53d6\uff0c\u5269\u4f59\u7684\u8f66\u7968\u6b3e\u5c06\u9000\u56de"]}),(0,L.jsxs)(x.View,{className:"confirm-box",children:[(0,L.jsxs)(x.View,{className:"diff-price",children:["\u9700\u8865\u5dee\u4ef7",R,"\u5143"]}),(0,L.jsxs)(x.Button,{className:"btn-orange btn-confirm",onClick:ne,children:[(0,L.jsx)(x.View,{className:"btn-title",children:"\u52a0\u5165\u62a2\u7968\u65b9\u6848"}),(0,L.jsx)(x.View,{className:"btn-sub-title",children:"\u63d0\u5347\u62a2\u7968\u6210\u529f\u7387"})]})]})]})]})},te=ee,ne=function(){},re=function(e){var t,n,r,a,s,i,c=e.toScanFacePage,o=e.toBreakPage,l=e.onClose,u=void 0===l?ne:l,p=(0,d.useContext)(y),h=p.orderStates,m=h.extendValues,f=1===(null===(t=m.GrabInterrupteSpecialSmallScene)||void 0===t?void 0:t.actionCode)||5===(null===(n=m.GrabInterrupteSpecialSmallScene)||void 0===n?void 0:n.actionCode),v=f?m.GrabInterrupteSpecialSmallScene:m.GrabInterrupteV2,g=v||{},b=g.alertInfo,w=void 0===b?{}:b,j=g.actionCode;return k.ZP.ubtDevTrace("train_tinyapp_dev_log",{bizKey:"WeakGuideScan_pop_smallScene",value:f}),f?(0,L.jsxs)(x.View,{class:"pop-tupian small-scene",children:[k.ZP.ubtTrace("s_trn_c_trace_10650072279",{exposureType:"popup",bizKey:"verificationPopups",scene:(0,k.Yt)(m.GrabInterrupteSpecialSmallScene)}),(0,L.jsx)(x.View,{class:"pop-tupian-img",style:{backgroundImage:"url(".concat(w.imgUrl||"https://images3.c-ctrip.com/train/2021/app/V8.41.6/xiaochengxu/zhuliucheng/img-12306.png",")")}}),(0,L.jsx)(x.View,{class:"ifont-closed-line",onClick:u}),(0,L.jsxs)(x.View,{class:"pop-tupian-bd",children:[(0,L.jsx)(x.View,{class:"tit",children:w.title}),null===(r=w.tips)||void 0===r?void 0:r.map((function(e,t){return(0,L.jsx)(x.View,{class:"desc",children:(0,L.jsx)(x.RichText,{nodes:e})},t)})),(0,L.jsx)(x.View,{class:"btn-box",children:(0,L.jsx)(x.Button,{class:"btn-submit",onClick:function(){return o("button")},children:w.buttonName})})]})]}):(0,L.jsxs)(x.View,{class:"pop-modal-blue pop-checktips new",children:[(0,L.jsx)(x.Image,{class:"bg",src:"https://images3.c-ctrip.com/train/2021/app/V8.41.6/xiaochengxu/zhuliucheng/img-renzheng.png",mode:"widthFix"}),(0,L.jsx)(x.View,{class:"ifont-closed-line",onClick:u}),(0,L.jsxs)(x.View,{class:"cont",children:[(0,L.jsx)(x.View,{class:"tit",children:w.title}),null===(a=w.tipList)||void 0===a?void 0:a.map((function(e,t){return(0,L.jsx)(x.View,{class:"item",children:(0,L.jsx)(x.RichText,{nodes:e})},t)})),(0,L.jsx)(x.View,{class:"btn-box",children:(0,L.jsx)(x.Button,{class:"btn-submit",onClick:function(){u(),c({type:4,from:"nobreak",needcheck:1==j?"1":"0"})},style:"font-size: 34rpx;",children:1==j?"\u540c\u610f\u534f\u8bae\u5e76"+(null===(s=w.buttonList)||void 0===s?void 0:s[0]):null===(i=w.buttonList)||void 0===i?void 0:i[0]})})]})]})},ae=re,se=function(){},ie=function(e){var t=e.activationAssistedFriendList,n=void 0===t?[]:t,r=e.onClose,i=void 0===r?se:r,c=(0,d.useContext)(y),o=c.orderStates,l=c.updateOrder,u=o.orderInfo,p=u.orderId,h=u.activateVipRightsInfo,m=u.useVipGrabRightType,f=[];f.length=(null===h||void 0===h?void 0:h.freeActivateFriendsNumber)-n.length||0,f.fill("");var v=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r,s,c;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i(),t={BookSourceID:1903,Channel:"ctripwx",ServerFrom:"wx/ctrip",OrderType:"VIPTQFFJH",OrderId:p},e.next=4,(0,g.xi)(t);case 4:n=e.sent,0==n.retCode?(r=function(){l()},s=function(){},c=function(){k.ZP.showToast("\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u91cd\u65b0\u652f\u4ed8!")},(0,k.td)({oid:n.orderNumber,sbackCallback:r,ebackCallback:c,rbackCallback:s})):k.ZP.showModal({m:"\u4ed8\u6b3e\u5931\u8d25 :("});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,L.jsxs)(x.View,{class:"pop-vip-activity ".concat(4===m?"pop-kexin":5===m?"pop-xuesheng":""),children:[n.length&&null!==h&&void 0!==h&&h.freeActivateFriendsNumber?(0,L.jsxs)(x.View,{class:"tit",children:["\u518d\u9080"," ",(0,L.jsx)(x.Text,{class:"strong",children:(null===h||void 0===h?void 0:h.freeActivateFriendsNumber)-n.length})," ","\u4f4d\u597d\u53cb\u52a9\u529b\uff0c\u5373\u53ef\u6fc0\u6d3b"]}):(0,L.jsxs)(x.View,{class:"tit",children:["\u9080"," ",(0,L.jsx)(x.Text,{class:"strong",children:null===h||void 0===h?void 0:h.freeActivateFriendsNumber})," ","\u4f4d\u597d\u53cb\u52a9\u529b\uff0c\u5373\u53ef\u6fc0\u6d3b"]}),5===m&&(0,L.jsx)(x.View,{class:"txt",children:"\xb7\u524d\u6765\u52a9\u529b\u7684\u540c\u5b66\u4e5f\u53ef\u9886\u53d6\u7279\u6743\xb7"}),(0,L.jsxs)(x.View,{class:"friend-list",children:[n.map((function(e,t){return(0,L.jsx)(x.View,{class:"item",children:(0,L.jsx)(x.Image,{src:e.photoUrl||"https://images3.c-ctrip.com/train/activity/20200714-vip-qiangpiao/avatar.png",class:"avatar"})},t)})),f.map((function(e,t){return(0,L.jsx)(x.View,{class:"item",children:(0,L.jsx)(x.Image,{src:"https://images3.c-ctrip.com/train/activity/20200714-vip-qiangpiao/order-pop-avatar.png",class:"avatar"})},t)}))]}),(0,L.jsx)(x.Button,{class:"btn-get","open-type":"share",id:"activation",onClick:i,children:n.length?"\u7ee7\u7eed\u5206\u4eab":"\u7acb\u5373\u6fc0\u6d3b"}),(null===h||void 0===h?void 0:h.isCanPayActivate)&&(0,L.jsx)(x.View,{class:"txt",onClick:v,"data-ubt-key":"rain_detail_vipbuybtn",children:(0,L.jsx)(x.RichText,{nodes:h.activateTitle,style:"display: inline-block;"})}),(0,L.jsx)(x.Text,{class:"ifont-closed",onClick:i})]})},ce=ie,oe=function(e,t){(0,P.Z)(e);var n=(0,d.useContext)(y),r=n.orderStates,a=r.orderInfo,s=r.scanFaceNeedCheck,i=(0,d.useState)(!1),c=(0,C.Z)(i,2),o=c[0],l=c[1];(0,P.Z)(a),(0,d.useImperativeHandle)(t,(function(){return{checkProto:function(){return!s||o}}}));var u=function(e){var t="https://m.ctrip.com/webapp/train/activity/orderservice/InsuranceDetail.aspx?ProductID=".concat("service"===e?2007:2021,"&terminal=1");h().navigateTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(t))})};return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(x.View,{class:"tip",children:[s&&(0,L.jsxs)(x.View,{class:"check-box",onClick:function(){return l(!o)},children:[(0,L.jsx)(x.Text,{class:"ifont-checkbox"}),(0,L.jsx)(x.Text,{class:o?"ifont-checked cur":"ifont-checked"})]}),s?"":"\u5f00\u59cb\u6838\u9a8c\u4ee3\u8868","\u5df2\u9605\u8bfb\u5e76\u540c\u610f",(0,L.jsx)(x.Text,{class:"tblue",onClick:function(){return u("service")},children:"\u670d\u52a1\u534f\u8bae"}),(0,L.jsx)(x.Text,{class:"tblue",onClick:function(){return u()},children:"\u8ba4\u8bc1\u534f\u8bae"})]}),s&&(0,L.jsx)(x.View,{class:"dialog-tip",children:"\u8bf7\u9605\u8bfb\u5e76\u52fe\u9009\u534f\u8bae"})]})},le=(0,d.forwardRef)(oe),ue=function(){},de=function(e){var t=e.type,n=void 0===t?"":t,r=e.bindAccountInfo,a=e.toScanFacePage,s=void 0===a?ue:a,i=e.onClose,c=void 0===i?ue:i,o=(0,d.useRef)(null),l=function(){o.current.checkProto()?(s({type:"active"===n?2:1}),c()):k.ZP.showToast("\u8bf7\u9605\u8bfb\u5e76\u52fe\u9009\u534f\u8bae","none")};return(0,L.jsxs)(x.View,{class:"pop-tupian",style:"height:{{name ? '896rpx' : '822rpx'}}",children:[(0,L.jsx)(x.Image,{src:"active"===n?"https://images3.c-ctrip.com/train/dulujie/jihuohuiyuan.png":"https://images3.c-ctrip.com/train/dulujie/xinyongxiang.png",mode:"widthFix"}),(0,L.jsxs)(x.View,{class:"pop-tupian-bd",children:[(0,L.jsx)(x.View,{class:"tit",children:"\u5f00\u542f\u5019\u8865\u901a\u9053"}),(0,L.jsx)(x.View,{class:"desc",children:"\u53ef\u5927\u5e45\u63d0\u5347\u62a2\u7968\u6210\u529f\u7387"}),(0,L.jsx)(x.Image,{src:"active"===n?"https://images3.c-ctrip.com/train/dulujie/step2.1@3x.png":"https://images3.c-ctrip.com/train/dulujie/step2@3x.png",mode:"widthFix"}),r.chineseName&&(0,L.jsxs)(x.View,{class:"pasName",children:["\u8bf7\u786e\u8ba4\u60a8\u662f\u8d26\u53f7\u672c\u4eba\uff1a",r.chineseName]}),(0,L.jsx)(x.View,{class:"btn-box",children:(0,L.jsxs)(x.Button,{class:"btn-submit hb-btn",onClick:l,children:["\u540c\u610f\u534f\u8bae\u5e76\u5f00\u59cb\u6fc0\u6d3b",(0,L.jsx)(x.Text,{class:"hb-btn-sub",children:"\u90013\u4e2a\u52a9\u529b\u5305"})]})}),(0,L.jsx)(le,{ref:o})]}),(0,L.jsx)(x.Icon,{class:"ifont-closed",onClick:c})]})},pe=de,he=function(){},me=function(e){var t=e.onClose,n=void 0===t?he:t,r=e.onClickLogin12306HBDialog,i=void 0===r?he:r,c=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:n();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,L.jsxs)(x.View,{className:"pop-tupian",style:"height: 778rpx;",children:[(0,L.jsx)(x.Image,{className:"hb-pic",src:"https://images3.c-ctrip.com/train/dulujie/houbutongdao.png"}),(0,L.jsxs)(x.View,{className:"pop-tupian-bd",children:[(0,L.jsx)(x.View,{className:"tit",children:"\u5f00\u542f\u5019\u8865\u901a\u9053"}),(0,L.jsx)(x.View,{className:"desc",children:"\u53ef\u5927\u5e45\u63d0\u5347\u62a2\u7968\u6210\u529f\u7387"}),(0,L.jsx)(x.Image,{className:"step-pic",src:"https://images3.c-ctrip.com/train/dulujie/step1@3x.png"}),(0,L.jsx)(x.View,{className:"btn-box",children:(0,L.jsxs)(x.Button,{className:"btn-submit hb-btn",onClick:c,children:["\u767b\u5f5512306",(0,L.jsx)(x.Text,{className:"hb-btn-sub",children:"\u90013\u4e2a\u52a9\u529b\u5305"})]})})]}),(0,L.jsx)(x.Icon,{className:"ifont-closed",onClick:n})]})},fe=d.memo(me),xe=n(39765),ve=function(){},ge=function(e){var t=e.grabRecommmendServiceInfo,n=void 0===t?{}:t,r=e.changeOrderPay,c=void 0===r?ve:r,o=e.onClose,l=void 0===o?ve:o,u=(0,d.useContext)(y),p=u.orderStates,h=u.updateOrder,m=p.orderInfo,f=n.recommmendServiceList[0],v=m.orderId,b=m.isFastPay,w=m.jLDetailInfo,j=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(t){var n,r,s,o,u,d,p;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=f.serviceType,r=f.productID,s=f.freeFlag,o=void 0!==s&&s,1!=t){e.next=31;break}return k.ZP.showLoading(),u=(0,k.Ej)({OriginalOrderId:v,ChangeType:11,RecommmendServiceList:[{serviceType:n,productID:r}]}),e.prev=4,e.next=7,(0,g.PH)(u);case 7:if(d=e.sent,0!=d.result){e.next=19;break}if(p=d.isFastPay||o,!p){e.next=16;break}return k.ZP.showModal({m:"\u6dfb\u52a0\u6210\u529f"}),h(),e.abrupt("return");case 16:c((0,i.Z)((0,i.Z)({},d),{},{redirectText:"\u6dfb\u52a0\u6210\u529f"}));case 17:e.next=20;break;case 19:throw d.resultMessage;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e["catch"](4),k.ZP.showModal({m:e.t0||"\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01"});case 25:return e.prev=25,k.ZP.hideLoading(),l(),e.finish(25);case 29:e.next=32;break;case 31:l();case 32:case"end":return e.stop()}}),e,null,[[4,22,25,29]])})));return function(t){return e.apply(this,arguments)}}(),N=b?f.freeFastPay:f.freeNormalPay,I=b?f.fastPay:f.normalPay,V=f.freeFlag?N:I,T=xe.zq[w.lightningLevel-1]||"";return(0,L.jsx)(x.View,{class:"pop-mid active",children:(0,L.jsx)(x.View,{class:"pop-mid-bd",children:(0,L.jsxs)(x.View,{class:"pop-white pop-night-qp",children:[f.freeFlag&&(0,L.jsxs)(x.View,{class:"tag",children:[T||"\u62a2\u7968","\u4e13\u4eab\xb7\u9650\u65f6\u514d\u8d39"]}),(0,L.jsx)(x.View,{class:"tit",children:V.title}),(0,L.jsx)(x.View,{class:"txt",children:(0,L.jsx)(x.RichText,{nodes:V.content})}),(0,L.jsx)(x.View,{class:"night-info",children:V.descList.map((function(e,t){return(0,L.jsx)(x.View,{class:"item",children:(0,L.jsx)(x.RichText,{nodes:e})},t)}))}),(0,L.jsx)(x.View,{class:"pop-night-qp-btn",children:f.alertInfo.buttonList.map((function(e,t){return(0,L.jsx)(x.Button,{class:1==e.actionType?"btn-buy":"btn-cancel",onClick:function(){return j(e.actionType)},children:e.buttonName},t)}))})]})})})},be=ge,we=void 0,je=function(){},Ne=function(e){var t=e.robTaskInfo,n=e.onClose,r=void 0===n?je:n,i=(0,d.useContext)(y),c=i.orderStates,o=i.updateOrder,l=c.orderInfo,u=c.shereFlag,p=l.orderId,m=l.ticketInfos,f=(0,d.useState)(!1),v=(0,C.Z)(f,2),b=v[0],w=v[1],j=(0,d.useState)(!1),N=(0,C.Z)(j,2),I=N[0],V=N[1],T=(0,d.useState)(""),S=(0,C.Z)(T,2),P=S[0],_=S[1];(0,d.useState)((function(){u&&F()}),[u]);var D=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(n){var r,s;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={OrderNumber:p,ShareType:n},k.ZP.showLoading(),k.ZP.ubtDevTrace("train_tinyapp_dev_log",{bizKey:"InviteRobPop_pop_share",value:{type:n,robTaskInfo:t}}),e.next=5,(0,g.L6)(r);case 5:if(s=e.sent,1!=s.retCode||!s.isSuccess){e.next=8;break}return e.abrupt("return",s);case 8:throw new Error("\u7f51\u7edc\u5f00\u5c0f\u5dee\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5~");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,D("1");case 2:k.ZP.showToast("\u5206\u4eab\u6210\u529f \u83b7\u5f97".concat(t.giftPackageNum,"\u4e2a\u52a9\u529b\u5305"),"none",2e3),setTimeout((function(){o()}),2e3);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(e){e.detail.authSetting["scope.writePhotosAlbum"]&&V(!0)},A=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return k.ZP.showLoading(),t={ShareKey:p,FromStation:m[0].departStation,ToStation:m[0].arriveStation,PassagePhotoUrl:"",RequestId:h().cwx_mkt.openid,ReqTime:""+(new Date).getTime(),Partner:"ctrip",channel:Z.Z.channel},e.prev=2,e.next=5,(0,g.jk)(t);case 5:if(n=e.sent,k.ZP.hideLoading(),!n.imgUrl){e.next=10;break}return _(n.imgUrl),e.abrupt("return",n.imgUrl);case 10:throw new Error("\u751f\u6210\u56fe\u7247\u5931\u8d25");case 13:e.prev=13,e.t0=e["catch"](2),k.ZP.showToast("\u751f\u6210\u56fe\u7247\u5931\u8d25","none");case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r,s;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:t=e.sent,n=function(){w(!0)},r=function(){k.ZP.showToast("\u4fdd\u5b58\u5931\u8d25","none")},s=function(){we.setData({hasRejectAlbum:!0})},(0,k.Qu)(t,n,r,s);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r(),e.prev=1,e.next=4,D("2");case 4:k.ZP.showToast("\u5206\u4eab\u6210\u529f \u83b7\u5f97".concat(t.giftPackageNum,"\u4e2a\u52a9\u529b\u5305"),"none",2e3),setTimeout((function(){o()}),2e3),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),k.ZP.showToast("\u83b7\u53d6\u52a9\u529b\u5305\u5931\u8d25","none",2e3);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();return b?(0,L.jsxs)(x.View,{class:"pop-share-qrcode",children:[(0,L.jsx)(x.View,{class:"pop-share-qrcode-bd",children:(0,L.jsx)(x.Image,{src:P,mode:"widthFix"})}),(0,L.jsx)(x.View,{class:"info",children:"\u56fe\u7247\u5df2\u4fdd\u5b58\u81f3\u624b\u673a\uff0c\u5feb\u53bb\u5206\u4eab\u5427"}),(0,L.jsx)(x.Icon,{class:"ifont-closed",onClick:B})]}):(0,L.jsxs)(x.View,{class:"pop-share-friend",children:[(0,L.jsx)(x.View,{class:"pop-share-friend-bd",children:(0,L.jsxs)(x.View,{class:"btn-box",children:[(0,L.jsx)(x.Image,{src:"https://images3.c-ctrip.com/train/app/828/qiangpiao/app/pop2/pop_VIP2.png"}),t.shareTypeList.map((function(e,t){return e.isCanGiftPackage?(0,L.jsxs)(L.Fragment,{children:[1===e.shareType&&(0,L.jsx)(x.Button,{"open-type":"share",class:"btn-qun",id:"robtaskshare"},t),2===e.shareType&&(I?(0,L.jsx)(x.Button,{class:"btn-pyq","open-type":"openSetting",onOpenSetting:O,id:"sharebtn-pop","data-type":"2"}):(0,L.jsx)(x.Button,{class:"btn-pyq",onClick:R,"data-type":"2"}))]}):(0,L.jsx)(L.Fragment,{})}))]})}),(0,L.jsx)(x.Icon,{class:"ifont-closed",bindtap:"hidePop"})]})},Ie=Ne,Ve=function(){},ke=function(e){var t=e.onClose,n=void 0===t?Ve:t,r=(0,d.useContext)(y),a=r.orderStates,s=a.orderInfo,i=s.orderId,c=s.alertInfo;return(0,L.jsx)(x.View,{class:"pop-mid active",children:(0,L.jsx)(x.View,{class:"pop-mid-bd",children:(0,L.jsx)(x.View,{class:"pop-white",children:(0,L.jsxs)(x.View,{class:"pop-sfhy",children:[(0,L.jsx)(x.Icon,{class:"icon-tips"}),c.title&&(0,L.jsx)(x.View,{class:"tit",children:c.title}),c.content&&(0,L.jsx)(x.View,{class:"txt",children:c.content}),(0,L.jsx)(x.Button,{class:"btn-ok","hover-class":"btn-ok_hover",onClick:function(){n(),(0,k._E)(i)},children:"\u4fee\u6539\u8ba2\u5355"})]})})})})},ye=ke,Te=function(){},Ze=function(e){var t=e.onClose,n=void 0===t?Te:t,r=(0,d.useContext)(y),a=r.orderStates,s=r.updateOrder,i=a.orderInfo,c=i.orderId,o=i.alertInfo,l=function(){n(),(0,k.td)({oid:c,sbackCallback:s,ebackCallback:s})};return(0,L.jsx)(L.Fragment,{children:(0,L.jsx)(x.View,{class:"pop-mid active",children:(0,L.jsx)(x.View,{class:"pop-mid-bd",children:(0,L.jsxs)(x.View,{class:"pop-white pop-paytips",children:[(0,L.jsx)(x.Icon,{class:"icon-tips"}),(0,L.jsx)(x.View,{class:"tit",children:o.title}),(0,L.jsx)(x.View,{class:"txt",children:o.content}),(0,L.jsxs)(x.View,{class:"pop-paytips-btn",children:[(0,L.jsx)(x.Button,{class:"btn-no","hover-class":"btn-no_hover",onClick:n,children:"\u6682\u4e0d\u652f\u4ed8"}),(0,L.jsx)(x.Button,{class:"btn-get","hover-class":"btn-get_hover",onClick:l,children:"\u7acb\u5373\u652f\u4ed8"})]})]})})})})},Se=Ze,Ce=function(){},Pe=function(e){var t=e.onClose,n=void 0===t?Ce:t,r=(0,d.useContext)(y),a=r.orderStates,s=a.orderInfo,i=s.alertInfo,c=function(){n(),h().navigateTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(i.jumpUrl))})};return(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)(x.View,{class:"pop-heyan",children:[(0,L.jsx)(x.View,{class:"tit",children:i.title}),(0,L.jsx)(x.View,{class:"txt",children:i.content}),(0,L.jsx)(x.Button,{class:"btn-go",onClick:c,children:i.buttonName})]})})},Le=Pe,_e=function(){},De=function(e){var t=e.onClose,n=void 0===t?_e:t,r=(0,d.useContext)(y),i=r.orderStates,c=r.updateOrder,o=i.orderInfo,l=i.extendValues,u=o.OrderId,p=l&&l.DedicatedGrabAisleInfo||{},h=p.title,m=p.content,f=p.buttonList,v=void 0===f?[]:f,g=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:n(),c();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,L.jsx)(x.View,{class:"pop-mid active pop-dedicated",children:(0,L.jsx)(x.View,{class:"pop-mid-bd",children:(0,L.jsxs)(x.View,{class:"pop-white pop-paytips",children:[(0,L.jsx)(x.View,{class:"tit",children:h}),(0,L.jsx)(x.View,{class:"txt",children:m}),!!v.length&&(0,L.jsx)(x.View,{class:"pop-paytips-btn",children:v.map((function(e,t){return 1===e.buttonType?(0,L.jsx)(x.Button,{class:"btn-no","hover-class":"btn-no_hover",onClick:n,children:e.buttonName},t):(0,L.jsx)(x.Button,{class:"btn-get","hover-class":"btn-get_hover",onClick:function(){(0,k.td)({oid:u,sbackCallback:function(){return g()},ebackCallback:function(){return g()}})},children:e.buttonName},t)}))})]})})})},Fe=De,Oe=A().classnames,Ae={bottom:"botm",middle:"mid"},Re=function(e){var t=e.children,n=e.direction,r=void 0===n?"bottom":n,a=e.className,s=void 0===a?"":a,i=e.visible,c=void 0!==i&&i,o=e.mask,l=void 0===o||o,u=e.clickMaskClose,p=void 0!==u&&u,h=e.lock,m=void 0===h||h,f=e.zIndex,v=void 0===f?9999:f,g=e.close,b=Ae[r],w=(0,d.useState)(!1),j=(0,C.Z)(w,2),N=j[0],I=j[1],V=(0,d.useState)(!1),k=(0,C.Z)(V,2),y=k[0],T=k[1];(0,d.useEffect)((function(){c?setTimeout((function(){T(!0)}),10):T(!1),setTimeout((function(){I(c)}),300)}),[c]);var Z=function(){p&&(null===g||void 0===g||g())};if(!c&&!N)return null;var S="popup ".concat(b," ").concat(y?"active":""," ").concat(s),P={zIndex:v};return(0,L.jsxs)(L.Fragment,{children:[l&&(0,L.jsx)(x.View,{className:Oe("popup-mask",{active:y}),style:c?P:{},onClick:Z,catchMove:!0}),(0,L.jsx)(x.View,{className:S,style:c?P:{},catchMove:m,children:t})]})},Be=Re,Me=A().dayjs,Ge=function(){},Ue=["intelligenceCancel","grabRecommend","weakGuideScan","activation","scanFaceActive","scanFaceCheck","loginHB12306","nearBy","nightGrab","recommendServiceGuide","robSuccess","HBFullModal","HBPayModal","mobileCheck"],ze=["nightGrab"],Ee=[],Ke=function(e){var t=e.popDataReady,n=void 0!==t&&t,r=e.nearByPopDetail,a=e.toScanFacePage,s=void 0===a?Ge:a,i=e.toBreakPage,c=void 0===i?Ge:i,o=e.directShowPopKey,l=void 0===o?"":o,u=e.setDirectShowPopKey,p=void 0===u?Ge:u,h=e.robTaskInfo,m=e.isCanFaceAuthentication,f=e.hbInfo,x=e.bindAccountInfo,v=e.onClickLogin12306HBDialog,g=void 0===v?Ge:v,b=e.grabRecommmendServiceInfo,w=e.activationAssistedFriendList,j=e.grabTrain,N=e.recommendTrainList,I=e.recommendFloatingLayerInfo,V=e.otherTrainsSeatsArr,Z=e.hbAlertInfo,S=e.changeOrderPay,P=void 0===S?Ge:S,_=(0,d.useContext)(y),D=_.orderStates,F=D.orderInfo,O=D.showType,A=D.extendValues,R=D.showModal,B=D.showNearTrainModal,M=F.orderId,G=F.alertInfo,U=F.ticketInfos,z=(0,d.useState)(""),E=(0,C.Z)(z,2),K=E[0],q=E[1];function W(e){var t,n,a,s=parseInt(null===x||void 0===x?void 0:x.status),i=1==(null===f||void 0===f?void 0:f.state)&&[1,2,4,5].includes(F.orderStatus);switch(e){case"intelligenceCancel":return"intelligenceCancelPop"===R;case"grabRecommend":return F.jLDetailInfo.jLAllTrainNumbers===U[0].trainNumber&&N.length;case"weakGuideScan":return 27==(null===G||void 0===G?void 0:G.alertType)||1===(null===(t=A.GrabInterrupteSpecialSmallScene)||void 0===t?void 0:t.actionCode)||5===(null===(n=A.GrabInterrupteSpecialSmallScene)||void 0===n?void 0:n.actionCode);case"activation":return F.isUseVipGrabRight&&F.isNeedActivateVipRights;case"scanFaceActive":return i&&20===s&&m;case"scanFaceCheck":return i&&(30===s||40===s)&&m;case"loginHB12306":return i&&Z.isShow;case"nearBy":return(null===r||void 0===r?void 0:r.timeLine)&&!F.jLDetailInfo.jLRecommodNearTrainTimeLine;case"nightGrab":case"recommendServiceGuide":return null===b||void 0===b||null===(a=b.recommmendServiceList)||void 0===a?void 0:a.find((function(e){return 1==e.serviceType&&1!=e.serviceStatus}));case"robSuccess":return(null===h||void 0===h?void 0:h.isCanGain)&&"robSuccess"==O;case"HBFullModal":return 5===(null===G||void 0===G?void 0:G.alertType);case"HBPayModal":return 6===(null===G||void 0===G?void 0:G.alertType);case"mobileCheck":return 18===(null===G||void 0===G?void 0:G.alertType);default:return!1}}function J(){B&&ze.push("nearBy"),Me().isSame(Me(U[0].departDate),"day")&&ze.push("weakGuideScan");var e=Ue.filter((function(e){return ze.find((function(t){return t===e}))||!Q(e)})),t=e.find(W)||"";"scanFaceActive"!==t&&"scanFaceCheck"!==t&&"loginHB12306"!==t||k.ZP.ubtTrace("s_trn_c_trace_10650072279",{exposureType:"popup",bizKey:"alternateChannel"}),k.ZP.ubtDevTrace("train_tinyapp_dev_log",{bizKey:"grabdetail_pop_show_pop_key",value:t}),q(t)}function Q(e){var t;return null===(t=T.ZK.getAttr(e))||void 0===t||null===(t=t.oids)||void 0===t?void 0:t.includes(M)}(0,d.useEffect)((function(){n&&W(l)&&q(l)}),[l,n]),(0,d.useEffect)((function(){n&&J()}),[n]);var X=(0,d.useCallback)((function(){if(Ue.includes(K)){var e,t=(null===(e=T.ZK.getAttr(K))||void 0===e?void 0:e.oids)||[];t.push(M),t=Array.from(new Set(t)),T.ZK.setAttr(K,{oids:t})}Ee.includes(K)&&setTimeout((function(){return J()}),300),q(""),p("")}),[K]),$=function(){switch(K){case"intelligenceCancel":return(0,L.jsx)(Y,{onClose:X});case"grabRecommend":return(0,L.jsx)(te,{grabTrain:j,recommendFloatingLayerInfo:I,recommendTrainList:N,otherTrainsSeatsArr:V,onClose:X,changeOrderPay:P});case"weakGuideScan":return(0,L.jsx)(ae,{toBreakPage:c,toScanFacePage:s,onClose:X});case"activation":return(0,L.jsx)(ce,{activationAssistedFriendList:w,onClose:X});case"scanFaceActive":return(0,L.jsx)(pe,{type:"active",bindAccountInfo:x,toScanFacePage:s,onClose:X});case"scanFaceCheck":return(0,L.jsx)(pe,{type:"check",bindAccountInfo:x,toScanFacePage:s,onClose:X});case"loginHB12306":return(0,L.jsx)(fe,{onClose:X,onClickLogin12306HBDialog:g});case"nearBy":return(0,L.jsx)(H,{nearByPopDetail:r,grabTrain:j,onClose:X});case"nightGrab":case"recommendServiceGuide":return(0,L.jsx)(be,{grabRecommmendServiceInfo:b,changeOrderPay:P,onClose:X});case"robSuccess":return(0,L.jsx)(Ie,{robTaskInfo:h,onClose:X});case"HBFullModal":return(0,L.jsx)(ye,{onClose:X});case"HBPayModal":return(0,L.jsx)(Se,{onClose:X});case"mobileCheck":return(0,L.jsx)(Le,{onClose:X});case"DedicatedGrabAisleInfo":return(0,L.jsx)(Fe,{onClose:X});default:return(0,L.jsx)(L.Fragment,{})}};return(0,L.jsx)(L.Fragment,{children:(0,L.jsx)(Be,{visible:K,className:"grabRecommend"===K?"pop-botm":"",direction:"grabRecommend"===K?"bottom":"middle",clickMaskClose:!0,close:X,children:(0,L.jsx)($,{})})})},He=d.memo(Ke),qe=function(){var e=(0,d.useContext)(y),t=e.orderStates,n=(e.pageFns,t.orderInfo),r=(0,d.useState)(""),c=(0,C.Z)(r,2),o=c[0],l=c[1],u=(0,d.useState)([]),p=(0,C.Z)(u,2),m=p[0],f=p[1],v=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,r,s,c,o,u,d,p,m;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=n.orderId,r=void 0===t?"":t,s=n.orderStatus,c=void 0===s?"":s,o=n.failReason,u=void 0===o?"":o,d={Channel:"ctripwx",PageId:S.Z.grabDetail,NoTicketReason:u||"",OrderInfo:{orderId:r,orderStatus:c,UserInfo:{Uid:h().user.auth}}},e.next=4,(0,g.Ay)(d);case 4:p=e.sent,"SUCCESS"==p.status&&p.scenceInfos&&(m=p.scenceInfos.filter((function(e){return!!e.scenceContent})).map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{content:!!e.scenceContent&&e.scenceContent})})),f(m),l(p.moreQuestionJumpUrl||""));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(e){h().component.cwebview({data:{url:encodeURIComponent(e)}})};return(0,d.useEffect)((function(){n&&v()}),[n]),(0,L.jsxs)(x.View,{className:"white-box faq-box",children:[(0,L.jsxs)(x.View,{className:"faq-hd",children:[(0,L.jsx)(x.View,{className:"htit",children:"\u5e38\u89c1\u95ee\u9898"}),(0,L.jsxs)(x.View,{className:"rbox",onClick:function(){o&&b(o)},children:["\u5176\u4ed6\u95ee\u9898",(0,L.jsx)(x.Text,{className:"ifont-arr"})]})]}),(0,L.jsx)(x.View,{className:"faq-bd",children:m.map((function(e,t){return(0,L.jsx)(x.View,{className:"item",onClick:function(){b(e.scenceUrl)},children:e.content},t)}))})]})},We=qe,Ye=A().classnames,Je=function(e){var t=e.visible,n=e.close,r=e.data;return t?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(x.View,{className:"rule-pop-mask",onClick:n}),(0,L.jsxs)(x.View,{className:"rule-pop",children:[(0,L.jsxs)(x.View,{className:"rule-pop-hd",children:[(0,L.jsx)(x.View,{className:"tit",children:"\u6d3b\u52a8\u8bf4\u660e"}),(0,L.jsx)(x.View,{className:"cancel ifont-closed-line",onClick:n})]}),(0,L.jsx)(x.View,{className:"rule-pop-bd",children:r.map((function(e,t){return(0,L.jsx)(x.View,{className:"item",children:e},t)}))})]})]}):null},Qe=function(e){var t,n=e.visible,r=e.done,a=e.close,s=e.orderInfo,c=e.sharedList,o=e.userRights,l=e.grabTicketChangeInfo,u=(0,d.useContext)(y),p=u.orderStates,h=p.speedActivityInfo,m=p.speedVipConfig,f=u.pageFns.navigateTo,v=(0,d.useState)(0),g=(0,C.Z)(v,2),b=g[0],w=g[1],j=(0,d.useState)([]),N=(0,C.Z)(j,2),I=N[0],V=N[1],T=(0,d.useState)(0),Z=(0,C.Z)(T,2),S=Z[0],P=Z[1],_=(0,d.useState)(null),D=(0,C.Z)(_,2),F=D[0],O=D[1],A=(0,d.useState)(null),R=(0,C.Z)(A,2),B=(R[0],R[1]),M=(0,d.useState)(!1),G=(0,C.Z)(M,2),U=G[0],z=G[1],E=(null===s||void 0===s||null===(t=s.ticketInfos)||void 0===t||null===(t=t[0].passengerInfos)||void 0===t?void 0:t.length)||1,K=function(){var e=l||{},t=e.userAccountPackageList,n=e.trainPackageInfo,r=n||{},a=r.acceleratePackagePrice,s=r.trainPackageProductList,c=(null===t||void 0===t?void 0:t.reduce((function(e,t){return(null===t||void 0===t?void 0:t.count)>0&&(e+=t.count),e}),0))||0,o=c*a;if(s){var u=s.map((function(e){var t=null===e||void 0===e?void 0:e.packageTitle.replace(/\u62a2\u7968/g,""),n=e.packagePrice-S,r=parseInt(n/a);return(0,i.Z)((0,i.Z)({},e),{},{name:t,perPrice:n,per:r})})).sort((function(e,t){return e.packagePrice-t.packagePrice})),d=u.filter((function(e){return e.packageTagV2||e.packageTag})).pop()||u[u.length-1],p=u.findIndex((function(e){return e.name==d.name}));u&&(V(u),O(d),w(p),B({count:c,price:o}))}},H=function(e){w(e),O(I[e])},q=function(){var e,t=b==I.findIndex((function(e){return"VIP"==e.name})),n=l.trainAppendProductList,i=null===n||void 0===n?void 0:n.find((function(e){return"AcceleratePackage"==e.specialRealSubType}));if(i||k.ZP.ubtDevTrace("train_tinyapp_dev_log",{bizKey:"grabdetail_speed_pop_done",value:{grabTicketChangeInfo:l}}),t){var c,u=null===(c=o.userRightsCountList)||void 0===c?void 0:c.find((function(e){return 6==e.rightsLevel}));if(!u)return a(),f({url:"/pages/trainActivity/twebview/index",data:{url:"https://pages.ctrip.com/ztrip/market/ctrip-vip/",needLogin:!0}});e=(0,k.Ej)({ChangeType:16,OriginalOrderId:s.orderId,UseRightsInfoList:[{rightsLevel:u.rightsLevel,rightsLevelRangeName:u.rightsLevelRangeName,rightsType:u.rightsType,sourceType:u.userRightsInfoList[0].sourceType,rightsName:u.userRightsInfoList[0].rightsName}]})}else e=(0,k.Ej)({OriginalOrderId:s.orderId,AppendList:[{AppendID:(null===i||void 0===i?void 0:i.appendID)||9999,AppendCount:F.per*E,AppendContent:""}],ChangeType:1});r(e,t)},W=function(){z(!0)},Y=function(){z(!1)},J=function(){return I.length<0?null:I.map((function(e,t){return(0,L.jsxs)(x.View,{className:Ye("item",{active:t==b,vip:"VIP"==e.name}),onClick:function(){return H(t)},children:["VIP"==e.name?(0,L.jsxs)(x.View,{className:"tag",children:[(0,L.jsx)(x.View,{className:"ifont-crown"}),"\u6700\u9ad8\u901f"]}):e.packageTagV2||e.packageTag?(0,L.jsx)(x.View,{className:"tag",children:e.packageTagV2||e.packageTag}):null,(0,L.jsxs)(x.View,{className:"tit",children:["\u63d0\u5347\u81f3",e.name]}),"VIP"==e.name&&null!==m&&void 0!==m&&m.isOpen?(0,L.jsx)(x.View,{className:"sub",children:null===m||void 0===m?void 0:m.desc}):(0,L.jsx)(x.View,{className:"sub",children:null!==e&&void 0!==e&&e.rights?"0\u5143/\u4eba":"".concat(e.per,"\u4efd/\u4eba")})]},t)}))},Q=function(){var e=F.serviceInfo||{},t=e.serviceList,n=e.descList;return null!==n&&void 0!==n&&n.length?(0,L.jsxs)(x.View,{className:"benefit",children:[(0,L.jsxs)(x.View,{className:"tit after",children:[(0,L.jsxs)(x.Text,{children:[F.name,"\u4e13\u4eab\u670d\u52a1"]}),(0,L.jsxs)(x.View,{className:"price",children:["\uffe5",F.perPrice*E]})]}),(0,L.jsx)(x.View,{className:"pkg-pic-list",children:null===t||void 0===t?void 0:t.map((function(e,t){return(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsxs)(x.View,{className:"img",children:[(0,L.jsx)(x.Image,{src:e.imgUrl}),!!e.tag&&(0,L.jsx)(x.View,{className:"tag",children:e.tag})]}),(0,L.jsx)(x.View,{className:"tit",children:e.title}),(0,L.jsx)(x.View,{className:"sub",children:e.subTitle})]},t)}))}),(0,L.jsx)(x.View,{className:"pkg-right-rule",children:n.map((function(e){return(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsx)(x.View,{className:"ifont-gou"}),e]},e)}))})]}):null};return(0,d.useEffect)((function(){K()}),[l,S]),(0,d.useEffect)((function(){P(null===s||void 0===s?void 0:s.jLDetailInfo.speedLevel)}),[s]),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(Be,{visible:n,clickMaskClose:!0,close:a,children:[k.ZP.ubtTrace("s_trn_c_trace_10650072279",{bizKey:"addSpeed",exposureType:"normal",orderId:s.orderId,helpedNum:c.length}),(0,L.jsxs)(x.View,{className:"speedup-pop",children:[(0,L.jsxs)(x.View,{className:"speedup-pop-hd",children:[(0,L.jsx)(x.View,{className:"close",onClick:a,children:"\u53d6\u6d88"}),(0,L.jsx)(x.View,{className:"tit",children:"\u9009\u62e9\u52a0\u901f\u7b49\u7ea7"})]}),(0,L.jsxs)(x.View,{className:"speedup-pop-bd",children:[(null===h||void 0===h?void 0:h.isOpen)&&(0,L.jsx)(x.Image,{src:h.banner,className:"banner",onClick:W}),(0,L.jsx)(x.View,{className:"list",children:J()}),!1,!!F&&Q(),(0,L.jsx)(x.View,{className:"done",onClick:q,children:"\u786e\u8ba4\u6dfb\u52a0"})]})]})]}),(null===h||void 0===h?void 0:h.isOpen)&&(0,L.jsx)(Je,{visible:U,data:h.rules,close:Y})]})},Xe=Qe,$e=A().classnames,et=function(e){var t,n=e.speedInfo,r=e.orderInfo,c=e.grabTicketChangeInfo,o=e.changeOrderPay,l=e.sharedList,u=e.userRights,p=e.updateOrder,h=e.isCanFaceAuthentication,m=void 0!==h&&h,f=(0,d.useContext)(y),v=f.pageFns,b=f.orderStates,w=b.grabShareConfig,j=(0,d.useState)(!1),N=(0,C.Z)(j,2),I=N[0],V=N[1],T=(0,d.useState)(!1),Z=(0,C.Z)(T,2),S=Z[0],P=Z[1],_=function(){var e;if(k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"addSpeedClick",orderId:r.orderId}),(null===(e=r.jLDetailInfo)||void 0===e?void 0:e.lightningLevel)>4){if(null!==w&&void 0!==w&&w.closeOrderSpeedUpShare)return k.ZP.showToast("\u6682\u4e0d\u652f\u6301\u5206\u4eab\u597d\u53cb\u52a0\u901f","none");var t=r.ticketInfos,n=r.userInfo,a=r.orderId;v.navigateTo({url:"/pages/train/inviterob/inviterob",data:{oid:a,astation:t[0].arriveStation,dstation:t[0].departStation,orderMobile:n.contactMobileAES,isCanFaceAuthentication:m}})}else V(!0)},D=function(){V(!1)},F=function(){return P(!S)},O=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(t,n){var r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return D(),k.ZP.showLoading(),e.prev=2,e.next=5,(0,g.PH)(t);case 5:if(r=e.sent,k.ZP.hideLoading(),0==r.result){e.next=10;break}throw k.ZP.showModal({m:r.resultMessage||"\u52a9\u529b\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01"}),r.resultMessage||"\u52a9\u529b\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01";case 10:if(!n){e.next=12;break}return e.abrupt("return",p());case 12:o((0,i.Z)((0,i.Z)({},r),{},{succText:"\u52a9\u529b\u6210\u529f!",redirectText:"\u52a9\u529b\u6210\u529f!"})),e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](2),k.ZP.showModal({m:e.t0});case 18:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t,n){return e.apply(this,arguments)}}(),A=function(){if(null!==r&&void 0!==r&&r.jLDetailInfo){var e,t=r.jLDetailInfo||{},n=t.serviceInfo,a=t.useRightsInfoList,s=t.lightningLevel,i=n||{},o=i.speedLevelDesc,l=i.descList,u=(null===o||void 0===o?void 0:o.replace(/<font[\s]+color=([^>]*)>([^<]*)<\/font>/gi,"<span style='color:$1;'>$2</span>"))||"";if(a){var d,p=(0,C.Z)(a,1),h=p[0];return 6==s&&6==h.rightsLevel?(0,L.jsx)(x.View,{className:"speed-cont-desc hasRights",children:(0,L.jsx)(x.View,{className:"tit",children:(0,L.jsxs)(x.View,{className:"right",children:[(0,L.jsx)(x.Image,{src:h.rightsSimpleIcon}),(0,L.jsxs)(x.View,{className:"txt",children:["\u672c\u5355\u5df2\u4f7f\u7528",h.rightsLevelRangeName,"\u62a2\u7968\u7279\u6743"]})]})})}):6==s&&6!=h.rightsLevel?(0,L.jsx)(x.View,{className:"speed-cont-desc hasRights",children:(0,L.jsxs)(x.View,{className:"tit",children:[(0,L.jsxs)(x.View,{className:"right",children:[(0,L.jsx)(x.View,{className:"ifont-gou"}),(0,L.jsx)(x.View,{className:"txt",children:"VIP\u62a2\u7968\u5df2\u5f00\u542f"})]}),(0,L.jsxs)(x.View,{className:"right",children:[(0,L.jsx)(x.Image,{src:h.rightsSimpleIcon}),(0,L.jsxs)(x.View,{className:"txt",children:["\u672c\u5355\u5df2\u4f7f\u7528",h.rightsLevelRangeName,"\u62a2\u7968\u7279\u6743"]})]})]})}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(x.View,{className:"right",children:[(0,L.jsx)(x.Image,{src:h.rightsSimpleIcon}),(0,L.jsxs)(x.View,{className:"txt",children:["\u672c\u5355\u5df2\u4f7f\u7528",h.rightsLevelRangeName,"\u62a2\u7968\u7279\u6743"]})]}),(0,L.jsxs)(x.View,{className:"speed-cont-desc hasRights",children:[(0,L.jsxs)(x.View,{className:"tit layer",children:[(0,L.jsx)(x.RichText,{nodes:u}),!!l&&(0,L.jsx)(x.View,{className:"expand-txt",onClick:F,children:"".concat(S?"\u6536\u8d77":"\u67e5\u770b").concat(xe.zq[s],"\u793c\u5305")})]}),!(null===(d=c.trainPackageInfo)||void 0===d||null===(d=d.trainPackageProductList)||void 0===d||!d.length)&&(0,L.jsx)(x.Button,{className:"btn",onClick:_,children:"\u7acb\u5373\u52a0\u901f"})]})]})}return 6==s?(0,L.jsx)(x.View,{className:"speed-cont-desc",children:(0,L.jsx)(x.View,{className:"tit",children:(0,L.jsxs)(x.View,{className:"right",children:[(0,L.jsx)(x.View,{className:"ifont-gou"}),(0,L.jsx)(x.View,{className:"txt",children:"VIP\u62a2\u7968\u5df2\u5f00\u542f"})]})})}):(0,L.jsxs)(x.View,{className:"speed-cont-desc",children:[(0,L.jsxs)(x.View,{className:"tit layer",children:[(0,L.jsx)(x.RichText,{nodes:u}),!!l&&(0,L.jsx)(x.View,{className:"expand-txt",onClick:F,children:"".concat(S?"\u6536\u8d77":"\u67e5\u770b").concat(xe.zq[s],"\u793c\u5305")})]}),!(null===(e=c.trainPackageInfo)||void 0===e||null===(e=e.trainPackageProductList)||void 0===e||!e.length)&&(0,L.jsx)(x.Button,{className:"btn",onClick:_,children:"\u7acb\u5373\u52a0\u901f"})]})}},R=function(){var e;if(null!==r&&void 0!==r&&null!==(e=r.jLDetailInfo)&&void 0!==e&&e.serviceInfo){var t=r.jLDetailInfo.serviceInfo||{},n=t.serviceList,a=t.descList;return null!==a&&void 0!==a&&a.length?(0,L.jsxs)(x.View,{className:$e("speed-cont-benefit",{active:S}),children:[S&&(0,L.jsx)(x.View,{className:"arrow"}),(0,L.jsx)(x.View,{className:"pkg-pic-list",children:null===n||void 0===n?void 0:n.map((function(e,t){return(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsxs)(x.View,{className:"img",children:[(0,L.jsx)(x.Image,{src:e.imgUrl}),!!e.tag&&(0,L.jsx)(x.View,{className:"tag",children:e.tag})]}),(0,L.jsx)(x.View,{className:"tit",children:e.title}),(0,L.jsx)(x.View,{className:"sub",children:e.subTitle})]},t)}))}),(0,L.jsx)(x.View,{className:"pkg-right-rule",children:a.map((function(e){return(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsx)(x.View,{className:"ifont-gou"}),e]},e)}))})]}):null}};return(0,L.jsxs)(L.Fragment,{children:[!!n&&(0,L.jsxs)(x.View,{className:$e("speed-cont",{vip:6==(null===(t=r.jLDetailInfo)||void 0===t?void 0:t.lightningLevel)}),children:[k.ZP.ubtTrace("s_trn_c_trace_10650072279",{bizKey:"grabSpeed",exposureType:"normal",orderId:r.orderId}),(0,L.jsx)(x.View,{className:"speed-cont-stage",children:n.speedLevels.map((function(e){var t;return(0,L.jsxs)(x.View,{className:$e("item",{active:e.curr}),children:["VIP"==e.name&&6!=(null===(t=r.jLDetailInfo)||void 0===t?void 0:t.lightningLevel)&&(0,L.jsx)(x.View,{className:"icon-vip"}),e.name]},e.name)}))}),(0,L.jsx)(x.View,{className:"speed-cont-line",children:(0,L.jsx)(x.View,{className:"line",style:{width:"".concat(n.linePercent,"%")}})}),A(),R()]}),(0,L.jsx)(Xe,{visible:I,done:O,close:D,sharedList:l,grabTicketChangeInfo:c,orderInfo:r,userRights:u})]})},tt=et,nt=A().classnames,rt=h().train,at=function(){var e=(0,d.useContext)(y),t=e.orderStates.orderInfo,n=e.pageFns.navigateTo,r=(0,d.useState)(null),i=(0,C.Z)(r,2),c=i[0],o=i[1],l=(0,d.useState)(!1),u=(0,C.Z)(l,2),p=u[0],h=u[1],m=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var n,r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={OrderNumber:t.orderId},e.next=3,(0,g.nT)(n);case 3:if(r=e.sent,1==r.retCode){e.next=6;break}throw r.retMessage;case 6:o(r),r.addedOrderInAnotherGroup||f();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e,n="TEAMUPNOTICE",r=(null===(e=T.ZK.getAttr(n))||void 0===e?void 0:e.oids)||[];"teamup"==rt.activitySource&&r.includes(t.orderId)&&(h(!0),v(n))},v=function(e){var n,r=(null===(n=T.ZK.getAttr(e))||void 0===n?void 0:n.oids)||[];T.ZK.setAttr(e,{oids:(0,J.Z)(new Set([].concat((0,J.Z)(r),[t.orderId])))})},b=function(){return h(!1)},w=function(){n({url:"/pages/trainActivity/twebview/index",data:{url:"".concat(c.jumpUrl,"&appointOrder=").concat(t.orderId)}})},j=function(){return(0,L.jsx)(Be,{visible:p,mask:!1,lock:!1,children:(0,L.jsxs)(x.View,{className:nt("pintuan-pop",{iphone:(0,k.Rq)()}),children:[(0,L.jsxs)(x.View,{className:"inner",onClick:w,children:[(0,L.jsx)(x.View,{className:"icon"}),(0,L.jsx)(x.View,{className:"txt",children:"\u53d1\u9001\u5e2e\u62a2\u6d88\u606f\uff0c\u5373\u53ef\u5f00\u542f\u591a\u4eba\u5e2e\u62a2\u6a21\u5f0f"}),(0,L.jsx)(x.View,{className:"btn"})]}),(0,L.jsx)(x.View,{className:"close",children:(0,L.jsx)(x.View,{className:"icon-closed",onClick:b})})]})})};return(0,d.useEffect)((function(){m()}),[]),(0,L.jsxs)(L.Fragment,{children:[(null===c||void 0===c?void 0:c.isShow)&&(0,L.jsxs)(x.View,{className:"pintuan-banner",children:[(0,L.jsx)(x.View,{className:"icon"}),(0,L.jsxs)(x.View,{className:"desc",children:[(0,L.jsx)(x.View,{className:"tit",children:c.title}),(0,L.jsx)(x.View,{className:"sub",children:c.subtitle||"\u7ec4\u56e2\u62a2\u7968\uff0c\u52a0\u901f\u56de\u5bb6"})]}),!!c.buttonName&&(0,L.jsx)(x.Button,{className:"btn",onClick:w,children:c.buttonName})]}),j()]})},st=at,it=A().classnames,ct=function(e){var t=(0,d.useContext)(y),n=t.orderStates.orderInfo,r=e.visible,a=e.rightList,s=e.done,c=e.close,o=(0,d.useState)([]),l=(0,C.Z)(o,2),u=l[0],p=l[1],h=(0,d.useState)(null),m=(0,C.Z)(h,2),f=m[0],v=m[1],g=function(e,t){if(!t.choesn){var n=u.map((function(n){return(0,i.Z)((0,i.Z)({},n),{},{userRightsInfoList:n.userRightsInfoList.map((function(n,r){return(0,i.Z)((0,i.Z)({},n),{},{choesn:t.rightsLevel==n.rightsLevel&&r==e})}))})}));t.choesn=!0,p(n),v(t)}},b=function(){s(f),k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"rightsFloatClick",orderId:n.OrderId,spped:f.rightsLevel})},w=function(){return(0,L.jsx)(x.View,{className:"list",children:u.map((function(e,t){return(0,L.jsxs)(x.View,{className:"group",children:[(0,L.jsxs)(x.View,{className:"tit",children:[e.rightsLevelRangeName,"\u7279\u6743"]}),e.userRightsInfoList.map((function(e,t){return(0,L.jsxs)(x.View,{className:"item",onClick:function(){return g(t,e)},children:[(0,L.jsxs)(x.View,{className:"tit",children:[e.rightsLevelRangeName,"\u62a2\u7968"]}),(0,L.jsx)(x.Image,{className:"icon",src:e.rightsIcon}),(0,L.jsxs)(x.View,{className:"count",children:["\u5269\u4f59",(0,L.jsx)(x.Text,{children:e.rightsCount}),"\u6b21"]}),(0,L.jsx)(x.View,{className:it("btn",{active:e.choesn})})]},t)}))]},t)}))})};return(0,d.useEffect)((function(){a&&p(a)}),[a]),(0,L.jsxs)(Be,{visible:r,clickMaskClose:!0,close:c,children:[k.ZP.ubtTrace("s_trn_c_trace_10650072279",{bizKey:"rightsFloat",exposureType:"normal",orderId:n.orderId}),(0,L.jsxs)(x.View,{className:"rights-pop",children:[(0,L.jsxs)(x.View,{className:"rights-pop-hd",children:[(0,L.jsx)(x.View,{className:"cancel ifont-closed-line",onClick:c}),(0,L.jsx)(x.View,{className:"tit",children:"\u9009\u62e9\u62a2\u7968\u7279\u6743"}),(0,L.jsx)(x.View,{className:"done",onClick:b,children:"\u786e\u5b9a"})]}),(0,L.jsxs)(x.View,{className:"rights-pop-bd",children:[(0,L.jsxs)(x.View,{className:"tips",children:[(0,L.jsx)(x.View,{className:"icon ifont-qus"}),"\u6bcf\u7b14\u8ba2\u5355\u4ec5\u53ef\u4f7f\u75281\u6b21\u7279\u6743"]}),w()]})]})]})},ot=ct,lt=function(e){var t=e.userRights,n=e.orderInfo,r=e.updateOrder,c=e.setModuleVisible,o=(0,d.useState)([]),l=(0,C.Z)(o,2),u=l[0],h=l[1],m=(0,d.useState)(0),f=(0,C.Z)(m,2),v=f[0],b=f[1],w=(0,d.useState)(null),j=(0,C.Z)(w,2),N=j[0],I=j[1],V=(0,d.useState)(!1),y=(0,C.Z)(V,2),T=y[0],Z=y[1],S=function(){var e,r;if(t&&t.isCanUseRights&&null!==(e=t.userRightsCountList)&&void 0!==e&&e.length){var a=t.userRightsCountList.filter((function(e){var t;return e.rightsLevel>=(null===(t=n.jLDetailInfo)||void 0===t?void 0:t.lightningLevel)})).map((function(e){var t;return(0,i.Z)((0,i.Z)({},e),{},{userRightsInfoList:null===e||void 0===e||null===(t=e.userRightsInfoList)||void 0===t?void 0:t.map((function(t){return(0,i.Z)((0,i.Z)((0,i.Z)({},t),p._.pick(e,["rightsLevel","rightsLevelRangeName","rightsType","title"])),{},{choesn:!1})}))})})).sort((function(e,t){return t.rightsLevel-e.rightsLevel}))||[],s=a.reduce((function(e,t){return e+((null===t||void 0===t?void 0:t.userRightsInfoList.length)||0)}),0),c=(null===(r=a[0])||void 0===r?void 0:r.userRightsInfoList[0])||{};c.choesn=!0,b(s),h(a),I(c)}},P=function(){v>1&&Z(!0)},_=function(e){I(e),Z(!1)},D=function(){Z(!1)},F=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,s;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=(0,k.Ej)({ChangeType:16,OriginalOrderId:n.orderId,UseRightsInfoList:[p._.pick(N,["rightsLevel","rightsLevelRangeName","rightsType","sourceType","rightsName"])]}),k.ZP.showLoading(),e.next=4,(0,g.PH)(t);case 4:if(s=e.sent,0==s.result){e.next=9;break}throw k.ZP.hideLoading(),k.ZP.showModal({m:s.resultMessage||"\u52a9\u529b\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01"}),new Error(s.resultMessage||"\u52a9\u529b\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01");case 9:return e.next=11,r(n.orderId);case 11:k.ZP.hideLoading();case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,d.useEffect)((function(){c(N&&(null===t||void 0===t?void 0:t.isCanUseRights)&&v>0)}),[N,t]),(0,d.useEffect)((function(){S()}),[t,n]),(0,L.jsxs)(L.Fragment,{children:[!!N&&(null===t||void 0===t?void 0:t.isCanUseRights)&&v>0&&(0,L.jsxs)(x.View,{className:"rights-box",children:[(0,L.jsx)(x.View,{className:"tit",children:N.title}),(0,L.jsx)(x.Image,{className:"icon",src:N.rightsIcon}),(0,L.jsxs)(x.View,{className:"counts ".concat(v>1?"arrow":""),onClick:P,children:["(\u5269\u4f59",N.rightsCount,"\u6b21)"]}),(0,L.jsx)(x.View,{className:"btn",onClick:F,children:"\u4f7f\u7528"})]}),v>1&&(0,L.jsx)(ot,{visible:T,rightList:u,done:_,close:D})]})},ut=lt,dt=h().train,pt=function(e){var t=(0,d.useContext)(y),n=t.orderStates.orderInfo,r=e.visible,i=e.close,c=(0,d.useState)(0),o=(0,C.Z)(c,1),l=o[0],u=(0,d.useState)(!1),p=(0,C.Z)(u,2),f=p[0],v=p[1],b=(0,d.useState)(""),w=(0,C.Z)(b,2),j=w[0],N=w[1],I=(0,d.useState)(!1),V=(0,C.Z)(I,2),T=V[0],Z=V[1],S=(0,d.useState)([]),P=(0,C.Z)(S,2),_=P[0],D=P[1];(0,m.useShareAppMessage)((function(){var e,t=null===n||void 0===n||null===(e=n.ticketInfos)||void 0===e?void 0:e[0],r=t.arriveStation,a=h().getStorageSync("USERINFO");return(0,k.fT)({ArriveStation:r,oid:null===n||void 0===n?void 0:n.orderId,avatar:encodeURIComponent(a.avatarUrl),shareImgs:_,filterType:"time",stuFlag:dt.stuFlag})}));var F=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,g.Gl)({ConfigKey:"train_wx_robshare_shareimgs_20191219"});case 2:n=e.sent,null!==n&&void 0!==n&&null!==(t=n.ConfigInfo)&&void 0!==t&&t.Content&&(r=JSON.parse(n.ConfigInfo.Content.split(",")),D(r));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){},A=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,r,s,i,c,o;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=n.orderId,i=n.ticketInfos,c={ShareKey:s,FromStation:null===i||void 0===i||null===(t=i[0])||void 0===t?void 0:t.departStation,ToStation:null===i||void 0===i||null===(r=i[0])||void 0===r?void 0:r.arriveStation,PassagePhotoUrl:""},k.ZP.showLoading(),e.prev=3,e.next=6,(0,k.E2)(c);case 6:return o=e.sent,k.ZP.hideLoading(),N(o),e.abrupt("return",o);case 12:e.prev=12,e.t0=e["catch"](3),k.ZP.showLoading(),k.ZP.showToast("\u751f\u6210\u56fe\u7247\u5931\u8d25","none");case 16:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r,s;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=function(){Z(!0)},n=function(){k.ZP.showToast("\u4fdd\u5b58\u5931\u8d25","none")},r=function(){v(!0)},e.next=5,A();case 5:s=e.sent,console.log("ImgUrl",s),(0,k.Qu)(s,t,n,r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){},M=function(){Z(!1)};return(0,d.useEffect)((function(){F()}),[]),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(Be,{visible:r,clickMaskClose:!0,close:i,children:(0,L.jsx)(x.View,{className:"pop-share",children:(0,L.jsxs)(x.View,{className:"share-bd",children:[2!==l&&(0,L.jsxs)(x.View,{className:"item",children:[f?(0,L.jsx)(x.Button,{className:"share",openType:"openSetting",onOpenSetting:O,children:(0,L.jsx)(x.Image,{src:"//pic.c-ctrip.com/train/wechat/inviterob/icon-pyq.png"})}):(0,L.jsx)(x.Button,{className:"share",onClick:R,children:(0,L.jsx)(x.Image,{src:"//pic.c-ctrip.com/train/wechat/inviterob/icon-pyq.png"})}),(0,L.jsx)(x.View,{className:"txt",children:"\u5206\u4eab\u5230\u670b\u53cb\u5708"})]}),1!==l&&(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsx)(x.Button,{className:"share",openType:"share",onClick:B,children:(0,L.jsx)(x.Image,{src:"//pic.c-ctrip.com/train/wechat/inviterob/icon-wechat.png"})}),(0,L.jsx)(x.View,{className:"txt",children:"\u5206\u4eab\u5230\u5fae\u4fe1\u7fa4"})]})]})})}),(0,L.jsx)(Be,{visible:T,direction:"middle",clickMaskClose:!0,close:M,children:(0,L.jsxs)(x.View,{className:"pop-share-qrcode",children:[(0,L.jsx)(x.View,{className:"pop-share-qrcode-bd",children:(0,L.jsx)(x.Image,{src:j,mode:"widthFix"})}),(0,L.jsx)(x.View,{className:"info",children:"\u56fe\u7247\u5df2\u4fdd\u5b58\u81f3\u624b\u673a\uff0c\u5feb\u53bb\u5206\u4eab\u5427"}),(0,L.jsx)(x.Text,{className:"ifont-closed",onClick:M})]})})]})},ht=pt,mt=function(e){var t=e.sharedList,n=(0,d.useContext)(y),r=n.orderStates.orderInfo,a=r.freeRewardGrabInsInfo,s=r.jLDetailInfo,i=(0,d.useState)(!1),c=(0,C.Z)(i,2),o=c[0],l=c[1],u=a||{},p=u.desc,h=u.tag,m=u.couponDesc,f=u.rewardFriendsNumber,v=u.sendCouponFriendIndex,g=function(){l(!0)},b=function(){l(!1)},w=function(){return(0,L.jsxs)(x.View,{className:"grab-invite-end",children:[(0,L.jsx)(x.View,{className:"tit",children:"\u7ee7\u7eed\u5206\u4eab\uff0c\u6700\u9ad8\u514d\u8d39\u5347\u81f3 VIP\u901f\u5ea6"}),(0,L.jsxs)(x.View,{className:"grab-invite-end-bd",children:[(0,L.jsxs)(x.View,{className:"invite-list",children:[t.slice(0,4).map((function(e,t){return(0,L.jsx)(x.View,{class:"item",children:(0,L.jsx)(x.Image,{src:e.passagePhotoUrl,className:"avatar"})},t)})),t.length>4&&(0,L.jsx)(x.View,{class:"item",children:(0,L.jsx)(x.Icon,{class:"icon-slh"})}),(0,L.jsx)(x.View,{className:"item",children:(0,L.jsx)(x.Button,{className:"btn-add",onClick:g})})]}),(0,L.jsxs)(x.View,{className:"rbox",onClick:g,children:[(0,L.jsxs)(x.View,{className:"txts",children:[(0,L.jsxs)(x.Text,{children:[t.length,"\u4eba\u5df2\u52a9\u529b"]}),(0,L.jsx)(x.Text,{children:"\u5df2\u4eab\u5b89\u5fc3\u62a2"})]}),(0,L.jsx)(x.View,{className:"ifont-arr"})]})]})]})},j=function(){if(t.length<=v){if(3===f)return(0,L.jsxs)(x.View,{className:"grab-invite-blank three",children:[(0,L.jsxs)(x.View,{className:"lbox",children:[(0,L.jsx)(x.View,{className:"tag",children:"\u672c\u5355\u4e13\u4eab"}),(0,L.jsx)(x.View,{className:"tit",children:t.length>0?"\u518d\u9080".concat(f-t.length,"\u4eba\u52a9\u529b\u9886\u5b89\u5fc3\u62a2"):"\u9080".concat(f,"\u4eba\u52a9\u529b\u9886\u5b89\u5fc3\u62a2")}),(0,L.jsx)(x.View,{className:"txt",children:p})]}),(0,L.jsx)(x.View,{className:"invite-list",children:Array.from({length:f}).map((function(e,n){return(0,L.jsxs)(x.View,{class:"item",children:[n==v-1?v&&v<t.length?(0,L.jsx)(x.View,{className:"tag-orage",children:m}):!!h&&(0,L.jsx)(x.View,{className:"tag-green",children:h}):null,t.length&&n<t.length?(0,L.jsx)(x.Image,{src:t[n].passagePhotoUrl,className:"avatar"}):(0,L.jsx)(x.Button,{className:"btn-add",onClick:g}),(0,L.jsxs)(x.View,{className:"txt",children:["\u7b2c",n+1,"\u4eba"]})]},n)}))})]});if(7===f)return(0,L.jsxs)(x.View,{className:"grab-invite-blank seven",children:[(0,L.jsxs)(x.View,{className:"lbox",children:[(0,L.jsx)(x.View,{className:"tag",children:"\u672c\u5355\u4e13\u4eab"}),(0,L.jsx)(x.View,{className:"tit",children:t.length>0?"\u518d\u9080".concat(f-t.length,"\u4eba\u52a9\u529b\u9886\u5b89\u5fc3\u62a2"):"\u9080".concat(f,"\u4eba\u52a9\u529b\u9886\u5b89\u5fc3\u62a2")}),(0,L.jsx)(x.View,{className:"txt",children:p})]}),(0,L.jsxs)(x.View,{className:"invite-list",children:[Array.from({length:2}).map((function(e,n){return(0,L.jsxs)(x.View,{className:"item",children:[n===v-1&&(0,L.jsx)(x.View,{className:"tag-orage",children:m}),n<t.length?(0,L.jsx)(x.Image,{src:t[n].passagePhotoUrl,className:"avatar"}):(0,L.jsx)(x.Button,{className:"btn-add",onClick:g}),(0,L.jsxs)(x.View,{className:"txt",children:["\u7b2c",n+1,"\u4eba"]})]},n)})),(0,L.jsx)(x.View,{class:"item",children:(0,L.jsx)(x.Icon,{class:"icon-slh"})}),(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsx)(x.View,{className:"tag-green",children:h}),(0,L.jsx)(x.Button,{className:"btn-add",onClick:g}),(0,L.jsxs)(x.View,{className:"txt",children:["\u7b2c",f,"\u4eba"]})]})]})]})}else if(t.length<=f){if(3===f)return(0,L.jsxs)(x.View,{className:"grab-invite-blank three",children:[(0,L.jsxs)(x.View,{className:"lbox",children:[(0,L.jsx)(x.View,{className:"tag",children:"\u672c\u5355\u4e13\u4eab"}),(0,L.jsx)(x.View,{className:"tit",children:t.length>0?"\u518d\u9080".concat(f-t.length,"\u4eba\u52a9\u529b\u9886\u5b89\u5fc3\u62a2"):"\u9080".concat(f,"\u4eba\u52a9\u529b\u9886\u5b89\u5fc3\u62a2")}),(0,L.jsx)(x.View,{className:"txt",children:p})]}),(0,L.jsx)(x.View,{className:"invite-list",children:Array.from({length:f}).map((function(e,n){return(0,L.jsxs)(x.View,{class:"item",children:[n==f-1?!!h&&(0,L.jsx)(x.View,{className:"tag-green",children:h}):null,t.length&&n<t.length?(0,L.jsx)(x.Image,{src:t[n].passagePhotoUrl,className:"avatar"}):(0,L.jsx)(x.Button,{className:"btn-add",onClick:g}),(0,L.jsxs)(x.View,{className:"txt",children:["\u7b2c",n+1,"\u4eba"]})]},n)}))})]});if(7===f)return(0,L.jsxs)(x.View,{className:"grab-invite-doing",children:[(0,L.jsx)(x.View,{className:"lbox",children:(0,L.jsxs)(x.View,{className:"tit",children:["\u518d\u9080",(0,L.jsx)(x.View,{className:"count",children:f-t.length}),"\u4eba",p]})}),(0,L.jsx)(x.View,{className:"grab-invite-doing-bd",children:(0,L.jsx)(x.View,{className:"invite-list",children:Array.from({length:f}).map((function(e,n){return(0,L.jsxs)(x.View,{className:"item",children:[n===v-1&&(0,L.jsx)(x.View,{className:"tag-orage",children:m}),n===f-1&&(0,L.jsx)(x.View,{className:"tag-green",children:h}),n<t.length?(0,L.jsx)(x.Image,{src:t[n].passagePhotoUrl,className:"avatar"}):(0,L.jsx)(x.Button,{className:"btn-add",onClick:g}),(0,L.jsxs)(x.View,{className:"txt",children:["\u7b2c",n+1,"\u4eba"]})]},n)}))})})]})}return w()};return null!==a&&void 0!==a&&a.isOpen&&a.rewardFriendsNumber&&6!==s.lightningLevel?(0,L.jsxs)(L.Fragment,{children:[j(),(0,L.jsx)(ht,{visible:o,close:b})]}):null},ft=mt,xt=A().classnames,vt=function(e){var t=(0,d.useContext)(y),n=t.orderStates.orderInfo,r=void 0===n?{}:n,c=t.updateOrder,o=e.userRights,l=e.grabTicketChangeInfo,u=e.changeOrderPay,p=e.isCanFaceAuthentication,h=(0,d.useState)(null),m=(0,C.Z)(h,2),f=m[0],v=m[1],b=(0,d.useState)(!0),w=(0,C.Z)(b,2),j=w[0],N=w[1],I=(0,d.useState)([]),V=(0,C.Z)(I,2),k=V[0],T=V[1],Z=(0,d.useState)(!1),S=(0,C.Z)(Z,2),P=S[0],_=S[1],D=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,s,c,o,l,u,d;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=r.jLDetailInfo,n=r.orderId,t){e.next=3;break}return e.abrupt("return");case 3:return o=xe.zq.map((function(e,n){var r=n===t.lightningLevel-1;return r&&(s=e,c=0==n?8:n+1==xe.zq.length?100:n/(xe.zq.length-1)*100+5),{name:e,curr:r}})),e.next=6,(0,g.N8)({OrderNumber:n});case 6:l=e.sent,u=l.sharedAccePacketList,d=(null===u||void 0===u?void 0:u.map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{passagePhotoUrl:e.passagePhotoUrl||"https://images3.c-ctrip.com/train/activity/ctrip-wechat-orderdetail/avatar.png"})})).reverse())||[],T(d),v({speedLevels:o,speedLvlName:s,linePercent:c});case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){N(!j)};return(0,d.useEffect)((function(){D()}),[r]),(0,L.jsx)(L.Fragment,{children:!!f&&(0,L.jsxs)(x.View,{className:xt("speed-box white-box",{active:!j}),children:[(0,L.jsx)(x.View,{className:"title",children:"\u62a2\u7968\u901f\u5ea6"}),(0,L.jsx)(tt,{userRights:o,speedInfo:f,orderInfo:r,sharedList:k,grabTicketChangeInfo:l,changeOrderPay:u,updateOrder:c,isCanFaceAuthentication:p}),(0,L.jsx)(st,{}),(0,L.jsx)(ft,{sharedList:k}),(0,L.jsx)(x.View,{className:xt("block",{active:!j}),children:(0,L.jsx)(ut,{orderInfo:r,userRights:o,updateOrder:c,setModuleVisible:_})}),P&&(0,L.jsx)(x.View,{className:"push",onClick:F})]})})},gt=vt,bt=A().classnames,wt=function(){},jt=function(e){var t,n=e.isCanFaceAuthentication,r=void 0!==n&&n,i=e.setDirectShowPopKey,c=void 0===i?wt:i,o=(0,d.useContext)(y),l=o.orderStates,u=o.pageFns,p=l.orderInfo,h=l.grabShareConfig,m=(0,d.useState)(null),f=(0,C.Z)(m,2),v=f[0],b=f[1],w=(0,d.useState)(!1),j=(0,C.Z)(w,2),N=j[0],I=j[1],V=(0,d.useState)("AliApp"===Z.Z.channel),T=(0,C.Z)(V,1),S=T[0],P=function(){var e=p.ticketInfos,t=p.userInfo,n=p.orderId;u.navigateTo({url:"/pages/train/inviterob/inviterob",data:{oid:n,astation:e[0].arriveStation,dstation:e[0].departStation,orderMobile:t.contactMobileAES,isCanFaceAuthentication:r}})},_=function(){c("activation")},D=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,g.Z8)("train_wx_grab_bottom_btn_tag");case 2:t=e.sent,b(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,g.ZT)({FromType:1});case 2:t=e.sent,1===t.retCode&&I(t.isSupermember);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,d.useEffect)((function(){p&&(D(),F())}),[p]),S?null:(0,L.jsx)(x.View,{className:"fixed-botm",children:(0,L.jsxs)(x.View,{className:"btn-flex",children:[(0,L.jsx)(x.Button,{className:"btn-linblue",onClick:function(){return(0,k._E)(p.orderId)},children:"\u4fee\u6539\u4efb\u52a1"}),6!==(null===(t=p.jLDetailInfo)||void 0===t?void 0:t.lightningLevel)||p.isNeedActivateVipRights?(0,L.jsx)(L.Fragment,{children:p.isNeedActivateVipRights?(0,L.jsx)(x.Button,{className:"btn-linorage",onClick:_,children:"\u6fc0\u6d3bVIP\u62a2\u7968"}):null!==h&&void 0!==h&&h.closeOrderBottomShare?null:(0,L.jsxs)(x.Button,{className:bt("btn-linorage",{vip:N&&!p.isUserSuperMember}),onClick:P,children:["\u514d\u8d39\u52a9\u529b",v&&v.helpBTnTag&&(0,L.jsx)(x.Text,{className:"tag",children:v&&v.helpBTnTag})]})}):null]})})},Nt=jt,It=A().dayjs,Vt=A().classnames,kt=function(){},yt=function(e){e.setDirectShowPopKey;var t=e.forecastInfo,n=void 0===t?{}:t,r=e.hbInfo,c=void 0===r?{}:r,o=e.setHbOrderCancelInfo,l=void 0===o?kt:o,u=e.hbOrderCancelInfo,p=void 0===u?{}:u,m=e.pushScanFaceResult,f=void 0===m?kt:m,v=(0,d.useContext)(y),b=v.updateOrder,w=void 0===b?kt:b,j=v.orderStates,N=(v.setState,v.pageFns),I=void 0===N?{}:N,V=j.orderInfo,T=j.extendValues,Z=void 0===T?{}:T,S=(j.protocalToogle,Z.recommendsalegrabinscanceltips),P=(0,d.useRef)(null),_=(0,d.useState)(!1),D=(0,C.Z)(_,2),F=D[0],O=D[1],A=(0,d.useState)(""),R=(0,C.Z)(A,2),B=R[0],M=R[1],G=(0,d.useState)({}),U=(0,C.Z)(G,2),z=U[0],E=U[1],K=(0,d.useState)(0),H=(0,C.Z)(K,2),q=H[0],W=H[1];(0,d.useEffect)((function(){F||M("")}),[F]),(0,d.useEffect)((function(){B&&k.ZP.ubtDevTrace("train_tinyapp_dev_log",{bizKey:"grabdetail_pop_show_pop_key",value:{popType:B,tSource:"cancel_grab_btn_component_pop"}})}),[B]);var Y=function(){h().navigateTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent("https://m.ctrip.com/webapp/train/activity/orderservice/InsuranceDetail.aspx?ProductID=2007&terminal=1"),"&title=").concat(encodeURIComponent("\u706b\u8f66\u7968\u670d\u52a1\u534f\u8bae"))})},J=function(){if(4!==p.cancelFailResultCode||P.current.checkProto()){O(!1);var e=p.cancelFailResultCode,t=p.userName12306,n=p.mobilePhone12306;switch(+e){case 1:(0,k.L5)({from:"orderdetail",userId12306:t,traceFrom:"hbOrderCancel"}).then((0,s.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,w(V.orderId);case 2:setTimeout((function(){return k.ZP.showToast("\u8bf7\u91cd\u65b0\u53d6\u6d88\u8ba2\u5355","none")}),1e3);case 3:case"end":return e.stop()}}),e)}))),(function(){setTimeout((function(){return k.ZP.showToast("\u8bf7\u7a0d\u540e\u518d\u8bd5","none")}),1e3)}));break;case 3:w(V.orderId);break;case 4:I.navigateTo({url:"/pages/train/face/face?fromType=4&userName=".concat(t),callback:function(e){console.log("i'm back from facepage",e);var t=function(){var t=e&&1==e.certificationResultCode;f(t,0,7).then((0,s.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,w(V.orderId);case 2:k.ZP.showToast(t?"\u8bf7\u91cd\u65b0\u53d6\u6d88\u8ba2\u5355":"\u8bf7\u7a0d\u540e\u91cd\u8bd5","none");case 3:case"end":return e.stop()}}),e)}))))};setTimeout((function(){t()}),500)}});break;case 6:var r="".concat(k.OP,"webapp/train/activity/ctrip-train-12306/#/verify?mobile=").concat(n||"\u60a8\u7684\u4e0b\u5355\u624b\u673a","&userName=").concat(t,"&userID12306=").concat(t);I.navigateTo({url:"/pages/trainActivity/twebview/index",data:{url:r,bridgeIns:function(e){console.log("TRN PROPS gotten",e.detail.data);var t=(0,C.Z)(e.detail.data,1),n=t[0].unRisk,r=void 0!==n&&n;setTimeout((function(){f(r,1,7).then((0,s.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,w(V.orderId);case 2:k.ZP.showToast(r?"\u8bf7\u91cd\u65b0\u53d6\u6d88\u8ba2\u5355":"\u8bf7\u7a0d\u540e\u91cd\u8bd5","none");case 3:case"end":return e.stop()}}),e)}))))}),500)},needLogin:!0}});break;default:k.ZP.showToast("\u8bf7\u524d\u5f80\u624b\u673a\u643a\u7a0b\u53d6\u6d88","none");break}}else k.ZP.showToast("\u8bf7\u9605\u8bfb\u5e76\u52fe\u9009\u534f\u8bae","none")},Q=function(){return new Promise((function(e,t){var n={OrderNumber:V.orderId,hBOrderNumber:c.hBOrderNumber||""},r=function(){var i=(0,s.Z)((0,a.Z)().mark((function s(){var i;return(0,a.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,g.bA)(n);case 2:i=a.sent,1==i.cancelResult?e(i):2==i.cancelResult?t(i):3==i.cancelResult?(n.PollingKey=i.pollingKey,setTimeout(r,1e3*i.rate||2e3)):t(i);case 4:case"end":return a.stop()}}),s)})));return function(){return i.apply(this,arguments)}}();r()}))},X=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={orderId:V.orderId,oid:V.orderId},e.prev=1,e.next=4,(0,g.ok)(t);case 4:n=e.sent,k.ZP.hideLoading(),n.retMessage?k.ZP.showModal({m:n.retMessage,done:function(){}}):h().navigateTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent("https://m.ctrip.com/webapp/train/cancelRob?oid=".concat(V.orderId,"&fromminiapp=1")),"&bgColor=19A0F0")}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),k.ZP.showModal({m:"\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002",done:function(){}});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),k.ZP.showLoading(),n=!1,e.next=5,(0,g.c1)({OrderNumber:V.orderId});case 5:if(r=e.sent,r.hBTicketList&&r.hBTicketList.length&&c.hBOrderNumber&&(n=!0),k.ZP.ubtDevTrace("train_tinyapp_dev_log",{bizKey:"grabdetail_pop_show_pop_key",value:{isHBOpenedOrder:n,tSource:"cancel_grab_btn_component_ishbopenedorder"}}),k.ZP.ubtTrace("c_tra_cancel_rob_order_applets",{partner:"Ctrip.Train",userid:h().user.duid||"",orderId:"".concat(V.orderId),cancelTime:It().format("YYYY-MM-DD HH:mm:ss"),cancelTrainInfo:JSON.stringify({trainNumber:V.jLDetailInfo.jLAllTrainNumbers,departDateTime:"".concat(V.ticketInfos[0].departDate," ").concat(V.ticketInfos[0].departTime,":00"),arriveDateTime:"".concat(V.ticketInfos[0].arriveDate," ").concat(V.ticketInfos[0].arriveTime,":00"),departStation:V.ticketInfos[0].departStation,arriveStation:V.ticketInfos[0].arriveStation,seatName:V.jLDetailInfo.jLAllSeatNames})}),V.canPreCancelWaitlist){e.next=11;break}return e.abrupt("return",t());case 11:n?Q().then(t).catch((function(e){k.ZP.ubtDevTrace("train_tinyapp_dev_log",{bizKey:"grabdetail_pop_show_pop_key",value:{res:e,tSource:"cancel_grab_btn_component_cancelhbfail"}}),k.ZP.hideLoading();var t=e.cancelFailResultCode,n=e.extendInfoList,r=void 0===n?[]:n,a=e.cancelFailResultTitle,s=e.cancelFailResultContent,c={cancelFailResultCode:t};null===r||void 0===r||r.forEach((function(e){c[e.key]=e.value})),l((0,i.Z)({cancelFailResultTitle:a,cancelFailResultContent:s},c)),O(!0),M("hbcancelFail")})):t();case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(){var e=parseInt(It().format("YYYYMMDDHHmmss")),t=parseInt(n&&n.startObj&&n.startObj.datePoint),r=parseInt(n&&n.keyObj&&n.keyObj.datePoint);W(t>r?1:e<r?2:3)},ee=function(){if(V.isBuyGrabIns)O(!0),M("cancelReassuring");else if("N"===V.jLDetailInfo.jLOrderStatus||It(+(0,k.Xz)(V.jLDetailInfo.jLBeginDateTime)).isAfter(It())){var e=+It(+(0,k.Xz)(V.jLDetailInfo.jLBeginDateTime))-+It();E({jlD:Math.floor(e/864e5),jlH:Math.floor(e/36e5)}),O(!0),M("ordercancelnotstart")}else try{$(),O(!0),M("ordercancelgrab")}catch(e){k.ZP.showModal({m:"\u786e\u5b9a\u53d6\u6d88\u8ba2\u5355\u5417\uff1f",confirmText:"\u786e\u5b9a",done:function(e){e.confirm&&X()}})}};return V.orderCanCancel?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(x.View,{className:"white-box qp-btnbox",children:(0,L.jsx)(x.Button,{className:"btn-cancel","hover-className":"btn-cancel_hover",onClick:ee,children:"\u53d6\u6d88\u8ba2\u5355"})}),(0,L.jsxs)(Be,{visible:F,close:function(){O(!1)},direction:"middle",clickMaskClose:!0,children:["cancelReassuring"===B&&(0,L.jsxs)(x.View,{className:"cancel-reassuring",children:[(0,L.jsx)(x.View,{className:"tit",children:"\u6b63\u5728\u4e3a\u60a8\u76d1\u63a7\u5019\u8865\u548c\u4f59\u7968"}),(0,L.jsx)(x.View,{className:"sub-tit",children:"\u60a8\u5df2\u8d2d\u4e70\u201c\u5b89\u5fc3\u62a2\u201d\uff0c\u62a2\u7968\u622a\u6b62\u65f6\u95f4\u524d\u53d6\u6d88\u8ba2\u5355\u5c06\u4e0d\u9000\u56de\u5b89\u5fc3\u62a2\u4ea7\u54c1\u8d39\u7528\uff0c\u5efa\u8bae\u60a8\u8010\u5fc3\u7b49\u5f85\uff0c\u540e\u7eed\u4ecd\u6709\u8f83\u591a\u653e\u7968\u673a\u4f1a"}),(0,L.jsxs)(x.View,{className:"btn-list",children:[(0,L.jsx)(x.View,{className:"btn-white",onClick:function(){O(!1)},children:"\u518d\u60f3\u60f3"}),(0,L.jsx)(x.View,{className:"btn-blue",onClick:function(){O(!1),X()},children:"\u53d6\u6d88\u8ba2\u5355"})]})]}),"ordercancelnotstart"===B&&(0,L.jsxs)(x.View,{className:"pop-qiangpiao",children:[z.jlD<1&&z.jlH>0?(0,L.jsx)(x.Image,{src:"https://pic.c-ctrip.com/train/wechat/pop-top-miaosha.png",className:"img",mode:"widthFix"}):(0,L.jsx)(x.Image,{src:"https://pic.c-ctrip.com/train/wechat/pop-top-kaishou.png",className:"img",mode:"widthFix"}),z.jlD<1&&z.jlH>0?(0,L.jsxs)(x.View,{children:[(0,L.jsx)(x.View,{className:"tit",children:"\u5373\u5c06\u4e3a\u60a8\u79d2\u6740\u8f66\u7968"}),(0,L.jsx)(x.View,{className:"txt",children:"\u6240\u9009\u65b9\u6848\u8f66\u6b21\u5c31\u8981\u5f00\u552e\u4e86\uff0c\u73b0\u5728\u53d6\u6d88\u5c06\u9519\u8fc7\u5927\u91cf\u8f66\u7968"})]}):(0,L.jsxs)(x.View,{children:[(0,L.jsx)(x.View,{className:"tit",children:"\u5c06\u8981\u4e3a\u60a8\u79d2\u6740\u8f66\u7968"}),(0,L.jsx)(x.View,{className:"txt",children:"\u6240\u9009\u8f66\u6b21\u8fd8\u672a\u5f00\u552e\uff0c\u6211\u4eec\u5c06\u81ea\u52a8\u4e3a\u60a8\u76d1\u63a7\uff0c\u5f00\u552e\u540e\u81ea\u52a8\u79d2\u6740"})]}),(0,L.jsxs)(x.View,{className:"pop-qiangpiao-btn",children:[(0,L.jsx)(x.Button,{className:"btn-cancel",onClick:function(){O(!1),X()},children:"\u72e0\u5fc3\u53d6\u6d88"}),(0,L.jsx)(x.Button,{className:"btn-submit",onClick:function(){O(!1)},children:"\u7ee7\u7eed\u7b49\u5f85"})]}),(0,L.jsx)("text",{className:"ifont-closed",onClick:function(){O(!1)}})]}),"ordercancelgrab"===B&&(0,L.jsxs)(x.View,{className:"pop-qiangpiao",children:[S?(0,L.jsx)(x.Image,{src:"https://pic.c-ctrip.com/train/wechat/pop-top-jiankong.png",className:"img",mode:"widthFix"}):(0,L.jsx)(x.Image,{src:"https://pic.c-ctrip.com/train/wechat/pop-top-tishi.png",className:"img",mode:"widthFix"}),S?(0,L.jsxs)(x.View,{children:[(0,L.jsx)(x.View,{className:"tit",children:S.title}),(0,L.jsx)(x.View,{className:"txt",children:S.content})]}):(0,L.jsxs)(L.Fragment,{children:[1===q&&(0,L.jsxs)(x.View,{children:[(0,L.jsx)(x.View,{className:"tit",children:"\u6b63\u503c\u653e\u7968\u9ad8\u5cf0\u671f"}),(0,L.jsx)(x.View,{className:"txt",children:"\u5f53\u524d\u4e3a\u653e\u7968\u9ad8\u5cf0\u671f\uff0c\u5230\u53d1\u8f66\u524d\u8fd8\u6709\u8f83\u591a\u653e\u7968\u673a\u4f1a\uff0c\u518d\u7b49\u4f1a\u513f\u53ef\u80fd\u5c31\u62a2\u5230\u7968\u4e86\uff01"})]}),2===q&&(0,L.jsxs)(x.View,{children:[(0,L.jsx)(x.View,{className:"tit",children:"\u6b63\u503c\u653e\u7968\u9ad8\u5cf0\u671f"}),(0,L.jsxs)(x.View,{className:"txt",children:["\u6b63\u503c\u653e\u7968\u9ad8\u5cf0\u671f ",n.keyObj.date_md," ","\u4e4b\u540e\u653e\u7968\u6982\u7387\u9ad8\uff0c\u518d\u8010\u5fc3\u7b49\u5f85\u5427\uff01"]})]}),3===q&&(0,L.jsxs)(x.View,{children:[(0,L.jsx)(x.View,{className:"tit",children:"\u6b63\u503c\u653e\u7968\u9ad8\u5cf0\u671f"}),(0,L.jsx)(x.View,{className:"txt",children:"\u5f53\u524d\u4e3a\u653e\u7968\u9ad8\u5cf0\u671f\uff0c\u5230\u53d1\u8f66\u524d\u8fd8\u6709\u8f83\u591a\u653e\u7968\u673a\u4f1a\uff0c\u518d\u7b49\u4f1a\u513f\u53ef\u80fd\u5c31\u62a2\u5230\u7968\u4e86\uff01"})]})]}),S?(0,L.jsx)(x.View,{className:"pop-qiangpiao-btn",children:S.buttonList.map((function(e,t){return(0,L.jsxs)(x.View,{children:[0===t&&(0,L.jsxs)(x.Button,{className:Vt("btn-cancel",{"btn-2line":e.buttonSubTitle}),onClick:function(){O(!1),X()},children:[e.buttonName,(0,L.jsxs)(x.Text,{className:"t",children:["(",e.buttonSubTitle,")"]})]}),1===t&&(0,L.jsx)(x.Button,{className:"btn-submit",onClick:function(){O(!1)},children:e.buttonName})]},t)}))}):(0,L.jsxs)(x.View,{className:"pop-qiangpiao-btn",children:[(0,L.jsx)(x.Button,{className:"btn-cancel",onClick:function(){O(!1),X()},children:"\u72e0\u5fc3\u53d6\u6d88"}),(0,L.jsx)(x.Button,{className:"btn-submit",onClick:function(){O(!1)},children:"\u518d\u62a2\u4f1a\u513f"})]}),(0,L.jsx)(x.Text,{className:"ifont-closed",onClick:function(){O(!1)}})]}),"hbcancelFail"===B&&(0,L.jsxs)(x.View,{className:"pop-modal-blue pop-checktips",children:[(0,L.jsx)(x.Icon,{className:"icon-tips",style:"background: url('https://pic.c-ctrip.com/train/wechat/icon-checktips.png');background-size: 100% 100%;"}),(0,L.jsx)(x.View,{className:"tit",children:p.cancelFailResultTitle}),(0,L.jsx)(x.View,{className:"item",children:p.cancelFailResultContent}),(0,L.jsx)(x.View,{className:"btn-box",children:[1,3,4,6].includes(p.cancelFailResultCode)?(0,L.jsxs)(L.Fragment,{children:[1===p.cancelFailResultCode&&(0,L.jsx)(x.Button,{className:"btn-submit",onClick:J,style:"font-size: 34rpx;",children:"\u7acb\u5373\u767b\u5f55"}),3===p.cancelFailResultCode&&(0,L.jsx)(x.Button,{className:"btn-submit",onClick:J,style:"font-size: 34rpx;",children:"\u67e5\u770b\u8ba2\u5355\u8be6\u60c5"}),(4===p.cancelFailResultCode||6===p.cancelFailResultCode)&&(0,L.jsxs)(x.Button,{className:"btn-submit",onClick:J,style:"font-size: 34rpx;",children:[4===p.cancelFailResultCode?"\u540c\u610f\u534f\u8bae\u5e76":"","\u7acb\u5373\u6838\u9a8c"]})]}):(0,L.jsx)(x.Button,{className:"btn-submit",onClick:function(){O(!1)},style:"font-size: 34rpx;",children:"\u786e\u5b9a"})}),4===p.cancelFailResultCode?(0,L.jsx)(le,{ref:P}):(0,L.jsxs)(x.View,{className:"tip",children:["\u5f00\u59cb\u6838\u9a8c\u4ee3\u8868\u5df2\u9605\u8bfb\u5e76\u540c\u610f",(0,L.jsx)(x.Text,{className:"tblue",onClick:Y,children:"\u706b\u8f66\u7968\u670d\u52a1\u534f\u8bae"})]}),(0,L.jsx)(x.Text,{className:"ifont-closed",onClick:function(){O(!1)}})]})]})]}):null},Tt=yt,Zt=function(){},St=function(e){var t=e.hbInfo,n=void 0===t?null:t,r=e.bindAccountInfo,i=void 0===r?null:r,c=e.isCanFaceAuthentication,o=void 0!==c&&c,l=e.singleToDouble,u=void 0===l?Zt:l,p=e.setDirectShowPopKey,m=void 0===p?Zt:p,f=e.setDetailPopVisible,v=void 0===f?Zt:f,g=e.HBAisleInfo,b=void 0===g?null:g,w=(0,d.useContext)(y),j=w.orderStates,N=j.orderInfo,I=(j.updateOrder,function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r,s,i,c,o,l,d;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,k.L5)({from:"orderdetail",push:3,traceFrom:"hbTab"});case 2:t=e.sent,n=(0,C.Z)(t,1),r=n[0],s=r.userName,i=void 0===s?"":s,c=r.loginPW,o=void 0===c?"":c,l=r.activateSuccess,d=void 0!==l&&l,d&&u(),(0,k.rP)(i,o,-1,N);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),V=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=i.status,o||![20,30,40].includes(+t)){e.next=4;break}return k.ZP.jumpToUrl("https://pages.ctrip.com/ztrip/market/12306active/?__ares_maxage=3m&autoawaken=close&popup=close&isRob=1"),e.abrupt("return");case 4:e.t0=+t,e.next=10===e.t0?7:20===e.t0?10:30===e.t0?13:40===e.t0?16:99===e.t0?19:22;break;case 7:return k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"alternateChannelClick",scene:3}),u(),e.abrupt("break",24);case 10:return k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"alternateChannelClick",scene:1}),m("scanFaceActive"),e.abrupt("break",24);case 13:return k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"alternateChannelClick",scene:2}),m("scanFaceCheck"),e.abrupt("break",24);case 16:return k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"alternateChannelClick",scene:2}),m("scanFaceCheck"),e.abrupt("break",24);case 19:return k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"alternateChannelClick",scene:0}),I(),e.abrupt("break",24);case 22:return k.ZP.jumpToUrl("https://pages.ctrip.com/ztrip/market/12306active/?__ares_maxage=3m&autoawaken=close&popup=close&isRob=1"),e.abrupt("break",24);case 24:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(e){return!!e&&(e.indexOf("\u6392\u961f\u8fdb\u5ea6")>-1||e.indexOf("\u5019\u8865\u89c4\u5219")>-1)},Z=function(e){var t=n.state;k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"alternateGrabChannelClick",orderId:N.orderId,scene:t}),e.indexOf("\u5019\u8865\u89c4\u5219")>-1&&k.ZP.jumpToUrl("https://pages.c-ctrip.com/ztrip/ctripapp/pages/houbu_rules_order_detail.html"),e.indexOf("\u6392\u961f\u8fdb\u5ea6")>-1&&v(!0)},S=function(){var e=n.state;switch(k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"alternateGrabChannelClick",orderId:N.orderId,scene:e}),e){case 1:V();break;case 3:h().train.orderInfo=N;var t="https://m.ctrip.com/webapp/train/modifyOrder?orderId=".concat(N.orderId,"&fromminiapp=1&bgColor=19A0F0");k.ZP.jumpToUrl(t);break;case 8:I();break;case 11:I();break;default:break}};return n?(0,L.jsx)(x.View,{children:b&&(0,L.jsxs)(x.View,{className:"grab-monitor-bd grab-houbu",children:[b.backgroundColor?(0,L.jsxs)(x.View,{className:"status",style:{backgroundColor:b.backgroundColor},children:[b.icon&&(0,L.jsx)(x.Icon,{className:"icon-wait",style:{backgroundImage:"url(".concat(b.icon,")")}}),(0,L.jsx)(x.RichText,{nodes:b.title||"",className:"t"})]}):(0,L.jsxs)(x.View,{className:"tit",children:[b.icon&&(0,L.jsx)(x.Icon,{className:"icon-warn",style:{backgroundImage:"url(".concat(b.icon,")")}}),b.title||""]}),b.content&&(0,L.jsx)(x.View,{className:"txt",onClick:function(){Z(b.content)},children:(0,L.jsx)(x.RichText,{nodes:"".concat(b.content).concat(T(b.content)?'<span class="ifont-arr"></span>':"")})}),b.buttonName&&(0,L.jsx)(x.Button,{className:"btn-blue btn-submit",onClick:S,children:b.buttonName})]})}):(0,L.jsx)(L.Fragment,{})},Ct=St,Pt=A().dayjs,Lt=A().classnames,_t=function(){},Dt={0:"tag-blue",1:"tag-green",2:"tag-orage"},Ft=null,Ot=0,At=function(e){var t=e.grabLogInfoList,n=void 0===t?[]:t,r=e.changeOrderRedirect,i=void 0===r?_t:r,c=e.changeOrderPay,o=void 0===c?_t:c,l=e.setDirectShowPopKey,u=void 0===l?_t:l,p=(0,d.useContext)(y),h=p.orderStates,m=h.orderInfo,f=(0,d.useState)(-1),v=(0,C.Z)(f,2),b=v[0],w=v[1],j=(0,d.useState)(!1),N=(0,C.Z)(j,2),I=N[0],V=N[1],T=(0,d.useState)(0),Z=(0,C.Z)(T,2),S=Z[0],P=Z[1],_=(0,d.useState)(""),D=(0,C.Z)(_,2),F=D[0],O=D[1],A=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(t){var n,r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(V(!1),n=null,k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"grabLogClick",orderId:m.orderId,logType:t.type,subType:t.subType}),4===t.subType&&(n=(0,k.Ej)({OriginalOrderId:m.orderId,ChangeType:17,SeatNames:t.cardInfo.seatName,TrainNumbers:t.cardInfo.trainNumber})),1===t.subType&&m.ticketInfos&&m.ticketInfos[0]&&m.ticketInfos[0].seatName&&(n=(0,k.Ej)({OriginalOrderId:m.orderId,ChangeType:17,SeatNames:m.ticketInfos[0].seatName,TrainNumbers:t.cardInfo.trainNumber})),2!==t.subType&&3!==t.subType||(n=(0,k.Ej)({OriginalOrderId:m.orderId,ChangeType:17,CrossStationGrabTicketList:[{originDepartStation:t.cardInfo.departStation,originArriveStation:t.cardInfo.arriveStation,recommendArriveStation:1===t.cardInfo.crossInfo.crossType?t.cardInfo.arriveStation:t.cardInfo.crossInfo.crossStation,recommendArriveType:1===t.cardInfo.crossInfo.crossType?0:t.cardInfo.crossInfo.crossOffset,recommendDepartType:1!==t.cardInfo.crossInfo.crossType?0:t.cardInfo.crossInfo.crossOffset,recommendDepartStation:1!==t.cardInfo.crossInfo.crossType?t.cardInfo.departStation:t.cardInfo.crossInfo.crossStation}],GrabLogInfo:{LogType:t.type,PlanType:t.subType}})),8===t.type&&(n=(0,k.Ej)({OriginalOrderId:m.orderId,ChangeType:17,AppendList:t.cardInfo.trainAppendProductList.map((function(e){return{AppendID:e.appendID,AppendCount:e.defaultNum}}))})),7!==t.type){e.next=10;break}return u("intelligentRecommend"),e.abrupt("return");case 10:if(n){e.next=12;break}return e.abrupt("return");case 12:return k.ZP.showLoading(),e.next=15,(0,g.PH)(n);case 15:if(r=e.sent,k.ZP.hideLoading(),0===r.result){e.next=20;break}return k.ZP.showToast(r.resultMessage||"\u8bf7\u7a0d\u540e\u91cd\u8bd5","none"),e.abrupt("return");case 20:if(0!==r.changeOrderAmount){e.next=23;break}return i("\u606d\u559c\uff0c\u8ba2\u5355\u4fee\u6539\u6210\u529f"),e.abrupt("return");case 23:k.ZP.showModal({title:"\u6e29\u99a8\u63d0\u793a",m:"\u60a8\u7684\u8ba2\u5355\u9700\u8981\u8865".concat(r.changeOrderAmount,"\u5143\u5dee\u4ef7\uff0c\u8bf7\u60a8\u572810\u5206\u949f\u5185\u8fdb\u884c\u652f\u4ed8\uff0c\u5426\u5219\u60a8\u7684\u4fee\u6539\u5c06\u5931\u6548\u3002\u5982\u6709\u5dee\u4ef7\u9000\u6b3e\uff0c\u4f1a\u5728\u51fa\u7968\u540e1~3\u5929\u5185\u9000\u56de\u60a8\u7684\u539f\u652f\u4ed8\u8d26\u6237\u3002"),confirmText:"\u53bb\u652f\u4ed8",showCancel:!1,done:function(){o(r)}});case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(e){V(!0),w(e),setTimeout((function(){O("log-item-scroll-".concat(e))}),400)},B=function(){V(!0),k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"monitorGrabChannelClick",orderId:m.orderId})};(0,d.useEffect)((function(){return n.length>2?Ft=setInterval((function(){Ot++,P(-60*Ot),Ot===n.length+1&&(Ot=0,P(0),setTimeout((function(){Ot++,P(-60*Ot)}),500))}),1500):(Ot=0,P(0),clearInterval(Ft)),function(){clearInterval(Ft),Ot=0}}),[n]);var M=(0,L.jsx)(L.Fragment,{children:n.map((function(e,t){return(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsxs)(x.View,{className:"lbox",children:[(0,L.jsx)(x.View,{class:"s",children:Pt(e.logDateTime).format("MM-DD")}),(0,L.jsx)(x.View,{class:"s",children:Pt(e.logDateTime).format("HH:mm")})]}),(0,L.jsx)(x.View,{className:"cont",children:(0,L.jsx)(x.View,{class:"txt",children:e.title})}),(0,L.jsx)(x.View,{className:"rbox",onClick:function(){R(t)},children:"\u8be6\u60c5"})]},t)}))}),G=function(e){var t=e.item,n=void 0===t?null:t;return(0,L.jsxs)(x.View,{className:"log-ticket",children:[(0,L.jsx)(x.View,{className:"tag-list",children:n.cardInfo.tagInfoList&&n.cardInfo.tagInfoList.length&&n.cardInfo.tagInfoList.map((function(e,t){return(0,L.jsxs)(x.View,{className:Dt[e.styleCode],children:[1===e.styleCode&&(0,L.jsx)(x.Text,{className:"ifont-gou"}),2===e.styleCode&&(0,L.jsx)(x.Text,{className:"ifont-info"}),e.tagDesc]},t)}))}),n.cardInfo.departDate&&(0,L.jsxs)(x.View,{className:"date",children:[Pt(n.cardInfo.departDate).format("MM\u6708DD\u65e5")," ",n.cardInfo.weekDay,"\u51fa\u53d1"]}),n.cardInfo.crossInfo&&n.cardInfo.crossInfo.crossType>0&&(0,L.jsxs)(x.View,{className:"fromto",children:[1===n.cardInfo.crossInfo.crossType&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(x.View,{className:"lst",children:[(0,L.jsx)(x.View,{className:"time",children:n.cardInfo.crossInfo.crossTime}),(0,L.jsx)(x.View,{className:"station",children:n.cardInfo.crossInfo.crossStation})]}),(0,L.jsxs)(x.View,{className:"kuazhan",children:[(0,L.jsx)(x.View,{className:"checi",children:n.cardInfo.trainNumber}),(0,L.jsxs)(x.View,{className:"status",children:["\u591a\u62a2",n.cardInfo.crossInfo.crossOffset,"\u7ad9"]})]})]}),(0,L.jsxs)(x.View,{className:"lst",children:[(0,L.jsx)(x.View,{className:"time",children:n.cardInfo.departTime}),(0,L.jsx)(x.View,{className:"station",children:n.cardInfo.departStation})]}),(0,L.jsx)(x.View,{className:"line"}),2===n.cardInfo.crossInfo.crossType&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(x.View,{className:"lst",children:[(0,L.jsx)(x.View,{className:"time",children:n.cardInfo.crossInfo.crossTime}),(0,L.jsx)(x.View,{className:"station",children:n.cardInfo.crossInfo.crossStation})]}),(0,L.jsxs)(x.View,{className:"kuazhan",children:[(0,L.jsx)(x.View,{className:"checi",children:n.cardInfo.trainNumber}),(0,L.jsxs)(x.View,{className:"status",children:["\u5c11\u62a2",Math.abs(n.cardInfo.crossInfo.crossOffset),"\u7ad9"]})]})]}),(0,L.jsxs)(x.View,{className:"lst",children:[(0,L.jsx)(x.View,{className:"time",children:n.cardInfo.arriveTime}),(0,L.jsx)(x.View,{className:"station",children:n.cardInfo.arriveStation})]}),3===n.cardInfo.crossInfo.crossType&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(x.View,{className:"kuazhan",children:[(0,L.jsx)(x.View,{className:"checi",children:n.cardInfo.trainNumber}),(0,L.jsxs)(x.View,{className:"status",children:["\u591a\u62a2",n.cardInfo.crossInfo.crossOffset,"\u7ad9"]})]}),(0,L.jsxs)(x.View,{className:"lst",children:[(0,L.jsx)(x.View,{className:"time",children:n.cardInfo.crossInfo.crossTime}),(0,L.jsx)(x.View,{className:"station",children:n.cardInfo.crossInfo.crossStation})]})]})]}),n.cardInfo.crossInfo&&0===n.cardInfo.crossInfo.crossType&&(0,L.jsxs)(x.View,{className:"fromto",children:[(0,L.jsxs)(x.View,{className:"lst",children:[(0,L.jsx)(x.View,{className:"time",children:n.cardInfo.departTime}),(0,L.jsx)(x.View,{className:"station",children:n.cardInfo.departStation})]}),(0,L.jsxs)(x.View,{className:"mid",children:[(0,L.jsx)(x.View,{className:"checi",children:n.cardInfo.trainNumber}),(0,L.jsx)(x.Icon,{className:"icon-fromto"})]}),(0,L.jsxs)(x.View,{className:"lst",children:[(0,L.jsx)(x.View,{className:"time",children:n.cardInfo.arriveTime}),(0,L.jsx)(x.View,{className:"station",children:n.cardInfo.arriveStation})]})]}),!n.cardInfo.isAdd&&(0,L.jsxs)(x.View,{className:"botm-info",children:[(0,L.jsx)(x.View,{className:"cont",children:"\u6dfb\u52a0\u81f3\u5907\u9009\u65b9\u6848\uff0c\u63d0\u9ad8\u62a2\u7968\u6210\u529f\u7387"}),(0,L.jsxs)(x.Button,{className:"btn-blue btn-add",onClick:function(){A(n)},children:[(0,L.jsx)(x.Icon,{className:"icon-add"}),"\u6dfb\u52a0"]})]}),n.cardInfo.isAdd&&(0,L.jsx)(x.View,{className:"botm-info",children:n.cardInfo.addDesc&&(0,L.jsx)(x.View,{className:"log-add",children:(0,L.jsxs)(x.View,{className:"l",children:[(0,L.jsx)(x.Text,{className:"ifont-gou"}),n.cardInfo.addDesc]})})})]})};return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(x.View,{className:"grab-monitor-bd grab-yupiao",style:"",children:[(0,L.jsx)(x.View,{className:Lt("grab-yupiao-bd",{two:2==n.length,more:n.length>2}),children:(0,L.jsx)(x.View,{style:{transform:"translateY(".concat(S,"rpx)"),transition:"all ".concat(0===S?"0":".5","s")},children:n.length>2?(0,L.jsxs)(L.Fragment,{children:[M,M]}):(0,L.jsx)(L.Fragment,{children:M})})}),(0,L.jsxs)(x.View,{className:"grab-yupiao-more",onClick:B,children:["\u67e5\u770b\u5168\u90e8",(0,L.jsx)(x.Text,{className:"ifont-arr"})]})]}),(0,L.jsx)(Be,{visible:I,close:function(){V(!1)},clickMaskClose:!0,children:(0,L.jsxs)(x.View,{className:"pop-grab-log",children:[(0,L.jsxs)(x.View,{className:"pop-botm-hd",children:[(0,L.jsx)(x.Text,{className:"ifont-closed-line",onClick:function(){V(!1)}}),(0,L.jsx)(x.View,{className:"tit",children:"\u62a2\u7968\u65e5\u5fd7"})]}),(0,L.jsxs)(x.ScrollView,{className:"pop-log-bd",scrollY:!0,scrollIntoView:F,children:[k.ZP.ubtTrace("s_trn_c_trace_10650072279",{exposureType:"actionbar",bizKey:"grabLog",orderId:m.orderId,logType:n.map((function(e){return e.type}))}),(0,L.jsx)(x.View,{className:"pop-log-list",children:n.map((function(e,t){return(0,L.jsxs)(x.View,{className:"item",id:"log-item-scroll-".concat(t),children:[(0,L.jsxs)(x.View,{className:"label",children:[Pt(e.logDateTime).format("MM-DD")," ",Pt(e.logDateTime).format("HH:mm")]}),6===e.type&&(0,L.jsxs)(x.View,{className:"tag-miss",children:[(0,L.jsx)(x.Icon,{className:"icon-miss"}),"\u9519\u8fc7\u4e86"]}),(0,L.jsxs)(x.View,{className:"log-txt",children:[(0,L.jsx)(x.View,{className:"cont",children:e.title}),e.cardInfo&&e.cardInfo.departStation&&(0,L.jsx)(x.View,{className:Lt("icon-down",{open:t===b}),onClick:function(){w(t===b?-1:t)}})]}),e.cardInfo&&e.cardInfo.addDesc&&t!==b&&(0,L.jsx)(x.View,{className:"log-add",children:(0,L.jsxs)(x.View,{className:"l",children:[(0,L.jsx)(x.Text,{className:"ifont-gou"}),e.cardInfo.addDesc]})}),e.cardInfo&&e.cardInfo.departStation&&t===b&&(0,L.jsx)(G,{item:e}),8===e.type&&e.cardInfo.trainAppendProductList&&e.cardInfo.trainAppendProductList.length&&e.cardInfo.trainAppendProductList.map((function(t,n){return(0,L.jsxs)(x.View,{className:"log-ensure",children:[(0,L.jsxs)(x.View,{className:"cont",children:[(0,L.jsxs)(x.View,{className:"tit",children:[t.appendTitle,(0,L.jsx)(x.Text,{className:"s",children:t.appendRightTitle})]}),(0,L.jsx)(x.View,{className:"txt",children:t.appendSubTitle})]}),e.cardInfo.isAdd?(0,L.jsxs)(x.View,{className:"rbox",children:[(0,L.jsx)(x.Text,{className:"ifont-gou"}),"\u5df2\u5f00\u542f"]}):(0,L.jsx)(x.Button,{className:"btn-blue btn-submit",onClick:function(){A(e)},children:"\u5f00\u542f"})]},n)})),7===e.type&&(0,L.jsxs)(x.View,{className:"log-ensure",children:[(0,L.jsxs)(x.View,{className:"cont",children:[(0,L.jsx)(x.View,{className:"tit",children:"\u51fa\u884c\u4fdd\u969c\u4f53\u9a8c"}),(0,L.jsx)(x.View,{className:"txt",children:"\u65e0\u7968\u65f6\uff0c\u4e3a\u60a8\u76d1\u63a7\u300c\u5f53\u524d\u6700\u4f18\u51fa\u884c\u65b9\u6848\u5e76\u5c1d\u8bd5\u5360\u5ea7-\u51fa\u7968\u300d"})]}),e.cardInfo.isAdd?(0,L.jsxs)(x.View,{className:"rbox",children:[(0,L.jsx)(x.Text,{className:"ifont-gou"}),"\u5df2\u5f00\u542f"]}):(0,L.jsx)(x.Button,{className:"btn-blue btn-submit",onClick:function(){A(e)},children:"\u5f00\u542f"})]})]},t)}))})]})]})})]})},Rt=At,Bt=function(){},Mt=function(e){var t=e.dedicatedGrabStatus,n=void 0===t?0:t,r=e.dedicatedGrabCardInfo,i=e.dedicatedGrabAlertInfo,c=e.changeOrderRedirect,o=void 0===c?Bt:c,l=e.changeOrderPay,u=void 0===l?Bt:l,p=(0,d.useContext)(y),h=p.orderStates,m=h.orderInfo,f=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,s,i,c,l;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(m){e.next=2;break}return e.abrupt("return");case 2:return i=null!==(t=null===m||void 0===m||null===(s=m.ticketInfos[0])||void 0===s||null===(s=s.passengerInfos)||void 0===s?void 0:s.length)&&void 0!==t?t:1,c=(0,k.Ej)({OriginalOrderId:m.orderId,AppendList:[{AppendID:r.productId,AppendCount:i,AppendContent:""}],ChangeType:17}),k.ZP.showLoading(),e.next=7,(0,g.PH)(c);case 7:if(l=e.sent,0===l.result){e.next=12;break}return k.ZP.hideLoading(),k.ZP.showToast(l.resultMessage||"\u8bf7\u7a0d\u540e\u91cd\u8bd5","none"),e.abrupt("return");case 12:if(1!==n){e.next=16;break}return k.ZP.hideLoading(),o("\u6dfb\u52a0\u6210\u529f"),e.abrupt("return");case 16:k.ZP.hideLoading(),l.redirectText="\u6dfb\u52a0\u6210\u529f",u(l);case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){r&&i&&[1,2].includes(r.status)&&(k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"specialGrabChannelClick",orderId:m.orderId,state:r.status,price:r.sellPrice}),k.ZP.showModal({title:i.title||"\u5f00\u542f\u63d0\u9192",m:i.subTitle||"",confirmText:i.buttonName,showCancel:!0,done:function(e){var t=e.cancel;t||f()}}))};return(0,L.jsxs)(x.View,{children:[![3,4].includes(n)&&(0,L.jsxs)(x.View,{className:"grab-monitor-bd grab-zhuanren",children:[(0,L.jsxs)(x.View,{className:"info",children:[(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsx)(x.Icon,{className:"icon-24hours"}),(0,L.jsx)(x.View,{className:"t",children:"\u5168\u5929\u4e13\u4eba\u62a2\u7968"})]}),(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsx)(x.Icon,{className:"icon-cgl"}),(0,L.jsx)(x.View,{className:"t",children:"\u62a2\u7968\u6210\u529f\u7387\u9ad8"})]}),(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsx)(x.Icon,{className:"icon-failfree"}),(0,L.jsx)(x.View,{className:"t",children:"\u5931\u8d25\u5168\u989d\u9000\u6b3e"})]})]}),(0,L.jsx)(x.View,{className:"txt",children:"\u8f66\u7968\u5982\u9700\u9000\u6539\u8bf7\u524d\u5f80\u8f66\u7ad9\u529e\u7406"}),(0,L.jsx)(x.Button,{className:"btn-blue btn-submit",onClick:v,children:1===n?"\u514d\u8d39\u5f00\u542f":"\u7acb\u5373\u5f00\u542f"})]}),4===n&&(0,L.jsxs)(x.View,{className:"grab-monitor-bd grab-zhuanren",children:[(0,L.jsxs)(x.View,{className:"status",children:[(0,L.jsx)(x.Icon,{className:"icon-open"}),(0,L.jsx)(x.View,{className:"t",children:"\u6b63\u5728\u4e3a\u60a8\u5f00\u542f\u4e13\u4eba\u62a2\u7968"})]}),(0,L.jsx)(x.View,{className:"txt",children:"\u8bf7\u8010\u5fc3\u7b49\u5f85\uff0c\u5f00\u542f\u540e\u7acb\u5373\u4e3a\u60a824\u5c0f\u65f6\u62a2\u7968"})]}),3===n&&(0,L.jsxs)(x.View,{className:"grab-monitor-bd grab-zhuanren",children:[(0,L.jsxs)(x.View,{className:"status suc",children:[(0,L.jsx)(x.Icon,{className:"icon-suc"}),(0,L.jsx)(x.View,{className:"t",children:"\u4e13\u4eba\u62a2\u7968\u5df2\u5f00\u542f"})]}),(0,L.jsx)(x.View,{className:"txt",children:"\u8f66\u7968\u5982\u9700\u9000\u6539\u8bf7\u524d\u5f80\u8f66\u7ad9\u529e\u7406\uff0c\u6216\u8dd1\u817f\u9000\u7968"})]})]})},Gt=Mt,Ut=A().classnames,zt=function(e){var t=e.hbInfo,n=void 0===t?null:t,r=e.updateHBInfo,i=e.bindAccountInfo,c=void 0===i?null:i,o=e.changeOrderRedirect,l=e.changeOrderPay,u=e.isCanFaceAuthentication,p=e.singleToDouble,h=e.setDirectShowPopKey,m=e.setDetailPopVisible,f=(0,d.useContext)(y),v=f.orderStates,b=v.orderInfo,w=(0,d.useState)(0),j=(0,C.Z)(w,2),N=j[0],I=j[1],V=(0,d.useState)([]),T=(0,C.Z)(V,2),Z=T[0],S=T[1],P=(0,d.useState)(0),_=(0,C.Z)(P,2),D=_[0],F=_[1],O=(0,d.useState)({}),A=(0,C.Z)(O,2),R=A[0],B=A[1],M=(0,d.useState)({}),G=(0,C.Z)(M,2),U=G[0],z=G[1],E=(0,d.useState)(null),K=(0,C.Z)(E,2),H=K[0],q=K[1];(0,d.useEffect)((function(){if(n&&n.extendList&&n.extendList.length){var e=n.extendList.filter((function(e){return"HBAisleInfo"===e.key}))[0];e&&q(JSON.parse(e.value))}}),[n]);var W=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,g.nZ)({OrderNumber:b.orderId});case 2:t=e.sent,1===t.retCode&&S((null===(n=t.logInfoList)||void 0===n?void 0:n.filter((function(e){return e.logDateTime})))||[]);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,g.Gs)({OrderNumber:b.orderId,Channel:"ctripwx"});case 2:t=e.sent,1===t.retCode&&t.cardInfo&&(n=t.cardInfo,r=t.alertInfo,F(n.status),B(n),z(r));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,d.useEffect)((function(){Y(),W()}),[b]),(0,d.useEffect)((function(){n&&1===n.state&&I(1)}),[n]),(0,L.jsx)(x.View,{children:(0,L.jsxs)(x.View,{className:"white-box grab-monitor",children:[(0,L.jsxs)(x.View,{className:"grab-monitor-tab",children:[(0,L.jsxs)(x.View,{className:Ut("item",{cur:0==N}),onClick:function(){I(0)},children:[(0,L.jsx)(x.Text,{className:"txt",children:"\u4f59\u7968\u76d1\u63a7"}),(0,L.jsx)(x.Text,{className:"ifont-qus",onClick:function(){k.ZP.jumpToUrl("https://m.ctrip.com/webapp/train/activity/orderservice/InsuranceDetail.aspx?ProductID=1666&terminal=1")}})]}),(0,L.jsxs)(x.View,{className:Ut("item",{cur:1==N}),onClick:function(){I(1)},children:[(0,L.jsx)(x.Text,{className:"txt",children:"\u5019\u8865\u901a\u9053"}),(0,L.jsx)(x.Text,{className:"ifont-qus",onClick:function(){k.ZP.jumpToUrl("https://m.ctrip.com/webapp/train/activity/orderservice/InsuranceDetail.aspx?ProductID=1667&terminal=1")}}),n&&1===n.state&&(0,L.jsx)(x.Text,{className:"tag",children:"\u672a\u5f00\u542f"})]}),(0,L.jsxs)(x.View,{className:Ut("item",{cur:2==N}),onClick:function(){I(2)},children:[(0,L.jsx)(x.Text,{className:"txt",children:"\u4e13\u4eba\u62a2\u7968"}),(0,L.jsx)(x.Text,{className:"ifont-qus",onClick:function(){k.ZP.jumpToUrl("https://m.ctrip.com/webapp/train/activity/orderservice/InsuranceDetail.aspx?ProductID=1077&terminal=1")}}),[1,2].includes(D)&&(0,L.jsx)(x.Text,{className:"tag",children:"\u672a\u5f00\u542f"})]})]}),0===N&&Z&&(0,L.jsxs)(L.Fragment,{children:[k.ZP.ubtTrace("s_trn_c_trace_10650072279",{exposureType:"normal",bizKey:"monitorGrabChannel",orderId:b.orderId}),(0,L.jsx)(Rt,{grabLogInfoList:Z,changeOrderRedirect:o,changeOrderPay:l,setDirectShowPopKey:h})]}),1===N&&(0,L.jsxs)(L.Fragment,{children:[k.ZP.ubtTrace("s_trn_c_trace_10650072279",{exposureType:"normal",bizKey:"alternateGrabChannel",orderId:b.orderId,scene:n.state}),(0,L.jsx)(Ct,{updateHBInfo:r,hbInfo:n,bindAccountInfo:c,isCanFaceAuthentication:u,singleToDouble:p,setDirectShowPopKey:h,setDetailPopVisible:m,HBAisleInfo:H})]}),2===N&&(0,L.jsxs)(L.Fragment,{children:[k.ZP.ubtTrace("s_trn_c_trace_10650072279",{exposureType:"normal",bizKey:"specialGrabChannel",orderId:b.orderId,state:R.status,price:R.sellPrice}),(0,L.jsx)(Gt,{dedicatedGrabStatus:D,dedicatedGrabCardInfo:R,dedicatedGrabAlertInfo:U,updateDedicatedGrabInfo:Y,changeOrderRedirect:o,changeOrderPay:l})]})]})})},Et=zt,Kt=A().dayjs,Ht=A().classnames,qt=function(e){var t=(0,d.useContext)(y),n=t.orderStates.orderInfo,r=e.forecastInfo,a=(0,d.useState)({}),s=(0,C.Z)(a,2),c=s[0],o=s[1],l=function(){var e=Kt().format("YYYYMMDDHHmmss"),t=r.dateList,n=r.retCode,a={},s={},c={},l=!1;if(1==n&&t&&!(t.length<3)){var u=t.map((function(e){var t=(0,i.Z)((0,i.Z)({},e),{},{date_nj:Kt(e.datePoint.replace(/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/,(function(e,t,n,r,a,s,i){return"".concat(t,"-").concat(n,"-").concat(r," ").concat(a,":").concat(s,":").concat(i)}))).format("MM\u6708DD\u65e5HH:mm"),date_md:Kt(e.datePoint.replace(/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/,(function(e,t,n,r,a,s,i){return"".concat(t,"-").concat(n,"-").concat(r," ").concat(a,":").concat(s,":").concat(i)}))).format("MM\u6708DD\u65e5")});return 1==t.dataType&&(a=t),2!=t.dataType&&6!=t.dataType||(c=t,l=6==t.dataType),3==t.dataType&&(s=t),t})),d=0;d=parseInt(e)<parseInt(c.datePoint)?(parseInt(e)-parseInt(a.datePoint))/(parseInt(c.datePoint)-parseInt(a.datePoint))*100/2:(parseInt(e)-parseInt(c.datePoint))/(parseInt(s.datePoint)-parseInt(c.datePoint))*100/2+50,d=d>0?d<90?d:90:4,o((0,i.Z)((0,i.Z)({},r),{},{dateList:u,startObj:a,endObj:s,keyObj:c,isPreForecast:l,left:d}))}},u=function(){var e=c.left;return(0,L.jsx)(x.View,{className:Ht("tips",{start:e>6,green:e>50,end:e>98}),style:{left:e>6?e-3:e},children:e>98?"\u5df2\u5904\u653e\u7968\u9ad8\u5cf0":"\u5f53\u524d\u72b6\u6001"})};return(0,d.useEffect)((function(){l()}),[r,n]),(0,L.jsx)(L.Fragment,{children:c.dateList&&c.dateList.length>=3&&(0,L.jsxs)(x.View,{className:"howto white-box",children:[(0,L.jsx)(x.View,{className:"tit",children:c.title}),(0,L.jsx)(x.View,{className:"sub",children:c.subTitle}),(0,L.jsxs)(x.View,{className:"box",children:[u(),(0,L.jsxs)(x.View,{className:"line",children:[!!c.isPreForecast&&(0,L.jsx)(x.View,{className:"detail",style:{left:0}}),!c.isPreForecast&&(0,L.jsx)(x.View,{className:"detail",style:{right:0}}),(0,L.jsx)(x.View,{className:"now",style:{width:"".concat(c.left,"%")}})]}),(0,L.jsxs)(x.View,{className:"type",children:[!(null===c||void 0===c||!c.startObj)&&(0,L.jsxs)(x.View,{className:"left",children:[(0,L.jsx)(x.View,{children:c.startObj.date_nj}),(0,L.jsx)(x.View,{children:c.startObj.desc})]}),!(null===c||void 0===c||!c.keyObj)&&(0,L.jsxs)(x.View,{className:"mid",children:[(0,L.jsx)(x.View,{children:c.keyObj.date_nj}),(0,L.jsx)(x.View,{children:c.keyObj.desc})]}),!(null===c||void 0===c||!c.endObj)&&(0,L.jsxs)(x.View,{className:"right",children:[(0,L.jsx)(x.View,{children:c.endObj.date_nj}),(0,L.jsx)(x.View,{children:c.endObj.desc})]})]})]})]})})},Wt=qt,Yt=A().dayjs,Jt=function(e){var t=e.visible,n=e.close,r=e.done,i=(0,d.useContext)(y),c=i.orderStates.orderInfo,o=void 0===c?{}:c,l=(0,d.useState)([]),u=(0,C.Z)(l,2),p=u[0],h=u[1];if((0,d.useEffect)((function(){null!==o&&void 0!==o&&o.orderId&&R()}),[o]),null===o||void 0===o||!o.ticketInfos)return null;var m=o.ticketInfos,f=o.appendProductList,v=o.userInfo.contactMobile,b=m[0],w=b.arriveStation,j=b.departStation,N=b.trainNumber,I=b.departTime,V=b.ticketPrice,T=b.ticketCount,Z=b.jLAlternativeDate,S=b.jLAlternativeSeat,P=b.jLAlternativeTrain,_=b.passengerInfos,D=_.map((function(e){return e.passengerName})).join(","),F=null===Z||void 0===Z?void 0:Z.split(",").map((function(e){return Yt(e).format("M\u6708D\u65e5")})).join(","),O=(f||[]).map((function(e){return"".concat(e.appendProductTitle," ").concat(e.appendProductDesc)})).join(","),A=null===P||void 0===P?void 0:P.split(",").filter((function(e){return e!=N})).join(","),R=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=k.Zs,e.next=3,(0,g.c1)({OrderNumber:o.orderId});case 3:e.t1=e.sent,t=(0,e.t0)(e.t1),n=t.hBTicketList,h(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){n(),k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"detailFloatClick",orderId:o.orderId,clickType:1})},M=function(){r(),k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"detailFloatClick",orderId:o.orderId,clickType:2})},G=function(){if(p)return(0,L.jsx)(x.View,{className:"list",children:p.map((function(e,t){return(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsxs)(x.View,{className:"desc",children:[(0,L.jsxs)(x.View,{className:"top",children:[(0,L.jsx)(x.Text,{children:Yt(e.departTime).format("MM\u6708DD\u65e5")}),(0,L.jsx)(x.Text,{children:e.trainNumber})]}),(0,L.jsxs)(x.View,{className:"bottom",children:[(0,L.jsxs)(x.Text,{children:[e.departStation,"-",e.arriveStation]}),(0,L.jsx)(x.Text,{children:e.seatName})]})]}),(0,L.jsx)(x.RichText,{nodes:e.desc,className:"text"})]},t)}))})};return(0,L.jsxs)(Be,{visible:t,clickMaskClose:!0,close:B,children:[t&&k.ZP.ubtTrace("s_trn_c_trace_10650072279",{bizKey:"detailFloat",orderId:o.orderId,exposureType:"normal"}),(0,L.jsxs)(x.View,{className:"diagnosis-pop",children:[(null===p||void 0===p?void 0:p.length)>0&&(0,L.jsxs)(x.View,{className:"panel",children:[(0,L.jsx)(x.View,{className:"tit",children:"\u5b98\u65b9\u5019\u8865\u901a\u9053"}),G()]}),(0,L.jsxs)(x.View,{className:"panel",children:[(0,L.jsx)(x.View,{className:"tit",children:"\u4f59\u7968\u76d1\u63a7\u901a\u9053"}),(0,L.jsxs)(x.View,{className:"cont",children:[(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsx)(x.View,{className:"label",children:"\u8f66\u6b21"}),(0,L.jsxs)(x.View,{className:"desc",children:[N,"(",I,"\u5f00)"]})]}),A.length>0&&(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsx)(x.View,{className:"label",children:"\u5907\u9009"}),(0,L.jsx)(x.View,{className:"desc",children:A})]}),(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsx)(x.View,{className:"label",children:"\u5ea7\u5e2d"}),(0,L.jsx)(x.View,{className:"desc",children:S})]}),(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsx)(x.View,{className:"label",children:"\u884c\u7a0b"}),(0,L.jsxs)(x.View,{className:"desc",children:[F," ",j,"-",w]})]}),(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsx)(x.View,{className:"label",children:"\u4e58\u5ba2"}),(0,L.jsx)(x.View,{className:"desc",children:D})]}),(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsx)(x.View,{className:"label",children:"\u624b\u673a"}),(0,L.jsx)(x.View,{className:"desc",children:v})]}),(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsx)(x.View,{className:"label",children:"\u7968\u6b3e"}),(0,L.jsxs)(x.View,{className:"desc",children:["\uffe5",V,"x",T,"(\u6700\u9ad8\u7968\u9762\u4ef7\u683c)"]})]}),O.length>0&&(0,L.jsxs)(x.View,{className:"item",children:[(0,L.jsx)(x.View,{className:"label",children:"\u5176\u4ed6"}),(0,L.jsx)(x.View,{className:"desc",children:O})]})]})]}),(0,L.jsx)(x.View,{className:"btn",onClick:M,children:"\u6dfb\u52a0\u66f4\u591a\u65b9\u6848"})]})]})},Qt=Jt,Xt=A().dayjs,$t=function(){},en=function(e){var t=e.popVisible,n=e.setPopVisible,r=e.showWeakGuide,i=e.setShowWeakGuide,c=e.orderSerial,o=e.onClickWeakGuide,l=void 0===o?$t:o,u=(0,d.useContext)(y),p=u.orderStates,h=p.orderInfo,m=p.diagnosisInfoBox,f=p.extendValues,v=u.pageFns.navigateTo,b=(0,d.useState)(!1),w=(0,C.Z)(b,2),j=w[0],N=w[1],I=(0,d.useState)(null),V=(0,C.Z)(I,2),T=V[0],S=V[1],P=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r,s,i,o,l;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={Channel:"ctripwx",OrderNumber:h.orderId},e.next=3,(0,g.fJ)(t);case 3:if(n=e.sent,r=n.retCode,s=n.retMessage,i=n.diagnosisPlanInfoList,o=n.cardInfo,1===r){e.next=10;break}throw s;case 10:l=null===i||void 0===i?void 0:i.every((function(e){return 3==e.status})),S(o),N((!l||(null===m||void 0===m?void 0:m.show))&&1===c);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){A(),v({url:"/pages/trainActivity/twebview/index",data:{url:"https://m.ctrip.com/webapp/train/grabTicketDiagnose?oid=".concat(h.orderId,"&bgColor=#00aaff")}})},D=function(){var e,t;if(27!==(null===(e=h.alertInfo)||void 0===e?void 0:e.alertType)&&!f.GrabInterrupteSpecialSmallScene)return null;var n=h.grabInterrupteInfoV2||(null===(t=f.GrabInterrupteSpecialSmallScene)||void 0===t?void 0:t.cardInfo);if(!n)return null;i(!0)},F=function(){_(),k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"grabDiagnoseClick",orderId:h.orderId})},O=function(){n(!0)},A=function(){n(!1)},R=function(){var e;if(null===h||void 0===h||!h.ticketInfos)return null;var t=h.ticketInfos[0],n=t.departDate,r=t.departTime,a=t.seatName,s=t.trainNumber,i=t.departStation,c=t.arriveStation,o=(null===(e=h.grabTaskList)||void 0===e?void 0:e.length)||0,l="".concat(Xt(n).format("MM-DD")," ").concat(s,"(").concat(r,"\u5f00) ").concat(a," ").concat(o>1?"...\u7b49\u591a\u79cd\u65b9\u6848\uff0c\u603b\u4ef7\uffe5":"\uff0c\u603b\u4ef7\uffe5").concat(h.orderAmount);return(0,L.jsxs)(x.View,{className:"detail",onClick:O,children:[(0,L.jsxs)(x.View,{className:"tit",children:[i,"-",c,(0,L.jsxs)(x.View,{className:"link",children:["\u8be6\u60c5",(0,L.jsx)(x.View,{className:"ifont-arr"})]})]}),(0,L.jsx)(x.View,{className:"sub",children:l})]})};return(0,d.useEffect)((function(){console.log("\u8be6\u60c5\u4fe1\u606f\u66f4\u65b0"),P(),D()}),[h,c]),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(x.View,{className:"diagnosis white-box",children:[!r&&j&&(null===T||void 0===T?void 0:T.title)&&(0,L.jsxs)(x.View,{className:"diagnosis-entry",children:[k.ZP.ubtTrace("s_trn_c_trace_10650072279",{bizKey:"grabDiagnose",exposureType:"normal",orderId:h.orderId}),(0,L.jsx)(x.Image,{className:"icon",src:"https://images3.c-ctrip.com/train/2021/app/V8.40.6/qiangpiao/icon_zhenduan.png"}),(0,L.jsxs)(x.View,{className:"cont",children:[(0,L.jsx)(x.RichText,{className:"tit",nodes:T.title}),(0,L.jsx)(x.RichText,{className:"sub",nodes:T.subTitle||""})]}),(0,L.jsx)(x.View,{className:"btn",onClick:F,children:"\u53bb\u4f18\u5316"})]}),r&&(0,L.jsxs)(x.View,{className:"diagnosis-entry diagnosis-weak-guide",children:[k.ZP.ubtTrace("TCWGrabDetail_Detail_WeakVerification_exposure",{PageId:"10650072279",channel:Z.Z.channel,SceneType:(0,k.Yt)(f.GrabInterrupteSpecialSmallScene),orderId:h.orderId}),(0,L.jsx)(x.Image,{className:"icon",src:"https://images3.c-ctrip.com/train/2022/app/8.58/qiangpiao/ruoyingdao/icon_ruoyindao@3x.png"}),(0,L.jsxs)(x.View,{className:"cont",children:[(0,L.jsxs)("text",{className:"tit",children:["\u5207\u636212306\u8d26\u53f7",(0,L.jsx)("text",{className:"important-tit",children:"\u53ef\u6062\u590d\u6210\u529f\u7387"})]}),(0,L.jsx)("text",{className:"sub",children:"12306\u89c4\u5b9a\u706b\u8f66\u51fa\u884c\u7528\u6237\uff0c\u9700\u8fdb\u884c\u5b9e\u540d\u5236\u8ba4\u8bc1\u6838\u9a8c"})]}),(0,L.jsxs)(x.View,{className:"btn",onClick:l,children:[(0,L.jsx)(x.View,{className:"tag",children:"\u53ef\u9080\u597d\u53cb\u5e2e\u62a2"}),"\u53bb\u5b8c\u6210"]})]}),R()]}),(0,L.jsx)(Qt,{visible:t,close:A,done:_})]})},tn=en,nn=function(e){var t=e.multipleBookingAndGrabSegmentation,n=null===t||void 0===t?void 0:t.relationOrderInfoList;if(!n||0===n.length)return null;var r=n[0],a=r.orderNumber,s=r.orderStatusName,i=r.ticketInfoList,c=r.routeSequence,o=r.canShowStationInfo,l=(r.orderStatus,i[0]),u=l.departDateTime,d=l.departStation,p=l.arriveDateTime,m=l.arriveStation,f=new Date(u.substring(0,4),parseInt(u.substring(4,6))-1,u.substring(6,8)),v=new Date(p.substring(0,4),parseInt(p.substring(4,6))-1,p.substring(6,8)),g=Math.floor((v-f)/864e5),b="".concat(u.substring(8,10),":").concat(u.substring(10,12)),w="".concat(p.substring(8,10),":").concat(p.substring(10,12)),j=function(){k.ZP.ubtTrace("TCWDetail_MultiRoutes_click",{PageId:"10650037941",orderId:t.currentOrderNumber,channel:"wx"}),h().redirectTo({url:"/pages/train/orderdetail/orderdetail?oid=".concat(a)})};return(0,L.jsxs)(L.Fragment,{children:[k.ZP.ubtTrace("TCWDetail_MultiRoutes_exposure",{PageId:"10650037941",orderId:t.currentOrderNumber,channel:"wx"}),(0,L.jsxs)(x.View,{className:"second-ticket-box-body",children:[(0,L.jsxs)(x.View,{className:"card",children:[(0,L.jsxs)(x.View,{className:"flex1",children:[(0,L.jsxs)(x.View,{className:"des",children:[(0,L.jsxs)(x.View,{className:"txt",children:["\u7b2c",c,"\u7a0b"]}),(0,L.jsx)(x.View,{className:"status",children:s})]}),o&&(0,L.jsxs)(x.View,{className:"info",children:[(0,L.jsxs)(x.View,{className:"departStationInfo",children:[(0,L.jsx)(x.View,{className:"departTime",children:b}),(0,L.jsx)(x.View,{className:"departStation",children:d})]}),"-",(0,L.jsxs)(x.View,{className:"arriveStationInfo",children:[(0,L.jsxs)(x.View,{className:"arriveTime",children:[w,0!==g&&(0,L.jsxs)(x.View,{className:"diff-day",children:["+",g,"\u5929"]})]}),(0,L.jsx)(x.View,{className:"arriveStation",children:m})]})]})]}),(0,L.jsx)(x.Button,{className:"btn",onClick:j,children:"\u7acb\u5373\u67e5\u770b"})]}),(0,L.jsx)(x.View,{className:"connect"})]})]})},rn=nn,an=A().dayjs,sn=A().URLSearchParams,cn=function(e){var t;(0,P.Z)(e);var n=(0,d.useContext)(y),r=n.orderStates,c=n.updateOrder,o=r.orderInfo,l=void 0===o?{}:o,u=r.statusBarHeight,m=r.extendValues,f=r.isCancel,v=r.subOrderId,b=r.onLoadReady,w=l.orderId,j=l.userInfo,N=l.ticketInfos,I=l.jLDetailInfo,V=l.otherSeats,S=l.topVerifyInfo;if(!I)return k.ZP.showToast("\u8ba2\u5355\u5df2\u66f4\u65b0\uff0c\u8bf7\u91cd\u65b0\u67e5\u770b"),setTimeout((function(){h().navigateBack()}),2e3),(0,L.jsx)(x.View,{children:"\u8ba2\u5355\u5df2\u66f4\u65b0\uff0c\u8bf7\u91cd\u65b0\u67e5\u770b"});var _=(0,d.useState)(null),D=(0,C.Z)(_,2),O=D[0],A=D[1],R=(0,d.useState)({}),B=(0,C.Z)(R,2),M=B[0],U=B[1],E=(0,d.useState)({}),K=(0,C.Z)(E,2),H=K[0],q=K[1],W=(0,d.useState)(!1),Y=(0,C.Z)(W,2),J=Y[0],Q=Y[1],X=(0,d.useState)({}),$=(0,C.Z)(X,2),ee=$[0],te=$[1],ne=(0,d.useState)({}),re=(0,C.Z)(ne,2),ae=re[0],se=re[1],ie=(0,d.useState)(null),ce=(0,C.Z)(ie,2),oe=ce[0],le=ce[1],ue=(0,d.useState)(null),de=(0,C.Z)(ue,2),pe=de[0],he=de[1],me=(0,d.useState)({}),fe=(0,C.Z)(me,2),xe=fe[0],ve=fe[1],ge=(0,d.useState)([]),be=(0,C.Z)(ge,2),we=be[0],je=be[1],Ne=(0,d.useState)({}),Ie=(0,C.Z)(Ne,2),Ve=Ie[0],ke=Ie[1],ye=(0,d.useState)([]),Te=(0,C.Z)(ye,2),Ze=Te[0],Se=Te[1],Ce=(0,d.useState)({}),Pe=(0,C.Z)(Ce,2),Le=Pe[0],_e=Pe[1],De=(0,d.useState)([]),Fe=(0,C.Z)(De,2),Oe=Fe[0],Ae=Fe[1],Re=(0,d.useState)({}),Be=(0,C.Z)(Re,2),Me=Be[0],Ge=Be[1],Ue=(0,d.useState)(!1),ze=(0,C.Z)(Ue,2),Ee=ze[0],Ke=ze[1],qe=(0,d.useState)(""),Ye=(0,C.Z)(qe,2),Je=Ye[0],Qe=Ye[1],Xe=(0,d.useState)({}),$e=(0,C.Z)(Xe,2),et=$e[0],tt=$e[1],nt=(0,d.useState)(!1),rt=(0,C.Z)(nt,2),at=rt[0],st=rt[1],it=(0,d.useState)(!1),ct=(0,C.Z)(it,2),ot=ct[0],lt=ct[1],ut=(0,d.useState)(1),dt=(0,C.Z)(ut,2),pt=dt[0],ht=dt[1],mt=(0,d.useState)(!1),ft=(0,C.Z)(mt,2),xt=ft[0],vt=ft[1],bt=(0,d.useRef)(!1),wt=T.WG.getAttr("12306Accounts")||[],jt=T.WG.getAttr("bind12306")||[],It=null===(t=wt.find((function(e){return e.userName===jt.name})))||void 0===t?void 0:t.loginPW,Vt=h().getStorageSync("accountJumpActive"),kt=!1;function yt(){return Zt.apply(this,arguments)}function Zt(){return Zt=(0,s.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={OrderNumber:w,SubOrderNumber:""},e.next=3,(0,g.sS)(t);case 3:n=e.sent,U(n);case 5:case"end":return e.stop()}}),e)}))),Zt.apply(this,arguments)}function St(){return Ct.apply(this,arguments)}function Ct(){return Ct=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r,s;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[],e.next=3,$t();case 3:return n=e.sent,r=n.trainInfo,s=n.grabTrainsSeatsArr,r&&(ke(r),t.push(Pt(r)),t.push(_t(r))),t.push(Ft()),t.push(Bt().then((function(e){if(e.bindAccountInfo){var t=e.bindAccountInfo.status;return[20,30,40].includes(+t)?At():void 0}}))),t.push(zt(l)),t.push(nn(r,s)),t.push(Gt()),t.push(Ht()),t.push(Yt()),e.next=16,Promise.all(t);case 16:Ke(!0);case 17:case"end":return e.stop()}}),e)}))),Ct.apply(this,arguments)}function Pt(e){return Lt.apply(this,arguments)}function Lt(){return Lt=(0,s.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,g.iQ)({MaxTicketPrice:t.price,ArriveStation:t.arriveStation,DepartStation:t.departStation,DepartDate:I.jLAlternativeDate.replace(/-/g,""),EarliestDepartTime:N[0].departTime,LatestDepartTime:N[0].departTime,MaxRunTime:t.runTime});case 2:n=e.sent,1===n.retCode&&se((0,i.Z)((0,i.Z)({},ae),{},{timeLine:n.recommendDefaultTimeLine}));case 4:case"end":return e.stop()}}),e)}))),Lt.apply(this,arguments)}function _t(e){return Dt.apply(this,arguments)}function Dt(){return Dt=(0,s.Z)((0,a.Z)().mark((function e(t){var n,r,s,c,o,l,u,d,p,h,m,f;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.arriveStation,r=t.departStation,s=function(e){return"\u9999\u6e2f"===e?"\u9999\u6e2f\u897f\u4e5d\u9f99":e},c={DepartStation:s(r),ArriveStation:s(n),DepartDate:an(N[0].departDate).format("YYYY-MM-DD"),ChannelName:"ctrip.wx"},e.next=5,(0,g.PT)(c);case 5:o=e.sent,l=o.trainInfoList||[],u=0,l.length>0&&(d=!1,p=!1,h=!1,m=!1,u=l.filter((function(e){var t=e.trainNumber,n=void 0===t?"":t,r=e.departTime,a=ae.timeLine.split("-")||["00:00","24:00"],s=!1;switch(s=r>=a[0]&&r<=a[1],null===n||void 0===n?void 0:n.charAt(0)){case"G":d=!0;break;case"D":p=!0;break;case"C":h=!0;break;default:m=!0}return s})).length,u>0&&(f=[],d&&f.push("\u9ad8\u94c1"),p&&f.push("\u52a8\u8f66"),h&&f.push("\u57ce\u9645"),m&&f.push("\u666e\u901a\u5217\u8f66"),se((0,i.Z)((0,i.Z)({},ae),{},{desc:"\u8be5\u65f6\u6bb5\u5171\u6709".concat(u,"\u8d9f").concat(f.join("\u3001"),"\u8f66\u6b21\u53ef\u62a2")}))));case 9:case"end":return e.stop()}}),e)}))),Dt.apply(this,arguments)}function Ft(){return Ot.apply(this,arguments)}function Ot(){return Ot=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r,s,i,c,o;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={OrderNumber:w},e.next=3,(0,g.aE)(t);case 3:n=e.sent,1==n.retCode&&(r=n.shareTypeList.some((function(e){return e.isCanGiftPackage})),s=n.shareTypeList.find((function(e){return 0!==e.giftPackageNum}))||{},i=s.giftPackageNum,c=n.shareTypeList,o=void 0===c?[]:c,q({isCanGain:r,giftPackageNum:i,shareTypeList:o}));case 5:case"end":return e.stop()}}),e)}))),Ot.apply(this,arguments)}function At(){return Rt.apply(this,arguments)}function Rt(){return Rt=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={Mobile:j.contactMobileAES,OrderID:w,OrderType:"JL",DepartStation:N[0].departStation,ArriveStation:N[0].arriveStation,DepartDate:null===(t=N[0].departDate)||void 0===t?void 0:t.split("-").join(""),TrainNumber:N[0].trainNumber,SeatName:N[0].seatName,SeatPrice:N[0].ticketPrice},e.next=3,(0,g.gt)(n);case 3:r=e.sent,Q(1==r.retCode&&r.isCanFaceAuthentication);case 5:case"end":return e.stop()}}),e)}))),Rt.apply(this,arguments)}function Bt(){return Mt.apply(this,arguments)}function Mt(){return Mt=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r,s,c,o;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,g.QN)({channel:"ctripwx",OrderNumber:w,UserMobile:j.contactMobileAES});case 2:return s=e.sent,c=s.hBOrderNumber,o=2===(null===(t=s.hBInfo)||void 0===t?void 0:t.openState)||1===(null===(n=s.hBInfo)||void 0===n?void 0:n.state),lt(o&&It&&!kt),te((0,i.Z)({hBOrderNumber:c},s.hBInfo)),le(s.bindAccountInfo),k.ZP.ubtTrace("s_trn_c_trace_10650072279",{exposureType:"normal",bizKey:"alternateChannel",type:2==(null===(r=s.hBInfo)||void 0===r?void 0:r.state)?1:0}),e.abrupt("return",s);case 10:case"end":return e.stop()}}),e)}))),Mt.apply(this,arguments)}function Gt(){return Ut.apply(this,arguments)}function Ut(){return Ut=(0,s.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,g.ld)({TimeType:2,Mobile:j.contactMobileAES,OrderNumber:w,DepartStations:N[0].departStation,ArriveStations:N[0].arriveStation,DepartDates:I.jLAlternativeDate,SeatNames:I.jLAllSeatNames,TrainNumbers:I.jLAllTrainNumbers,PassengerList:N[0].passengerInfos,AlternateTunnel:0});case 2:t=e.sent,1===t.retCode&&t.alertInfo&&Ge(t.alertInfo);case 4:case"end":return e.stop()}}),e)}))),Ut.apply(this,arguments)}function zt(e){return Kt.apply(this,arguments)}function Kt(){return Kt=(0,s.Z)((0,a.Z)().mark((function e(t){var n,r,s,i,c,o,l,u,d;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!==t&&void 0!==t&&t.ticketInfos){e.next=2;break}return e.abrupt("return");case 2:return n=t.ticketInfos[0],r={Channel:"ctripwx",OrderType:"JL",IsMember:!0,OrderId:t.orderId,DepartStation:n.departStation,ArriveStation:n.arriveStation,DepartDateTime:"".concat(n.departDate," ").concat(n.departTime,":00"),VendorID:"7"},e.next=6,(0,g.ez)(r);case 6:if(s=e.sent,0==s.retCode){e.next=9;break}return e.abrupt("return");case 9:if(i=s.grabRecommmendServiceInfo,null===i||void 0===i||!i.recommmendServiceList){e.next=16;break}return c=i.recommmendServiceList.find((function(e){return 1==e.serviceType}))||{},o=c.canFreePrice,l=c.isCanFree,u=c.buyLevelProductFee,e.next=14,(0,g.Z8)("train_wx_nightgrab_config_v2");case 14:d=e.sent,i.recommmendServiceList.forEach((function(e){if(1==e.serviceType){var t=i.recommmendServiceList[0].price,n=void 0===t?0:t,r=N[0].passengerInfos.length,a=r>1?"\uffe5".concat(n," x ").concat(r):"\uffe5".concat(n);Object.values(d).forEach((function(e){e.descList.forEach((function(t,n){if(t.indexOf("&")>-1){var s=t.match(/&(\S*)&/)[1];s=r>1?"".concat(s," x ").concat(r):s,e.descList[n]=t.replace(/\&(.*?)\&/,s)}t.indexOf("$")>-1&&(e.descList[n]=t.replace(/\$(.*price)\$/,a))}))})),Object.assign(e,d),u>=o&&l&&(e.freeFlag=!0)}}));case 16:A(s.userRightsInfo),ve(s),he(i);case 19:case"end":return e.stop()}}),e)}))),Kt.apply(this,arguments)}function Ht(){return qt.apply(this,arguments)}function qt(){return qt=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(l.isUseVipGrabRight){e.next=2;break}return e.abrupt("return");case 2:return t={OrderNumber:w},e.next=5,(0,g.iW)(t);case 5:n=e.sent,1==n.retCode&&n.assistedFriendsList&&(r=n.assistedFriendsList,je(r));case 7:case"end":return e.stop()}}),e)}))),qt.apply(this,arguments)}function Yt(){return Jt.apply(this,arguments)}function Jt(){return Jt=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,g.Z8)("ctrip-intelligent-recommend");case 3:if(t=e.sent,null===t||void 0===t||!t.isOpen){e.next=15;break}if("C"!==I.jLOrderStatus){e.next=15;break}if(!m.GrabTicketSegmentation){e.next=13;break}if(!f){e.next=9;break}return e.abrupt("return");case 9:n="https://m.ctrip.com/webapp/train/intelligentSegmentation?oid=".concat(w,"&needLogin=true"),h().redirectTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(n))}),e.next=15;break;case 13:r="https://m.ctrip.com/webapp/train/activity/ctrip-intelligent-recommend/?oid=".concat(w,"&subOrderId=").concat(v,"&needLogin=true"),h().redirectTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(r))});case 15:e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](0),(0,k.vJ)(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])}))),Jt.apply(this,arguments)}function Qt(e,t){var n=function(e,t){e[t.seatName]?parseFloat(t.seatPrice)>e[t.seatName].seatPrice&&(e[t.seatName]={seatPrice:parseFloat(t.seatPrice)}):e[t.seatName]={SeatPrice:parseFloat(t.seatPrice)}},r=t?e.concat(t):e,a=r.map((function(e){return e.seatList})).reduce((function(e,t){return null===t||void 0===t||t.forEach((function(t){n(e,t)})),e}),{});return a}function Xt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.forEach((function(e){t[e]&&(t[e].selected=!0)})),Object.keys(t).map((function(e){return(0,i.Z)({seatName:e,selected:!1},t[e])}))}function $t(){return en.apply(this,arguments)}function en(){return en=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r,s,i,c;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=N[0],n={departStation:t.departStation,arriveStation:t.arriveStation,departDate:t.departDate,trainName:t.trainNumber},e.prev=2,e.next=5,(0,k.Ab)(n);case 5:if(s=e.sent,null!==(r=s.seatList)&&void 0!==r&&r.length){e.next=8;break}throw new Error("\u8f66\u6b21\u6570\u636e\u5f02\u5e38");case 8:return i=Qt([],s),c=Xt(V,i).filter((function(e){return"\u5546\u52a1\u5ea7"!==e.seatName&&"\u9ad8\u7ea7\u8f6f\u5367"!==e.seatName&&e.seatName!==t.seatName})),e.abrupt("return",{trainInfo:s,grabTrainsSeatsArr:c});case 13:return e.prev=13,e.t0=e["catch"](2),e.abrupt("return",{});case 16:case"end":return e.stop()}}),e,null,[[2,13]])}))),en.apply(this,arguments)}function nn(e,t){return cn.apply(this,arguments)}function cn(){return cn=(0,s.Z)((0,a.Z)().mark((function e(t,n){var r,s,i,c,o,l,u,d,h;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t&&n){e.next=2;break}return e.abrupt("return",{});case 2:return r=t.departStation,s=t.arriveStation,i=t.departureDate,c=t.trainNumber,o=t.seatName,l=t.departTimeStamp,u=an(l).format("YYYYMMDDHHmmss"),e.t0=on,e.next=7,(0,g.V8)({Channel:"ctriph5",FromType:0,departStation:r,arriveStation:s,DepartDates:i,TrainNumbers:c,SeatNames:o,DepartTimes:u});case 7:if(e.t1=e.sent,d=(0,e.t0)(e.t1),d.recommendFloatingLayerInfo&&_e(d.recommendFloatingLayerInfo),p._.isArray(d.recommendListBySuccessRate)){e.next=12;break}return e.abrupt("return");case 12:h=d.recommendListBySuccessRate.slice(0,4),Se(h),Ae(n);case 15:case"end":return e.stop()}}),e)}))),cn.apply(this,arguments)}function on(e){function t(e,t){var n=an(t).diff(an(e),"s"),r=parseInt(n/3600),a=parseInt((n-3600*r)/60);return{timesCost:r?"".concat(r,"\u65f6").concat(a,"\u5206"):"".concat(a,"\u5206"),runTime:60*r+a}}var n,r=e.recommendListBySuccessRate;return r&&(n=r.map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{departStation:e.depStation,arriveStation:e.arrStation,departTimeStamp:+an(e.depTime),departTime:"".concat(e.depTime[8]).concat(e.depTime[9],":").concat(e.depTime[10]).concat(e.depTime[11]),arriveTime:"".concat(e.arrTime[8]).concat(e.arrTime[9],":").concat(e.arrTime[10]).concat(e.arrTime[11])},t(e.depTime,e.arrTime))}))),(0,i.Z)((0,i.Z)({},e),{},{recommendListBySuccessRate:n})}function ln(e){return un.apply(this,arguments)}function un(){return un=(0,s.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t&&k.ZP.showModal({m:t}),e.next=3,c();case 3:n=e.sent,zt(n);case 5:case"end":return e.stop()}}),e)}))),un.apply(this,arguments)}function dn(e){l.isFastPay?ln(e.redirectText||""):(0,k.td)({oid:e.changeOrderId,sbackCallback:function(){return ln(e.succText||"")},ebackCallback:function(){return ln(e.failText||"")}})}function pn(){if(ot&&k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"activateMemberClick",clickType:3}),bt.current)return k.ZP.goToHomepage();h().navigateBack()}function hn(e){return mn.apply(this,arguments)}function mn(){return mn=(0,s.Z)((0,a.Z)().mark((function e(t){var n,r,s,i,o,u,d,p,h,f,x,v,g,b,w,j;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=m.GrabInterrupteSpecialSmallScene,r=m.GrabInterrupteV2,s=(0,k.Yt)(n),k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"button"===t?"verificationPopupsClick":"verificationBannerClick",scene:s}),i="",!r){e.next=9;break}i=null!==(o=m.GrabInterrupte)&&void 0!==o&&o.jumpUrl?null===(h=m.GrabInterrupte)||void 0===h?void 0:h.jumpUrl:null!==r&&void 0!==r&&null!==(u=r.alertInfo)&&void 0!==u&&u.jumpUrl?null===r||void 0===r||null===(f=r.alertInfo)||void 0===f?void 0:f.jumpUrl:3==(null===(d=m.GrabInterrupte)||void 0===d?void 0:d.actionCode)||3==(null===(p=m.GrabInterrupteV2)||void 0===p?void 0:p.actionCode)?"ctrip-train-12306/#/verify":"/pages/train/face/face",xn({type:4,from:"nobreak"}),e.next=17;break;case 9:if(!n){e.next=17;break}if(x=n.actionCode,v=n.userId12306,g=n.userName,b=n.passportType,w=n.mobilePhone12306,j=n.passportNumber,1!=x){e.next=16;break}return i="ctrip-train-12306/#/login",e.next=15,(0,k.Uv)({fromType:4,accountInfo:{userId12306:v,scene:"small-scene"},orderInfo:l});case 15:c();case 16:5==x&&(i="ctrip-train-12306/#/verify",fn({mobile:w,userName:g,passportType:b,passportNumber:j,userId12306:v,verifyFlag:2,orderNumber:l.orderId,from:"weakGuide",fromType:2}));case 17:k.ZP.ubtTrace("TCWGrabDetail_Detail_WeakVerification_click",{PageId:"10650072279",channel:Z.Z.channel,SceneType:(0,k.Yt)(m.GrabInterrupteSpecialSmallScene),ToLocation:i,orderId:l.orderId});case 18:case"end":return e.stop()}}),e)}))),mn.apply(this,arguments)}function fn(e){var t=e.verifyFlag,n=e.mobile,r=e.userName,i=e.userId12306,o=e.passportType,l=e.passportNumber,u=e.orderNumber,d=e.from,p=e.fromType,m=new sn({verifyFlag:t,from:d,needLogin:!0,sourceType:"H5",smsContent:"",mobile:n||"\u60a8\u768412306\u7ed1\u5b9a\u624b\u673a\u53f7",userName:r||"",userID12306:i||"",mobileCheck:1,source:"WX",showhead:0,channel:"WX",passportType:o||"",passportNumber:l||"",orderNumber:u}).toString(),f="".concat(k.OP,"webapp/train/activity/ctrip-train-12306/#/verify?").concat(m),x=h().getCurrentPage();x.navigateTo({url:"/pages/trainActivity/twebview/index",data:{url:f,bridgeIns:function(e){var t=(0,C.Z)(e.detail.data,1),n=t[0].unRisk,r=void 0!==n&&n;setTimeout((0,s.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,vn(r,1,p);case 2:c();case 3:case"end":return e.stop()}}),e)}))),500)}}})}function xn(e){var t,n,r,i,o=e.type,l=e.from;"nobreak"!==l&&k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"alternateOpenClick",scene:o});var u="",d="";if(oe){var p=oe.status,f=oe.userName;switch(+o){case 1:var x;if(30==p||40==p)u=f;else u=null===(x=m.grabGuidUserCheckFace)||void 0===x?void 0:x.userId12306;break;case 2:u=f;break;case 3:break;case 4:u=(null===(t=m.GrabInterrupte)||void 0===t?void 0:t.userId12306)||(null===(n=m.GrabInterrupteV2)||void 0===n?void 0:n.userId12306),d=(null===(r=m.GrabInterrupte)||void 0===r?void 0:r.mobilePhone12306)||(null===(i=m.GrabInterrupteV2)||void 0===i?void 0:i.mobilePhone12306);break;default:break}if(m.GrabInterrupteV2&&4==o){var v=(0,k.Yt)(m.GrabInterrupteSpecialSmallScene);k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"verificationPopupsClick",scene:v})}if(4==o){var g,b,w,j,N,I;if(null!==(g=m.GrabInterrupte)&&void 0!==g&&g.jumpUrl)return void k.ZP.jumpToUrl(null===(N=m.GrabInterrupte)||void 0===N?void 0:N.jumpUrl);if(null!==(b=m.GrabInterrupteV2)&&void 0!==b&&null!==(b=b.alertInfo)&&void 0!==b&&b.jumpUrl)return void k.ZP.jumpToUrl(null===(I=m.GrabInterrupteV2)||void 0===I||null===(I=I.alertInfo)||void 0===I?void 0:I.jumpUrl);if(3==(null===(w=m.GrabInterrupte)||void 0===w?void 0:w.actionCode)||3==(null===(j=m.GrabInterrupteV2)||void 0===j?void 0:j.actionCode)){var V="".concat(k.OP,"webapp/train/activity/ctrip-train-12306/#/verify?mobile=").concat(d||"\u60a8\u7684\u4e0b\u5355\u624b\u673a","&userName=").concat(u,"&userID12306=").concat(u,"&needLogin=true"),y=h().getCurrentPage();return void y.navigateTo({url:"/pages/trainActivity/twebview/index",data:{url:V,bridgeIns:function(e){console.log("TRN PROPS gotten",e.detail.data);var t=(0,C.Z)(e.detail.data,1),n=t[0].unRisk,r=void 0!==n&&n;setTimeout((0,s.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t="nobreak"==l?2:null,e.next=3,vn(r,1,t);case 3:c();case 4:case"end":return e.stop()}}),e)}))),500)}}})}}var T=h().getCurrentPage();T.navigateTo({url:"/pages/train/face/face?fromType=".concat(o,"&userName=").concat(u),callback:function(e){console.log("i'm back from facepage",e),e=(0,k.Zs)(e);var t=function(){var t=(0,s.Z)((0,a.Z)().mark((function t(){var n,r,s,i,u,d,p;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1!=o&&2!=o){t.next=14;break}if(0==e.certificationResultCode&&1==e.failCode?Qe("loginHB12306"):k.ZP.showToast("\u6838\u9a8c\u6210\u529f"),!l||"break"!=l){t.next=9;break}return i=1==(null===(s=e)||void 0===s?void 0:s.certificationResultCode),t.next=6,vn(i,0);case 6:c(),t.next=10;break;case 9:1==e.certificationResultCode&&(bn(),c());case 10:k.ZP.ubtTrace("hbchannel_open_success",{value:1==(null===(n=e)||void 0===n?void 0:n.certificationResultCode)}),k.ZP.ubtTrace("hbchannel_open_failure",{value:1!==(null===(r=e)||void 0===r?void 0:r.certificationResultCode)}),t.next=20;break;case 14:if(4!=o){t.next=20;break}return d=1==(null===(u=e)||void 0===u?void 0:u.certificationResultCode),p="nobreak"==l?2:null,t.next=19,vn(d,0,p);case 19:c();case 20:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();setTimeout((function(){t()}),500)}})}}function vn(){return gn.apply(this,arguments)}function gn(){return gn=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r,s,i,c,o,u=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=u.length>0&&void 0!==u[0]&&u[0],r=u.length>1&&void 0!==u[1]?u[1]:0,s=u.length>2?u[2]:void 0,i=m.GrabInterrupteV2||{},c=i.userId12306,o={Channel:"WX",OrderNumber:w,AccountName:7==s?null===et||void 0===et?void 0:et.userName12306:c||l.userId12306,FromType:null!==s&&void 0!==s?s:"A"==(null===(t=l.jLDetailInfo)||void 0===t?void 0:t.jLOrderStatus)?2:1,CheckFaceStatus:n?0:1,AuthenticationType:r},e.next=7,(0,g.DB)(o);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)}))),gn.apply(this,arguments)}function bn(){return wn.apply(this,arguments)}function wn(){return wn=(0,s.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return k.ZP.showLoading(),t={OrderNumber:w,FromType:2},e.next=4,(0,g.KS)(t);case 4:n=e.sent,k.ZP.hideLoading(),1==n.retCode?setTimeout((function(){Bt()}),2e3):k.ZP.showToast("none",n.retMessage||"\u5f00\u542f\u53cc\u901a\u9053\u62a2\u7968\u5931\u8d25");case 7:case"end":return e.stop()}}),e)}))),wn.apply(this,arguments)}Vt&&(kt=Vt.split("&")[0]==w&&Vt.split("&")[1]==jt.name),(0,d.useEffect)((function(){if(b){var e=getCurrentPages();1==e.length&&(bt.current=!0),yt(),St(),Nn()}}),[l,b]);var jn=(0,d.useCallback)(function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r,s,i,c,o,u,d;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return k.ZP.ubtTrace("c_trn_c_10650072279",{bizKey:"alternateOpenClick",scene:0}),e.next=3,(0,k.L5)({from:"orderdetail",push:3,traceFrom:"loginHB"});case 3:t=e.sent,n=(0,C.Z)(t,1),r=n[0],s=r.userName,i=void 0===s?"":s,c=r.loginPW,o=void 0===c?"":c,u=r.activateSuccess,d=void 0!==u&&u,d&&bn(),(0,k.rP)(i,o,-1,l);case 7:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),[l]);function Nn(){m.ChangeOrderAlternativeInfo&&ht(m.ChangeOrderAlternativeInfo.orderSerial)}return(0,L.jsxs)(x.View,{className:l.isBuyGrabIns?"anxin":l.isUserSuperMember?"vip":"",children:[(0,L.jsxs)(x.View,{className:"top-bar",style:"padding-top: "+u+"px",children:[(0,L.jsx)(x.Icon,{className:bt.current?"ifont-home":"ifont-back",onClick:pn}),(0,L.jsx)(x.View,{className:"tit",children:"\u8ba2\u5355\u8be6\u60c5"})]}),ot&&(0,L.jsx)(x.View,{className:"wrap",style:"padding-top: ".concat(u,"px"),children:(0,L.jsx)(F,{setShowGuideBox:lt,singleToDouble:bn})}),!ot&&(0,L.jsxs)(x.View,{className:"wrap",style:"padding-top: ".concat(u,"px"),children:[(0,L.jsx)(G,{orderSerial:pt,showActivationPop:function(){return Qe("activation")},showWeakGuide:xt}),S&&"D"!==I.jLOrderStatus&&(0,L.jsx)(z,{}),(null===m||void 0===m?void 0:m.MultipleBookingAndGrabSegmentation)&&(0,L.jsx)(rn,{multipleBookingAndGrabSegmentation:m.MultipleBookingAndGrabSegmentation}),(0,L.jsx)(tn,{popVisible:at,setPopVisible:st,showWeakGuide:xt,setShowWeakGuide:vt,orderSerial:pt,onClickWeakGuide:hn}),(0,L.jsx)(Et,{hbInfo:ee,updateHBInfo:Bt,bindAccountInfo:oe,changeOrderRedirect:ln,changeOrderPay:dn,isCanFaceAuthentication:J,singleToDouble:bn,setDirectShowPopKey:Qe,setDetailPopVisible:st}),1===pt&&(0,L.jsx)(gt,{userRights:O,grabTicketChangeInfo:xe,changeOrderPay:dn,isCanFaceAuthentication:J}),(0,L.jsx)(Wt,{forecastInfo:M}),(0,L.jsx)(Tt,{hbInfo:ee,forecastInfo:M,setHbOrderCancelInfo:tt,hbOrderCancelInfo:et,pushScanFaceResult:vn}),(0,L.jsx)(We,{}),1===pt&&(0,L.jsx)(Nt,{isCanFaceAuthentication:J,setDirectShowPopKey:Qe})]}),!ot&&(0,L.jsx)(He,{toBreakPage:hn,toScanFacePage:xn,directShowPopKey:Je,setDirectShowPopKey:Qe,robTaskInfo:H,nearByPopDetail:ae,isCanFaceAuthentication:J,hbInfo:ee,bindAccountInfo:oe,onClickLogin12306HBDialog:jn,grabRecommmendServiceInfo:pe,activationAssistedFriendList:we,grabTrain:Ve,recommendTrainList:Ze,recommendFloatingLayerInfo:Le,otherTrainsSeatsArr:Oe,hbAlertInfo:Me,popDataReady:Ee,changeOrderPay:dn})]})},on=cn,ln=h().train,un=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(e){var r;(0,c.Z)(this,n),r=t.call(this,e),r.checkPerformance=!0,r.pageId=S.Z.grabDetail;var a=(0,k.Zs)(ln.orderInfo||{});return r.state={loginFlag:!1,showType:ln.showType||"",orderInfo:a,firstIn:!1,isCancel:!1,subOrderId:"",sheredFlag:!1,statusBarHeight:0,onLoadReady:!1,extendValues:r.getExtendValues(a)},r}return(0,o.Z)(n,[{key:"onLoad",value:function(e){console.log("options",e);var t=e.params,n=void 0===t?"{}":t,r=f().getSystemInfoSync();this.setState((0,i.Z)((0,i.Z)({statusBarHeight:r.statusBarHeight},JSON.parse(n)),{},{firstIn:!0,onLoadReady:!0})),this.initalState(),this.tripConflictionHandler(this.state.orderInfo,n.isCancel)}},{key:"componentDidShow",value:function(){var e=this;setTimeout((function(){e.updateOrder(),e.onshareCb()}),1e3);var t=function(){h().user.nonmemberLogin((function(t){0===t.returnCode?e.setState({loginFlag:!0}):e.ctripLogin()}))};if(h().user.isLogin())this.state.loginFlag||h().user.checkLoginStatusFromServer((function(n){if(n)e.setState({loginFlag:!0});else{if(h().user.logout((function(){console.log("logout")})),"baidu"===Z.Z.miniProgramType)return void t();e.ctripLogin()}}));else{if("baidu"===Z.Z.miniProgramType)return void(this.hasGoLogin?this.navigateBack():(this.hasGoLogin=!0,this.ctripLogin()));h().user.wxLogin((function(){return console.log("\u5237\u65b0\u767b\u5f55\u6001")})),this.ctripLogin()}this.state.firstIn&&this.setState({firstIn:!1})}},{key:"onshareCb",value:function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.shareFlag&&(this.shareFlag=!1,this.setState({shereFlag:!0}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onPullDownRefresh",value:function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return k.ZP.showLoading(),e.prev=1,e.next=4,this.updateOrder();case 4:e.next=8;break;case 6:e.prev=6,e.t0=e["catch"](1);case 8:return e.prev=8,f().stopPullDownRefresh(),k.ZP.hideLoading(),e.finish(8);case 12:case"end":return e.stop()}}),e,this,[[1,6,8,12]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"onShareAppMessage",value:function(e){var t=h().getStorageSync("USERINFO");if("button"==e.from&&"activation"===e.target.id)return{title:"\u8fd9\u91ccVIP\u62a2\u7968\u7adf\u7136\u514d\u8d39\u4e86\uff01\u5c31\u5dee\u4f60\u5e2e\u6211\u70b9\u4e00\u4e0b",bu:"train",path:Z.Z.isCtripApp?"pages/home/homepage?toUrl=".concat(encodeURIComponent("/pages/train/activation/index?OrderNumber=".concat(this.state.orderInfo.orderId,"&Avatar=").concat(t.avatarUrl||""))):"/pages/train/activation/index?OrderNumber=".concat(this.state.orderInfo.orderId,"&avatar=").concat(t.avatarUrl||""),imageUrl:"https://images3.c-ctrip.com/train/app/827/qiangpiao/xcx/xcx_fm_qzl.png"};"button"===e.from&&"robtaskshare"===e.target.id&&(this.shareFlag=!0);var n=this.state.orderInfo.ticketInfos[0],r=n.arriveStation,a=n.passengerInfos.some((function(e){return 3==e.ticketType}));return console.log("\u5206\u4eab=============",e),(0,k.fT)({arriveStation:r,oid:this.state.orderInfo.orderId,avatar:encodeURIComponent(t.avatarUrl),shareImgs:this.state.shareImgs,filterType:"time",stuFlag:a})}},{key:"initalState",value:function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.getConfigInfos(),e.next=3,(0,g.Z8)("train_wx_robshare_shareimgs_20191219");case 3:t=e.sent,console.log(t),this.setState({shareImgs:t});case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getExtendValues",value:function(e){var t,n={};return null===(t=e.extendList)||void 0===t||t.forEach((function(e){if(e.value)try{if("ticketallowanceactivityalert"==e.key){var t=JSON.parse(e.value),r=t.content.split("\xa5");t.content=r[0],t.award=r[1],n.ticketallowanceactivityalert=t}if("ETicketGuidUserCheckFace"==e.key){var a=JSON.parse(e.value);try{a.desc=a.desc.replace(/&lt;/g,"<"),a.desc=a.desc.replace(/&gt;/g,">")}catch(e){console.log(e)}n.eTicketGuidUserCheckFace=a}else n[e.key]=JSON.parse(e.value)}catch(e){console.error("getExtendvalues",e)}})),n}},{key:"getConfigInfos",value:function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var t,n,r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={keys:["ctrip-miniapp-diagnosis-info-box","ctrip-scan-face-checkbox-flag","grabdetail-speed-activity","grabdetail-vipconfig","wechat_mini_grab_share"]},e.next=3,(0,g.Fz)(t);case 3:if(n=e.sent,1==n.resultCode){e.next=6;break}throw n.resultMessage;case 6:r={},n.configs.forEach((function(e){var t=e.key,n=e.data;switch(t){case"ctrip-miniapp-diagnosis-info-box":r.diagnosisInfoBox=(0,k.Zs)(n);break;case"ctrip-scan-face-checkbox-flag":var a=n.needCheck;r.scanFaceNeedCheck=a;break;case"grabdetail-speed-activity":r.speedActivityInfo=n;break;case"grabdetail-vipconfig":r.speedVipConfig=n;break;case"wechat_mini_grab_share":var s=(null===n||void 0===n?void 0:n[Z.Z.traceChannel])||{};r.grabShareConfig=s,s.closeOrderPageShare&&f().hideShareMenu();break;default:break}})),this.setState(r);case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"ctripLogin",value:function(){return new Promise((function(e,t){h().user.isLogin()&&e(),h().user.login({callback:function(n){0==n.ReturnCode?(T.WG.setAttr("auth",h().user.auth),e()):(this.navigateBack(),t())}})}))}},{key:"updateOrder",value:function(){var e=(0,s.Z)((0,a.Z)().mark((function e(t){var n,r,s;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.state.firstIn){e.next=2;break}return e.abrupt("return");case 2:return n=t||this.state.orderInfo.orderId,r={OrderId:n,ver:1,Channel:"WX"},e.next=6,(0,g.l)(r);case 6:if(s=e.sent,s.orderInfo){e.next=9;break}return e.abrupt("return");case 9:if(9!=s.orderInfo.orderStatus&&8!=s.orderInfo.orderStatus){e.next=11;break}return e.abrupt("return",h().redirectTo({url:"/pages/train/orderdetail/ordinary/ordinary?oid=".concat(n,"&from=tinyGrabDetail")}));case 11:this.setState({orderInfo:s.orderInfo,extendValues:this.getExtendValues(s.orderInfo)}),this.tripConflictionHandler(s.orderInfo,this.state.isCancel);case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"tripConflictionHandler",value:function(e,t){var n,r,a=t||!1,s=null,i=null===e||void 0===e||null===(n=e.extendList)||void 0===n||null===(n=n.find((function(e){return"TripConflict"===e.key})))||void 0===n?void 0:n.value;if(i)try{s="string"===typeof i?JSON.parse(i):i}catch(e){console.error(e)}return!(!s||"K"!==(null===e||void 0===e||null===(r=e.jLDetailInfo)||void 0===r?void 0:r.jLOrderStatus)||a)&&(h().redirectTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent("https://m.ctrip.com/webapp/train/itineraryConfliction?oid=".concat(e.orderId,"&needLogin=true")),"&data=").concat(JSON.stringify({needLogin:!0}))}),!0)}},{key:"render",value:function(){var e=this;return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(y.Provider,{value:{orderStates:(0,i.Z)({},this.state),updateOrder:this.updateOrder.bind(this),setState:this.setState.bind(this),pageFns:{navigateTo:this.navigateTo.bind(this),ubtTrace:this.ubtTrace.bind(this)}},children:(0,L.jsx)(on,{})}),(0,L.jsx)(x.View,{className:"view-check",onAnimationEnd:function(){return e.viewReadyHandle()}})]})}}]),n}(V),dn=un,pn={navigationBarTitleText:"\u62a2\u7968\u8be6\u60c5",navigationStyle:"custom",navigationBarBackgroundColor:"#ffffff",navigationBarTextStyle:"white",backgroundColor:"#EEF1F6",enablePullDownRefresh:!0,backgroundTextStyle:"dark",enableShareAppMessage:!0};dn.enableShareAppMessage=!0;Page((0,r.createPageConfig)(dn,"pages/trainOrder/orderdetail/grab/index",{root:{cn:[]}},pn||{}))},79181:function(e){e.exports=require("../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../cwx/ext/global")}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[560,2107,1216,8592],(function(){return t(66551)}));e.O()}]);
//# sourceMappingURL=index.js.map