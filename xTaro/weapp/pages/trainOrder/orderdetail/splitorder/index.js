"use strict";require("../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[8374],{34677:function(e,t,r){r.d(t,{Qb:function(){return i}});var n=r(88381);function a(e){var t=["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],r=t[e.day()];return"\u5468".concat(r)}function i(e){return o(e)||a(e)}function o(e){var t=(0,n.dayjs)().startOf("day"),r=e.startOf("day"),a=r.diff(t,"day");switch(a){case 0:return"\u4eca\u5929";case 1:return"\u660e\u5929";case 2:return"\u540e\u5929"}return""}},99299:function(e,t,r){var n=r(90201),a=r(71515),i=r(2269),o=function(e){var t=e.content;return"string"===typeof t||n.isValidElement(t)?t:null===t||void 0===t?void 0:t.map((function(e,t){return(0,i.jsx)(a.Text,{className:e.className||"",style:e.style,onClick:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),e.action&&e.action()},children:e.text},t)}))};function s(e){var t=e.icon,r=e.title,s=e.content,c=e.buttonList,u=void 0===c?[]:c,l=e.className,d=e.style,p=e.children,f=e.close,m=e.tip,h=e.onClose,v=(0,n.useMemo)((function(){return(0,i.jsx)(o,{content:s})}),[s]),x=(0,n.useMemo)((function(){return m&&!!m.content&&(0,i.jsx)(o,{content:m.content})}),[m]),g=(0,n.useMemo)((function(){return f&&(0,i.jsx)(a.View,{className:"".concat(f.className?f.className:"icon-closed ".concat(f.position||"")," "),onClick:f.action||h})}),[f,h]);return(0,i.jsxs)(a.View,{className:"modal-content ".concat(l||""),style:d,children:[g,t&&(0,i.jsx)(a.View,{className:t}),r&&(0,i.jsx)(a.View,{className:"tit",children:r}),(0,i.jsx)(a.View,{className:"txt",children:v}),p,(0,i.jsx)(a.View,{className:"btn-box",children:u.map((function(e,t){return(0,i.jsxs)(a.Button,{className:e.className?e.className:t===u.length-1?"btn-submit":"btn-cancel",style:e.style,onClick:e.action,"open-type":e.openType,"show-message-card":e.showMessageCard,"send-message-path":e.sendMessagePath,"send-message-title":e.sendMessageTitle,"send-message-img":e.sendMessageImg,children:[e.buttonName,(0,i.jsx)(a.Text,{children:e.buttonSubTitle})]},t)}))}),m&&(0,i.jsx)(a.View,{className:"tip-box",children:x})]})}t["Z"]=s},9645:function(e,t,r){r.r(t);var n=r(90201),a=r(71515),i=r(2269);function o(e){var t=e.item,r=e.onTripTimeTable,o=e.mock,s=(0,n.useCallback)((function(){r&&r(t)}),[r,t]);return(0,i.jsxs)(a.View,{className:"ticket-element-box ".concat(o?"loading-mock-skeleton":""),children:[(0,i.jsxs)(a.View,{className:"ticket-element-title-row",children:[(0,i.jsxs)(a.View,{className:"ticket-element-title  skeleton-item skeleton-square skeleton-shimmer",children:["\u7b2c",t.routeSequence,"\u7a0b"]}),t.orderTag&&(0,i.jsx)(a.View,{className:"ticket-element-tag".concat("\u4ed8\u8d39\u8d2d\u4e70"===t.orderTag?" blue":""),children:t.orderTag}),(0,i.jsx)(a.View,{className:"flex1"}),(0,i.jsx)(a.View,{className:"ticket-element-status skeleton-item skeleton-square skeleton-shimmer",children:t.orderStatusName})]}),(0,i.jsxs)(a.View,{className:"ticket-element-station-row",children:[(0,i.jsx)(a.View,{className:"flex1 flex-row",children:(0,i.jsxs)(a.View,{className:"flex-row skeleton-item skeleton-square skeleton-shimmer",children:[(0,i.jsxs)(a.View,{className:"station-time ".concat(t.departShiftDay>0?"shift-tag":""," "),children:[(0,i.jsx)(a.Text,{className:"skeleton-item",children:t.departTime}),t.departShiftDay>0&&(0,i.jsxs)(a.View,{className:"shift-tag",children:["+",t.departShiftDay]})]}),(0,i.jsx)(a.View,{children:t.departStation}),(0,i.jsx)(a.View,{className:"station-line",children:"-"}),(0,i.jsxs)(a.View,{className:"station-time ".concat(t.arriveShiftDay>0?"shift-tag":""),children:[(0,i.jsx)(a.Text,{children:t.arriveTime}),t.arriveShiftDay>0&&(0,i.jsxs)(a.View,{className:"shift-tag",children:["+",t.arriveShiftDay]})]}),(0,i.jsx)(a.View,{className:"station-time",children:t.arriveStation})]})}),(0,i.jsxs)(a.View,{className:"station skeleton-item skeleton-square skeleton-shimmer",onClick:s,children:[(0,i.jsx)(a.View,{className:"ifont-local"}),(0,i.jsx)(a.Text,{children:"\u7ecf\u505c\u7ad9"})]})]}),(0,i.jsx)(a.View,{className:"ticket-element-time-row",children:(0,i.jsx)(a.View,{className:"flex",children:(0,i.jsxs)(a.Text,{className:"skeleton-item skeleton-square skeleton-shimmer",children:[(0,i.jsx)(a.Text,{children:t.departDateString}),(0,i.jsx)(a.Text,{children:"\u51fa\u53d1 "}),(0,i.jsx)(a.Text,{children:t.trainNumber})]})})}),(0,i.jsx)(a.View,{children:t.passengerInfoList.map((function(e,t){return(0,i.jsxs)(a.View,{className:"ticket-element-pas-row skeleton-item skeleton-square skeleton-shimmer",children:[(0,i.jsx)(a.View,{children:e.passengerName}),1!=e.ticketType&&(0,i.jsx)(a.View,{className:"pas-type-tag ".concat(1==e.ticketType?"free":""),children:e.ticketTypeName}),(0,i.jsx)(a.View,{className:"flex1"}),-1!=e.ticketType&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.View,{children:e.seatName}),(0,i.jsxs)(a.View,{className:"margin-left",children:[e.ticketPrice,"\u5143"]}),e.seatNo&&(0,i.jsx)(a.View,{className:"margin-left ",children:e.seatNo})]})]},t)}))})]})}t["default"]=o},77523:function(e,t,r){r.r(t);var n=r(79301),a=r(95308),i=r(90129),o=r(90201),s=r(99299),c=r(71515),u=r(92954),l=r.n(u),d=r(48979),p=r(39765),f=r(12033),m=r(2269),h=[1,2,3,4,5,6],v=0;function x(e){var t=e.onClose,r=d.Z.useModel("ordinary"),u=(0,i.Z)(r,2),x=u[0],g=u[1],w=x.orderInfo,y=x.accountInfo,k=(0,o.useState)(""),N=(0,i.Z)(k,2),Z=N[0],S=N[1],T=(0,o.useState)(!0),b=(0,i.Z)(T,2),j=b[0],I=b[1],D=(0,o.useMemo)((function(){return[{buttonName:"\u53d6\u6d88",action:function(){t(0)}},{buttonName:"\u786e\u8ba4",action:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var r;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(Z.length<6)){e.next=3;break}return f.ZP.showToast("\u8bf7\u8f93\u51656\u4f4d\u6d88\u8d39\u5bc6\u7801","none"),e.abrupt("return");case 3:return e.prev=3,f.ZP.showLoading("\u6b63\u5728\u5151\u6362,\u8bf7\u8010\u5fc3\u7b49\u5f85"),e.next=7,g.orderPointPayNotify(Z);case 7:r=e.sent,f.ZP.hideLoading(),1===r.retCode&&1===r.pollingResult?(f.ZP.showToast("\u5151\u6362\u6210\u529f"),t(1)):(f.ZP.showToast(r.failReason||"\u5151\u6362\u5931\u8d25","error"),t({nextPop:"pointsPayFail"})),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](3),f.ZP.hideLoading(),f.ZP.showToast(e.t0.failReason||e.t0.message||"\u5151\u6362\u5931\u8d25","error");case 16:case"end":return e.stop()}}),e,null,[[3,12]])})));function r(){return e.apply(this,arguments)}return r}()}]}),[Z]),P=(0,o.useMemo)((function(){return{content:(0,m.jsx)(c.View,{className:"tip-text",onClick:(0,a.Z)((0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=d.Z.getModelDispatchers("ordinary"),e.next=3,t.getReset12306PasswordUrl();case 3:r=e.sent,l().navigateTo({url:r});case 5:case"end":return e.stop()}}),e)}))),children:"\u5fd8\u8bb0\u5bc6\u7801\uff1f\u70b9\u51fb\u53bb\u91cd\u7f6e"})}}),[]),C=(0,o.useCallback)((function(){j||I(v++)}),[j]),V=(0,o.useCallback)((function(){I(!1)}),[]),M=(0,o.useCallback)((function(){S("")}),[]),O=(0,o.useCallback)((function(e){console.log("e.detail.value---",e.detail.value),S(e.detail.value),e.detail.value.length>=h.length&&l().hideKeyboard()}),[]),R=(0,o.useMemo)((function(){var e=w.orderAmount,t=y.pointUseTotal,r=void 0===t?0:t;return{totalPoints:r,usePoint:e*p.Bg.EXCHANGE_RATE}}),[w,y]),L=R.totalPoints,Y=R.usePoint;return(0,m.jsx)(s.Z,{className:"pop-modal-blue point-pay-pop",buttonList:D,tip:P,children:(0,m.jsxs)(c.View,{children:[(0,m.jsx)(c.View,{className:"point-pay-pop-title",children:"\u8f93\u51656\u4f4d\u6d88\u8d39\u5bc6\u7801"}),(0,m.jsxs)(c.View,{className:"point-pay-count-row",children:[(0,m.jsx)(c.View,{children:"\u8d26\u6237\u79ef\u5206\u4f59\u989d"}),(0,m.jsxs)(c.View,{className:"highlight",children:[L,"\u5206"]})]}),(0,m.jsxs)(c.View,{className:"point-pay-count-row",children:[(0,m.jsx)(c.View,{children:"\u672c\u6b21\u6d88\u8d39\u79ef\u5206"}),(0,m.jsxs)(c.View,{className:"highlight",children:[Y,"\u5206"]})]}),(0,m.jsx)(c.View,{className:"point-pay-tips highlight",children:"\u79ef\u5206\u5151\u6362\u7684\u8f66\u7968\u4e0d\u53ef\u9000\u7968\uff0c\u8bf7\u786e\u8ba4\u540e\u5151\u6362"}),(0,m.jsxs)(c.View,{className:"point-pay-input-container",children:[(0,m.jsx)(c.View,{className:"input-grid",onClick:C,children:h.map((function(e,t){return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(c.View,{className:"item",children:(0,m.jsx)(c.View,{className:"input-text ".concat(Z[t]?"black":""),children:Z[t]})}),t!=h.length-1&&(0,m.jsx)(c.View,{className:"split-line"})]},t)}))}),(0,m.jsx)(c.Input,{adjustPosition:!0,className:"point-pay-input",placeholder:"",onFocus:M,value:Z,focus:j,onBlur:V,maxlength:h.length,onInput:O,onChange:O})]})]})})}t["default"]=x},24338:function(e,t,r){r.r(t);var n=r(79301),a=r(95308),i=r(90201),o=r(92954),s=r.n(o),c=r(48979),u=r(99299),l=r(2269);function d(e){var t=e.onClose,r=(0,i.useMemo)((function(){return[{buttonName:"\u91cd\u7f6e\u5bc6\u7801",action:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var r,a;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t(0),r=c.Z.getModelDispatchers("ordinary"),e.next=4,r.getReset12306PasswordUrl();case 4:a=e.sent,s().navigateTo({url:a});case 6:case"end":return e.stop()}}),e)})));function r(){return e.apply(this,arguments)}return r}()},{buttonName:"\u518d\u6b21\u8f93\u5165",action:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t({nextPop:"pointsPay"});case 1:case"end":return e.stop()}}),e)})));function r(){return e.apply(this,arguments)}return r}()}]}),[]);return(0,l.jsx)(u.Z,{onClose:t,close:!0,className:"pop-modal-blue",title:"\u6d88\u8d39\u5bc6\u7801\u9519\u8bef \n \u8bf7\u9009\u62e9\u518d\u6b21\u8f93\u5165\u6216\u91cd\u7f6e\u5bc6\u7801",buttonList:r})}t["default"]=d},42976:function(e,t,r){var n=r(32180),a=r(79301),i=r(298),o=r(95308),s=r(57042),c=r(24460),u=r(81876),l=r(21867),d=r(86066),p=r(45023),f=r(90201),m=r(92954),h=r.n(m),v=r(48979),x=r(65542),g=r(2269);function w(e){return e.displyName||e.name||"component"}var y=v.Z.Provider;function k(e){var t=function(t){(0,l.Z)(n,t);var r=(0,d.Z)(n);function n(e){var t;(0,s.Z)(this,n),t=r.call(this,e),(0,p.Z)((0,u.Z)(t),"pageQuery",{}),(0,p.Z)((0,u.Z)(t),"routerInfo",void 0),(0,p.Z)((0,u.Z)(t),"_pageComponentRef",null),(0,p.Z)((0,u.Z)(t),"_setRef",(function(e){console.log("ref-----",e),t._pageComponentRef=e}));var a=(0,m.getCurrentInstance)(),i=a.router;return t.pageQuery=i.params,t.routerInfo=i,t}return(0,c.Z)(n,[{key:"componentDidShow",value:function(){this._pageComponentRef&&this._pageComponentRef.componentDidShow&&this._pageComponentRef.componentDidShow.apply(this._pageComponentRef,arguments)}},{key:"onShareAppMessage",value:function(){this._pageComponentRef&&this._pageComponentRef.onShareAppMessage&&this._pageComponentRef.onShareAppMessage.apply(this._pageComponentRef,arguments)}},{key:"render",value:function(){return console.log("==========",this.props),(0,g.jsx)(y,{children:(0,g.jsx)(e,(0,i.Z)({ref:this._setRef,pageQuery:this.pageQuery,routerInfo:this.routerInfo,page:this},this.props))})}}]),n}(x.Z);return(0,p.Z)(t,"displayName","StoreWrapped".concat(w(e))),t}var N=r(82566),Z=r(99263),S=r(56884),T=r.n(S),b=r(67);function j(){return I.apply(this,arguments)}function I(){return I=(0,o.Z)((0,a.Z)().mark((function e(){var t,r=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:2,T().user.isLogin()){e.next=9;break}if(2!==t){e.next=6;break}return e.next=5,D(!1);case 5:return e.abrupt("return",e.sent);case 6:return e.abrupt("return",!1);case 9:return e.abrupt("return",new Promise((function(e,r){T().user.checkLoginStatusFromServer(function(){var r=(0,o.Z)((0,a.Z)().mark((function r(n){var i;return(0,a.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(i=!1,n){r.next=8;break}if(2!==t){r.next=6;break}return r.next=5,D(!0);case 5:i=r.sent;case 6:r.next=9;break;case 8:i=!0;case 9:e(i);case 10:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())})));case 10:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function D(e){return P.apply(this,arguments)}function P(){return P=(0,o.Z)((0,a.Z)().mark((function e(t){var r,n,i;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=function(){return new Promise((function(e,t){T().user.nonmemberLogin((function(t){0===t.returnCode?e(!0):e(!1)}))}))},n=function(){return new Promise((function(e,t){T().user.login({callback:function(t){0==t.ReturnCode?(b.WG.setAttr("auth",T().user.auth),e(!0)):e(!1)}})}))},!t||"baidu"!==Z.Z.miniProgramType){e.next=8;break}return e.next=5,r();case 5:if(i=e.sent,!i){e.next=8;break}return e.abrupt("return",i);case 8:return e.next=10,n();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)}))),P.apply(this,arguments)}var C,V=r(51531),M=r(90129),O=r(71515),R=function(){return(0,m.getMenuButtonBoundingClientRect)()};function L(){if(C)return C;var e=(0,m.getSystemInfoSync)(),t=e,r=t.statusBarHeight;return r&&!Number.isNaN(r)||(e=(0,i.Z)((0,i.Z)({},e),{},{statusBarHeight:20})),C=e}var Y=function(){var e=L()||{},t=e.safeArea,r=e.screenHeight,n=e.statusBarHeight;if(t&&t.bottom>0){var a=r-t.bottom;return 0===a&&n>25&&(a=34),{top:t.top,bottom:a,left:0,right:0}}return{top:0,bottom:0,left:0,right:0}},B=function(){var e=L(),t=e.statusBarHeight,r=void 0===t?0:t,n=e.platform,a="android"===n?48:40,i=R(),o=i.top,s=i.height;return o&&0!==o&&s&&0!==s?2*(o-r)+s:a},q=r(61981),E=r(12033);function A(e,t,r){var n=(0,f.useState)(0),i=(0,M.Z)(n,2),s=i[0],c=i[1],u=(0,f.useRef)(0),l=(0,f.useRef)(null);function d(e,t){(0,o.Z)((0,a.Z)().mark((function t(){var r;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=function(){var t=(0,o.Z)((0,a.Z)().mark((function t(r){var n;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,q.GetPreHoldSeatResult)({userId:T().user.auth,orderNumber:e,pollingKey:(null===r||void 0===r?void 0:r.pollingKey)||""});case 2:if(n=t.sent,1!==n.retCode&&0!==n.retCode){t.next=5;break}return t.abrupt("return",n);case 5:return n.holdSchedule>u.current&&(u.current=n.holdSchedule),t.abrupt("return",{pollingFlag:!0,pollingRate:n.requestRate,pollingKey:n.pollingKey});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),t.next=3,(0,E.nP)(r);case 3:t.sent;case 4:case"end":return t.stop()}}),t)})))(),l.current=setInterval((function(){c((function(e){if(e<99){var r=e+1;return u.current>r&&(r=u.current),r}return t(),l.current&&clearInterval(l.current),l.current=null,99}))}),300*Math.random()+100)}return(0,f.useEffect)((function(){e&&t&&d(e,r)}),[e,t,r]),{percent:s}}var H=r(88381),F=r(68277),G=["requiredMap","loadingView"],_=0,U=1,K=function(e,t){return"function"===typeof t?t(e):t===e};function Q(e){var t=e.Component,r=e.Loading,n=e.requiredMap,a=void 0===n?{}:n,o=f.forwardRef((function(e,n){var o=(0,f.useState)(_),s=(0,M.Z)(o,2),c=s[0],u=s[1],l=e.requiredMap,d=e.loadingView,p=(0,F.Z)(e,G);return(0,f.useLayoutEffect)((function(){if(c!==U){var t=Object.keys(l||{}),r=a;t.length>0&&(r=(0,i.Z)((0,i.Z)({},a),{},{instanceRequiredKeyMap:l}));var n=Object.keys(r),o=n.length,s=!0;if(o>0){for(var d=0;d<o;d++){var p=n[d],f=e[p],m=r[p],h=K(f,m);if(!h){s=!1;break}}s&&u(U)}else u(U)}}),[e]),c===_?d||(0,g.jsx)(r,{}):(0,g.jsx)(t,(0,i.Z)((0,i.Z)({},p),{},{ref:n}))}));return o.displayName=t.displayName,o}function J(e){var t=e.Component,r=e.mockProps;return f.memo((function(){return console.log("mockProps----"),(0,g.jsx)(t,(0,i.Z)({},r))}))}var W="\u6b63\u5728\u4e3a\u60a8\u5360\u5ea7\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85";function z(e){var t,r,n=e.countdownOrderTips,a=(e.bookTips,e.isPreHolding),i=e.isShowRobSame,o=e.orderInfo,s=(0,f.useState)({countDown:"",displayCountdown:!1}),c=(0,M.Z)(s,2),u=c[0],l=c[1],d=(0,f.useRef)(null);return(0,f.useEffect)((function(){var e=function(){d.current&&clearInterval(d.current),d.current=null};if(n){var t=function t(){var r=Math.trunc((0,H.dayjs)(o.lastPayTime,"YYYY-MM-DD HH:mm:ss").valueOf()/1e3),n=Math.trunc((0,H.dayjs)().valueOf()/1e3);if(n>=r)l({countDown:"",displayCountdown:!1}),e();else{var a=E.ZP.pad(Math.trunc((r-n)/60)),i=E.ZP.pad(Math.trunc((r-n)%60)),s=a+"\u5206"+i+"\u79d2";l({countDown:s,displayCountdown:!0})}return t};d.current=setInterval(t(),1e3)}return e}),[n,o]),n?u.displayCountdown?(0,g.jsxs)(O.View,{className:"txt skeleton-item skeleton-square skeleton-shimmer",children:["\u5ea7\u4f4d\u5df2\u6210\u529f\u9501\u5b9a\uff01\u8bf7\u5728",(0,g.jsx)(O.Text,{className:"orange",children:u.countDown}),"\u5185\u5b8c\u6210\u652f\u4ed8\u3002"]}):(0,g.jsx)(O.View,{className:"txt skeleton-item skeleton-square skeleton-shimmer",children:"\u5ea7\u4f4d\u5df2\u6210\u529f\u9501\u5b9a\uff01\u8bf7\u5c3d\u5feb\u5b8c\u6210\u652f\u4ed8\u3002"}):a?(0,g.jsx)(O.View,{className:"txt skeleton-item skeleton-square skeleton-shimmer",children:(null===o||void 0===o||null===(t=o.orderStatusBarInfo)||void 0===t?void 0:t.statusNameDesc)||W}):i?(0,g.jsx)(O.View,{className:"txt skeleton-item skeleton-square skeleton-shimmer",children:(0,g.jsx)(O.Text,{className:"qiangpiao-txt",children:null===o||void 0===o?void 0:o.failReason})}):(0,g.jsx)(O.View,{className:"txt skeleton-item skeleton-square skeleton-shimmer",children:(0,g.jsx)(O.RichText,{nodes:null===o||void 0===o||null===(r=o.orderStatusBarInfo)||void 0===r?void 0:r.statusNameDesc})})}function X(e){var t,r,n,a=e.orderInfo,i=e.extendValues,o=e.isSuccess,s=e.paidSuccess,c=e.isPreHolding,u=e.isLoading;return u?(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(O.View,{className:"status",children:(0,g.jsx)(O.View,{className:"icon icon-status-loading"})})}):c?(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(O.View,{className:"status",children:[(0,g.jsx)(O.View,{className:"icon icon-status-loading"}),(0,g.jsx)(O.View,{className:"icon icon-seat"})]})}):o||s?(0,g.jsx)(O.View,{className:"icon icon-status-suc"}):a.enablePayOrder?(0,g.jsx)(O.View,{className:"icon icon-status-refund"}):a.enablePayOrder||o?25==(null===a||void 0===a||null===(t=a.alertInfo)||void 0===t?void 0:t.alertType)||23==(null===a||void 0===a||null===(r=a.alertInfo)||void 0===r?void 0:r.alertType)&&2==(null===i||void 0===i||null===(n=i.eTicketUser12306Process)||void 0===n?void 0:n.guideCode)?(0,g.jsx)(O.View,{className:"icon icon-status-fail"}):null:(0,g.jsx)(O.View,{className:"icon icon-status-fail"})}var $=f.memo(X);function ee(e){var t,r,n=e.orderInfo,a=e.extendValues,i=void 0===a?{}:a,o=e.orderFlags,s=e.updateOrder,c=(e.mock,o.isSuccess),u=o.paidSuccess,l=o.isPreHolding,d=o.isShowRobSame,p=o.countdownOrderTips,f=o.isLoading,m=n.orderId,h=A(m,l,s),v=h.percent;return(0,g.jsxs)(O.View,{className:"order-status ".concat(""),children:[(0,g.jsx)(O.View,{className:"status",children:(0,g.jsx)($,{orderInfo:n,extendValues:i,isSuccess:c,paidSuccess:u,isPreHolding:l,isLoading:f})}),(0,g.jsxs)(O.View,{className:"cont",children:[(0,g.jsx)(O.View,{className:"tit ",children:(0,g.jsx)(O.Text,{className:"skeleton-item skeleton-square skeleton-shimmer",children:l?(null===n||void 0===n||null===(t=n.orderStatusBarInfo)||void 0===t?void 0:t.statusName)+" "+v+"%":null===n||void 0===n||null===(r=n.orderStatusBarInfo)||void 0===r?void 0:r.statusName})}),(0,g.jsx)(z,{countdownOrderTips:p,isPreHolding:l,isShowRobSame:d,orderInfo:n})]})]})}var te=Q({Component:ee,Loading:J({Component:ee,mockProps:{mock:!0,orderFlags:{isLoading:!0},orderInfo:{orderId:"----",orderStatusBarInfo:{statusName:"\u6b63\u5728\u52a0\u8f7d...",statusNameDesc:"\u8bf7\u8010\u5fc3\u7b49\u5f85"}}}}),requiredMap:{orderInfo:function(e){return e&&e.orderId}}});function re(e){var t=e.notice;return t?(0,g.jsx)(O.View,{className:"notice-container",children:(0,g.jsx)(O.RichText,{nodes:t})}):null}var ne=re,ae=r(70245),ie=r(34677),oe=[0,1,2],se=f.lazy((function(){return Promise.resolve().then((function(){return(0,ae.Z)(r(9645))}))}));function ce(e){var t=e.orderInfo,r=e.extendValues,n=e.onTimeTable,a=e.mock,i=(0,f.useMemo)((function(){if(r&&r.multipleBookingAndGrabSegmentation)return{tripElements:t.splitOrderTicketList,TripElementRender:se};var e=oe.includes(t.orderStatus),n=(t.ticketInfos||[]).map((function(e){var r=(0,H.dayjs)(e.departDate,"YYYY-MM-DD");return{departShiftDay:e.departShiftDay,arriveShiftDay:e.arriveShiftDay,routeSequence:e.routeSequence,trainNumber:e.trainNumber,departStation:e.departStation,arriveStation:e.arriveStation,departDateString:r.format("MM\u6708DD\u65e5")+" "+(0,ie.Qb)(r),departTime:e.departTime,arriveTime:e.arriveTime,ticketEntrance:e.ticketEntrance,electronicNumber:e.electronicNumber,orderStatusName:t.OrderStatusName,orderTag:"",passengerInfoList:e.passengerInfos.map((function(t){var r=t.realTicketInfo;return{passengerName:t.passengerName,seatName:(null===r||void 0===r?void 0:r.dealSeatNo)||e.seatName,seatNo:(null===r||void 0===r?void 0:r.dealSeatNo)||"",ticketType:t.ticketType,ticketTypeName:t.ticketTypeName,ticketPrice:e.ticketPrice}}))}}));return{tripElements:n,TripElementRender:e?se:(0,g.jsx)(O.View,{})}}),[r,t]),o=i.tripElements,s=i.TripElementRender;return(0,g.jsx)(g.Fragment,{children:o.map((function(e,t){return(0,g.jsx)(f.Suspense,{fallback:(0,g.jsx)(O.View,{}),children:(0,g.jsx)(s,{item:e,onTripTimeTable:n,mock:a},t)})}))})}var ue=Q({Component:ce,Loading:J({Component:ce,mockProps:{mock:!0,orderInfo:{orderId:"-----",splitOrderTicketList:[{routeSequence:1,trainNumber:"----",departStation:"----",arriveStation:"----",departDate:"-----",arriveDate:"-----",departTime:"-----",arriveTime:"-----",departDateTime:"--------------",arriveDateTime:"--------------",departDateString:"------ --",ticketEntrance:"---",electronicNumber:"----",orderStatusName:"----",orderTag:"",seatName:"---",passengerInfoList:[{passengerName:"---",seatName:"---",ticketPrice:"---",ticketType:1,ticketTypeName:"---"}]},{routeSequence:2,trainNumber:"----",departStation:"----",arriveStation:"----",departDate:"-----",arriveDate:"-----",departTime:"-----",arriveTime:"-----",departDateTime:"--------------",arriveDateTime:"--------------",departDateString:"------ --",ticketEntrance:"---",electronicNumber:"----",orderStatusName:"----",orderTag:"",seatName:"---",passengerInfoList:[{passengerName:"---",seatName:"---",ticketPrice:"---",ticketType:1,ticketTypeName:"---"}]}]},extendValues:{multipleBookingAndGrabSegmentation:{}}}}),requiredMap:{orderInfo:function(e){return e&&e.orderId}}});function le(e){var t=e.tripElement,r=e.hideTime;return 3!==(null===t||void 0===t?void 0:t.length)&&console.error("".concat(null===t||void 0===t?void 0:t.length," !== 3 ,\u6e32\u67d3\u6837\u5f0f\u53ef\u80fd\u4f1a\u6709\u95ee\u9898")),(0,g.jsxs)(O.View,{className:"scheme-stride",children:[(0,g.jsx)(O.View,{className:"line-solid first"}),(0,g.jsx)(O.View,{className:"line-solid last"}),(0,g.jsx)(O.View,{className:"stride-info",children:null===t||void 0===t?void 0:t.map((function(e,t){return"from"===e.type||"to"===e.type?(0,g.jsxs)(O.View,{className:"info-item flex1",children:[(0,g.jsx)(O.View,{className:"time ".concat(r?"hide":""),children:(0,g.jsx)(O.Text,{className:"skeleton-item skeleton-square skeleton-shimmer",children:e.time})}),(0,g.jsx)(O.View,{className:"station",children:(0,g.jsx)(O.Text,{className:"skeleton-item skeleton-square skeleton-shimmer",children:e.station})}),(0,g.jsx)(O.View,{className:"dot-dark skeleton-item skeleton-square skeleton-shimmer"}),(0,g.jsx)(O.View,{className:"".concat(e.infoType," skeleton-item skeleton-square skeleton-shimmer"),children:e.info})]},t):"tag"===e.type?(0,g.jsxs)(O.View,{className:"tag-item skeleton-item skeleton-square skeleton-shimmer",children:[(0,g.jsx)(O.View,{className:"time tgrey ".concat(r?"hide":""),children:(0,g.jsx)(O.Text,{className:"skeleton-item skeleton-square skeleton-shimmer",children:e.time})}),(0,g.jsx)(O.View,{className:"station tgrey",children:e.station}),(0,g.jsx)(O.View,{className:"".concat(e.infoType," skeleton-item skeleton-square skeleton-shimmer"),children:e.info})]},t):(0,g.jsxs)(O.View,{className:"info-item",children:[(0,g.jsx)(O.View,{className:"time tgrey ".concat(r?"hide":""),children:(0,g.jsx)(O.Text,{className:"skeleton-item skeleton-square skeleton-shimmer",children:e.time})}),(0,g.jsx)(O.View,{className:"station tgrey center ",children:(0,g.jsx)(O.Text,{className:"skeleton-item skeleton-square skeleton-shimmer",children:e.station})}),(0,g.jsxs)(O.View,{className:"".concat(e.infoType," skeleton-item skeleton-square skeleton-shimmer"),children:[(0,g.jsx)(O.View,{className:"trans-icon"}),e.info]})]},t)}))})]})}var de=le;function pe(e){var t=e.orderInfo,r=e.extendValues,n=e.mock,a=void 0!==n&&n,i=(0,f.useMemo)((function(){var e=[],n="";if(r&&r.multipleBookingAndGrabSegmentation){var a,i,o=null===t||void 0===t||null===(a=t.tripAxis)||void 0===a?void 0:a.axisInfo;e=(null===t||void 0===t||null===(i=t.tripAxis)||void 0===i?void 0:i.tripElement)||[],n=null!==o&&void 0!==o&&o.sameTrain?'\u8bf7\u5728<span style="color:#006FF6;">'.concat(null===o||void 0===o?void 0:o.transferStation,"</span>\u6362\u4e2a\u5ea7\u4f4d\uff0c\u65e0\u9700\u4e0b\u8f66").concat(null!==o&&void 0!==o&&o.combinSeatChangeTrainNum?"\uff0c".concat(null===o||void 0===o?void 0:o.combinSeatChangeTrainStation,'\u7ad9\u8f66\u6b21\u53f7<span style="color:#006FF6;">\u53d8\u66f4\u4e3a').concat(null===o||void 0===o?void 0:o.combinSeatChangeTrainNum,"</span>"):""):"\u5230\u8fbe".concat(null===o||void 0===o?void 0:o.transferStation,'\uff0c\u8bf7\u5728<span style="color:#006FF6;">').concat(null===o||void 0===o?void 0:o.transferTime,"\u5185\u6362\u4e58</span>")}return{tripElement:e,titleNodes:n}}),[t,r]),o=i.tripElement,s=i.titleNodes;return o&&o.length>0&&(0,g.jsxs)(O.View,{className:"trip-axis-box ".concat(a?"loading-mock-skeleton":""),children:[(0,g.jsx)(O.View,{className:"title-view skeleton-item skeleton-square skeleton-shimmer",children:(0,g.jsx)(O.RichText,{nodes:s})}),(0,g.jsx)(de,{tripElement:o,hideTime:!0})]})}var fe=Q({Component:pe,Loading:J({Component:pe,mockProps:{mock:!0,orderInfo:{orderId:"-----------",tripAxis:{axisInfo:{transferStation:"----",sameTrain:!0},tripElement:[{time:"----",station:"------",info:"------",infoType:"tag-grey start",type:"from"},{time:"----",station:"------",info:"------",infoType:"tag-grey",type:"info"},{time:"----",station:"------",info:"------",infoType:"tag-grey end",type:"to"}]}},extendValues:{multipleBookingAndGrabSegmentation:{}}}}),requiredMap:{orderInfo:function(e){return e&&e.orderId}}}),me=Y(),he=me.top,ve=me.bottom,xe=B(),ge={"--safe-padding-bottom":ve+"px","--status-bar-height":he+"px","--nav-bar-height":xe+"px"};function we(e){var t=e.children,r=e.className,n=void 0===r?"":r,a=e.containerClassName,i=e.holdPlace,o=void 0!==i&&i;return(0,g.jsxs)(O.View,{className:"bottom-bar-container ".concat(a||""),style:ge,children:[o&&(0,g.jsx)(O.View,{className:"bottom-bar-placeholder safe-padding-bottom"}),(0,g.jsx)(O.View,{className:"bottom-bar safe-padding-bottom ".concat(n||""),children:t})]})}var ye=f.memo(we);function ke(e){var t=e.title,r=e.desc,n=e.tag,a=e.showExplain,i=void 0===a?function(){}:a,o=e.isTitle,s=void 0!==o&&o,c=e.type,u=void 0===c?"":c,l=e.icon;return(0,g.jsxs)(O.View,{className:"detail-row ".concat(s?"title-row":""),children:[l&&(0,g.jsx)(O.View,{className:"icon",children:l}),(0,g.jsx)(O.View,{className:"title",children:t}),(0,g.jsx)(O.View,{className:"icon-font icon-question ".concat(i?"":"hidden"),onClick:function(){i&&i()}}),(0,g.jsx)(O.View,{className:"tag",children:n}),(0,g.jsx)(O.View,{className:"flex1"}),(0,g.jsx)(O.View,{className:"desc ".concat(u),children:r})]})}function Ne(e){var t=e.showPriceDetail,r=e.toggleShowPriceDetail,n=e.priceList;return(0,g.jsxs)(O.View,{className:"price-detail-container ".concat(t?"show":"close"),children:[(0,g.jsx)(O.View,{className:"mask",onClick:r}),(0,g.jsxs)(O.View,{className:"price-detail-content",children:[(0,g.jsxs)(O.View,{className:"detail-title",children:[(0,g.jsx)(O.View,{children:"\u91d1\u989d\u660e\u7ec6"}),(0,g.jsx)(O.View,{className:"close",onClick:r,children:(0,g.jsx)(O.View,{className:"icon-font icon-close"})})]}),(0,g.jsx)(O.View,{className:"content",children:n&&n.map((function(e,t){return(0,g.jsx)(ke,{title:e.name,tag:e.tag,desc:e.priceInfo,icon:e.icon},t)}))})]})]})}var Ze=Ne;function Se(e){var t=e.orderInfo,r=e.extendValues,n=e.onPayClick,a=(0,f.useState)(!1),i=(0,M.Z)(a,2),o=i[0],s=i[1],c=(0,f.useCallback)((function(){null!==t&&void 0!==t&&t.enablePayOrder?n&&n(0):h().showToast({title:"\u5f53\u524d\u72b6\u6001\u4e0d\u53ef\u652f\u4ed8\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",icon:"none",duration:2e3,mask:!0})}),[t,r,n]),u=(0,f.useMemo)((function(){var e,n=null===t||void 0===t||null===(e=t.orderPriceList)||void 0===e?void 0:e.map((function(e){return{name:e.orderPriceName,tag:"",priceInfo:e.orderPriceValue}})),a=t.orderAmount;if(r&&r.multipleBookingAndGrabSegmentation&&(a=r.multipleBookingAndGrabSegmentation.totalOrderPrice),null!==t&&void 0!==t&&t.enablePayOrder){var i={showPayBar:!0,orderPrice:a,payButton:"\u53bb\u652f\u4ed8",orderPriceList:n};return i}return{showPayBar:!1,orderPrice:a,payButton:"\u53bb\u652f\u4ed8",orderPriceList:n}}),[t,r]),l=u.orderPrice,d=u.payButton,p=u.showPayBar,m=u.orderPriceList,v=(0,f.useCallback)((function(){s(!o)}),[s,o]);return p&&(0,g.jsxs)(ye,{holdPlace:!0,className:"order-pay-bottom-bar",containerClassName:"order-pay-bottom-bar-container",children:[(0,g.jsx)(Ze,{priceList:m,showPriceDetail:o,toggleShowPriceDetail:v}),(0,g.jsxs)(O.View,{className:"pay-box",children:[(0,g.jsx)(O.View,{className:"price-box number-zx2",children:(0,g.jsxs)(O.Text,{children:[(0,g.jsx)(O.Text,{className:"unit",children:"\xa5"}),(0,g.jsx)(O.Text,{children:l})]})}),(0,g.jsxs)(O.View,{className:"rbox",onClick:v,children:[(0,g.jsx)(O.View,{children:"\u660e\u7ec6"}),(0,g.jsx)(O.Text,{className:"ifont-arr".concat(o?" open":"")})]}),(0,g.jsx)(O.Button,{className:"btn-pay",onClick:c,children:d})]})]})}var Te=Se;function be(e){return je.apply(this,arguments)}function je(){return je=(0,o.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={orderID:t,IsAsyn:!0,RescheduleOrderNumber:"",Action:1},e.abrupt("return",(0,q.ur)(r).catch((function(e){return null})));case 2:case"end":return e.stop()}}),e)}))),je.apply(this,arguments)}function Ie(e,t){return De.apply(this,arguments)}function De(){return De=(0,o.Z)((0,a.Z)().mark((function e(t,r){var n,i;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(r){var n,i;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={orderID:t,RescheduleOrderNumber:"",isAsyn:!0,pollingKey:(null===r||void 0===r?void 0:r.pollingKey)||""},e.next=3,(0,q.fU)(n);case 3:if(i=e.sent,1!=i.code){e.next=6;break}return e.abrupt("return",i);case 6:return e.abrupt("return",{pollingFlag:!0,pollingRate:i.pollingRate,pollingKey:i.pollingKey});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.prev=1,e.next=4,(0,E.nP)(n,void 0,10);case 4:return i=e.sent,e.abrupt("return",i);case 8:return e.prev=8,e.t0=e["catch"](1),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),De.apply(this,arguments)}function Pe(e){(0,f.useRef)(!0);(0,f.useEffect)((function(){var e=setInterval((function(){var e=v.Z.getModelState("ordinary"),t=e.orderInfo,r=e.extendValues,n=e.loopRefresh;if((0,E.AQ)(t,r)&&n){var a=v.Z.getModelDispatchers("ordinary");a.updateOrder()}}),5e3);return function(){e&&clearInterval(e)}}),[]),(0,f.useEffect)((function(){var e,t=v.Z.getModelState("ordinary"),r=t.orderInfo,n=(t.orderFlags,t.extendValues);v.Z.getModelDispatchers("ordinary");null!==n&&void 0!==n&&n.multipleBookingAndGrabSegmentation&&(null===n||void 0===n||null===(e=n.multipleBookingAndGrabSegmentation)||void 0===e?void 0:e.groupOrderStatus)>1&&setTimeout((function(){h().redirectTo({url:"/pages/train/orderdetail/orderdetail?oid=".concat(r.orderId)})}),1e3)}),[e]);var t=(0,f.useCallback)((0,o.Z)((0,a.Z)().mark((function t(){var r,n;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,E.gw)(1e3);case 2:return r=v.Z.getModelState("ordinary"),r.orderInfo,r.orderFlags,r.extendValues,n=v.Z.getModelDispatchers("ordinary"),t.next=7,n.stopLoopRefresh();case 7:return t.next=9,be(e.orderId);case 9:return t.next=11,Ie(e.orderId);case 11:return n.updateOrder(),t.next=14,n.startLoopRefresh();case 14:case"end":return t.stop()}}),t)}))),[]);return{processPayResult:t}}var Ce={bottom:"botm",middle:"mid"},Ve=function(e){var t=e.children,r=e.direction,n=void 0===r?"bottom":r,a=e.className,i=void 0===a?"":a,o=e.visible,s=void 0!==o&&o,c=e.mask,u=void 0===c||c,l=e.clickMaskClose,d=void 0!==l&&l,p=e.lock,m=void 0===p||p,h=e.zIndex,v=void 0===h?9999:h,x=e.close,w=Ce[n],y=(0,f.useState)(!1),k=(0,M.Z)(y,2),N=k[0],Z=k[1],S=(0,f.useState)(!1),T=(0,M.Z)(S,2),b=T[0],j=T[1];(0,f.useEffect)((function(){s?setTimeout((function(){j(!0)}),10):j(!1),setTimeout((function(){Z(s)}),300)}),[s]);var I=function(){d&&(null===x||void 0===x||x())};if(!s&&!N)return null;var D="popup ".concat(w," ").concat(b?"active":""," ").concat(i),P={zIndex:v};return(0,g.jsxs)(g.Fragment,{children:[u&&(0,g.jsx)(O.View,{className:(0,H.classnames)("popup-mask",{active:b}),style:s?P:{},onClick:I,catchMove:!0}),(0,g.jsx)(O.View,{className:D,style:s?P:{},catchMove:m,children:t})]})},Me=Ve;function Oe(e){switch(e){case"pointsPay":return f.lazy((function(){return Promise.resolve().then((function(){return(0,ae.Z)(r(77523))}))}));case"pointsPayFail":return f.lazy((function(){return Promise.resolve().then((function(){return(0,ae.Z)(r(24338))}))}));default:return null}}var Re=Oe;function Le(e){switch(e){default:return"middle"}}function Ye(e){switch(e){case"pointsPay":return!1;default:return!0}}var Be=Ye;function qe(){var e=v.Z.useModel("ordinary"),t=(0,M.Z)(e,2),r=t[0],n=t[1],a=r.popType,i=(0,f.useMemo)((function(){return{ModalViewType:Re(a),modalDirection:Le(a),modalMaskClose:Be(a)}}),[a]),o=i.ModalViewType,s=i.modalDirection,c=i.modalMaskClose,u=(0,f.useCallback)((function(e){switch(a){case"pointsPay":e&&e.nextPop?n.showPop(e.nextPop):(n.showPop(""),n.startLoopRefresh());break;case"pointsPayFail":n.showPop(""),n.startLoopRefresh();break}}),[a]);return(0,g.jsx)(Me,{visible:!!a,direction:s,clickMaskClose:c,close:u,children:o?(0,g.jsx)(f.Suspense,{fallback:null,children:(0,g.jsx)(o,{onClose:u,modalType:a})}):null})}var Ee=qe,Ae=Y(),He=Ae.top,Fe=Ae.bottom,Ge=B(),_e={"--safe-padding-bottom":Fe+"px","--status-bar-height":He+"px","--nav-bar-height":Ge+"px"};function Ue(){var e=v.Z.useModel("ordinary"),t=(0,M.Z)(e,2),r=t[0],n=t[1],i=r.orderInfo,s=r.orderFlags,c=r.extendValues,u=(0,f.useCallback)((function(){console.log("needUpdateOrder"),n.delayLoopUpdateOrder()}),[]);(0,m.usePullDownRefresh)((0,o.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.updateOrder();case 2:h().stopPullDownRefresh();case 3:case"end":return e.stop()}}),e)}))));var l=Pe(i),d=l.processPayResult,p=(0,f.useCallback)((function(){var e=v.Z.getModelState("ordinary"),t=e.orderInfo,r=e.paramsObj;if(t.enablePayOrder){var n=function(){var e;t.mergePayOrderId?(0,E.wW)(t.mergePayOrderId).then((function(e){E.ZP.showModal({content:"\u8ba2\u5355\u7cfb\u7edf\u6536\u6b3e\u4f1a\u7565\u6709\u5ef6\u8fdf\uff0c\u652f\u4ed8\u6210\u529f\u540e\u53ef\u5237\u65b0\u8ba2\u5355\u67e5\u770b\u7ed3\u679c",confirmText:"\u652f\u4ed8\u6210\u529f",cancelText:"\u652f\u4ed8\u5931\u8d25",done:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.confirm?1:t.cancel?2:0,E.ZP.showLoading("\u652f\u4ed8\u68c0\u67e5\u4e2d..."),e.next=4,d();case 4:E.ZP.hideLoading();case 5:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()})})).catch((function(e){console.log("\u652f\u4ed8\u5931\u8d25--------"),E.ZP.showToast(e.message||(0===e.type?"\u652f\u4ed8\u53d6\u6d88":"\u652f\u4ed8\u5931\u8d25"),"none"),d()})):(0,E.c6)(t.orderId).then((function(e){E.ZP.showModal({m:"\u8ba2\u5355\u7cfb\u7edf\u6536\u6b3e\u4f1a\u7565\u6709\u5ef6\u8fdf\uff0c\u652f\u4ed8\u6210\u529f\u540e\u53ef\u5237\u65b0\u8ba2\u5355\u67e5\u770b\u7ed3\u679c",confirmText:"\u652f\u4ed8\u6210\u529f",cancelText:"\u652f\u4ed8\u5931\u8d25",done:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.confirm?1:t.cancel?2:0,E.ZP.showLoading("\u652f\u4ed8\u68c0\u67e5\u4e2d..."),e.next=4,d();case 4:E.ZP.hideLoading();case 5:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()})})).catch((function(e){console.log("\u652f\u4ed8\u5931\u8d25--------"),E.ZP.showToast(e.message||(0===e.type?"\u652f\u4ed8\u53d6\u6d88":"\u652f\u4ed8\u5931\u8d25"),"none"),d()})),E.ZP.ubtTrace("TCWDetail_SaveSeat_Pay_click",{Content:null===t||void 0===t||null===(e=t.orderStatusBarInfo)||void 0===e?void 0:e.statusName,orderId:t.orderId,ExpoType:1==r.isNoSeat?1:0,IsCheapest:t.isCanPointsPay?1:0})};t.payButtonFrontTips?E.ZP.showModal({m:t.payButtonFrontTips,showCancel:!1,done:function(e){e.confirm&&n()}}):n()}}),[]),x=(0,f.useCallback)(function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.stopLoopRefresh(),p();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),w=(0,f.useMemo)((function(){return c&&c.pointsSplitOrderCard?c.pointsSplitOrderCard:null}),[c]),y=(0,f.useCallback)((function(e){var t="https://m.ctrip.com/webapp/train/activity/ctrip-train-timetable?fromStation=".concat(e.departStation,"&toStation=").concat(e.arriveStation,"&date=").concat(e.departDate,"&TrainNumber=").concat(e.trainNumber);T().navigateTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(t))})}),[]);console.log("state-----",r);var k=(0,f.useMemo)((function(){return c&&c.multipleBookingAndGrabSegmentation?1==c.multipleBookingAndGrabSegmentation.groupOrderStatus:i.orderCanCancel}),[i,c]),N=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,r,o;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return E.ZP.showLoading("\u6b63\u5728\u53d6\u6d88\u8ba2\u5355"),e.next=3,n.stopLoopRefresh();case 3:return t={orderId:i.orderId,oid:i.orderId},r=function(e){h().redirectTo({url:"/pages/train/orderdetail/orderdetail?oid=".concat(e)})},e.prev=5,e.next=8,(0,q.ok)(t);case 8:o=e.sent,E.ZP.hideLoading(),o.retMessage?E.ZP.showModal({m:o.retMessage,done:function(){r(i.orderId)}}):r(i.orderId),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](5),E.ZP.showModal({m:"\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002",done:function(){n.startLoopRefresh()}});case 16:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,r,i,o;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=v.Z.getModelState("ordinary"),i=r.orderInfo,o=r.paramsObj,E.ZP.ubtTrace("TCWDetail_SaveSeat_Cancel_click",{Content:null===i||void 0===i||null===(t=i.orderStatusBarInfo)||void 0===t?void 0:t.statusName,orderId:i.orderId,ExpoType:1==o.isNoSeat?1:0,IsCheapest:i.isCanPointsPay?1:0}),e.next=5,n.stopLoopRefresh();case 5:E.ZP.showModal({title:"\u6e29\u99a8\u63d0\u793a",m:"\u4f59\u7968\u7d27\u5f20\uff0c\u8d8a\u65e9\u4e0b\u5355\u62a2\u7968\u6210\u529f\u7387\u8d8a\u9ad8\u3002\u82e5\u53d6\u6d88\u8ba2\u5355\u5c06\u4e3a\u60a8\u53d6\u6d88\u6b64\u5355\u5168\u90e8\u884c\u7a0b",showCancel:!0,confirmText:"\u53d6\u6d88\u8ba2\u5355",cancelText:"\u6682\u4e0d\u53d6\u6d88",done:function(e){e.confirm?N():n.startLoopRefresh()}});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,g.jsxs)(O.View,{className:"page safe-padding-container",style:_e,children:[(0,g.jsxs)(O.View,{children:[(0,g.jsx)(O.View,{className:"linear-background"}),(0,g.jsx)(te,{orderInfo:i,orderFlags:s,extendValues:c,updateOrder:u}),(0,g.jsx)(ne,{notice:w}),(0,g.jsx)(fe,{orderInfo:i,extendValues:c}),(0,g.jsx)(ue,{orderInfo:i,extendValues:c,onTimeTable:y})]}),k&&(0,g.jsx)(O.View,{className:"order-cancel-btn",onClick:Z,children:"\u53d6\u6d88\u8ba2\u5355"}),(0,g.jsx)(O.View,{className:"bottom-placeholder"}),(0,g.jsx)(Te,{orderInfo:i,extendValues:c,onPayClick:x}),(0,g.jsx)(Ee,{})]})}var Ke=Ue,Qe=function(e){(0,l.Z)(r,e);var t=(0,d.Z)(r);function r(e){var n;return(0,s.Z)(this,r),n=t.call(this,e),(0,p.Z)((0,u.Z)(n),"hasGoLogin",!1),n.props.page.pageId=N.Z.ordinaryDetail,n.state={firstIn:!0,refundShareInfo:{},rescheduleShareInfo:{}},n.hasGoLogin=!1,n}return(0,c.Z)(r,[{key:"componentDidMount",value:function(){this.initData()}},{key:"componentWillUnmount",value:function(){var e=v.Z.getModelDispatchers("ordinary");e.clear()}},{key:"loadOrderInfo",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,r,n,o,s;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=v.Z.getModelDispatchers("ordinary"),r=this.props.pageQuery.params,n=void 0===r?"{}":r,o=JSON.parse(n),e.next=5,(0,V.Z)(o.oid);case 5:return s=e.sent,e.next=8,t.update((0,i.Z)({orderId:o.oid,paramsObj:o},s));case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"loadConfig",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,r;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=v.Z.getModelDispatchers("configs"),e.next=3,t.loadConfigs();case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"initData",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,r,n,i,o,s;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.loadOrderInfo();case 2:return t=e.sent,t&&t.orderInfo&&(r=this.props.pageQuery.params,n=void 0===r?"{}":r,i=JSON.parse(n),o=t.orderInfo,E.ZP.ubtTrace("TCWDetail_exposure",{Content:o.orderStatusBarInfo.statusName,orderId:o.orderId,ExpoType:1==i.isNoSeat?1:0,IsCheapest:o.isCanPointsPay?1:0}),this.tripConflictionHandler(t.orderInfo)),e.next=6,this.loadConfig();case 6:if(null===t||void 0===t||!t.orderInfo){e.next=10;break}return s=v.Z.getModelDispatchers("ordinary"),e.next=10,s.loadOtherInfo(null===t||void 0===t?void 0:t.orderInfo);case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"tripConflictionHandler",value:function(e){var t,r,n=this.props.pageQuery.params,a=void 0===n?"{}":n,i=JSON.parse(a),o=!(null===i||void 0===i||!i.isCancel)&&(null===i||void 0===i?void 0:i.isCancel),s=null===e||void 0===e||null===(t=e.extendList)||void 0===t||null===(t=t.find((function(e){return"TripConflict"===e.key})))||void 0===t?void 0:t.value,c=s?"string"===typeof s?JSON.parse(s):s:null;c&&"k"===(null===e||void 0===e||null===(r=e.jLDetailInfo)||void 0===r?void 0:r.jLOrderStatus)&&!o&&h().redirectTo({url:"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent("https://m.ctrip.com/webapp/train/itineraryConfliction?oid=".concat(e.orderId,"&needLogin=true")),"&data=").concat(JSON.stringify({needLogin:!0}))})}},{key:"componentDidShow",value:function(){var e=this,t=function(){var t=(0,o.Z)((0,a.Z)().mark((function t(r){var n;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=7;break}if("baidu"!==Z.Z.miniProgramType){t.next=5;break}if(!e.hasGoLogin){t.next=5;break}return e.props.page.navigateBack(),t.abrupt("return");case 5:t.next=12;break;case 7:if(e.state.firstIn){t.next=11;break}return n=v.Z.getModelDispatchers("ordinary"),t.next=11,n.fetchOrderInfo();case 11:e.setState({firstIn:!1});case 12:e.hasGoLogin=!0;case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();this.hasGoLogin?j(1).then(t):j(2).then(t)}},{key:"render",value:function(){return(0,g.jsx)(Ke,{})}}]),r}(f.Component),Je=k(Qe),We={navigationBarTitleText:"\u8ba2\u5355\u8be6\u60c5",navigationBarTextStyle:"white",backgroundTextStyle:"light",navigationBarBackgroundColor:"#0085f6",backgroundColor:"#0085f6",backgroundColorTop:"#0085f6",backgroundColorBottom:"#EEF0F6",enablePullDownRefresh:!0};Page((0,n.createPageConfig)(Je,"pages/trainOrder/orderdetail/splitorder/index",{root:{cn:[]}},We||{}))},48979:function(e,t,r){r.d(t,{Z:function(){return b}});var n=r(88381),a=r(298),i=r(79301),o=r(95308),s=r(51531),c=r(52927),u=r(67),l=r(61981),d=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var r,n,a,o,s,c,d;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,n=(null===(r=t.ticketInfos)||void 0===r?void 0:r.map((function(e){return e.arriveStation})))||[],!u.BT.get()||!u.BT.getAttr("cityMainList")){e.next=6;break}return a=u.BT.getAttr("cityMainList"),o=Object.values(a).flat().filter((function(e){return n.includes(e.cityName)})).map((function(e){return e.CtripCityName})),e.abrupt("return",o);case 6:return e.next=8,(0,l.GetTrainStationInfo)({});case 8:return s=e.sent,c=s.trainStationsInfo,d=c.filter((function(e){return n.includes(e.stationName)})).map((function(e){return e.cityName})),e.abrupt("return",d);case 14:return e.prev=14,e.t0=e["catch"](0),console.log("getArrivedStationAndCity \u62a5\u9519",e.t0),e.abrupt("return",[]);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),p=d;function f(e){return new Promise((function(t){setTimeout((function(){t({code:-1001002,message:"timeout"})}),e)}))}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{timeout:5e3},r=t.timeout;return new Promise((function(t){var n={},a=Object.keys(e),i=0;if(0===a.length)t(n);else{var o=function(e,r){n[e]=r,++i===a.length&&t(n)},s=f(r);a.forEach((function(t){var r=Promise.resolve(e[t]);Promise.race([r,s]).then((function(e){if(e&&-1001002===e.code)throw e;o(t,e)})).catch((function(e){console.warn("[Promise ".concat(t," is error]"),JSON.stringify(e)),o(t,void 0)}))}))}}))}var h=r(12033);function v(e){return(0,l.GetUserAccountInfo)({userName123:e}).then((function(e){if(1!==e.retCode)throw e;return e}))}function x(e){var t=e.password,r=e.orderId,n=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(n){var a;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,l.OrderPointPayNotify)({pointSecret:(0,h.zy)(t),orderNumber:r,channelName:"WX",pollingkey:(null===n||void 0===n?void 0:n.pollingKey)||""});case 2:if(a=e.sent,1===a.retCode&&3===a.pollingResult){e.next=5;break}return e.abrupt("return",a);case 5:return e.abrupt("return",{pollingFlag:!0,pollingRate:a.requestRate,requestRate:a.requestRate,pollingKey:a.pollingKey});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,h.nP)(n,void 0,15)}function g(){return{popType:"",orderId:"",paramsObj:{},orderInfo:{},orderFlags:c.Z,extendValues:{},insurancePromptEntrance:{isShow:!1},shareInfos:"",subscribedFlag:-1,hasCollected:!0,showChildTip:!1,showFreeOrder:!1,loopRefresh:!1,accountInfo:{},loading:!0}}var w={state:g(),effects:function(e){return{effectsDemo:function(t,r){return(0,o.Z)((0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:setTimeout((function(){e["ordinary"].update({popType:"saveTaskGuide"})}),5e3);case 1:case"end":return t.stop()}}),t)})))()},fetchOrderInfo:function(e,t){var r=this;return(0,o.Z)((0,i.Z)().mark((function n(){var a,o;return(0,i.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e||t.ordinary.orderId,n.next=3,(0,s.Z)(a);case 3:return o=n.sent,o&&(a!==t.ordinary.orderId&&(console.log("\u8ba2\u5355\u53f7\u53d8\u66f4\u8ba4\u4e3a\u662f\u5904\u7406\u4e0b\u4e00\u5355\u4fe1\u606f\u4e86"),r.loadOtherInfo(o.orderInfo)),r.update(o)),n.abrupt("return",o);case 6:case"end":return n.stop()}}),n)})))()},delayLoopUpdateOrder:function(e,t){var r=this;return(0,o.Z)((0,i.Z)().mark((function n(){var a,o;return(0,i.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e||t.ordinary.orderId,n.next=3,(0,h.gw)(2e3);case 3:if(a===t.ordinary.orderId){n.next=7;break}r.updateOrder(a),n.next=11;break;case 7:return n.next=9,(0,s.Z)(a);case 9:o=n.sent,o&&r.update(o);case 11:case"end":return n.stop()}}),n)})))()},updateOrder:function(e){var t=this;return(0,o.Z)((0,i.Z)().mark((function r(){return(0,i.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.abrupt("return",t.fetchOrderInfo(e));case 1:case"end":return r.stop()}}),r)})))()},loadOtherInfo:function(e){var t=this;return(0,o.Z)((0,i.Z)().mark((function r(){var n,a,o;return(0,i.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,m({arrivedStations:p(e)});case 2:a=r.sent,(u.ZK.getAttr("clickCloseCollect")||u.ZK.getAttr("HASCOLLECTED"))&&(a.hasCollected=!0),o=e.orderId,o!==(null===(n=u.ZK.getAttr("showChildTip"))||void 0===n?void 0:n.key)&&(u.ZK.setAttr("showChildTip",{key:o}),a.showChildTip=!0),t.update(a);case 7:case"end":return r.stop()}}),r)})))()},get12306AccountInfo:function(e,t){var r=this;return(0,o.Z)((0,i.Z)().mark((function e(){var n,a;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.ordinary.orderInfo,e.next=3,v(n.userId12306);case 3:return a=e.sent,r.update({accountInfo:a}),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})))()},orderPointPayNotify:function(e,t){return(0,o.Z)((0,i.Z)().mark((function r(){var n;return(0,i.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.ordinary.orderInfo,r.abrupt("return",x({password:e,orderId:n.orderId}));case 2:case"end":return r.stop()}}),r)})))()},getReset12306PasswordUrl:function(e,t){var r=t.ordinary.orderInfo,n="https://m.ctrip.com/webapp/train/updateMemberpsd?titleBgColor=C6DDFC&userName=".concat((0,h.zy)(r.UserId12306));return"/pages/trainActivity/twebview/index?url=".concat(encodeURIComponent(n))},loadPopDeps:function(e,t){return(0,o.Z)((0,i.Z)().mark((function e(){var r;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=t["ordinary"],t["configs"],r.orderInfo,r.extendValues,{};case 4:case"end":return e.stop()}}),e)})))()},loadInsuranceInfo:function(e){return(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},startLoopRefresh:function(){this.update({loopRefresh:!0})},stopLoopRefresh:function(){this.update({loopRefresh:!1})}}},reducers:{clear:function(){return g()},update:function(e,t){return(0,a.Z)((0,a.Z)({},e),t)},showPop:function(e,t){return(0,a.Z)((0,a.Z)({},e),{},{popType:t})}}},y=r(45023),k=r(93212);function N(e){return Z.apply(this,arguments)}function Z(){return Z=(0,o.Z)((0,i.Z)().mark((function e(t){var r,n;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var r,n,a;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,l.Z8)(t[0]);case 3:if(r=e.sent,r)try{n=JSON.parse(r),n&&(r=n)}catch(e){console.log("config------------key",t[0],"--result-----",r,"--------",(0,k.Z)(r))}if("2021_travel_share_config"!==t[0]){e.next=9;break}r=null===(a=r)||void 0===a?void 0:a.isOpen,e.next=11;break;case 9:if("ctrip-official-account-source"!==t[0]){e.next=11;break}return e.abrupt("return",{freeOrderIconConfig:r["wechat-order-detail-free-order-icon"],freeOrderModalConfig:r["wechat-order-detail-free-order-dialog"]});case 11:return e.abrupt("return",(0,y.Z)({},t[1],r));case 14:e.prev=14,e.t0=e["catch"](0),console.log("".concat(t[0],"\u914d\u7f6e\u51fa\u9519"),e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}()));case 2:return r=e.sent,n=r.reduce((function(e,t){return(0,a.Z)((0,a.Z)({},e),t)}),{}),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))),Z.apply(this,arguments)}var S={state:{configs:{}},effects:function(e){return{loadConfigs:function(){var e=this;return(0,o.Z)((0,i.Z)().mark((function t(){var r,n;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=[["2021_travel_share_config","isShareEntranceOpen"]],t.next=3,N(r);case 3:return n=t.sent,e.update({configs:n}),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})))()}}},reducers:{update:function(e,t){var r=e.configs,n=t.configs;return(0,a.Z)((0,a.Z)({},e),{},{configs:(0,a.Z)((0,a.Z)({},r),n)})}}},T=(0,n.createStore)({ordinary:w,configs:S}),b=T},52927:function(e,t){var r={countdownOrderTips:!1,activity:!1,altInfo:!1,isShowBuyAgain:!1,isShowRobSame:!1,isShowBuyReturn:!1,isShowRedPocket:!1,isTimeOut:!1,hasReturned:!1,isPreHolding:!1};t["Z"]=r},51531:function(e,t,r){r.d(t,{Z:function(){return D}});var n=r(79301),a=r(95308),i=r(22276),o=r(298),s=r(90129),c=r(56884),u=r.n(c),l=r(88381),d=r(39765),p=r(34677),f=r(12033),m=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,i,o,s;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:r=t.rescheduleTicketList,a=t.ticketInfos,null!==r&&void 0!==r&&r.length?(i=r[0],t.orderinfos={time:{arriveTime:(0,l.dayjs)("".concat(i.arriveDate," ").concat(i.arriveTime)).valueOf(),departTime:(0,l.dayjs)("".concat(i.departDate," ").concat(i.departTime)).valueOf()},station:{departStation:i.departStation,arriveStation:i.arriveStation}}):null!==a&&void 0!==a&&a.length&&(a.length>1&&a[0].departStation!==a[1].arriveStation?(o=a,t.orderinfos={time:{departTime:(0,l.dayjs)("".concat(o[0].departDate," ").concat(o[0].departTime)).valueOf(),arriveTime:(0,l.dayjs)("".concat(o[1].arriveDate," ").concat(o[1].arriveTime)).valueOf()},station:{departStation:o[0].departStation,arriveStation:o[1].arriveStation}}):(s=a[0],console.log(a,"ticketInfos"),t.orderinfos={time:{departTime:(0,l.dayjs)("".concat(s.departDate," ").concat(s.departTime)).valueOf(),arriveTime:(0,l.dayjs)("".concat(s.arriveDate," ").concat(s.arriveTime)).valueOf()},station:{departStation:s.departStation,arriveStation:s.arriveStation}}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(e){var t;if(null===e||void 0===e||null===(t=e.hBGrabInfo)||void 0===t||!t.hBTask)return e;var r=e.hBGrabInfo.hBTask,n=e.ticketInfos,a=e.userInfo,i=r.split("|"),c=(0,s.Z)(i,4),u=c[0],l=c[1],d=c[2],p=c[3];return(0,o.Z)((0,o.Z)({},e),{},{hBGrabInfo:(0,o.Z)((0,o.Z)({},e.hBGrabInfo),{},{frontProps:{taskTab:"rob",list:[{label:"\u884c\u7a0b",txt:"".concat(u," ").concat(l)},{label:"\u8f66\u6b21",txt:d},{label:"\u5ea7\u5e2d",txt:p},{label:"\u4e58\u5ba2",txt:n[0].passengerInfos.map((function(e){return e.passengerName})).join(",")},{label:"\u624b\u673a",txt:a.contactNobile}]}})})},v=function(e,t){return e.map((function(e){var r=e.realTicketInfo||{},n=null===t||void 0===t?void 0:t.find((function(t){var r;return null===(r=t.reschedulePassengerList)||void 0===r?void 0:r.find((function(t){return t.iDCardNumberAES===e.iDCardNumberAES&&t.passengerType===e.ticketType}))})),a=e.iDCardNumberAES;try{a=u().util.base64Decode(e.iDCardNumberAES)}catch(e){console.log("\u8eab\u4efd\u8bc1\u53f7\u89e3\u6790\u5931\u8d25",e)}return(0,o.Z)((0,o.Z)({},e),{},{iDCardNumber:a,seatName:r.seatName||"",dealSeatNo:r.dealSeatNo||"",dealTicketPrice:r.dealTicketPrice||"",ticketStatus:r.ticketStatus||"",ticketStatusCode:r.ticketStatusCode,changeButtonDisplay:r.changeButtonDisplay,returnButtonDisplay:r.returnButtonDisplay,hasChanged:5==r.ticketStatusCode,changing:(null===n||void 0===n?void 0:n.reschedulePassengerList[0].grabTicketDetailButtonDisplay)&&9!=(null===n||void 0===n?void 0:n.reschedulePassengerList[0].rescheduleType)})}))};function x(e,t){var r=[(0,o.Z)((0,o.Z)({},e),{},{routeSequence:t.currentRouteSequence||t.routeSequence})];t.relationOrderInfoList.forEach((function(e){r.push(e)})),r=r.sort((function(e,t){return e.routeSequence-t.routeSequence}));var n=[];return r.forEach((function(e){n=[].concat((0,i.Z)(n),(0,i.Z)(e.orderPriceList||[]))})),n}function g(e,t){var r=[];t.relationOrderInfoList.forEach((function(e){e.ticketInfoList.forEach((function(t,n){var a=(0,l.dayjs)(t.departDateTime,"YYYYMMDDHHmmss"),i=(0,l.dayjs)(t.arriveDateTime,"YYYYMMDDHHmmss"),s="";t.passengerInfoList.forEach((function(e){s=e.seatName}));var c={arriveShiftDay:0,departShiftDay:0},u=i.startOf("day"),d=a.startOf("day");if(c.arriveShiftDay=d.diff(u,"day"),n>0){var f=(0,l.dayjs)(e.ticketInfoList[n-1].arriveDateTime,"YYYYMMDDHHmmss").startOf("day");c.departShiftDay=d.diff(f,"day")}r.push((0,o.Z)((0,o.Z)({},t),{},{trainNumber:t.trainNumber,orderStatusName:e.orderStatusName,orderTag:"JL"===e.orderType?"\u62a2\u7968":"",departTime:a.format("HH:mm"),arriveTime:i.format("HH:mm"),departDate:a.format("YYYY-MM-DD"),arriveDate:i.format("YYYY-MM-DD"),departDateString:a.format("MM\u6708DD\u65e5")+" "+(0,p.Qb)(a),routeSequence:e.routeSequence+(t.routeSequence-1),seatName:s}))}))}));var n=t.currentRouteSequence,a=(e.ticketInfos||[]).map((function(e){var r=(0,l.dayjs)(e.departDate+" "+e.departTime,"YYYY-MM-DD HH:mm"),a=(0,l.dayjs)(e.arriveDate+" "+e.arriveTime,"YYYY-MM-DD HH:mm"),o="",s=[],c=e.passengerInfos.map((function(t){var r=t.realTicketInfo,n=t.freePassengerInfo;return n&&s.push({passengerName:n.passportName,seatName:(null===r||void 0===r?void 0:r.dealSeatName)||e.seatName,seatNo:"",ticketType:-1,ticketTypeName:"\u514d\u8d39\u4e58\u8f66\u513f\u7ae5",ticketPrice:0}),o=(null===r||void 0===r?void 0:r.dealSeatName)||e.seatName,{passengerName:t.passengerName,seatName:(null===r||void 0===r?void 0:r.dealSeatName)||e.seatName,seatNo:(null===r||void 0===r?void 0:r.dealSeatNo)||"",ticketType:t.ticketType,ticketTypeName:t.ticketTypeName,ticketPrice:e.ticketPrice}}));return c=[].concat((0,i.Z)(c),s),{routeSequence:n+(e.routeSequence-1),trainNumber:e.trainNumber,departStation:e.departStation,arriveStation:e.arriveStation,departDate:r.format("YYYY-MM-DD"),arriveDate:a.format("YYYY-MM-DD"),departTime:e.departTime,arriveTime:e.arriveTime,departDateTime:r.format("YYYYMMDDHHmmss"),arriveDateTime:a.format("YYYYMMDDHHmmss"),departDateString:r.format("MM\u6708DD\u65e5")+" "+(0,p.Qb)(r),ticketEntrance:e.ticketEntrance,electronicNumber:e.electronicNumber,orderStatusName:t.currentOrderStatusName,orderTag:"JL"===t.currentOrderType?"\u62a2\u7968":"",seatName:o,passengerInfoList:c}})),s=[].concat((0,i.Z)(a),r).sort((function(e,t){return e.routeSequence-t.routeSequence}));return s=s.map((function(e,t){var r=(0,l.dayjs)(e.departDateTime,"YYYYMMDDHHmmss"),n=(0,l.dayjs)(e.arriveDateTime,"YYYYMMDDHHmmss"),a={arriveShiftDay:0,departShiftDay:0},i=n.startOf("day"),c=r.startOf("day");if(a.arriveShiftDay=i.diff(c,"day"),t>0){var u=(0,l.dayjs)(s[t-1].arriveDateTime,"YYYYMMDDHHmmss").startOf("day");a.departShiftDay=c.diff(u,"day")}return(0,o.Z)((0,o.Z)({},e),a)})),s}function w(e,t){var r,n,a=[],i={type:"combine-seat",sameTrain:!0,transferStation:"",transferTime:"",combinSeatChangeTrainNum:"",combinSeatChangeTrainStation:"",recommendDepartType:0,recommendArriveType:0};if(null===(r=e.forEach)||void 0===r||r.call(e,(function(t,r){if(0===r);else{var n=e[r-1];i.transferStation=n.arriveStation;var a=n.trainNumber===t.trainNumber;if(i.sameTrain=a,!a){var o=(0,l.dayjs)(n.arriveDateTime,"YYYYMMDDHHmmss"),s=(0,l.dayjs)(t.departDateTime,"YYYYMMDDHHmmss"),c=s.diff(o,"minute");i.transferTime=f.ZP.costTimeString(c)}}})),!i.sameTrain){var o=t.trainTicketSegmentRelation;o&&o.forEach((function(e){e.combinSeatChangeTrainNum&&(i.sameTrain=!0,i.combinSeatChangeTrainNum=e.combinSeatChangeTrainNum,i.combinSeatChangeTrainStation=e.combinSeatChangeTrainStation)}))}if(i.sameTrain){var s=t.onTrainThenByTicketSolu;if(s){var c=s.solutionInfoList;if(c.length>0){var u=c[0];i.recommendDepartType=u.recommendDepartType,i.recommendArriveType=u.recommendArriveType}}}return null===(n=e.forEach)||void 0===n||n.call(e,(function(t,r){if(0===r)a.push({time:t.departTime,station:t.departStation,info:i.sameTrain?t.seatName:"\u7b2c".concat(t.routeSequence,"\u7a0b").concat(t.trainNumber),infoType:"tag-white start",type:"from"});else{var n=e[r-1];a.push({time:n.arriveTime,station:t.departStation===n.arriveStation?n.arriveStation:"".concat(n.arriveStation,"\u3000").concat(t.departStation),info:i.sameTrain?"\u8f66\u5185\u6362\u5ea7":t.departStation===n.arriveStation?"\u540c\u7ad9\u6362\u4e58":"\u5f02\u7ad9\u6362\u4e58",type:"info",infoType:i.sameTrain?"tag-grey":"tag-grey transfer"}),r==e.length-1&&a.push({time:t.arriveTime,station:t.arriveStation,info:i.sameTrain?t.seatName:"\u7b2c".concat(t.routeSequence,"\u7a0b").concat(t.trainNumber),infoType:"tag-white end",type:"to"})}})),{tripElement:a,axisInfo:i}}var y=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r){var s,c,u,p,f,m,h,y,k,N,Z,S,T,b,j,I,D;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",t);case 2:if(s=t.rescheduleTicketList,c=t.ticketInfos,u=t.orderStatus,p=t.isFastPay,f=t.enablePayOrder,m=t.orderType,h=t.expansionList,y=void 0===h?[]:h,k=t.orderStatusName,N=null===s||void 0===s?void 0:s.map((function(e){var t,r=(0,l.dayjs)(e.departTime).format("HH:mm"),n=(0,l.dayjs)(e.departTime).format("MM\u6708DD\u65e5"),a=(0,l.dayjs)(e.arriveTime).format("HH:mm"),i=(0,l.dayjs)(e.arriveTime).format("MM\u6708DD\u65e5"),s=(null===(t=e.reschedulePassengerList[0])||void 0===t||null===(t=t.ticketEntrance)||void 0===t?void 0:t.replace(/(\u68c0\u7968\u53e3|\u5019\u8f66\u5730\u70b9)[:|\uff1a]?/,""))||"";return(0,o.Z)((0,o.Z)({},e),{},{rescheduledDepartTime:r,rescheduledDepartDate:n,rescheduledArriveTime:a,rescheduledArriveDate:i,ticketEntrance:s})})),Z=[],S=(0,i.Z)(c),!(S&&S.length>0)){e.next=11;break}return e.next=10,Promise.all(null===c||void 0===c?void 0:c.map(function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,i,c,u,p,f,m,h;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=(0,l.dayjs)(t.departDate).format("MM\u6708DD\u65e5"),i=d.c8[(0,l.dayjs)(t.departDate).day()],c=(0,l.dayjs)(t.arriveDate).format("MM\u6708DD\u65e5"),u=d.c8[(0,l.dayjs)(t.arriveDate).day()],p=v(t.passengerInfos,s),f=(null===(r=t.ticketEntrance)||void 0===r?void 0:r.replace(/(\u68c0\u7968\u53e3|\u5019\u8f66\u5730\u70b9)[:|\uff1a]?/,""))||"",m=!1,h="",e.abrupt("return",(0,o.Z)((0,o.Z)({},t),{},{departWeek:i,departDateStr:a,arriveWeek:u,arriveDateStr:c,passengerInfos:p,ticketEntrance:f,isTicketFail:m,issueFailDesc:h}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 10:Z=e.sent;case 11:return T=Z.length>1?Z.sort((function(e,t){return e.routeSequence-t.routeSequence})):Z,b=(y||[]).some((function(e){return 4===e.type})),I=null,D=t.orderPriceList||[],r&&r.multipleBookingAndGrabSegmentation&&(I=g(t,r.multipleBookingAndGrabSegmentation),D=x(t,r.multipleBookingAndGrabSegmentation),j=w(I,r)),p||1!=u||f||!["CZL","DZL"].includes(m)||(k="\u5f85\u652f\u4ed8"),e.abrupt("return",(0,o.Z)((0,o.Z)({},t),{},{tripAxis:j,orderPriceList:D,splitOrderTicketList:I,expansionBtn:b,orderStatusName:k,ticketInfos:T,rescheduleTicketList:N}));case 18:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),k=r(45023),N={escapeQuotes:function(e){return e.replace(/"/g,'\\\\"')},unescapeQuotes:function(e){return e.replace(/\\\\"/g,'"')}},Z=function(e){var t;if(null===e||void 0===e||null===(t=e.extendList)||void 0===t||!t.length)return{};var r=e.extendList.reduce((function(e,t){try{var r=N.unescapeQuotes(decodeURIComponent(t.value));if("ticketallowanceactivityalert"===t.key){var n=JSON.parse(r).content.split("\xa5");return(0,o.Z)((0,o.Z)({},e),{},{ticketallowanceactivityalert:{content:n[0],award:n[1]}})}if("ETicketGuidUserCheckFace"===t.key){var a,i=JSON.parse(r);return(0,o.Z)((0,o.Z)({},e),{},{ETicketGuidUserCheckFace:(0,o.Z)((0,o.Z)({},i),{},{desc:(null===(a=i.desc)||void 0===a||null===(a=a.replace(/&lt;/g,"<"))||void 0===a?void 0:a.replace(/&gt;/g,">"))||""})})}return(0,o.Z)((0,o.Z)({},e),{},(0,k.Z)({},t.key,JSON.parse(r)))}catch(r){var s;console.log("getExtendValues \u62a5\u9519\u4f7f\u7528\u539f\u59cb\u503c",r);var c=N.unescapeQuotes(decodeURIComponent(t.value));return(0,o.Z)((0,o.Z)({},e),{},(0,k.Z)({},t.key,null===c||void 0===c||null===(s=c.replace(/&lt;/g,"<"))||void 0===s?void 0:s.replace(/&gt;/g,">")))}}),{});return(0,f.Zs)(r)},S=r(61981),T=r(52927);function b(e){var t,r,n=("E"==e.orderType||"P"==e.orderType)&&8==e.orderStatus||"\u8d2d\u7968\u6210\u529f"==e.orderStatusName||"P"==e.orderType&&6==e.orderStatus,a=Object.assign({},T.Z);return a.countdownOrderTips=e.isPreHoldSeat&&1==e.orderStatus&&e.enablePayOrder,a.activity=n,a.altInfo=n,a.isShowBuyReturn=n&&e.ticketInfos.length<2&&5!=e.orderStatus,a.isShowRedPocket=n,a.isShowBuyAgain=9==e.orderStatus,a.isShowRobSame=!(!e.failReason||!(e.failReason.indexOf("\u5df2\u552e\u5b8c")>-1||e.failReason.indexOf("\u65e0\u7968")>-1||e.failReason.indexOf("\u4f59\u7968\u4e0d\u8db3")>-1||e.failReason.indexOf("\u6ca1\u6709\u8db3\u591f\u7684\u7968")>-1)),a.isTimeOut=/\u8ba2\u5355\u8d85\u65f6/.test(e.orderStatusName),a.isSuccess=[6,7,8].includes(e.orderStatus),a.paidSuccess=/\u652f\u4ed8\u6210\u529f/.test(null===(t=e.orderStatusBarInfo)||void 0===t?void 0:t.statusName)||4==e.orderStatus,a.hasReturned=/\u5168\u90e8\u9000\u7968/.test(e.orderStatusName),a.isCancelOrder=9==e.orderStatus,a.isRefund=10==e.orderStatus||11==e.orderStatus,a.isPreHolding=1===(null===(r=e.orderStatusBarInfo)||void 0===r?void 0:r.statusType),a.isShowHotelSuccess=a.isSuccess&&"\u5df2\u9000\u7968"!==e.orderStatusName&&"\u5df2\u53d6\u6d88"!==e.orderStatusName,a}function j(e){return I.apply(this,arguments)}function I(){return I=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,i,o,s;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={OrderId:t,ver:1,Channel:"WX"},e.prev=1,e.next=4,(0,S.l)(r);case 4:if(a=e.sent,a.orderInfo){e.next=7;break}return e.abrupt("return");case 7:return i=b(a.orderInfo),m(a.orderInfo),o=Z(a.orderInfo),e.t0=h,e.next=13,y(a.orderInfo,o);case 13:if(e.t1=e.sent,s=(0,e.t0)(e.t1),s.orderFlags=i,s.orderId){e.next=18;break}throw a;case 18:return console.log("\u683c\u5f0f\u5316\u540e\u8ba2\u5355\u8be6\u60c5",JSON.stringify({orderId:t,orderInfo:s,orderFlags:i,extendValues:o},null,4)),e.abrupt("return",{orderId:t,orderInfo:s,orderFlags:i,extendValues:o});case 22:e.prev=22,e.t2=e["catch"](1),console.log("\u8ba2\u5355\u4fe1\u606f\u52a0\u8f7d\u5931\u8d25",e.t2);case 25:case"end":return e.stop()}}),e,null,[[1,22]])}))),I.apply(this,arguments)}var D=j},79181:function(e){e.exports=require("../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../cwx/ext/global")}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[560,2107,1216,8592],(function(){return t(42976)}));e.O()}]);
//# sourceMappingURL=index.js.map