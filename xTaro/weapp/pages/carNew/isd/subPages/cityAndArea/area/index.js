"use strict";require("../../../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[7105],{8648:function(e,t,a){var i=a(32180),o=a(298),n=a(19153),r=a(57042),s=a(24460),l=a(81876),c=a(79038),d=a(59772),u=a(21867),v=a(86066),m=a(45023),h=(a(90201),a(71515)),g=a(33675),p=a.n(g),f=a(92954),x=a(64341),y=a(4750),S=a(81194),Z=a(35418),N=a(74629),I=a(19410),T=a(84758),w=a(45926),L=a(55060),A=a(54802),C=a(96714),O=a(31729),D=a(80762),j=a(26347),R=a(27019),_=a(68140),k=a(2269),M=N.ObserverKey.CAR_CHANGE_LOCATION_EVENT,V=function(e){return e[e["AIRPORT"]=1]="AIRPORT",e[e["RAILWAYSTATION"]=2]="RAILWAYSTATION",e[e["BUSSTATION"]=9]="BUSSTATION",e}(V||{}),b=function(e){(0,u.Z)(a,e);var t=(0,v.Z)(a);function a(e){var i;(0,r.Z)(this,a),i=t.call(this,e),(0,m.Z)((0,l.Z)(i),"autoExpose",void 0),(0,m.Z)((0,l.Z)(i),"getUrlOption",(function(){var e,t=null===(e=(0,f.getCurrentInstance)())||void 0===e||null===(e=e.router)||void 0===e?void 0:e.params,a={cityId:2,cityName:"\u4e0a\u6d77",isDomestic:!0,fromCity:!0};return null!==t&&void 0!==t&&t.cityInfo&&(a=L.Utils.jsonParse(decodeURIComponent(null===t||void 0===t?void 0:t.cityInfo))),a})),(0,m.Z)((0,l.Z)(i),"showStorage",(function(){var e,t=i.state.cityId,a=i.props.areaStorage,o=(null===a||void 0===a||null===(e=a.filter((function(e){return+e.cid===+t})))||void 0===e?void 0:e.slice(0,6))||[];i.setState({areaStorage:o})})),(0,m.Z)((0,l.Z)(i),"handleDelStorage",(function(){var e=i.state,t=e.cityId,a=e.isDomestic,o=I.Z.geStorage(N.StorageKey.CAR_AREA_HISTORY),n=a?I.Z.geStorage(N.StorageKey.CAR_CITY_HISTORY_ISD):I.Z.geStorage(N.StorageKey.CAR_CITY_HISTORY_OSD),r=(null===o||void 0===o?void 0:o.filter((function(e){return+(null===e||void 0===e?void 0:e.cid)!==+t})))||[],s=(null===n||void 0===n?void 0:n.filter((function(e){return+(null===e||void 0===e?void 0:e.cityId)!==+t})))||[];I.Z.setStorage(N.StorageKey.CAR_AREA_HISTORY,r),I.Z.setStorage(a?N.StorageKey.CAR_CITY_HISTORY_ISD:N.StorageKey.CAR_CITY_HISTORY_OSD,s),i.setState({areaStorage:[]})})),(0,m.Z)((0,l.Z)(i),"clickPoi",(function(e){e.addr;var t=e.id,a=e.lat,o=e.lng,n=e.name,r=e.formataddr,s={cid:+t,cname:n,isDomestic:!0,area:{id:"",lat:a,lng:o,name:r}};i.handleClickLocation(s)})),(0,m.Z)((0,l.Z)(i),"handleClickLocation",(0,n.debounce)((function(e){var t,a,o,n,r,s=i.props,l=s.setAreaStorage,c=s.rentalLocation,d=i.state.isDomestic;if(l(e),void 0!==e.isDomestic){var u=(0,R.M)(c,e);u&&(0,O.Z)({carEnv:{appType:(0,D.getAppType)(d)}})}C.mq.LogTrace({key:C.Qx.c_car_fetch_list_page_req,info:{data:e,step:1}});var v={cid:+(null===e||void 0===e?void 0:e.cid),cname:null===e||void 0===e?void 0:e.cname,isDomestic:null===e||void 0===e?void 0:e.isDomestic,area:{id:null===e||void 0===e||null===(t=e.area)||void 0===t?void 0:t.id,lat:null===e||void 0===e||null===(a=e.area)||void 0===a?void 0:a.lat,lng:null===e||void 0===e||null===(o=e.area)||void 0===o?void 0:o.lng,name:null===e||void 0===e||null===(n=e.area)||void 0===n?void 0:n.name,type:null===e||void 0===e||null===(r=e.area)||void 0===r?void 0:r.type}};p().Observer.noti(M,{type:"message",options:{detail:{data:[{rentalLocation:JSON.stringify(v)}]}}});var m=i.getUrlOption();null!==m&&void 0!==m&&m.fromCity?p().navigateBack({delta:2}):p().navigateBack({delta:1})}),300)),(0,m.Z)((0,l.Z)(i),"getDataInitMore",(function(e){return!!([V.BUSSTATION,V.RAILWAYSTATION].includes(e.type)&&e.areaInfoList.length>4)})),(0,m.Z)((0,l.Z)(i),"getMoreState",(function(e){var t=e||i.props.areaList,a=[];return null===t||void 0===t||t.map((function(e,t){var i={more:!1};[V.BUSSTATION,V.RAILWAYSTATION].includes(e.type)&&e.areaInfoList.length>4&&(i.more=!0),a.push(i)})),a})),(0,m.Z)((0,l.Z)(i),"setMoreState",(function(e){i.setState({areaListMoreData:e})})),(0,m.Z)((0,l.Z)(i),"changeMoreState",(function(e){var t,a,n=i.getMoreState();if(null!==(t=n[e])&&void 0!==t&&t.more){var r=null===(a=i.state)||void 0===a||null===(a=a.areaListMoreData)||void 0===a?void 0:a.map((function(t,a){return(0,o.Z)((0,o.Z)({},t),{},{more:e===a?!t.more:t.more})}));i.setState({areaListMoreData:r})}})),(0,m.Z)((0,l.Z)(i),"isShowLocation",(function(){var e,t=i.props.currentLocation;return(null===(e=i.state)||void 0===e?void 0:e.cityId)===(null===t||void 0===t?void 0:t.id)})),(0,m.Z)((0,l.Z)(i),"refreshObservePage",(function(){i.__page&&i.__page.getDOMProps&&"undefined"!==typeof i.__page.exposeObserver&&p().sendUbtExpose.refreshObserve((0,l.Z)(i))})),(0,m.Z)((0,l.Z)(i),"noAreaResult",(function(e){var t=e.cityName,a=void 0===t?"":t,i=e.className,o=void 0===i?"":i;return(0,k.jsxs)(h.View,{className:o,children:[(0,k.jsx)(h.Image,{src:"https://pages.c-ctrip.com/carisd/weixin/noresult.png",className:"no-area-img"}),(0,k.jsxs)(h.Text,{className:"no-area-text",children:[a,w.Z.noService]})]})}));var s=i.getUrlOption(),c=i.getMoreState();return i.state={areaListMoreData:c,areaStorage:[],cityId:null===s||void 0===s?void 0:s.cityId,cityName:null===s||void 0===s?void 0:s.cityName,isDomestic:null===s||void 0===s?void 0:s.isDomestic},i.autoExpose=!0,i.checkPerformance=!0,i}return(0,s.Z)(a,[{key:"getPageId",value:function(){return this.pageId=L.Channel.getPageId().AREA.ID,this.pageId}},{key:"onLoad",value:function(e){(0,c.Z)((0,d.Z)(a.prototype),"onLoad",this).call(this,e),this.showStorage()}},{key:"onReady",value:function(){(0,c.Z)((0,d.Z)(a.prototype),"onReady",this).call(this),this.props.getLocation()}},{key:"componentDidShow",value:function(){(0,c.Z)((0,d.Z)(a.prototype),"componentDidShow",this).call(this)}},{key:"componentDidHide",value:function(){(0,c.Z)((0,d.Z)(a.prototype),"componentDidHide",this).call(this)}},{key:"componentWillUnmount",value:function(){(0,c.Z)((0,d.Z)(a.prototype),"componentWillUnmount",this).call(this),_.AreaReqAndResData.removeData()}},{key:"componentWillReceiveProps",value:function(e){e.isLoading||this.setMoreState(this.getMoreState(e.areaList))}},{key:"render",value:function(){var e,t,a,i=this,o=this.props,r=o.isLoading,s=o.areaList,l=this.state,c=l.areaStorage,d=l.isDomestic,u=d?j.COMPONENT_CHANNEL.ISD:j.COMPONENT_CHANNEL.OSD,v=this.getUrlOption(),m=v.fromCity;return(0,k.jsxs)(h.View,{className:(0,n.classnames)("area-page",!(null!==s&&void 0!==s&&s.length)&&"area-page-white"),children:[(0,k.jsx)(h.View,{className:"area-input",children:(0,k.jsx)(y.Z,{type:"area",cityId:null===(e=this.state)||void 0===e?void 0:e.cityId,cityName:null===(t=this.state)||void 0===t?void 0:t.cityName,handleClickLocation:this.handleClickLocation,isLocal:this.isShowLocation(),refreshObservePage:this.refreshObservePage,currentTab:u,isFromCityArea:m})}),(0,k.jsxs)(h.ScrollView,{scrollY:!0,className:"location-scroll",children:[this.isShowLocation()&&(0,k.jsx)(h.View,{className:"my-location",id:"location",children:(0,k.jsx)(T.Z,{showTick:!0,clickPoi:this.clickPoi})}),!(null===c||void 0===c||!c.length)&&(0,k.jsxs)(h.View,{className:"area-history",children:[(0,k.jsxs)(h.View,{className:"area-history-title",children:[(0,k.jsx)(h.Text,{className:"area-history-text",children:w.Z.areaHistory}),(0,k.jsxs)(h.View,{className:"area-del",onClick:this.handleDelStorage,children:[(0,k.jsx)(S.Z,{type:"icon",className:"area-history-del",children:Z.q.fJW}),(0,k.jsx)(h.Text,{className:"del-txt",children:w.Z.delHistory})]})]}),null===c||void 0===c?void 0:c.map((function(e){var t;return(0,k.jsx)(h.View,{className:"area-history-item",onClick:function(){i.handleClickLocation(e)},children:null===e||void 0===e||null===(t=e.area)||void 0===t?void 0:t.name})}))]}),s&&s.map((function(e,t){var a,o,r;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(h.View,{className:(0,n.classnames)("part"),children:[(0,k.jsxs)(h.View,{className:"cap",onClick:function(){i.changeMoreState(t)},children:[(0,k.jsx)(S.Z,{className:(0,n.classnames)("sign",A.itemTypeIconsStyle[e.type].color),type:"icon",children:A.itemTypeIconsStyle[e.type].icon}),(0,k.jsx)(h.Text,{className:"main","data-testid":N.UITestID.car_testid_page_area_module,children:e.name})]}),(0,k.jsx)(h.View,{className:"group",children:null===e||void 0===e||null===(a=e.areaInfoList)||void 0===a?void 0:a.map((function(a,o){var r,s,l,c,d,u=null===(r=e.areaInfoList)||void 0===r?void 0:r.length,v=u%2===1;return null!==(s=i.state)&&void 0!==s&&null!==(s=s.areaListMoreData[t])&&void 0!==s&&s.more&&o<4||null===(l=i.state)||void 0===l||null===(l=l.areaListMoreData[t])||void 0===l||!l.more?(0,k.jsxs)(h.View,{className:(0,n.classnames)("opt",(null===e||void 0===e?void 0:e.type)===V.AIRPORT?"one":"two",v&&o+1===u&&"isLast"),children:[(0,k.jsx)(h.Text,{className:"txt",onClick:function(){i.handleClickLocation(a)},children:a.aname}),(null===a||void 0===a||null===(c=a.subAreas)||void 0===c?void 0:c.length)&&(0,k.jsx)(h.View,{className:"sub",children:null===a||void 0===a||null===(d=a.subAreas)||void 0===d?void 0:d.map((function(e,t){var a;return(0,k.jsx)(h.View,{className:(0,n.classnames)("col",(null===e||void 0===e||null===(a=e.aname)||void 0===a?void 0:a.length)>7&&"sml"),onClick:function(){i.handleClickLocation(e)},children:e.aname})}))})]}):null}))})]}),i.getDataInitMore(e)&&(0,k.jsxs)(h.View,{className:"expand",onClick:function(){i.changeMoreState(t)},children:[(0,k.jsx)(h.Text,{className:"txt",children:null!==(o=i.state)&&void 0!==o&&null!==(o=o.areaListMoreData[t])&&void 0!==o&&o.more?w.Z.showMore:w.Z.showLess}),(0,k.jsx)(S.Z,{type:"icon",className:"arrow",children:null!==(r=i.state)&&void 0!==r&&null!==(r=r.areaListMoreData[t])&&void 0!==r&&r.more?Z.q.DIG:Z.q.zJj})]})]})})),!(null===s||void 0===s||!s.length)&&(0,k.jsx)(h.View,{className:"footer",children:(0,k.jsx)(h.Text,{className:"footerTex",children:w.Z.haveShownWholeContent})}),!r&&!(null!==s&&void 0!==s&&s.length)&&this.noAreaResult({className:"new-search-no-area",cityName:null===(a=this.state)||void 0===a?void 0:a.cityName}),r&&(0,k.jsx)(h.View,{className:"area-Loading"})]}),(0,k.jsx)(h.View,{className:"view-check",onAnimationEnd:function(){return i.viewReadyHandle&&i.viewReadyHandle()}})]})}}]),a}(x.Z),P=b,E=a(6017),H=a(26720),Y=a(3766),q=a(78955),U=a(54109),B=a(75199),W=function(e){return{currentLocation:(0,Y.vW)(e),isLoading:(0,U.Vc)(e),areaList:(0,H.RT)(),areaStorage:(0,H.Vz)(),rentalLocation:(0,B.gk)(e)}},K=function(e){return{setAreaStorage:function(t){return e((0,q.vI)(t))},getLocation:function(t){e((0,q.mX)(t))}}},G=(0,n.connect)(W,K)(P),J=(0,E.Z)(G),z=function(e){return(0,k.jsx)(J,(0,o.Z)({},e))},F=z,Q={navigationBarTitleText:"\u9009\u62e9\u53d6\u8f66\u5730\u70b9",navigationBarTextStyle:"black",navigationBarBackgroundColor:"#ffffff"};Page((0,i.createPageConfig)(F,"pages/carNew/isd/subPages/cityAndArea/area/index",{root:{cn:[]}},Q||{}))},79181:function(e){e.exports=require("../../../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../../../cwx/ext/global")},33675:function(e){e.exports=require("../../../../../../cwx/cwx")},44353:function(e){e.exports=require("../../../../../../cwx/cwx.js")},46346:function(e){e.exports=require("../../../../../../cwx/ext/global")}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[7606,2107,1216,8592],(function(){return t(8648)}));e.O()}]);
//# sourceMappingURL=index.js.map