"use strict";require("../../../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[9794],{40877:function(e,t,i){var n=i(32180),o=i(298),s=i(19153),c=i(57042),r=i(24460),a=i(81876),l=i(79038),d=i(59772),u=i(21867),h=i(86066),y=i(45023),p=i(90201),C=i(92954),v=i(71515),m=i(33675),S=i.n(m),x=i(64341),f=i(63118),w=i(4750),g=i(84758),L=i(45926),D=i(74629),Z=i(2269),I=D.Platform.COMPONENT_CHANNEL,N=function(e){var t=e.currentTab,i=e.handleChangeTab,n=function(e){i(e)};return(0,Z.jsx)(v.View,{className:"tab-change",children:(0,Z.jsxs)(v.View,{className:"tab-view",children:[(0,Z.jsx)(v.View,{className:(0,s.classnames)(t===I.ISD&&"active","item"),onClick:function(){n(I.ISD)},children:(0,Z.jsx)(v.Text,{className:"text",children:L.Z.isdLocation})}),(0,Z.jsx)(v.View,{className:(0,s.classnames)(t===I.OSD&&"active","item"),onClick:function(){n(I.OSD)},children:(0,Z.jsx)(v.Text,{className:"text",children:L.Z.osdLocation})})]})})},T=(0,p.memo)(N),k=i(26720),j=function(e){return{metroStationList:(0,k.l_)()}},O=function(e){return{}},A=(0,s.connect)(j,O)(T),V=i(19410),b=i(81194),_=i(35418),P=i(54237),H=i(95948),R=i(80762),E=i(16247),Y=i(55060),q=i(27019),M=i(31729),B=D.ObserverKey.CAR_CHANGE_LOCATION_EVENT,K=D.Platform.COMPONENT_CHANNEL,G=(0,p.memo)((function(e){var t=e.historys,i=e.appType,n=e.handleClickCity,o=e.handleDelHistory,c=e.cityId;return(0,Z.jsx)(v.View,{className:"city-section",id:"history",children:(0,Z.jsxs)(v.View,{className:"city-row",children:[(0,Z.jsxs)(v.View,{className:"city-row-title",children:[(0,Z.jsx)(v.Text,{className:"title",children:L.Z.history}),(0,Z.jsxs)(v.View,{className:"city-row-opt",onClick:o,children:[(0,Z.jsx)(b.Z,{type:"icon",className:"city-history-del",children:_.q.fJW}),(0,Z.jsx)(v.Text,{className:"del-txt",children:L.Z.delHistory})]})]}),(0,Z.jsx)(v.View,{className:"city-row-cont",children:null===t||void 0===t?void 0:t.map((function(e){var t;return(0,Z.jsx)(v.View,{className:(0,s.classnames)("col",i===K.ISD?"isd":"osd",(null===(t=e.name)||void 0===t?void 0:t.length)>5&&"sl",+e.cityId===+c&&"blue"),onClick:function(){n(e)},children:e.name},e.name)}))})]})})})),J=(0,p.memo)((function(e){var t=e.sections,i=e.handleClickLetter,n=e.currentAnchors,o=e.handleClickCity,s=function(e){var t,s,c=e.section;switch(c.key){case P.Sg.hot:var r=null===c||void 0===c||null===(t=c.data)||void 0===t?void 0:t[0],a=r.hots;return(0,Z.jsx)(v.View,{className:"city-section",id:"hot",children:null===a||void 0===a?void 0:a.map((function(e){var t;return(0,Z.jsxs)(v.View,{className:"hot-row",children:[(0,Z.jsxs)(v.View,{className:"hot-row-title",children:[(0,Z.jsx)(v.Image,{src:e.bgImage,className:"img",mode:"widthFix"}),(0,Z.jsx)(v.Text,{className:"title",style:{color:e.color},children:e.text})]}),(0,Z.jsx)(v.View,{className:"hot-row-cont",children:null===e||void 0===e||null===(t=e.cityInfo)||void 0===t?void 0:t.map((function(e){return(0,Z.jsxs)(v.View,{className:"city-name",onClick:function(){o(e)},children:[(0,Z.jsx)(v.Text,{className:"txt",children:e.name}),!!e.cornerTag&&(0,Z.jsx)(v.Text,{className:"mark",children:e.cornerTag})]})}))})]},e.text)}))});case P.Sg.anchor:var l=null===c||void 0===c||null===(s=c.data)||void 0===s?void 0:s[0];return(0,Z.jsx)(v.View,{className:"city-section",children:(0,Z.jsxs)(v.View,{className:"anchor-row",children:[(0,Z.jsx)(v.View,{className:"anchor-row-title",children:L.Z.anchorTitle}),(0,Z.jsx)(v.View,{className:"anchor-row-cont",children:null===l||void 0===l?void 0:l.map((function(e){return(0,Z.jsx)(v.View,{className:"col",onClick:function(){i(e.key,K.ISD,n)},children:(0,Z.jsx)(v.Text,{className:"txt",children:e.text})})}))})]})});default:return null}};return(0,Z.jsx)(v.View,{children:null===t||void 0===t?void 0:t.map((function(e){return(0,Z.jsx)(s,{section:e})}))})})),U=(0,p.memo)((function(e){var t=e.cities,i=e.appType,n=e.handleClickCity;return(0,Z.jsx)(v.View,{className:"city-section",children:null===t||void 0===t?void 0:t.map((function(e){var t;return(0,Z.jsxs)(v.View,{className:"city-row",id:e.key,children:[(0,Z.jsx)(v.View,{className:"city-row-title",children:e.text}),(0,Z.jsx)(v.View,{className:"city-row-cont",children:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.map((function(e){var t;return(0,Z.jsx)(v.View,{className:(0,s.classnames)("col",i===K.ISD?"isd":"osd",(null===(t=e.name)||void 0===t?void 0:t.length)>5&&"sl"),onClick:function(){n(e)},children:e.name},e.name)}))})]},e.text)}))})})),W=function(e){(0,u.Z)(i,e);var t=(0,h.Z)(i);function i(e){var n;return(0,c.Z)(this,i),n=t.call(this,e),(0,y.Z)((0,a.Z)(n),"options",void 0),(0,y.Z)((0,a.Z)(n),"isLoginPending",!1),(0,y.Z)((0,a.Z)(n),"preCacheProxy",void 0),(0,y.Z)((0,a.Z)(n),"autoExpose",void 0),(0,y.Z)((0,a.Z)(n),"setLoadData",(function(){var e,t,i=(0,R.getCarEnv)()||{},o=i.currentEnv,s=(0,E.getCityResISD)(),c=(0,H.useComposeCitySection)(s,f.Z.APP_TYPE.ISD),r=(0,E.getCityResOSD)(),a=(0,H.useComposeCitySection)(r,f.Z.APP_TYPE.OSD),l=n.state,d=l.currentAppendISD,u=l.currentAppendOSD,h=(l.currentTab,null===c||void 0===c||null===(e=c.cities)||void 0===e?void 0:e.slice(0,d)),y=null===a||void 0===a||null===(t=a.cities)||void 0===t?void 0:t.slice(0,u);n.setState({isdCityCurrentList:h,osdCityCurrentList:y,isdCityList:c,osdCityList:a,currentTab:o})})),(0,y.Z)((0,a.Z)(n),"loadAllSection",(function(){var e,t,i=n.state,o=i.isdCityList,s=i.osdCityList;n.setState({isdCityCurrentList:null===o||void 0===o?void 0:o.cities,osdCityCurrentList:null===s||void 0===s?void 0:s.cities,currentAppendISD:null===o||void 0===o||null===(e=o.cities)||void 0===e?void 0:e.length,currentAppendOSD:null===s||void 0===s||null===(t=s.cities)||void 0===t?void 0:t.length,loadAll:!0})})),(0,y.Z)((0,a.Z)(n),"appendNextSection",(function(){var e=n.state,t=e.currentTab,i=e.currentAppendISD,o=e.currentAppendOSD;if(t===K.ISD){var s=n.state.isdCityList.cities;if(i>(null===s||void 0===s?void 0:s.length))return;n.setState({isdCityCurrentList:null===s||void 0===s?void 0:s.slice(0,i+1),currentAppendISD:i+1})}else{var c=n.state.osdCityList.cities;if(o>(null===c||void 0===c?void 0:c.length))return;n.setState({osdCityCurrentList:null===c||void 0===c?void 0:c.slice(0,o+1),currentAppendOSD:o+1})}})),(0,y.Z)((0,a.Z)(n),"handleScrollLower",(function(){n.state.loadAll||n.appendNextSection()})),(0,y.Z)((0,a.Z)(n),"handleClickLetter",(function(e,t,i){var o=null===i||void 0===i?void 0:i.indexOf(null===i||void 0===i?void 0:i.find((function(t){return t.key===e}))),s=n.state.loadAll;t===K.ISD?n.setState({currentAppendISD:s?n.state.currentAppendISD:o,scrollCodeISD:e},(function(){s||n.appendNextSection()})):t===K.OSD&&n.setState({currentAppendOSD:s?n.state.currentAppendOSD:o,scrollCodeOSD:e},(function(){s||n.appendNextSection()}))})),(0,y.Z)((0,a.Z)(n),"showStorage",(function(){var e=V.Z.geStorage(D.StorageKey.CAR_CITY_HISTORY_ISD)||[],t=V.Z.geStorage(D.StorageKey.CAR_CITY_HISTORY_OSD)||[];n.setState({isdCityHistoryList:e,osdCityHistoryList:t})})),(0,y.Z)((0,a.Z)(n),"handleDelHistory",(function(){var e=n.state.currentTab;e===K.ISD?V.Z.setStorage(D.StorageKey.CAR_CITY_HISTORY_ISD,[]):V.Z.setStorage(D.StorageKey.CAR_CITY_HISTORY_OSD,[]),n.showStorage()})),(0,y.Z)((0,a.Z)(n),"handleClickLocation",(function(e){var t=n.props,i=t.setAreaStorage,o=t.rentalLocation;if("0"!==e.area.type){if(i(e),void 0!==e.isDomestic){var s=(0,q.M)(o,e);s&&(0,M.Z)({carEnv:{appType:(0,R.getAppType)(e.isDomestic)}})}S().Observer.noti(B,{type:"message",options:{detail:{data:[{rentalLocation:JSON.stringify(e)}]}}}),S().navigateBack(1)}else n.handleClickCity({id:+e.cid,name:e.cname,isDomestic:e.isDomestic})})),(0,y.Z)((0,a.Z)(n),"handleClickCity",(0,s.debounce)((function(e){var t=e.id,i=e.name,o=e.isDomestic,s={cityId:+t,cityName:i,fromCity:!0,isDomestic:o};n.props.setTempLocation({tempLocation:{cid:+t,cname:i,country:""}}),n.props.fetchAreaList(),S().navigateTo({url:"/pages/carNew/isd/subPages/cityAndArea/area/index?cityInfo=".concat(encodeURIComponent(JSON.stringify(s)))})}),500)),(0,y.Z)((0,a.Z)(n),"clickPoi",(function(e){e.addr;var t=e.id,i=e.lat,o=e.lng,s=e.name,c=e.formataddr,r={cid:+t,cname:s,isDomestic:!0,area:{id:"",lat:i,lng:o,name:c}};n.handleClickLocation(r)})),(0,y.Z)((0,a.Z)(n),"isShowLocation",(function(){var e=n.props.currentLocation;return null===e||void 0===e?void 0:e.isDomestic})),(0,y.Z)((0,a.Z)(n),"isShowLocationTick",(function(){var e=n.props.currentLocation;return+n.state.cityId===+(null===e||void 0===e?void 0:e.id)})),(0,y.Z)((0,a.Z)(n),"refreshObservePage",(function(){n.__page&&n.__page.getDOMProps&&"undefined"!==typeof n.__page.exposeObserver&&S().sendUbtExpose.refreshObserve((0,a.Z)(n))})),(0,y.Z)((0,a.Z)(n),"handleChangeTab",(function(e){n.setState({currentTab:e,currentSelect:e})})),(0,y.Z)((0,a.Z)(n),"setShowCityList",(function(e){n.setState({showCityList:e})})),n.state={scrollCodeISD:"",scrollCodeOSD:"",cityStorage:[],cityId:"",hideCityResult:!1,currentAppend:"",currentAppendISD:2,currentAppendOSD:5,isdCityCurrentList:[],osdCityCurrentList:[],currentTab:K.ISD,loadAll:!1,isdCityHistoryList:[],osdCityHistoryList:[],isdCityList:[],osdCityList:[],currentSelect:"",showCityList:!0},n.autoExpose=!0,n.preCacheProxy={},n.checkPerformance=!0,n}return(0,r.Z)(i,[{key:"getPageId",value:function(){return this.pageId=Y.Channel.getPageId().CITY.ID,this.pageId}},{key:"onLoad",value:function(e){this.options=e,(0,l.Z)((0,d.Z)(i.prototype),"onLoad",this).call(this,e),this.showStorage(),this.setLoadData()}},{key:"onReady",value:function(){var e;(0,l.Z)((0,d.Z)(i.prototype),"onReady",this).call(this),this.onPageReady();var t=null===(e=(0,C.getCurrentInstance)())||void 0===e||null===(e=e.router)||void 0===e?void 0:e.params,n=t||{},o=n.cityId;this.setState({cityId:o}),this.props.getLocation()}},{key:"componentDidShow",value:function(){(0,l.Z)((0,d.Z)(i.prototype),"componentDidShow",this).call(this)}},{key:"componentDidHide",value:function(){(0,l.Z)((0,d.Z)(i.prototype),"componentDidHide",this).call(this)}},{key:"onPageReady",value:function(){var e=this;this.performanceMonitor.interactiveStart=new Date,this.performanceMonitor.submit(),this.performanceMonitor.contentShowStart=this.performanceMonitor.interactiveStart,this.performanceMonitor.submitTTI(),setTimeout((function(){e.loadAllSection()}),1e3)}},{key:"render",value:function(){var e=this,t=this.state,i=t.scrollCodeISD,n=t.scrollCodeOSD,o=(t.cityStorage,t.cityId),c=t.isdCityCurrentList,r=t.osdCityCurrentList,a=t.currentTab,l=t.isdCityHistoryList,d=t.osdCityHistoryList,u=t.isdCityList,h=t.osdCityList,y=t.currentSelect,p=t.showCityList,C=(K.ISD,K.OSD,u.anchors),m=h.anchors,S=a===K.ISD?C:m;return(0,Z.jsxs)(v.View,{className:"city-page",children:[(0,Z.jsx)(w.Z,{type:"city",handleClickLocation:this.handleClickLocation,handleClickCity:this.handleClickCity,refreshObservePage:this.refreshObservePage,currentTab:a,setShowCityList:this.setShowCityList}),p&&(0,Z.jsx)(A,{currentTab:a,handleChangeTab:this.handleChangeTab}),p&&(0,Z.jsxs)(v.View,{className:(0,s.classnames)("cityView",y===K.ISD&&"slideRight",y===K.OSD&&"slideLeft",a===K.ISD&&"transRight",a===K.OSD&&"transLeft"),children:[(0,Z.jsxs)(v.ScrollView,{scrollY:!0,scrollIntoView:i,className:"location-scroll",onScrollToLower:this.handleScrollLower,children:[this.isShowLocation()&&(0,Z.jsxs)(v.View,{className:"my-location",id:"location","data-testid":D.UITestID.car_testid_page_city_locate,children:[(0,Z.jsx)(v.View,{className:"city-title",children:L.Z.curlocation}),(0,Z.jsx)(g.Z,{clickPoi:this.clickPoi,showTick:this.isShowLocationTick()})]}),!(null===l||void 0===l||!l.length)&&(0,Z.jsx)(G,{historys:l,appType:K.ISD,handleClickCity:this.handleClickCity,handleDelHistory:this.handleDelHistory,cityId:o}),(0,Z.jsx)(J,{sections:null===u||void 0===u?void 0:u.sections,handleClickLetter:this.handleClickLetter,currentAnchors:S,handleClickCity:this.handleClickCity}),(0,Z.jsx)(U,{cities:c,appType:K.ISD,handleClickCity:this.handleClickCity})]}),(0,Z.jsxs)(v.ScrollView,{scrollY:!0,scrollIntoView:n,className:"location-scroll",onScrollToLower:this.handleScrollLower,children:[!(null===d||void 0===d||!d.length)&&(0,Z.jsx)(G,{historys:d,appType:K.OSD,handleClickCity:this.handleClickCity,handleDelHistory:this.handleDelHistory,cityId:o}),(0,Z.jsx)(J,{sections:null===h||void 0===h?void 0:h.sections,handleClickCity:this.handleClickCity}),(0,Z.jsx)(U,{cities:r,appType:K.OSD,handleClickCity:this.handleClickCity})]})]}),p&&(0,Z.jsx)(v.View,{className:"city-letter-list",children:(0,Z.jsx)(v.View,{className:"city-letter-group",children:null===S||void 0===S?void 0:S.map((function(t){return(0,Z.jsx)(v.View,{className:"city-letter-item",onClick:function(){e.handleClickLetter(t.key,a,S)},id:t.key,children:t.text},t.key)}))})}),(0,Z.jsx)(v.View,{className:"view-check",onAnimationEnd:function(){return e.viewReadyHandle&&e.viewReadyHandle()}})]})}}]),i}(x.Z),F=W,X=i(6017),z=i(78955),Q=i(3766),$=i(41693),ee=i(75199),te=function(e){return{currentLocation:(0,Q.vW)(e),searchLocations:(0,E.getSearchCityLocations)(),rentalLocation:(0,ee.gk)(e)}},ie=function(e){return{getLocation:function(t){e((0,z.mX)(t))},setTempLocation:function(t){return e((0,$.pp)(t))},fetchAreaList:function(t){return e((0,$.Vt)(t))},setAreaStorage:function(t){return e((0,z.vI)(t))}}},ne=(0,s.connect)(te,ie)(F),oe=(0,X.Z)(ne),se=function(e){return(0,Z.jsx)(oe,(0,o.Z)({},e))},ce=se,re={navigationBarTitleText:"\u9009\u62e9\u53d6\u8f66\u5730\u70b9",navigationBarTextStyle:"black",navigationBarBackgroundColor:"#ffffff"};Page((0,n.createPageConfig)(ce,"pages/carNew/isd/subPages/cityAndArea/city/index",{root:{cn:[]}},re||{}))},79181:function(e){e.exports=require("../../../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../../../cwx/ext/global")},33675:function(e){e.exports=require("../../../../../../cwx/cwx")},44353:function(e){e.exports=require("../../../../../../cwx/cwx.js")},46346:function(e){e.exports=require("../../../../../../cwx/ext/global")}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[7606,2107,1216,8592],(function(){return t(40877)}));e.O()}]);
//# sourceMappingURL=index.js.map