"use strict";require("../../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[9515],{58971:function(e,r,i){var t=i(32180),n=i(298),a=i(19153),o=i(57042),s=i(24460),d=i(81876),c=i(79038),l=i(59772),v=i(21867),u=i(86066),g=i(45023),f=i(90201),_=i(71515),h=i(33675),p=i.n(h),m=i(64341),N=i(55060),x=i(74629),y=N.Utils.getSharkValue,A={get driversAdd(){return y("drivers_add")},get hasEnd(){return y("hasEnd")},get driverContactPhone(){return y("driver_contact_phone")},get driverContactEmail(){return y("driver_contact_phone")},get driverIsdPleaseAdd(){return y("driver_isd_please_add")},get driverIsdName(){return y("driver_isd_name")},get driverIsdCertificate(){return y("driver_isd_certificate")},get driverIsdPhone(){return y("driver_isd_Phone")},get driverCertificateTypeIdNo(){return y("driver_certificate_type_id_no")},get driverCertificateTypePassport(){return y("driver_certificate_type_passport")},get driverCertificateTypeHomereturnpermitNo(){return y("driver_certificate_type_homereturnpermit_no")},get driverCertificateTypeMtpsNo(){return y("driver_certificate_type_mtps_no")},get driver_noEnglishName(){return y("driver_noEnglishName")},get driver_noEnglishName_Age(){return y("driver_noEnglishName_Age")},get driver_noEnglishName_Nationality(){return y("driver_noEnglishName_Nationality")},get driver_noEnglishName_Phone(){return y("driver_noEnglishName_Phone")},get driver_noAge_Nationality(){return y("driver_noAge_Nationality")},get driver_noAge_Phone(){return y("driver_noAge_Phone")},get driver_noNationality_Phone(){return y("driver_noNationality_Phone")},get driver_noEnglishName_Age_Nationality(){return y("driver_noEnglishName_Age_Nationality")},get driver_noEnglishName_Age_Phone(){return y("driver_noEnglishName_Age_Phone")},get driver_noEnglishName_Nationality_Phone(){return y("driver_noEnglishName_Nationality_Phone")},get driver_noAge_Nationality_Phone(){return y("driver_noAge_Nationality_Phone")},get driver_noEnglishName_Age_Nationality_Phone(){return y("driver_noEnglishName_Age_Nationality_Phone")},get driver_nationality(){return y("driver_nationality")},get drivers_noAgeTips(){return y("drivers_noAgeTips")},get driver_noPhone(){return y("driver_noPhone")},get driver_noNationality(){return y("driver_noNationality")},get drivers_dateOfBirth(){return y("drivers_dateOfBirth")},ageYear:function(e){return y("ageYear",e)},driversDateOfBirthTooYoung:function(e){return y("drivers_dateOfBirthTooYoung",e)},drivers_yongAge:function(e){return y("drivers_yongAge",e)},drivers_oldAge:function(e){return y("drivers_oldAge",e)}},C=i(2269),P=function(e){var r=e.data,i=e.availableCertificates,t=void 0===i?[]:i,n=e.curCertificates,o=e.isLast,s=e.passenger,d=e.isOsd,c=e.yongAge,l=void 0===c?0:c,v=e.oldAge,u=void 0===v?0:v,g=e.onPress,h=e.onEdit,p=r.fullName,m=r.mobile,y=r.certificateList,P=r.passengerId,T=r.nationalityName,w=r.firstName,I=r.lastName,b=r.birthday,E=r.age,j=(0,f.useMemo)((function(){var e=null===n||void 0===n?void 0:n[P],r=t.includes(e)?e:"",i=y.find((function(e){return(r||e.certificateType)===e.certificateType&&t.includes&&t.includes(e.certificateType)}));if(i&&i.certificateType===x.DriverConstants.CertificateType.id){var o=(0,a.cloneDeep)(i);return o.certificateNo=N.Utils.identifyIdMask(i.certificateNo),o}return i}),[t,y,n,P]),D=(0,f.useCallback)((function(e){switch(e){case x.DriverConstants.CertificateType.id:return A.driverCertificateTypeIdNo;case x.DriverConstants.CertificateType.passport:return A.driverCertificateTypePassport;case x.DriverConstants.CertificateType.homereturnpermit:return A.driverCertificateTypeHomereturnpermitNo;case x.DriverConstants.CertificateType.mtps:return A.driverCertificateTypeMtpsNo;default:return""}}),[]),k=function(){var e=r.fullName,i=r.mobile,t=r.nationalityName,n=r.firstName,a=r.lastName,o=r.birthday,s=!t,c=!n||!a,l=!o,v=!i,u=!j,g=!e,f=d?"osd":"isd";switch(f){case"osd":return c&&l&&s&&v?A.driver_noEnglishName_Age_Nationality_Phone:c&&l&&s?A.driver_noEnglishName_Age_Nationality:c&&l&&v?A.driver_noEnglishName_Age_Phone:c&&s&&v?A.driver_noEnglishName_Nationality_Phone:l&&s&&v?A.driver_noAge_Nationality_Phone:c&&l?A.driver_noEnglishName_Age:c&&s?A.driver_noEnglishName_Nationality:c&&v?A.driver_noEnglishName_Phone:l&&s?A.driver_noAge_Nationality:l&&v?A.driver_noAge_Phone:s&&v?A.driver_noNationality_Phone:c?A.driver_noEnglishName:l?A.drivers_noAgeTips:s?A.driver_noNationality:v?A.driver_noPhone:"";case"isd":return g&&u&&v?"".concat(A.driverIsdPleaseAdd).concat(A.driverIsdName,"\u3001").concat(A.driverIsdCertificate,"\u3001").concat(A.driverIsdPhone):g&&u?"".concat(A.driverIsdPleaseAdd).concat(A.driverIsdName,"\u3001").concat(A.driverIsdCertificate):g&&v?"".concat(A.driverIsdPleaseAdd).concat(A.driverIsdName,"\u3001").concat(A.driverIsdPhone):u&&v?"".concat(A.driverIsdPleaseAdd).concat(A.driverIsdCertificate,"\u3001").concat(A.driverIsdPhone):g?"".concat(A.driverIsdPleaseAdd).concat(A.driverIsdName):u?"".concat(A.driverIsdPleaseAdd).concat(A.driverIsdCertificate):v?"".concat(A.driverIsdPleaseAdd).concat(A.driverIsdPhone):""}},L=(0,f.useMemo)((function(){var e=d?"osd":"isd";switch(e){case"osd":if(l>0&&E<l)return A.drivers_yongAge(l);if(u>0&&E>u)return A.drivers_oldAge(u);case"isd":var r=y.find((function(e){return e.certificateType===x.DriverConstants.CertificateType.id}))||{},i=r.certificateNo;return N.Utils.isFull18IdCard(i)?"":A.driversDateOfBirthTooYoung(18);default:return""}}),[y,l,u]),V=k(),B=(0,f.useMemo)((function(){return!L&&!V}),[L,V]),Z=D(j&&j.certificateType),O=(0,f.useMemo)((function(){return!(!s||!s.passengerId||s.passengerId!==P)}),[P,s]),U=(0,f.useCallback)((function(){g(r)}),[g,r]),q=(0,f.useCallback)((function(e){e.stopPropagation(),h(r)}),[h,r]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(_.View,{onClick:B?U:q,className:"driver-item-wrap",children:[(0,C.jsxs)(_.View,{className:"driver-item-left",children:[(0,C.jsx)(_.Text,{className:(0,a.classnames)("check-radiobox",B?O?"checked":"":"disable")}),(0,C.jsxs)(_.View,{className:"item-info-wrap",children:[(0,C.jsxs)(_.Text,{className:(0,a.classnames)("driver-name",B?"":"disable"),children:[p," ",I&&w&&"".concat(I,"/").concat(w)]}),!!j&&(0,C.jsxs)(_.View,{className:"driver-info-wrap",children:[(0,C.jsx)(_.Text,{className:"driver-info text-info-label",children:Z}),(0,C.jsx)(_.Text,{className:"driver-info text-info-value",children:j&&j.certificateNo})]}),!!b&&d&&(0,C.jsxs)(_.View,{className:"driver-info-wrap",children:[(0,C.jsx)(_.Text,{className:"driver-info text-info-label",children:A.drivers_dateOfBirth}),(0,C.jsxs)(_.Text,{className:"driver-info text-info-value",children:[b," ",A.ageYear(E)]})]}),!!m&&(0,C.jsxs)(_.View,{className:"driver-info-wrap",children:[(0,C.jsx)(_.Text,{className:"driver-info text-info-label",children:A.driverContactPhone}),(0,C.jsx)(_.Text,{className:"driver-info text-info-value",children:m})]}),!!T&&d&&(0,C.jsxs)(_.View,{className:"driver-info-wrap",children:[(0,C.jsx)(_.Text,{className:"driver-info text-info-label",children:A.driver_nationality}),(0,C.jsx)(_.Text,{className:"driver-info text-info-value",children:T})]}),!!V&&(0,C.jsx)(_.Text,{className:"driver-info-tip driver-info-error",children:V}),!V&&!!L&&(0,C.jsx)(_.Text,{className:"driver-info-tip driver-info-warning",children:L})]})]}),(0,C.jsx)(_.View,{className:"driver-item-right",onClick:q,children:(0,C.jsx)(_.Text,{className:"icon_edit ico-mg1"})})]}),!o&&(0,C.jsx)(_.View,{className:"driver-item-line"})]})},T=P,w=i(96103),I=function(e){(0,v.Z)(i,e);var r=(0,u.Z)(i);function i(e){var t;return(0,o.Z)(this,i),t=r.call(this,e),(0,g.Z)((0,d.Z)(t),"addDriver",(0,a.debounce)((function(){var e={isAdd:!0,fromUrl:"driver"};p().navigateTo({url:"/pages/carNew/isd/subPages/driverEdit/index?data=".concat(encodeURIComponent(JSON.stringify(e)))})}),300,{trailing:!1,leading:!0})),(0,g.Z)((0,d.Z)(t),"editDriver",(0,a.debounce)((function(e){var r={driver:e,isAdd:!1,fromUrl:"driver"};p().navigateTo({url:"/pages/carNew/isd/subPages/driverEdit/index?data=".concat(encodeURIComponent(JSON.stringify(r)))})}),300,{trailing:!1,leading:!0})),(0,g.Z)((0,d.Z)(t),"onSelectDriver",(function(e){p().navigateBack(),setTimeout((function(){return t.props.selectDriver(e)}))})),t.state={},t.checkPerformance=!0,t}return(0,s.Z)(i,[{key:"getPageId",value:function(){return this.pageId=N.Channel.getPageId().DRIVER.ID,this.pageId}},{key:"componentWillMount",value:function(){var e;this.props.fetchApiDriverList(),null!==(e=this.props.availableCertificates)&&void 0!==e&&e.length||this.props.fetchApiIdCardList()}},{key:"componentWillUnmount",value:function(){var e=this;(0,c.Z)((0,l.Z)(i.prototype),"componentWillUnmount",this).call(this),w.po.afterNavigateBack((function(r){e.props.backToBooking(r)}))}},{key:"render",value:function(){var e=this,r=this.props,i=r.isLoadingSuccess,t=r.passengerList,n=r.isLoading,a=N.Utils.isCtripOsd();return(0,C.jsxs)(_.View,{className:"driver-page-container",children:[(0,C.jsx)(_.View,{className:"add-driver-btn-wrap",onClick:this.addDriver,children:(0,C.jsxs)(_.View,{className:"add-driver-btn-content",children:[(0,C.jsx)(_.View,{className:"add-btn-icon icon-add"}),(0,C.jsx)(_.View,{className:"add-btn-text",children:A.driversAdd})]})}),!n&&i&&(null===t||void 0===t?void 0:t.length)&&(null===t||void 0===t?void 0:t.map((function(r,i){return(0,C.jsx)(T,{data:r,availableCertificates:e.props.availableCertificates,curCertificates:e.props.curCertificates,passenger:e.props.passenger,yongAge:e.props.yongAge,oldAge:e.props.oldAge,isOsd:a,isLast:i===e.props.passengerList.length-1,onEdit:e.editDriver,onPress:e.onSelectDriver})}))),(0,C.jsxs)(_.View,{className:"bottom-text",children:[A.hasEnd,"~"]}),(0,C.jsx)(_.View,{className:"view-check",onAnimationEnd:function(){return e.viewReadyHandle&&e.viewReadyHandle()}})]})}}]),i}(m.Z),b=I,E=i(91882),j=i(94704),D=i(62813),k=i(70753),L=i(34719),V=i(86504),B=i(58419),Z=i(27110),O=i(22189),U=i(6017),q=function(e){var r=(0,D.z9)(e),i=(0,k.XE)(r)||{},t=i.ageRestriction,n=void 0===t?{}:t,a=n.maxDriverAge,o=n.minDriverAge,s=o,d=a;return{passengerList:(0,j.zr)(e),availableCertificates:(0,j.Pj)(e),passenger:(0,j.ly)(e),curCertificates:(0,j.nX)(e),isLoadingSuccess:(0,j.ms)(e),isLoading:(0,j.Vc)(e),yongAge:s,oldAge:d}},S=function(e){var r=(0,L.z9)(e),i=(0,V.XE)(r)||{},t=i.ageRestriction,n=void 0===t?{}:t,a=n.maxDriverAge,o=n.minDriverAge,s=o,d=a;return{passengerList:(0,j.zr)(e),availableCertificates:(0,j.Pj)(e),passenger:(0,j.ly)(e),curCertificates:(0,j.nX)(e),isLoadingSuccess:(0,j.ms)(e),isLoading:(0,j.Vc)(e),yongAge:s,oldAge:d}},M=function(e){return{selectDriver:function(r){return e((0,E.lF)((0,n.Z)((0,n.Z)({},r),{},{queryPriceInfo:!0})))},fetchApiDriverList:function(r){return e((0,E.hy)(r))},fetchApiIdCardList:function(r){return e((0,E.DB)(r))},backToBooking:function(r){e((0,B.EL)(r)),e((0,B.BG)(!0))}}},R=function(e){return{selectDriver:function(r){return e((0,E.lF)((0,n.Z)((0,n.Z)({},r),{},{queryPriceInfo:!0})))},fetchApiDriverList:function(r){return e((0,E.hy)(r))},fetchApiIdCardList:function(r){return e((0,E.DB)(r))},backToBooking:function(r){e((0,Z.EL)(r)),e((0,O.BG)(!0))}}},Y=N.Utils.isCtripOsd()?(0,a.connect)(S,R)(b):(0,a.connect)(q,M)(b),z=(0,U.Z)(Y),F=function(e){return(0,C.jsx)(z,(0,n.Z)({},e))},G=F,H={navigationBarTitleText:"\u9009\u62e9\u9a7e\u9a76\u5458",navigationBarTextStyle:"black",navigationBarBackgroundColor:"#ffffff"};Page((0,t.createPageConfig)(G,"pages/carNew/isd/subPages/driverList/index",{root:{cn:[]}},H||{}))},79181:function(e){e.exports=require("../../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../../cwx/ext/global")},33675:function(e){e.exports=require("../../../../../cwx/cwx")},44353:function(e){e.exports=require("../../../../../cwx/cwx.js")},46346:function(e){e.exports=require("../../../../../cwx/ext/global")}},function(e){var r=function(r){return e(e.s=r)};e.O(0,[7606,2107,1216,8592],(function(){return r(58971)}));e.O()}]);
//# sourceMappingURL=index.js.map