"use strict";require("../../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[1239],{5163:function(e,n,r){var t=r(32180),o=r(298),a=r(19153),c=r(57042),l=r(24460),i=r(81876),s=r(79038),u=r(59772),d=r(21867),f=r(86066),x=r(45023),h=r(90201),p=r(71515),m=r(64341),C=r(55060),g=C.Utils.getSharkValue,w={get orderCancelTitle(){return g("orderCancelTitle")},get orderCancelBtn(){return g("orderCancelBtn")},get cancelOrder(){return g("order_cancelOrder")},get cancelTips(){return g("order_cancelTips")},get cancelFee(){return g("order_cancelFee")},get cancelReason(){return g("order_cancelReason")},get textareaPlaceHolder(){return g("order_placeHolder")},get cancelOrderValidateError(){return g("cancelOrderValidateError")}},R=r(90129),v=r(22548),Z=r(2269),N=function(e){var n=e.cancelReasons,r=e.reasonsRef,t=e.textareaRef,o=e.isShowNoReasonError,a=e.selectedReasonCallBack,c=(0,h.useRef)(""),l=(0,h.useRef)({}),i=(0,h.useState)({}),s=(0,R.Z)(i,2),u=s[0],d=s[1],f=(0,h.useCallback)((function(e){d(e),l.current=e,"function"===typeof a&&a()}),[n,o]);return(0,h.useEffect)((function(){t(c),r(l)}),[]),null!==n&&void 0!==n&&n.length?(0,Z.jsxs)(p.View,{className:"reasonWrap",children:[(0,Z.jsx)(p.Text,{className:"f32",children:w.cancelReason}),o&&(0,Z.jsxs)(p.View,{className:"flex flex-row showNoReasonErrorWrap",children:[(0,Z.jsx)(p.Text,{className:"icon-circleIFilled"}),(0,Z.jsx)(p.Text,{className:"showNoReasonError",children:w.cancelOrderValidateError})]}),(0,Z.jsx)(p.View,{className:"flex flex-row-wrap mt32",children:null===n||void 0===n?void 0:n.map((function(e){return(0,Z.jsx)(j,{isSelected:u.code===e.code,title:e.title,code:e.code,onClick:f})}))}),(0,Z.jsx)(p.Textarea,{className:"reason-textarea",autoHeight:!0,placeholderClass:"textarea-placeholder",placeholder:w.textareaPlaceHolder,maxlength:100,ref:c})]}):null},j=(0,h.memo)((function(e){var n=e.title,r=e.code,t=e.onClick,o=e.isSelected,a=(0,h.useCallback)((function(){t({code:r,title:n})}),[r,n]);return(0,Z.jsx)(v.Z,{onClick:a,className:"textBtn reason-item ".concat(o&&"isSelected"),children:n})})),T=(0,h.memo)(N),k=r(90607),B=function(e){return{cancelReasons:(0,k.Qb)(e)}},S=(0,a.connect)(B)(T),b=r(37031),O=function(e){var n=e.penaltyAmount;return(0,Z.jsxs)(p.View,{className:"cancelOrder-fee",children:[(0,Z.jsx)(p.Text,{className:"tip",children:w.cancelTips}),(0,Z.jsxs)(p.View,{className:"flex between-horizontal",children:[(0,Z.jsx)(p.Text,{className:"f32",children:w.cancelFee}),(0,Z.jsx)(b.Z,{className:"feeLine flex f32 price-orange",price:n,currency:"CNY"})]})]})},V=(0,h.memo)(O),y=function(e){var n,r;return{penaltyAmount:(0,k.il)(e)?null!==(n=null===(r=(0,k.il)(e))||void 0===r?void 0:r.amount)&&void 0!==n?n:"0":""}},E=(0,a.connect)(y)(V),M=r(63562),P=function(e){var n=e.visible,r=e.onPopupClose,t=e.title,o=e.leftBtnText,a=e.rightBtnText,c=e.leftBtnClick,l=e.rightBtnClick;return(0,Z.jsx)(M.Z,{visible:n,onPopupClose:r,className:"confirmModalWrap",renderContent:(0,Z.jsxs)(p.View,{children:[(0,Z.jsx)(p.Text,{className:"title",children:t}),(0,Z.jsxs)(p.View,{className:"btns",children:[(0,Z.jsx)(v.Z,{onClick:c,className:"leftBtn",children:o}),(0,Z.jsx)(v.Z,{onClick:l,className:"rightBtn",children:a})]})]})})},q=P,I=function(e){(0,d.Z)(r,e);var n=(0,f.Z)(r);function r(e){var t;return(0,c.Z)(this,r),t=n.call(this,e),(0,x.Z)((0,i.Z)(t),"textareaRef",null),(0,x.Z)((0,i.Z)(t),"reasonsRef",null),(0,x.Z)((0,i.Z)(t),"showConfirmModal",(function(){var e,n=(null===(e=t.reasonsRef)||void 0===e?void 0:e.current)||{},r=n.title;r?t.setState({confirmModalVisible:!0}):t.setState({isShowNoReasonError:!0})})),(0,x.Z)((0,i.Z)(t),"hideConfirmModal",(function(){t.setState({confirmModalVisible:!1})})),(0,x.Z)((0,i.Z)(t),"getTextareaRef",(function(e){t.textareaRef=e})),(0,x.Z)((0,i.Z)(t),"getReasonsRef",(function(e){t.reasonsRef=e})),(0,x.Z)((0,i.Z)(t),"toCancelOrder",(function(){var e,n,r=(null===(e=t.reasonsRef)||void 0===e?void 0:e.current)||{},o=r.title,a=r.code,c=null===(n=t.textareaRef)||void 0===n||null===(n=n.current)||void 0===n?void 0:n.value,l="".concat(o).concat(c?";".concat(c):"");t.props.toCancelOrder({reason:l,reasonCode:a})})),(0,x.Z)((0,i.Z)(t),"handleSelectedReason",(function(){t.state.isShowNoReasonError&&t.setState({isShowNoReasonError:!1})})),t.state={confirmModalVisible:!1,isShowNoReasonError:!1},t}return(0,l.Z)(r,[{key:"getPageId",value:function(){return this.pageId=C.Channel.getPageId().ORDER_CANCEL.ID,this.pageId}},{key:"onReady",value:function(){(0,s.Z)((0,u.Z)(r.prototype),"onReady",this).call(this);var e=this.props,n=e.fetchQueryCancelFee,t=e.orderId;n(t)}},{key:"componentDidShow",value:function(){(0,s.Z)((0,u.Z)(r.prototype),"componentDidShow",this).call(this)}},{key:"componentWillUnmount",value:function(){(0,s.Z)((0,u.Z)(r.prototype),"componentWillUnmount",this).call(this)}},{key:"render",value:function(){var e=this.state,n=e.confirmModalVisible,r=e.isShowNoReasonError;return(0,Z.jsxs)(p.View,{className:"cancelOrder-wrapper",children:[(0,Z.jsxs)(p.ScrollView,{scrollY:!0,children:[(0,Z.jsx)(E,{}),(0,Z.jsx)(S,{isShowNoReasonError:r,reasonsRef:this.getReasonsRef,textareaRef:this.getTextareaRef,selectedReasonCallBack:this.handleSelectedReason})]}),(0,Z.jsx)(p.View,{className:"footerBox",children:(0,Z.jsx)(v.Z,{onClick:this.showConfirmModal,className:"footerBox-btn",children:w.cancelOrder})}),(0,Z.jsx)(q,{title:w.orderCancelTitle,visible:n,leftBtnText:w.orderCancelBtn,rightBtnText:w.cancelOrder,onPopupClose:this.hideConfirmModal,leftBtnClick:this.hideConfirmModal,rightBtnClick:this.toCancelOrder})]})}}]),r}(m.Z),_=I,F=r(26338),W=r(6017),D=function(e){return{orderId:(0,k.NO)(e)}},H=function(e){return{toCancelOrder:function(n){return e((0,F.at)(n))},fetchQueryCancelFee:function(n){return e((0,F.k)(n))}}},A=(0,a.connect)(D,H)(_),Q=(0,W.Z)(A),U=function(e){return(0,Z.jsx)(Q,(0,o.Z)({},e))},G=U,L={navigationBarTitleText:"\u53d6\u6d88\u8ba2\u5355",navigationBarTextStyle:"black",navigationBarBackgroundColor:"#ffffff"};Page((0,t.createPageConfig)(G,"pages/carNew/isd/subPages/cancelOrder/index",{root:{cn:[]}},L||{}))},79181:function(e){e.exports=require("../../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../../cwx/ext/global")},33675:function(e){e.exports=require("../../../../../cwx/cwx")},44353:function(e){e.exports=require("../../../../../cwx/cwx.js")},46346:function(e){e.exports=require("../../../../../cwx/ext/global")}},function(e){var n=function(n){return e(e.s=n)};e.O(0,[7606,2107,1216,8592],(function(){return n(5163)}));e.O()}]);
//# sourceMappingURL=index.js.map