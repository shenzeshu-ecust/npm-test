"use strict";require("../../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[342],{4187:function(e,o,n){var s=n(32180),i=n(298),t=n(19153),c=n(57042),a=n(24460),l=n(81876),u=n(79038),r=n(59772),p=n(21867),d=n(86066),x=n(45023),h=n(90201),v=n(71515),m=n(33675),C=n(64341),N=n(90129),g=n(55060),f=g.Utils.getSharkValue,b={get couponValidity(){return f("couponValidity")},get couponDetails(){return f("couponDetails")},get couponRules(){return f("couponRules")},get haveNoUseableCouponTips(){return f("haveNoUseableCouponTips")},get dontUseCoupon(){return f("dontUseCoupon")},get reachBottom(){return f("reachBottom")},get haveNoUnUseableCouponTips(){return f("haveNoUnUseableCouponTips")},get canUseCoupon(){return f("canUseCoupon")},get cannotUseCoupon(){return f("cannotUseCoupon")},get cashback(){return f("cashback")},get immediatelyReduce(){return f("immediatelyReduce")}},j=n(74629),w=n(2269),T=function(e){var o=e.disabled,n=e.coupon,s=e.selectedCoupon,i=e.onTapCheckCoupon,c=(0,h.useState)(!1),a=(0,N.Z)(c,2),l=a[0],u=a[1],r=(0,h.useCallback)((function(e){e.stopPropagation(),u(!l)}),[l]);return(0,w.jsxs)(v.View,{className:(0,t.classnames)("coupon-box",l||o?"coupon-active":"",o?"coupon-disabled":""),onClick:function(){i(n)},"data-testid":j.UITestID.car_testid_page_coupon_box,children:[(0,w.jsxs)(v.View,{className:"coupon-box-inner",children:[(0,w.jsxs)(v.View,{className:"coupon-side",children:[(0,w.jsxs)(v.Text,{className:"coupon-price",children:[(null===n||void 0===n?void 0:n.deductionPercent)||(null===n||void 0===n?void 0:n.deductionAmount),(0,w.jsx)(v.Text,{className:"coupon-price-unit",children:null===n||void 0===n?void 0:n.unitName})]}),(0,w.jsx)(v.Text,{className:"coupon-price-text",children:1===(null===n||void 0===n?void 0:n.payofftype)?b.cashback:b.immediatelyReduce})]}),(0,w.jsxs)(v.View,{className:"coupon-main",children:[(0,w.jsxs)(v.View,{className:"coupon-info",children:[(0,w.jsx)(v.Text,{className:"coupon-name line2",children:null===n||void 0===n?void 0:n.couponName}),(null===n||void 0===n?void 0:n.description)&&(0,w.jsx)(v.Text,{className:"coupon-text line2",children:null===n||void 0===n?void 0:n.description}),(0,w.jsxs)(v.Text,{className:"coupon-date",children:[b.couponValidity,null===n||void 0===n?void 0:n.expiredDate]})]}),(0,w.jsxs)(v.View,{className:"coupon-detail-link",onClick:r,"data-testid":j.UITestID.car_testid_page_coupon_detail,children:[(0,w.jsx)(v.Text,{className:"coupon-link-text",children:b.couponDetails}),(0,w.jsx)(v.Text,{className:(0,t.classnames)("icon-drop-down",l?"active":"")})]})]}),!o&&(0,w.jsx)(v.View,{className:"coupon-check",children:(0,w.jsx)(v.View,{className:(0,t.classnames)(s&&(null===s||void 0===s?void 0:s.code)===(null===n||void 0===n?void 0:n.code)?"icon-selected":"icon-un-selected")})})]}),l&&(0,w.jsxs)(v.View,{className:"coupon-rules",children:[(0,w.jsxs)(v.View,{className:"rules-item",children:[(0,w.jsxs)(v.Text,{className:"rules-title",children:[b.couponRules,": "]}),(0,w.jsx)(v.Text,{className:"rules-text",children:null===n||void 0===n?void 0:n.couponDesc})]}),(0,w.jsxs)(v.View,{className:"rules-item",children:[(0,w.jsxs)(v.Text,{className:"rules-title",children:[b.couponValidity,": "]}),(0,w.jsx)(v.Text,{className:"rules-text",children:null===n||void 0===n?void 0:n.expiredDate})]})]}),o&&(0,w.jsx)(v.View,{className:"coupon-disabled-text",children:(0,w.jsx)(v.Text,{children:null===n||void 0===n?void 0:n.extDesc})})]})},V=T,k=function(e){var o=e.text;return(0,w.jsxs)(v.View,{className:"empty-box",children:[(0,w.jsx)(v.View,{className:"empty-lottie"}),(0,w.jsx)(v.View,{className:"empty-text",children:o})]})},U=k,D=function(){return(0,w.jsx)(v.View,{className:"coupon-footer",children:b.reachBottom})},y=D,Z=n(96103),_=function(e){(0,p.Z)(n,e);var o=(0,d.Z)(n);function n(e){var s;return(0,c.Z)(this,n),s=o.call(this,e),(0,x.Z)((0,l.Z)(s),"options",void 0),(0,x.Z)((0,l.Z)(s),"isLoginPending",!1),(0,x.Z)((0,l.Z)(s),"onChangeTab",(function(e){s.setState({activeTab:e.target.dataset.value})})),(0,x.Z)((0,l.Z)(s),"onTapCheckCoupon",(function(e){s.props.selectDontUseCoupon(!1),s.props.changeCoupon(e),m.cwx.navigateBack()})),(0,x.Z)((0,l.Z)(s),"onTapNoCheckCoupon",(function(){s.props.selectDontUseCoupon(!0),s.props.changeCoupon(),m.cwx.navigateBack()})),s.state={activeTab:0,selectedDontUse:!1},s.checkPerformance=!0,s}return(0,a.Z)(n,[{key:"getPageId",value:function(){return this.pageId=g.Channel.getPageId().COUPON.ID,this.pageId}},{key:"componentWillUnmount",value:function(){var e=this;(0,u.Z)((0,r.Z)(n.prototype),"componentWillUnmount",this).call(this),Z.po.afterNavigateBack((function(o){e.props.backToBooking(o)}))}},{key:"componentDidHide",value:function(){(0,u.Z)((0,r.Z)(n.prototype),"componentDidHide",this).call(this)}},{key:"render",value:function(){var e,o,n=this,s=this.props,i=s.usableCoupons,c=s.couponList,a=s.unusableCoupons,l=s.selectedCoupon;return(0,w.jsxs)(v.View,{className:"coupon-wrap",children:[(0,w.jsxs)(v.View,{className:"coupon-tabs",children:[(0,w.jsxs)(v.View,{onClick:this.onChangeTab,"data-value":0,className:(0,t.classnames)("coupon-tab",0===this.state.activeTab?"active":""),children:[b.canUseCoupon,"(",null===i||void 0===i?void 0:i.length,")"]}),(0,w.jsxs)(v.View,{onClick:this.onChangeTab,"data-value":1,className:(0,t.classnames)("coupon-tab",1===this.state.activeTab?"active":""),"data-testid":j.UITestID.car_testid_page_coupon_tab_unable,children:[b.cannotUseCoupon,"(",null===a||void 0===a?void 0:a.length,")"]})]}),this.state.activeTab?(0,w.jsx)(v.View,{className:"coupon-content",children:(0,w.jsxs)(v.ScrollView,{scrollY:!0,className:"coupon-scroll",children:[!(null!==a&&void 0!==a&&a.length)&&(0,w.jsx)(U,{text:b.haveNoUnUseableCouponTips}),!(null===a||void 0===a||!a.length)&&(0,w.jsxs)(v.View,{className:"coupon-list",children:[null===a||void 0===a?void 0:a.map((function(e){return(0,w.jsx)(V,{onTapCheckCoupon:g.Utils.noop,coupon:e,disabled:!e.isEnabled})})),(0,w.jsx)(y,{})]})]})}):(0,w.jsx)(v.View,{className:"coupon-content",children:(0,w.jsxs)(v.ScrollView,{scrollY:!0,className:"coupon-scroll",children:[(null===c||void 0===c||null===(e=c.notices)||void 0===e?void 0:e[0])&&(0,w.jsx)(v.View,{className:"coupon-tip",children:(0,w.jsx)(v.Text,{className:"coupon-tip-text",children:null===c||void 0===c||null===(o=c.notices)||void 0===o?void 0:o[0]})}),!(null!==i&&void 0!==i&&i.length)&&(0,w.jsx)(U,{text:b.haveNoUseableCouponTips}),!(null===i||void 0===i||!i.length)&&(0,w.jsxs)(v.View,{className:"coupon-list",children:[null===i||void 0===i?void 0:i.map((function(e){return(0,w.jsx)(V,{coupon:e,selectedCoupon:l,disabled:!e.isEnabled,onTapCheckCoupon:n.onTapCheckCoupon})})),(0,w.jsx)(v.View,{onClick:this.onTapNoCheckCoupon,className:"coupon-box","data-testid":j.UITestID.car_testid_page_coupon_dont_use,children:(0,w.jsxs)(v.View,{className:"coupon-box-inner",children:[(0,w.jsx)(v.View,{className:"coupon-main",children:(0,w.jsx)(v.View,{className:"coupon-name line2",children:b.dontUseCoupon})}),(0,w.jsx)(v.View,{className:"coupon-check",children:(0,w.jsx)(v.View,{className:(0,t.classnames)(this.props.IsSelectedDontUseCoupon?"icon-selected":"icon-un-selected")})})]})}),(0,w.jsx)(y,{})]})]})}),(0,w.jsx)(v.View,{className:"view-check",onAnimationEnd:function(){return n.viewReadyHandle&&n.viewReadyHandle()}})]})}}]),n}(C.Z),B=_,I=n(62813),P=n(34719),q=n(55418),S=n(58419),L=n(22189),R=n(27110),E=n(6017),O=function(e){var o=(0,I.KP)(e),n=o.couponList,s=(null===n||void 0===n?void 0:n.usableCoupons)||[],i=(null===n||void 0===n?void 0:n.unusableCoupons)||[];return{couponList:n,usableCoupons:s,unusableCoupons:i,selectedCoupon:(0,I._D)(e),IsSelectedDontUseCoupon:(0,I.C8)(e)}},G=function(e){var o=(0,P.KP)(e),n=o.couponList,s=(null===n||void 0===n?void 0:n.usableCoupons)||[],i=(null===n||void 0===n?void 0:n.unusableCoupons)||[];return{couponList:n,usableCoupons:s,unusableCoupons:i,selectedCoupon:(0,q._D)(e),IsSelectedDontUseCoupon:(0,q.C8)(e)}},H=function(e){return{queryPriceInfo:function(){return e((0,S.B2)())},changeCoupon:function(o){e((0,S.ex)(o)),e((0,S.B2)())},backToBooking:function(o){e((0,S.EL)(o)),e((0,S.BG)(!0))},selectDontUseCoupon:function(o){e((0,S.zE)(o))}}},z=function(e){return{queryPriceInfo:function(){return e((0,L.B2)())},changeCoupon:function(o){e((0,R.ex)(o)),e((0,L.B2)())},backToBooking:function(o){e((0,R.EL)(o)),e((0,L.BG)(!0))},selectDontUseCoupon:function(o){e((0,R.zE)(o))}}},A=g.Utils.isCtripOsd()?(0,t.connect)(G,z)(B):(0,t.connect)(O,H)(B),K=(0,E.Z)(A),W=function(e){return(0,w.jsx)(K,(0,i.Z)({},e))},Y=W,F={navigationBarTitleText:"\u4f18\u60e0\u5238",navigationBarTextStyle:"black",navigationBarBackgroundColor:"#ffffff"};Page((0,s.createPageConfig)(Y,"pages/carNew/isd/subPages/coupon/index",{root:{cn:[]}},F||{}))},79181:function(e){e.exports=require("../../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../../cwx/ext/global")},33675:function(e){e.exports=require("../../../../../cwx/cwx")},44353:function(e){e.exports=require("../../../../../cwx/cwx.js")},46346:function(e){e.exports=require("../../../../../cwx/ext/global")}},function(e){var o=function(o){return e(e.s=o)};e.O(0,[7606,2107,1216,8592],(function(){return o(4187)}));e.O()}]);
//# sourceMappingURL=index.js.map