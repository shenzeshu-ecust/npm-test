"use strict";require("../../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[7724],{86328:function(e,t,o){var n=o(39328);t["Z"]=n.Z},16214:function(e,t,o){o.d(t,{Z:function(){return h}});var n=o(71515),i={m_breathe_list_row_container:"style-module_hejfG",m_element_breathe:"style-module_BngRq"},a=o(31137),r=o(2269),s=function(e){var t=e.config,o=e.space;return(0,r.jsx)(n.View,{children:(0,r.jsx)(n.View,{style:{marginBottom:o},children:(0,r.jsx)(n.View,{className:(0,a.AK)(i.m_breathe_list_row_container),children:(0,r.jsx)(n.View,{className:(0,a.AK)(i.m_element_breathe,i.breat_loading),style:{width:t.width||"100%",height:t.height||14,background:t.background,backgroundColor:t.background||"#f5f5fa"}})})})})},l=s,u={m_ticket_info_breathe:"style-module_EzE6A",m_breathe_space:"style-module_nfsPW",m_pad_8:"style-module_c4ffE"},c=o(90201),d=o(93713),m=function(){var e="#eff5ff",t={width:"74%",height:19,background:e},o={width:"100%",height:16,background:e},n=[o,t,t],i=[12,12,22];return(0,r.jsx)(r.Fragment,{children:n.map((function(e,t){return(0,r.jsx)(l,{config:e,space:i[t]},t)}))})},_=function(){var e="#eff5ff",t={width:"100%",height:37,background:e};return(0,r.jsxs)(n.View,{children:[(0,r.jsxs)(n.View,{className:(0,a.AK)(u.m_ticket_info_breathe),style:{height:d.k},children:[(0,r.jsx)(l,{config:t,space:12}),(0,r.jsx)(n.View,{className:(0,a.AK)(u.m_pad_8),children:(0,r.jsx)(m,{})}),(0,r.jsx)(l,{config:t,space:12}),(0,r.jsxs)(n.View,{className:(0,a.AK)(u.m_pad_8),children:[(0,r.jsx)(m,{}),(0,r.jsx)(m,{})]})]}),(0,r.jsx)(n.View,{className:(0,a.AK)(u.m_breathe_space)})]})},h=(0,c.memo)(_,(function(){return!0}))},18855:function(e,t,o){o.d(t,{Z:function(){return c}});o(90201);var n=o(31137),i=o(71515),a=o(63362),r={no_result_container:"style-module_VICK9",no_result_img:"style-module_EhaOL",no_result_desc:"style-module_AYawJ",m_no_subtext:"style-module_r8X6w",m_btn_wrap:"style-module_zowq1",m_btn_text:"style-module_FNgyq"},s=o(30194),l=o(2269),u=function(e){var t=e.text,o=void 0===t?"":t,u=e.subText,c=void 0===u?"":u,d=e.backBtnText,m=void 0===d?"":d,_=e.errPageLog,h=void 0===_?{}:_;return(0,l.jsxs)(i.View,{className:(0,n.AK)(r.no_result_container),children:[(0,l.jsx)(n.Y,{src:"https://pic.c-ctrip.com/platform/h5/component/empty-state/empty-result.png_.webp",className:(0,n.AK)(r.no_result_img)}),!!o&&(0,l.jsx)(i.Text,{className:(0,n.AK)(r.no_result_desc),children:o}),!!c&&(0,l.jsx)(i.Text,{className:(0,n.AK)(r.m_no_subtext),children:c}),!!m&&(0,l.jsx)(n.En,{className:(0,n.AK)(r.m_btn_wrap),onClick:function(){(0,s.Vg)(h.backBtnDevTraceLog),a.ZP.navigateBack()},children:(0,l.jsx)(i.Text,{className:(0,n.AK)(r.m_btn_text),children:m})})]})},c=u},49718:function(e,t,o){o.d(t,{Z:function(){return v}});var n=o(298),i=o(68277),a=o(50358),r=a.Z,s=o(71515),l=o(31137),u={m_footer_long:"style-module_q8J5b",m_footer_btn_wrapper:"style-module_BwlSq",m_footer_btn:"style-module_qddRA",m_footer_btn_text:"style-module_R_QmQ",m_font_18:"style-module_MwyrA",m_font_gray:"style-module_Euq_V",m_footer_tag_hold:"style-module_T1lFf"},c=o(63574),d=o(2269),m=["showBigBtn","footer","bigBtnClickLog","showSku","setRefs"],_={linearGradientStart:{x:0,y:0},linearGradientEnd:{x:1,y:0},linearGradientColor:["rgba(255, 165, 10, 1)","rgba(255, 119, 0,1)"]},h={linearGradientColor:["rgba(221,221,221, 1)","rgba(221,221,221, 1)"]},p=function(e){var t=e.bigBtnClickLog,o=e.footer,n=e.showBigBtn,i=e.btnClickLog,a=e.booking,r=e.onTabClick,m=e.optid,p=(e.btnTraceData,e.showSku),f=o.isGrayBtn;return(0,d.jsx)(l.En,{log:n?t:i&&i({resourceid:m?m.join(","):""}),className:(0,l.AK)(u.m_footer_btn_wrapper),activeOpacity:f?1:.8,onClick:n?function(){return r(0,1)}:f?null:function(){return a(!1)},children:(0,d.jsx)(l.cn,{start:_.linearGradientStart,end:_.linearGradientEnd,colors:!f||n?_.linearGradientColor:h.linearGradientColor,className:(0,l.AK)(u.m_footer_btn),"hover-class":"none",plain:!0,children:n?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.Text,{className:(0,l.AK)(u.m_footer_btn_text,u.m_font_18),style:c.Z,children:"\u9884\u8ba2\u9009\u62e9"}),(0,d.jsx)(l.Y,{src:"https://dimg04.c-ctrip.com/images/1o53412000bxkad1k58A0.png",style:{width:16,height:16,marginTop:l.hj.isIOS()?0:1.5}})]}):(0,d.jsx)(s.Text,{className:(0,l.AK)(u.m_footer_btn_text,f?u.m_font_gray:""),style:c.Z,children:p?"\u4e0b\u4e00\u6b65":"\u53bb\u9884\u8ba2"})})})},f=function(e){e.showBigBtn;var t,o=e.footer,a=(e.bigBtnClickLog,e.showSku),c=e.setRefs,_=(0,i.Z)(e,m);return(0,d.jsxs)(s.View,{onLayout:e.onLayout,className:"ticket_detail_footer_wrap",ref:function(e){c("footer",e)},children:[!a&&null!==o&&void 0!==o&&null!==(t=o.showTags)&&void 0!==t&&t.length?(0,d.jsx)(s.View,{className:(0,l.AK)(u.m_footer_tag_hold),style:{height:39}}):null,(0,d.jsx)(r,(0,n.Z)((0,n.Z)((0,n.Z)({},_),o),{},{renderPayBtn:function(){return p(e)},fstyle:{m_footer_long:{paddingBottom:22}}}))]})},v=f},30436:function(e,t,o){o.d(t,{Z:function(){return f}});var n=o(298),i=o(71515),a=o(31137),r={m_back_content:"style-module_GCXSW",m_back_title:"style-module_Hgszi",m_back_label:"style-module_bQ6b_",m_lable_image:"style-module_O2oxh",m_back_label_wrapper:"style-module_r2TSX",m_back_label_text:"style-module_aB7hk",m_back_label_wrapper_container:"style-module_Mw2gK",vs_title:"style-module_XKNRB",price_wrap:"style-module_RPJiO",price:"style-module_kzBCs",price_total:"style-module_IdV9q",price_pre:"style-module_GNWVU",price_text:"style-module_fcSJA",price_sub:"style-module_jEEPQ",price_market:"style-module_nbqGg",price_market_android:"style-module_i6Ofq",sale:"style-module_UVRW5",deduct_desc:"style-module_sTNMz",deduct_desc_android:"style-module_gHBXD",deduct_desc_text:"style-module_FTaAv",deduct_desc_text_android:"style-module_YubPs"},s=o(63574),l=o(66023),u=o(90129),c=o(90201),d=function(e){var t=e.priceInfo,o=(0,c.useState)(!1),n=(0,u.Z)(o,2),i=n[0],a=n[1],r=(null===t||void 0===t?void 0:t.footPop)||{},s=r.title,l={name:"paymentPopLayer",title:s,hideIphoneXAdapter:!1,crnModalProps:{coverStatusBar:!0},zIndex:99,style:{maxHeight:"100%"},headerStyles:{m_poplayer_title:{color:"#111"},closeColor:"#555",closeIcon:"xclosed"},showCloseButton:!0},d=(0,c.useCallback)((function(){null!==t&&void 0!==t&&t.deductDesc&&a(!0)}),[]),m=(0,c.useCallback)((function(){a(!1)}),[]);return{onClickPromotions:d,promotionsVisible:i,onClosePromotions:m,poplayerProps:l}},m=d,_=o(91278),h=o(2269),p=function(e){var t=e.onLayout,o=e.title,u=e.recommendInfo,c=e.setRefs,d=e.saleCountDesc,p=e.priceInfo,f=(null===p||void 0===p?void 0:p.footPop)||{},v=f.content,g=(f.totleContent,f.priceTipList),y=m(e),k=y.onClickPromotions,x=y.promotionsVisible,b=y.onClosePromotions,w=y.poplayerProps;return(0,h.jsxs)(i.View,{className:(0,a.AK)(r.m_back_content),onLayout:t,ref:function(e){return c&&c("head",e)},children:[p?(0,h.jsxs)(i.View,{className:(0,a.AK)(r.price_wrap),children:[(0,h.jsxs)(a.En,{className:(0,a.AK)(r.price),onClick:k,children:[(0,h.jsxs)(i.View,{className:(0,a.AK)(r.price_total),children:[(0,h.jsx)(a.X_,{className:(0,a.AK)(r.price_pre),style:s.Z,children:"\xa5"}),(0,h.jsx)(a.X_,{className:(0,a.AK)(r.price_text),style:s.Z,children:p.total}),(0,h.jsx)(a.X_,{className:(0,a.AK)(r.price_sub),children:p.subPriceDes})]}),p.marketPrice&&p.deductDesc?(0,h.jsxs)(a.X_,{className:(0,a.AK)(r.price_market,a.hj.isIOS()?"":r.price_market_android),children:["\xa5",p.marketPrice]}):null,p.deductDesc?(0,h.jsxs)(a.En,{className:(0,a.AK)(r.deduct_desc,a.hj.isIOS()?"":r.deduct_desc_android),children:[(0,h.jsx)(a.X_,{className:(0,a.AK)(r.deduct_desc_text,a.hj.isIOS()?"":r.deduct_desc_text_android),style:s.Z,children:p.deductDesc}),(0,h.jsx)(l.m,{type:"help",style:{fontSize:10,color:"#FF5500"},className:"help_icon"})]}):null]}),(0,h.jsx)(a.X_,{className:(0,a.AK)(r.sale),children:d})]}):null,(0,h.jsx)(a.X_,{className:(0,a.AK)(r.m_back_title),style:s.Z,children:o}),!!u&&(0,h.jsx)(i.View,{className:(0,a.AK)(r.m_back_label),children:(0,h.jsxs)(i.View,{className:(0,a.AK)(r.m_back_label_wrapper,r.m_back_label_wrapper_container),children:[(0,h.jsx)(a.Y,{src:"https://dimg04.c-ctrip.com/images/1o54n12000cgjq5v86128.png",className:(0,a.AK)(r.vs_title),style:{}}),(0,h.jsx)(a.X_,{className:(0,a.AK)(r.m_back_label_text),numberOfLines:1,style:s.Z,children:u})]})}),(0,h.jsxs)(a.H5,(0,n.Z)((0,n.Z)({visible:x},w),{},{onClose:b,children:[(0,h.jsx)(_["default"],{content:v,priceTipList:g}),a.GI.getPlatform()===a.GI.PLATFORM_TYPE.Mini?(0,h.jsx)(i.View,{style:{height:90,width:"100%"}}):null]}))]})},f=p},66023:function(e,t,o){o.d(t,{m:function(){return l}});var n=o(298),i=o(31137),a=o(2269),r={dArrowDown:"&#xf37e;",xclosed:"&#xe004;",arrowup:"&#xe32b;",arrowdown:"&#xe32c;",copyLine:"&#xf15b;",share:"&#xe020;",help:"&#xe931;",muted:"&#xed9a;",unMuted:"&#xeda3;",back:"&#xe28b;",comment:"&#xf14a2;",arrowright:"&#xe008;",locate:"&#xe00a;"},s=function(e){if("string"!=typeof e)return e;var t=e.replace(/&#x([0-9a-fA-F]+);/g,(function(e,t){return String.fromCodePoint(parseInt(t,16))}));return t},l=function(e){var t={},o=e.size,l=e.color;return o&&(t.fontSize=o),l&&(t.color=l),(0,a.jsx)(i.rD,(0,n.Z)((0,n.Z)({fontFamily:"crn_font_ticket_detail"},e),{},{style:(0,n.Z)((0,n.Z)({},(null===e||void 0===e?void 0:e.style)||{}),t),children:s(r[e.type])}))}},45137:function(e,t,o){o.d(t,{Z:function(){return I}});var n=o(90201),i=o(31137),a=o(66023),r=o(71515),s={m_nav_wrap:"style-module_Q5cWj",m_nav_left:"style-module_S0aEJ",m_nav_center:"style-module_ca6rR",m_nav_center_text:"style-module_hufuL",m_nav_right:"style-module_YaQaa",mini_iconwrap:"style-module_cxkfU",m_nav_right_share_icon:"style-module_UOZk9",center_wrap:"style-module_ziY_r"},l=o(90129),u=o(9641),c=o(25158),d=function(e,t){var o=(0,n.useRef)(null),a=(0,n.useRef)(null),r=(0,n.useRef)(null),s=(0,n.useState)(80),d=(0,l.Z)(s,2),m=d[0],_=d[1],h=(0,n.useState)(!1),p=(0,l.Z)(h,2),f=p[0],v=p[1],g=(0,n.useState)(!1),y=(0,l.Z)(g,2),k=y[0],x=y[1];(0,n.useImperativeHandle)(t,(function(){return{onScroll:function(t){console.log(">>>>>>>>>>>>sholdUseDarkMode",k);var n=Math.max(0,Math.min(t/(e.headHeight||120),1));o.current&&((0,u.N)(o.current,{backgroundColor:"rgba(255,255,255,".concat(n,")")}),(0,u.N)(a.current,{opacity:i.hj.isIOS()?Math.min((t-20)/((e.headHeight||120)-20),1):n})),n>.5&&!k?x(!0):n<=.5&&k&&x(!1)}}}));var b=function(t){var o,n=null===t||void 0===t||null===(o=t.nativeEvent)||void 0===o?void 0:o.layout,i=n.height;_(i),v(!0),e.onLayout&&e.onLayout(t)},w=(0,c.Z)((function(t){e.onChangeMuted&&e.onChangeMuted(t)})),Z=function(e){e&&i.ft.share(e)};return{navH:m,navRef:o,titRef:a,hvRef:r,onLayout:b,onShare:Z,isLayout:f,sholdUseDarkMode:k,onChangeMuted:w}},m=d,_=o(7249),h=function(e){},p=o(63574),f=o(92954),v=o.n(f),g=o(30194),y=o(6148),k=o(34134),x={iconwrap:"style-module_vTDKk"},b=o(2269),w=function(e){var t=e.color,o=void 0===t?"#333":t,r=e.onChangeMuted,s=e.className,u=e.isMuted,d=void 0===u||u,m=e.show,_=void 0===m||m,h=(0,n.useState)(d),p=(0,l.Z)(h,2),f=p[0],v=p[1],g=(0,c.Z)((function(){v(!f),r&&r(!f)}));return(0,n.useEffect)((function(){d!==f&&v(d)}),[d]),_?(0,b.jsx)(i.En,{className:(0,i.AK)(x.iconwrap,s),onClick:g,children:(0,b.jsx)(a.m,{type:f?"muted":"unMuted",size:24,color:o})}):null},Z=w,T=(0,n.forwardRef)((function(e,t){var o=m(e,t),l=o.navH,u=o.navRef,c=o.titRef,d=o.hvRef,f=o.onLayout,x=o.onShare,w=o.isLayout,T=o.sholdUseDarkMode,I=o.onChangeMuted,P=e.logs,j=P.closeClickLog,S=P.headerLeftDevtraceLog,L=P.shareExposureLog,R=P.shareClickLog,C=P.moreClickLog,N=P.moreExpoLog,E=e.startTime,M=e.color,A=e.shareInfo,D=e.mediaInfo,V=e.showSound,G=e.isMuted,F=e.request,B=!(null===D||void 0===D||!D.videoUrl),K=0;B&&V&&(K+=1),A&&0!=Object.keys(A).length&&i.GI.getPlatform()===i.GI.PLATFORM_TYPE.CRN&&(K+=1);var H="delivery"==(null===F||void 0===F?void 0:F.scene)&&i.hj.isApp();H&&(K+=1);var O=function(){return(0,b.jsx)(i.En,{onClick:function(){(0,g.Vg)(S),e.onClose()},log:j&&j({type:"button",duration:((new Date).getTime()-E)/1e3}),className:(0,i.AK)(s.m_nav_left),children:(0,b.jsx)(a.m,{type:"back",size:24,color:T||!D?"#333":"#fff"})})},Y=function(){return(0,b.jsxs)(r.View,{className:s.m_nav_right,children:[(0,b.jsx)(Z,{color:T?"#333":"#fff",onChangeMuted:I,show:V&&B,isMuted:G}),A&&0!=Object.keys(A).length&&i.GI.getPlatform()===i.GI.PLATFORM_TYPE.CRN?(0,b.jsx)(i.En,{onClick:function(){(0,g.Vg)(S),x(A)},log:R,testID:L,className:(0,i.AK)(s.m_nav_right_share_icon),children:(0,b.jsx)(a.m,{type:"share",size:24,color:T?"#333":"#fff"})}):null,H?(0,b.jsx)(i.En,{className:s.m_nav_right_config_icon,log:C,testID:N,children:(0,b.jsx)(k.Z,{styleType:T?1:3,size:44})}):null]})},q=(0,_.D)((function(){h("dark-content")}),100);(0,n.useEffect)((function(){var e;i.GI.getPlatform()==i.GI.PLATFORM_TYPE.CRN&&(null===d||void 0===d||null===(e=d.current)||void 0===e||e.setRenderLeftView(O),q())}),[M,A,T,V,G,K]),(0,n.useEffect)((function(){i.GI.getPlatform()!==i.GI.PLATFORM_TYPE.CRN&&setTimeout((function(){i.c0.getBoundingClientRect({node:u.current}).then((function(e){if(e){var t={nativeEvent:{layout:{height:e.height}}};f(t)}}))}),i.hj.isBaidu()?100:0)}),[u]);var U=i.GI.getPlatform()===i.GI.PLATFORM_TYPE.Mini;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(r.View,{ref:function(e){return u.current=e},className:(0,i.AK)(s.m_nav_wrap),onLayout:f,children:[i.ua.isMini()?(0,b.jsx)(Z,{color:"#fff",onChangeMuted:I,show:V&&B,isMuted:G,className:s.mini_iconwrap}):null,(0,b.jsx)(i.sR,{backgroundColor:"transparent",ref:function(e){return d.current=e},renderLeftView:O,renderCenterView:function(){return(0,b.jsxs)(r.View,{className:(0,i.AK)(s.center_wrap),children:[(0,b.jsx)(r.View,{ref:function(e){return c.current=e},className:(0,i.AK)(s.m_nav_center),style:{width:v().getSystemInfoSync().windowWidth-(K>=2?40*K+42:82)},children:(0,b.jsx)(i.X_,{numberOfLines:1,className:(0,i.AK)(s.m_nav_center_text),style:p.Z,children:e.title})}),Y()]})},rightViewWidth:K>=2?40*K:40,statusBarProps:{translucent:!0,barStyle:"dark-content",backgroundColor:"transparent"},relativeCenter:!0})]}),(0,b.jsx)(r.View,{style:{paddingTop:U?0:w?l:i.hj.isIOS()?(0,y.m)(42):(0,y.m)(88),display:D?"none":"flex"},children:w||U?null:(0,b.jsx)(i.iY.Top,{})})]})})),I=T},93713:function(e,t,o){o.d(t,{k:function(){return c}});var n=o(90129),i=o(90201),a=o(7249),r=o(31137),s=o(92954),l=o.n(s),u=o(30194),c=417,d=l().getSystemInfoSync().windowHeight,m=function(e){var t=e.ticketInfomation,o=e.renderFullScreen,s=e.onShortLayout,l=t||{},m=l.groups,_=void 0===m?[]:m,h=l.eleCount,p=(0,i.useState)(2),f=(0,n.Z)(p,2),v=f[0],g=f[1],y=(0,i.useState)(!1),k=(0,n.Z)(y,2),x=k[0],b=k[1],w=(0,i.useState)(!1),Z=(0,n.Z)(w,2),T=Z[0],I=Z[1],P=(0,i.useState)(!1),j=(0,n.Z)(P,2),S=j[0],L=j[1],R=(0,i.useState)(_),C=(0,n.Z)(R,2),N=C[0],E=C[1],M=(0,i.useRef)(null),A=(0,i.useRef)(null),D=function(){var t=e.logs,o=void 0===t?{}:t,n=o.operaterDevTraceLog;n&&(0,u.Vg)(n(S?"\u6536\u8d77\u5168\u90e8":"\u5c55\u5f00\u5168\u90e8")),v<=2&&g(h),L(!S)},V=(0,a.D)((function(e){I(!0),e<c&&(v<h?g(h):(b(!0),g(h),s&&s()))}),50),G=function(e){var t,o=null===e||void 0===e||null===(t=e.nativeEvent)||void 0===t?void 0:t.layout,n=o.height;V(n)};return(0,i.useEffect)((function(){e.onToggleExpand(M.current,S)}),[S]),(0,i.useEffect)((function(){E(_)}),[_.length]),(0,i.useEffect)((function(){o&&setTimeout((function(){D()}),500)}),[]),(0,i.useEffect)((function(){r.GI.getPlatform()!==r.GI.PLATFORM_TYPE.CRN&&setTimeout((function(){r.c0.getBoundingClientRect({node:A.current}).then((function(e){e?V(e.height):r.hj.isBaidu()&&setTimeout((function(){r.c0.getBoundingClientRect({node:A.current}).then((function(e){console.log("\u767e\u5ea6\u5c0f\u7a0b\u5e8f\u6ca1\u62ff\u5230\u518d\u62ff\u4e00\u6b21=========",e),e&&V(e.height)}))}),500)}))}),r.hj.isBaidu()?200:0)}),[A]),{renderCount:v,handleClick:D,onLayout:G,maxHeight:o?d:c,renderFullScreen:o,isShort:x,isShowAllInfo:S,hasLayout:T,ticketGroups:N,operaterRef:M,ticketCardRef:A}};t["Z"]=m},86317:function(e,t,o){o.d(t,{Z:function(){return K}});var n=o(93713),i=o(90201),a=o(66023),r=o(71515),s=o(31137),l={m_ticket_detail_margin:"style-module_yj3Uh",m_detail_wrapper:"style-module_RjlAz",m_show_all:"style-module_m4h4D",m_show_all_text:"style-module_IYFgp",m_linear_gradient:"style-module_WczWg",m_ticket_detail_info:"style-module_ujIuL",m_ticket_detail_operate:"style-module_bm8Tc",m_padding_bottom_16:"style-module_hz32Q"},u={m_ticket_detail_info_padding:"style-module_RIQbm",m_ticket_group_info:"style-module_ZmbSg",m_ticket_group_title:"style-module_P35Kv",m_ticket_group_name:"style-module_jBbqi",m_ticket_group_name_highlights:"style-module_tfACU",m_ticket_group_icon:"style-module_eOSie",m_ticket_element_name:"style-module_xf2bR",m_ticket_element_name_icon:"style-module_Nc2kG",m_ticket_element_name_font:"style-module_txVFe",m_ticket_group_info_bottom_line:"style-module_sU1wp",m_ticket_group_info_bottom_space:"style-module_E2rNH"},c={m_ticket_element_modules:"style-module_rvd9U",m_ticket_element_module_name_value:"style-module_OAqcp",m_ticket_element_contents:"style-module_SA0Pv",m_ticket_element_contents_name:"style-module_bIYQV",m_ticket_element_contents_val:"style-module_zYMnn",m_ticket_element_contents_text:"style-module_MChJd",img:"style-module_Wa_Sy"},d=o(57042),m=o(24460),_=o(21867),h=o(86066),p={tip_text:"style-module_LB2iq",tip_text_copy:"style-module_K7r8S"},f=o(95360),v=o(92954),g=o.n(v),y=o(2269),k=s.GI.getPlatform()===s.GI.PLATFORM_TYPE.Mini?s.En:r.Text,x=function(e){(0,_.Z)(o,e);var t=(0,h.Z)(o);function o(){return(0,d.Z)(this,o),t.apply(this,arguments)}return(0,m.Z)(o,[{key:"fotmatData",value:function(e){var t=/((http|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:/~+#-]*[\w@?^=%&amp;/~+#-])?)/g,o=e.match(t)||[],n=[];return o.forEach((function(t,o){var i=e.indexOf(t);if(-1!==i){var a=e.slice(0,i);a&&n.push({text:a}),e=e.slice(i+t.length,e.length),n.push({text:t,isUrl:!0})}})),e&&n.push({text:e}),n}},{key:"render",value:function(){var e=this,t=this.props.tip,o=void 0===t?"":t,n=this.fotmatData(o);return(0,y.jsx)(r.View,{style:{fontSize:0},children:(0,y.jsx)(k,{className:"ticket-tip-copy-view",children:n.map((function(t,o){return t.isUrl?(0,y.jsxs)(k,{className:"ticket-tip-copy-view",onClick:function(){g().setClipboardData({data:t.text}),e.toast.show("\u590d\u5236\u6210\u529f")},children:[(0,y.jsx)(r.Text,{className:(0,s.AK)(p.tip_text_copy),onPress:function(){g().setClipboardData({data:t.text}),e.toast.show("\u590d\u5236\u6210\u529f")},children:t.text}),(0,y.jsx)(s.En,{style:{marginLeft:2,height:14},className:"ticket-tip-copy-btn",onClick:function(){g().setClipboardData({data:t.text}),e.toast.show("\u590d\u5236\u6210\u529f")},children:(0,y.jsx)(a.m,{type:"copyLine",size:14,color:"#006FF6"})})]},o):(0,y.jsx)(r.Text,{className:(0,s.AK)(p.tip_text),children:t.text},o)}))})})}}]),o}(f.ZP),b=o(63574),w=o(90129),Z=o(39860),T=function(e){return e},I="https://dimg04.c-ctrip.com/images/0AS05120009os3mi7318B.png_.webp",P=function(e){var t=e||{},o=t.desc,n=t.imageBorder,a=s.GI.getPlatform()==s.GI.PLATFORM_TYPE.CRN,r=(0,i.useState)(o),l=(0,w.Z)(r,2),u=l[0],c=l[1],d=(0,i.useCallback)((function(e){if(a){var t=e.detail||{},o=t.width,n=void 0===o?0:o,i=t.height,r=void 0===i?0:i,s=r/n,l=224*s;null!==u&&void 0!==u&&u.height&&c((function(e){var t=(0,Z.I8)(e);return t.height=l,t}))}}),[u]);return(0,y.jsx)(s.Y,{src:(null===u||void 0===u?void 0:u.desc)||I,style:Object.assign({width:T(224)},a&&null!==u&&void 0!==u&&u.height?{height:T(u.height)}:{},n,a?{}:{verticalAlign:"bottom"}),onLoad:function(e){return d(e)},mode:a?"":"widthFix"})},j=P,S=function(e){var t=e.ElementModules,o=function(e,t){var o;o=e.map((function(e){var t=e.desc.replace(/\.(jpg|png)/,"_Q90.$1"),o=t.split("?");return o.length&&(t=o[0]),{url:t,thumbnailURL:"",name:"",imageDescription:""}}));var n={showPhotoIndex:t,items:o,meta:{hideSaveImageButton:!0}};s.JO.show(n)};return(0,y.jsx)(y.Fragment,{children:null===t||void 0===t?void 0:t.map((function(e,t){var n;return(0,y.jsxs)(r.View,{className:(0,s.AK)(c.m_ticket_element_modules),children:[e.moduleName?(0,y.jsx)(r.View,{children:(0,y.jsx)(r.Text,{className:(0,s.AK)(c.m_ticket_element_module_name_value),style:b.Z,children:e.moduleName})}):null,null===e||void 0===e||null===(n=e.contents)||void 0===n?void 0:n.map((function(e,t){var n;return(0,y.jsxs)(r.View,{className:(0,s.AK)(c.m_ticket_element_contents),children:[(0,y.jsx)(r.Text,{className:(0,s.AK)(c.m_ticket_element_contents_name),children:e.contName}),(0,y.jsx)(r.View,{style:{display:"flex",flexDirection:"column"},children:null===e||void 0===e||null===(n=e.contVals)||void 0===n?void 0:n.map((function(e,t){var n;if(0==e.type)return(0,y.jsx)(r.View,{className:(0,s.AK)(c.m_ticket_element_contents_val),style:t?{paddingTop:4}:{},children:(0,y.jsx)(x,{tip:null===(n=e.descs)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.desc})},t);if(1==e.type){var i,a,l=null===e||void 0===e||null===(i=e.descs)||void 0===i?void 0:i.length;return(0,y.jsx)(r.View,{style:{paddingLeft:20,paddingTop:t?5:0},children:null===e||void 0===e||null===(a=e.descs)||void 0===a?void 0:a.map((function(e,t){var n=l>1?0==t?{borderTopLeftRadius:6,borderTopRightRadius:6}:t==l-1?{borderBottomRightRadius:6,borderBottomLeftRadius:6}:{}:{borderRadius:6,marginTop:3};return(0,y.jsx)(s.En,{activeOpacity:1,onClick:function(){return o([e],0)},children:(0,y.jsx)(j,{desc:e,imageBorder:n})})}))},t)}}))})]},t)}))]},t)}))})},L=S,R=o(298),C={detail_highlights_wrap:"style-module_CSypJ",detail_highlights_text:"style-module_nGFna"},N=o(6148),E=s.GI.getPlatform()==s.GI.PLATFORM_TYPE.Mini,M=function(e){var t=e.text,o=e.style,n=void 0===o?{}:o;return t?(0,y.jsx)(s.En,{className:(0,s.AK)(C.detail_highlights_wrap),style:E?(0,R.Z)((0,R.Z)({},n),{},{height:"auto",lineHeight:"".concat((0,N.m)(14),"px"),marginBottom:(0,N.m)(2)}):n,children:(0,y.jsx)(r.Text,{className:(0,s.AK)(C.detail_highlights_text),style:E?(0,R.Z)((0,R.Z)({},b.Z),{},{marginTop:0}):b.Z,children:t})}):null},A=M,D=o(30901),V=function(e){var t=e||{},o=t.groups,n=t.initEleCount,i=t.logs,a=o.length,l=0,c=i.groupTitleExposureLog,d=i.eleTitleExposureLog;return console.log("TicketCard-render"),(0,y.jsx)(y.Fragment,{children:null===o||void 0===o?void 0:o.map((function(e,t){var i,m,_,h,p,f;return t<=a?(0,y.jsxs)(r.View,{children:[e.groupName?(0,y.jsx)(s.cn,{start:{x:0,y:1},end:{x:0,y:0},colors:["rgba(245, 249, 255, 0.3) 50%","rgba(238, 245, 255, 0.65) 75.27%","rgb(238, 245, 255) 100%"],className:(0,s.AK)(u.m_ticket_group_info),children:(0,y.jsxs)(s.En,{className:(0,s.AK)(u.m_ticket_group_title),testID:c&&c({categorypos:t+1}),children:[!!e.groupIcon&&(0,y.jsx)(s.Y,{src:e.groupIcon,className:(0,s.AK)(u.m_ticket_group_icon)}),(0,y.jsxs)(r.View,{className:(0,s.AK)(u.m_ticket_group_name_highlights),children:[(0,y.jsx)(r.Text,{className:(0,s.AK)(u.m_ticket_group_name),style:(0,s.y0)(1==(null===e||void 0===e||null===(i=e.elements)||void 0===i?void 0:i.length)&&null!==e&&void 0!==e&&null!==(m=e.elements)&&void 0!==m&&null!==(m=m[0])&&void 0!==m&&m.highlights?{marginRight:6}:{},b.Z),children:e.groupName}),1==(null===e||void 0===e||null===(_=e.elements)||void 0===_?void 0:_.length)&&null!==e&&void 0!==e&&null!==(h=e.elements)&&void 0!==h&&null!==(h=h[0])&&void 0!==h&&h.highlights?(0,y.jsx)(A,{text:null===e||void 0===e||null===(p=e.elements)||void 0===p?void 0:p[0].highlights}):null]})]})}):null,(0,y.jsx)(r.View,{className:(0,s.AK)(u.m_ticket_detail_info_padding),children:null===e||void 0===e||null===(f=e.elements)||void 0===f?void 0:f.map((function(o,i){var c;return o.eleCount==n&&(a=t),l++,o.eleCount<=n?(0,y.jsxs)(r.View,{children:[o.elementName?(0,y.jsxs)(s.En,{className:(0,s.AK)(u.m_ticket_element_name),testID:d&&d({elementpos:l}),children:[(0,y.jsx)(r.View,{className:(0,s.AK)(u.m_ticket_element_name_icon)}),(0,y.jsx)(r.Text,{className:(0,s.AK)(u.m_ticket_element_name_font),style:(0,s.y0)(o.highlights?{marginRight:6}:{},b.Z),children:o.elementName}),(0,y.jsx)(A,{text:o.highlights})]}):null,(0,y.jsx)(L,{ElementModules:null===o||void 0===o?void 0:o.modules}),i<(null===e||void 0===e||null===(c=e.elements)||void 0===c?void 0:c.length)-1?(0,y.jsx)(r.View,{style:{paddingLeft:8},children:(0,y.jsx)(r.View,{className:(0,s.AK)(u.m_ticket_group_info_bottom_line),style:{borderBottomWidth:0,borderTopWidth:D.Z}})}):null]},i):null}))}),t<o.length-1?(0,y.jsx)(r.View,{className:(0,s.AK)(u.m_ticket_group_info_bottom_space)}):null]},t):null}))})},G=V,F={linearGradientStart:{x:0,y:0},linearGradientEnd:{x:0,y:1},linearGradientColor:["rgba(255, 255, 255, 0)","rgba(255, 255, 255, 1)"]},B=function(e){var t=(0,n.Z)(e),o=t.renderCount,u=t.handleClick,c=t.onLayout,d=t.maxHeight,m=t.isShort,_=t.isShowAllInfo,h=t.ticketGroups,p=t.renderFullScreen,f=t.operaterRef,v=t.hasLayout,g=t.ticketCardRef;console.log("ticketInfomation-render");var k=e.logs,x=void 0===k?{}:k,w=e.infoMinH,Z=e.lowPricePerception,T=e.ticketInfomation,I=void 0===T?{}:T,P=e.request,j=I.videoInfos,S=void 0===j?[]:j,L=x.operaterExposureLog,R=x.detailExposureLog,C=x.operaterClickLog,N=(0,i.useMemo)((function(){return(0,y.jsx)(G,{groups:h,logs:x,initEleCount:o})}),[o]),E=!m&&!p&&v,M=L?L({module_name:"detail"}):{};return(0,y.jsxs)(r.View,{children:[(0,y.jsxs)(s.En,{className:(0,s.AK)(l.m_detail_wrapper),style:_||m?{height:"auto"}:{height:d},testID:R,children:[(0,y.jsx)(r.View,{className:(0,s.AK)(l.m_ticket_detail_info,E?"":l.m_padding_bottom_16),style:(0,s.y0)(p?{minHeight:w,paddingTop:16}:{},S.length||Z?{paddingTop:10}:{},!P.showSku||S.length||Z?{}:{marginTop:16}),ref:function(e){g.current=e},onLayout:function(e){return c(e)},children:N}),E&&(0,y.jsxs)(s.En,{className:(0,s.AK)(l.m_ticket_detail_operate),style:{position:_?"relative":"absolute"},ref:function(e){return f.current=e},activeOpacity:1,onClick:u,log:C&&C({module_name:"detail",applyType:_?1:0}),children:[!_&&(0,y.jsx)(s.cn,{start:F.linearGradientStart,end:F.linearGradientEnd,colors:F.linearGradientColor,className:(0,s.AK)(l.m_linear_gradient),"hover-class":"none",plain:!0}),(0,y.jsxs)(s.En,{className:(0,s.AK)(l.m_show_all),testID:M,children:[(0,y.jsxs)(r.Text,{className:(0,s.AK)(l.m_show_all_text),style:b.Z,children:[_?"\u6536\u8d77":"\u5c55\u5f00","\u5168\u90e8"]}),(0,y.jsx)(a.m,{color:"#0066F6",type:_?"arrowup":"arrowdown",size:12})]})]})]}),!p&&(0,y.jsx)(r.View,{className:(0,s.AK)(l.m_ticket_detail_margin)})]})},K=B},86036:function(e,t,o){o.d(t,{Z:function(){return N}});var n=o(298),i=o(90201),a=o(71515),r=o(31137),s={poster_img:"style-module_xIoy6",m_back_content:"style-module_ItFD2",m_image_back:"style-module_NS2qA"},l=o(57042),u=o(24460),c=o(21867),d=o(86066),m=o(79301),_=o(95308),h=o(81876),p=o(45023),f=function(){var e=(0,_.Z)((0,m.Z)().mark((function e(){return(0,m.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){r.Y8.getNetworkType({success:function(t){return e(null===t||void 0===t?void 0:t.networkType)},fail:function(e){return t(null===e||void 0===e?void 0:e.networkType)}})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(e){(0,c.Z)(o,e);var t=(0,d.Z)(o);function o(e){var n;return(0,l.Z)(this,o),n=t.call(this,e),(0,p.Z)((0,h.Z)(n),"videoRef",void 0),(0,p.Z)((0,h.Z)(n),"state",void 0),(0,p.Z)((0,h.Z)(n),"handleWifiAutoPlay",(0,_.Z)((0,m.Z)().mark((function e(){var t;return(0,m.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:t=e.sent,"WIFI"==String(t).toUpperCase()&&setTimeout((function(){n.play()}),r.hj.isIOS()?0:500);case 4:case"end":return e.stop()}}),e)})))),(0,p.Z)((0,h.Z)(n),"handlePlay",(function(){var e=n.props.clickToFullScreen;n.state.showPlay?n.play():e?n.enterFullScreen():n.pause()})),(0,p.Z)((0,h.Z)(n),"onEnded",(function(){var e=n.props.onEnded;e&&e()})),(0,p.Z)((0,h.Z)(n),"onPlay",(function(){var e=n.props.onPlay;e&&e(),n.setState({showPlay:!1})})),(0,p.Z)((0,h.Z)(n),"onPause",(function(){var e=n.props.onPause;e&&e(),n.setState({showPlay:!0})})),(0,p.Z)((0,h.Z)(n),"onTimeUpdate",(function(){for(var e=n.props.onTimeUpdate,t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];e&&e(o)})),(0,p.Z)((0,h.Z)(n),"onError",(function(){var e=n.props.onError;e&&e()})),(0,p.Z)((0,h.Z)(n),"onExitFullScreen",(function(){var e=n.props.onExitFullScreen;n.pause(),e&&e()})),(0,p.Z)((0,h.Z)(n),"onEnterFullScreen",(function(){var e=n.props.onEnterFullScreen;e&&e()})),(0,p.Z)((0,h.Z)(n),"onMuteChange",(function(e){var t=n.props.onMuteChange;t&&t(e)})),n.state={showPlay:!0},n}return(0,u.Z)(o,[{key:"componentDidMount",value:function(){var e=this.props.needWifiAutoPlay;e&&this.handleWifiAutoPlay()}},{key:"play",value:function(){this.videoRef&&this.videoRef.play()}},{key:"pause",value:function(){this.videoRef&&this.videoRef.pause()}},{key:"release",value:function(){var e,t;this.videoRef&&(null===(e=(t=this.videoRef).release)||void 0===e||e.call(t))}},{key:"seekTo",value:function(e){var t,o;this.videoRef&&(null===(t=(o=this.videoRef).seekTo)||void 0===t||t.call(o,e))}},{key:"setMuted",value:function(e){this.videoRef&&this.videoRef.setMuted(e)}},{key:"enterFullScreen",value:function(e){this.videoRef&&this.videoRef.enterFullScreen(e)}}]),o}(i.Component),g=o(92954),y=o.n(g),k=o(2269),x=function(e){(0,c.Z)(o,e);var t=(0,d.Z)(o);function o(e){var n;return(0,l.Z)(this,o),n=t.call(this,e),(0,p.Z)((0,h.Z)(n),"videoRef",void 0),(0,p.Z)((0,h.Z)(n),"state",void 0),(0,p.Z)((0,h.Z)(n),"onTimeUpdate",(function(e){var t=n.props.onTimeUpdate,o=e.detail||{},i=o.currentTime,a=o.duration;t(i,a)})),(0,p.Z)((0,h.Z)(n),"onMuteChange",(function(e){var t=e.detail||{},o=t.isMuted,i=n.props.onMuteChange;i&&i(o)})),n.state={muted:e.muted},n}return(0,u.Z)(o,[{key:"componentDidMount",value:function(){this.videoRef=(0,g.createVideoContext)("TNTVideo")}},{key:"play",value:function(){this.videoRef&&this.videoRef.play()}},{key:"pause",value:function(){this.videoRef&&this.videoRef.pause()}},{key:"seekto",value:function(e){this.videoRef&&this.videoRef.seek(e)}},{key:"enterFullScreen",value:function(e){this.videoRef&&this.videoRef.requestFullScreen(e)}},{key:"setMuted",value:function(e){this.setState({muted:e})}},{key:"render",value:function(){var e=this.props,t=e.videoUrl,o=e.coverImageUrl,n=e.loop,i=void 0===n||n,r=e.autoplay,s=e.scalingModeInEmbed,l=e.onWaiting,u=e.onError,c=e.onPlay,d=e.onPause,m=e.onEnded,_=e.style,h=this.state.muted,p=void 0===h||h;return(0,k.jsx)(a.Video,{style:_,id:"TNTVideo",src:t,poster:o,objectFit:1==s?"cover":"contain",controls:!1,muted:p,loop:i,autoplay:r,enableProgressGesture:!1,showCenterPlayBtn:!1,onTimeUpdate:this.onTimeUpdate,onMuteChange:this.onMuteChange,onWaiting:l,onError:u,onPlay:c,onPause:d,onEnded:m})}}]),o}(i.Component),b={video_wrapper:"index-module_Jwfj_",m_img:"index-module_PvIE8",play_btn:"index-module_QAS_V"},w=o(6148),Z=function(e){(0,c.Z)(o,e);var t=(0,d.Z)(o);function o(e){return(0,l.Z)(this,o),t.call(this,e)}return(0,u.Z)(o,[{key:"render",value:function(){var e=this,t=this.props.style,o=this.state.showPlay;return(0,k.jsxs)(a.View,{className:(0,r.AK)(b.video_wrapper),id:"TNT-VIDEO-WRAPPER",style:t,children:[(0,k.jsx)(x,(0,n.Z)((0,n.Z)({ref:function(t){return e.videoRef=t}},this.props),{},{onEnded:this.onEnded,onPlay:this.onPlay,onPause:this.onPause,onTimeUpdate:this.onTimeUpdate,onError:this.onError,onEnterFullScreen:this.onEnterFullScreen,onExitFullScreen:this.onExitFullScreen,onMuteChange:this.onMuteChange})),(0,k.jsx)(r.En,{onClick:this.handlePlay,className:b.play_btn,children:o?(0,k.jsx)(a.Image,{src:"https://dimg04.c-ctrip.com/images/0AS4q120008wyohs77C7F.png",mode:"aspectFit",style:{width:(0,w.m)(44),height:(0,w.m)(44)}}):null})]})}}]),o}(v),T=o(90129),I=function(){return!1},P=function(e,t){var o="_Q50";-1==t.indexOf("Q")&&(t+=o);var n=e.lastIndexOf("."),i=e.slice(n),a=e.slice(0,n)+"_"+t+i;return I()?a.replace(/(jpg|png)_\.webp/,"$1"):"webp"==i?a:a+"_.webp"},j=o(30194),S=o(25158),L=function(e,t){var o=e.imgUrl,n=e.videoUrl,a=e.ticketGroupId,r=e.logs,s=e.updateVideoPlaying,l=e.updateMuted,u=e.request,c=r.videoPlayClickLog,d=r.videoPauseClickLog,h=(0,i.useState)(""),p=(0,T.Z)(h,2),v=p[0],g=p[1],y=function(){var e=(0,_.Z)((0,m.Z)().mark((function e(){var t;return(0,m.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:t=e.sent,g(String(t).toUpperCase());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=(0,i.useState)(0),x=(0,T.Z)(k,2),b=x[0],w=x[1],Z=(0,i.useState)(0),I=(0,T.Z)(Z,2),L=I[0],R=I[1],C=(0,i.useState)(!0),N=(0,T.Z)(C,2),E=N[0],M=N[1],A=(0,i.useState)(null),D=(0,T.Z)(A,2),V=D[0],G=D[1],F=(0,i.useState)("WIFI"==v?"playing":"pause"),B=(0,T.Z)(F,2),K=B[0],H=B[1],O=(0,i.useState)("WIFI"==v),Y=(0,T.Z)(O,2),q=Y[0],U=Y[1],z=(0,i.useState)("sku"==u.anchor),W=(0,T.Z)(z,2),X=W[0],Q=W[1];(0,i.useImperativeHandle)(t,(function(){return{setMuted:function(e){M(e),V&&V.setMuted(e)},setVideoHide:function(e){Q(e)},getVideoHide:function(){return X}}})),(0,i.useEffect)((function(){setTimeout((function(){y()}),0)}),[]);var J={videoUrl:n,coverImageUrl:(null===o||void 0===o?void 0:o.indexOf("_C_"))>-1?o:P(o,"C_686_422_Q50"),loop:!0,isShowWifiTipsEveryTime:!1,noUnifiedMute:!0,scalingModeInEmbed:1,isOffsetStatusBarInFullScreenAndroid:!0,bizType:"ticket-level1saleunit",logExtra:{"ticket-level1saleunit_id":String(a||""),"ticket-level1saleunit_pageid":"10650087188",networktype:"WIFI"==v?"wifi":"nowifi"}};(0,i.useEffect)((function(){var e;X?(H(q?"playing":"pause"),q&&V&&V.pause()):("playing"==K&&V&&V.play(),V&&(null===V||void 0===V||null===(e=V.setMuted)||void 0===e||e.call(V,E)))}),[X,V]);var $=(0,S.Z)((function(){var e=c&&c({title:"",seq:1})||{},t=e.params,o=e.type;(0,j.Zz)(t,o),U(!0)})),ee=(0,S.Z)((function(){var e=d&&d({title:"",seq:1,length:b,duration:L,is_finished:0})||{},t=e.params,o=e.type;(0,j.Zz)(t,o),U(!1)})),te=(0,S.Z)((function(e){var t=(0,T.Z)(e,2),o=t[0],n=t[1];!b&&w(n),o>L&&R(o)})),oe=(0,S.Z)((function(e){l(e)}));return(0,i.useEffect)((function(){s(q)}),[q]),{config:J,onPlay:$,onPause:ee,onTimeUpdate:te,onMuteChange:oe,setPlayerViewRef:G,videoHide:X}},R=L,C=(r.ua.isMini(),(0,i.forwardRef)((function(e,t){var o=e.type,i=e.imgUrl,l=e.onLayout,u=e.setRefs,c=R(e,t),d=c.config,m=c.onTimeUpdate,_=c.onPlay,h=c.onPause,p=c.onMuteChange,f=c.setPlayerViewRef,v=c.videoHide,g={height:(0,w.m)(230),width:y().getSystemInfoSync().windowWidth,overflow:"hidden"};return(0,k.jsxs)(a.View,{className:(0,r.AK)(s.m_back_content),onLayout:l,ref:function(e){return u&&u("media",e)},children:[1==o?(0,k.jsx)(Z,(0,n.Z)((0,n.Z)({needWifiAutoPlay:!v,clickToFullScreen:!r.ua.isMini(),style:g,ref:function(e){return f(e)}},d),{},{onTimeUpdate:m,onPlay:_,onPause:h,onMuteChange:p})):(0,k.jsx)(r.Y,{src:i,className:(0,r.AK)(s.poster_img)}),(0,k.jsx)(r.cn,{start:{x:0,y:0},end:{x:0,y:1},colors:["rgba(0, 0, 0, 0.4)","rgba(0, 0, 0, 0)"],locations:[.02,1],className:(0,r.AK)(s.m_image_back)})]})}))),N=C},3848:function(e,t,o){var n,i=o(32180),a=o(45023),r=o(63228),s=o(31137),l=o(298),u=o(57042),c=o(24460),d=o(81876),m=o(21867),_=o(86066),h=o(32768),p=o(71515),f=o(22276),v=o(95360),g=o(79301),y=o(95308),k=o(8356),x=o(92954),b=o.n(x),w=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=Object.keys(e||{}).filter((function(e){return-1!==e.indexOf("ext-")})),n={};return o.forEach((function(o){var i=o;t||(i=o.replace(/^ext-(.*)$/,"$1")),e[o]&&(n[i]=e[o])})),n},Z=function(e){return{isNewNaquhua:"newNaquhua"==e.label}},T=o(39860),I=o(39720),P=function(e,t){var o=s.GI.getDevEnv()==s.GI.DEV_ENV_TYPE.FAT?"/restapi/soa2/21052/json/getTicketGroupInfo?subEnv=fat30":"/restapi/soa2/21052/json/getTicketGroupInfo",n=[{name:"imgSize",value:JSON.stringify([{code:"spotImgSize",size:"C_100_100_Q50"}])}];return{data:Object.assign({},{head:{extension:n}},t,e),url:o}},j=function(e){var t={};if(e)t=(0,k.v)(e);else{var o=(0,x.getCurrentInstance)();t=o.router.params}var n=(0,T.I8)(t);t.optid=t.optid||t.tid;var i=w(t),a=(0,l.Z)((0,l.Z)({poiid:t.poiid,optid:(0,T.oG)(t.optid?t.optid.split("|"):[]),ticketGroupId:t.ticketGroupId,showSku:"true"==t.showSku,anchor:t.anchor,date:t.date||"",token:t.token?decodeURIComponent(t.token):"",extParams:i,productId:t.productId||"",ctm_ref:t.ctm_ref,traceid:t.traceid,resourcetype:t.type,hasDiscountInfo:!!t.hasDiscountInfo},Z(t)),{},{scene:t.scene||"shelf",urlParams:n});return a},S=(0,a.Z)((0,a.Z)((0,a.Z)({},s.GI.PLATFORM_TYPE.CRN,"10650087188"),s.GI.PLATFORM_TYPE.H5,"10650104114"),s.GI.PLATFORM_TYPE.Mini,"10650104116"),L=s.GI.getPlatform(),R=function(){var e=(0,y.Z)((0,g.Z)().mark((function e(t){var o,n,i,a,r,l,u,c,d;return(0,g.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=t.params,n=t.http,i=o.showSku,e.prev=2,a=(0,I.Z)(),a.clientInfo.pageId=S[L],r={ticketGroupId:o.ticketGroupId,scene:o.scene||"shelf",head:{extension:[{name:"imgSize",value:'[{"code":"headImgSize","size":"C_750_420_Q50"},{"code":"spotImgSize","size":"C_100_100_Q50"}]'}]}},s.GI.getPlatform()==s.GI.PLATFORM_TYPE.CRN&&"shelf"==o.scene&&(r.tags=[{key:"elementVsInfo",value:"v3"}]),o.poiid&&(r.poiId=o.poiid),o.token&&(r.token=o.token),l=[P(r,a)],u=["navigation","ticketInfomation","spotList","lowPricePerception","mediaInfo"],i||u.push("setFooter"),c={enableCache:!0,cacheExpireTime:5,cacheLocation:"MEM"},l.forEach((function(e){return e.cachePolicy=c})),e.next=16,n(l);case 16:return d=e.sent,console.log("\u7968\u79cd\u8be6\u60c5\u9996\u5c4f\u8bf7\u6c42",l,d),e.abrupt("return",{response:d,modules:u});case 21:return e.prev=21,e.t0=e["catch"](2),console.log("\u53d1\u8bf7\u6c42\u62a5\u9519\u4e86"),e.abrupt("return",{});case 25:case"end":return e.stop()}}),e,null,[[2,21]])})));return function(t){return e.apply(this,arguments)}}(),C=function(e,t,o){o.ticketInfomation||(o.ticketInfomation={});var n=t.getTicketGroupInfo,i=n||{},a=i.elementGroups,r=i.videoInfos;if(a&&a.length){var s=0;o.ticketInfomation.groups=a.map((function(e){var t=e.groupName,o=void 0===t?{}:t,n=o.icon,i=o.values,a=e.elements,r=void 0===a?[]:a;return{groupName:Array.isArray(i)?i[0]:i,groupIcon:n,elements:r.map((function(e){var t=e.name,o=e.modules,n=void 0===o?[]:o,i=e.highlights,a=void 0===i?"":i;return s+=1,{elementName:t,eleCount:s,highlights:a,modules:n.map((function(e){var t=e.name,o=e.moduleProps,n=void 0===o?[]:o;return{moduleName:t,contents:n.map((function(e){var t=e.name,o=e.propValues,n=void 0===o?[]:o;return{contName:t,contVals:n.map((function(e){var t=e.type,o=e.value,n=void 0===o?[]:o;return{type:t,descs:n.map((function(e){return{desc:e,height:159}}))}}))}}))}}))}}))}})),o.ticketInfomation.eleCount=s}o.ticketInfomation.videoInfos=(r||[]).filter((function(e){return e.coverUrl&&e.videoUrl}))},N=o(6148),E=b().getSystemInfoSync().windowWidth-(0,N.m)(84),M=function(e,t,o){var n=t.getTicketGroupInfo,i=n||{},a=i.vsInfo,r=i.id,s=a||{},l=s.titleInfo,u=s.vsInfos,c=s.descInfos,d=s.vsType,m=void 0===d?0:d;a&&u&&l&&(o.lowPricePerception={},o.lowPricePerception.vsType=m,o.lowPricePerception.priceInfo=B(l,!0,m),o.lowPricePerception.vPriceInfo=B({name:l.vName,flags:l.vFlags,salePrice:l.vSalePrice,marketPrice:l.vMarketPrice},!1,m),o.lowPricePerception.descInfoList=(c||[]).map((function(e){return 1==(null===e||void 0===e?void 0:e.type)?null===e||void 0===e?void 0:e.desc:""})),o.lowPricePerception.vsInfos=1==m?G(u,m):D(u),o.lowPricePerception.elementhighlightLog=1==m?A(u,r):null)},A=function(e,t){var o=[];e.forEach((function(e){((null===e||void 0===e?void 0:e.details)||[]).forEach((function(e){(null===e||void 0===e?void 0:e.highlights)&&o.push(e.id)}))}));var n=o.length>0?{id:t,elementid:o.join(",")}:null;return n},D=function(e){if(0==(null===e||void 0===e?void 0:e.length))return[];var t=[];return e.forEach((function(e,o){e.details.forEach((function(o,n){var i=V(o,e.vDetails);t.push({detail:B(o),vdetail:i})}))})),t},V=function(e,t){var o=(t||[]).find((function(t){return t.detailCode==e.detailCode}));return o?B(o):{name:"\u65e0",isNone:!0}},G=function(e,t){if(0==(null===e||void 0===e?void 0:e.length))return[];var o=[];return e.forEach((function(n,i){n.details.forEach((function(i,a){var r=[];e.forEach((function(e){e.groupCode==n.groupCode&&(r=r.concat(e.vDetails||[]))}));var s=r.find((function(e){return e.detailCode==i.detailCode}));o.push(B((0,l.Z)((0,l.Z)({},i),s),!1,t))}))})),o},F=function(e){return!!e||0===e},B=function(e,t,o,n,i,a){var r=e.name,s=e.flags,l=e.salePrice,u=e.marketPrice,c=e.highlights,d=(s||[]).includes("minPriceFlag"),m=void 0!==t?t:(s||[]).includes("highlightFlag");if(1==o){var _=F(l)?"\u5355\u4e70\u4ef7":F(u)?"\u95e8\u5e02\u4ef7":"",h=d?"\u8d77":"",p=(_.length+h.length+3)*(0,N.m)(10),f=2*E-p,v=Number((f/(0,N.m)(13)).toFixed(0));if(r&&r.length>v){var g=r.slice(0,v-2),y=/[&*()\\\/-_+\[\]{}\|:'",<.>?a-zA-Z0-9]/gi,k=g.match(y),x=null!==k&&void 0!==k&&k.length?Number((k.length/2).toFixed(0)):0;r=r.slice(0,v-2+x)+"..."}return{name:r,isStartPrice:d,pricePrefix:_,priceSuffix:h,price:F(l)?l:F(u)?u:"",highlights:c,col:n||1,hasBottomBorder:!!i,detailCode:a}}return{name:r,isStartPrice:d,pricePrefix:void 0!==l?"\u643a\u7a0b\u552e\u4ef7":void 0!==u?"\u95e8\u5e02\u4ef7":"",priceSuffix:d?"\u8d77":"",price:F(l)?l:F(u)?u:"",isHighLight:m,highlights:c}},K=function(e,t,o){var n=H(e,t,o);o.footer=n},H=function(e,t,o,n){var i,a=t.getTicketGroupInfo,r=a||{},l=r.minPrice,u=void 0===l?{}:l,c=r.promotions,d=void 0===c?[]:c,m=r.flags,_=void 0===m?[]:m,h=r.tags,p=void 0===h?[]:h,f=u.minPriceResourceId,v=u.minPricePeopleDesc,g=u.displayPrice,y=u.salePrice,k=u.preferentialAmount,x=u.marketPrice;null!==(i=e.optid)&&void 0!==i&&i.length&&(e.optid=[f]);var b=(_||[]).indexOf("minPriceFlag")<0?"":"\u8d77",w=k>0?"".concat("head"==n?"\u5df2\u4f18\u60e0\xa5":"\u5df2\u51cf").concat(k):"",Z=[{total:{name:v,marketPrice:x?"\xa5".concat(x):"",price:"\xa5"+y}}],T=x?Number(x):0,I=(0,s.lu)(T,y),P=[];I>0&&P.push({total:{name:"\u643a\u7a0b\u9884\u8ba2\u4f18\u60e0",price:"-\xa5".concat(I),discountText:"\u60e0",isNoDash:!0}}),d&&d.length&&d.map((function(e){if(0==e.promotionstatus){var t,o,n=2==e.reductionMode&&3==e.type?e.startAmount:e.amount;P.push({total:{name:null===(t=e.descriptions)||void 0===t?void 0:t[0],price:"-\xa5".concat(n),descs:(null===(o=e.descriptions)||void 0===o?void 0:o.slice(1))||[],discountText:3==e.type?"\u60e0":"\u51cf",isNoDash:!0}})}})),null!==P&&void 0!==P&&P.length&&Z.push.apply(Z,P);var j=[];p&&p.length&&p.forEach((function(e){var t=e.tagType,o=e.tagItems;"Reservation"==t?o.forEach((function(e){["BookingSuccessCanUse","ReadyToUse"].includes(e.tagCode)&&j.push(e.tagName)})):["Refund","Apply","ticketsresourcetag"].includes(t)&&o.forEach((function(e){j.push(e.tagName)}))}));var S={title:"\u4f18\u60e0\u8bf4\u660e",content:Z},L={total:g,marketPrice:x,subPriceDes:b,deductDesc:w,nextTitle:"\u4e0b\u4e00\u6b65",isGrayBtn:!1,isLoading:!1,footPop:S,showTags:j};return L},O=o(29053),Y=function(e,t,o){o.navigation||(o.navigation={});var n=t.getTicketGroupInfo,i=n||{},a=i.basicInfo,r=i.staticInfo;if(a&&(o.navigation.title=a.name,o.navigation.recommendInfo=(null===a||void 0===a?void 0:a.recommendInfo)||""),o.navigation.saleCountDesc=(null===r||void 0===r?void 0:r.saleCountDesc)||"",o.navigation.shareInfo=U(n,e),"delivery"==e.scene){var s=H(e,t,o,"head");s.footPop&&(s.footPop.priceTipList=q(t)),o.navigation.priceInfo=s}},q=function(e){var t=e.getPriceInfo;if(!t)return"";var o="",n=null!==t&&void 0!==t&&t.value?JSON.parse(t.value):{desc:[]};return((null===n||void 0===n?void 0:n.desc)||[]).forEach((function(e,t){o+=e,t!=n.desc.length-1&&(o+="\n")})),o},U=function(e,t){var o;if("delivery"!==t.scene)return{};var n=e||{},i=n.basicInfo,a=n.minPrice,r=n.mediaInfos,l=void 0===r?{}:r,u=i||{},c=u.name,d=a||{},m=d.displayPrice,_=t||{},h=_.urlParams,p=void 0===h?{}:h;p.token&&delete p.token,p.anchor&&delete p.anchor;var f=s.GI.getDevEnv()==s.GI.DEV_ENV_TYPE.FAT,v=f?"https://www.fat6.qa.nt.ctripcorp.com":"https://m.ctrip.com",g="".concat(v,"/webapp/xtnt/ticket-detail?").concat((0,O.Xh)(p));f&&(g+="&env=fat");var y={shareType:"Default",imageUrl:(null===l||void 0===l||null===(o=l[0])||void 0===o?void 0:o.imgUrl)||"",title:"".concat(c,"\uff0c").concat(m,"\u5143\u8d77"),desc:"\u6211\u5728\u643a\u7a0b\u65c5\u884c\u4e0a\u53d1\u73b0".concat(c,"\u5f88\u4e0d\u9519\uff0c").concat(m,"\u5143\u8d77\uff0c\u5feb\u53bb\u770b\u770b\u5427\uff01"),path:g};return y},z=o(97613),W=s.GI.getDevEnv()===s.GI.DEV_ENV_TYPE.FAT?"https://m.ctrip.fat325.qa.nt.ctripcorp.com":"https://m.ctrip.com",X=function(e,t){var o;return o=s.hj.isApp()?"/rn_destination_poi/index.main.js?CRNModuleName=rn_destination_poi&CRNType=1&initialPage=sightDetail&poiId=".concat(e).concat(t?"&ctm=".concat(t):""):s.hj.isInMini()&&!s.hj.isInQuick()&&!s.hj.isInKuaiShou()||s.hj.isMini()?"/pages/gs/sight/newDetail?poiId=".concat(e).concat(t?"&ctm=".concat(t):""):"".concat(W,"/webapp/you/gspoi/sight/2/0.html?poiId=").concat(e,"&seo=0&isHideNavBar=YES").concat(t?"&ctm=".concat(t):"").concat((0,z.Ry)()?"&scene=welfare":""),o},Q=function(e,t,o){var n=e.ctm;o.ticketInfomation||(o.ticketInfomation={});var i=t.getTicketGroupInfo,a=i||{},r=a.relatedScenicSpots,s=void 0===r?[]:r,l=[];s&&s.length&&"delivery"==e.scene&&(l=s.map((function(e){var t;return{imgUrl:(null===(t=e.imgUrls)||void 0===t?void 0:t[0])||"",spotName:e.name,scoreText:e.cmtScore?"".concat(e.cmtScore,"\u5206"):"\u6682\u65e0\u8bc4\u5206",commentCountText:e.commentCount?"".concat(e.commentCount,"\u70b9\u8bc4"):"\u6682\u65e0\u70b9\u8bc4",address:e.address,jumpUrl:X(e.poiId,n)}}))),o.spotList=l},J=o(38696),$=o(24239),ee={},te=[],oe=function(e){te=e.devTraceKeyData},ne=function(e,t){var o=t.request,n=t.ticketInfomation,i=void 0===n?{}:n,a=i.groups,r=void 0===a?[]:a,s=o.optid,u=void 0===s?[]:s,c=o.resourcetype,d=o.ticketGroupId,m=o.poiid,_=o.showSku,h=0;r.map((function(e){var t=e.elements,o=void 0===t?[]:t;h+=o.length})),ee=(0,l.Z)((0,l.Z)({},ee),{poiid:String(m),level1saleunitid:d,resourcetype:c,resourceid:u.join(","),categoryunitcount:r.length,elementcount:h,is_detail:r.length?1:0,is_sku:_?1:0}),te=e.devTraceKeyData,o.traceid},ie=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{ubtKey:e,data:(0,l.Z)((0,l.Z)({},re()),{},{key:e,keyid:t},o),pageId:String((0,$.dD)()||""),exposureEngine:"v1"}},ae=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:"click",key:e,params:(0,l.Z)((0,l.Z)({key:e},re()),t)}},re=function(){return ee},se=function(){return te},le=function(e){try{(0,J.Z)({attrs:se(),action:"sys_show",module:"\u53ef\u8ba2\u963b\u65ad",scene:"\u4e3b\u63a5\u53e3\u6570\u636e\u5f02\u5e38",key:"tkt_1100006",value:"\u4e3b\u63a5\u53e3\u6570\u636e\u5f02\u5e38",jsonData:{value:"\u4e3b\u63a5\u53e3\u6570\u636e\u5f02\u5e38",errorMsg:e?e.message:"\u65e0",errorStack:e?e.stack.slice(0,400):"\u65e0"}})}catch(e){}},ue=function(){try{(0,J.Z)({attrs:se(),action:"sys_show",module:"\u53ef\u8ba2\u963b\u65ad",scene:"\u521d\u59cb\u5316",key:"tkt_2100003",value:"\u4ea7\u54c1\u5df2\u552e\u7f44\uff0c\u8bf7\u9009\u8d2d\u5176\u4ed6\u4ea7\u54c1\u5427",jsonData:{value:"\u4ea7\u54c1\u5df2\u552e\u7f44\uff0c\u8bf7\u9009\u8d2d\u5176\u4ed6\u4ea7\u54c1\u5427"}})}catch(e){}},ce=function(e,t,o){var n=t.getTicketGroupInfo,i=n||{},a=i.mediaInfos,r=void 0===a?[]:a,s=null===r||void 0===r?void 0:r[0];s&&("delivery"==e.scene||1==s.type)&&(o.mediaInfo=s)},de={getParamsFromUrl:function(){var e=j();return e},getFormatByModules:function(e,t,o,n){var i={},a=n||{},r=a.scene;try{o.forEach((function(o){i=me(o,i,e,t)}))}catch(e){le(e),"firstInit"===r&&(i.isSaleOut=!0)}return i}},me=function(e,t,o,n){switch(e){case"navigation":Y(o,n,t);break;case"ticketInfomation":C(o,n,t);break;case"setFooter":K(o,n,t);break;case"lowPricePerception":M(o,n,t);break;case"spotList":Q(o,n,t);case"mediaInfo":ce(o,n,t);break}return t},_e=function(e,t){var o=(null===e||void 0===e?void 0:e.state)||{},n=o.request,i=void 0===n?{}:n;if(i.token)return i;var a=t||{},r=a.getTicketGroupInfo,s=void 0===r?{}:r,l=s||{},u=l.extInfos,c=void 0===u?[]:u;return(c||[]).some((function(e){return"token"==e.key&&(i.token=decodeURIComponent(e.value),!0)})),i},he=o(3164),pe=o(26593),fe=function(){return{navLog:{closeClickLog:function(e){var t=e.duration,o=e.type;return ae("tkt_pzxqyclose_trace",{duration:t,type:o})},headerLeftDevtraceLog:{action:"usr_click",attrs:se(),module:"\u5934\u90e8\u6a21\u5757",value:"\u5173\u95ed\u6309\u94ae"},shareExposureLog:ie("tkt_sharebutton_shareexpo_expo","250420"),shareClickLog:ae("tkt_sharebutton_shareclick_click"),moreClickLog:ae("tkt_morebutton_click"),moreExpoLog:ie("tkt_morebutton_expo","254043")},spotListLog:{expo:function(e){return ie("tkt_relatedpoi_expo","254045",{pos:e})},click:function(e){return ae("tkt_relatedpoi_click",{pos:e})}},tabLog:{tabExposureLog:ie("tkt_pzxqybar_exposure",""),tabClickLog:function(e){var t=e.buttonname;return ae("tkt_pzxqybar_trace",{buttonname:t})},tabClickDevTraceLog:function(e){return{action:"usr_click",attrs:se(),module:"tab\u6a21\u5757",value:e}}},detailLog:{detailExposureLog:ie("tkt_pzxqydetail_exposure",""),groupTitleExposureLog:function(e){var t=e.categorypos;return ie("tkt_pzxqydetailheadline_exposure","",{categorypos:t})},eleTitleExposureLog:function(e){var t=e.elementpos;return ie("tkt_pzxqydetailheadline_exposure","",{elementpos:t})},operaterExposureLog:function(e){var t=e.module_name,o=void 0===t?"detail":t;return ie("tkt_pzxqyfold_exposure","",{module_name:o})},operaterClickLog:function(e){var t=e.module_name,o=void 0===t?"detail":t,n=e.applyType;return ae("tkt_pzxqyfold_trace",{module_name:o,applyType:n})},operaterDevTraceLog:function(e){return{action:"usr_click",attrs:se(),module:"\u4ea7\u54c1\u8be6\u60c5",value:e}},videoExposureLog:function(e){return ie("tkt_videoexpo_video_expo","236022",e)},videoPlayClickLog:function(e){return ae("tkt_videopaly_video_click",e)},videoPauseClickLog:function(e){return ae("tkt_videostop_video_click",e)},videoTitleExposureLog:function(e){return ie("tkt_videotitle_video_expo","",e)},videoTitleClickLog:function(e){return ae("tkt_videotitle_video_click",e)},vsExposureLog:function(e){return ie("tkt_vs_vs_expo","236026",e)},elementhighlightExposureLog:function(e){return ie("tkt_elementhighlight_exposure_expo","242707",e)}},skuLog:{skuExposureLog:ie("tkt_pzxqydatesku_exposure","")},footerLog:{bigBtnClickLog:ae("tkt_pzxqybuttonnavigator_trace"),btnClickLog:function(e){var t=e.resourceid;return ae("tkt_sightdetail_click_package_next",{resourceid:t})},anchorBtnDevTraceLog:{action:"usr_click",attrs:se(),module:"\u5e95\u90e8\u6a21\u5757",value:"\u9884\u8ba2\u9009\u62e9"},detailDevTraceLog:{action:"usr_click",attrs:se(),module:"\u5e95\u90e8\u6a21\u5757",value:"\u660e\u7ec6"},nextDevTraceLog:{action:"usr_click",attrs:se(),module:"\u5e95\u90e8\u6a21\u5757",value:"\u4e0b\u4e00\u6b65"}},errPageLog:{backBtnDevTraceLog:{action:"usr_click",attrs:se(),module:"\u65e0\u4ea7\u54c1\u9875",value:"\u8fd4\u56de"}}}},ve=function(e,t){ne(e,t),e.logData=fe()},ge=function(e,t){var o={key:t||"PRICE_DESCRIBE",resourceIds:[]};return{data:Object.assign({},e,o),url:"/restapi/soa2/12530/json/applicationConfig?v=PRICE_DESCRIBE"}},ye=o(18866),ke=(0,he.Z)("ticket-detail"),xe=s.GI.getPlatform()===s.GI.PLATFORM_TYPE.CRN,be=function(){function e(t){(0,u.Z)(this,e),(0,a.Z)(this,"target",void 0),(0,a.Z)(this,"timer",void 0),this.target=t,this.timer=(new Date).getTime(),e.init(this)}return(0,c.Z)(e,[{key:"second",value:function(){var e=(0,y.Z)((0,g.Z)().mark((function e(t,o,n){var i,a,r,s,u,c;return(0,g.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=(0,I.Z)(),r=[ge(a)],e.next=4,(0,ye.ZP)(r);case 4:if(s=e.sent,s){e.next=7;break}return e.abrupt("return");case 7:u=(0,l.Z)((0,l.Z)({},t||{}),{},{getPriceInfo:null===(i=s[0])||void 0===i?void 0:i.data}),c=de.getFormatByModules(o,u,["navigation"],{scene:"secondInit"}),n.target.afterFetch((0,l.Z)({},c));case 10:case"end":return e.stop()}}),e)})));function t(t,o,n){return e.apply(this,arguments)}return t}()}],[{key:"init",value:function(){var e=(0,y.Z)((0,g.Z)().mark((function e(t){var o,n,i,a,r,s,u,c,d;return(0,g.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.target.state.request,i="sku"==n.anchor,ke.record(i?"Secondreq":"Firstreq"),e.next=5,R({params:n,http:t.target.http});case 5:if(a=e.sent,r=a.response,s=a.modules,r){e.next=10;break}return e.abrupt("return");case 10:if(ke.recordEnd(i?"Secondreq":"Firstreq"),null!==(o=r[0].ticketGroup)&&void 0!==o&&null!==(o=o.elementGroups)&&void 0!==o&&o.length&&(n.showSku||r&&r[0].ticketGroup&&r[0].ticketGroup.minPrice)){e.next=15;break}return ue(),t.target.afterFetch({isSaleOut:!0}),e.abrupt("return");case 15:u={getTicketGroupInfo:r[0].ticketGroup},c=de.getFormatByModules(n,u,s,{scene:"firstInit"}),d=_e(t.target,u),console.log("getFormatByModules-state",c,r),ke.record(i?"Seconrender":"Firstrender"),ve(t.target,(0,l.Z)((0,l.Z)({},t.target.state),c)),t.target.afterFetch((0,l.Z)((0,l.Z)({},c),{},{request:d}),{cb:function(){ke.recordEnd(i?"Seconrender":"Firstrender"),xe&&(0,pe.f)((0,l.Z)((0,l.Z)({key:"ttd_dev_pageload_render",id:220287},ke.viewRecords(["Loadjs","Firstreq","Firstrender","Secondreq","Seconrender"])),{},{jsonData:{timestamp:ke.getRecordStamps()}}),"devtrace")}}),t.second(u,n,t);case 23:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),we=o(63362),Ze=o(30194),Te=function(e,t,o,n,i){s.c0.getBoundingClientRect({node:t}).then((function(e){if(e){var t=e.top,a=i?0:Ie(),r=o.scrollTop,s=void 0===r?0:r,l=.2*b().getSystemInfoSync().windowHeight,u=t+s-a-l||0;n&&n(u)}}))},Ie=function(e){return s.hj.isIOS()?s.hj.isIPhoneX()?88:64:50},Pe=o(9641),je=o(2446),Se=je.ZP,Le=o(57113),Re=Le.Z,Ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=s.GI.getDevEnv();switch(t){case"DEV":case"FAT":return e?"https://".concat(e):"https://m.fws.qa.nt.ctripcorp.com";case"PROD":return"https://m.ctrip.com";default:return"https://m.ctrip.com"}},Ne=Ce(),Ee=s.GI.PLATFORM_TYPE,Me=s.GI.getDevEnv(),Ae=s.GI.getPlatform(),De=function(e){var t="".concat(Ne,"/webapp/taro/pages/tnt/booking/index?");return["FAT","dev"].includes(Me)&&(t+="env=fat&"),(0,a.Z)((0,a.Z)((0,a.Z)({},Ee.Mini,"/pages/tnt/booking/index?"),Ee.CRN,"/rn_ttd_taro/_crn_config?CRNModuleName=rn_ttd_taro&CRNType=1&initialPage=booking&isNew=true&"),Ee.H5,t)[e||Ae]},Ve=function(e){var t="".concat(Ne,"/webapp/taro/pages/tnt/detail/resource/index?");return["FAT","dev"].includes(Me)&&(t+="env=fat&"),(0,a.Z)((0,a.Z)((0,a.Z)({},Ee.Mini,"/pages/gs/detail/resource/index?"),Ee.CRN,"/rn_ttd_taro/_crn_config?CRNModuleName=rn_ttd_taro&CRNType=1&initialPage=resource&"),Ee.H5,t)[e||Ae]},Ge=function(e,t){return Array.from(new Set(t.filter((function(t){return e.includes(t)}))))},Fe=o(7249),Be=b().getSystemInfoSync().windowHeight,Ke=(0,he.Z)("ticket-detail"),He=.2*(Be-(s.GI.getPlatform()==s.GI.PLATFORM_TYPE.H5?0:(0,N.m)(151))),Oe=function(e){(0,m.Z)(i,e);var t=(0,_.Z)(i);function i(e){var r;(0,u.Z)(this,i),r=t.call(this,e),(0,a.Z)((0,d.Z)(r),"state",void 0),(0,a.Z)((0,d.Z)(r),"fetch",void 0),(0,a.Z)((0,d.Z)(r),"scrollView_ref",void 0),(0,a.Z)((0,d.Z)(r),"skuRef",void 0),(0,a.Z)((0,d.Z)(r),"detailTabY",0),(0,a.Z)((0,d.Z)(r),"skuTabY",0),(0,a.Z)((0,d.Z)(r),"fixH",0),(0,a.Z)((0,d.Z)(r),"pageHeight",Be),(0,a.Z)((0,d.Z)(r),"navRef",void 0),(0,a.Z)((0,d.Z)(r),"detailRef",void 0),(0,a.Z)((0,d.Z)(r),"videoCompRef",void 0),(0,a.Z)((0,d.Z)(r),"pageRefs",{}),(0,a.Z)((0,d.Z)(r),"pageWrapRef",void 0),(0,a.Z)((0,d.Z)(r),"scrollTop",0),(0,a.Z)((0,d.Z)(r),"logData",{}),(0,a.Z)((0,d.Z)(r),"startTime",(new Date).getTime()),(0,a.Z)((0,d.Z)(r),"devTraceKeyData",[]),(0,a.Z)((0,d.Z)(r),"layouted",!1),(0,a.Z)((0,d.Z)(r),"moduleConfig",[{name:"nav",height:88},{name:"media",height:0},{name:"head",height:0},{name:"lowPricePerception",height:0},{name:"spotList",height:0},{name:"tab",height:0},{name:"detail",height:0},{name:"sku",height:0},{name:"footer",height:97}]),(0,a.Z)((0,d.Z)(r),"allRefs",[]),(0,a.Z)((0,d.Z)(r),"initEnd",!1),(0,a.Z)((0,d.Z)(r),"moduleMapH",r.moduleConfig.reduce((function(e,t){return e[t.name]=t.height,e}),{})),(0,a.Z)((0,d.Z)(r),"videoWrapHeight",0),(0,a.Z)((0,d.Z)(r),"onScrollThrottle",void 0),(0,a.Z)((0,d.Z)(r),"scrollTimer",null),(0,a.Z)((0,d.Z)(r),"toggleExpandY",0),(0,a.Z)((0,d.Z)(r),"skuDateInitSelect",!1),(0,a.Z)((0,d.Z)(r),"testTime",0),(0,a.Z)((0,d.Z)(r),"isRN",!0),(0,a.Z)((0,d.Z)(r),"isMini",!1),(0,a.Z)((0,d.Z)(r),"isH5",!1),(0,a.Z)((0,d.Z)(r),"timer",null),(0,a.Z)((0,d.Z)(r),"updateVideoPlaying",(function(e){r.setState({isVideoPlaying:e})})),(0,a.Z)((0,d.Z)(r),"onChangeMuted",(function(e){r.videoCompRef&&r.videoCompRef.setMuted(e),r.updateMuted(e)})),(0,a.Z)((0,d.Z)(r),"updateMuted",(function(e){r.setState({isMuted:e})})),r.testTime=(new Date).getTime();var l=de.getParamsFromUrl(),c=[{text:"\u4ea7\u54c1\u8be6\u60c5",index:0,name:"detail"},{text:"\u9884\u8ba2\u9009\u62e9",index:1,name:"sku"}],m=0;if(r.state={request:l,renderModules:{sku:"sku"==l.anchor,info:"sku"!==l.anchor},footer:{total:"",subPriceDes:"",isGrayBtn:!0},tabInfos:c,currentTab:"sku"==l.anchor?c[1]:c[0],showBigBtn:l.showSku&&"sku"!=l.anchor,videoHide:"sku"==l.anchor,lastVideoHide:"sku"==l.anchor,isPack3:!1,diffDateBoxResIds:[],sameDateBoxResIds:[],firstLevelInfos:[],firstLevelMapSubResId:{},firstLevelMapSelectedPropertyIds:{},boxResIdMapSubResId:{},assistComponent:Le.K,showFooter:!1,showSku:!1,scrollTop:m,footerHeight:97,headLoad:"sku"!=l.anchor,isLoading:"sku"==l.anchor,autoScroll:!1,tabTip:"",isVideoPlaying:!1,isMuted:!0,showTopTab:!(!r.isRN||"sku"!=l.anchor)},r.initEnd="sku"!=l.anchor,r.devTraceKeyData=[{key:"poiid",value:l.poiid},{key:"ticketGroupId",value:l.ticketGroupId},{key:"optid",value:l.optid.toString()}],!s.hj.isInServer()){r.fetch=new be((0,d.Z)(r)),r.register();var _=o(9157).Z;_({pageId:(0,$.dD)()})}return n=(0,d.Z)(r),r.onScrollAnchor=r.onScrollAnchor.bind((0,d.Z)(r)),r.isRN=s.GI.getPlatform()==s.GI.PLATFORM_TYPE.CRN,r.isMini=s.GI.getPlatform()==s.GI.PLATFORM_TYPE.Mini,r.isH5=s.GI.getPlatform()==s.GI.PLATFORM_TYPE.H5,r.debonceScroll=r.isRN||r.isMini?r.onScroll:(0,Fe.D)(r.onScroll,20),oe((0,d.Z)(r)),r}return(0,c.Z)(i,[{key:"register",value:function(){Re.register(this)}},{key:"componentDidUpdate",value:function(){this.getAllLayout()}},{key:"getAllLayout",value:function(){var e=this;s.GI.getPlatform()!=s.GI.PLATFORM_TYPE.CRN&&(this.allRefs||[]).forEach((function(t){setTimeout((function(){var o=t.ref;o&&s.c0.getBoundingClientRect({node:o}).then((function(o){if(o){var n={nativeEvent:{layout:{height:o.height}}};switch(t.name){case"page":e.getPageHeight(n);break;default:e.onLayout(t.name,n)}}}))}),s.hj.isBaidu()?200:0)}))}},{key:"setRefs",value:function(e,t){var o=this.allRefs.some((function(t){return t.name==e}));o||this.allRefs.push({name:e,ref:t})}},{key:"afterFetch",value:function(e,t){var o=t||{},n=o.cb,i=this.state,a=i.request,r=i.renderModules,s=void 0===r?{}:r,u=i.isLoading;a.showSku&&(e.renderModules=(0,l.Z)((0,l.Z)({},s),{},{sku:!0})),this.setState((0,l.Z)((0,l.Z)({},e),{},{render:!0}),(function(){u&&Ke.record("ticket_detail_content_render_to_mask_hide"),n&&n()}))}},{key:"onSkuLoad",value:function(e,t,o){var n;if("mask"!=t){var i=null!==o&&void 0!==o&&null!==(n=o.peopleProperties)&&void 0!==n&&n.length?"\u53ef\u9009\u4eba\u7fa4":"S"==(null===o||void 0===o?void 0:o.priceMode)||null!==o&&void 0!==o&&o.hasSingleDateCalendar?"\u53ef\u9009\u65e5\u671f":"",a=this.state.renderModules;a.info=!0,this.setState({renderModules:a,isSaleOut:!!e,tabTip:i})}else Ke.record("ticket_detail_mask_sku_render_to_hide")}},{key:"onToggleExpand",value:function(e,t){var o=this;e&&(this.layouted=!0,s.hj.isBaidu()&&this.setState({}),t||setTimeout((function(){return Te(null,e,o,(function(e){var t=o.state.scrollTop;o.toggleExpandY&&e>o.skuTabY&&(e=o.toggleExpandY),t==e&&(e+=.1),o.toggleExpandY=e,o.scrollTo(e)}))}),100))}},{key:"onClose",value:function(){this.pop()}},{key:"onTabClick",value:function(e,t){var o,n,i=this.state,a=i.tabInfos,r=i.request,s=i.scrollTop,l="detail"==a[t].name?this.detailTabY:this.skuTabY;"detail"==a[t].name&&this.setState({showTopTab:!1}),l==s&&(l+=.01),this.scrollTo(l);var u=this.logData,c=u.tabLog,d=void 0===c?{}:c,m=u.footerLog,_=void 0===m?{}:m,h=(null===d||void 0===d?void 0:d.tabClickLog)&&d.tabClickLog({buttonname:null===a||void 0===a||null===(o=a[t])||void 0===o?void 0:o.name})||{};(0,Ze.Zz)(null===h||void 0===h?void 0:h.params,null===h||void 0===h?void 0:h.type),d.tabClickDevTraceLog&&(0,Ze.Vg)(d.tabClickDevTraceLog);var p=null!==r&&void 0!==r&&r.showSku?(null===(n=this.skuRef)||void 0===n||null===(n=n.logData)||void 0===n?void 0:n.btnTraceData)||{}:_.nextDevTraceLog;(0,Ze.Vg)(p)}},{key:"scrollTo",value:function(e,t){this.isRN?(this.scrollView_ref&&this.scrollView_ref.scrollTo({x:0,y:e>0?e:0}),t&&t()):this.setState({scrollTop:e},(function(){t&&t()}))}},{key:"onScroll",value:function(e){var t,o,n,i=this,a=null===e||void 0===e||null===(t=e.nativeEvent)||void 0===t||null===(t=t.contentOffset)||void 0===t?void 0:t.y,r=void 0!==a?a:(null===e||void 0===e||null===(o=e.detail)||void 0===o?void 0:o.scrollTop)||0;(r||0==r)&&(this.scrollTop=r);var u=this.state,c=u.currentTab,d=u.footer,m=u.autoScroll,_=u.request;null===(n=this.navRef)||void 0===n||n.onScroll(r);var h=this.findTab(r);_.showSku&&this.getShowTopTab(r);var p=function(e,t){var o=!1;if(e.index!=c.index&&i.initEnd&&!m){var n={currentTab:e};s.hj.isBaidu()&&(n.scrollTop=t),i.setState((0,l.Z)({},n)),o=!0}if(("sku"==e.name||!d.isGrayBtn)&&(i.state.showBigBtn||m)){var a={showBigBtn:!1,autoScroll:!1};s.hj.isBaidu()&&(a.scrollTop=t),i.setState((0,l.Z)({},a)),o=!0}if("sku"!==e.name&&d.isGrayBtn&&!i.state.showBigBtn&&!m){var r={showBigBtn:!0};s.hj.isBaidu()&&(r.scrollTop=t),i.setState((0,l.Z)({},r)),o=!0}!o&&s.hj.isBaidu()&&i.setState({scrollTop:t})};s.hj.isBaidu()?(this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout((function(){p(h,r)}),200)):p(h,r),this.setVideoStatus(r),s.GI.getPlatform()!=s.GI.PLATFORM_TYPE.Mini||s.hj.isBaidu()||b().createSelectorQuery().select("#ticket_detail_scroll_view").fields({scrollOffset:!0}).exec((function(e){var t;if(null!==e&&void 0!==e&&e[0]){var o=null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.scrollTop;if(o>r){var n=i.findTab(o);p(n,o)}}}))}},{key:"getShowTopTab",value:function(e){var t=this.state.showTopTab,o=e>this.detailTabY;this.isRN&&o!==t&&this.setState({showTopTab:o})}},{key:"setVideoStatus",value:function(e){var t=e+1>this.moduleMapH["media"]-this.moduleMapH["nav"];this.videoCompRef&&this.videoCompRef.setVideoHide(t)}},{key:"culculateH",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.state.mediaInfo,o=this.moduleConfig.findIndex((function(e){return"sku"==e.name}));this.fixH=this.moduleMapH["nav"]+this.moduleMapH["tab"],this.skuTabY=this.moduleConfig.reduce((function(e,t,n){return n<o&&(e+=t.height),e}),0)-this.fixH-He-(this.isRN&&t?this.moduleMapH["nav"]:!this.isRN&&t?-this.moduleMapH["nav"]:0),this.detailTabY=this.skuTabY-this.moduleMapH["detail"]+He-(this.isH5?this.fixH:0),this.skuTabY<this.detailTabY&&(this.skuTabY=this.detailTabY+20),(s.GI.getPlatform()!==s.GI.PLATFORM_TYPE.CRN&&!this.layouted&&!this.initEnd||e)&&this.onScrollAnchor()}},{key:"findTab",value:function(e){return e+1<this.skuTabY?this.state.tabInfos[0]:this.state.tabInfos[1]}},{key:"onLayout",value:function(e,t){var o,n=this.state,i=(n.request,n.lowPricePerception),a=n.isLoading,r=(n.mediaInfo,this.moduleConfig.find((function(t){return t.name==e}))),s=null===t||void 0===t||null===(o=t.nativeEvent)||void 0===o?void 0:o.layout,l=s.height;if((null===r||void 0===r?void 0:r.height)!=l){r.height=l;var u=this.moduleMapH[e];this.moduleMapH[r.name]=l;var c=0==u&&this.moduleMapH[e]>0;this.moduleMapH["head"]>0&&this.moduleMapH["detail"]>0&&(i&&this.moduleMapH["lowPricePerception"]>0||!i)&&a&&this.setState({headLoad:!0}),"footer"==r.name&&this.setState({footerHeight:l}),this.culculateH(c)}}},{key:"getPageHeight",value:function(e){var t,o=null===e||void 0===e||null===(t=e.nativeEvent)||void 0===t?void 0:t.layout,n=o.height;this.pageHeight=n}},{key:"onShortLayout",value:function(){var e=this;this.setState({isShort:!0}),setTimeout((function(){e.onScrollAnchor("force")}),100)}},{key:"onScrollAnchor",value:function(e){var t=this,o=this.state,n=o.request,i=o.lowPricePerception,a=o.isLoading,r=(o.scrollTop,o.mediaInfo),s=o.spotList,u=i&&this.moduleMapH["lowPricePerception"]>0||!i,c=r&&this.moduleMapH["media"]>0||!r,d=s&&s.length>0&&this.moduleMapH["spotList"]>0||!(null!==s&&void 0!==s&&s.length);"sku"==n.anchor&&this.moduleMapH["detail"]&&this.moduleMapH["head"]&&u&&c&&d&&(a||"force"==e)&&this.scrollTo(this.skuTabY,(function(){t.setState({autoScroll:!1},(function(){a&&(setTimeout((function(){t.setState({isLoading:!1}),Ke.recordEnd("ticket_detail_content_render_to_mask_hide"),Ke.recordEnd("ticket_detail_mask_sku_render_to_hide"),(0,pe.f)((0,l.Z)((0,l.Z)({key:"ttd_dev_ticket_detail_anchor",id:253569},Ke.viewRecords(["ticket_detail_content_render_to_mask_hide","ticket_detail_mask_sku_render_to_hide"])),{},{jsonData:{}}),"devtrace")}),20),setTimeout((function(){t.initEnd=!0,(0,Pe.N)(t.detailRef,{opacity:1})}),200))}))}))}},{key:"onBtnClick",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o={url:"",data:{}},n=this.state,i=n.footer.hasNaquhua,a=n.request,r=a.date,u=a.optid,c=a.ctm_ref,d=a.selectPropertyIds,m=void 0===d?[]:d,_=a.token,h=a.peopleId,p=a.poiid,v=a.spotid,g=a.extParams,y=a.traceid,k=a.productId,x=a.resourcetype,b=a.showSku,w=n.skutype,Z=n.isPack3,T=n.diffDateBoxResIds,I=void 0===T?[]:T,P=n.sameDateBoxResIds,j=void 0===P?[]:P,S=n.firstLevelInfos,L=void 0===S?[]:S,R=n.firstLevelMapSubResId,C=void 0===R?{}:R,N=n.firstLevelMapSelectedPropertyIds,E=void 0===N?{}:N,M=n.boxResIdMapSubResId,A=void 0===M?{}:M,D=n.renderModules,V=(0,l.Z)({poiid:p,ctm_ref:c,token:encodeURIComponent(_),isNewNaquhua:!!i,traceid:y},g),G=this.logData.footerLog,F=void 0===G?{}:G,B=b?(null===(e=this.skuRef)||void 0===e||null===(e=e.logData)||void 0===e?void 0:e.btnTraceData)||function(){return null}:F.nextDevTraceLog;(0,Ze.Vg)(B);var K=D.sku;if(i&&(V.label="newNaquhua"),null!==u&&void 0!==u&&u.length?V.optid=u.join("|"):K&&(V.optid=[]),r&&(V.date=r),null!==m&&void 0!==m&&m.length&&(V.salesPropertyIds=m.join("|")),w&&(V.fromSkuType=w),x&&(V.resourcetype=x),h&&(V.peopleId=h),k&&(V.productId=k),Z){var H=[],Y=[];L.forEach((function(e){var t=e.firstLevelId;H.push(Number(t));var o=E[t];Y.push(o.join("-"))})),V.salesPropertyIds=Y.join("|"),V.firstLevelIds=H.join("|")}if(0==u.length&&!K||1==u.length){if(Z&&1==u.length){var q=u[0],U=[].concat((0,f.Z)(I),(0,f.Z)(j)).includes(q);if(U){var z=[],W=A[q];L.forEach((function(e){var t=e.firstLevelId,o=C[t];z.push.apply(z,(0,f.Z)(Ge(W,o)))})),V.subResourceId=z.join("-")}}o={url:De(),data:V}}else{if(Z){var X=[],Q=[],J=[];if(u.forEach((function(e){I.includes(e)?(Q.push(e),J.push(0)):j.includes(e)?(Q.push(e),J.push(1)):X.push(e)})),V.optid=X.join("|"),V.boxid=Q.join("|"),V.boxType=J.join("|"),Q.length){var $=[];Q.forEach((function(e){var t=[],o=A[e];L.forEach((function(e){var n=e.firstLevelId,i=C[n];t.push.apply(t,(0,f.Z)(Ge(o,i)))})),$.push(t.join("-"))})),V.subResourceId=$.join("|")}}var ee=s.GI.getPlatform()==s.GI.PLATFORM_TYPE.H5||s.GI.getPlatform()==s.GI.PLATFORM_TYPE.Mini?s.GI.PLATFORM_TYPE.H5:s.GI.PLATFORM_TYPE.CRN;o={url:Ve(ee),data:(0,l.Z)((0,l.Z)({},V),{},{spotid:v})}}if(t)return o.url+(0,O.Xh)(o.data);this.push(o),Se.hide()}},{key:"addFun",value:function(e,t){var o,n,i=this.state,a=i.request,r=i.footer;a.showSku?null===(n=this.skuRef)||void 0===n||n.addFun(e,t):null!==(o=r.showTags)&&void 0!==o&&o.length&&t&&t()}},{key:"onSkuChange",value:function(e){var t,o=this,n=e.footer,i=e.date,a=e.optid,r=e.isNewNaquhua,s=e.peopleId,u=e.selectPropertyIds,c=e.skutype,d=e.spotid,m=e.reservation,_=e.resourcetype,h=e.bookingUrl,p=e.isPack3,f=e.diffDateBoxResIds,v=e.sameDateBoxResIds,g=e.firstLevelInfos,y=e.firstLevelMapSubResId,k=e.firstLevelMapSelectedPropertyIds,x=e.boxResIdMapSubResId,b=this.state,w=b.request,Z=b.currentTab,T=(b.tabInfos,null===(t=w)||void 0===t?void 0:t.date);w=(0,l.Z)((0,l.Z)({},w),{},{date:i,optid:a,peopleId:s,selectPropertyIds:u,isNewNaquhua:r,spotid:d}),this.setState({showBigBtn:"sku"!==Z.name&&n.isGrayBtn,footer:n,skutype:c,request:w,reservation:m,resourcetype:_,bookingUrl:h,isPack3:p,diffDateBoxResIds:f,sameDateBoxResIds:v,firstLevelInfos:g,firstLevelMapSubResId:y,firstLevelMapSelectedPropertyIds:k,boxResIdMapSubResId:x},(function(){var e;null===(e=o.skuRef)||void 0===e||e.runFuns()})),!T||this.skuDateInitSelect||"sku"===w.anchor?n.isGrayBtn&&this.onTabClick(0,1):this.skuDateInitSelect=!0}},{key:"onVideoWrapLayout",value:function(e){this.videoWrapHeight=e}},{key:"pageWillDisappear",value:function(){if(this.videoCompRef){var e=this.videoCompRef.getVideoHide();this.videoCompRef.setVideoHide(!0),this.setState((function(t){return{lastVideoHide:e}}))}}},{key:"pageDidAppear",value:function(){var e=this,t=this.state.renderModules;this.setState((function(e){return{}}),(function(){t.sku&&e.skuRef&&e.skuRef.checkButtonStatus&&e.skuRef.checkButtonStatus(),e.videoCompRef&&e.videoCompRef.setVideoHide(e.state.lastVideoHide)}))}},{key:"componentDidShow",value:function(){s.GI.getPlatform()==s.GI.PLATFORM_TYPE.Mini&&Re.register(this)}}],[{key:"pageWillAppear",value:function(){}},{key:"onBackAndroid",value:function(){var e=n.logData.navLog,t=void 0===e?{}:e,o=t.closeClickLog;if(o){var i=o({type:"gesture",duration:((new Date).getTime()-n.startTime)/1e3}),a=i.params,r=i.type;(0,Ze.Zz)(a,r)}we.ZP.navigateBack()}}]),i}(v.ZP),Ye={m_page_wrap:"style-module_q_Ca0",m_tab_item:"style-module_e_vG2",m_tab_item_text:"style-module_T7aas",m_tab_animated_style:"style-module_e7UEh",m_back_blue:"style-module_fJmkf",m_back_img_style:"style-module_PRInC",m_detail_wrapper:"style-module_JXHCs",m_head_hold:"style-module_X0Vfd",m_sku_title:"style-module_DJxZG",m_sku_title_text:"style-module_VOZFf",m_sku_wrapper:"style-module_e_2wu",m_radius_0:"style-module_QOKtH",m_radius_top_12:"style-module_VDZou",m_opacity_0:"style-module_t1SRT",m_opacity_1:"style-module_c7PZU",m_tab_sticky:"style-module_PxI5W",loading:"style-module_CejFN",loading_mask:"style-module_gVXML",m_tab_tip:"style-module_TNmY1",m_tab_tip_text:"style-module_lpPwf"},qe=o(90201),Ue=o(2269),ze=function(e){return(0,Ue.jsx)(Ue.Fragment,{})},We=o(63574),Xe=function(){return null},Qe=o(66023),Je=o(90129),$e=function(e){var t,o,n=e.spotList||[],i=null===(t=e.logs)||void 0===t?void 0:t.click,a=null===(o=e.logs)||void 0===o?void 0:o.expo,r=(0,qe.useState)(0),l=(0,Je.Z)(r,2),u=l[0],c=l[1],d=(0,qe.useCallback)((function(e){s.Px.navigateTo({url:e,needNewContainer:!0,isUseHybridgeMini:!0})}),[]);return{spotList:n,currentPage:u,totalPage:n.length,setCurrentPage:c,handleClickSpot:d,spotClickLog:i,spotExpoLog:a}},et={m_spot_item_img:"style-module_YlNsc",m_spot_list:"style-module_w8O52",m_spot_item:"style-module_C56NK",m_spot_item_img_wrapper:"style-module_R00d7",m_spot_item_label:"style-module_BwWZt",m_spot_item_label_text:"style-module_Wu5fw",m_spot_item_label_text_app:"style-module_MdxAx",m_spot_item_content:"style-module_FpLEJ",m_spot_item_content_top:"style-module_jzQU7",m_spot_item_content_top_name:"style-module_MDwaJ",m_spot_item_content_top_next_icon:"style-module_Vklb_",m_spot_item_content_bottom:"style-module_i3dYy",m_spot_item_content_bottom_score_icon:"style-module_RGWQG",m_spot_item_content_bottom_score_icon_android:"style-module_xDUio",m_spot_item_content_bottom_score:"style-module_UGznw",m_spot_item_content_bottom_split_line:"style-module_jywbX",m_spot_item_content_bottom_commment:"style-module_GhevT",m_spot_item_content_bottom_address_icon:"style-module_ewS9Y",m_spot_item_content_bottom_address_icon_android:"style-module_Lx4Zz",m_spot_item_content_bottom_address:"style-module_Etnbu",m_swiper_wrapper:"style-module_pO2Vy",m_swiper_item:"style-module_nKkAr",m_pagination_dots:"style-module_bYryF",m_pagination_dot_item:"style-module_FNIAi",m_pagination_dot_item_active:"style-module_zkgYv",m_split_line:"style-module_pkziF",m_split_margin:"style-module_Oz_p1"},tt=o(30901),ot=function(e){var t=e.currentPage,o=e.datas,n=e.spotClassName,i=void 0===n?"":n,a=e.spotStyle,r=void 0===a?{}:a;return(0,Ue.jsx)(p.View,{className:(0,s.AK)(et.m_pagination_dots,i),style:r,children:o.map((function(e,o){var n=t===o;return(0,Ue.jsx)(p.View,{className:(0,s.AK)(et.m_pagination_dot_item,n?et.m_pagination_dot_item_active:"")},o)}))})},nt=function(e){var t=e.imgUrl,o=e.spotName,n=e.scoreText,i=e.commentCountText,a=e.address,r=e.jumpUrl,l=e.handleClick,u=e.expoLog,c=e.clickLog;return(0,Ue.jsxs)(s.En,{className:et.m_spot_item,log:c,testID:u,onClick:function(){l&&l(r)},children:[(0,Ue.jsxs)(p.View,{className:et.m_spot_item_img_wrapper,children:[(0,Ue.jsx)(s.Y,{className:et.m_spot_item_img,src:t}),(0,Ue.jsx)(p.View,{className:et.m_spot_item_label}),(0,Ue.jsx)(p.Text,{className:(0,s.AK)(et.m_spot_item_label_text,s.hj.isApp()?et.m_spot_item_label_text_app:""),children:"\u76f8\u5173\u666f\u70b9"})]}),(0,Ue.jsxs)(p.View,{className:et.m_spot_item_content,children:[(0,Ue.jsxs)(p.View,{className:et.m_spot_item_content_top,children:[(0,Ue.jsx)(p.Text,{className:et.m_spot_item_content_top_name,style:We.Z,children:o}),(0,Ue.jsx)(Qe.m,{className:et.m_spot_item_content_top_next_icon,type:"arrowright",size:12,color:"#111"})]}),(0,Ue.jsxs)(p.View,{className:et.m_spot_item_content_bottom,children:[(0,Ue.jsx)(Qe.m,{className:(0,s.AK)(et.m_spot_item_content_bottom_score_icon,s.hj.isIOS()?"":et.m_spot_item_content_bottom_score_icon_android),type:"comment",size:11,color:"#888"}),(0,Ue.jsx)(p.Text,{className:et.m_spot_item_content_bottom_score,children:n}),(0,Ue.jsx)(p.View,{className:et.m_spot_item_content_bottom_split_line}),(0,Ue.jsx)(p.Text,{className:et.m_spot_item_content_bottom_commment,children:i}),(0,Ue.jsx)(Qe.m,{className:(0,s.AK)(et.m_spot_item_content_bottom_address_icon,s.hj.isIOS()?"":et.m_spot_item_content_bottom_address_icon_android),type:"locate",size:11,color:"#888"}),(0,Ue.jsx)(s.X_,{className:et.m_spot_item_content_bottom_address,numberOfLines:1,children:a})]})]})]})},it=function(e){var t=$e(e),o=t.currentPage,n=t.totalPage,i=t.spotList,a=t.setCurrentPage,r=t.handleClickSpot,s=t.spotClickLog,u=t.spotExpoLog;return!i||i.length<=0?null:(0,Ue.jsxs)(p.View,{className:et.m_spot_list,children:[1==i.length?(0,Ue.jsx)(nt,(0,l.Z)((0,l.Z)({},i[0]||{}),{},{handleClick:r,expoLog:u(1),clickLog:s(1)})):(0,Ue.jsx)(p.View,{children:(0,Ue.jsx)(p.Swiper,{onChange:function(e){a(e.detail.current)},className:et.m_swiper_wrapper,children:i.map((function(e,t){return(0,Ue.jsx)(p.SwiperItem,{className:et.m_swiper_item,children:(0,Ue.jsx)(nt,(0,l.Z)((0,l.Z)({},e),{},{handleClick:r,expoLog:u(t+1),clickLog:s(t+1)}))},t)}))})}),i.length>1&&(0,Ue.jsx)(ot,{currentPage:o,totalPage:n,datas:i,spotClassName:et.m_spot_list_dot})]})},at=function(e){var t=e.onLayout,o=e.setRefs;return(0,Ue.jsxs)(p.View,{style:{backgroundColor:"#fff",overflow:"hidden"},onLayout:t,className:"spot-list-wrapper",ref:function(e){return o("spotList",e)},children:[(0,Ue.jsx)(p.View,{className:et.m_split_line,style:{height:tt.Z}}),(0,Ue.jsx)(it,(0,l.Z)({},e)),(0,Ue.jsx)(p.View,{className:(0,s.AK)(et.m_split_margin)})]})},rt=(0,he.Z)("ticket-detail"),st=ze,lt=ze,ut=ze,ct=ze,dt=ze,mt=ze,_t=function(){return null},ht=function(e){(0,m.Z)(n,e);var t=(0,_.Z)(n);function n(e){var o;(0,u.Z)(this,n),o=t.call(this,e),(0,a.Z)((0,d.Z)(o),"panResponder",void 0),(0,a.Z)((0,d.Z)(o),"startX",20),(0,a.Z)((0,d.Z)(o),"isIos",s.hj.isIOS());var i=(0,$.b6)("Loadjs");return i&&(rt.set("Loadjs",i),rt.recordEnd("Loadjs"),(0,$.ku)("Loadjs")),o.panResponder=h.Z.create({onStartShouldSetPanResponder:function(e,t){var n=(null===e||void 0===e?void 0:e.nativeEvent)||{},i=n.pageX;return i<o.startX},onPanResponderMove:function(e,t){var o=t.dx,i=t.dy;t.x0;o>120&&Math.abs(i)<o&&n.onBackAndroid()}}),o}return(0,c.Z)(n,[{key:"renderXTab",value:function(e){var t=this,o=this.state,n=o.currentTab,i=o.tabInfos,a=o.render,r=o.tabTip,l=this.logData.tabLog,u=void 0===l?{}:l;return(0,Ue.jsx)(s.UJ,{data:i,renderItem:function(o,n,i){return(0,Ue.jsxs)(p.View,{className:(0,s.AK)(Ye.m_tab_item),onLayout:function(o){return t.onLayout(e,o)},ref:function(o){t.setRefs(e,o)},children:[(0,Ue.jsx)(s.X_,{testID:0==n&&a?u.tabExposureLog:{},className:(0,s.AK)(Ye.m_tab_item_text),style:We.Z,children:o.text}),1==n&&r?(0,Ue.jsx)(p.View,{className:(0,s.AK)(Ye.m_tab_tip),style:{left:b().getSystemInfoSync().windowWidth/4},children:(0,Ue.jsx)(p.Text,{className:(0,s.AK)(Ye.m_tab_tip_text),children:r})}):null]},n)},current:n.index,onTabClick:function(e,o){t.onTabClick(e,o)},showBgIndicator:!0,indictorWidth:26,scrollAble:!1,comStyle:(0,s.y0)({backgroundColor:"#fff",borderBottomWidth:1/b().getSystemInfoSync().pixelRatio,borderBottomColor:"#eee",borderBottomStyle:"solid"}),bgIndicatorStyles:{height:3,borderTopLeftRadius:2,borderTopRightRadius:2,backgroundColor:"#0066F6"},indicatorAnimate:!1})}},{key:"renderModule",value:function(e){var t,n=this,i=this.state,a=i.request,r=i.navigation,u=i.ticketInfomation,c=i.lowPricePerception,d=(i.currentTab,i.tabInfos,i.isShort),m=i.renderModules,_=i.render,h=i.footerHeight,f=(i.tabTip,i.spotList),v=i.mediaInfo,g=r||{},y=(g.title,g.recommendInfo,this.pageHeight-this.fixH-h),k=y-this.moduleMapH["head"],x=(0,l.Z)((0,l.Z)({},a),{},{usePage:"detail",subPage:"ticket-detail",aggregation:!0,label:a.isNewNaquhua?"newNaquhua":""}),b=this.logData,w=(b.tabLog,b.detailLog),Z=void 0===w?{}:w,T=b.skuLog,I=void 0===T?{}:T,P=b.spotListLog,j=void 0===P?{}:P;ut=o(16214).Z;var S=this.initEnd||"sku"!==a.anchor,L=s.GI.getPlatform()==s.GI.PLATFORM_TYPE.CRN;s.GI.getPlatform(),s.GI.PLATFORM_TYPE.Mini;switch(e){case"media":return mt=o(86036).Z,(0,Ue.jsx)(Ue.Fragment,{children:v?(0,Ue.jsx)(mt,(0,l.Z)((0,l.Z)({ref:function(e){return n.videoCompRef=e},onLayout:function(t){return n.onLayout(e,t)}},v),{},{ticketGroupId:a.ticketGroupId,setRefs:this.setRefs.bind(this),logs:Z,request:a,updateVideoPlaying:this.updateVideoPlaying,updateMuted:this.updateMuted})):(0,Ue.jsx)(p.View,{})});case"head":return dt=o(30436).Z,(0,Ue.jsx)(Ue.Fragment,{children:r?(0,Ue.jsx)(Ue.Fragment,{children:(0,Ue.jsx)(dt,(0,l.Z)((0,l.Z)({onLayout:function(t){return n.onLayout(e,t)}},r||{}),{},{setRefs:this.setRefs.bind(this)}))}):(0,Ue.jsx)(p.View,{onLayout:function(t){return n.onLayout(e,t)}})});case"lowPricePerception":return L&&null!==c&&void 0!==c&&null!==(t=c.vsInfos)&&void 0!==t&&t.length?(0,Ue.jsx)(Xe,{onLayout:function(t){return n.onLayout(e,t)},lowPricePerception:c,vsExposureLog:Z.vsExposureLog,elementhighlightExposureLog:Z.elementhighlightExposureLog,request:a}):(0,Ue.jsx)(p.View,{});case"tab":var R=s.GI.getPlatform()!==s.GI.PLATFORM_TYPE.CRN?p.View:qe.Fragment,C=s.GI.getPlatform()!==s.GI.PLATFORM_TYPE.CRN?{style:{top:v?this.moduleMapH["nav"]:0},className:(0,s.AK)(Ye.m_tab_sticky)}:{};return a.showSku?(0,Ue.jsx)(R,(0,l.Z)((0,l.Z)({},C),{},{children:this.renderXTab(e)})):null;case"detail":return(null===m||void 0===m?void 0:m.info)&&(lt=o(86317).Z),(0,Ue.jsx)(p.View,{ref:function(t){n.detailRef=t,n.setRefs(e,t)},className:(0,s.AK)(Ye.m_detail_wrapper,a.showSku?"":Ye.m_radius_top_12,S||d||!L?Ye.m_opacity_1:Ye.m_opacity_0),onLayout:function(t){return n.onLayout(e,t)},children:null!==m&&void 0!==m&&m.info&&u?(0,Ue.jsx)(lt,{renderFullScreen:!a.showSku,infoMinH:k,ticketInfomation:u,lowPricePerception:c,onToggleExpand:this.onToggleExpand.bind(this),onShortLayout:function(){return n.onShortLayout()},logs:Z,request:a}):(0,Ue.jsx)(ut,{})});case"sku":return(null===m||void 0===m?void 0:m.sku)&&(st=o(86328).Z),a.showSku&&x.token?(0,Ue.jsxs)(p.View,{className:(0,s.AK)(Ye.m_sku_wrapper),style:{minHeight:y},onLayout:function(t){return n.onLayout(e,t)},ref:function(t){n.setRefs(e,t)},children:[(0,Ue.jsx)(p.View,{className:(0,s.AK)(Ye.m_sku_title),children:_?(0,Ue.jsx)(s.X_,{testID:I.skuExposureLog,className:(0,s.AK)(Ye.m_sku_title_text),style:We.Z,children:"\u9884\u8ba2\u9009\u62e9"}):null}),(0,Ue.jsx)(st,{hasAssistCompRender:!0,ref:function(e){return n.skuRef=e},request:x,otherParams:{skuMinHeight:y},onSkuChange:function(e){return n.onSkuChange(e)},onSkuLoad:function(e,t){return n.onSkuLoad(e,"",t)},pageId:(0,$.dD)()})]}):null;case"spotList":return null!==f&&void 0!==f&&f.length?(0,Ue.jsx)(at,{spotList:f,logs:j,onLayout:function(t){return n.onLayout(e,t)},setRefs:this.setRefs.bind(this)}):(0,Ue.jsx)(p.View,{});default:return null}}},{key:"render",value:function(){var e,t,n,i,a,r,u=this;if(s.hj.isInServer())return(0,Ue.jsx)(p.View,{});var c=this.state,d=c.footer,m=c.request,_=c.navigation,h=c.showBigBtn,f=c.reservation,v=c.isSaleOut,g=c.assistComponent,y=c.scrollTop,k=c.footerHeight,x=c.isLoading,b=c.mediaInfo,w=c.isVideoPlaying,Z=c.isMuted,T=c.showTopTab,I=(m.showSku,_||{}),P=I.title,j=I.shareInfo,S=o(45137).Z,L=o(49718).Z,R=this.logData,C=R.navLog,N=void 0===C?{}:C,E=R.footerLog,M=void 0===E?{}:E,A=R.errPageLog,D=void 0===A?{}:A;v&&(ct=o(18855).Z);this.initEnd||m.anchor;var V={date:null===m||void 0===m?void 0:m.date},G=o(7286).Z,F=s.GI.getPlatform()===s.GI.PLATFORM_TYPE.Mini,B=(0,l.Z)({enhanced:!0,showScrollbar:!1,bounces:!1,scrollY:!0,onScroll:function(e){e.persist&&e.persist(),u.debonceScroll(e)},scrollsToTop:!1,scrollEventThrottle:16,scrollAnchoring:!0,style:(0,l.Z)({height:s.hj.isMini()?"calc(100% - ".concat(k,"px)"):"100%",flexShrink:1,backgroundColor:"transparent"},F?{}:{position:"relative"}),onLayout:this.onScrollAnchor.bind(this)},this.isRN?{}:{scrollTop:y}),K=this.isRN?qe.Fragment:p.View;return(0,Ue.jsxs)(p.View,(0,l.Z)((0,l.Z)({className:(0,s.AK)(Ye.m_page_wrap,"ticket-detail-wrap"),onLayout:function(e){return u.getPageHeight(e)},ref:function(e){u.pageWrapRef=e,u.setRefs("page",e)}},this.isIos?this.panResponder.panHandlers:{}),{},{children:[(0,Ue.jsx)(S,{title:P,shareInfo:j,headHeight:this.moduleMapH["head"],onLayout:function(e){return u.onLayout("nav",e)},ref:function(e){return u.navRef=e},onClose:function(){return u.onClose()},startTime:this.startTime,color:"#333",logs:N,mediaInfo:b,showSound:w,isMuted:Z,onChangeMuted:this.onChangeMuted,request:m}),this.isRN&&!x&&!v&&null!==m&&void 0!==m&&m.showSku?(0,Ue.jsx)(p.View,{style:(0,l.Z)({position:"absolute",top:this.moduleMapH["nav"],left:0,zIndex:8},T?{}:{zIndex:-10}),children:this.renderXTab("tab")}):null,v?(0,Ue.jsx)(ct,{text:"\u4f60\u67e5\u627e\u7684\u9875\u9762\u4e0d\u5b58\u5728",subText:"\u8bf7\u8fd4\u56de\u4e0a\u4e00\u9875",backBtnText:"\u8fd4\u56de",errPageLog:D}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)(p.ScrollView,(0,l.Z)((0,l.Z)({id:"ticket_detail_scroll_view",ref:function(e){return u.scrollView_ref=e}},B),{},{children:[(0,Ue.jsx)(K,{children:this.moduleConfig.map((function(e){return u.renderModule(e.name)}))}),x?(0,Ue.jsx)(p.View,{className:(0,s.AK)(Ye.loading),style:{height:"100%",flexShrink:1,backgroundColor:"#fff"}}):null]})),(0,Ue.jsx)(L,{collectAniFun:this.addFun.bind(this,"skufooter"),onLayout:function(e){return u.onLayout("footer",e)},setRefs:this.setRefs.bind(this),footer:d,spotid:m.spotid,optid:m.optid,showBigBtn:h,reservation:f,showSku:m.showSku,notHigh:!1,notKeepSpace:!0,btnClickLog:m.showSku?(null===(e=this.skuRef)||void 0===e||null===(e=e.logData)||void 0===e?void 0:e.tkt_sightdetail_click_package_next)||_t:M.btnClickLog,buyNoteClickLog:(null===(t=this.skuRef)||void 0===t||null===(t=t.logData)||void 0===t?void 0:t.tkt_sightdetail_click_package_notice)||_t,buyNoteExposureLog:(null===(n=this.skuRef)||void 0===n||null===(n=n.logData)||void 0===n?void 0:n.tkt_sightdetail_view_package_notice)||_t,priceDetailTraceData:m.showSku?(null===(i=this.skuRef)||void 0===i||null===(i=i.logData)||void 0===i?void 0:i.priceDetailTraceData)||_t:M.detailDevTraceLog,buyNoteTraceData:(null===(a=this.skuRef)||void 0===a||null===(a=a.logData)||void 0===a?void 0:a.buyNoteTraceData)||_t,btnTraceData:m.showSku?(null===(r=this.skuRef)||void 0===r||null===(r=r.logData)||void 0===r?void 0:r.btnTraceData)||_t:M.nextDevTraceLog,bigBtnClickLog:M.bigBtnClickLog,booking:this.onBtnClick.bind(this),onTabClick:function(e,t){return u.onTabClick(e,t)},chioceDateData:V})]}),(0,Ue.jsx)(G,{assistComponent:g})]}))}}]),n}(Oe),pt=(0,r.Z)(ht,(0,a.Z)((0,a.Z)((0,a.Z)({},s.GI.PLATFORM_TYPE.CRN,10650087188),s.GI.PLATFORM_TYPE.H5,10650104114),s.GI.PLATFORM_TYPE.Mini,10650104116),"ticket-detail"),ft=pt,vt={navigationBarTitleText:"\u8be6\u60c5",usingComponents:{},navigationBarBackgroundColor:"#ffffff",navigationBarTextStyle:"black",backgroundColor:"#eeeeee",backgroundTextStyle:"light",rnPageName:"ticket-detail"};Page((0,i.createPageConfig)(ft,"pages/tnt/business/detail/ticket-detail/index",{root:{cn:[]}},vt||{}))},63574:function(e,t,o){var n=o(31137),i=n.hj.isIOS()?{}:{fontWeight:"bold"};t["Z"]=i},9157:function(e,t){t["Z"]=function(e){}},7286:function(e,t,o){var n=o(49451);t["Z"]=n.Z},7249:function(e,t,o){o.d(t,{D:function(){return a}});var n=o(79301),i=o(95308);function a(e,t){var o;return(0,i.Z)((0,n.Z)().mark((function i(){var a,r,s,l,u=arguments;return(0,n.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:for(a=u.length,r=new Array(a),s=0;s<a;s++)r[s]=u[s];l=this,clearTimeout(o),o=setTimeout((function(){e.apply(l,r)}),t);case 4:case"end":return n.stop()}}),i,this)})))}},9641:function(e,t,o){o.d(t,{N:function(){return n}});var n=function(e,t){e&&e.style&&Object.assign(e.style,t)}},79181:function(e){e.exports=require("../../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../../cwx/ext/global")},33675:function(e){e.exports=require("../../../../../cwx/cwx")}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[3177,2107,1216,8592],(function(){return t(3848)}));e.O()}]);
//# sourceMappingURL=index.js.map