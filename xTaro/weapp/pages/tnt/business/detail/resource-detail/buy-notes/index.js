"use strict";require("../../../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[653],{21817:function(e,t,n){var o=n(32180),i=n(45023),r=n(63228),s=n(31137),a=n(68277),l=n(298),u=n(57042),c=n(24460),d=n(81876),h=n(21867),f=n(86066),g=n(90201),p=n(76914),v=n(95360),m=n(92954),Z=n.n(m),C=n(71515),S=n(9156),b=n(90129),y=n(96343),k=function(e){var t=e||{},n=t.target,o=void 0===n?{}:n,i=o.state,r=i.isLoading,a=i.request,l=(0,g.useState)(!1),u=(0,b.Z)(l,2),c=u[0],d=u[1];(0,g.useEffect)((function(){s.hj.isInServer()||d(!0)}),[]);var h=(0,g.useCallback)((function(e){(0,y.Z)(o,a,e)}),[o,a]);return{isLoading:r,isNotInServer:c,changeBottomCallback:h}},x=k,P=n(72027),w={m_title:"index-module_fVzX8",m_page_wrap:"index-module_cXJut",m_content:"index-module_qLxpU",m_loading:"index-module_r2neG"},I=n(2269),_=s.hj.isH5(),j=function(e){var t=e.titleInfoProps,n=e.onShowSubtitlesPoplayer,o=e.style,i=void 0===o?{}:o,r=e.onClosePoplayer;return(0,I.jsx)(C.View,{className:w.m_title,style:i,children:(0,I.jsx)(S.Z,(0,l.Z)((0,l.Z)({},t),{},{onShowSubtitlesPoplayer:n,onClose:r}))})},B=function(e){var t=e.children,n=e.isNotInServer,o=e.onClose,i=e.windowHeight,r=e.isComponent;return _&&!r?(0,I.jsx)(C.View,{style:_?{height:"100%",paddingTop:n?.2*i:i-600}:{},onClick:o,children:t}):(0,I.jsx)(I.Fragment,{children:t})},N=g.forwardRef((function(e,t){var n,o=e||{},i=o.target,r=void 0===i?{}:i,a=x(e),u=a.isLoading,c=a.isNotInServer,d=a.changeBottomCallback,h=e.hideBottom,f=e.buttonInfo,p=e.buyNoteShareClickLog,v=e.onClose,m=e.bottomHeight,S=e.isComponent,b=null===f||void 0===f||null===(n=f.clickLog)||void 0===n||null===(n=n.params)||void 0===n?void 0:n.stocktype,y=s.GI.getPlatform()===s.GI.PLATFORM_TYPE.CRN,k=s.GI.getPlatform()===s.GI.PLATFORM_TYPE.Mini,N=y?Z().getSystemInfoSync().windowHeight-Z().getSystemInfoSync().statusBarHeight:Z().getSystemInfoSync().windowHeight;return(0,g.useImperativeHandle)(t,(function(){return{changeBottom:d}})),(0,I.jsx)(B,{isNotInServer:c,onClose:v,windowHeight:N,isComponent:S,children:(0,I.jsx)(C.View,{style:{height:S?"100%":k?"100vh":c?.8*N:600,overflow:"hidden"},className:w.m_content,onClick:_?function(e){return e.stopPropagation()}:void 0,children:u?(0,I.jsx)(C.View,{style:{height:"100%"},children:(0,I.jsx)(s.OK,{style:{height:"100%"},size:35,fontStyle:{fontSize:12}})}):(0,I.jsx)(P.Z,(0,l.Z)((0,l.Z)({stocktype:b},r.state),{},{isBuyNotesPageMini:s.hj.isMini()&&!S,target:r,hideBottom:h,onClose:v,TitleComp:j,extraButtonInfo:f,buyNoteShareClickLog:p,bottomHeight:m,changeBottomCallback:d}))})})})),R=(0,v.RI)(N),T=n(27480),L=n(86648),M=n(63362),H=n(32768),A=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var o;return(0,u.Z)(this,n),o=t.call(this,e),(0,i.Z)((0,d.Z)(o),"panResponder",void 0),(0,i.Z)((0,d.Z)(o),"startX",20),(0,i.Z)((0,d.Z)(o),"isIos",s.hj.isIOS()),o.panResponder=H.Z.create({onStartShouldSetPanResponder:function(e,t){var n=(null===e||void 0===e?void 0:e.nativeEvent)||{},i=n.pageX;return i<o.startX},onPanResponderMove:function(t,n){var o=n.dx,i=n.dy;o>120&&Math.abs(i)<o&&(e.onBack?e.onBack():M.ZP.navigateBack())}}),o}return(0,c.Z)(n,[{key:"render",value:function(){return(0,I.jsx)(C.View,(0,l.Z)((0,l.Z)({className:this.props.className},this.props.allPlatform||this.isIos?this.panResponder.panHandlers:{}),{},{children:this.props.children}))}}]),n}(g.PureComponent),G=n(93081),O=n(99135),q=["isComponent","onClose"],F=null,E=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var o;(0,u.Z)(this,n),o=t.call(this,e),(0,i.Z)((0,d.Z)(o),"state",void 0),(0,i.Z)((0,d.Z)(o),"buyNotesRef",void 0);var r=e.isComponent;return o.buyNotesRef=null,o.state={visible:!1,request:r?(0,T.j)(e):(0,T.j)((0,p.N)()),isLoading:!0},F=(0,d.Z)(o),r&&((0,G.Zw)(),!s.hj.isInServer()&&(0,G.eV)(["getProductPriceCalendar","CreateTicketOrder","SearchBookingReducetools","searchBookingSalesPromotionRestful","getProductShelf","searchAdditionalResource","getActPreferenceInfo","resourceDetails"])),!s.hj.isInServer()&&new L.Z((0,d.Z)(o)),O.B.register("tnt_bookingSkidSoldout_notice",(function(){var e;console.log("tnt_bookingSkidSoldout_notice======="),null===(e=o.buyNotesRef)||void 0===e||e.changeBottom()}),!0),o}return(0,c.Z)(n,[{key:"componentDidMount",value:function(){this.setState({visible:!0})}},{key:"onClose",value:function(){var e=this.props,t=e.isComponent,n=e.onClose,o=this.state.request,i=o.seckillid,r=o.isFromShelf;i&&r&&O.B.send("ottd_shelf_reloadShelf"),t?n&&n():this.pop()}},{key:"afterFetch",value:function(e,t,n,o){var i=(0,l.Z)((0,l.Z)({},e),{},{isLoading:!1});this.setState(i,o)}},{key:"componentWillUnmount",value:function(){O.B.destroy("tnt_bookingSkidSoldout_notice",(function(){}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.isComponent,o=t.onClose,i=(0,a.Z)(t,q),r=n?i:(0,p.N)(),u=s.hj.isMini();return u||n?(0,I.jsx)(R,(0,l.Z)((0,l.Z)({},r),{},{isComponent:n,onClose:o,target:this,ref:function(t){return e.buyNotesRef=t}})):(0,I.jsxs)(s.H5,{visible:this.state.visible,isCrnModal:!1,zIndex:100,style:{backgroundColor:"transparent",bottom:0,top:"auto"},onClose:function(){return e.setState({visible:!1})},closeTransitionEnd:function(){return e.onClose()},hideIphoneXAdapter:!0,children:[(0,I.jsx)(s.pT,{translucent:!0,backgroundColor:"transparent"}),(0,I.jsx)(A,{className:(0,s.AK)(w.m_page_wrap,"m_buynotes"),onBack:function(){return e.setState({visible:!1})},children:(0,I.jsx)(R,(0,l.Z)((0,l.Z)({},r),{},{onClose:function(){return e.setState({visible:!1})},target:this,ref:function(t){return e.buyNotesRef=t}}))})]})}}],[{key:"renderCheckInfo",value:function(){return{top:.25,bottom:.1}}},{key:"onBackAndroid",value:function(){var e;null===(e=F)||void 0===e||e.setState({visible:!1})}}]),n}(v.ZP);(0,i.Z)(E,"useFragment",!0);var V=(0,r.Z)(E,(0,i.Z)((0,i.Z)((0,i.Z)({},s.GI.PLATFORM_TYPE.CRN,10650086419),s.GI.PLATFORM_TYPE.H5,10650097502),s.GI.PLATFORM_TYPE.Mini,10650097504),"buy-notes"),X={navigationBarTitleText:"\u8d2d\u4e70\u987b\u77e5",usingComponents:{},navigationBarBackgroundColor:"#ffffff",navigationBarTextStyle:"black",backgroundColor:"#eeeeee",backgroundTextStyle:"light",rnPageName:"buy-notes"};Page((0,o.createPageConfig)(V,"pages/tnt/business/detail/resource-detail/buy-notes/index",{root:{cn:[]}},X||{}))},79181:function(e){e.exports=require("../../../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../../../cwx/ext/global")}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[3177,2107,1216,8592],(function(){return t(21817)}));e.O()}]);
//# sourceMappingURL=index.js.map