"use strict";require("../../taroCommon"),(wx["tripTaroGlobal30"]=wx["tripTaroGlobal30"]||[]).push([[1499],{94712:function(e,n,r){var t=r(32180),i=r(298),c=r(57042),o=r(24460),a=r(81876),s=r(21867),l=r(86066),u=r(45023),d=r(71515),g=r(33485),h=r(56959),m=r(79301),p=r(95308),f=r(90201),x=r(46294),y=r(78119),v=r(65251),b=r(46046),_=r(8972),w={traceKey:{cLoginSuccess:h.Mx.c_wechat_login_success,cLoginFail:h.Mx.c_wechat_login_fail},logDevTrace:function(e){return b.ZP.logDevTrace(e)},logTrace:function(e,n){return b.ZP.logTrace(e,n)}},C=(0,i.Z)((0,i.Z)({},w),{},{loginType:"sendMessageByPhone",monitor:(0,_.gH)(h.q2.sendMessageByPhone)}),k=(0,i.Z)((0,i.Z)({},w),{},{loginType:"searchOrderByPhone",monitor:(0,_.gH)(h.q2.searchOrderByPhone)}),j=r(89299),Z=r(28629),S=r(68451),A=r(2269),P=function(e){var n=(0,y.hk)(),r=n.restSeconds,t=n.start,i=e.mobile,c=e.captchaRef,o=(0,x.useVerifyCode)({sendVerifyCode:function(){var e=(0,p.Z)((0,m.Z)().mark((function e(n,r,t){var i;return(0,m.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.Jv.sendMessage(n,t,x.VerifyCodeScene.SEARCH_ORDER);case 2:return i=e.sent,e.abrupt("return",i);case 4:case"end":return e.stop()}}),e)})));function n(n,r,t){return e.apply(this,arguments)}return n}(),captchaConfig:{appId:h.mD.modern,businessSite:h.MD.mobileQueryOrder},log:C}),a=o.clickSendVerifyCode,s=(0,f.useCallback)((function(){if(v.tY.logTrace(h.b9.c_miniapporder_find_sendcode),(0,v.Cf)(i)){var e=(0,v.lL)(i,j.k);e>0?t(e):a({sendVerifyCodeInfo:{mobilePhone:i,countryCode:"86"},loading:v.Bj,toast:v.yD,captcha:(0,Z.o)(c)}).then((function(e){null!==e&&void 0!==e&&e.ok&&((0,v.hJ)(i),t(j.k))}))}}),[i,t,c,a]);return r?(0,A.jsx)(d.Button,{className:"btn_countdown gray",disabled:!0,children:"".concat(r,"s\u540e\u91cd\u65b0\u53d1\u9001")}):(0,A.jsx)(d.Button,{className:"btn_countdown",onClick:s,children:"\u53d1\u9001\u9a8c\u8bc1\u7801"})},L=r(70487),N=r(84475),T=function(e){return!!e||((0,v.pb)("\u8bf7\u5148\u9605\u8bfb\u5e76\u540c\u610f\u76f8\u5173\u534f\u8bae\u548c\u653f\u7b56"),!1)},V=function(e){var n=e.isCheckedAgreement,r=e.mobileSearchSuccessResultUrl,t=(0,y.Gl)(),c=(0,y.Gl)(),o=(0,f.useRef)(null),a={mobile:t.value,captchaRef:o},s=(0,x.useSearchOrder)({orderSearch:function(){var e=(0,p.Z)((0,m.Z)().mark((function e(n,r,t){var i;return(0,m.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.Jv.login({mobilePhone:n,dynamicCode:r,countryCode:t},{});case 2:return i=e.sent,e.abrupt("return",i);case 4:case"end":return e.stop()}}),e)})));function n(n,r,t){return e.apply(this,arguments)}return n}(),log:k}),l=s.clickSearchOrder,u=(0,f.useCallback)((function(){v.tY.logTrace(h.b9.c_miniapporder_find_verify),(0,v.tV)(t.value,c.value)&&T(n)&&l({searchOrderInfo:{mobilePhone:t.value,verifyCode:c.value,countryCode:"86",isAgreement:n},loading:v.Bj,toast:v.yD}).then((function(e){if(null!==e&&void 0!==e&&e.ok&&(v.tY.logTrace(h.b9.c_miniapporder_find_success),v.tY.logTrace(h.Mx.c_wechat_login_success,{type:"ordersearch",subtype:e.hasLogin?"haslogin":"nologin"}),null!==e&&void 0!==e&&e.hasLogin||v.tY.logTrace(h.b9.c_miniapporder_find_login),r)){var n=!0,t=!1;(0,L.B2)({url:r,needLogin:n,isNavigate:t})}}))}),[t,c,r,l,n]);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)(d.View,{className:"login-item",children:[(0,A.jsx)(d.Label,{className:"login-item_title",children:"\u624b\u673a\u53f7"}),(0,A.jsx)(d.Input,(0,i.Z)({className:"login-item_input",name:"mobilephone",id:"mobilephone",type:"number",maxlength:11,placeholder:"\u8ba2\u5355\u8054\u7cfb\u4eba\u624b\u673a\u53f7"},t))]}),(0,A.jsxs)(d.View,{className:"login-item",children:[(0,A.jsx)(d.Label,{className:"login-item_title",children:"\u52a8\u6001\u7801"}),(0,A.jsx)(d.Input,(0,i.Z)({className:"login-item_input login-item_input-picauth",placeholder:"6\u4f4d\u6570\u5b57",id:"dyncpwd",type:"number",maxlength:6,name:"dyncpwd"},c)),(0,A.jsx)(P,(0,i.Z)({},a))]}),(0,A.jsx)(d.Button,{className:"btn-login",hoverClass:"btn-primary_hover",id:"dynamicLogin",onClick:u,children:"\u767b\u5f55\u5e76\u67e5\u8be2"}),(0,A.jsx)(N.Z,{useModern:!0,businessSite:h.MD.mobileQueryOrder,ref:o})]})},B=r(90129),O=r(3997),M=function(e){var n=e.isLogin,r=e.checkLoginAndAgree,t=(0,f.useState)(!1),i=(0,B.Z)(t,2),c=i[0],o=i[1],a=(0,f.useCallback)((function(){o((function(){return r(!c),!c}))}),[c,r]);return n?null:(0,A.jsxs)(d.View,{className:"agreement",children:[(0,A.jsx)(d.Icon,{type:c?"success":"circle",size:"17",onClick:a}),"\u9605\u8bfb\u5e76\u540c\u610f\u643a\u7a0b\u7684",(0,A.jsxs)(d.Text,{className:"agreement-text","data-jumptype":v.UM.agreement,onClick:v.PP,children:["\u300a",O.fx.accountsAgreement.text,"\u300b"]}),"\u548c",(0,A.jsxs)(d.Text,{className:"agreement-text","data-jumptype":v.UM.policy,onClick:v.PP,children:["\u300a",O.fx.accountsPolicy.text,"\u300b"]}),(0,A.jsx)(d.View,{children:"\u672a\u6ce8\u518c\u624b\u673a\u53f7\uff0c\u67e5\u5355\u65f6\u5c06\u81ea\u52a8\u6ce8\u518c\u643a\u7a0b\u8d26\u53f7\u3002"})]})},I=function(e){(0,s.Z)(r,e);var n=(0,l.Z)(r);function r(){var e;(0,c.Z)(this,r);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return e=n.call.apply(n,[this].concat(i)),(0,u.Z)((0,a.Z)(e),"state",{isCheckedAgreement:!1,mobileSearchSuccessResultUrl:""}),(0,u.Z)((0,a.Z)(e),"checkLoginAndAgree",(function(n){e.setState({isCheckedAgreement:n})})),e}return(0,o.Z)(r,[{key:"getPageId",value:function(){return h.Vo.searchorder}},{key:"onLoad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,v.bg)(),r=this.getFromQueryViaOptions(e);this.setState({isCheckedAgreement:n,mobileSearchSuccessResultUrl:r})}},{key:"getFromQueryViaOptions",value:function(e){var n="",r=!1;return e.from&&(r=!0),n=r?decodeURIComponent(e.from||""):e.data&&e.data.from,n}},{key:"renderIsLoginAndAgree",value:function(){return(0,A.jsx)(M,{isLogin:(0,v.bg)(),checkLoginAndAgree:this.checkLoginAndAgree})}},{key:"render",value:function(){return(0,A.jsxs)(d.View,{className:"bg",children:[(0,A.jsx)(d.View,{className:"login-by_phone",children:(0,A.jsx)(d.View,{className:"login-form_list",children:(0,A.jsx)(V,(0,i.Z)({},this.state))})}),this.renderIsLoginAndAgree(),(0,A.jsx)(d.View,{className:"tips-notice",children:"\u53ef\u652f\u6301\u67e5\u8be2\u6700\u8fd11\u5e74\u7684\u8ba2\u5355\uff08\u706b\u8f66\u7968\u4ec5\u9650\u6700\u8fd11\u6708\uff09"}),this.checkPerformanceFunc()]})}}]),r}(g.Z),R={usingComponents:{captcha:"@miniapp/commonComponent/captcha_min/captcha"},componentPlaceholder:{captcha:"@miniapp/cwx/component/captcha_min/captcha"},navigationBarTitleText:"\u624b\u673a\u53f7\u67e5\u5355",navigationBarTextStyle:"white",navigationBarBackgroundColor:"#099fde",disableScroll:!0};Page((0,t.createPageConfig)(I,"pages/accounts/pages/searchorder/index",{root:{cn:[]}},R||{}))},79181:function(e){e.exports=require("../../../../cwx/cpage/initNavigator")},91783:function(e){e.exports=require("../../../../cwx/cpage/ubt_wx")},56884:function(e){e.exports=require("../../../../cwx/cwx")},65238:function(e){e.exports=require("../../../../cwx/ext/global")},39270:function(e){e.exports=require("../../../../agreementConfig")},33675:function(e){e.exports=require("../../../../cwx/cwx")}},function(e){var n=function(n){return e(e.s=n)};e.O(0,[3487,2107,1216,8592],(function(){return n(94712)}));e.O()}]);
//# sourceMappingURL=index.js.map